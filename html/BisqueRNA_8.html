<div class="container">

<table style="width: 100%;"><tr>
<td>GetCTP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return cell type proportions from bulk</h2>

<h3>Description</h3>

<p>Calculate cell type proportions from a data frame containing bulk expression
values. Uses PCA (weighted or regular) to estimate relative proportions
within each cell type.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GetCTP(
  bulk,
  cell_types,
  markers,
  ct_col,
  gene_col,
  min_gene,
  max_gene,
  weighted,
  w_col,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bulk</code></td>
<td>
<p>Expression Set containing bulk data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_types</code></td>
<td>
<p>Character vector. Names of cell types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>Data frame with columns specifying cluster and gene,
and optionally a column for weights, typically the fold-change of the gene.
Important that the genes for each cell type are row-sorted by signficance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ct_col</code></td>
<td>
<p>Character string. Column name specifying cluster/cell type
corresponding to each marker gene in <strong>markers</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_col</code></td>
<td>
<p>Character string. Column name specifying gene names in
<strong>markers</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_gene</code></td>
<td>
<p>Numeric. Min number of genes to use for each cell type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_gene</code></td>
<td>
<p>Numeric. Max number of genes to use for each cell type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Boolean. Whether to use weights for gene prioritization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_col</code></td>
<td>
<p>Character string. Column name for weights, such as "avg_logFC",
in <strong>markers</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean. Whether to print log info during decomposition.
Errors will be printed regardless.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A List. Slot <strong>cors</strong> contains list of vectors with correlation
coefficients. Slot <strong>ctps</strong> contains list of CTP objects returned by
GetCTP
</p>


</div>