<div class="container">

<table style="width: 100%;"><tr>
<td>plot.biwavelet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot <code>biwavelet</code> objects</h2>

<h3>Description</h3>

<p>Plot <code>biwavelet</code> objects such as the cwt, cross-wavelet and wavelet
coherence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'biwavelet'
plot(
  x,
  ncol = 64,
  fill.cols = NULL,
  xlab = "Time",
  ylab = "Period",
  tol = 1,
  plot.cb = FALSE,
  plot.phase = FALSE,
  type = "power.corr.norm",
  plot.coi = TRUE,
  lwd.coi = 1,
  col.coi = "white",
  lty.coi = 1,
  alpha.coi = 0.5,
  plot.sig = TRUE,
  lwd.sig = 4,
  col.sig = "black",
  lty.sig = 1,
  bw = FALSE,
  legend.loc = NULL,
  legend.horiz = FALSE,
  arrow.len = min(par()$pin[2]/30, par()$pin[1]/40),
  arrow.lwd = arrow.len * 0.3,
  arrow.cutoff = 0.8,
  arrow.col = "black",
  xlim = NULL,
  ylim = NULL,
  zlim = NULL,
  xaxt = "s",
  yaxt = "s",
  form = "%Y",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>biwavelet</code> object generated by <code>wt</code>,
<code>xwt</code>, or <code>wtc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>Number of colors to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.cols</code></td>
<td>
<p>Vector of fill colors to be used. Users can specify color
vectors using <code>colorRampPalette</code> or
<code>brewer.pal</code> from package
<code>RColorBrewer</code>. Value <code>NULL</code> generates
MATLAB's jet color palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X-label of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y-label of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance level for significance contours. Sigificance contours
will be drawn around all regions of the spectrum where
<code>spectrum/percentile &gt;= tol</code>. If strict <code class="reqn">i^{th}</code> percentile
regions are desired, then <code>tol</code> must be set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cb</code></td>
<td>
<p>Plot color bar if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.phase</code></td>
<td>
<p>Plot phases with black arrows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot to create. Can be <code>power</code> to plot the power,
<code>power.corr</code> to plot the bias-corrected power, <code>power.norm</code> to
plot the power normalized by the variance, <code>power.corr.norm</code> to plot
the bias-corrected power normalized by the variance, <code>wavelet</code> to plot
the wavelet coefficients, or <code>phase</code> to plot the phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.coi</code></td>
<td>
<p>Plot cone of influence (COI) as a semi-transparent polygon if
<code>TRUE</code>. Areas that fall within the polygon can be affected by edge
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.coi</code></td>
<td>
<p>Line width of COI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.coi</code></td>
<td>
<p>Color of COI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.coi</code></td>
<td>
<p>Line type of COI. Value 1 is for solide lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.coi</code></td>
<td>
<p>Transparency of COI. Range is 0 (full transparency) to 1 (no
transparency).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.sig</code></td>
<td>
<p>Plot contours for significance if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.sig</code></td>
<td>
<p>Line width of significance contours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sig</code></td>
<td>
<p>Color of significance contours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.sig</code></td>
<td>
<p>Line type of significance contours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>plot in black and white if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.loc</code></td>
<td>
<p>Legend location coordinates as defined by
<code>image.plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.horiz</code></td>
<td>
<p>Plot a horizontal legend if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.len</code></td>
<td>
<p>Size of the arrows. Default is based on plotting region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.lwd</code></td>
<td>
<p>Width/thickness of arrows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.cutoff</code></td>
<td>
<p>Cutoff value for plotting phase arrows. Phase arrows will
be be plotted in regions where the significance of the zvalues exceeds
<code>arrow.cutoff</code> for <code>wt</code> and <code>xwt</code> objects. For
<code>pwtc</code> and <code>wtc</code> objects, phase arrows will be
plotted in regions where the <code>rsq</code> value exceeds <code>arrow.cutoff</code>.
If the object being plotted does not have a significance field, regions
whose z-values exceed the <code>arrow.cutoff</code> quantile will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.col</code></td>
<td>
<p>Color of arrows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>The x limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>The y limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>The z limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxt</code></td>
<td>
<p>Add x-axis? Use <code>n</code> for none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxt</code></td>
<td>
<p>Add y-axis? Use <code>n</code> for none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>Format to use to display dates on the x-axis.
See <code>Date</code> for other valid formats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Arrows pointing to the right mean that <code>x</code> and <code>y</code> are in phase.
</p>
<p>Arrows pointing to the left mean that <code>x</code> and <code>y</code> are in anti-phase.
</p>
<p>Arrows pointing up mean that <code>x</code> leads <code>y</code> by <code class="reqn">\pi/2</code>.
</p>
<p>Arrows pointing down mean that <code>y</code> leads <code>x</code> by <code class="reqn">\pi/2</code>.
</p>


<h3>Author(s)</h3>

<p>Tarik C. Gouhier (tarik.gouhier@gmail.com)
Code based on WTC MATLAB package written by Aslak Grinsted.
</p>


<h3>References</h3>

<p>Cazelles, B., M. Chavez, D. Berteaux, F. Menard, J. O. Vik, S. Jenouvrier,
and N. C. Stenseth. 2008. Wavelet analysis of ecological time series.
<em>Oecologia</em> 156:287-304.
</p>
<p>Grinsted, A., J. C. Moore, and S. Jevrejeva. 2004. Application of the cross
wavelet transform and wavelet coherence to geophysical time series.
<em>Nonlinear Processes in Geophysics</em> 11:561-566.
</p>
<p>Torrence, C., and G. P. Compo. 1998. A Practical Guide to Wavelet Analysis.
<em>Bulletin of the American Meteorological Society</em> 79:61-78.
</p>
<p>Liu, Y., X. San Liang, and R. H. Weisberg. 2007. Rectification of the Bias in
the Wavelet Power Spectrum. <em>Journal of Atmospheric and Oceanic
Technology</em> 24:2093-2102.
</p>


<h3>Examples</h3>

<pre><code class="language-R">t1 &lt;- cbind(1:100, rnorm(100))
t2 &lt;- cbind(1:100, rnorm(100))

# Continuous wavelet transform
wt.t1 &lt;- wt(t1)

# Plot power
# Make room to the right for the color bar
par(oma = c(0, 0, 0, 1), mar = c(5, 4, 4, 5) + 0.1)
plot(wt.t1, plot.cb = TRUE, plot.phase = FALSE)

# Cross-wavelet transform
xwt.t1t2 &lt;- xwt(t1, t2)

# Plot cross-wavelet
par(oma = c(0, 0, 0, 1), mar = c(5, 4, 4, 5) + 0.1)
plot(xwt.t1t2, plot.cb = TRUE)

# Example of bias-correction
t1 &lt;- sin(seq(0, 2 * 5 * pi, length.out = 1000))
t2 &lt;- sin(seq(0, 2 * 15 * pi, length.out = 1000))
t3 &lt;- sin(seq(0, 2 * 40 * pi, length.out = 1000))

# This aggregate time series should have the same power
# at three distinct periods
s &lt;- t1 + t2 + t3

# Compare plots to see bias-effect on CWT:
# biased power spectrum artificially
# reduces the power of higher-frequency fluctuations.
wt1 &lt;- wt(cbind(1:1000, s))
par(mfrow = c(1,2))
plot(wt1, type = "power.corr.norm", main = "Bias-corrected")
plot(wt1, type = "power.norm", main = "Biased")

# Compare plots to see bias-effect on XWT:
# biased power spectrum artificially
# reduces the power of higher-frequency fluctuations.
x1 &lt;- xwt(cbind(1:1000, s), cbind(1:1000, s))
par(mfrow = c(1,2))

plot(x1, type = "power.corr.norm", main = "Bias-corrected")
plot(x1, type = "power.norm", main = "Biased")

</code></pre>


</div>