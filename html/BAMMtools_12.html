<div class="container">

<table style="width: 100%;"><tr>
<td>distinctShiftConfigurations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify distinct rate shift configurations</h2>

<h3>Description</h3>

<p>Identify topologically distinct rate shift configurations
that were sampled with <code>BAMM</code>, and assign each sample in the
posterior to one of the distinct shift configurations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">distinctShiftConfigurations(ephy, expectedNumberOfShifts, threshold, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedNumberOfShifts</code></td>
<td>
<p>The expected number of rate shifts under the
prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Threshold value for marginal posterior-to-prior odds
ratios, used to identify branches with elevated shift probabilities
relative to prior (core vs non-core shifts).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to distinctShiftConfigurations (possibly
deprecated args).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Rabosky et al (2014) and the <code>BAMM</code> project website for
details on the nature of distinct shift configurations and especially
the distinction between "core" and "non-core" rate shifts. Note that
branches with elevated marginal posterior probabilities relative to
the prior (marginal odds ratios) cannot be claimed to have
"significant" evidence for a rate shift on the basis of this evidence
alone.
</p>


<h3>Value</h3>

<p>An object of class <code>bammshifts</code>. This is a list with the
following components:
</p>

<ul>
<li>
<p> marg.probs: A list of the marginal probability of a shift
occurring at each node of the phylogeny for each distinct rate
shift configuration.
</p>
</li>
<li>
<p> marginal_odd_ratio: Marginal posterior-to-prior odds ratios
for one or more rate shifts an a given branch.
</p>
</li>
<li>
<p> shifts: A list of the set of shift nodes for each distinct
rate configuration.
</p>
</li>
<li>
<p> samplesets: A list of sample indices that reduce to each of
the unique shift sets.
</p>
</li>
<li>
<p> frequency: A vector of frequencies of each distinct shift
configuration.
</p>
</li>
<li>
<p> coreshifts: A vector of node numbers corresponding to the
core shifts. All of these nodes have a marginal odds ratio of
at least <code>threshold</code> supporting a rate shift.
</p>
</li>
<li>
<p> threshold: A single numeric value giving the marginal
posterior:prior odds ratio threshold used during enumeration
of distinct shift configurations.
</p>
</li>
</ul>
<p>Results are sorted by frequency:
</p>
<p>$frequency[1] gives the most common shift configuration sampled.
</p>
<p>$shifts[[1]] gives the corresponding node indices for that
configuration.
</p>
<p>$samplesets[[1]] gives the indices of samples with this configuration.
</p>


<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>See Also</h3>

<p><code>plot.bammshifts</code>, <code>credibleShiftSet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.25, nsamples=500)

sc &lt;- distinctShiftConfigurations(ed, expectedNumberOfShifts = 1,
                                  threshold = 5)

plot(sc, ed, rank=1)
</code></pre>


</div>