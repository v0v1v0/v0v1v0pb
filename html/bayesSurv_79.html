<div class="container">

<table style="width: 100%;"><tr>
<td>predictive2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute predictive quantities based on a Bayesian survival regression
model fitted using bayesBisurvreg or bayessurvreg2 or bayessurvreg3 functions.
</h2>

<h3>Description</h3>

<p>This function computes predictive densities, survivor and hazard
curves for specified combinations of covariates.
</p>
<p>Firstly, either the function <code>bayesBisurvreg</code> or the
function <code>bayessurvreg2</code> or the function <code>bayessurvreg3</code>
has to be used to obtain a sample from the posterior distribution of unknown quantities.
</p>
<p>Function <code>predictive2.control</code> serves only to perform some input
checks inside the main function <code>predictive2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predictive2(formula, random, obs.dim, time0, data = parent.frame(),
     grid, na.action = na.fail, Gspline,
     quantile = c(0, 0.025, 0.5, 0.975, 1),
     skip = 0, by = 1, last.iter, nwrite,
     only.aver = TRUE,
     predict = list(density=FALSE, Surv=TRUE,
                    hazard=FALSE, cum.hazard=FALSE),
     dir, extens = "", extens.random="_b", version=0)

predictive2Para(formula, random, obs.dim, time0, data = parent.frame(),
     grid, na.action = na.fail, Gspline,
     quantile = c(0, 0.025, 0.5, 0.975, 1),
     skip = 0, by = 1, last.iter, nwrite,
     only.aver = TRUE,
     predict = list(density=FALSE, Surv=TRUE,
                    hazard=FALSE, cum.hazard=FALSE),
     dir, extens = "", extens.random="_b", version=0)

predictive2.control(predict, only.aver, quantile, obs.dim,
     time0, Gspline, n)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the same formula as that one used to sample from the
posterior distribution of unknown quantities by the function
<code>bayesBisurvreg</code> or <code>bayessurvreg2</code> or
<code>bayessurvreg3</code>. On the left hand side whichever
<code>Surv</code> object of a~proper length
can be used (it is ignored anyway).
</p>
<p>REMARK: the prediction must be asked for at least two combinations of
covariates. This is the restriction imposed by one of the internal
functions I use.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>the same <code>random </code> statement as that one used to sample from the
posterior distribution of unknown quantities by the function
<code>bayessurvreg2</code> or <code>bayessurvreg3</code>, not applicable if
<code>bayesBisurvreg</code> was used to sample from the posterior
distribution.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>obs.dim</code></td>
<td>
<p>a vector that has to be supplied if bivariate data were
used for estimation (using the function
<code>bayesBisurvreg</code>). This vector has to be of the same
length as the number of covariate combinations for which the
predictive quantities are to be computed. It determines to which
dimension (1 or 2) each observation belong.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>time0</code></td>
<td>
<p>a~vector of length <code>Gspline$dim</code> giving the starting
time for the survival model. It does not have to be supplied if equal
to zero (usually).
This option is used to get hazard and density functions on the
original time scale in the case that the model was
<code class="reqn">\log(T-time0) = \dots</code>. Note that
<code>time0</code> IS NOT the starting time of doubly censored observation
since there after subtracting the onset time, the starting time is
(usually) equal to zero.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame in which to interpret the variables
occuring in the formulas. Usually, you create a new
<code>data.frame</code> similar to that one used to obtain a sample from
the posterior distribution. In this new <code>data.frame</code>, put
covariate values equal to these for which predictive quantities are
to be obtained. If <code>cluster</code> statement was used, assign a
unique cluster identification to each observation. Response variable
and a censoring indicator may be set to arbitrary values. They are
only used in <code>formula</code> but are ignored for computation.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>a~vector giving the grid of values where predictive
quantities are to be evaluated. The grid should normally start at some
value slightly higher than <code>time0</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>function to be used to handle any <code>NA</code>s in the
data. The user is discouraged to change a default value
<code>na.fail</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>Gspline</code></td>
<td>
<p>a~list specifying the G-spline used for the error
distribution in the model. It is a~list with the following components:
</p>

<dl>
<dt>dim</dt>
<dd>
<p>dimension of the G-spline, in the case when the function
<code>bayesBisurvreg</code> was used to fit the model this will
usually be equal to 2, in the case when the function
<code>bayessurvreg2</code> was used to fit the model this MUST be
equal to 1.</p>
</dd>
<dt>K</dt>
<dd>
<p>a~vector of length <code>Gspline$dim</code> specifying the number
of knots at each side of the middle knot for each dimension of the
G-spline.</p>
</dd>
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>a vector of quantiles that are to be computed for each
predictive quantity.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>number of rows that should be skipped at the beginning of
each *.sim file with the stored sample.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>additional thinning of the sample.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>last.iter</code></td>
<td>
<p>index of the last row from *.sim files that should be
used. If not specified than it is set to the maximum available
determined according to the file <code>mixmoment.sim</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>nwrite</code></td>
<td>
<p>frequency with which is the user informed about the
progress of computation (every <code>nwrite</code>th iteration count of
iterations change).
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>only.aver</code></td>
<td>
<p>if <code>TRUE</code> only posterior predictive mean is
computed for all quantities and no quantiles.
</p>
<p>The word of warning: with <code>only.aver</code> set to <code>FALSE</code>, all
quantities must be stored for all iterations of the MCMC to be able to
compute the quantiles. This might require quite lots of memory.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>a list of logical values indicating which predictive quantities are to be computed.
Components of the list:
</p>

<dl>
<dt>density</dt>
<dd>
<p>predictive density</p>
</dd>
<dt>Surv</dt>
<dd>
<p>predictive survivor functions</p>
</dd>
<dt>hazard</dt>
<dd>
<p>predictive hazard functions</p>
</dd>
<dt>cum.hazard</dt>
<dd>
<p>predictive cumulative hazard functions</p>
</dd>
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>directory where to search for files (‘mixmoment.sim’,
‘mweight.sim’, mmean.sim', gspline.sim', 'beta.sim', 'D.sim', ...) with the McMC
sample.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>extens</code></td>
<td>
<p>an extension used to distinguish different sampled
G-splines if more formulas were used in one MCMC simulation (e.g. with
doubly-censored data).
</p>

<ul>
<li>
<p> if the data were not doubly-censored or if you wish to compute
predictive quantities for the <em>onset</em> time of the
doubly-censored data then
</p>

<table><tr>
<td style="text-align: center;">
      <code>extens = ""</code>
    </td>
</tr></table>
</li>
<li>
<p> if the data were doubly-censored and you wish to compute
predictive quantities for the <em>event</em> time then
</p>

<table><tr>
<td style="text-align: center;">
      <code>extens = "_2"</code>
    </td>
</tr></table>
</li>
</ul>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>extens.random</code></td>
<td>
<p>only applicable if the function
<code>bayessurvreg3</code> was used to generate the MCMC sample.
</p>
<p>This is an extension used to distinguish different sampled G-splines
determining the distribution of the random intercept (under the
presence of doubly-censored data).
</p>

<ul>
<li>
<p> if the data were not doubly-censored or if you wish to compute
predictive quantities for the <em>onset</em> time of the
doubly-censored data then
</p>

<table><tr>
<td style="text-align: center;">
      <code>extens.random = "_b"</code>
    </td>
</tr></table>
</li>
<li>
<p> if the data were doubly-censored and you wish to compute
predictive quantities for the <em>event</em> time then
</p>

<table><tr>
<td style="text-align: center;">
      <code>extens.random = "_b2"</code>
    </td>
</tr></table>
</li>
</ul>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p> this argument indicates by which <code>bayes*survreg*</code> function the
chains used by <code>bayesGspline</code> were created. Use the following:
</p>

<dl>
<dt>bayesBisurvreg:</dt>
<dd>
<p><code>version = 0</code>;</p>
</dd>
<dt>bayessurvreg2:</dt>
<dd>
<p><code>version = 0</code>;</p>
</dd>
<dt>bayessurvreg3:</dt>
<dd>
<p>with all distributions specified as G-splines:
<code>version = 3</code>;</p>
</dd>
<dt>bayessurvreg3:</dt>
<dd>
<p>with error distributions specified as
G-splines and bivariate normal random intercepts: <code>version = 32</code>.</p>
</dd>    
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of covariate combinations for which the prediction will
be performed.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A list with possibly the following components (what is included depends
on the value of the arguments <code>predict</code> and <code>only.aver</code>):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>a~vector with the grid values at which the survivor
function, survivor density, hazard and cumulative hazard are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Surv</code></td>
<td>
<p>predictive survivor functions.
</p>
<p>A~matrix with as many columns as length(grid) and as many
rows as the number of covariate combinations for which the
predictive quantities were asked. One row per covariate combination.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>predictive survivor densities.
</p>
<p>The same structure as <code>Surv</code> component of the list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazard</code></td>
<td>
<p>predictive hazard functions.
</p>
<p>The same structure as <code>Surv</code> component of the list.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.hazard</code></td>
<td>
<p>predictive cumulative hazard functions.
</p>
<p>The same structure as <code>Surv</code> component of the list.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.Surv</code></td>
<td>
<p>pointwise quantiles for the predictive survivor
functions.
</p>
<p>This is a list with as many components as the number of covariate
combinations. One component per covariate combination.
</p>
<p>Each component of this list is a~matrix with as many columns as
length(grid) and as many rows as the length of the argument
<code>quantile</code>. Each row of this matrix gives values of one
quantile. The rows are also labeled by the probabilities (in %) of
the quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.density</code></td>
<td>
<p>pointwise quantiles for the predictive survivor
densities.
</p>
<p>The same structure as <code>quant.Surv</code> component of the list.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.hazard</code></td>
<td>
<p>pointwise quantiles for the predictive hazard
functions.
</p>
<p>The same structure as <code>quant.Surv</code> component of the list.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant.cum.hazard</code></td>
<td>
<p>pointwise quantiles for the predictive
cumulative hazard functions.
</p>
<p>The same structure as <code>quant.Surv</code> component of the list.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Komárek, A. (2006).
<em>Accelerated Failure Time Models for Multivariate
Interval-Censored Data with Flexible Distributional Assumptions</em>.
PhD. Thesis, Katholieke Universiteit Leuven, Faculteit Wetenschappen.
</p>
<p>Komárek, A. and Lesaffre, E. (2008).
Bayesian accelerated failure time model with multivariate doubly-interval-censored data
and flexible distributional assumptions.
<em>Journal of the American Statistical Association</em>, <b>103</b>,
523 - 533.
</p>
<p>Komárek, A. and Lesaffre, E. (2006).
Bayesian semi-parametric accelerated failurew time model for paired
doubly interval-censored data.
<em>Statistical Modelling</em>, <b>6</b>, 3 - 22.
</p>
<p>Komárek, A.,  Lesaffre, E., and Legrand, C. (2007).
Baseline and treatment effect heterogeneity for survival
times between centers using a random effects accelerated failure time
model with flexible error distribution.
<em>Statistics in Medicine</em>, <b>26</b>, 5457 - 5472.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See the description of R commands for
## the models described in
## Komarek (2006),
## Komarek and Lesaffre (2006),
## Komarek and Lesaffre (2008),
## Komarek, Lesaffre, and Legrand (2007).
##
## R commands available in the documentation
## directory of this package
##  - ex-tandmobPA.R and
##    https://www2.karlin.mff.cuni.cz/~komarek/software/bayesSurv/ex-tandmobPA.pdf
##  - ex-tandmobCS.R and
##    https://www2.karlin.mff.cuni.cz/~komarek/software/bayesSurv/ex-tandmobCS.pdf
##  - ex-eortc.R and
##    https://www2.karlin.mff.cuni.cz/~komarek/software/bayesSurv/ex-eortc.pdf
</code></pre>


</div>