<div class="container">

<table style="width: 100%;"><tr>
<td>whitening</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Decorrelates an EMG signal
</h2>

<h3>Description</h3>

<p>Decorrelates an <abbr><span class="acronym">EMG</span></abbr> signal using an <abbr><span class="acronym">SVD</span></abbr> decomposition of a covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">whitening(data, channel, method = c("PCA", "ZCA"), k = 4, r = 1, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an ‘emg’ object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>the whitening method to be applied to the <abbr><span class="acronym">EMG</span></abbr> signal: "PCA" (default) or "ZCA" (see ‘References’).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>number of columns (see ‘Details’) to construct the covariance matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>column to be used as the whitened signal (see ‘Details’).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Whitening an <abbr><span class="acronym">EMG</span></abbr> signal is a preprocessing step that can improve amplitude estimation, onset activation detection and fecature classification.
</p>
<p>A whitening transformation reduces autocorrelation within a signal.
</p>
<p>The implemented methods are PCA and ZCA, both based on a <abbr><span class="acronym">SVD</span></abbr> decomposition of a covariance matrix.  The (artificial) matrix is constructed with k shifted versions of the <abbr><span class="acronym">EMG</span></abbr> signal.  The result is then an matrix with <code>k</code> columns. The output of the whitening procedure is (usually) the first column (<code>r=1</code>).
</p>


<h3>Value</h3>

<p>An ‘emg’ object storing the whitened <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Note</h3>

<p>The output is not fully whitened. The method decorrelates the columns of the artificial matrix, which contains a shifted version of the signal. At the end only one column (which can be autocorrelated) is taken as the output.
Also, it works better when the sampling rate is high (low sampling rates tend to produce decorrelated samples).
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Implementing PCA/Whitening <a href="http://ufldl.stanford.edu/wiki/index.php/Implementing_PCA/Whitening">http://ufldl.stanford.edu/wiki/index.php/Implementing_PCA/Whitening</a>
</p>


<h3>See Also</h3>

<p><code>dcbiasremoval</code>, <code>highpass</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# Whitening x
y &lt;- whitening(x)

# change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# plot the original channel and the corresponding whitened channel
plot(x, main = "Original  channel")
plot(y, main = "Whitened channel")

# reset graphical parameters
par(op)
</code></pre>


</div>