<div class="container">

<table style="width: 100%;"><tr>
<td>pwsd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Politis and White (2004) Spectral Density "PWSD" Automatic Block-Length Selection</h2>

<h3>Description</h3>

<p>Run the Automatic Block-Length selection method proposed by Politis and White
(2004) and corrected in Patton, Politis, and White (2009). The method is
based on spectral density estimation via flat-top lag windows of Politis and
Romano (1995). This code was adapted from <code>b.star</code> to add
functionality and include correlogram support including an S3 method,
<em>see</em> Hayfield and Racine (2008).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwsd(
  data,
  K_N = NULL,
  M_max = NULL,
  m_hat = NULL,
  b_max = NULL,
  c = NULL,
  round = FALSE,
  correlogram = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an <code class="reqn">n x k</code> data.frame, matrix, or vector (if <code class="reqn">k = 1</code>)
where the optimal block-length will be computed for each of the <code class="reqn">k</code>
columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_N</code></td>
<td>
<p>an integer value, the maximum lags for the auto-correlation,
<code class="reqn">rho_k</code>, which to apply the <em>implied hypothesis</em> test. Defaults to
<code>max(5, log(N))</code>. <em>See</em> Politis and White (2004) footnote c.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_max</code></td>
<td>
<p>an integer value, the upper-bound for the optimal number of lags,
<code class="reqn">M</code>, to compute the auto-covariance for. <em>See</em> Theorem 3.3 (ii) of
Politis and White (2004).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_hat</code></td>
<td>
<p>an integer value, if set to <code>NULL</code> (the default), then
<code>m_hat</code> is estimated as the smallest integer after which the correlogram
appears negligible for <code>K_N</code> lags. In problematic cases, setting
<code>m_hat</code> to an integer value can be used to override the estimation
procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_max</code></td>
<td>
<p>a numeric value, the upper-bound for the optimal block-length.
Defaults to <code>ceiling(min(3 * sqrt(n), n / 3))</code> per Politis and White
(2004).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>a numeric value, the constant which acts as the significance level
for the implied hypothesis test. Defaults to <code>qnorm(0.975)</code> for a
two-tailed 95% confidence level. Politis and  White (2004) suggest
<code>c = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p>a logical value, if set to <code>FALSE</code> then the final
block-length output will not be rounded, the default. If set to <code>TRUE</code>
the final estimates for the optimal block-length will be rounded to whole
numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlogram</code></td>
<td>
<p>a logical value, if set to <code>TRUE</code> a plot of the
correlogram (<em>i.e.</em> a plot of <code class="reqn">R(k)</code> vs. <code class="reqn">k</code>) will be output to
the console. If set to <code>FALSE</code>, no interim plots will be output to the
console, but may be plotted later using the corresponding S3 method,
plot.pwsd.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class 'pwsd'
</p>


<h3>References</h3>

<p>Andrew Patton, Dimitris N. Politis &amp; Halbert White (2009) Correction to
"Automatic Block-Length Selection for the Dependent Bootstrap" by D.
Politis and H. White, Econometric Review, 28:4, 372-375, DOI:
doi: <a href="https://doi.org/10.1080/07474930802459016">10.1080/07474930802459016</a>
</p>
<p>Dimitris N. Politis &amp; Halbert White (2004) Automatic Block-Length Selection
for the Dependent Bootstrap, Econometric Reviews, 23:1, 53-70, DOI:
doi: <a href="https://doi.org/10.1081/ETC-120028836">10.1081/ETC-120028836</a>
</p>
<p>Politis, D.N. and Romano, J.P. (1995), Bias-Corrected Nonparametric Spectral
Estimation. Journal of Time Series Analysis, 16: 67-103, DOI:
doi: <a href="https://doi.org/10.1111/j.1467-9892.1995.tb00223.x">10.1111/j.1467-9892.1995.tb00223.x</a>
</p>
<p>Tristen Hayfield and Jeffrey S. Racine (2008). Nonparametric Econometrics:
The np Package. Journal of Statistical Software 27(5). DOI:
doi: <a href="https://doi.org/10.18637/jss.v027.i05">10.18637/jss.v027.i05</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate AR(1) time series
sim &lt;- stats::arima.sim(list(order = c(1, 0, 0), ar = 0.5),
                        n = 500, innov = rnorm(500))

# Calculate optimal block length for series
pwsd(sim, round = TRUE)


# Use S3 Method
b &lt;- pwsd(sim, round = TRUE, correlogram = FALSE)
plot(b)

</code></pre>


</div>