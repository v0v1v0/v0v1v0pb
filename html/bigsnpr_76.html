<div class="container">

<table style="width: 100%;"><tr>
<td>snp_plinkKINGQC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Relationship-based pruning</h2>

<h3>Description</h3>

<p>Quality Control based on KING-robust kinship estimator. More information can
be found at <a href="https://www.cog-genomics.org/plink/2.0/distance#king_cutoff">https://www.cog-genomics.org/plink/2.0/distance#king_cutoff</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snp_plinkKINGQC(
  plink2.path,
  bedfile.in,
  bedfile.out = NULL,
  thr.king = 2^-3.5,
  make.bed = TRUE,
  ncores = 1,
  extra.options = "",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>plink2.path</code></td>
<td>
<p>Path to the executable of PLINK 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bedfile.in</code></td>
<td>
<p>Path to the input bedfile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bedfile.out</code></td>
<td>
<p>Path to the output bedfile. Default is created by
appending <code>"_norel"</code> to <code>prefix.in</code> (<code>bedfile.in</code> without extension).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr.king</code></td>
<td>
<p>Note that KING kinship coefficients are scaled such that
duplicate samples have kinship 0.5, not 1. First-degree relations
(parent-child, full siblings) correspond to ~0.25, second-degree relations
correspond to ~0.125, etc. It is conventional to use a cutoff of ~0.354
(2^-1.5, the geometric mean of 0.5 and 0.25) to screen for monozygotic
twins and duplicate samples, ~0.177 (2^-2.5) to remove first-degree
relations as well, and ~0.0884 (2^-3.5, <strong>default</strong>) to remove
second-degree relations as well, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make.bed</code></td>
<td>
<p>Whether to create new bed/bim/fam files (default).
Otherwise, returns a table with coefficients of related pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores used. Default doesn't use parallelism.
You may use <code>bigstatsr::nb_cores()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra.options</code></td>
<td>
<p>Other options to be passed to PLINK2 as a string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to show PLINK log? Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>See parameter <code>make-bed</code>.
</p>


<h3>References</h3>

<p>Manichaikul, Ani, Josyf C. Mychaleckyj, Stephen S. Rich, Kathy Daly,
Michele Sale, and Wei-Min Chen. "Robust relationship inference in genome-wide
association studies." Bioinformatics 26, no. 22 (2010): 2867-2873.
</p>


<h3>See Also</h3>

<p>download_plink2 snp_plinkQC
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

bedfile &lt;- system.file("extdata", "example.bed", package = "bigsnpr")
plink2 &lt;- download_plink2(AVX2 = FALSE)

bedfile2 &lt;- snp_plinkKINGQC(plink2, bedfile,
                            bedfile.out = tempfile(fileext = ".bed"),
                            ncores = 2)

df_rel &lt;- snp_plinkKINGQC(plink2, bedfile, make.bed = FALSE, ncores = 2)
str(df_rel)

## End(Not run)

</code></pre>


</div>