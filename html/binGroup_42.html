<div class="container">

<table style="width: 100%;"><tr>
<td>hierarchical.desc2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Operating characteristics for hierarchical group testing</h2>

<h3>Description</h3>

<p>Calculate operating characteristics for hierarchical 
group testing with up to four stages, given a vector of individual 
probabilities and a testing configuration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hierarchical.desc2(p, I2 = NULL, I3 = NULL, se = 1, sp = 1,
  order.p = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities corresponding to each individual's 
risk of disease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I2</code></td>
<td>
<p>a numeric vector of pool sizes for stage 2 testing (used in 
hierarchical testing with at least three stages).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I3</code></td>
<td>
<p>a numeric vector of pool sizes for stage 3 testing (used in 
hierarchical testing with at least four stages).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the sensitivity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>the specificity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.p</code></td>
<td>
<p>a logical value indicating whether the vector of 
individual probabilities needs to be sorted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the operating characteristics for
hierarchical group testing with up to four stages of testing. 
Operating characteristics calculated are expected number of tests, 
and pooling sensitivity, pooling specificity, pooling positive 
predictive value, and pooling negative predictive value, for each 
individual and for the configuration overall.
</p>
<p>If <kbd>I2</kbd> is NULL, there are two stages of testing. If <kbd>I3</kbd> 
is NULL but <kbd>I2</kbd> has values, there are three stages of testing.
If both <kbd>I2</kbd> and <kbd>I3</kbd> have values, there are four stages 
of testing.
</p>
<p>Vectors <kbd>I2</kbd> and <kbd>I3</kbd> should be entered using notation
that keeps track of all individuals through all stages (e.g. for
a group of 10 individuals that splits into 5, 4, and 1 individual
at stage 2, then into 3, 2, 2, 1, and 1 individual at stage 3
before individual testing at stage 4, then I2=c(5,4,1) and 
I3=c(3,2,2,1,1,1) so that the specimen that was tested 
individually at stage 2 is still numbered at stage 3 even though
it will not be tested again).
</p>
<p>The displayed pooling sensitivity, pooling specificity, pooling positive 
predictive value, and pooling negative predictive value are weighted 
averages of the corresponding individual accuracy measures for all 
individuals within the initial group for a hierarchical algorithm.
Expressions for these averages are provided in the Supplementary 
Material for Hitt et al. (2018). These expressions are based on accuracy 
definitions given by Altman and Bland (1994a, 1994b).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ET</code></td>
<td>
<p>the expected number of tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stages</code></td>
<td>
<p>the number of stages in the testing algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.size</code></td>
<td>
<p>the total number of individuals tested in the 
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I2</code></td>
<td>
<p>pool sizes for the second stage of testing, or
"individual testing" if there are only two stages of testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I3</code></td>
<td>
<p>pool sizes for the third stage of testing, or
"individual testing" if there are only three stages of testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>the initial (stage 1) group size for two stage testing, 
or the number of subgroups originating from the initial group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>the number of subgroups for each preceding group 
containing more than one individual, or "individual testing" 
if there are only two stages of testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m3</code></td>
<td>
<p>the number of subgroups for each preceding group 
containing more than one individual, or "individual testing" 
if there are only three stages of testing. NULL if there are 
only two stages of testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual.testerror</code></td>
<td>
<p>a data frame containing:
</p>

<dl>
<dt>pse.vec</dt>
<dd>
<p>a vector containing each individual's pooling 
sensitivity.</p>
</dd>
<dt>psp.vec</dt>
<dd>
<p>a vector containing each individual's pooling 
specificity.</p>
</dd>
<dt>pppv.vec</dt>
<dd>
<p>a vector containing each individual's pooling 
positive predictive value.</p>
</dd>
<dt>pnpv.vec</dt>
<dd>
<p>a vector containing each individual's pooling
negative predictive value.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.testerror</code></td>
<td>
<p>a vector containing:
</p>

<dl>
<dt>PSe</dt>
<dd>
<p>the overall pooling sensitivity for the algorithm. 
Further details are given under 'Details'.</p>
</dd>
<dt>PSp</dt>
<dd>
<p>the overall pooling specificity for the algorithm. 
Further details are given under 'Details'.</p>
</dd>
<dt>PPPV</dt>
<dd>
<p>the overall pooling positive predictive value 
for the algorithm. Further details are given under 'Details'.</p>
</dd>
<dt>PNPV</dt>
<dd>
<p>the overall pooling negative predictive value
for the algorithm. Further details are given under 'Details'.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individual.probabilities</code></td>
<td>
<p>a vector containing each 
individual's probability of disease. If <kbd>order.p=TRUE</kbd>, this
is the sorted vector of individual probabilities.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function returns the pooling positive and negative
predictive values for all individuals even though these measures are 
diagnostic specific; i.e., PPPV (PNPV) should only be considered
for those individuals who have tested positive (negative).
</p>


<h3>Author(s)</h3>

<p>This function was originally written by Michael S. 
Black for Black et al. (2015). The function was obtained from 
<a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a>. Minor modifications were made 
to the function for inclusion in the binGroup package.
</p>


<h3>References</h3>

<p>Black, M., Bilder, C., Tebbs, J. (2015).
“Optimal retesting configurations for hierarchical group testing.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>64</b>(4), 693–710.
ISSN 14679876, doi: <a href="https://doi.org/10.1111/rssc.12097">10.1111/rssc.12097</a>.
</p>


<h3>See Also</h3>

<p><code>Array.Measures</code> for calculating operating characteristics
under array testing without master pooling, 
<code>MasterPool.Array.Measures</code> for non-informative array 
testing with master pooling, and <code>inf.dorf.measures</code> 
for informative two-stage hierarchical testing. See 
<code>p.vec.func</code> for generating a vector of 
individual risk probabilities for informative group testing.  
</p>
<p><a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a>
</p>
<p>Other Operating characteristic functions: <code>Array.Measures</code>,
<code>MasterPool.Array.Measures</code>,
<code>inf.dorf.measures</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the operating characteristics for 
#   non-informative two-stage hierarchical testing
#   with an overall disease prevalence of p = 0.015
#   and an initial group size of 12.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
p.vec &lt;- rep(x=0.015, times=12)
hierarchical.desc2(p=p.vec, I2=NULL, I3=NULL, se=0.95, 
sp=0.95, order.p=FALSE)

# Calculate the operating characteristics for 
#   non-informative three-stage hierarchical testing
#   with an overall disease prevalence of p = 0.04, 
#   where an initial group of 20 individuals is 
#   split into equally sized subgroups of 5 each.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
p.vec &lt;- rep(x=0.04, times=20)
hierarchical.desc2(p=p.vec, I2=rep(x=5, times=4),
I3=NULL, se=0.99, sp=0.99, order.p=FALSE)

# Calculate the operating characteristics for 
#   informative three-stage hierarchical testing
#   where an initial group of 10 individuals is 
#   split into subsequent groups of 5, 4, and 1 
#   individual.
# A vector of individual probabilities is generated using
#   the expected value of order statistics from a beta 
#   distribution with p = 0.02 and a heterogeneity level 
#   of alpha = 0.5. Depending on the specified probability, 
#   alpha level, and overall group size, simulation may 
#   be necessary in order to generate the vector of individual
#   probabilities. This is done using p.vec.func() and 
#   requires the user to set a seed in order to reproduce 
#   results.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
set.seed(1002)
p.vec &lt;- p.vec.func(p=0.02, alpha=0.5, grp.sz=10)
hierarchical.desc2(p=p.vec, I2=c(5,4,1), I3=NULL,
se=0.90, sp=0.90, order.p=TRUE)
</code></pre>


</div>