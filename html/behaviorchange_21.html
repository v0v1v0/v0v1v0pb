<div class="container">

<table style="width: 100%;"><tr>
<td>complecs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a COMPLECS graph</h2>

<h3>Description</h3>

<p>COMPLECS was developed to help make sense of complex systems. It reads data from a
number of worksheets in a spreadsheet and generates a diagram according to those
specifications. Originally, COMPLECS was developed to visualise a problem during
the needs assessment phase of intervention development.
</p>


<h3>Usage</h3>

<pre><code class="language-R">complecs(
  input,
  title = "COMPLECS overview",
  layout = "fdp",
  graph_styling = list(c("outputorder", "edgesfirst", "graph"), c("overlap", "false",
    "graph"), c("fixedsize", "false", "node"), c("fontname", "Arial", "graph"),
    c("fontname", "Arial", "node"), c("fontname", "Arial", "edge"), c("headclip", "true",
    "edge"), c("tailclip", "false", "edge")),
  directed = TRUE,
  outputFile = NULL,
  outputWidth = 1600,
  outputHeight = NULL,
  returnDotOnly = FALSE,
  returnSvgOnly = FALSE,
  returnGraphOnly = TRUE,
  maxLabelLength = 20,
  regExReplacements = opts$get("diagrammerSanitization"),
  silent = opts$get("silent")
)

## S3 method for class 'complecs'
print(
  x,
  width = x$input$width,
  height = x$input$height,
  title = DiagrammeR::get_graph_name(x$output$graph),
  ...
)

## S3 method for class 'complecs'
print(
  x,
  width = x$input$width,
  height = x$input$height,
  title = DiagrammeR::get_graph_name(x$output$graph),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>Either a link to a Google Sheet, or a path to an Excel file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>The title of the COMPLECS graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>The layout to use; has to be one of the <code>DiagrammeR</code> layout
types (<code>dot</code>, <code>neato</code>, <code>circo</code> and <code>twopi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph_styling</code></td>
<td>
<p>Additional styling to apply; a list with three-element
vectors, where the three elements correspond to, respectively, the <code>attr</code>,
<code>value</code>, and <code>attr_type</code> arguments for <code>DiagrammeR::add_global_graph_attrs()</code>.
Note that these attributes may override attributes specified in the COMPLECS
specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directed</code></td>
<td>
<p>Whether to draw directed arrows or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputFile</code></td>
<td>
<p>A character vector where each element is one path (including
filename) to write the graph to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputWidth, outputHeight</code></td>
<td>
<p>If not <code>NULL</code>, a way to override the width and
height when calling <code>complecs</code> to generate a COMPLECS overview.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnDotOnly</code></td>
<td>
<p>Whether to only return the produced DOT code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnSvgOnly</code></td>
<td>
<p>Whether to only return the SVG in a character vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnGraphOnly</code></td>
<td>
<p>Whether to only return the produced graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxLabelLength</code></td>
<td>
<p>The number of characters where to wrap the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regExReplacements</code></td>
<td>
<p>A list of pairs of regular
expressions that will be applied to the specifications
before generating the ABCD. This can be used to sanitize
problematic characters (e.g. ', " and \).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Whether to be chatty or silent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The object to print (i.e. a result of a call to <code>complecs</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width, height</code></td>
<td>
<p>If not <code>NULL</code>, a way to override the width and
height when calling <code>print</code> to print a COMPLECS overview.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any additional arguments for the <code>print()</code> method are passed
to <code>DiagrammeR::render_graph()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>COMPLECS is a recursive acronym for COMPLECS Organises Multiple Players &amp; Linked
Environments using Connected Specifications.
</p>


<h3>Value</h3>

<p>A <code>complecs</code> object that includes the graph and the graph in SVG in
<code>output$graph</code> and <code>output$graphSvg</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
### Path in the package with example COMPLECS
exampleCOMPLECS &lt;-
  system.file(
    "extdata",
    "COMPLECS-spec-example.xlsx",
    package = "behaviorchange"
  );

behaviorchange::complecs(
  exampleCOMPLECS
);

### Loading that COMPLECS from a google sheet - but note that
### this requires an internet connection!
behaviorchange::complecs(
  paste0(
    "https://docs.google.com/spreadsheets/d/",
    "1WMO15xroy4a0RfpuZ8GhT-NfDoxwS34w9PrWp8rGjjk"
  )
);

## End(Not run)
</code></pre>


</div>