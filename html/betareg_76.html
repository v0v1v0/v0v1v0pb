<div class="container">

<table style="width: 100%;"><tr>
<td>betamix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finite Mixtures of Beta Regression for Rates and Proportions</h2>

<h3>Description</h3>

<p>Fit finite mixtures of beta regression models for rates and
proportions via maximum likelihood with the EM algorithm using a
parametrization with mean (depending through a link function on the
covariates) and precision parameter (called phi).
</p>


<h3>Usage</h3>

<pre><code class="language-R">betamix(formula, data, k, subset, na.action, weights, offset,
  link = c("logit", "probit", "cloglog", "cauchit", "log",
    "loglog"), link.phi = "log",
  control = betareg.control(...), cluster = NULL,
  FLXconcomitant = NULL, FLXcontrol = list(), verbose = FALSE,
  nstart = if (is.null(cluster)) 3 else 1, which = "BIC", 
  ID, fixed, extra_components, ...)

extraComponent(type = c("uniform", "betareg"), coef, delta,
  link = "logit", link.phi = "log")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>symbolic description of the model (of type <code>y ~ x</code>
or <code>y ~ x | z</code>; for details see <code>betareg</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data, subset, na.action</code></td>
<td>
<p>arguments controlling formula processing
via <code>model.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>optional numeric vector of integer case weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>optional numeric vector with an a priori known component to be
included in the linear predictor for the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a vector of integers indicating the number of components of
the finite mixture; passed in turn to the <code>k</code> argument
of <code>stepFlexmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>character specification of the link function in
the mean model (mu). Currently, <code>"logit"</code>, <code>"probit"</code>,
<code>"cloglog"</code>, <code>"cauchit"</code>, <code>"log"</code>, <code>"loglog"</code> are supported.
Alternatively, an object of class <code>"link-glm"</code> can be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.phi</code></td>
<td>
<p>character specification of the link function in
the precision model (phi). Currently, <code>"identity"</code>,
<code>"log"</code>, <code>"sqrt"</code> are supported. The default is <code>"log"</code>
unless <code>formula</code> is of type <code>y ~ x</code> where the default is
<code>"identity"</code> (for backward compatibility).
Alternatively, an object of class <code>"link-glm"</code> can be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control arguments specified via
<code>betareg.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Either a matrix with <code>k</code> columns of initial
cluster membership probabilities for each observation; or a factor
or integer vector with the initial cluster
assignments of observations at the start of the EM
algorithm. Default is random assignment into <code>k</code>
clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FLXconcomitant</code></td>
<td>
<p>concomitant variable model; object of class
<code>FLXP</code>. Default is the object returned by calling
<code>FLXPconstant</code>.
The argument <code>FLXconcomitant</code> can be omitted if <code>formula</code>
is a three-part formula of type <code>y ~ x | z | w</code>, where <code>w</code>
specificies the concomitant variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FLXcontrol</code></td>
<td>
<p>object of class <code>"FLXcontrol"</code> or a named list;
controls the EM algorithm and passed in turn to the <code>control</code>
argument of <code>flexmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical; if <code>TRUE</code> progress information is shown
for different starts of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>for each value of <code>k</code> run
<code>stepFlexmix</code> <code>nstart</code> times and keep only
the solution with maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>number of model to get if <code>k</code> is a vector of
integers longer than one. If character, interpreted as
number of components or name of an information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>grouping variable indicating if observations are from the same
individual, i.e. the component membership is restricted to be the
same for these observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>symbolic description of the model for the parameters
fixed over components (of type <code>~ x | z</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra_components</code></td>
<td>
<p>a list containing objects returned by
<code>extraComponent()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>betareg.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>specifies if the component follows a uniform distribution
or a beta regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>a vector with the coefficients to determine the midpoint
of the uniform distribution or names list with the coefficients for
the mean and precision of the beta regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>numeric; half-length of the interval of the uniform
distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The arguments and the model specification are similar to
<code>betareg</code>. Internally <code>stepFlexmix</code>
is called with suitable arguments to fit the finite mixture model with
the EM algorithm. See Grün et al. (2012) for more details.
</p>
<p><code>extra_components</code> is a list where each element corresponds to a
component where the parameters are fixed a-priori.
</p>


<h3>Value</h3>

<p>An object of class <code>"flexmix"</code> containing the best model with
respect to the log likelihood or the one selected according to
<code>which</code> if <code>k</code> is a vector of integers longer than 1.
</p>


<h3>Author(s)</h3>

<p>Bettina Grün and Achim Zeileis
</p>


<h3>References</h3>

<p>Cribari-Neto F, Zeileis A (2010). Beta Regression in R.
<em>Journal of Statistical Software</em>, <b>34</b>(2), 1–24.
<a href="https://doi.org/10.18637/jss.v034.i02">doi:10.18637/jss.v034.i02</a>
</p>
<p>Grün B, Kosmidis I, Zeileis A (2012).
Extended Beta Regression in R: Shaken, Stirred, Mixed, and Partitioned.
<em>Journal of Statistical Software</em>, <b>48</b>(11), 1–25.
<a href="https://doi.org/10.18637/jss.v048.i11">doi:10.18637/jss.v048.i11</a>
</p>
<p>Grün B, Leisch F (2008). FlexMix Version 2: Finite Mixtures
with Concomitant Variables and Varying and Constant Parameters.
<em>Journal of Statistical Software</em>, <b>28</b>(4), 1–35.
<a href="https://doi.org/10.18637/jss.v028.i04">doi:10.18637/jss.v028.i04</a>
</p>
<p>Leisch F (2004). FlexMix: A General Framework for Finite Mixture
Models and Latent Class Regression in R.
<em>Journal of Statistical Software</em>, <b>11</b>(8), 1–18.
<a href="https://doi.org/10.18637/jss.v011.i08">doi:10.18637/jss.v011.i08</a>
</p>


<h3>See Also</h3>

<p><code>betareg</code>, <code>flexmix</code>,
<code>stepFlexmix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">options(digits = 4)

## data with two groups of dyslexic and non-dyslexic children
data("ReadingSkills", package = "betareg")

suppressWarnings(RNGversion("3.5.0"))
set.seed(4040)
## try to capture accuracy ~ iq relationship (without using dyslexia
## information) using two beta regression components and one additional
## extra component for a perfect reading score
rs_mix &lt;- betamix(accuracy ~ iq, data = ReadingSkills, k = 3,
  nstart = 10, extra_components = extraComponent(type = "uniform",
  coef = 0.99, delta = 0.01))

## visualize result
## intensities based on posterior probabilities
prob &lt;- 2 * (posterior(rs_mix)[cbind(1:nrow(ReadingSkills),
   clusters(rs_mix))] - 0.5)
## associated HCL colors
col0 &lt;- hcl(c(260, 0, 130), 65, 45, fixup = FALSE)
col1 &lt;- col0[clusters(rs_mix)]
col2 &lt;- hcl(c(260, 0, 130)[clusters(rs_mix)], 65 * abs(prob)^1.5,
   95 - 50 * abs(prob)^1.5, fixup = FALSE)
## scatter plot
plot(accuracy ~ iq, data = ReadingSkills, col = col2, pch = 19,
   cex = 1.5, xlim = c(-2, 2))
points(accuracy ~ iq, data = ReadingSkills, cex = 1.5, pch = 1,
   col = col1)
## fitted lines
iq &lt;- -30:30/10
cf &lt;- rbind(coef(rs_mix, model = "mean", component = 1:2),
   c(qlogis(0.99), 0))
for(i in 1:3)
   lines(iq, plogis(cf[i, 1] + cf[i, 2] * iq), lwd = 2,
         col = col0[i])

## refit the model including a concomitant variable model using the
## dyslexia information with some noise to avoid complete separation
## between concomitant variable and component memberships
set.seed(4040)
w &lt;- rnorm(nrow(ReadingSkills), 
           c(-1, 1)[as.integer(ReadingSkills$dyslexia)])

## The argument FLXconcomitant can be omitted when specifying
## the model via a three part formula given by
## accuracy ~ iq | 1 | w
## The posteriors from the previously fitted model are used
## for initialization.
library("flexmix")
rs_mix2 &lt;- betamix(accuracy ~ iq, data = ReadingSkills,
  extra_components = extraComponent(type = "uniform",
  coef = 0.99, delta = 0.01), cluster = posterior(rs_mix),
  FLXconcomitant = FLXPmultinom(~w))
coef(rs_mix2, which = "concomitant")
summary(rs_mix2, which = "concomitant")
</code></pre>


</div>