<div class="container">

<table style="width: 100%;"><tr>
<td>optim.boxcox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Response Transformations for Random Effect and Variance Component Models</h2>

<h3>Description</h3>

<p>The <code>optim.boxcox()</code> performs a grid search over the parameter <code>lambda</code>
for overdispersed generalized linear models and variance component models and 
then optimizes over this grid, to calculate the maximum likelihood estimator of
the transformation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optim.boxcox(
  formula,
  groups = 1,
  data,
  K = 3,
  steps = 500,
  tol = 0.5,
  start = "gq",
  EMdev.change = 1e-04,
  find.in.range = c(-3, 3),
  s = 60,
  plot.opt = 3,
  verbose = FALSE,
  noformat = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>the random effects. To fit overdispersion models, set <code>groups</code> = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of mass points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a positive scalar (usually, 0&lt;<code>tol</code> &lt;= 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version "quantile" or Gaussian Quadrature "gq" can be
set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find.in.range</code></td>
<td>
<p>search in a range of <code>lambda</code>, with default (-3,3)
in step of 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>number of points in the grid search of <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>Set <code>plot.opt=3</code>, to plot the disparity against
iteration number and the profile log-likelihood against <code>lambda</code>. 
Use <code>plot.opt=0</code>, to only plot the profile log-likelihood against <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noformat</code></td>
<td>
<p>Set <code>noformat = TRUE</code>, to change the formatting of the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Box-Cox transformation (Box &amp; Cox, 1964) is applied to the overdispersed
generalized linear models and variance component models with an unspecified
mixing distribution. The NPML estimate of the mixing distribution is known
to be a discrete distribution involving a finite number of mass-points and corresponding
masses (Aitkin et al., 2009). An Expectation-Maximization (EM) algorithm is
used for fitting the finite mixture distribution, one needs to specify the
number of components <code>K</code> of the finite mixture in advance. To stop the EM-algorithm when it reached its convergence point,
we need to defined the convergence criteria that is the absolute change in 
the successive log-likelihood function values being less than an arbitrary 
parameter such as <code>EMdev.change</code> = 0.0001 (Einbeck et
at., 2014). This algorithm can be implemented using
the function <code>np.boxcoxmix()</code>, which is designed to account for overdispersed generalized
linear models and variance component models using the non-parametric
profile maximum likelihood (NPPML) estimation.
</p>
<p>The ability of the EM algorithm to locate the global maximum in fewer iterations
can be affected by the choice of initial values, the function <code>optim.boxcox()</code> 
allows us to choose from two different methods to set the initial value of the mass
points. When option "gq" is set, then Gauss-Hermite masses and mass points are used
as starting points in the EM algorithm, while setting start= "quantile" uses the 
Quantile-based version to select the starting points. 
</p>
<p><code>optim.boxcox()</code> performs a grid search over the parameter <code>lambda</code> and then
optimizes over this grid, to calculate the maximum likelihood estimator of the transformation.
It produces a plot of the non-parametric profile likelihood function that summarises information
concerning <code>lambda</code>, including a vertical line indicating the best value of <code>lambda</code>
that maximizes the non-parametric profile log-likelihood.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>All.lambda</code></td>
<td>
<p>list of <code>lambda</code> values used in the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Maximum</code></td>
<td>
<p>the best estimate of <code>lambda</code> found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>the value of the profile
log-likelihood corresponding to Maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMconverged</code></td>
<td>
<p>1 is TRUE, means the EM algorithm converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMiteration</code></td>
<td>
<p>provides the number of iterations of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass.point</code></td>
<td>
<p>the fitted mass points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the masses corresponding to the mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the
vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the standard deviation of the mixing distribution (the square root of the variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the standard error of the estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a matrix of posterior probabilities that element i comes from cluster k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the profile log-likelihood of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile.loglik</code></td>
<td>
<p>the profile complete log-likelihood of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disparity</code></td>
<td>
<p>the disparity of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>the fitted values for the individual observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.transformed</code></td>
<td>
<p>the fitted values for
the individual transformed observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the difference between the observed values and the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals.transformed</code></td>
<td>
<p>the difference between the transformed observed values and the transformed fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predicted.re</code></td>
<td>
<p>a vector of predicted residuals.</p>
</td>
</tr>
</table>
<p>The other outcomes are not relevant to users and they are intended for internal use only.
</p>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>


<h3>See Also</h3>

<p><code>np.boxcoxmix</code>,
<code>tolfind.boxcox</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The strength Data
data(strength, package = "mdscore")
maxlam &lt;- optim.boxcox(y ~ cut*lot, data = strength, K = 3,  
           start = "gq" ,  find.in.range = c(-2, 2), s = 5)
# Maximum profile log-likelihood: 33.6795 at lambda= -0.4  

data(Oxboys, package = "nlme")
Oxboys$boy &lt;- gl(26,9)
maxlamvc &lt;- optim.boxcox(height ~  age, groups = Oxboys$boy,
                         data = Oxboys,   K = 2,  start = "gq",
                         find.in.range=c(-1.2,1), s=6, plot.opt = 0) 
maxlamvc$Maximum
#[1] -0.8333333
plot(maxlamvc,8)





</code></pre>


</div>