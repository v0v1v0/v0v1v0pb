<div class="container">

<table style="width: 100%;"><tr>
<td>bayessurvreg2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cluster-specific accelerated failure time model for multivariate,
possibly doubly-interval-censored data. The error distribution is
expressed as a penalized univariate normal mixture with high number of
components (G-spline). The distribution of the vector of random
effects is multivariate normal.  
</h2>

<h3>Description</h3>

<p>A function to estimate a regression model with possibly clustered
(possibly right, left, interval or doubly-interval censored) data.
In the case of doubly-interval censoring, different regression models
can be specified for the onset and event times.
</p>
<p>(Multivariate) random effects, normally distributed and  acting as
in the linear mixed model, normally distributed, can be included to
adjust for clusters.
</p>
<p>The error density of the regression model is specified as a mixture of
Bayesian G-splines (normal densities with equidistant means and
constant variances). This function performs an MCMC sampling from the
posterior distribution of unknown quantities.
</p>
<p>For details, see Komárek (2006),
and Komárek, Lesaffre and Legrand (2007).
</p>
<p>We explain first in more detail a model without doubly censoring.
Let <code class="reqn">T_{i,l},\; i=1,\dots, N,\; l=1,\dots, n_i</code>
be event times for <code class="reqn">i</code>th cluster and the units within that cluster
The following regression model is assumed:
</p>
<p style="text-align: center;"><code class="reqn">\log(T_{i,l}) = \beta'x_{i,l} + b_i'z_{i,l} + \varepsilon_{i,l},\quad i=1,\dots, N,\;l=1,\dots, n_i</code>
</p>

<p>where <code class="reqn">\beta</code> is unknown regression parameter vector,
<code class="reqn">x_{i,l}</code> is a vector of covariates.
<code class="reqn">b_i</code> is a (multivariate) cluster-specific random effect
vector and <code class="reqn">z_{i,l}</code> is a vector of covariates for random
effects.
</p>
<p>The random effect vectors <code class="reqn">b_i,\;i=1,\dots, N</code>
are assumed to be i.i.d. with a (multivariate) normal distribution
with the mean <code class="reqn">\beta_b</code> and a covariance matrix
<code class="reqn">D</code>. Hierarchical centring (see Gelfand, Sahu, Carlin, 1995) is
used. I.e. <code class="reqn">\beta_b</code> expresses the average effect of the
covariates included in <code class="reqn">z_{i,l}</code>. Note that covariates
included in <code class="reqn">z_{i,l}</code> may not be included in the covariate
vector <code class="reqn">x_{i,l}</code>. The covariance matrix <code class="reqn">D</code> is
assigned an inverse Wishart prior distribution in the next level of hierarchy.
</p>
<p>The error terms
<code class="reqn">\varepsilon_{i,l},\;i=1,\dots, N, l=1,\dots, n_i</code>
are assumed to be i.i.d. with a univariate density
<code class="reqn">g_{\varepsilon}(e)</code>. This density is expressed as
a mixture of Bayesian G-splines (normal densities with equidistant
means and constant variances). We distinguish two,
theoretically equivalent, specifications.
</p>

<dl>
<dt>Specification 1</dt>
<dd>
<p style="text-align: center;"><code class="reqn">\varepsilon \sim
	\sum_{j=-K}^{K} w_{j} N(\mu_{j},\,\sigma^2)</code>
</p>

<p>where <code class="reqn">\sigma^2</code> is the
<b>unknown</b> basis variance and
<code class="reqn">\mu_{j},\;j=-K,\dots, K</code>
is an equidistant grid of knots symmetric around the
<b>unknown</b> point <code class="reqn">\gamma</code> 
and related to the unknown basis variance through the
relationship
</p>
<p style="text-align: center;"><code class="reqn">\mu_{j} = \gamma + j\delta\sigma,\quad j=-K,\dots,K,</code>
</p>

<p>where <code class="reqn">\delta</code> is fixed
constants, e.g. <code class="reqn">\delta=2/3</code>
(which has a justification of being close to cubic B-splines).

</p>
</dd>
<dt>Specification 2</dt>
<dd>
<p style="text-align: center;"><code class="reqn">\varepsilon \sim \alpha + \tau\,V</code>
</p>

<p>where <code class="reqn">\alpha</code> is an
<b>unknown</b> intercept term and
<code class="reqn">\tau</code> is an <b>unknown</b> scale parameter.
<code class="reqn">V</code> is then
standardized error term which is distributed according
to the univariate normal mixture, i.e.
</p>
<p style="text-align: center;"><code class="reqn">V\sim \sum_{j=-K}^{K}
	w_{j} N(\mu_{j},\,\sigma^2)</code>
</p>

<p>where <code class="reqn">\mu_{j},\;j=-K,\dots, K</code>
is an equidistant grid of <b>fixed</b> knots (means), usually
symmetric about the <b>fixed</b> point <code class="reqn">\gamma=0</code> and
<code class="reqn">\sigma^2</code> is <b>fixed</b> basis variance.
Reasonable values for the numbers of grid
points <code class="reqn">K</code> is
<code class="reqn">K=15</code> with the distance between the two
knots equal to <code class="reqn">\delta=0.3</code> and for the basis
variance
<code class="reqn">\sigma^2=0.2^2.</code>
</p>
</dd>  
</dl>
<p>Personally, I found Specification 2 performing better. In the paper
Komárek, Lesaffre and Legrand (2007) only
Specification 2 is described.
</p>
<p>The mixture weights
<code class="reqn">w_{j},\;j=-K,\dots, K</code> are
not estimated directly. To avoid the constraints
<code class="reqn">0 &lt; w_{j} &lt; 1</code> and
<code class="reqn">\sum_{j=-K}^{K}\,w_j = 1</code>
transformed weights <code class="reqn">a_{j},\;j=-K,\dots, K</code>
related to the original weights by the logistic transformation:
</p>
<p style="text-align: center;"><code class="reqn">a_{j} = \frac{\exp(w_{j})}{\sum_{m}\exp(w_{m})}</code>
</p>

<p>are estimated instead.
</p>
<p>A Bayesian model is set up for all unknown parameters. For more
details I refer to Komárek (2006)
and to Komárek, Lesafre, and Legrand (2007).
</p>
<p>If there are doubly-censored data the model of the same type as above
can be specified for both the onset time and the time-to-event. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayessurvreg2(formula, random, formula2, random2,
   data = parent.frame(),
   na.action = na.fail, onlyX = FALSE,
   nsimul = list(niter = 10, nthin = 1, nburn = 0, nwrite = 10),
   prior, prior.beta, prior.b, init = list(iter = 0),
   mcmc.par = list(type.update.a = "slice", k.overrelax.a = 1,
                   k.overrelax.sigma = 1, k.overrelax.scale = 1),
   prior2, prior.beta2, prior.b2, init2,
   mcmc.par2 = list(type.update.a = "slice", k.overrelax.a = 1,
                    k.overrelax.sigma = 1, k.overrelax.scale = 1),
   store = list(a = FALSE, a2 = FALSE, y = FALSE, y2 = FALSE,
                r = FALSE, r2 = FALSE, b = FALSE, b2 = FALSE), 
   dir)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>model formula for the regression. In the case of
doubly-censored data, this is the model formula for the onset
time.
</p>
<p>The left-hand side of the <code>formula</code> must be an object created
using <code>Surv</code>.
</p>
<p>In the formula all covariates appearing both in the vector
<code class="reqn">x_{i,l}</code> and <code class="reqn">z_{i,l}</code> must be
mentioned. Intercept is implicitely included in the model by the
estimation of the error distribution. As a consequence <code>-1</code> in
the model formula does not have any effect on the model
specification.
</p>
<p>If <code>random</code> is used then the formula must contain
an identification of clusters in the form <code>cluster(id)</code>, where
<code>id</code> is a name of the variable that determines clusters, e.g.
</p>

<table><tr>
<td style="text-align: center;">
      <code>Surv(time, event) gender + cluster(id)</code>.
    </td>
</tr></table>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>formula for the ‘random’ part of the model, i.e. the
part that specifies the covariates <code class="reqn">z_{i,l}</code>. In the
case of doubly-censored data, this is the <code>random</code> formula for
the onset time.
</p>
<p>If omitted, no random part is included in the model. E.g. to specify the model with a
random intercept, say <code>random= 1</code>. All effects mentioned in
<code>random</code> should also be mentioned on the right-hand side of
<code>formula</code>.
</p>
<p>When some random effects are included the random intercept is added
by default. It can be removed using e.g. <code>random= -1 + gender</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>formula2</code></td>
<td>
<p>model formula for the regression of the time-to-event in
the case of doubly-censored data. Ignored otherwise. The same structure as
for <code>formula</code> applies here.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>random2</code></td>
<td>
<p>specification of the ‘random’ part of the model for
time-to-event in the case of doubly-censored data. Ignored
otherwise. The same structure as for <code>random</code> applies here.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>optional data frame in which to interpret the variables
occuring in the <code>formula</code>, <code>formula2</code>, <code>random</code>,
<code>random2</code> statements.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>the user is discouraged from changing the default
value <code>na.fail</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>onlyX</code></td>
<td>
<p>if <code>TRUE</code> no MCMC sampling is performed and only the
design matrix (matrices) are returned. This can be useful to set up
correctly priors for regression parameters in the presence of
<code>factor</code> covariates.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>nsimul</code></td>
<td>
<p>a list giving the number of iterations of the MCMC and
other parameters of the simulation.
</p>

<dl>
<dt>niter</dt>
<dd>
<p>total number of sampled values after discarding
thinned ones, burn-up included;</p>
</dd>
<dt>nthin</dt>
<dd>
<p>thinning interval;</p>
</dd>
<dt>nburn</dt>
<dd>
<p>number of sampled values in a burn-up period after
discarding thinned values. This value should be smaller than
<code>niter</code>. If not, <code>nburn</code> is set to <code>niter - 1</code>. It can be set to zero;</p>
</dd>
<dt>nwrite</dt>
<dd>
<p>an interval at which information about the number of
performed iterations is print on the screen and during the
burn-up period an interval with which the sampled values are
writen to files;</p>
</dd>
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list specifying the prior distribution of the G-spline
defining the distribution of the error term in the regression model
given by <code>formula</code> and <code>random</code>. See <code>prior</code> argument of
<code>bayesHistogram</code> function for more detail. In this list
also ‘Specification’ as described above is specified.
</p>
<p>The item <code>prior$neighbor.system</code> can only be equal to
<code>uniCAR</code> here.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>prior.b</code></td>
<td>
<p>a list defining the way in which the random effects
involved in <code>formula</code> and <code>random</code>
are to be updated and the specification
of priors for parameters related to these random effects. The list
is assumed to have the following components.
</p>

<dl>
<dt>prior.D</dt>
<dd>
<p>a string defining the prior distribution for the
covariance matrix of random effects <code class="reqn">D</code>. It can be either
“inv.wishart” or “sduniform”.
</p>

<dl>
<dt>inv.wishart</dt>
<dd>
<p>in that case is assumed that the prior distribution
of the matrix <code class="reqn">D</code> is Inverse-Wishart with degrees of freedom
equal to <code class="reqn">\tau</code> and a scale matrix equal to
<code class="reqn">S</code>. When <code class="reqn">D</code> is a matrix <code class="reqn">q\times q</code> a
prior expectation of <code class="reqn">D</code> is equal to
<code class="reqn">(\tau - q - 1)^{-1}S</code> if
<code class="reqn">\tau &gt; q + 1</code>. For
<code class="reqn">q - 1 &lt; \tau \leq q + 1</code> a prior
expectation is not finite.	
Degrees of freedom parameter <code class="reqn">\tau</code> does not have to be an
integer. It has to only satisfy a condition
<code class="reqn">\tau &gt; q - 1</code>. <code>prior.b$df.D</code> gives a prior
degrees of freedom parameter <code class="reqn">\tau</code> and
<code>prior.b$scale.D</code> determines the scale matrix <code class="reqn">D</code>.
Inverse-Wishart is also the default choice.
</p>
</dd>
<dt>sduniform</dt>
<dd>
<p>this can be used only when the random effect is
univariate (e.g. only random intercept in the model).
Then the matrix <code class="reqn">D</code> is just a scalar and the
prior of <code class="reqn">\sqrt{D}</code> (standard deviation of the
univariate random effect) is assumed to be uniform on interval
<code class="reqn">(0, S)</code>. The upper limit <code class="reqn">S</code> is given by <code>prior.b$scale.D</code>.
</p>
</dd>	
</dl>
</dd>  </dl>
<dl>
<dt>df.D</dt>
<dd>
<p>degrees of freedom parameter <code class="reqn">\tau</code> in the case
that the prior of the matrix <code class="reqn">D</code> is inverse-Wishart.
</p>
</dd>
<dt>scale.D</dt>
<dd>
<p>a lower triangle of the scale matrix <code class="reqn">S</code> in
the case that the prior of the matrix <code class="reqn">D</code> is
inverse-Wishart or the upper limit <code class="reqn">S</code> of the uniform distribution in
the case that <code class="reqn">\sqrt{D} \sim \mbox{Unif}(0, S)</code>.
</p>
</dd>    
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>prior.beta</code></td>
<td>
<p>prior specification for the regression parameters,
in the case of doubly-censored data for the regression parameters of
the onset time, i.e. it is related to <code>formula</code> and
<code>random</code>.
Note that the <code>beta</code> vector contains both the fixed effects
<code class="reqn">\beta</code> and the means of the random effects (except the
random intercept) <code class="reqn">\beta_b</code>.
</p>
<p>This should be a list with the following components:
</p>

<dl>
<dt>mean.prior</dt>
<dd>
<p>a vector specifying a prior mean for each
<code>beta</code> parameter in the model.</p>
</dd>
<dt>var.prior</dt>
<dd>
<p>a vector specifying a prior variance for each
<code>beta</code> parameter.</p>
</dd>
</dl>
<p>It is recommended to run the function
bayessurvreg2 first with its argument <code>onlyX</code> set to <code>TRUE</code>
to find out how the betas are sorted. They must correspond to a
design matrix X taken from <code>formula</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional list with initial values for the MCMC related
to the model given by <code>formula</code> and <code>random</code>. The list can have the following components:
</p>

<dl>
<dt>iter</dt>
<dd>
<p>the number of the iteration to which the initial values
correspond, usually zero.</p>
</dd>
<dt>beta</dt>
<dd>
<p>a vector of initial values for the regression
parameters (both the fixed effects and means of the random
effects).
It must be sorted in the same way as are the columns
in the design matrix. Use <code>onlyX=TRUE</code> if you do not know how
the columns in the design matrix are created.</p>
</dd>
<dt>a</dt>
<dd>
<p>a vector of length <code class="reqn">2K+1</code> with the initial values of transformed mixture weights.</p>
</dd>
<dt>lambda</dt>
<dd>
<p>initial values for the Markov random fields precision parameter. 
</p>
</dd>
<dt>gamma</dt>
<dd>
<p>an initial values for the middle
knot <code class="reqn">\gamma.</code>
</p>
<p>If ‘Specification’ is 2, this value will not be changed
by the MCMC and it is recommended (for easier
interpretation of the results) to set <code>init$gamma</code> to zero
(default behavior).
</p>
<p>If ‘Specification’ is 1 <code>init$gamma</code> should be
approximately equal to the mean value of the residuals.
</p>
</dd>
<dt>sigma</dt>
<dd>
<p>an initial values of the basis
standard deviation <code class="reqn">\sigma</code>.
</p>
<p>If ‘Specification’ is 2, this value will not be changed
by the MCMC and it is recommended to set it
approximately equal to the range of standardized data
(let say 4 + 4)
divided by the number of knots and
multiplied by something like 2/3.
</p>
<p>If ‘Specification’ is 1
this should be approximately equal to the range of the residuals
divided by the number of knots <code class="reqn">(2K+1)</code> and
multiplied again by something like 2/3.
</p>
</dd>  
<dt>intercept</dt>
<dd>
<p>an initial values of the
intercept term <code class="reqn">\alpha</code>.
</p>
<p>If ‘Specification’ is 1 this value is not changed by the
MCMC and the initial value is always changed to zero.</p>
</dd>
<dt>scale</dt>
<dd>
<p>an initial value of the scale
parameter <code class="reqn">\tau</code>.
</p>
<p>If ‘Specification’ is 1 this value is not changed by the MCMC
and the initial value is always changed to one.</p>
</dd>
<dt>D</dt>
<dd>
<p>initial value for the covariance matrix of random effects
<code class="reqn">D</code>. Only its lower triangle must be given in a vector,
e.g. <code>c(d[1,1], d[2,1], d[3,1], d[2,2], d[3,2], d[3,3])</code>
for a matrix <code class="reqn">3 \times 3</code>.</p>
</dd>
<dt>b</dt>
<dd>
<p>a vector or matrix of the initial values of random effects
<code class="reqn">b_i,\;i=1,\dots,N</code>
for each cluster. The matrix should be of size
<code class="reqn">q\times N</code>, where <code class="reqn">q</code> is the number of random
effects. I.e. each column of the matrix contains the initial
values for one cluster.</p>
</dd>
<dt>y</dt>
<dd>
<p>a vector of length <code class="reqn">\sum_{i=1}^N\,n_i</code>
with initial values of log-event-times.</p>
</dd>
<dt>r</dt>
<dd>
<p>a vector of length <code class="reqn">\sum_{i=1}^N\,n_i</code>
with initial
component labels for each residual. All values must be between
<code class="reqn">-K</code> and <code class="reqn">K.</code> See argument <code>init</code> of
the function <code>bayesHistogram</code> for more details.</p>
</dd>
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>mcmc.par</code></td>
<td>
<p>a list specifying how some of the G-spline parameters
related to the distribution of the error term from <code>formula</code>
are to be updated. See <code>bayesBisurvreg</code> for more
details.
</p>
<p>In contrast to <code>bayesBisurvreg</code> function argument
<code>mcmc.par$type.update.a</code> can also be equal to
<code>"block"</code> in which case all <code class="reqn">a</code> coefficients are updated
in 1 block using the Metropolis-Hastings algorithm. 
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>prior2</code></td>
<td>
<p>a list specifying the prior distribution of the G-spline
defining the distribution of the error term in the regression model
given by <code>formula2</code> and <code>random2</code>. See <code>prior</code> argument of
<code>bayesHistogram</code> function for more detail.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>prior.b2</code></td>
<td>
<p>prior specification for the parameters related to the
random effects from <code>formula2</code> and <code>random2</code>. This should
be a list with the same structure as <code>prior.b</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>prior.beta2</code></td>
<td>
<p>prior specification for the regression parameters
of time-to-event in the case of doubly censored data (related to
<code>formula2</code> and <code>random2</code>).
This should be a list with the same structure as <code>prior.beta</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>init2</code></td>
<td>
<p>an optional list with initial values for the MCMC related
to the model given by <code>formula2</code> and <code>random2</code>.
The list has the same structure as <code>init</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>mcmc.par2</code></td>
<td>
<p>a list specifying how some of the G-spline parameters
related to <code>formula2</code> are to be updated. The list has the same
structure as <code>mcmc.par</code>.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>store</code></td>
<td>
<p>a list of logical values specifying which chains that are
not stored by default are to be stored. The list can have the
following components.
</p>

<dl>
<dt>a</dt>
<dd>
<p>if <code>TRUE</code> then all the transformed mixture weights
<code class="reqn">a_{k},</code>
<code class="reqn">k=-K,\dots,K,</code>
related to the G-spline (error distribution) of <code>formula</code> are stored.</p>
</dd>
<dt>a2</dt>
<dd>
<p>if <code>TRUE</code> and there are doubly-censored data then
all the transformed mixture weights
<code class="reqn">a_{k},</code>
<code class="reqn">k=-K,\dots,K,</code>
related to the G-spline (error distribution) of <code>formula2</code> are stored.</p>
</dd>
<dt>y</dt>
<dd>
<p>if <code>TRUE</code> then augmented log-event times for all
observations related to the <code>formula</code> are stored.</p>
</dd>
<dt>y2</dt>
<dd>
<p>if <code>TRUE</code> then augmented log-event times for all
observations related to <code>formula2</code> are stored.</p>
</dd>
<dt>r</dt>
<dd>
<p>if <code>TRUE</code> then labels of mixture components for
residuals related to <code>formula</code> are stored.</p>
</dd>
<dt>r2</dt>
<dd>
<p>if <code>TRUE</code> then labels of mixture components for
residuals related to <code>formula2</code> are stored.</p>
</dd>
<dt>b</dt>
<dd>
<p>if <code>TRUE</code> then the sampled values of the random
effects related to <code>formula</code> and <code>random</code> are stored.</p>
</dd>
<dt>b2</dt>
<dd>
<p>if <code>TRUE</code> then the sampled values of the random
effects related to <code>formula2</code> and <code>random2</code> are stored.</p>
</dd>
</dl>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>a string that specifies a directory where all sampled
values are to be stored.
</p>
</td>
</tr></table>
<h3>Value</h3>

<p>A list of class <code>bayessurvreg2</code> containing an information
concerning the initial values and prior choices.
</p>


<h3>Files created</h3>

  
<p>Additionally, the following files with sampled values
are stored in a directory specified by <code>dir</code> argument of this
function (some of them are created only on request, see <code>store</code>
parameter of this function).
</p>
<p>Headers are written to all files created by default and to files asked
by the user via the argument <code>store</code>. During the burn-in, only
every <code>nsimul$nwrite</code> value is written. After the burn-in, all
sampled values are written in files created by default and to files
asked by the user via the argument <code>store</code>. In the files for
which the corresponding <code>store</code> component is <code>FALSE</code>, every
<code>nsimul$nwrite</code> value is written during the whole MCMC (this
might be useful to restart the MCMC from some specific point).
</p>
<p>The following files are created:
</p>

<dl>
<dt>iteration.sim</dt>
<dd>
<p>one column labeled <code>iteration</code> with
indeces of MCMC iterations to which the stored sampled values
correspond.
</p>
</dd>
<dt>mixmoment.sim</dt>
<dd>
<p>columns labeled <code>k</code>, <code>Mean.1</code>, 
<code>D.1.1</code>, where
</p>
<p><b>k</b> = number of mixture components that had probability
numerically higher than zero;
</p>
<p><b>Mean.1</b> =
<code class="reqn">\mbox{E}(\varepsilon_{i,l})</code>;
</p>
<p><b>D.1.1</b> =
<code class="reqn">\mbox{var}(\varepsilon_{i,l})</code>;
</p>
<p>all related to the distribution of the error term from the
model given by <code>formula</code>.
</p>
</dd>
<dt>mixmoment_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>mixmoment.sim</code>, however related to the model
given by <code>formula2</code>.      
</p>
</dd>
<dt>mweight.sim</dt>
<dd>
<p>sampled mixture weights
<code class="reqn">w_{k}</code> of mixture components that had
probabilities numerically higher than zero. Related to the model
given by <code>formula</code>.
</p>
</dd>
<dt>mweight_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>mweight.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>mmean.sim</dt>
<dd>
<p>indeces <code class="reqn">k,</code>
<code class="reqn">k \in\{-K, \dots, K\}</code>
of mixture components that had probabilities numerically higher
than zero. It corresponds to the weights in
<code>mweight.sim</code>. Related to the model given by <code>formula</code>.
</p>
</dd>
<dt>mmean_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>mmean.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>gspline.sim</dt>
<dd>
<p>characteristics of the sampled G-spline
(distribution of
<code class="reqn">\varepsilon_{i,l}</code>)
related to the model given by
<code>formula</code>. This file together with <code>mixmoment.sim</code>,
<code>mweight.sim</code> and <code>mmean.sim</code> can be used to reconstruct
the G-spline in each MCMC iteration.
</p>
<p>The file has columns labeled
<code>gamma1</code>,
<code>sigma1</code>,
<code>delta1</code>,
<code>intercept1</code>, 
<code>scale1</code>,
The meaning of the values in these columns is the following:
</p>
<p><b>gamma1</b> = the middle knot <code class="reqn">\gamma</code> 
If ‘Specification’ is 2, this column usually contains zeros;
</p>
<p><b>sigma1</b> = basis standard deviation <code class="reqn">\sigma</code>
of the G-spline. This column contains a fixed value
if ‘Specification’ is 2;
</p>
<p><b>delta1</b> = distance <code class="reqn">delta</code> between the two knots of the G-spline.
This column contains a fixed value if ‘Specification’ is 2;
</p>
<p><b>intercept1</b> = the intercept term <code class="reqn">\alpha</code> of the G-spline.
If ‘Specification’ is 1, this column usually contains zeros;
</p>
<p><b>scale1</b> = the scale parameter <code class="reqn">\tau</code> of the G-spline.
If ‘Specification’ is 1, this column usually contains ones;
</p>
</dd>
<dt>gspline_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>gspline.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>mlogweight.sim</dt>
<dd>
<p>fully created only if <code>store$a = TRUE</code>. The
file contains the transformed weights
<code class="reqn">a_{k},</code>
<code class="reqn">k=-K,\dots,K</code>
of all mixture components, i.e. also of components that had numerically zero
probabilities. This file is related to the error distribution of
the model given by <code>formula</code>.
</p>
</dd>
<dt>mlogweight_2.sim</dt>
<dd>
<p>fully created only if <code>store$a2 =
      TRUE</code> and in the case of doubly-censored data, the same
structure as <code>mlogweight.sim</code>, however related to the error
distribution of the model given by <code>formula2</code>. 
</p>
</dd>
<dt>r.sim</dt>
<dd>
<p>fully created only if <code>store$r = TRUE</code>. The file
contains the labels of the mixture components into which the
residuals are intrinsically assigned. Instead of indeces on the
scale <code class="reqn">\{-K,\dots, K\}</code>
values from 1 to <code class="reqn">(2\,K+1)</code> are stored here. Function
<code>vecr2matr</code> can be used to transform it back to
indices from <code class="reqn">-K</code> to <code class="reqn">K</code>.
</p>
</dd>
<dt>r_2.sim</dt>
<dd>
<p>fully created only if <code>store$r2 =
      TRUE</code> and in the case of doubly-censored data, the same
structure as <code>r.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>lambda.sim</dt>
<dd>
<p>one column labeled <code>lambda</code>. These are the
values of the smoothing parameter<code class="reqn">\lambda</code>
(hyperparameters of the prior distribution of the transformed
mixture weights <code class="reqn">a_{k}</code>). This file is
related to the model given by <code>formula</code>.
</p>
</dd>
<dt>lambda_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>lambda.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>beta.sim</dt>
<dd>
<p>sampled values of the regression parameters, both
the fixed effects <code class="reqn">\beta</code> and means of the random
effects <code class="reqn">\beta_b</code> (except the random intercept which
has always the mean equal to zero).
This file is related to the model given by <code>formula</code>.
The columns are labeled according to the
<code>colnames</code> of the design matrix.
</p>
</dd>
<dt>beta_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>beta.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>D.sim</dt>
<dd>
<p>sampled values of the covariance matrix <code class="reqn">D</code> of
the random effects. The file has <code class="reqn">1 + 0.5\,q\,(q+1)</code> columns (<code class="reqn">q</code> is the dimension of the random
effect vector <code class="reqn">b_i</code>). The first column labeled <code>det</code>
contains the determinant of the sampled matrix, additional columns
labeled <code>D.1.1</code>, <code>D.2.1</code>, ..., <code>D.q.1</code>, ...
<code>D.q.q</code> contain the lower triangle of the sampled
matrix. This file is related to the model specified by
<code>formula</code> and <code>random</code>.
</p>
</dd>
<dt>D_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>D.sim</code>, however related to the model given by
<code>formula2</code> and <code>random2</code>.
</p>
</dd>
<dt>b.sim</dt>
<dd>
<p>fully created only if <code>store$b = TRUE</code>. It
contains sampled values of random effects for all clusters in
the data set. The file has <code class="reqn">q\times N</code> columns sorted as
<code class="reqn">b_{1,1},\dots,b_{1,q},\dots, b_{N,1},\dots,b_{N,q}</code>. This file is
related to the model given by <code>formula</code> and <code>random</code>.
</p>
</dd>
<dt>b_2.sim</dt>
<dd>
<p>fully created only if <code>store$b2 =
      TRUE</code> and in the case of doubly-censored data, the same
structure as <code>b.sim</code>, however related to the model
given by <code>formula2</code> and <code>random2</code>. 
</p>
</dd>  
<dt>Y.sim</dt>
<dd>
<p>fully created only if <code>store$y = TRUE</code>. It
contains sampled (augmented) log-event times for all observations
in the data set.
</p>
</dd>
<dt>Y_2.sim</dt>
<dd>
<p>fully created only if <code>store$y2 =
      TRUE</code> and in the case of doubly-censored data, the same
structure as <code>Y.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
<dt>logposter.sim</dt>
<dd>
<p>columns labeled <code>loglik</code>, <code>penalty</code>,
and <code>logprw</code>. This file is related to the model
given by <code>formula</code>. The columns have the following meaning.
</p>
<p><b>loglik</b>
<code class="reqn">=</code> <code class="reqn">%
	- (\sum_{i=1}^N\,n_i)\,\Bigl\{\log(\sqrt{2\pi}) + \log(\sigma) \Bigr\}-
          0.5\sum_{i=1}^N\sum_{l=1}^{n_i}
	  \Bigl\{
	  (\sigma^2\,\tau^2)^{-1}\; (y_{i,l} - x_{i,l}'\beta - z_{i,l}'b_i -
	  \alpha - \tau\mu_{r_{i,l}})^2
          \Bigr\}
      </code>
</p>
<p>where <code class="reqn">y_{i,l}</code> denotes (augmented) <em>(i,l)</em>th
true log-event time.
</p>
<p>In other words, <code>loglik</code> is equal to the
conditional log-density
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^N \sum_{l=1}^{n_i}\,\log\Bigl\{p\bigl(y_{i,l}\;\big|\;r_{i,l},\,\beta,\,b_i,\,\mbox{G-spline}\bigr)\Bigr\};</code>
</p>

<p><b>penalty:</b>
the penalty term
</p>
<p style="text-align: center;"><code class="reqn">-\frac{1}{2}\sum_{k}\Bigl(\Delta\, a_k\Bigr)^2</code>
</p>

<p>(not multiplied by <code class="reqn">\lambda</code>);
</p>
<p><b>logprw</b> <code class="reqn">=</code>
<code class="reqn">-2\,(\sum_i n_i)\,\log\bigl\{\sum_{k}a_{k}\bigr\} +
	\sum_{k}N_{k}\,a_{k},</code>
where <code class="reqn">N_{k}</code> is the number of residuals
assigned intrinsincally to the <code class="reqn">k</code>th
mixture component.
</p>
<p>In other words, <code>logprw</code> is equal to the conditional
log-density
<code class="reqn">\sum_{i=1}^N\sum_{l=1}^{n_i} \log\bigl\{p(r_{i,l}\;|\;\mbox{G-spline
	  weights})\bigr\}.</code>
</p>
</dd>
<dt>logposter_2.sim</dt>
<dd>
<p>in the case of doubly-censored data, the same
structure as <code>logposter.sim</code>, however related to the model
given by <code>formula2</code>. 
</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Gelfand, A. E., Sahu, S. K., and Carlin, B. P. (1995).
Efficient parametrisations for normal linear mixed models.
<em>Biometrika,</em> <b>82,</b> 479-488.
</p>
<p>Komárek, A. (2006).
<em>Accelerated Failure Time Models for Multivariate
Interval-Censored Data with Flexible Distributional Assumptions</em>.
PhD. Thesis, Katholieke Universiteit Leuven, Faculteit Wetenschappen.
</p>
<p>Komárek, A., Lesaffre, E., and Legrand, C. (2007).
Baseline and treatment effect heterogeneity for survival
times between centers using a random effects accelerated failure time
model with flexible error distribution.
<em>Statistics in Medicine,</em> <b>26</b>, 5457-5472.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See the description of R commands for
## the model with EORTC data,
## analysis described in Komarek, Lesaffre and Legrand (2007).
##
## R commands available in the documentation
## directory of this package
## as ex-eortc.R and
## https://www2.karlin.mff.cuni.cz/ komarek/software/bayesSurv/ex-eortc.pdf
##
</code></pre>


</div>