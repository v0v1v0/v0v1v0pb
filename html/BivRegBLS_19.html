<div class="container">

<table style="width: 100%;"><tr>
<td>MD.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Display the CBLS regression, or univariate tolerance intervals in a (M,D) plot</h2>

<h3>Description</h3>

<p>Display the CBLS regression in a (M,D) plot with or without hyperbolic confidence and/or predictive intervals, and an acceptance interval. Alternatively, univariate tolerance intervals which are bounded by two horizontal lines can be plotted.</p>


<h3>Usage</h3>

<pre><code class="language-R">MD.plot(results = NULL, xname = "X", yname = "Y", antilog = NULL,
        accept.int = 0, accept.int.perc = FALSE, accept.int.threshold = NULL,
        include.int = TRUE, graph.int = c("CB", "PI"), graph.horiz.int = c("bTI", "bgTI"),
        col.CBLS = 1, col.CI = 2, col.CB = 3, col.PI = 4, col.GI = 5, col.bTI = 3,
        col.bgTI = 4, lty.CBLS = 1, lty.CI = 1, lty.CB = 1, lty.PI = 1, lty.GI = 1,
        lty.bTI = 1, lty.bgTI = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>a CBLS class object (obtained with the <code>BLS</code> function) or a MD.horiz.lines class object (obtained with the <code>MD.horiz.lines</code> function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antilog</code></td>
<td>
<p> a character string or a numeric value. This argument displays the CBLS or MD.horiz.lines results on the initial scales in the (M,D) plot if a logarithmic transformation was used prior to the CBLS or MD.horiz.lines functions. Options available are: 10 or "e".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.int</code></td>
<td>
<p> a numeric vector (length equal 1 or 2) for the value of Δ: |Y-X|&lt;Δ to assess whether two devices (X and Y) are equivalent or not. Two values of Δ can be entered to take into account the case where the equivalence threshold changes along the M axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.int.perc</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether Δ needs to be interpreted in percentage: Y = X ± Δ%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.int.threshold</code></td>
<td>
<p> a numeric value for the M threshold where the value of Δ changes if two Δ values are used in <code>accept.int</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.int</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether the hyperbolic intervals should lie entirely in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.int</code></td>
<td>
<p> a character vector for the hyperbolic curves to be displayed on the graph. Options are: "CI" (Confidence Intervals),"CB" (Confidence Bands),"PI" (Predictive Intervals),"GI" (Generalised Intervals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph.horiz.int</code></td>
<td>
<p> if a MD.horiz.lines object is used, a character vector for the univariate tolerance intervals to be displayed on the graph. Options are: "bTI" (beta expectation tolerance interval or tolerance interval type I) and/or "bgTI" (beta gamma content tolerance interval or tolerance interval type II).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.CBLS</code></td>
<td>
<p> a character string or a numeric variable for the colour of the CBLS regression line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.CI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.CB</code></td>
<td>
<p> a character string or a numeric variable for the colour of the confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.PI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the predictive intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.GI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the generalized intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bTI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the beta expectation tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bgTI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the beta gamma content tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.CBLS</code></td>
<td>
<p> a numeric variable for the type of line of the CBLS regression line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.CI</code></td>
<td>
<p> a numeric variable for the type of line for the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.CB</code></td>
<td>
<p> a numeric variable for the type of line for the confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.PI</code></td>
<td>
<p> a numeric variable for the type of line for the predictive intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.GI</code></td>
<td>
<p> a numeric variable for the type of line for the generalized intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.bTI</code></td>
<td>
<p> a numeric variable for the type of line for the beta expectation tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.bgTI</code></td>
<td>
<p> a numeric variable for the type of line for the beta gamma content tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> the common arguments from 'plot' or 'par' that may be used additionaly, such as xlim, ylim, xlab, ylab.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>results</code> argument is mandatory. The value of Δ (<code>accept.int</code>) is converted to percentage if antilog is used in a (M,D) plot to define 2 asymetric bounds (1- Δ/100, (100/(100-Δ)).</p>


<h3>Value</h3>

<p>An (M,D) plot in a new window.</p>


<h3>Note</h3>

<p>The limits of the axes and their labels are set automatically by the function. To compare different plots with fixed limits, use xlim and ylim. To write customized labels, use xlab and ylab.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code>XY.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BivRegBLS)
data(SBP)
# Estimate the CBLS regression on replicated data
res.CBLS=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Plot the results in a (M,D) plot with an acceptance interval
MD.plot(results=res.CBLS,xname="J",yname="S",accept.int=10,accept.int.perc=FALSE)
MD.plot(results=res.CBLS,xname="J",yname="S",accept.int=10,accept.int.perc=TRUE)
MD.plot(results=res.CBLS,xname="J",yname="S",accept.int=c(10,15),
        accept.int.perc=FALSE,accept.int.threshold=150)
</code></pre>


</div>