<div class="container">

<table style="width: 100%;"><tr>
<td>beta_kn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the KN. model</h2>

<h3>Description</h3>

<p>Fit the KN. model from the <code>betaclust</code> family of beta mixture models for DNA methylation data.
The KN. model analyses a single DNA sample type and identifies the thresholds between the different methylation states.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta_kn(data, M = 3, parallel_process = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe of dimension <code class="reqn">C \times N</code> containing methylation values for <code class="reqn">C</code> CpG sites from <code class="reqn">R = 1</code> sample type collected from <code class="reqn">N</code> patients.
Samples are grouped together in the dataframe such that the columns are ordered as Sample1_Patient1, Sample1_Patient2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of methylation states to be identified in a DNA sample type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel_process</code></td>
<td>
<p>The "TRUE" option results in parallel processing of the models for increased computational efficiency. The default option has been set as "FALSE" due to package testing limitations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed to allow for reproducibility (default = NULL).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The KN. model clusters each of the <code class="reqn">C</code> CpG sites into one of <code class="reqn">K</code> methylation states, based on data from <code class="reqn">N</code> patients for one DNA sample type (i.e. <code class="reqn">R = 1</code>).
As each CpG site can belong to any of the <code class="reqn">M = 3</code> methylation states (hypomethylated, hemimethylated or hypermethylated), the default value of <code class="reqn">K = M = 3</code>.
The KN. model differs from the K.. model as it is less parsimonious, allowing cluster and patient-specific shape parameters. The returned object can be passed as an input parameter to the
<code>threshold</code> function available in this package to calculate the thresholds between the methylation states.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li>
<p> cluster_size - The total number of CpG sites in each of the K clusters.
</p>
</li>
<li>
<p> llk - A vector containing the log-likelihood value at each step of the EM algorithm.
</p>
</li>
<li>
<p> alpha - The first shape parameter for the beta mixture model.
</p>
</li>
<li>
<p> delta - The second shape parameter for the mixture model.
</p>
</li>
<li>
<p> tau - The estimated mixing proportion for each cluster.
</p>
</li>
<li>
<p> z - A matrix of dimension <code class="reqn">C \times K</code> containing the posterior probability of each CpG site belonging to each of the <code class="reqn">K</code> clusters.
</p>
</li>
<li>
<p> classification - The classification corresponding to z, i.e. map(z).
</p>
</li>
<li>
<p> uncertainty - The uncertainty of each CpG site's clustering.    </p>
</li>
</ul>
<h3>See Also</h3>

<p><code>beta_k</code>
</p>
<p><code>betaclust</code>
</p>
<p><code>threshold</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">my.seed &lt;- 190
M &lt;- 3
data_output &lt;- beta_kn(pca.methylation.data[1:30,2:5], M,
                       parallel_process = FALSE, seed = my.seed)
thresholds &lt;- threshold(data_output, pca.methylation.data[1:30,2:5], "KN.")
</code></pre>


</div>