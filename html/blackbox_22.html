<div class="container">

<table style="width: 100%;"><tr>
<td>calcGCV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate smoothing parameters by generalized cross-validation (GCV)
</h2>

<h3>Description</h3>

<p>Smoothing is based on prediction in a linear mixed model (“Kriging”) with non-zero residual variance. The correlation function for the random effect is the Matern function with argument the Euclidian distance between scaled coordinates (x/scale). The Matern function also has a smoothness parameter. These parameters are by default estimated by GCV. For large data sets (say &gt;2000 rows), it is strongly recommended to select a subset of the data using <code>GCVptnbr</code>, as GCV will otherwise be very slow.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcGCV(sorted_data=data, data, CovFnParam = NULL, GCVptnbr = Inf,
       topmode = FALSE, verbose = FALSE, cleanResu = "",
       force=FALSE, decreasing=FALSE,
       verbosity = blackbox.getOption("verbosity"),
       optimizers = blackbox.getOption("optimizers"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sorted_data</code></td>
<td>

<p>A data frame with both predictor and response variance, sorted and with attributes, as produced by <code>prepareData</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Obsolete, for Migraine back-compatibility, should not be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CovFnParam</code></td>
<td>

<p>Optional fixed values of scale factors for each predictor variable. Smoothness should not be included in this argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GCVptnbr</code></td>
<td>

<p>Maximum number of rows selected for GCV.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topmode</code></td>
<td>

<p>Controls the way rows are selected. For development purposes, should not be modified
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Whether to print some messages or not. Distinct from <code>verbosity</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>Distinct from <code>verbose</code>. See <code>verbosity</code> in <code>blackbox.options</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cleanResu</code></td>
<td>

<p>A connection, or a character string naming a file for some nicely formated output. If <code>""</code> (the default), print to the standard output connection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p> Boolean. Forces the analysis of data without pairs of response values for given parameter values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizers</code></td>
<td>
<p>A vector of) character strings, from which the optimization method is selected. Default is <code>nloptr</code> with its own <code>"NLOPT_LN_BOBYQA"</code> method. See the source of the function for other methods (the latter being subject to change with little notice).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p> Boolean. Use TRUE if you want the result to be used in function maximization rather than minimization.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>CovFnParam</code></td>
<td>
<p>Scale parameters <b>and</b> smoothness parameter of the Matern correlation function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaEst</code></td>
<td>
<p>Ratio of residual variance over random effect variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pureRMSE</code></td>
<td>
<p>Estimate of root residual variance</p>
</td>
</tr>
</table>
<p>and possibly other elements.
</p>
<p>Global options <code>CovFnParam</code> is modified as a side effect.
</p>


<h3>References</h3>

<p>Golub, G. H., Heath, M. and Wahba, G. (1979) Generalized Cross-Validation as a method for choosing a good ridge parameter.
Technometrics 21: 215-223.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># see example on main doc page (?blackbox)
</code></pre>


</div>