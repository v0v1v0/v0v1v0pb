<div class="container">

<table style="width: 100%;"><tr>
<td>Selection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable selection for a Bayenet object</h2>

<h3>Description</h3>

<p>Variable selection for a Bayenet object
</p>


<h3>Usage</h3>

<pre><code class="language-R">Selection(obj, sparse)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Bayenet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical flag. If TRUE, spike-and-slab priors will be used to shrink coefficients of irrelevant covariates to zero exactly.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For class ‘Sparse’,  the inclusion probability is used to indicate the importance of predictors. 
Here we use a binary indicator <code class="reqn">\phi</code> to denote the membership of the non-spike distribution. 
Take the main effect of the <code class="reqn">j</code>th genetic factor, <code class="reqn">X_{j}</code>, as an example. 
Suppose we have collected H posterior samples from MCMC after burn-ins. The <code class="reqn">j</code>th G factor is included 
in the final model at the <code class="reqn">j</code>th MCMC iteration if the corresponding indicator is 1, i.e., <code class="reqn">\phi_j^{(h)} = 1</code>. 
Subsequently, the posterior probability of retaining the <code class="reqn">j</code>th genetic main effect in the final model is defined as the average of all the indicators for the <code class="reqn">j</code>th G factor among the H posterior samples. 
That is, <code class="reqn">p_j = \hat{\pi} (\phi_j = 1|y) = \frac{1}{H} \sum_{h=1}^{H} \phi_j^{(h)}, \;  j = 1, \dots,p.</code>
A larger posterior inclusion probability of <code class="reqn">j</code>th indicates a stronger empirical evidence that the <code class="reqn">j</code>th genetic main effect has a non-zero coefficient, i.e., a stronger association with the phenotypic trait. 
Here, we use 0.5 as a cutting-off point. If <code class="reqn">p_j &gt; 0.5</code>, then the <code class="reqn">j</code>th genetic main effect is included in the final model. Otherwise, the <code class="reqn">j</code>th genetic main effect is excluded in the final model.
For class ‘NonSparse’, variable selection is based on 95% credible interval.
Please check the references for more details about the variable selection.
</p>


<h3>Value</h3>

<p>an object of class ‘Selection’ is returned, which is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method used for identifying important effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>a list of indicators of selected effects.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lu, X. and Wu, C. (2023). Bayesian quantile elastic net with spike-and-slab priors.
</p>


<h3>See Also</h3>

<p><code>Bayenet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat)
max.steps=5000
fit= Bayenet(X, Y, clin, max.steps, penalty="lasso")
selected=Selection(fit,sparse=TRUE)
selected$Main.G


</code></pre>


</div>