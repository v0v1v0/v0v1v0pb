<div class="container">

<table style="width: 100%;"><tr>
<td>nsec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracts the predicted NSEC value as desired from an
object of class <code>bayesnecfit</code> or <code>bayesmanecfit</code>.</h2>

<h3>Description</h3>

<p>Extracts the predicted NSEC value as desired from an
object of class <code>bayesnecfit</code> or <code>bayesmanecfit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nsec(
  object,
  sig_val = 0.01,
  resolution = 1000,
  x_range = NA,
  hormesis_def = "control",
  xform = identity,
  prob_vals = c(0.5, 0.025, 0.975),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>bayesnecfit</code> or
<code>bayesmanecfit</code> returned by <code>bnec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>The number of unique x values over which to find NSEC -
large values will make the NSEC estimate more precise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_range</code></td>
<td>
<p>A range of x values over which to consider extracting NSEC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hormesis_def</code></td>
<td>
<p>A <code>character</code> vector, taking values
of "max" or "control". See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_vals</code></td>
<td>
<p>A vector indicating the probability values over which to
return the estimated NSEC value. Defaults to 0.5 (median) and 0.025 and
0.975 (95 percent credible intervals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to pass to class specific methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NSEC is no-effect toxicity metric that estimates the concentration
at which the modeled mean response is statistically indistinguishable from
the mean control response. See the detailed derivation in
Fisher and Fox (2023).
</p>
<p>For <code>hormesis_def</code>, if "max", then NSEC values are calculated
as a decline from the maximum estimates (i.e. the peak at NEC);
if "control", then NSEC values are calculated relative to the control, which
is assumed to be the lowest observed concentration.
</p>
<p>Calls to functions <code>ecx</code> and <code>nsec</code> and
<code>compare_fitted</code> do not require the same level of flexibility
in the context of allowing argument <code>newdata</code>
(from a <code>posterior_predict</code> perspective) to
be supplied manually, as this is and should be handled within the function
itself. The argument <code>resolution</code> controls how precisely the
<code>ecx</code> or <code>nsec</code> value is estimated, with
argument <code>x_range</code> allowing estimation beyond the existing range of
the observed data (otherwise the default range) which can be useful in a
small number of cases. There is also no reasonable case where estimating
these from the raw data would be of value, because both functions would
simply return one of the treatment concentrations, making NOEC a better
metric in that case.
</p>


<h3>Value</h3>

<p>A vector containing the estimated NSEC value, including upper and
lower 95% credible interval bounds.
</p>


<h3>References</h3>

<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019â€“2028.
doi: 10.1002/etc.5610.
</p>


<h3>See Also</h3>

<p><code>bnec</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(bayesnec)

data(manec_example)
nsec(manec_example)


</code></pre>


</div>