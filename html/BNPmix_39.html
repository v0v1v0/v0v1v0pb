<div class="container">

<table style="width: 100%;"><tr>
<td>plot.BNPdens</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density plot for BNPdens class</h2>

<h3>Description</h3>

<p>Extension of the <code>plot</code> method to the <code>BNPdens</code> class. The method <code>plot.BNPdens</code> returns suitable plots for a <code>BNPdens</code>
object. See details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'BNPdens'
plot(
  x,
  dimension = c(1, 2),
  col = "#0037c4",
  show_points = F,
  show_hist = F,
  show_clust = F,
  bin_size = NULL,
  wrap_dim = NULL,
  xlab = "",
  ylab = "",
  band = T,
  conf_level = c(0.025, 0.975),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>BNPdens</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>if <code>x</code> is the output of a model fitted to multivariate data,
<code>dimensions</code> specifies the two dimensions for the bivariate contour plot
(if they are equal, a marginal univarite plot is returned);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color of the lines;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_points</code></td>
<td>
<p>if <code>TRUE</code>, the function plots also the observations, default <code>FALSE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_hist</code></td>
<td>
<p>if <code>TRUE</code>, and the model is univariate, the function plots also the histogram of the data, default  <code>FALSE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_clust</code></td>
<td>
<p>if <code>TRUE</code> the function plots also the points colored with respect to the estimated partition, default  <code>FALSE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_size</code></td>
<td>
<p>if <code>show_hist = TRUE</code>, it correponds to the size of each bin,
default <code>range(data) / 30</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrap_dim</code></td>
<td>
<p>bivariate vector, if <code>x</code> is the output of <code>DDPdensity</code>, it correponds to the number of rows and columns in the plot. Default <code>c(ngroup, 1)</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label of the horizontal axis;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label of the vertical axis;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>
<p>if <code>TRUE</code> and <code>x</code> is the output of a univariate model or of <code>DDPdensity</code>, the plot method displays quantile-based posterior credible bands along with estimated densities;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>bivariate vector, order of the quantiles for the posterior credible bands. Default <code>c(0.025, 0.975)</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the <code>BNPdens</code> object is generated by <code>PYdensity</code>, the function returns
the univariate or bivariate estimated density plot.
If the <code>BNPdens</code> object is generated by <code>PYregression</code>, the function returns
the scatterplot of the response variable jointly with the covariates (up to four), coloured according to the estimated partition.
up to four covariates.
If <code>x</code> is a <code>BNPdens</code> object generated by <code>DDPdensity</code>, the function returns
a wrapped plot with one density per group.
The plots can be enhanced in several ways: for univariate densities, if <code>show_hist = TRUE</code>,
the plot shows also the histogram of the data; if <code>show_points = TRUE</code>,
the plot shows also the observed points along the
x-axis; if <code>show_points = TRUE</code> and <code>show_clust = TRUE</code>, the points are colored
according to the partition estimated with the <code>partition</code> function.
For multivariate densities: if  <code>show_points = TRUE</code>,
the plot shows also the scatterplot of the data;
if <code>show_points = TRUE</code> and  <code>show_clust = TRUE</code>,
the points are colored according to the estimated partition.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># PYdensity example
data_toy &lt;- c(rnorm(100, -3, 1), rnorm(100, 3, 1))
grid &lt;- seq(-7, 7, length.out = 50)
est_model &lt;- PYdensity(y = data_toy,
 mcmc = list(niter = 200, nburn = 100, nupd = 100),
 output = list(grid = grid))
class(est_model)
plot(est_model)

# PYregression example
x_toy &lt;- c(rnorm(100, 3, 1), rnorm(100, 3, 1))
y_toy &lt;- c(x_toy[1:100] * 2 + 1, x_toy[101:200] * 6 + 1) + rnorm(200, 0, 1)
grid_x &lt;- c(0, 1, 2, 3, 4, 5)
grid_y &lt;- seq(0, 35, length.out = 50)
est_model &lt;- PYregression(y = y_toy, x = x_toy,
mcmc = list(niter = 200, nburn = 100),
output = list(grid_x = grid_x, grid_y = grid_y))
summary(est_model)
plot(est_model)

# DDPdensity example
data_toy &lt;- c(rnorm(50, -4, 1), rnorm(100, 0, 1), rnorm(50, 4, 1))
group_toy &lt;- c(rep(1,100), rep(2,100))
grid &lt;- seq(-7, 7, length.out = 50)
est_model &lt;- DDPdensity(y = data_toy, group = group_toy,
mcmc = list(niter = 200, nburn = 100, napprox_unif = 50),
output = list(grid = grid))
summary(est_model)
plot(est_model)


</code></pre>


</div>