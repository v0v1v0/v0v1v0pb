<div class="container">

<table style="width: 100%;"><tr>
<td>bipartite-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Analysis of bipartite ecological webs
</h2>

<h3>Description</h3>

<p>Bipartite provides functions to visualise webs and calculate a series of indices commonly used to describe pattern in (ecological) networks, a.k.a. webs. It focusses on webs consisting of only two levels, e.g. pollinator-visitation or predator-prey webs. Visualisation is important to get an idea of what we are actually looking at, while the indices summarise different aspects of the webs topology.</p>


<h3>Details</h3>

<p>Note: We only had three types of bipartite webs in mind when starting this package: seed-disperser, plant-pollinator and host-parasitoid systems. In how far it makes sense to use these functionalities for other systems (or indeed even for these systems) lies in the hands of the user. Please refer to the literature cited for details on the theory behind the indices.
</p>
<p>Networks can be either binary (0/1 or FALSE/TRUE matrices) or quantitative (matrices containing estimates of pairwise interaction strength, usually assumed here to be interaction frequency).
</p>
<p>Input for most analyses is an interaction matrix of m nodes (= species) from one group (“higher”) with n nodes (= species) from another group (“lower”), i.e. a n x m matrix, where higher level nodes are in columns, lower level nodes in rows. Column and row names can be provided. This is fundamentally different from “one-mode” networks, which are organised as k x k matrix, i.e. one group of nodes only, in which each node can link (= interact) with each other. Such a format is incompatible with the functions we provide here. (Note, however, that functions <code>as.one.mode</code> and <code>web2edges</code> are convenience functions to morph bipartite networks into one-mode webs. Furthermore, some indices build on one-mode networks and <em>are</em> called from bipartite.)
</p>
<p>Before you start with the network, you have to get the data into the right shape. The function <code>frame2webs</code> aims to facilitate this process. Arranging a web, e.g. by size, is supported by <code>sortweb</code>.
</p>
<p>The typical first step is to <b>visualise</b> the network. Two functions are on offer here: one (<code>visweb</code>) simply plots the matrix in colours depicting the strength of an interaction and options for re-arranging columns and rows (e.g. to identify compartments or nesting). The other function (<code>plotweb</code>) plots the actual web with participants (as two rows of rectangles) connected by lines (proportional to interaction strength). Both can be customised by many options.
</p>
<p>The second step is to <b>calculate indices</b> describing network topography. There are <b>three</b> different levels this can be achieved at: the entire web (using function <code>networklevel</code>), at the level of each group (also using function <code>networklevel</code>) or the individual node (= species; thus somewhat inconsistently called <code>specieslevel</code>). Most other functions in the package are helpers, although some can be called on their own and return the respective result (<code>dfun</code>, <code>H2fun</code> and <code>second.extinct</code> with <code>slope.bipartite</code>).
</p>
<p>The third step is to <b>compare results to null models</b>. Many interaction matrices are very incomplete snapshots of the true underlying network (e.g. a one-week sampling of a pollination network on a patch of 4 x 4 meters). As a consequence, many species were rarely observed, many are singletons (only one recording). To make analyses comparable across networks with different sampling intensity and number of species per group, we need a common yardstick. We suggest that users should use a null model, i.e. an algorithm that randomises entries while constraining some web properties (such as dimensions, marginal totals or connectance). The function <code>nullmodel</code> provides a few such null models, but this is a wide field of research and we make no recommendations (actually, we do: see Dormann et al. 2009 and Dormann 2011, both shipping in the doc-folder of this package). You can also simulate networks using <code>genweb</code> or <code>null.distr</code>.
</p>
<p>Finally, bipartite comes with 23 quantitative pollination network data sets taken from the NCEAS interaction webs data base (use <code>data(package="bipartite")</code> to show their names) and it has a few miscellaneous functions looking at some special features of bipartite networks (such as modularity: <code>computeModules</code> or potential for apparent competition: <code>PAC</code>).
</p>

<p>See help pages and vignette for details and examples.
</p>
<p>For an overview of other computing resources, data, books, journals etc. check out this page: <a href="https://github.com/briatte/awesome-network-analysis">https://github.com/briatte/awesome-network-analysis</a>.
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> bipartite</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 2.20</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-05-10</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>versionlog</h3>

<p>Please see help page <code>versionlog</code> for all changes and updates prior to version 2.00. This page will only list most recent changes. 
</p>

<ul>
<li>
<p> 2.20 (10-May-2024)
</p>

<dl>
<dt>Code changes to</dt>
<dd>
<p><code>plotweb</code>,  <code>plotweb2</code>, <code>visweb</code> and  <code>compart</code> as well as the namespace, due to changes in the  <code>cca</code>-function in <span class="pkg">vegan</span>. Many thanks to Jari Oksanen (maintainer of vegan) to provide these patches!</p>
</dd>
<dt>Added new option <span class="option">effective</span> to <code>networklevel</code>:</dt>
<dd>
<p>With this option, diversity, H2' and evenness indices are turned into “effective” diversity and evenness indices, by exponentiating them. It has been repeatedly argued that Shannon's H is ecologically difficult to interpret and should instead be exponentiated to yield the “effective number of species, if all were equally abundant” (e.g. Jost 2006). The same logic goes for evenness (Jost 2010) and, by extension, for H2'. Since H2' then becomes an index with data-dependent upper bound, rather than one on [0,1], this version may not fly. For diversity, exponentiating will yield the same values as indices “vulnerability” and “generality”, which is why we had removed that option from an earlier version (and now it's back). So largely this option is useful for “interaction evenness” and for experimenting.</p>
</dd> 
</dl>
</li>
<li>
<p> 2.19 (29-Nov-2023)
</p>

<dl>
<dt>Fixed missing <code>any</code> causing a problem when plotting modules,</dt>
<dd>
<p>reported by rubenroos and Celia Ferriol Gonzalez: many thanks!</p>
</dd>
<dt>When a matrix has more columns/rows than the sum of entries, <code>r2dexternal</code>
</dt>
<dd>
<p>will not work without external abundances. The fix is incomplete, as it is only applied to columns in the moment, and not to <code>vaznullexternal</code> either. Thanks to Emilie Ellis for reporting!</p>
</dd>
<dt>Warning fix in internal function <code>isCorrectModuleWebObject</code>:</dt>
<dd>
<p>Incorrect testing of dimensions of modularity object. Thanks to Frazer Moore for reporting.</p>
</dd>
</dl>
</li>
<li>
<p> 2.18 (22-Oct-2022)
</p>

<dl>
<dt>Bug fix in <code>robustness</code>:</dt>
<dd>
<p>For large matrices, the (too short) subdivision length and the possible non-zero starting values caused an error. Thanks to Rafael Pinheiro for reporting.</p>
</dd>
<dt>Small semantic</dt>
<dd>
<p>fixes newly picked up by sterner CRAN checks (e.g. non-UTF in comment; escaped ampersand in title).</p>
</dd>
</dl>
</li>
<li>
<p> 2.17 (release date: 12-Apr-2022)
</p>

<dl>
<dt>New null model for "compound network structure" using <code>restrictednull</code>:</dt>
<dd>
<p>This function, contributed by Gabriel Felix, Rafael Pinheiro, and Marco Mello from the Ecological Synthesis Lab (SintECO) in São Paulo, constructs null model expectations for networks with modules. So far, nestedness could not be properly tested for <em>within</em> null model modules, only at the level of the entire network. This function uses information from previously identified modules (typically using <code>computeModules</code>) to generate expectations based on marginal totals and observed connectivity. It builds on <code>vaznull</code> in that respect, but adds the modular structure.</p>
</dd>
<dt>Major rehaul of <code>mgen</code>:</dt>
<dd>
<p>1. the biggest change is that <span class="option">keep.species=TRUE</span> now respects the probabilities of the input web (before it had used marginal totals) already for the first interaction of each species, and tries to minimize the number of interactions assigned in this first part of the function. 2. the main part of the function has been changed, not using a while-loop anymore and thus dropping the argument <span class="option">trials</span>. 3. handling of <span class="option">autotransfrom</span> has been slightly changed, avoiding unnecessary warnings. 4. the output web now keeps dimnames of input web.</p>
</dd>
<dt>Slight changes to <code>specieslevel</code>,</dt>
<dd>
<p>where the weighted betweenness values could be wrongly placed if the web contained compartments without indirect links. Thanks to Marco Mello for drawing our attention to this!</p>
</dd>
<dt>
<code>computeModules</code> used to remove</dt>
<dd>
<p>all-1 rows and columns in a binary network, as they contain no information on modules. However, this affects the modularity value. Now the function always keeps the full network. Note that all-0-values are still removed. Thanks to Elvira D'Bastiani for reporting this problem!</p>
</dd>
<dt>Substantial speed boost to <code>vaznull</code>,</dt>
<dd>
<p>thanks to an improvement suggested by Rafael Pinheiro!</p>
</dd>
<dt>Bug fix in <code>webs2array</code>,</dt>
<dd>
<p>which caused problems when called within another function.</p>
</dd>
<dt>Added index modularity (= Newman's Q) to <code>networklevel</code>.</dt>
<dd>
<p>No options are available, hence this value is the likelihood of the default setting of <code>computeModules</code>.</p>
</dd>
<dt>Bug fix in index PSI in <code>specieslevel</code>,</dt>
<dd>
<p>where the beta-exponent was on the wrong matrix, and hence it did not yield species strength for beta=0.</p>
</dd>
<dt>Retired binmatnest as called by <code>nestedness</code>.</dt>
<dd>
<p>Binmatnest was one of the first nice nestedness algorithms, implemented in C++. It has been kept merely for historical reasons, as <span class="pkg">vegan</span>'s <code>nestedtemp</code> is more reliable. We finally decided to kick binmatnest out, using this function as legacy-call to <code>nestedtemp</code> and leaving the legacy help page. (Also makes package maintenance a bit easier: one C++ function less to think about.)</p>
</dd>
<dt>Added text-option to <code>plotPAC</code>.</dt>
<dd>
<p>Species names have a tendency to always be in the way, and too long. Therefore the original function only plotted numbers. Now we added the option to plot (and scale and move) labels for each species. Not nice, but practical.</p>
</dd>
<dt>Function <code>networklevel</code> now</dt>
<dd>
<p>calls <span class="pkg">vegan</span>'s <code>nesteddisc</code> when computing the index "discrepancy". That function tries to handle ties in the data consistently, although for webs with many columns (or rows) with the same number of links this will still lead to slightly different values. Thanks to Valentin Stefan for drawing our attention to this! Also, we added an explicit note of this behaviour in <code>networklevel</code>.</p>
</dd>
<dt>Bug fix in <code>r2dexternal</code> and <code>vaznullexternal</code>:</dt>
<dd>
<p>Sometimes did not yield the correct row/column sums, when margins were extremely skewed.</p>
</dd>
<dt>Addressed long-standing confusion in <code>nested</code>,</dt>
<dd>
<p> which reports some indices in [0,1], others in [0, 100] (i.e. as percent). Thanks to Jari Oksanen for reminding me of this point. All but one now report in the 0-100% range. While fixing this, also added WNODA (based on <code>nest.smdm</code>) to the fray.</p>
</dd>
</dl>
</li>
<li>
<p> 2.16 (release date: 08-Jan-2021)
</p>

<dl>
<dt>Bug fix in <code>H2fun</code>:</dt>
<dd>
<p>threw an error when <span class="option">H2_integer=TRUE</span>. Thanks to mxdub for finding and fixing this! (Sorry that I managed to click on “comment and close” before “confirm accept merg”; this github interaction is still somewhat new to me.)</p>
</dd>
<dt>Bug fix in <code>betalinkr</code>:</dt>
<dd>
<p>Now standardization to proportions also works for empty webs as division by zero is avoided. 2. <code>specmx.higher.unique</code> can now be assessed even for 1-link-networks, as setting <span class="option">drop=FALSE</span> keeps the dimensions of the matrix. Thanks to Benjamin Schwarz for providing these fixes! (And don't ask me why the pull request on github does not show.)</p>
</dd>
<dt>Added multicolour-option to <span class="option">arrow.col</span> in <code>plotPAC</code>,</dt>
<dd>
<p>following a question by Horacio Silva. We can now colour each arrow of the plot individually, although the sequence of colours provided may require some fiddling around.</p>
</dd>
</dl>
</li>
<li>
<p> 2.15 (release date: 04-Apr-2020)
</p>

<dl>
<dt>A pair of new functions for plotting: <code>sortmatrix</code> and <code>plotmatrix</code>,</dt>
<dd>
<p>both provided by Rafael Pinheiro and Gabriel Felix from the University of Campinas in Brazil. The functions' scope is to plot interaction networks of nested, modular and mixed topology (Pinheiro et al. 2019). As plotting is not the forte of bipartite so far, and these two functions help to add a bit of plotting facilities. Many thanks for contributing!</p>
</dd>
<dt>Bug fix in <code>robustness</code>:</dt>
<dd>
<p>in my previous updates of the discontinued <code>class</code>-issues I managed to omit a crucial “!” in the code. Thanks to Hanlun Liu and Felix Neff for reporting!</p>
</dd>
<dt>Bug fix in <code>extinction</code>:</dt>
<dd>
<p>for sparse networks, the function sometimes returned a vector rather than a matrix, due to incorrectly dropping a dimension. Thanks to Felix Neff for reporting and providing the solution!</p>
</dd>
<dt>Expanded help of <code>as.one.mode</code>:</dt>
<dd>
<p>in particular the way the weights were computed was not documented at all, as pointed out by Lennart Dittmer. This is now rectified and also the R-code now features in-line comments as to what is happening at each step.</p>
</dd>
</dl>
</li>
<li>
<p> 2.14 (release date: 07-Jan-2020)
</p>

<dl>
<dt>Updates</dt>
<dd>
<p>of <code>betalinkr</code>-options.</p>
</dd>
<dt>Future R-version 4.x.x</dt>
<dd>
<p>requires discontinuation of <code>class(x) == "y"</code>-like code (rather using <code>is(x, "y")</code> or <code>inherits(x, "y")</code>). Updated accordingly.</p>
</dd>
<dt>C++-style changes</dt>
<dd>
<p>requiring identifyModules-Arguments to be labelled slightly differently. Impossible to check without setting up a linux chain, but still reason for CRAN not to accept.</p>
</dd> 
</dl>
</li>
<li>
<p> 2.13 (release date: 21-May-2019)
</p>

<dl>
<dt>Several small fixes,</dt>
<dd>
<p>e.g. check for binary networks in <code>nullmodel</code> failed if values &lt; 1 were in the matrix.</p>
</dd>
<dt>Added a lengthy vignette,</dt>
<dd>
<p>illustrating the use of the package.</p>
</dd>
<dt>(Small) bug fix in <code>empty</code>:</dt>
<dd>
<p>something was stupidly wrong for matrices of only one row or column. Spotted by Benjamin Schwarz, thanks!</p>
</dd>
<dt>New function <code>vaznullexternal</code>,</dt>
<dd>
<p>as wished by Matt Funaki. This is the “normal” <code>vaznull</code>-nullmodel, but now external abundances for either or both groups can be provided. Modelled on <code>r2dexternal</code>.</p>
</dd>
<dt>Important bug fix and new option in <code>webs2array</code>:</dt>
<dd>
<p>name indexing was wrong, so that entries were entered in wrong cells. Also, the function now also accepts a weblist as input.</p>
</dd>
<dt>New function <code>betalinkr</code>:</dt>
<dd>
<p>it allows comparison of networks and partitioning of network dissimilarity. Based on betalink package/paper by Tim Poisot, but more integrated into the bipartite package, and importantly implements many more features and corrected partitioning approaches. Two more new functions come with it: <code>array2linkmx</code>, <code>betalinkr_multi</code>.</p>
</dd>
<dt>New function <code>decimalr2dtable</code>:</dt>
<dd>
<p>it allows to simulate matrices with the same marginal totals as the input, but for non-negative, non-integer inputs. Doing so, it “smears” out the entries over the entire matrix and will hence be meaningless for any index comparison which responds to matrix filling. An attempt to deal with webs composed of rates rather than observed interactions. Useful probably only in a very few cases, as marginal totals are unlikely to be interpretable as abundance-activity, and hence implying a very different kind of null model to <code>nullmodel</code>s.</p>
</dd>
</dl>
</li>
<li>
<p> 2.12 (release date: 11-Mar-2019)
</p>

<dl>
<dt>New function <code>nest.smdm</code>
</dt>
<dd>
<p>by Rafael Pinheiro, Gabriel Felix, Marco Mello, and the team of the Ecological Synthesis Lab, University of São Paulo, which computes the nestedness measure NODF (as present in <span class="pkg">vegan</span>) more flexibly, by allowing the matrix to be sorted not only by number of filled cells (think: binary networks), but also by absolute marginal totals. NODF does not work for completely filled matrices, but this version (called NODA) does. Also, <code>nest.smdm</code> compute nesting within modules, if module identities are provided (e.g. by <code>computeModules</code> and the new little helper function <code>module2constraints</code>). All these metrics are computed for binary or weighted networks.</p>
</dd>
<dt>Function <code>NOS</code>
</dt>
<dd>
<p>yields NA when one or more nodes are 0. The original equation allows an alternative way to compute NOS, which has been implemented by tchen98: many thanks!</p>
</dd>
</dl>
</li>
<li>
<p> 2.11 (relase date: 12-Jul-2018)
</p>

<dl>
<dt>Change of defaults in <code>metaComputeModules</code>
</dt>
<dd>
<p>, from <span class="option">DormannStrauss</span> to <span class="option">Beckett</span>. Beckett's algorithm is far less variable in its performance, thus I assumed that one would not actually need <code>metaComputeModules</code> for it at all. However, also <span class="option">Beckett</span> is not foolproof and benefits from a few re-runs with different starting configurations. Now defaults are consistent with <code>computeModules</code>. Thanks to Laura Burkle for raising the issue.</p>
</dd>
<dt>Bug fix in <code>nested</code>
</dt>
<dd>
<p>, which didn't correctly pass through the <span class="option">normalised</span>-argument for index "C score". Also the naming of "C score" (rather than previously "C.score") was changed for consistency with <code>networklevel</code>. Many thanks to Carlos Zamora-Manzur for reporting!</p>
</dd>
<dt>Deprecation of the command <code>register</code> in C++17</dt>
<dd>
<p>required attention in the <code>MersenneTwister.h</code>-code used in <code>computeModules</code>. Thanks to Brian Ripley, for the R Core Team, for notifying all maintainers using this command in advance of future CRAN-submission problems!</p>
</dd>
</dl>
</li>
<li>
<p> 2.10 (release date: 20-Dec-2017)
</p>

<dl>
<dt>Removed option <span class="option">weighted</span>
</dt>
<dd>
<p>from <code>CC</code>, which had no effect on the way <code>sna::closeness</code> computes the value. Thanks to Thais Zanata for making me aware of this!</p>
</dd>
<dt>Fixed bug in option <span class="option">rescaled</span>
</dt>
<dd>
<p>of <code>CC</code>, which did not properly rescale values so that they sum to 1. Thanks to Thais Zanata for making me aware of this!</p>
</dd>
<dt>Added NODF</dt>
<dd>
<p>to the indices available in <code>networklevel</code>.</p>
</dd>
<dt>Added network of Olito &amp; Fox (2015)</dt>
<dd>
<p>as <code>olito2015</code>; data from dryad (URL given in help page).</p>
</dd>
</dl>
</li>
<li>
<p> 2.09 (release date: 30-Jun-2017)	
</p>

<dl>
<dt>Fixed type of object returned by <code>computeModules</code>,</dt>
<dd>
<p>when using <span class="option">method="DormannStrauss"</span>, which I had broken after changing the default. Many thanks to Abdul Shakoor for reporting. Also added an error catcher to exclude, from binary webs, species that interact with every other species (i.e. are all 1; all-0 were already excluded).</p>
</dd>
<dt>Fixed imprecise explanation in <code>plotweb</code>'s</dt>
<dd>
<p><span class="option">low/high.spacing</span>, which now correctly describes its effect on the horizontal space within a level. (Thanks to Jeff Ollerton for reporting.)</p>
</dd>
</dl>
</li>
<li>
<p> 2.08 (release date: 30-Mar-2017)	
</p>

<dl>
<dt>New modularity algorithm called by <code>computeModules</code>.</dt>
<dd>
<p>Although the excellent algorithm <code>DIRT_LPA_wb_plus</code> by Stephen Beckett has been around for a year, I never managed to find the time to put it into bipartite. By now, Stephen has even written a wrapper code so that the output is fully compatible with existing code for plotting (<code>plotModuleWeb</code>) there was really no argument left to postpone it. Stephen's DIRT_LPA_wb_plus will be the new default, replacing 'QuanBiMo', which remains available under <span class="option">method='DormannStrauss'</span>. While DIRT could be called recursively, thereby making modules-within-modules computable, this is not packaged yet. So currently the much slower DormannStrauss-option is the only way to get recursive modules. Many thanks to Stephen for making this code available!</p>
</dd>
<dt>
<code>networklevel</code> and <code>grouplevel</code> inconsistently</dt>
<dd>
<p>returned different values for secondary extinction, because the former by default purged empty columns/rows, while the latter didn't. It does now. Thanks to Gianalberto Losapio for bringing this to my attention.</p>
</dd>
</dl>
</li>
<li>
<p> 2.07 (release date: 08-Nov-2016)
</p>
 
<dl>
<dt>Bug fixed in <code>vaznull</code>,</dt>
<dd>
<p> filled the matrix with 1s instead of 0s (although it was a ‘sophisticated’ logical mistake I made, not a simple typo). Thanks to Sandra Bibiana Corea for reporting! </p>
</dd>
<dt>Small patch in C++-code of binmatnest</dt>
<dd>
<p> for compatibility with clang. Thanks to Brian Ripley for fixing one of these C++-things that I never will understand! (In this case, the original code (by Miguel Rodríguez-Gironés) defined a pointer to "vector", which caused ambiguities in which "vector" should be used during compilation: the such defined pointer, or the std::vector.)</p>
</dd>
<dt>Smaller typographic</dt>
<dd>
<p> and referencing corrections/additions (e.g. in plotPAC).</p>
</dd> 
</dl>
</li>
<li>
<p> 2.06b (release date: 10-May-2016)
</p>
 
<dl>
<dt>Some explanation addded to <code>czvalues</code>,</dt>
<dd>
<p> where a z-value of NA is returned if a species is alone (in its trophic level) in a module. This is due to the way z-values are computed, and not a bug.</p>
</dd>
<dt>Function <code>nestedcontribution</code>
</dt>
<dd>
<p>was not exported in the namespace. Fixed. Thanks to various people reporting this.</p>
</dd>	
</dl>
</li>
<li>
<p> 2.06 (release date: 29-Sep-2015)
</p>
 
<dl>
<dt>Bug fix in <code>C.score</code>,</dt>
<dd>
<p> which did not compute the maximum number of possible checkerboards correctly, and hence let the normalised C-score to be incorrect. Now it uses a brute-force approach, which works fine but takes its time.</p>
</dd>	
<dt>Function <code>nestedcontribution</code>
</dt>
<dd>
<p>was not exported (i.e. not listed in the namespace file). Fixed. Thanks to Wesley Dátillo for reporting.</p>
</dd>
<dt>Help page of <code>specieslevel</code>
</dt>
<dd>
<p>now correctly described a species' degree as sum of its links. Thanks to Bernhard Hoiß for the correction!</p>
</dd>
<dt>C++-warnings addressed:</dt>
<dd>
<p>outcommented some unused variables in dendro.h and removed some fprintf-warnings in bmn5.cc</p>
</dd>
<dt>Little bug fix in <code>vaznull</code>:</dt>
<dd>
<p>Threw an error when matrix was without 0s. Thanks to Thais Zanata for reporting.</p>
</dd>
</dl>
</li>
<li>
<p> 2.05 (release date: 24-Nov-2014)
</p>
 
<dl>
<dt>New function <code>nestedcontribution</code>
</dt>
<dd>
<p>which computes the contribution of each species to the overall nestedness, based on Bascompte et al. 2003 and as used by Saavedra et al. 2011. Many thanks to Daniel Stouffer for contributing this function!</p>
</dd>	
<dt>New function <code>mgen</code>:</dt>
<dd>
<p>this function is based on R-code written by Diego Vázquez (many thanks for sending the code), with a bit of brushing up options by CFD. The function takes a probability matrix generated by whatever mechanism and builds a null model from it. This is a niffty little idea, making null modelling concerned with generating ideas on what makes an interaction probable and leaving the step of producing and integer-network of simulated interactions to this function.</p>
</dd>
<dt>minor fixes in <code>networklevel</code>
</dt>
<dd>
<p>“weighted connectance” was only returned when “linkage density” was in “index” call; now also available on its own. Also sligthly revised the help file.</p>
</dd>
<dt>
<code>nested</code> with option <span class="option">weighted NODF</span> called the unsorted version of this function,</dt>
<dd>
<p>while calling the same index in <code>networklevel</code> called the sorted. This is not nice (although not strictly wrong). Now both call the sorted version and users have to directly invoke <code>nestednodf</code> for the unsorted option. Many thanks to Julian Resasco for reporting!</p>
</dd>
<dt>Changes to the help page of <code>vaznull</code>:</dt>
<dd>
<p>I (CFD) misread the original paper introducing this null model and hence assumed that<code>vaznull</code> would constrain marginal totals <b>and</b> connectance. However, this was not intended in Diego Vázquez original implementation and never stated anywhere (except in the help pages of this function here in bipartite). Hence, the help pages were changed to now reflect both intention and actual action of this function. This also means that currently only one null model with constrained marginal totals <b>and</b> connectance is available: <code>swap.web</code>. Many thanks to Diego for clearing this up!</p>
</dd>
<dt>Some example code had to be re-written</dt>
<dd>
<p>to adapt to the upcoming/new structure of <span class="pkg">vegan</span>, which got rid of function <code>commsimulator</code> (replaced by <code>simulate</code>). Many thanks to Jari Oksanen for informing me about this!</p>
</dd>
<dt>Added an error message</dt>
<dd>
<p>to function <code>second.extinct</code> for the case that a user wants to provide an extinction sequence for both trophic levels. There is no obvious way to simulate this across the two groups, and hence it is not implemented. Also added error messages for non-matching vector/web dimensions and alike.</p>
</dd>
</dl>
</li>
<li>
<p> 2.04 (release date: 25-Mar-2014)
</p>
 
<dl>
<dt>R-C++-communication bug fixed in <code>computeModules</code>:</dt>
<dd>
<p>This bug has been a constant thorn in my side. Somehow the C-code behind <code>computeModules</code> could only be called once. On second call, it returned an error because somehow it kept some old files in memory. So far, I used a work-around (unloading and re-loading the dynamic library), which only worked on Windows and Mac. I still don't fully understand it, but thanks to Tobias Hegemann (whom I paid for being more competent than myself) we now have a function running bug-free on all platforms. (Deep sigh of relief.)</p>
</dd>
<dt>The call of index “functional complementarity” through <code>networklevel</code> did not work.</dt>
<dd>
<p>Fixed this legacy issue, which was due to a confusion created by the index' earlier name of “functional diversity”.</p>
</dd>
<dt>Help page to <code>specieslevel</code> gave incomplete name for one index:</dt>
<dd>
<p>Should be <span class="option">interaction push pull</span>; also the function itself had the “push pull”-bit messed up. Thanks to Natacha Chacoff for reporting!</p>
</dd>
<dt>Sequence of indices differed between lower and higher level. (Fixed.)</dt>
<dd>
<p>Both should be the same and should fit the description in the help file. Thanks to Jimmy O'Donnell for reporting!</p>
</dd>
</dl>
</li>
<li>
<p> 2.03 (release date: 15-Jan-2014)
</p>
 
<dl>
<dt>Some ghost text led to conflicts with the updated package checking.</dt>
<dd>
<p>Ghost text deleted. Thanks to Brian Ripley of the R-Team and CRAN for not only reporting the issue but also pointing to its solution!</p>
</dd>
<dt>Option <span class="option">empty.web</span> added to <code>specieslevel</code>:</dt>
<dd>
<p>Similar to the argument in <code>networklevel</code>; non-interacting species from the network were always excluded so far; new option <span class="option">FALSE</span> not fully tested yet.</p>
</dd>
<dt>Minor bug fix in <code>specieslevel</code>:</dt>
<dd>
<p> “pollination support index” returned “PSI”; “PDI” now referenced correctly as “paired differences index”.</p>
</dd>
<dt>Simplification in <code>grouplevel</code> and correspondingly in <code>networklevel</code>:</dt>
<dd>
<p>Previously, <code>index="generality"</code> or <code>"vulnerability"</code> was identical to <code>"effective partners"</code> with option <code>weighted=TRUE</code>, but different for <code>weighted=FALSE</code> (to which only <code>"effective partners"</code> responded). We reduced this to one index called "generality" or "vulnerability" (depending on the focal group), but which will now give the non-weighted mean if option <code>weighted=FALSE</code>. It can still be called by "effective partners" for backward compatibility.</p>
</dd>
<dt>Function <code>grouplevel</code> used <code>fd</code> wrongly!</dt>
<dd>
<p>Instead of returning the value for rows, it returned the functional diversity for columns (and vice versa). We also used the opportunity to rename the index to its correct name: “functional complementarity” and the function to <code>fc</code>. Help pages for <code>fc</code> and <code>grouplevel</code> were adapted accordingly. Thanks to Mariano Devoto for pointing out this mistake!</p>
</dd>
<dt>New index “weighted connectance” in function <code>networklevel</code>:</dt>
<dd>
<p>This index is simply computed as linkage density divided by number of species in the network. Note that using <span class="option">empty.web=TRUE</span> will affect this value (which is intended). Thanks to Becky Morris for suggesting to add this index here.</p>
</dd>
<dt>Help page for function <code>PDI</code> corrected.</dt>
<dd>
<p>Thanks to Timothy Poisot for reporting some issues in the help page.</p>
</dd>
</dl>
</li>
<li>
<p> 2.02 (release date: 30-Sep-2013)
</p>
 
<dl>
<dt>Glitch fixed in <code>grouplevel</code> (thus also affecting <code>networklevel</code>).</dt>
<dd>
<p>Networks with only one species in one of the two levels resulted in errors, rather than simply return NA for C-score and secondary extinction computation. Thanks to whoever it was for reporting (at the INTECOL workshop).</p>
</dd>
<dt>Minor bug fixes in  <code>specieslevel</code>:</dt>
<dd>
<p>Gave error messages for closeness and betweenness if the network had no shortest path. Now returns a warning and NAs instead. Reported: JF.</p>
</dd>
<dt>Minor bux fix in  <code>networklevel</code>:</dt>
<dd>
<p>Failed to work when an index was listed twice in the function call. Reported: JF.</p>
</dd>
<dt>New function <code>r2dexternal</code>:</dt>
<dd>
<p>This function is a null model algorithm like Patefields (<code>r2dtable</code>, but it excepts externally measured abundances to compute the null model-expectation. Experimental.</p>
</dd>
<dt>Memory leak in <code>computeModules</code> fixed.</dt>
<dd>
<p>Because some object was not deleted, memory consumption of this function shot through the roof (with time). Since R has a somewhat weird way of handling memory, I think that also subsequent operations were slower (because the dynamically expanded memory is not being shrunken again, which is a problem if you use the hard drive as RAM). Thanks to Florian Hartig for investing the time to fix it!</p>
</dd>
</dl>
</li>
<li>
<p> 2.01 (release date: 28-Jun-2013)
This release features smoothing of various glitches that were introduced when we cleaned up the code for version 2.00.
</p>
 
<dl>
<dt>New index for <code>specieslevel</code>:</dt>
<dd>
<p>Computes the nestedness rank (as proposed by Alarcon et al. 2008). Can also be employed directly using the <b>new function</b> <code>nestedrank</code> with options for weighting for number of interactions per link, normalising the rank and different method to compute the nestedness-arranged matrix.</p>
</dd>
<dt>Polishing <code>specieslevel</code>:</dt>
<dd>
<p>Now returns an error message if the index is not recognised, instead of an empty list.</p>
</dd>
<dt>Function <code>plotweb</code>
</dt>
<dd>
<p>received an option to plot additional individuals of a species in different ways. For a host-parasitoid network, some hosts are not parasitised. This data vector can now be interpreted in two ways, making the plotting function a bit more flexible.</p>
</dd> </dl>
<dl>
<dt>Function <code>degreedistr</code>
</dt>
<dd>
<p>can now be invoked for each level separately. Also arguments can be passed to the plotting options.</p>
</dd>
<dt>New data set <code>junker2013</code>:</dt>
<dd>
<p>a nice and large pollination network. Thanks to Robert Junker for providing this data set!</p>
</dd>
<dt>Fixed computation of secondary extinction slopes for both levels simultaneously</dt>
<dd>
<p>for random extinction sequences. This was so far not possible, because the function did not combine extinction sequences of different lengths. This was simply an oversight, reported by Richard Lance. (Thanks!)</p>
</dd>
</dl>
</li>
<li>
<p> 2.00 (release date: 15-Mar-2013)
A new version number usually indicates substantial changes. In this case, we have re-named and re-grouped some of the output of <code>networklevel</code> and <code>specieslevel</code> for greater consistency and transparency. Beware! Running the same functions now (2.00 and up) will yield different results to &lt;2.00 (because the same values are now in a different sequence).
</p>
<p>We also started carefully renaming indices and re-writing help files. The main reason is that we started this work thinking of pollination networks. Over time, however, other types of ecological networks came into focus, and now also non-ecological networks are on the table. Thus, we started (and shall continue) referring to lower and higher levels, rather than plant and pollinators, hosts and predators or even trophic levels. Thus, in our emerging nomenclature the two levels are referred to as “groups” (their members remain “species” interacting with their “partners” in the other group). 
</p>
<p>Please read (or at least skim) the help pages before using a function of version 2.00 for the first time. 
</p>
<p>In function <code>specieslevel</code> indices can now be computed for levels separately (or together). Few user-visible changes, but complete re-structuring under the hood. Option <span class="option">species number</span> was moved to <code>grouplevel</code> as <span class="option">number of species</span>.
</p>
<p>In the new function <code>grouplevel</code> we collected all indices that can be computed for each of the two groups (i.e. trophic or other levels). Indices can be computed for each group separately or for both simultaneously. All group-level indices are also accessible through <code>networklevel</code>!
</p>
<p>In the new function <code>linklevel</code> we collected all indices that can be computed for each cell of the bipartite matrix. Currently, there are few such indices, however.
</p>
<p>In function <code>networklevel</code> we dropped the plotting options. Users wanting to plot degree distributions or extinction slopes are encouraged to use the functions <code>degreedistr</code> and <code>slope.bipartite</code>, respectively.
</p>
<p>Furthermore, due to licensing issues, we copy-pasted several functions from the package <b>tnet</b>, created and maintained by Tore Opsahl, to bipartite. We have so far called these functions from tnet, but only recently did R start to enforce license compatibility, which caused this step (bipartite being GPL and tnet being CC by-NC 3.0). We are really very grateful to Tore for allowing us to include the following functions: <code>as.tnet</code>, <code>betweenness_w</code>, <code>closeness_w</code>, <code>clustering_tm</code>, <code>distance_w</code>, <code>symmetrise_w</code>, <code>tnet_igraph</code>.
</p>
<p>Here a more detailed list of changes:
</p>

<dl>
<dt><code>networklevel</code></dt>
<dd>

<ul>
<li>
<p> Function call and output now more consistent in naming and sequence. When higher and lower level indices are given (e.g. extinction slopes, number of shared partners), the first will always be the one referring to the property of the <em>lower</em> level. From a pollinator network perspective, the first value in such a pair describes a plant-level index, the second a pollinator-level index.
</p>
</li>
<li>
<p> Indices <span class="option">mean interaction diversity</span> dropped from <code>networklevel</code>. We found no reference to this metric and saw little use for it. It is very similar to vulnerability/generality and can easily be computed from the output of <code>specieslevel</code> as <code>mean(specieslevel(web, index="diversity"))</code>.
</p>
</li>
<li>
<p>  Now also accepts non-integer values as input. The argument <span class="option">H2_integer</span> will then automatically be set to FALSE. Will return NA for those indices that cannot be computed (e.g. Fisher's alpha). As a knock-on effect, <code>H2fun</code> had to be slightly adapted to round to machine precision when searching for H2min. (A somewhat technical detail, but making <code>H2fun</code> getting caught sometimes.)
</p>
</li>
</ul>
</dd>
<dt>New function <code>grouplevel</code>
</dt>
<dd>
<p>in which we collected indices that can be computed for each of the two groups (i.e. trophic or other levels). Indices can be computed for each group separately or for both simultaneously. All group-level indices are also accessible through <code>networklevel</code>!</p>
</dd>
<dt>New function <code>linklevel</code>
</dt>
<dd>
<p>in which we collect indices that can be computed for each cell of the bipartite matrix.</p>
</dd>
</dl>
<dl>
<dt>New option to <code>PDI</code>:</dt>
<dd>
<p><span class="option">normalise=FALSE</span> offers the option of using the index as originally proposed, although we prefer to use TRUE and made this the default. </p>
</dd>
<dt>Corrected network <code>bezerra2009</code>.</dt>
<dd>
<p>Network was actually the transpose of the correct network and hence wrongly had plant species as columns.</p>
</dd>
<dt>New function <code>endpoint</code>
</dt>
<dd>
<p>computes end-point degrees following Barrat et al. (2004); one of the indices computed at <code>linklevel</code>.</p>
</dd>
<dt>New function <code>frame2webs</code>
</dt>
<dd>
<p>helps organising data into one or more webs.</p>
</dd>
<dt>New function <code>webs2array</code>
</dt>
<dd>
<p>helps organising webs into one array.</p>
</dd>
<dt>Function <code>specieslevel</code>
</dt>
<dd>
<p>gained two new indices (thanks to Jochen Fründ): <span class="option">proportional</span> <span class="option">similarity</span> and <span class="option">proportional generality</span>. See help page of that function for details.</p>
</dd>
<dt>New function <code>npartite</code>
</dt>
<dd>
<p>Experimental function to analyse more-than-2-level networks.</p>
</dd>
<dt><code>visweb</code></dt>
<dd>
<p>now obeys the label size to make sure labels are always in the plotting area. Thanks to Zachary Grinspan 
for drawing our attention to this issue.</p>
</dd>
<dt>Little bug fix in <code>second.extinct</code>
</dt>
<dd>
<p>Function failed for argument <span class="option">participant="both"</span> because I filled the extinction sequence with the wrong number of 0s (to achieve always the same dimensionality of results in repeated runs). Thanks to Carine Emer for reporting!</p>
</dd>
<dt><code>specieslevel</code></dt>
<dd>
<p>failed to work for non-matrix data (i.e. <code>data.frames</code>). It now coerces <code>data.frames</code> to <code>matrix</code> as a first step and hence should work also on <code>data.frame</code>s. Thanks to Marina Wolowski for drawing our attention to this problem.</p>
</dd>
<dt>Minor bug fix in <code>dfun</code>:</dt>
<dd>
<p>When external abundances were provided with a 0 in it, <code>dfun</code> could throw up <code>Inf</code>-values. Reported by Indrani Singh and fixed by Jochen Fründ.</p>
</dd>
<dt>Settings for functions called by <code>nested</code>
</dt>
<dd>
<p>are now enshrined in stone. The initial reason was to set only the default for one function (<code>nestedness</code>) to a faster setting (<span class="option">null.models=FALSE</span>), but then I decided to restrict all settings to the defaults of the functions called (except for this one option).</p>
</dd>
<dt>Bug fix for the rarely used function <code>null.t.test</code>:</dt>
<dd>
<p>Did not work if only one index was given.</p>
</dd>
</dl>
</li>
</ul>
<h3>Author(s)</h3>

<p>Carsten F. Dormann, Jochen Fründ and Bernd Gruber, with additional code from many others (referred to in the respective help file), noticeably from Tore Opsahl's tnet package.
</p>
<p>Maintainer: Carsten Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>
</p>


<h3>References</h3>

<p>Alarcon, R., Waser, N.M. and Ollerton, J. 2008. Year-to-year variation in the topology of a plant-pollinator interaction network. <em>Oikos</em> <b>117</b>, 1796–1807
</p>
<p>Almeida-Neto, M. and Ulrich, W. (2011) A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environmental Modelling &amp; Software</em>, <b>26</b>, 173–178
</p>
<p>Bascompte, J., Jordano, P. and Olesen, J. M. (2006) Asymmetric coevolutionary networks facilitate biodiversity maintenance. <em>Science</em> <b>312</b>, 431–433
</p>
<p>Beckett, S.J. 2016. Improved community detection in weighted bipartite networks. <em>Royal Society open science</em> <b>3</b>, 140536
</p>
<p>Bersier, L. F., Banasek-Richter, C. and Cattin, M. F. (2002) Quantitative descriptors of food-web matrices. <em>Ecology</em> <b>83</b>, 2394–2407
</p>
<p>Blüthgen, N., Menzel, F. and Blüthgen, N. (2006) Measuring specialization in species interaction networks. <em>BMC Ecology</em> <b>6</b>, 12
</p>
<p>Blüthgen, N., Menzel, F., Hovestadt, T., Fiala, B. and Blüthgen, N. (2007) Specialization, constraints, and conflicting interests in mutualistic networks. <em>Current Biology</em> <b>17</b>, 1–6
</p>
<p>Corso G., de Araújo A.I.L. and de Almeida A.M. (2008) A new nestedness estimator in community networks. <em>arXiv</em>, 0803.0007v1 [physics.bio-ph]
</p>
<p>Dalsgaard, B., A. M. Martín González, J. M. Olesen, A. Timmermann, L. H. Andersen, and J. Ollerton. (2008) Pollination networks and functional specialization: a test using Lesser Antillean plant-hummingbird assemblages. <em>Oikos</em> <b>117</b>, 789–793
</p>
<p>Devoto M., Bailey S., Craze P. &amp; Memmott J. (2012) Understanding and planning ecological restoration of plant-pollinator networks.
<em>Ecology Letters</em> <b>15</b>, 319–328
</p>
<p>Dormann, C.F., Fründ, J., Blüthgen, N., and Gruber, B. (2009) Indices, graphs and null models: analysing bipartite ecological networks. <em>The Open Ecology Journal</em> <b>2</b>, 7–24
</p>
<p>Dormann, C.F. (2011) How to be a specialist? Quantifying specialisation in pollination networks. <em>Network Biology</em> <b>1</b>, 1–20
</p>
<p>Galeano J., Pastor J.M. and Iriondo J.M. (2008) Weighted-Interaction Nestedness Estimator (WINE): A new estimator to calculate over frequency matrices. <em>arXiv</em> 0808.3397v1 [physics.bio-ph]
</p>
<p>Jost, L. (2006). Entropy and diversity. <em>Oikos</em>, <b>113</b>, 363–375. https://doi.org/10.1111/j.2006.0030-1299.14714.x
</p>
<p>Jost, L. (2010). The relation between evenness and diversity. <em>Diversity</em>, <b>2</b>, Article 2. https://doi.org/10.3390/d2020207
</p>
<p>Martín Gonzáles, A.M., Dalsgaard, B. and Olesen, J.M. (2009) Centrality measures and the importance of generalist species in pollination networks. <em>Ecological Complexity</em>, <b>7</b>, 36–43
</p>
<p>Memmott, J., Waser, N. M. and Price, M. V. (2004) Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605–2611
</p>
<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. (2004) Experimental evidence for apparent competition in a tropical forest food web. <em>Nature</em> <b>428</b>, 310–313
</p>
<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. (2005) Apparent competition and insect community structure: towards a spatial perspective. <em>Annales Zoologica Fennici</em> <b>42</b>, 449–462.
</p>
<p>Müller, C. B., Adriaanse, I. C. T., Belshaw, R. and Godfray, H. C. J. (1999) The structure of an aphid-parasitoid community. <em>Journal of Animal Ecology</em> <b>68</b>, 346–370
</p>
<p>Pinheiro, R.B.P. et al. 2019. A new model explaining the origin of different topologies in interaction networks. <em>Ecology</em> <b>100</b>, 1–30
</p>
<p>Poisot, T., Lepennetier, G., Martinez, E., Ramsayer, J., and Hochberg, M.E. (2011a) Resource availability affects the structure of a natural bacteria-bacteriophage community. <em>Biology Letters</em> <b>7</b>, 201–204
</p>
<p>Poisot, T., Bever, J.D., Nemri, A., Thrall, P.H., and Hochberg, M.E. (2011b) A conceptual framework for the evolution of ecological specialisation. <em>Ecology Letters</em> <b>14</b>, 841–851
</p>
<p>Tylianakis, J. M., Tscharntke, T. and Lewis, O. T. (2007) Habitat modification alters the structure of tropical host-parasitoid food webs. <em>Nature</em> <b>445</b>, 202–205
</p>
<p>Vázquez, D. P. and Aizen, M. A. (2004) Asymmetric specialization: A pervasive feature of plant-pollinator interactions. <em>Ecology</em> <b>85</b>, 1251–1257
</p>
<p>Vázquez, D.P., Chacoff, N.,P. and  Cagnolo, L. (2009) Evaluating multiple determinants of the structure of plant-animal mutualistic networks. <em>Ecology</em> <b>90</b>, 2039–2046.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(Safariland)
plotweb(Safariland)
visweb(Safariland)
networklevel(Safariland)
specieslevel(Safariland)

## End(Not run)
</code></pre>


</div>