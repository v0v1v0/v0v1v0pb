<div class="container">

<table style="width: 100%;"><tr>
<td>mpl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Joint models for clustered data with binary and survival outcomes.
</h2>

<h3>Description</h3>

<p>{mpl} is a function to fit a joint model for clustered binary and survival data using maximum penalized likelihood (MPL) method  with Jackknife variance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpl(formula, ...)

## S3 method for class 'formula'
mpl(formula, formula.glm, formula.cluster, data, weights=NULL,
    subset = NULL, max.iter=100, tol = 0.005, jackknife=TRUE, ...)
#
# Use:
#
# fit = mpl(Surv(time, status)~w+z, y~x1+x2, ~cluster, data=data)
#
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula"(or one that can be coerced to
that class): a symbolic description of the Cox proportiobal hazards model to be fitted
for survival data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.glm</code></td>
<td>
<p>an object of class "formula"(or one that can be coerced to 
that class): a symbolic description of the generalized linear model to be fitted for 
binary data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.cluster</code></td>
<td>
<p>an object of class "formula"(or one that can be coerced to
that class): a symbolic description of the cluster variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by 
'as.data.frame' to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the enviro
nment from which mpl is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be 'NULL' or a numeric vector. If non-NULL, weights options 
in the glm model and the coxph model will be assinged with the supplied weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>only a subset of data will be used for model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Maximum number of iterations, default is max.iter = 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolrance for convergence, default is tol = 0.005</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackknife</code></td>
<td>
<p>Jackknife method for variance, default is jackknife = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level regression fitting 
functions (see below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>mpl(Surv(time, event)~w+z, y~x1+x2, ~cluster) will fit penalized likelihood for binary and survival data with cluster effect.
Function print(x) can be used to print a summary of mpl results.
</p>


<h3>Value</h3>


<p>mpl returns an object of class inheriting from "mpl". 
When jackknife = TRUE, an object of class "mpl" is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the maximum estimate of the regression coefficients and varaince component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR_HR</code></td>
<td>
<p>Odds ratios (OR) and hazard ratios (HR) for binary and survival outcomes, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ase</code></td>
<td>
<p>Asymptotic standard error for theta, which is usually understimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jse</code></td>
<td>
<p>Jackknife standard error of theta based on resampling, this is considered to be more robust</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Based on code from J. Wang.
</p>


<h3>Author(s)</h3>

<p>Bingshu E. Chen (bingshu.chen@queensu.ca)
</p>


<h3>References</h3>

<p>Chen, B. E. and Wang, J. (2020). Joint modelling of binary response and survival for clustered data in clinical trials. Statistics in Medicine. Vol 39. 326-339.
</p>


<h3>See Also</h3>


<p><code>coxph</code>, 
<code>glm</code>, 
<code>print</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
### No run
# 
# fit = mpl(Surv(time, event)~trt+ki67, resp~trt+age, ~center.id) 
#
</code></pre>


</div>