<div class="container">

<table style="width: 100%;"><tr>
<td>tolfind.boxcox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Grid search over tol for NPPML estimation of random effect and variance component models</h2>

<h3>Description</h3>

<p>A grid search over the parameter <code>tol</code>, to set the initial values of
the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tolfind.boxcox(
  formula,
  groups = 1,
  data,
  K = 3,
  lambda = 1,
  EMdev.change = 1e-04,
  plot.opt = 2,
  s = 15,
  steps = 500,
  find.in.range = c(0, 1.5),
  start = "gq",
  verbose = FALSE,
  noformat = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of mass points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>Set <code>plot.opt=2</code>, to plot the EM trajectories and the development of the disparity over
iteration number.  And <code>plot.opt=0</code>, for none of them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>number of points in the grid search of <code>tol</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find.in.range</code></td>
<td>
<p>search in a range of <code>tol</code>, with default (0,1.5) in
step of 0.1 .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version "quantile" or Gaussian Quadrature "gq" can be
set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noformat</code></td>
<td>
<p>Set <code>noformat = TRUE</code>, to change the formatting of the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A grid search over <code>tol</code> can be performed using <code>tolfind.boxcox()</code>
function, which works for <code>np.boxcoxmix()</code> to find the
optimal solution.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MinDisparity</code></td>
<td>
<p>the minimum disparity found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mintol</code></td>
<td>
<p>the
value of <code>tol</code> corresponding to <code>MinDisparity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AllDisparities </code></td>
<td>
<p>a vector containing all disparities calculated on the
grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alltol </code></td>
<td>
<p>list of <code>tol</code> values used in the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AllEMconverged </code></td>
<td>
<p>1 is TRUE, means the EM algorithm converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the Bayesian information criterion of the fitted regression model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>See Also</h3>

<p><code>np.boxcoxmix</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The Pennsylvanian Hospital Stay Data
data(hosp, package = "npmlreg")
test1 &lt;- tolfind.boxcox(duration ~ age , data = hosp, K = 2, lambda = 0, 
           find.in.range = c(0, 2), s = 10,  start = "gq")
# Minimal Disparity: 137.8368 at tol= 2 
# Minimal Disparity with EM converged: 137.8368 at tol= 2

# Effect of Phenylbiguanide on Blood Pressure
data(PBG, package = "nlme")
test2 &lt;- tolfind.boxcox(deltaBP ~ dose , groups = PBG$Rabbit, find.in.range = c(0, 2),
    data = PBG, K = 2, lambda = -1, s = 15,  start = "quantile", plot.opt = 0)
test2$Mintol
# [1] 1.6
test2$MinDisparity
# [1] 449.5876








</code></pre>


</div>