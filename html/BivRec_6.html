<div class="container">

<table style="width: 100%;"><tr>
<td>bivrecNP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric Analysis of Bivariate Alternating Recurrent Event Gap Time Data</h2>

<h3>Description</h3>

<p>This function allows users to estimate the joint cumulative distribution function (cdf) for the two types of gap times (xij, yij), the marginal survival function for the Type I gap times (xij), and the conditional cdf for the Type II gap times (yij) given the Type I gap times (xij). See details for the estimation methods provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bivrecNP(response, ai, u1, u2, level, conditional, given.interval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A response object of class <code style="white-space: pre;">⁠bivrecSurv⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ai</code></td>
<td>
<p>See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1</code></td>
<td>
<p>A vector or single number to be used for the estimation of joint cdf P(Type I gap times <code class="reqn">\le</code> u1, Type II gap times <code class="reqn">\le</code> u2) in the nonparametric method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2</code></td>
<td>
<p>A vector or single number to be used for the estimation of joint cdf P(Type I gap times <code class="reqn">\le</code> u1, Type II gap times <code class="reqn">\le</code> u2) in the nonparametric method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The confidence level for confidence intervals for joint cdf, marginal survival probability and conditional cdf. Must be between 0.50 and 0.99. Default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditional</code></td>
<td>
<p>A logical value. If TRUE, this function will calculate the conditional cdf for the Type II gap time given an interval of the Type I gap time and the bootstrap standard error and confidence interval at the specified confidence level. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given.interval</code></td>
<td>
<p>A vector c(v1, v2) that must be specified if conditional = TRUE. The vector indicates an interval for the Type I gap time to use for the estimation of the cdf of the Type II gap time given this interval.
If given.interval = c(v1, v2), the function calculates P(Type II gap times <code class="reqn">\le</code> y | v1 <code class="reqn">\le</code> Type I gap times <code class="reqn">\le</code> v2). The given values v1 and v2 must be in the range of gap times in the estimated marginal survival.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code style="white-space: pre;">⁠ai⁠</code> indicates a real non-negative function of censoring times to be used as weights in the nonparametric method. This variable can take on values of 1 or 2 which indicate:
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠ai=1⁠</code> (default): the weights are simply 1 for all subjects, <code class="reqn">a(Ci) = 1</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠ai=2⁠</code>: the weight for each subject is the subject's censoring time, <code class="reqn">a(Ci) = Ci</code>.
</p>
</li>
</ul>
<p>Related methods: <code style="white-space: pre;">⁠plot.bivrecNP⁠</code>, <code style="white-space: pre;">⁠head.bivrecNP⁠</code>, <code style="white-space: pre;">⁠print.bivrecNP⁠</code>.
</p>


<h3>Value</h3>

<p>A bivrecNP object that contains:
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠joint_cdf⁠</code>
</p>
</li>
<li> <p><code style="white-space: pre;">⁠marginal_survival⁠</code>
</p>
</li>
<li> <p><code style="white-space: pre;">⁠conditional_cdf⁠</code> (when conditional = TRUE)
</p>
</li>
<li> <p><code style="white-space: pre;">⁠formula⁠</code>
</p>
</li>
<li> <p><code style="white-space: pre;">⁠ai⁠</code>
</p>
</li>
<li> <p><code style="white-space: pre;">⁠level⁠</code>
</p>
</li>
<li> <p><code style="white-space: pre;">⁠given.interval⁠</code> (when conditional = TRUE)
</p>
</li>
<li> <p><code style="white-space: pre;">⁠xij, yij⁠</code>
</p>
</li>
<li> <p><code style="white-space: pre;">⁠new_data⁠</code>
</p>
</li>
</ul>
<h3>References</h3>

<p>Huang CY, Wang MC. (2005). Nonparametric estimation of the bivariate recurrence time distribution. Biometrics, 61: 392-402.
doi: <a href="https://doi.org/10.1111/j.1541-0420.2005.00328.x">10.1111/j.1541-0420.2005.00328.x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

library(BivRec)

# Simulate bivariate alternating recurrent event data
set.seed(28)
sim_data &lt;- simBivRec(nsize=100, beta1=c(0.5,0.5), beta2=c(0,-0.5),
            tau_c=63, set=1.1)
bivrecsurv_data &lt;- with(sim_data, bivrecSurv(id, epi, xij, yij, d1, d2))
npresult &lt;- bivrecNP(response = bivrecsurv_data, ai=1,
                     u1 = seq(2, 20, 2), u2 = seq(1, 14, 2), level=0.99)
head(npresult)
plot(npresult)

#This is an example with longer runtime

 npresult2 &lt;- bivrecNP(response = bivrecsurv_data, ai=1,
               u1 = seq(2, 20, 1), u2 = seq(1, 15, 1), conditional = TRUE,
               given.interval = c(0, 10), level = 0.99)
 head(npresult2)
 plot(npresult2)

## End(Not run)

</code></pre>


</div>