<div class="container">

<table style="width: 100%;"><tr>
<td>bpcp2samp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Melded BPCP test
</h2>

<h3>Description</h3>

<p>Tests for dissimilarity between two groups in their survival distributions at a fixed point in time. Can operationalize that dissimilarity as 'difference', 'ratio' or 
'oddsratio'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bpcp2samp(time, status, group, testtime, 
    parmtype = c("difference", "oddsratio", "ratio","cdfratio",
        "one.minus.ratio","one.minus.cdfratio"), 
    nullparm = NULL, 
    alternative = c("two.sided", "less", "greater"), 
    conf.level = 0.95, 
    midp=FALSE,
    changeGroupOrder=FALSE,
    control = bpcp2sampControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>time to event for each observation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>

<p>status of event time, 1 is observed, 0 is right censored
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>group for test, should have two levels, to change order use as factor and change order of levels
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testtime</code></td>
<td>

<p>fixed time when you want to test for a difference
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmtype</code></td>
<td>

<p>parameter type for comparing the survival function of the two groups, either 'difference' 'ratio' 'oddsratio' 'cdfratio' 'one.minus.ratio' or 'one.minus.cdfratio'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullparm</code></td>
<td>

<p>null value of the parameter of interest, default of NULL gives 0 if parmtype='difference' and 1 otherwise
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>character, either 'two.sided','less', or 'greater' 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>confidence level, e.g., 0.95
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midp</code></td>
<td>
<p>logical, do mid-p tests and confidence intervals?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changeGroupOrder</code></td>
<td>
<p>logical, change the order of the groups?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>list of control parameters, see <code>bpcp2sampControl</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The melded confidence interval method is a very general procedure to create confidence intervals for the two sample tests by combining one sample confidence intervals. If S1 and S2 are the survival value at <code>testtime</code> from sample 1 (first value of <code>group</code>) and sample 2 (second value of <code>group</code>) respectively, then 
we can get confidence intervals on the S2-S1 (<code>parmtype='difference'</code>), S2/S1 (<code>parmtype='ratio'</code>), 
(S2*(1-S1))/(S1*(1-S2)) (<code>parmtype='oddsratio'</code>), (1-S1))/(1-S2)=F1/F2 (<code>parmtype='cdfratio'</code>),  1-S2/S1 (<code>parmtype='one.minus.ratio'</code>), 
or 1-(1-S1))/(1-S2)=1-F1/F2(<code>parmtype='one.minus.cdfratio'</code>). 
</p>
<p>The resulting melded CIs appear to guarantee coverage as long as the one sample confidence intervals from which the melded CIs are derived have guaranteed coverage themselves. So since we use the BPCP for the one sample intervals and they appear to guarantee coverage (see Fay, Brittain, and Proschan, 2013), we expect the melded BPCP intervals to have at least nominal coverage. Note that when there is no censoring the melded CIs derived from the one-sample BPCPs, give matching inferences to Fisher's exact test (i.e., give theoretically identical p-values) when testing the null hypothesis of equality (S1=S2).  For details see Fay, Proschan and Brittain (2015).   
</p>
<p>The original melded CIs focused on combining one sample CIs that that guarantee coverage. We can apply the melding to other CIs as well, such as the mid-p style CIs. The mid-p CIs are not designed to guarantee coverage, but are designed to have close to the nominal coverage 'on average' over all the possible values of the parameters. The usual p-value is derived from Pr[ see observed data or more extreme under null], while the mid p-value version comes from (1/2) Pr[see obs data] + Pr[ see more extreme data]. Mid-p CIs come from inverting the test that uses the mid p-value instead of the usual p-value. 
</p>


<h3>Value</h3>

<p>A list with class "htest" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>estimate of S1, survival at testtime for group 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>estimate of S2, survival at testtime for group 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value for the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a confidence interval for the parameter determined by <code>parmtype</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>estimate of parameter determined by <code>parmtype</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>the specificed null hypothesized value of the parameter determined by <code>parmtype</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>type of alternative with respect to the null.value, either 'two.sided', 'greater' or 'less'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string describing the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string describing the parameter determined by <code>parmtype</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael P. Fay
</p>


<h3>References</h3>

<p>Fay, MP, Brittain, E, and Proschan, MA. (2013). Pointwise Confidence Intervals for a Survival Distribution with Small Samples or Heavy Censoring.  Biostatistics 14(4): 723-736
doi: 10.1093/biostatistics/kxt016. (copy available at http://www.niaid.nih.gov/about/organization/dcr/brb/staff/Pages/michael.aspx).  
</p>
<p>Fay, MP, Proschan, MA, and Brittain, E (2015) Combining One Sample Confidence Procedures for Inferences in the Two Sample Case. Biometrics 71:146-156. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(leuk2)
# test difference of S(20) values
# S(20)=survival function at 20 weeks 
bpcp2samp(leuk2$time,leuk2$status,leuk2$treatment,
   20,parmtype="difference")
# test ratio of S(20) in two treatment groups, 
bpcp2samp(leuk2$time,leuk2$status,leuk2$treatment,
   20,parmtype="ratio")
# change the order of the group variable to get the other ratio 
bpcp2samp(leuk2$time,leuk2$status,leuk2$treatment,20,
   parmtype="ratio",changeGroupOrder=TRUE)
# estimate treatment effect= 1 - F(20,trt)/F(20,plac), 
#   where F(20)=1-S(20) = Pr(T &lt;=20) is the 
#   cumulative distribution function 
# Test whether treatment effect is greater than 30 pct
bpcp2samp(leuk2$time,leuk2$status,leuk2$treatment,20,
    parmtype="one.minus.cdfratio",nullparm=0.30,
    alternative="greater",
    changeGroupOrder=FALSE)
</code></pre>


</div>