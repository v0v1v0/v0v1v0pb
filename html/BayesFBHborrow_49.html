<div class="container">

<table style="width: 100%;"><tr>
<td>GibbsMH.NoBorrow</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GibbsMH sampler, without Bayesian Borrowing</h2>

<h3>Description</h3>

<p>An MCMC sampler for time-to-event data, without Bayesian Borrowing.
We obtain a flexible baseline hazard function by making the split points 
random within a piecewise exponential model and using a Gaussian Markov 
random field prior to smooth the baseline hazards. Only calls the sampler and
does not run any input checks. Best practice is to call BayesFBHborrow(), if the 
user is not familiar with the model at hand.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'NoBorrow'
GibbsMH(
  Y,
  I,
  X = NULL,
  Y_0 = NULL,
  I_0 = NULL,
  X_0 = NULL,
  tuning_parameters,
  hyperparameters = list(a_sigma = 1, b_sigma = 1, phi = 3, clam_smooth = 0.8),
  lambda_hyperparameters = list(a_lambda = 0.01, b_lambda = 0.01),
  iter = 1500L,
  warmup_iter = 10L,
  refresh = 0,
  max_grid = 2000L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>event indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_0</code></td>
<td>
<p>historical data, default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I_0</code></td>
<td>
<p>historical event indicator, default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_0</code></td>
<td>
<p>historical design matrix, default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning_parameters</code></td>
<td>
<p>list of "cprop_beta", "Jmax",
and "pi_b"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperparameters</code></td>
<td>
<p>list containing the hyperparameters c("a_sigma",
"b_sigma", "Jmax", "clam_smooth", "cprop_beta", "phi"). Default is 
list("a_sigma" = 2, "b_sigma" = 2, "Jmax" = 20, "clam_smooth" = 0.8, 
"cprop_beta" = 0.5, "phi" = 3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_hyperparameters</code></td>
<td>
<p>contains two hyperparameters ("a" and "b") used for
the update of lambda, default is c(0.01, 0.01)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations for MCMC sampler, excluding warmup, 
default is 2000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmup_iter</code></td>
<td>
<p>number of warmup iterations (burn-in) for MCMC sampler, 
default is 2000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refresh</code></td>
<td>
<p>number of iterations between printed screen updates, 
default is 500</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_grid</code></td>
<td>
<p>grid size for the smoothed baseline hazard, default is 2000</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with values after each iteration for parameters: out_fixed (J, 
mu, sigma2, beta), lambda, s, as well as tuning values of the total number 
of accepts: lambda_move and beta_move. Also included is the out_slam which 
contains the shrunk estimate of the baseline hazard.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# Load example data and set your hyper parameters
data(weibull_cc, package = "BayesFBHborrow")
data(weibull_hist, package = "BayesFBHborrow")

# The datasets consists of 3 (2) columns named "tte", "event" and "X".
# To explicitly run the sampler, extract the samples as following
Y &lt;- weibull_cc$tte
I &lt;- weibull_cc$event
X &lt;- matrix(weibull_cc$X_trt)

# Specify hyperparameters and tuning parameters
hyper &lt;-  list("a_sigma" = 2,
               "b_sigma" = 2,
               "clam_smooth" = 0.5,
               "phi" = 3)

tuning_parameters &lt;- list("Jmax" = 5,
                          "pi_b" = 0.5,
                          "cprop_beta" = 0.5)
                          
# Set initial values to 'NULL' for default settings
output &lt;- GibbsMH(Y, I, X, NULL, NULL, NULL,
                  tuning_parameters = tuning_parameters, hyperparameters = hyper, 
                  iter = 5, warmup_iter = 1)
</code></pre>


</div>