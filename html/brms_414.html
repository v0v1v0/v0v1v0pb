<div class="container">

<table style="width: 100%;"><tr>
<td>sar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial simultaneous autoregressive (SAR) structures</h2>

<h3>Description</h3>

<p>Set up an spatial simultaneous autoregressive (SAR) term in <span class="pkg">brms</span>. The
function does not evaluate its arguments â€“ it exists purely to help set up a
model with SAR terms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sar(M, type = "lag")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>An object specifying the spatial weighting matrix.
Can be either the spatial weight matrix itself or an
object of class <code>listw</code> or <code>nb</code>, from which
the spatial weighting matrix can be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of the SAR structure. Either <code>"lag"</code>
(for SAR of the response values) or <code>"error"</code>
(for SAR of the residuals). More information is
provided in the 'Details' section.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>lagsar</code> structure implements SAR of the response values:
</p>
<p style="text-align: center;"><code class="reqn">y = \rho W y + \eta + e</code>
</p>

<p>The <code>errorsar</code> structure implements SAR of the residuals:
</p>
<p style="text-align: center;"><code class="reqn">y = \eta + u, u = \rho W u + e</code>
</p>

<p>In the above equations, <code class="reqn">\eta</code> is the predictor term and <code class="reqn">e</code> are
independent normally or t-distributed residuals. Currently, only families
<code>gaussian</code> and <code>student</code> support SAR structures.
</p>


<h3>Value</h3>

<p>An object of class <code>'sar_term'</code>, which is a list
of arguments to be interpreted by the formula
parsing functions of <span class="pkg">brms</span>.
</p>


<h3>See Also</h3>

<p><code>autocor-terms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(oldcol, package = "spdep")
fit1 &lt;- brm(CRIME ~ INC + HOVAL + sar(COL.nb, type = "lag"),
            data = COL.OLD, data2 = list(COL.nb = COL.nb),
            chains = 2, cores = 2)
summary(fit1)
plot(fit1)

fit2 &lt;- brm(CRIME ~ INC + HOVAL + sar(COL.nb, type = "error"),
            data = COL.OLD, data2 = list(COL.nb = COL.nb),
            chains = 2, cores = 2)
summary(fit2)
plot(fit2)

## End(Not run)

</code></pre>


</div>