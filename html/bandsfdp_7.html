<div class="container">

<table style="width: 100%;"><tr>
<td>tdc_ub</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Uniform Band</h2>

<h3>Description</h3>

<p>This function computes an upper prediction bound, derived from the
uniform band, on the FDP in TDC's list of discoveries.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tdc_ub(
  thresholds,
  labels,
  alpha,
  gamma,
  c = 0.5,
  lambda = 0.5,
  n = length(labels),
  interpolate = TRUE
)

uniband(
  thresholds,
  labels,
  alpha,
  gamma,
  c = 0.5,
  lambda = 0.5,
  n = length(labels),
  interpolate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>The rejection threshold of TDC. If given as
a vector, an upper prediction bound is returned for each element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>A vector of (ordered) labels. See details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The FDR threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The confidence parameter of the bound. Typical values include
<code>gamma = 0.05</code> or <code>gamma = 0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Determines the ranks of the target score that are considered
winning. Defaults to <code>c = 0.5</code> for (single-decoy) TDC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Determines the ranks of the target score that are
considered losing. Defaults to <code>lambda = 0.5</code> for (single-decoy) TDC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of hypotheses. Defaults to the length of <code>labels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>A boolean indicating whether the bands should be
interpolated. Offers a slight boost in performance at the cost of computing
power. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In (single-decoy) TDC, each hypothesis is associated to a
winning score and a label (1 for a target win, -1 for a decoy win). This
function assumes that the hypotheses are ordered in decreasing order of
winning scores (with ties broken at random). The argument <code>labels</code>,
therefore, must be ordered according to this rule.
</p>
<p>This function also supports the extension of TDC that uses multiple
decoys. In that setup, the target score is competed with multiple decoy
scores and the rank of the target score after competition is used to determine whether the
hypothesis is a target win (label = 1), decoy win (-1) or uncounted (0).
The top <code>c</code> proportion of ranks are considered winning, the bottom
<code>1-lambda</code> losing, and all the rest uncounted.
</p>
<p>The threshold of TDC is given by the formula:
</p>
<p style="text-align: center;"><code class="reqn">\max\{k : \frac{D_k + 1}{T_k \vee 1} \cdot \frac{c}{1-\lambda} \leq \alpha\}</code>
</p>

<p>where <code class="reqn">T_k</code> is the number of target wins among the top
<code class="reqn">k</code> hypotheses, and <code class="reqn">D_k</code> is the number of decoy wins similarly.
</p>
<p>The argument <code>gamma</code> sets a confidence level of <code>1-gamma</code>. Since
the uniform band requires pre-computed Monte Carlo statistics, only
certain values of <code>gamma</code> are available to use. Commonly used
confidence levels, like 0.95 and 0.99, are available. We refer the reader
to the README of this package for more details.
</p>
<p>The argument <code>alpha</code>, used to compute the threshold of TDC, is also
used in this function. It serves to compute an appropriate d_max
for a non-trivial bound. In particular, if the user inputs a vector of
<code>thresholds</code>, a bound is returned for each element of
<code>thresholds</code> using the same d_max. For more details, see:
<a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>
<p>We recommend the use of <code>interpolate = TRUE</code> (default), as it generally
results in a tighter bound. This comes at the cost of performance: the bound
for each threshold is computed in O(n) time with interpolation and O(1)
without.
</p>


<h3>Value</h3>

<p>An upper prediction bound on the FDP in TDC's list of discoveries.
If <code>thresholds</code> is a vector, returns an upper prediction bound for each
element of <code>thresholds</code>.
</p>


<h3>References</h3>

<p>Ebadi et al. (2022), Bounding the FDP in competition-based
control of the FDR <a href="https://arxiv.org/abs/2302.11837">https://arxiv.org/abs/2302.11837</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("fdpbandsdata", quietly = TRUE)) {
  set.seed(123)
  thresholds &lt;- c(250, 500, 750, 1000)
  labels &lt;- c(
    rep(1, 250),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.9, 0.1)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.5, 0.5)),
    sample(c(1, -1), size = 250, replace = TRUE, prob = c(0.1, 0.9))
  )
  alpha &lt;- 0.05
  gamma &lt;- 0.05
  tdc_ub(thresholds, labels, alpha, gamma)
}

</code></pre>


</div>