<div class="container">

<table style="width: 100%;"><tr>
<td>fit_secondary_growth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit secondary growth models</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Fits a secondary growth model to a set of growth rates obtained experimentally.
Modelling is done according to the gamma concept proposed by Zwietering (1992)
and cardinal parameter models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_secondary_growth(
  fit_data,
  starting_point,
  known_pars,
  sec_model_names,
  transformation = "sq",
  ...,
  check = TRUE,
  formula = mu ~ .
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit_data</code></td>
<td>
<p>Tibble with the data used for the fit. It must have
one column with the observed growth rate (named <code>mu</code> by default; can be
changed using the "formula" argument) and as many columns
as needed with the environmental factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting_point</code></td>
<td>
<p>Named vector with initial values for the model parameters
to estimate from the data. The growth rate under optimum conditions must be named
<code>mu_opt</code>. The rest must be called 'env_factor'+'_'+'parameter'. For instance,
the minimum pH for growth is 'pH_xmin'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known_pars</code></td>
<td>
<p>Named vector of fixed model parameters. Must be named using the
same convention as <code>starting_point</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sec_model_names</code></td>
<td>
<p>Named character vector defining the secondary model
for each environmental factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>Character defining the transformation of <code>mu</code> for
model fitting. One of <code>sq</code> (square root; default), <code>log</code> (log-transform) or
<code>none</code> (no transformation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>modFit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Whether to do some basic checks (TRUE by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula" describing the y variable. The
right hand side must be ".". By default <code>mu ~ .</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An instance of <code>FitSecondaryGrowth()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## We use the data included in the package

data("example_cardinal")

## Define the models to fit

sec_model_names &lt;- c(temperature = "Zwietering", pH = "CPM")

## Any model parameter can be fixed

known_pars &lt;- list(mu_opt = 1.2, temperature_n = 1,
    pH_n = 2, pH_xmax = 6.8, pH_xmin = 5.2)

## Initial values must be given for every other parameter

my_start &lt;- list(temperature_xmin = 5, temperature_xopt = 35,
    pH_xopt = 6.5)

## We can now call the fitting function

fit_cardinal &lt;- fit_secondary_growth(example_cardinal, my_start, known_pars, sec_model_names)

## With summary, we can look at the parameter estimates

summary(fit_cardinal)

## The plot function compares predictions against observations

plot(fit_cardinal)

## Passing which = 2, generates a different kind of plot

plot(fit_cardinal, which = 2)
plot(fit_cardinal, which = 2, add_trend = TRUE)
plot(fit_cardinal, which = 2, add_segment = TRUE)

</code></pre>


</div>