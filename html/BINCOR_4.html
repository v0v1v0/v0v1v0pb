<div class="container">

<table style="width: 100%;"><tr>
<td>ccf_ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-correlation 
</h2>

<h3>Description</h3>

<p>The <code>ccf_ts</code> function estimates and plots the cross-correlation 
between the binned time series. <code>ccf_ts</code> has an 
option to remove the linear trend of the time series under analysis (other 
pre-processing methods could be used) and contains several parameters that are 
described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ccf_ts(bints1, bints2, lagmax=NULL, ylima=-1, ylimb=1, rmltrd="N", RedL=T, 
 device="screen", Hfig, Wfig, Hpdf, Wpdf, resfig, ofilename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bints1, bints2</code></td>
<td>

<p>The bints1 and bints2 are the binned time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lagmax</code></td>
<td>

<p>This parameter indicates the maximum lag for which the cross-correlation 
is calculated (its value depends on the length of the data set). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylima, ylimb</code></td>
<td>

<p>This parameters define the extremes of the range in which the CCF will 
be plotted. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmltrd</code></td>
<td>

<p>This is the option used to remove the linear trend in the time series 
under study (by default the linear trend is not removed, but it can 
be activated with the option “Y” or “y”). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RedL</code></td>
<td>

<p>RedL plots a right red line to highlight the correlation coefficient at 
the lag-0 (the default option is TRUE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>

<p>The type of the output device (by default the option is “screen”, 
and the other options are “jpg”, “png” and “pdf”) for the 
scatter plot of the binned time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hfig</code></td>
<td>

<p>The height for the CCF plot in “jpg” or “png” format.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wfig</code></td>
<td>

<p>The width for the CCF plot in “jpg” or “png”format.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hpdf</code></td>
<td>

<p>The height for the CCF plot in “pdf” format.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wpdf</code></td>
<td>

<p>The width for the CCF plot in “pdf” format.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resfig</code></td>
<td>

<p><em>resfig</em> is the plot resolution in “ppi” (by default <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> does not 
record a resolution in the image file, except for BMP) for the CCF plot  
(“jpg” or “png” formats), an adequate value could be 150 ppi. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofilename</code></td>
<td>

<p>The output filename (CCF plot) for the CCF estimated of the binned time series. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>ccf_ts</code> estimate the cross-correlation between two binned 
time series by means of the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> native function <em>ccf</em> (package:stats).
</p>


<h3>Value</h3>

<p>Output: an object of the form <em>ccf</em> containing the correlation 
coefficients for the defined number of lags (lagmax) and the statistical 
significance. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br>
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br> 
EPOC UMR CNRS 5805 - U. de Bordeaux, Pessac, FRANCE.<br>
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br>
Web2: <a href="http://www.researchgate.net/profile/Josue_Polanco-Martinez">http://www.researchgate.net/profile/Josue_Polanco-Martinez</a>.<br>
Email: <a href="josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> 
</p>


<h3>References</h3>

<p>Polanco-Martínez, J.M., Medina-Elizalde, M.A., Sánchez Goñi, M.F., 
M. Mudelsee. (2018). BINCOR: an R package to estimate the correlation 
between two unevenly spaced time series. Ms. under review (second round). 
</p>


<h3>Examples</h3>

<pre><code class="language-R"> #####################################################################
 #::  Figure 5 (Polanco-Martínez et al. (2018), (mimeo)). 
 #####################################################################
 library("BINCOR") 
 library("pracma")

 #####################################################################
 #:: Loading the time series under analysis: example 2 (pollen ACER)  
 #####################################################################
 data(MD04_2845_siteID31)
 data(MD95_2039_siteID32)

 #####################################################################
 # Computing the binned time series though our bin_cor function
 #####################################################################
 bincor.tmp &lt;- bin_cor(ID31.dat, ID32.dat, FLAGTAU=3, "salida_ACER_ABRUPT.tmp")
 binnedts   &lt;- bincor.tmp$Binned_time_series

 # To avoid NA's values  
 bin_ts1    &lt;- na.omit(bincor.tmp$Binned_time_series[,1:2])
 bin_ts2    &lt;- na.omit(bincor.tmp$Binned_time_series[,c(1,3)]) 

 #####################################################################
 # Testing our ccf_ts function
 #####################################################################
 # Screen 
 ccf_ts(bin_ts1, bin_ts2, RedL=TRUE, rmltrd="y") 

 # PDF format  
 ccf_ts(bin_ts1, bin_ts2, RedL=TRUE, rmltrd="y", device="pdf", Hpdf=6, 
  Wpdf=9, resfig=300, ofilename="ccf_ID31_ID32_res")
 
 # JPG format 
 ccf_ts(bin_ts1, bin_ts2, RedL=TRUE, rmltrd="y", device="jpg", 
  Hfig=900, Wfig=1200, resfig=150, ofilename="ccf_ID31_ID32_res")
</code></pre>


</div>