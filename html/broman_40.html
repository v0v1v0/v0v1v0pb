<div class="container">

<table style="width: 100%;"><tr>
<td>normalize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile normalization</h2>

<h3>Description</h3>

<p>Quantile normalizes two vectors or a matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normalize(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Optional second numeric vector</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We sort the columns, take averages across rows, and then plug the
averages back into the respective positions.  The marginal
distributions in the columns are thus forced to be the same.
Missing values, which can result in differing numbers of observed
values per column, are dealt with by linear interpolation.
</p>


<h3>Value</h3>

<p>If two vectors, <code>x</code> and <code>y</code>, are provided, the output is a
matrix with two columns, with the quantile normalized versions of
<code>x</code> and <code>y</code>.
If <code>y</code> is missing, <code>x</code> should be a matrix, in which case the
output is a matrix of the same dimensions with the columns quantile
normalized with respect to each other.
</p>


<h3>Examples</h3>

<pre><code class="language-R">z &lt;- rmvn(10000, mu=c(0,5,10), V = rbind(c(1,0.5,0.5),c(0.5,1,0.5),c(0.5,0.5,1)))
z[sample(prod(dim(z)), 1500)] &lt;- NA
pairs(z)
br &lt;- seq(min(z, na.rm=TRUE), max(z, na.rm=TRUE), length=200)
par(mfrow=c(3,1))
for(i in 1:3)
  hist(z[,i], xlab="z", main=i, breaks=br)
zn &lt;- normalize(z)
br &lt;- seq(min(zn, na.rm=TRUE), max(zn, na.rm=TRUE), length=200)
for(i in 1:3)
  hist(zn[,i], xlab="normalized z", main=i, breaks=br)
pairs(zn)

</code></pre>


</div>