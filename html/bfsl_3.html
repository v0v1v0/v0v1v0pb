<div class="container">

<table style="width: 100%;"><tr>
<td>bfsl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the Best-fit Straight Line</h2>

<h3>Description</h3>

<p><code>bfsl</code> calculates the best-fit straight line to independent points with
(possibly correlated) normally distributed errors in both coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bfsl(...)

## Default S3 method:
bfsl(x, y = NULL, sd_x = 0, sd_y = 1, r = 0, control = bfsl_control(), ...)

## S3 method for class 'formula'
bfsl(
  formula,
  data = parent.frame(),
  sd_x,
  sd_y,
  r = 0,
  control = bfsl_control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of <em>x</em> observations or a data frame (or an
object coercible by <code>as.data.frame</code> to a data frame) containing
the named vectors <em>x</em>, <em>y</em>, and optionally <em>sd_x</em>,
<em>sd_y</em> and <em>r</em>. If weights <em>w_x</em> and <em>w_y</em> are given,
then <em>sd_x</em> and <em>sd_y</em> are calculated from <em>sd_x = 1/sqrt(w_x)</em>
and <em>sd_y = 1/sqrt(w_y)</em>. Specifying <code>y</code>, <code>sd_x</code>, <code>sd_y</code>
or <code>r</code> directly as function arguments overwrites these variables in the
data structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of <em>y</em> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_x</code></td>
<td>
<p>A vector of <em>x</em> measurement error standard
deviations. If it is of length one, all data points are assumed to have the
same <em>x</em> standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_y</code></td>
<td>
<p>A vector of <em>y</em> measurement error standard
deviations. If it is of length one, all data points are assumed to have the
same <em>y</em> standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A vector of correlation coefficients between errors in
<em>x</em> and <em>y</em>. If it is of length one, all data points are assumed to
have the same correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control settings. See <code>bfsl_control</code>
for the names of the settable control values and their effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula specifying the bivariate model (as in <code>lm</code>,
but here only <code>y ~ x</code> makes sense).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame containing the variables of the model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bfsl</code> provides the general least-squares estimation solution to the
problem of fitting a straight line to independent data with (possibly
correlated) normally distributed errors in both <code>x</code> and <code>y</code>.
</p>
<p>With <code>sd_x = 0</code> the (weighted) ordinary least squares solution is
obtained. The calculated standard errors of the slope and intercept
multiplied with <code>sqrt(chisq)</code> correspond to the ordinary least squares
standard errors.
</p>
<p>With <code>sd_x = c</code>, <code>sd_y = d</code>, where <code>c</code> and <code>d</code> are
positive numbers, and <code>r = 0</code> the Deming regression solution is obtained.
If additionally <code>c = d</code>, the orthogonal distance regression solution,
also known as major axis regression, is obtained.
</p>
<p>Setting <code>sd_x = sd(x)</code>, <code>sd_y = sd(y)</code> and <code>r = 0</code> leads to
the geometric mean regression solution, also known as reduced major
axis regression or standardised major axis regression.
</p>
<p>The goodness of fit metric <code>chisq</code> is a weighted reduced chi-squared
statistic. It compares the deviations of the points from the fit line to the
assigned measurement error standard deviations. If <code>x</code> and <code>y</code> are
indeed related by a straight line, and if the assigned measurement errors
are correct (and normally distributed), then <code>chisq</code> will equal 1. A
<code>chisq &gt; 1</code> indicates underfitting: the fit does not fully capture the
data or the measurement errors have been underestimated. A <code>chisq &lt; 1</code>
indicates overfitting: either the model is improperly fitting noise, or the
measurement errors have been overestimated.
</p>


<h3>Value</h3>

<p>An object of class "<code>bfsl</code>", which is a <code>list</code> containing
the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A <code>2x2</code> matrix with columns of the fitted coefficients
(intercept and slope) and their standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>The goodness of fit  (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>The fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The residuals, that is <code>y</code> observations minus fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>The residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.ab</code></td>
<td>
<p>The covariance of the slope and intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>The control <code>list</code> used, see the <code>control</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convInfo</code></td>
<td>
<p>A <code>list</code> with convergence information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>list</code> containing <code>x</code>, <code>y</code>, <code>sd_x</code>, <code>sd_y</code>
and <code>r</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>York, D. (1968). Least squares fitting of a straight line with
correlated errors. <em>Earth and Planetary Science Letters</em>, 5, 320â€“324,
https://doi.org/10.1016/S0012-821X(68)80059-7
</p>


<h3>Examples</h3>

<pre><code class="language-R">x = pearson_york_data$x
y = pearson_york_data$y
sd_x = 1/sqrt(pearson_york_data$w_x)
sd_y = 1/sqrt(pearson_york_data$w_y)
bfsl(x, y, sd_x, sd_y)
bfsl(y~x, pearson_york_data, sd_x, sd_y)

fit = bfsl(pearson_york_data)
plot(fit)

</code></pre>


</div>