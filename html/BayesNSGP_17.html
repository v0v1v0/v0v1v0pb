<div class="container">

<table style="width: 100%;"><tr>
<td>nsCrossdist3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate coordinate-specific cross-distance matrices, only for nearest neighbors
and store in an array</h2>

<h3>Description</h3>

<p><code>nsCrossdist3d</code> generates and returns new 3-dimensional arrays containing
the former dist1_sq, dist2_s1, and dist12 matrices, but
only as needed for the k nearest-neighbors of each location.
these 3D matrices (dist1_3d, dist2_3d, and dist12_3d)
are used in the new implementation of calculateAD_ns().
</p>


<h3>Usage</h3>

<pre><code class="language-R">nsCrossdist3d(
  coords,
  predCoords,
  P_nID,
  scale_factor = NULL,
  isotropic = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>N x d matrix; contains the x-y coordinates of stations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predCoords</code></td>
<td>
<p>M x d matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_nID</code></td>
<td>
<p>N x k matrix; contains indices of nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_factor</code></td>
<td>
<p>Scalar; optional argument for re-scaling the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isotropic</code></td>
<td>
<p>Logical; indicates whether distances should be calculated
separately for each coordinate dimension (FALSE) or simultaneously for all
coordinate dimensions (TRUE). <code>isotropic = FALSE</code> can only be used for
two-dimensional coordinate systems.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Arrays with nearest neighbor distances in each coordinate 
direction. When the spatial dimension d &gt; 2, dist1_3d contains squared
Euclidean distances, and dist2_3d and dist12_3d are empty.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some coordinates and neighbors
coords &lt;- cbind(runif(100),runif(100))
predCoords &lt;- cbind(runif(200),runif(200))
P_nID &lt;- FNN::get.knnx(coords, predCoords, k = 10)$nn.index # Prediction NN
# Calculate distances
Pdist &lt;- nsCrossdist3d(coords, predCoords, P_nID)

</code></pre>


</div>