<div class="container">

<table style="width: 100%;"><tr>
<td>tfr.median.set</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Editing Medians of the Projection
</h2>

<h3>Description</h3>

<p>These functions are to be used by expert analysts. They allow to change the projection medians either to specific values, including the WPP values, or shift the medians by a given constant, or by a specific adjusting procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tfr.median.set(sim.dir, country, values, years = NULL)

tfr.median.shift(sim.dir, country, reset = FALSE, shift = 0, 
    from = NULL, to = NULL)
    
tfr.median.adjust(sim.dir, countries, factor1 = 2/3, factor2 = 1/3, forceAR1 = FALSE)

tfr.median.reset(sim.dir, countries = NULL)

tfr.shift.prediction.to.wpp(sim.dir, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim.dir</code></td>
<td>
<p>Directory containing the prediction object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country</code></td>
<td>
<p>Name or numerical code of a country.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>countries</code></td>
<td>
<p>Vector of country names or codes. If <code>NULL</code> in the <code>tfr.median.reset</code> function, the reset is done for all countries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Array of the new median values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p>Numeric vector giving years which <code>values</code> correspond to. Ideally it should be of the same length as <code>values</code>. If it is <code>NULL</code>,
<code>values</code> are set starting from the first prediction period. If <code>values</code> correspond to consecutive years, only the first year might be given here. A year <code class="reqn">t</code> represents a prediction period <code class="reqn">[t_i, t_{i+1}]</code> if <code class="reqn">t_i &lt; t \leq t_{i+1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset</code></td>
<td>
<p>Logical. If <code>TRUE</code> medians in a range of <code>from</code> and <code>to</code> are reset to their original values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>Constant by which the medians should be offset. It is not used if <code>reset</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>Year from which the offset/reset should start. By default, it starts at the first prediction period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Year until which the offset/reset should be done. By default, it is set to the last prediction period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor1, factor2</code></td>
<td>
<p>Adjusting factors for the first and second projection period, respectively (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forceAR1</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the given countries are forced to enter Phase III (i.e. the AR(1) process) in the first projection period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the underlying adjustment function. It can be <code>verbose</code> to show/hide the progress of the adjustment and <code>wpp.year</code> to adjust it to if it differs from the wpp year of the simulation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>tfr.median.set</code> can be used to set the medians of the given country to specific values. Function <code>tfr.median.shift</code> can be used to offset the medians by a specific constant, or to reset the medians to their original BHM values.
Function <code>tfr.median.adjust</code> runs the prediction procedure for the given countries with an additional decrement in the model in the first two projection periods. In the first projection period it is computed as <code>factor1*S</code> where <code>S</code> is a difference between observed decrement and the expected decrement (by the double logistic function) in the last observed period. In the second projection period, in the formula <code>factor1</code> is replaced by <code>factor2</code>. If <code>forceAR1</code> is set to <code>TRUE</code>, we recommend to set <code>factor1</code> and <code>factor2</code> to 0. The function then calls <code>tfr.median.set</code> in order to store the new median for each country.
</p>
<p>Function<code>tfr.shift.prediction.to.wpp</code> shifts the projected medians so that they correspond to the values found in the <code>tfrprojMed</code> datasets of the <span class="pkg">wpp</span> package that either corresponds to the package used for the simulation itself or is given by the <code>wpp.year</code> argument. If using <span class="pkg">wpp2022</span>, the dataset name is automatically adjusted depending if it is an annual or a 5-year simulation.
</p>
<p>Function <code>tfr.median.reset</code> resets medians of the given countries to the original values. By default it deletes adjustments for all countries.
</p>
<p>In all five functions, if a median is modified, the corresponding offset is stored in the prediction object (element <code>median.shift</code>) and the updated prediction object is written back to disk. All functions in the package that use trajectories and trajectory statistics use the <code>median.shift</code> values to offset the results correspondingly, i.e. trajectories are shifted the same way as the medians.
</p>


<h3>Value</h3>

<p>All functions return an updated object of class <code>bayesTFR.prediction</code>.
</p>


<h3>Author(s)</h3>

<p>Hana Sevcikova, Leontine Alkema</p>


<h3>See Also</h3>

<p><code>tfr.median.set.all</code> for shifting estimation medians.</p>


</div>