<div class="container">

<table style="width: 100%;"><tr>
<td>getG_symDMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes a Very Large Genomic Relationship Matrix</h2>

<h3>Description</h3>

<p>Computes a positive semi-definite symmetric genomic relation matrix G=XX'
offering options for centering and scaling the columns of <code>X</code>
beforehand.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getG_symDMatrix(X, center = TRUE, scale = TRUE, impute = TRUE, scaleG = TRUE,
  minVar = 1e-05, blockSize = 5000L,
  folderOut = paste0("symDMatrix_", randomString()), vmode = "double",
  i = seq_len(nrow(X)), j = seq_len(ncol(X)), chunkSize = 5000L,
  nCores = getOption("mc.cores", 2L), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A matrix-like object, typically the genotypes of a <code>BGData</code>
object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>Either a logical value or a numeric vector of length equal to the
number of columns of <code>X</code>. If <code>FALSE</code>, no centering is done.
Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Either a logical value or a numeric vector of length equal to the
number of columns of <code>X</code>. If <code>FALSE</code>, no scaling is done.
Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute</code></td>
<td>

<p>Indicates whether missing values should be imputed. Defaults to
<code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleG</code></td>
<td>

<p>TRUE/FALSE whether xx' must be scaled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minVar</code></td>
<td>

<p>Columns with variance lower than this value will not be used in the
computation (only if <code>scale</code> is not <code>FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockSize</code></td>
<td>

<p>The number of rows and columns of each block. If <code>NULL</code>, a single
block of the same length as <code>i</code> will be created. Defaults to 5000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folderOut</code></td>
<td>

<p>The path to the folder where to save the <code>symDMatrix</code> object.
Defaults to a random string prefixed with "symDMatrix_".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vmode</code></td>
<td>

<p>vmode of <code>ff</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>

<p>Indicates which rows of <code>X</code> should be used. Can be integer,
boolean, or character. By default, all rows are used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>

<p>Indicates which columns of <code>X</code> should be used. Can be integer,
boolean, or character. By default, all columns are used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunkSize</code></td>
<td>

<p>The number of columns of <code>X</code> that are brought into physical memory
for processing per core. If <code>NULL</code>, all columns of <code>X</code> are
used. Defaults to 5000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCores</code></td>
<td>

<p>The number of cores (passed to <code>mclapply</code>). Defaults to the number
of cores as detected by <code>detectCores</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Whether progress updates will be posted. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Even very large genomic relationship matrices are supported by partitioning
<code>X</code> into blocks and calling <code>getG</code> on these blocks. This function
performs the block computations sequentially, which may be slow. In an HPC
environment, performance can be improved by manually distributing these
operations to different nodes.
</p>


<h3>Value</h3>

<p>A <code>symDMatrix</code> object.
</p>


<h3>See Also</h3>

<p><code>multi-level-parallelism</code> for more information on multi-level
parallelism. <code>symDMatrix-class</code> and
<code>BGData-class</code> for more information on the <code>BGData</code> class.
<code>getG</code> to learn more about the underlying method.
</p>


</div>