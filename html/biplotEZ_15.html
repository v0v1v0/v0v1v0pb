<div class="container">

<table style="width: 100%;"><tr>
<td>CVA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform Canonical Variate Analysis (CVA)</h2>

<h3>Description</h3>

<p>This function appends the <code>biplot</code> object with elements resulting from performing CVA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CVA(bp, classes=bp$classes, dim.biplot = c(2, 1, 3), e.vects = 1:ncol(bp$X),
           weightedCVA = "weighted", show.class.means = TRUE,
           low.dim = "sample.opt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bp</code></td>
<td>
<p>an object of class <code>biplot</code> obtained from preceding function <code>biplot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p>a vector of the same length as the number of rows in the data matrix with the class indicator for the samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim.biplot</code></td>
<td>
<p>the dimension of the biplot. Only values <code>1</code>, <code>2</code> and <code>3</code> are accepted, with default <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.vects</code></td>
<td>
<p>the vector indicating which eigenvectors (canonical variates) should be plotted in the biplot, with default <code>1:dim.biplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightedCVA</code></td>
<td>
<p>a character string indicating which type of CVA to perform. One of "<code>weighted</code>" (default) for a weighted CVA to be performed (The centring matrix will be a diagonal matrix with the class sizes (<code class="reqn">\mathbf{C} = \mathbf{N}</code>), "<code>unweightedCent</code>" for unweighted CVA to be performed (The centring matrix is the usual centring matrix (<code class="reqn">\mathbf{C} = \mathbf{I}_{G} - G^{-1}\mathbf{1}_{G}\mathbf{1}_{G}'</code>)) or "<code>unweightedI</code>" for unweighted CVA to be performed while retaining the weighted centroid (The centring matrix is an indicator matrix (<code class="reqn">\mathbf{C} = \mathbf{I}_{G}</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.class.means</code></td>
<td>
<p>a logical value indicating whether to plot the class means on the biplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low.dim</code></td>
<td>
<p>a character string indicating which method to use to construct additional dimension(s) if the dimension of the canonical space is smaller than <code>dim.biplot</code>. One of "<code>sample.opt</code>" (default) for maximising the sample predictivity of the individual samples in the biplot or "<code>Bhattacharyya.dist</code>" which is based on the decomposition of the Bhattacharyya distance into a component for the sample means and a component for the dissimilarity between the sample covariance matrices.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Object of class CVA with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of the centered and scaled numeric variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xcat</code></td>
<td>
<p>the data frame of the categorical variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.X</code></td>
<td>
<p>the original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p>the vector of category levels for the class variable. This is to be used for <code>colour</code>, <code>pch</code> and <code>cex</code> specifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>the vector of observations that have been removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a logical value indicating whether <code class="reqn">\mathbf{X}</code> is centered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>a logical value indicating whether <code class="reqn">\mathbf{X}</code> is scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>the vector of means for each numerical variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>the vector of standard deviations for each numerical variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.aes</code></td>
<td>
<p>the vector of category levels for the grouping variable. This is to be used for <code>colour</code>, <code>pch</code> and <code>cex</code> specifications. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.names</code></td>
<td>
<p>the descriptive names to be used for group labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>the number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Title</code></td>
<td>
<p>the title of the biplot rendered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmat</code></td>
<td>
<p>the matrix for transformation to the canonical space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Linv</code></td>
<td>
<p>the inverse of <code class="reqn">\mathbf{L}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>the vector of eigenvalues of the two-sided eigenvalue problem.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>the matrix with each row containing the details of the points to be plotted (i.e. coordinates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ax.one.unit</code></td>
<td>
<p>one unit in the positive direction of each biplot axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gmat</code></td>
<td>
<p>the indicator matrix defining membership of the classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xmeans</code></td>
<td>
<p>the matrix of the class means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zmeans</code></td>
<td>
<p>the matrix of the class mean coordinates that are plotted in the biplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.vects</code></td>
<td>
<p>the vector indicating which canonical variates are plotted in the biplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cmat</code></td>
<td>
<p>the centring matrix based on different choices of weighting described in arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bmat</code></td>
<td>
<p>the between class sums of squares and cross products matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wmat</code></td>
<td>
<p>the within class sums of squares and cross products matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mrr</code></td>
<td>
<p>the matrix used for prediction from the canonical space (the inverse of <code class="reqn">\mathbf{M}=\mathbf{LV})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mr</code></td>
<td>
<p>the first r dimensions of the solution to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmat</code></td>
<td>
<p>the matrix with the class sizes on the diagonal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.mat</code></td>
<td>
<p>the matrix with the eigenvalues of <code class="reqn">\mathbf{W}^{-1/2}\mathbf{BW}^{-1/2}</code> on the diagonal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class.means</code></td>
<td>
<p>a logical value indicating whether the class means should be plotted in the biplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim.biplot</code></td>
<td>
<p>the dimension of the biplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low.dim</code></td>
<td>
<p>the method used to construct additional dimension(s).</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>biplot()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">biplot(iris[,1:4]) |&gt; CVA(classes=iris[,5])
# create a CVA biplot
biplot(iris[,1:4]) |&gt; CVA(classes=iris[,5]) |&gt; plot()

</code></pre>


</div>