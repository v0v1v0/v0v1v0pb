<div class="container">

<table style="width: 100%;"><tr>
<td>acf.bspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior autocovariances</h2>

<h3>Description</h3>

<p>Deriving (posterior) autocovariances or autocorrelations
from the spectrum's posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bspec'
acf(x, spec = NULL,
   type = c("covariance", "correlation"),
   two.sided = x$two.sided, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>bspec</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>(optional) a <code>numeric</code> vector giving <em>fixed</em>
values of the spectral parameters (e.g. derived by the
<code>sample</code> function) for which the
autocovariances then are deterministic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a <code>character</code> string specifying the desired type of
output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>a <code>logical</code> flag indicating whether the
<code>spec</code> values are to be interpreted as <em>one-sided</em> or
<em>two-sided</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>spec</code> is supplied, the autocovariance (or autocorrelation)
function corresponding to that specific spectrum will be returned.
As this is a completely deterministic relationship, the
“<code>stderr</code>” slot of the result will be zero in this case.
</p>
<p>If <code>spec</code> is <em>not</em> supplied, the <em>(posterior) expected
autocovariance</em> is returned in the “<code>acf</code>” element, and its
<em>(posterior) standard deviation</em> is returned in the
“<code>stderr</code>” element.
The posterior expectation of the autocovariance is only finite if
<em>all (!)</em> posterior degrees-of-freedom parameters in the
<code>bspec</code> object are <code class="reqn">&gt;2</code>. The posterior
variance (and with that the <code>stderr</code> element) is only finite if all
these are <code class="reqn">&gt;4</code>.
</p>
<p>Autocorrelations are only returned if <code>spec</code> is supplied.
</p>


<h3>Value</h3>

<p>A list of class <code>bspecACF</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>a <code>numeric</code> vector giving the lags
corresponding to the (discrete) autocovariance / autocorrelation
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acf</code></td>
<td>
<p>a <code>numeric</code> vector giving the values of the
autocovariance / autocorrelation function correponding to the
above lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr</code></td>
<td>
<p>a <code>numeric</code> vector giving the standard
errors (posterior standard deviations) of the above autocovariance
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a <code>character</code> string giving the
nature of the above <code>acf</code> element: either <code>"covariance"</code>
or <code>"correlation"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>an <code>integer</code> giving the sample
size of the original time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bspec</code></td>
<td>
<p>a <code>character</code> string giving the
name of the <code>bspec</code> object the <code>bspecACF</code> object was
generated from.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>(Posterior) expectation and standard deviation of the spectrum may in
many cases not be finite (see above).
Autocorrelations are only returned if <code>spec</code> is supplied.
</p>


<h3>Author(s)</h3>

<p>Christian Roever, <a href="mailto:christian.roever@med.uni-goettingen.de">christian.roever@med.uni-goettingen.de</a></p>


<h3>References</h3>

<p>Roever, C., Meyer, R., Christensen, N.
Modelling coloured residual noise in gravitational-wave signal processing.
<em>Classical and Quantum Gravity</em>, <b>28</b>(1):015010, 2011.
doi: <a href="https://doi.org/10.1088/0264-9381/28/1/015010">10.1088/0264-9381/28/1/015010</a>.
See also <a href="https://arxiv.org/abs/0804.3853">arXiv preprint 0804.3853</a>.</p>


<h3>See Also</h3>

<p><code>bspec</code>,
<code>expectation</code>,
<code>sample.bspec</code>,
<code>acf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">lhspec1 &lt;- bspec(lh)

# without any prior specifications,
# autocovariances are not finite:
print(acf(lhspec1))
str(acf(lhspec1))

# for given values of the spectral parameters,
# the autocovariances are fixed:
str(acf(lhspec1, spec=sample(lhspec1)))

# for all the prior degrees-of-freedom greater than one,
# the expected autocovariance is finite, its variance isn't:
lhspec2 &lt;- bspec(lh, priordf=2, priorscale=0.6, intercept=FALSE)
print(acf(lhspec2))
str(acf(lhspec2))
plot(acf(lhspec2))
</code></pre>


</div>