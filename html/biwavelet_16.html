<div class="container">

<table style="width: 100%;"><tr>
<td>pwtc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute partial wavelet coherence</h2>

<h3>Description</h3>

<p>Compute partial wavelet coherence between <code>y</code> and <code>x1</code> by
partialling out the effect of <code>x2</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwtc(
  y,
  x1,
  x2,
  pad = TRUE,
  dj = 1/12,
  s0 = 2 * dt,
  J1 = NULL,
  max.scale = NULL,
  mother = "morlet",
  param = -1,
  lag1 = NULL,
  sig.level = 0.95,
  sig.test = 0,
  nrands = 300,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Time series <code>y</code> in matrix format (<code>n</code> rows x 2 columns).
The first column should contain the time steps and the second column should
contain the values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>Time series <code>x1</code> in matrix format (<code>n</code> rows x 2 columns).
The first column should contain the time steps and the second column should
contain the values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>Time series <code>x2</code> whose effects should be partialled out in
matrix format (<code>n</code> rows x 2 columns). The first column should contain
the time steps and the second column should contain the values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad</code></td>
<td>
<p>Pad the values will with zeros to increase the speed of the
transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dj</code></td>
<td>
<p>Spacing between successive scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>Smallest scale of the wavelet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J1</code></td>
<td>
<p>Number of scales - 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.scale</code></td>
<td>
<p>Maximum scale. Computed automatically if left unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mother</code></td>
<td>
<p>Type of mother wavelet function to use. Can be set to
<code>morlet</code>, <code>dog</code>, or <code>paul</code>. Significance testing is only
available for <code>morlet</code> wavelet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Nondimensional parameter specific to the wavelet function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag1</code></td>
<td>
<p>Vector containing the AR(1) coefficient of each time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.test</code></td>
<td>
<p>Type of significance test. If set to 0, use a regular
<code class="reqn">\chi^2</code> test. If set to 1, then perform a time-average test. If set to
2, then do a scale-average test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrands</code></td>
<td>
<p>Number of Monte Carlo randomizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Do not display progress bar.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return a <code>biwavelet</code> object containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coi</code></td>
<td>
<p>matrix containg cone of influence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>matrix containing the cross-wavelet transform of <code>y</code> and
<code>x1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsq</code></td>
<td>
<p>matrix of partial wavelet coherence between <code>y</code> and <code>x1</code>
(with <code>x2</code> partialled out)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>matrix of phases between <code>y</code> and <code>x1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>vector of periods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>vector of scales</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>length of a time step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>vector of times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>vector of values used to plot xaxis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>smallest scale of the wavelet </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dj</code></td>
<td>
<p>spacing between successive scales</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.sigma</code></td>
<td>
<p>standard deviation of <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1.sigma</code></td>
<td>
<p>standard deviation of <code>x1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mother</code></td>
<td>
<p>mother wavelet used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of <code>biwavelet</code> object created (<code>pwtc</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>
<p>matrix containg <code>sig.level</code> percentiles of wavelet
coherence based on the Monte Carlo AR(1) time series</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The Monte Carlo randomizations can be extremely slow for large
datasets. For instance, 1000 randomizations of a dataset consisting of 1000
samples will take ~30 minutes on a 2.66 GHz dual-core Xeon processor.
</p>


<h3>Author(s)</h3>

<p>Tarik C. Gouhier (tarik.gouhier@gmail.com)
Code based on WTC MATLAB package written by Aslak Grinsted.
</p>


<h3>References</h3>

<p>Aguiar-Conraria, L., and M. J. Soares. 2013. The Continuous Wavelet
Transform: moving beyond uni- and bivariate analysis. <em>Journal of
Economic Surveys</em> In press.
</p>
<p>Cazelles, B., M. Chavez, D. Berteaux, F. Menard, J. O. Vik, S. Jenouvrier,
and N. C. Stenseth. 2008. Wavelet analysis of ecological time series.
<em>Oecologia</em> 156:287-304.
</p>
<p>Grinsted, A., J. C. Moore, and S. Jevrejeva. 2004. Application of the cross
wavelet transform and wavelet coherence to geophysical time series.
<em>Nonlinear Processes in Geophysics</em> 11:561-566.
</p>
<p>Ng, E. K. W., and J. C. L. Chan. 2012. Geophysical applications of partial
wavelet coherence and multiple wavelet coherence. <em>Journal of
Atmospheric and Oceanic Technology</em> 29:1845-1853.
</p>
<p>Torrence, C., and G. P. Compo. 1998. A Practical Guide to Wavelet Analysis.
<em>Bulletin of the American Meteorological Society</em> 79:61-78.
</p>
<p>Torrence, C., and P. J. Webster. 1998. The annual cycle of persistence in the
El Nino/Southern Oscillation. <em>Quarterly Journal of the Royal
Meteorological Society</em> 124:1985-2004.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- cbind(1:100, rnorm(100))
x1 &lt;- cbind(1:100, rnorm(100))
x2 &lt;- cbind(1:100, rnorm(100))

# Partial wavelet coherence of y and x1
pwtc.yx1 &lt;- pwtc(y, x1, x2, nrands = 0)

# Partial wavelet coherence of y and x2
pwtc.yx2 &lt;- pwtc(y, x2, x1, nrands = 0)

# Plot partial wavelet coherence and phase difference (arrows)
# Make room to the right for the color bar
par(mfrow = c(2,1), oma = c(4, 0, 0, 1),
    mar = c(1, 4, 4, 5), mgp = c(1.5, 0.5, 0))

plot(pwtc.yx1, xlab = "", plot.cb = TRUE,
     main = "Partial wavelet coherence of y and x1 | x2")

plot(pwtc.yx2, plot.cb = TRUE,
     main = "Partial wavelet coherence of y and x2 | x1")

</code></pre>


</div>