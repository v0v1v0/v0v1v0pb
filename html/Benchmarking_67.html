<div class="container">

<table style="width: 100%;"><tr>
<td>stoned</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convex nonparametric least squares</h2>

<h3>Description</h3>

<p>Convex nonparametric least squares here for convex (Cost) function 
function or concave (Production) function with multiplicative or 
additive error term. the StoNED estimator combines the
axiomatic and non-parametric frontier (the DEA aspect) with
a stochastic noise term (the SFA aspect)</p>


<h3>Usage</h3>

<pre><code class="language-R">stoned(X, Y, RTS = "vrs", COST = 0, MULT = 0, METHOD = "MM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Inputs (right hand side) of firms to be evaluated, a K x m matrix
of observations of K firms with m inputs (firm x input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Output or cost (left hand side) of firms to be evaluated, a K x 1 matrix
of observations of K firms with 1 output or cost (firm x input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RTS</code></td>
<td>
<p>RTS determines returns to scale assumption: RTS="vrs", 
"drs", "crs"  and "irs" are possible for constant or variable returns
to scale; see <code>dea</code> for a verbal description and numbering scheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COST</code></td>
<td>
<p>COST specifies whether a cost function needs is 
estimated (COST=1) or a production function (COST=0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MULT</code></td>
<td>
<p>MULT determines if multiplicative (MULT=1) or 
additive (MULT=0) model is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>METHOD</code></td>
<td>
<p>METHOD specifies the way efficiency is estimated: 
MM for Method of Moments and PSL for pseudo likelihood estimation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Convex nonparametric least squares here for convex (cost)
function with multiplicative error term: Y=b*X*exp(e) or additive
error term: Y=b*X + e.</p>


<h3>Value</h3>

<p>The results are returned in a list with the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>residualNorm</code></td>
<td>
<p>Norm of residual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solutionNorm</code></td>
<td>
<p>Norm of solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Is there an error in the solution?</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>beta_matrix, estimated coefficients as a Kxm matrix; if there 
is an intercept the first column is the intercept, and the matrix is Kx(1+m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff</code></td>
<td>
<p>Efficinecy score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>front</code></td>
<td>
<p>Points on the frontier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_u</code></td>
<td>
<p>sigma_u</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Convex nonparametric least squares here for convex (Cost) function
with multiplicative error term:
<code>Y=b*X*exp(e)</code> or additive error term: <code>Y=b*X + e</code>.
</p>
<p>The intercept is absent for the constant returns to scale assumption; all 
other technology assumptions do have an intercept.
</p>
<p>Note that the method <code>stoned</code> is a rather slow method and probably only 
works in a reasonable time for less than 3-400 units.
</p>


<h3>Author(s)</h3>

<p>Stefan Seifert <a href="mailto:s.seifert@ilr.uni-bonn.de">s.seifert@ilr.uni-bonn.de</a> and Lars Otto <a href="mailto:larsot23@gmail.com">larsot23@gmail.com</a>
</p>


<h3>References</h3>

<p>Kuosmanen and Kortelainen, "Stochastic non-smooth envelopment of data: 
semi-parametric frontier estimation subject to shape constraints", 
<em>Journal of Productivity Analysis</em> 2012
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Example: Single Input Production Function
n=10

x1 &lt;- runif(n,10,20)
v &lt;- rnorm(n,0,0.01)
u &lt;- abs(rnorm(n,0,0.04))

y &lt;- (x1^0.8)*exp(-u)*exp(v)

sol_MM &lt;- stoned(x1, y)
sol_PSL &lt;- stoned(x1, y, METHOD="PSL")

plot(x1,y)
curve(x^0.8, add=TRUE)
points(x1,sol_MM$front, col="red")
points(x1,sol_PSL$front, col="blue", pch=16, cex=.6)
</code></pre>


</div>