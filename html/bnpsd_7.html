<div class="container">

<table style="width: 100%;"><tr>
<td>coanc_to_kinship</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform coancestry matrix to kinship matrix</h2>

<h3>Description</h3>

<p>If <code>Theta</code> is the coancestry matrix and <code>Phi</code> is the kinship matrix (both are <code>n</code>-by-<code>n</code> symmetric), then these matrices agree off-diagonal, but the diagonal gets transformed as
<code>diag( Phi ) = ( 1 + diag( Theta ) ) / 2</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coanc_to_kinship(coancestry)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>coancestry</code></td>
<td>
<p>The <code>n</code>-by-<code>n</code> coancestry matrix</p>
</td>
</tr></table>
<h3>Value</h3>

<p>The <code>n</code>-by-<code>n</code> kinship matrix, preserving column and row names.
</p>


<h3>See Also</h3>

<p>The inverse function is given by <code>popkin::inbr_diag()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a trivial case: unadmixed individuals from independent subpopulations
# number of individuals/subpops
n_ind &lt;- 5
# unadmixed individuals
admix_proportions &lt;- diag(rep.int(1, n_ind))
# equal Fst for all subpops
inbr_subpops &lt;- 0.2
# diagonal coancestry matryx
coancestry &lt;- coanc_admix(admix_proportions, inbr_subpops)
kinship &lt;- coanc_to_kinship(coancestry)

# a more complicated admixture model
# number of individuals
n_ind &lt;- 5
# number of intermediate subpops
k_subpops &lt;- 2
# non-trivial admixture proportions
admix_proportions &lt;- admix_prop_1d_linear(n_ind, k_subpops, sigma = 1)
# different Fst for each of the k subpops
inbr_subpops &lt;- c(0.1, 0.3)
# non-trivial coancestry matrix
coancestry &lt;- coanc_admix(admix_proportions, inbr_subpops)
kinship &lt;- coanc_to_kinship( coancestry )

</code></pre>


</div>