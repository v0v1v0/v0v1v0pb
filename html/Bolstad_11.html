<div class="container">

<table style="width: 100%;"><tr>
<td>binogcp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial sampling with a general continuous prior</h2>

<h3>Description</h3>

<p>Evaluates and plots the posterior density for <code class="reqn">\pi</code>, the probability
of a success in a Bernoulli trial, with binomial sampling and a general
continuous prior on <code class="reqn">\pi</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">binogcp(
  x,
  n,
  density = c("uniform", "beta", "exp", "normal", "user"),
  params = c(0, 1),
  n.pi = 1000,
  pi = NULL,
  pi.prior = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the number of observed successes in the binomial experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of trials in the binomial experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>may be one of "beta", "exp", "normal", "student", "uniform"
or "user"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>if density is one of the parameteric forms then then a vector
of parameters must be supplied.  beta: a, b exp: rate normal: mean, sd
uniform: min, max</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.pi</code></td>
<td>
<p>the number of possible <code class="reqn">\pi</code> values in the prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>a vector of possibilities for the probability of success in a
single trial. This must be set if density = "user".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.prior</code></td>
<td>
<p>the associated prior probability mass. This must be set if
density = "user".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that are passed to <code>Bolstad.control</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list will be returned with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>the scaled likelihood function for <code class="reqn">\pi</code> given
<code class="reqn">x</code> and <code class="reqn">n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>the posterior probability of
<code class="reqn">\pi</code> given <code class="reqn">x</code> and <code class="reqn">n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>the vector of possible
<code class="reqn">\pi</code> values used in the prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.prior</code></td>
<td>
<p>the associated
probability mass for the values in <code class="reqn">\pi</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>binobp</code> <code>binodp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## simplest call with 6 successes observed in 8 trials and a continuous
## uniform prior
binogcp(6, 8)

## 6 successes, 8 trials and a Beta(2, 2) prior
binogcp(6, 8,density = "beta", params = c(2, 2))

## 5 successes, 10 trials and a N(0.5, 0.25) prior
binogcp(5, 10, density = "normal", params = c(0.5, 0.25))

## 4 successes, 12 trials with a user specified triangular continuous prior
pi = seq(0, 1,by = 0.001)
pi.prior = rep(0, length(pi))
priorFun = createPrior(x = c(0, 0.5, 1), wt = c(0, 2, 0))
pi.prior = priorFun(pi)
results = binogcp(4, 12, "user", pi = pi, pi.prior = pi.prior)

## find the posterior CDF using the previous example and Simpson's rule
myCdf = cdf(results)
plot(myCdf, type = "l", xlab = expression(pi[0]),
	   ylab = expression(Pr(pi &lt;= pi[0])))

## use the quantile function to find the 95% credible region.
qtls = quantile(results, probs = c(0.025, 0.975))
cat(paste("Approximate 95% credible interval : ["
	, round(qtls[1], 4), " ", round(qtls, 4), "]\n", sep = ""))

## find the posterior mean, variance and std. deviation
## using the output from the previous example
post.mean = mean(results)
post.var = var(results)
post.sd = sd(results)

# calculate an approximate 95% credible region using the posterior mean and
# std. deviation
lb = post.mean - qnorm(0.975) * post.sd
ub = post.mean + qnorm(0.975) * post.sd

cat(paste("Approximate 95% credible interval : ["
	, round(lb, 4), " ", round(ub, 4), "]\n", sep = ""))

</code></pre>


</div>