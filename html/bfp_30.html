<div class="container">

<table style="width: 100%;"><tr>
<td>plotCurveEstimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic function for plotting a fractional polynomial curve estimate</h2>

<h3>Description</h3>

<p>Plot a fractional polynomial curve estimate for either a single model
or a Bayesian model average over <code>BayesMfp</code> objects. Optionally,
credible intervals and / or bands can be added to the plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotCurveEstimate(model, termName, plevel = 0.95, slevel = plevel,
plot = TRUE, legendPos = "topleft", rug = FALSE, partialResids=TRUE, 
hpd=TRUE,..., main = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of class <code>BayesMfp</code> or <code>BmaSamples</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>termName</code></td>
<td>
<p>string denoting an FP term, as written by the
<code>summary</code> method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plevel</code></td>
<td>
<p>credible level for pointwise intervals, and <code>NULL</code>
means no pointwise intervals (default: 0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slevel</code></td>
<td>
<p>credible level for simultaneous credible band (SCB),
<code>NULL</code> means no SCB (defaults to <code>plevel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>FALSE</code>, only return values needed to produce the
plot, but do not plot (default is <code>TRUE</code>, so a plot is made)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPos</code></td>
<td>
<p>position of coefficient estimates (for <code>BayesMfp</code>) or
sample size (for <code>BmaSamples</code>) in the plot, <code>NULL</code> suppresses the
printing (default is “topleft”)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>add a rug to the plot? (default: <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partialResids</code></td>
<td>
<p>add partial residuals to the plot? (default:
<code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpd</code></td>
<td>
<p>use HPD intervals (<code>TRUE</code>, default) or quantile-based
(<code>FALSE</code>) intervals?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments in case of a <code>BayesMfp</code>
object (see details) and arguments for plotting with
<code>matplot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>optional main argument for the plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Further arguments for application on a <code>BayesMfp</code> object:
</p>

<dl>
<dt>grid</dt>
<dd>
<p>vector of unscaled abscissae, default is a length
<code>gridSize</code> grid over the observed range specified by
providing the argument <code>NULL</code>.</p>
</dd>
<dt>post</dt>
<dd>
<p>list with posterior parameters of the model, which may be
provided manually to accelerate plotting in a loop</p>
</dd>
<dt>gridSize</dt>
<dd>
<p>default number of grid points used when no
<code>grid</code> is supplied (default is 201)</p>
</dd>
<dt>numSim</dt>
<dd>
<p>number of simulations for estimation of the SCB
(default is 500)</p>
</dd>
</dl>
<h3>Value</h3>

<p>a list of various plotting information:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>original</code></td>
<td>
<p>grid on the original covariate scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>grid on the transformed scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>mode curve values, only for <code>BayesMfp</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>pointwise mean curve values, only for
<code>BmaSamples</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>pointwise median curve values, only for
<code>BmaSamples</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plower</code></td>
<td>
<p>lower boundaries for pointwise intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pupper</code></td>
<td>
<p>upper boundaries for pointwise intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slower</code></td>
<td>
<p>lower boundaries for SCB</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supper</code></td>
<td>
<p>upper boundaries for SCB</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsVals</code></td>
<td>
<p>observed values of the covariate on the original scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleSize</code></td>
<td>
<p>sample size underlying the curve estimate, only for
<code>BmaSamples</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partialResids</code></td>
<td>
<p>partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>vector of shift and scale parameter</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>BayesMfp</code>, <code>BmaSamples</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## construct a BayesMfp object
set.seed(19)
x1 &lt;- rnorm (n=15)
x2 &lt;- rbinom (n=15, size=20, prob=0.5) 
x3 &lt;- rexp (n=15)
y &lt;- rt (n=15, df=2)

test &lt;- BayesMfp (y ~ bfp (x2, max = 4) + uc (x1 + x3), nModels = 100,
method="exhaustive")

## plot the x2 curve estimate for the 20-th best model
p1 &lt;- plotCurveEstimate (test[20], "x2")

## look at the returned list
str(p1)

## plot the BMA curve estimate for the same covariate
testBma &lt;- BmaSamples (test)
p2 &lt;- plotCurveEstimate (testBma, "x2")

## look at the returned list
str(p2)

## try the new options:
plotCurveEstimate (testBma, "x2", partialResids=FALSE, hpd=FALSE)
</code></pre>


</div>