<div class="container">

<table style="width: 100%;"><tr>
<td>DEzs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Differential-Evolution MCMC zs</h2>

<h3>Description</h3>

<p>Differential-Evolution MCMC zs
</p>


<h3>Usage</h3>

<pre><code class="language-R">DEzs(
  bayesianSetup,
  settings = list(iterations = 10000, Z = NULL, startValue = NULL, pSnooker = 0.1, burnin
    = 0, thin = 1, f = 2.38, eps = 0, parallel = NULL, pGamma1 = 0.1, eps.mult = 0.2,
    eps.add = 0, consoleUpdates = 100, zUpdateFrequency = 1, currentChain = 1,
    blockUpdate = list("none", k = NULL, h = NULL, pSel = NULL, pGroup = NULL, groupStart
    = 1000, groupIntervall = 1000), message = TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bayesianSetup</code></td>
<td>
<p>a BayesianSetup with the posterior density function to be sampled from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settings</code></td>
<td>
<p>list with parameter settings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startValue</code></td>
<td>
<p>(optional) eiter a matrix with start population, a number to define the number of chains that are run or a function that samples a starting population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>starting Z population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>iterations to run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pSnooker</code></td>
<td>
<p>probability of Snooker update</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of iterations treated as burn-in. These iterations are not recorded in the chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning parameter. Determines the interval in which values are recorded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>small number to avoid singularity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>scaling factor for gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical, determines weather parallel computing should be attempted (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pGamma1</code></td>
<td>
<p>probability determining the frequency with which the scaling is set to 1 (allows jumps between modes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.mult</code></td>
<td>
<p>random term (multiplicative error)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.add</code></td>
<td>
<p>random term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockUpdate</code></td>
<td>
<p>list determining whether parameters should be updated in blocks. For possible settings see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>logical determines whether the sampler's progress should be printed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For parallel computing, the likelihood density in the bayesianSetup needs to be parallelized, i.e. needs to be able to operate on a matrix of proposals
</p>
<p>For blockUpdate the first element in the list determines the type of blocking.
Possible choices are
</p>

<ul>
<li>
<p>"none" (default), no blocking of parameters
</p>
</li>
<li>
<p>"correlation"  blocking based on correlation of parameters. Using h or k (see below)
</p>
</li>
<li>
<p>"random"  random blocking. Using k (see below)
</p>
</li>
<li>
<p>"user"  user defined groups. Using groups (see below)
</p>
</li>
</ul>
<p>Further seven parameters can be specified. "k" determnined the number of groups, "h" the strength
of the correlation used to group parameter and "groups" is used for user defined groups.
"groups" is a vector containing the group number for each parameter. E.g. for three parameters
with the first two in one group, "groups" would be c(1,1,2).
Further pSel and pGroup can be used to influence the choice of groups. In the sampling process
a number of groups is randomly drawn and updated. pSel is a vector containing relative probabilities
for an update of the respective number of groups. E.g. for always updating only one group pSel = 1.
For updating one or two groups with the same probability pSel = c(1,1). By default all numbers
have the same probability.
The same principle is used in pGroup. Here the user can influence the probability of each group
to be updated. By default all groups have the same probability.
Finally "groupStart" defines the starting point of the groupUpdate and "groupIntervall" the intervall
in which the groups are evaluated.
</p>


<h3>Author(s)</h3>

<p>Francesco Minunno and Stefan Paul
</p>


<h3>References</h3>

<p>ter  Braak C. J. F., and Vrugt J. A. (2008). Differential Evolution Markov Chain with snooker updater and fewer chains. Statistics and Computing http://dx.doi.org/10.1007/s11222-008-9104-9
</p>


<h3>See Also</h3>

<p><code>DE</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BayesianTools)

ll &lt;- generateTestDensityMultiNormal(sigma = "no correlation")
bayesianSetup &lt;- createBayesianSetup(likelihood = ll, 
                                     lower = rep(-10, 3), 
                                     upper = rep(10, 3))

settings = list(iterations = 200)
out &lt;- runMCMC(bayesianSetup = bayesianSetup, sampler = "DEzs", settings = settings)
summary(out)

# DE family samplers are population MCMCs that run a number of internal chains
# in parallel. Here examples how to change the internal chains
# note that internal chains can be executedi n parallel
settings = list(startValue = 4, iterations = 200)
out &lt;- runMCMC(bayesianSetup = bayesianSetup, sampler = "DEzs", settings = settings)
summary(out)

# Modify the start values of the internal chains (note that this is a matrix
# of dim nChain * nPar)
settings = list(startValue = matrix(rnorm(12), nrow = 4, ncol = 3), 
                iterations = 200)
out &lt;- runMCMC(bayesianSetup = bayesianSetup, sampler = "DEzs", settings = settings)
summary(out)

# In the DE sampler family with Z matrix, the previous chains are written in 
# a common matrix, from which proposals are generated. Per default this matrix
# is started with samples from the prior, but we can change this. Often useful
# to improve sampler convergence, 
# see  https://github.com/florianhartig/BayesianTools/issues/79
settings = list(startValue = matrix(rnorm(12), nrow = 4, ncol = 3),
                Z = matrix(rnorm(300), nrow = 100, ncol = 3),
                iterations = 200)
out &lt;- runMCMC(bayesianSetup = bayesianSetup, sampler = "DEzs", settings = settings)
summary(out)


</code></pre>


</div>