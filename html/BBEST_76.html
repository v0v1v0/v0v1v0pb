<div class="container">

<table style="width: 100%;"><tr>
<td>test.signal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A random function with a smooth background</h2>

<h3>Description</h3>

<p><code>test.signal</code> creates a random function that consists of peaks, a smooth background, and a Gaussian noise. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">test.signal(x, lambda, sigma, x.delta, knots.n, peaks.widthRange, peaks.n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector, the x-points where data should be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>numeric, the mean signal magnitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>numeric, the noise level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.delta</code></td>
<td>
<p>numeric, the minimum spacing allowed between spline knots. Defines background smoothness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots.n</code></td>
<td>
<p>numeric, a number of spline knots to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks.widthRange</code></td>
<td>
<p>numeric vector, specifies range in peak widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks.n</code></td>
<td>
<p>numeric, the number of peaks to generate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The background is calculated as a sum of fundamental splines on the randomly generated knots. The function is a sum of the background, random peaks, and Gaussian noise.
</p>


<h3>Value</h3>

<p>An object of type <code>data</code> (see <code>set.data</code>) with the following elements added: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>list with elements <code>x</code> and <code>y</code> that specify the knot positions and knot values, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bkg</code></td>
<td>
<p>numeric vector containing the generated background.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># 1. Create test function 
f &lt;- test.signal(x=seq(0,30,0.01), lambda=5, 
         sigma=0.1, x.delta=1.0, knots.n=5, 
         peaks.widthRange=c(0.1, 0.3), peaks.n=7)
	
# 2. Plot results
plot(f$x, f$y, t="l", xlab="x", ylab="f")
lines(f$x, f$bkg, col=2)
lines(f$x, f$y - f$bkg, col="gray")
legend(20, .9*max(f$y), c("test function", "background", 
       "peaks+noise"), lty=1, col=c(1,2,"gray"))

</code></pre>


</div>