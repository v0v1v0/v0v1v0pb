<div class="container">

<table style="width: 100%;"><tr>
<td>beta4reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Beta Regression Models</h2>

<h3>Description</h3>

<p>This function fits Bayesian beta regression models. The response distribution can be either the beta with the support on (0,1)  or the four-parameter beta with an unknown final support. The logarithm of the pseudo marginal likelihood (LPML), the deviance information criterion (DIC), and the Watanabe-Akaike information criterion (WAIC) are provided for model comparison.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta4reg(formula, data, na.action, link="logit", model = "mode",
         mcmc=list(nburn=3000, nsave=2000, nskip=0, ndisplay=500),
         prior=NULL, start=NULL, Xpred=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression of the form <code>y ~ x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame in which to interpret the variables named in the <code>formula</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a missing-data filter function, applied to the <code>model.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>a character string for the link function. Choices include <code>"logit"</code>, <code>"probit"</code>, <code>"loglog"</code> and <code>"cloglog"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a character string for the regression type. The options include <code>"mean"</code> for a mean regression, <code>"mode"</code> for a mode regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>a list giving the MCMC parameters. The list must include the following elements: <code>nburn</code> an integer giving the number of burn-in scans, <code>nskip</code> an integer giving the thinning interval, <code>nsave</code> an integer giving the total number of scans to be saved, <code>ndisplay</code> an integer giving the number of saved scans to be displayed on screen (the function reports on the screen when every <code>ndisplay</code> iterations have been carried out).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list giving the prior information. The function itself provides all default priors. The following components can be specified here: <code>ma0</code> and <code>mb0</code> for the prior of marginal population mode or mean, <code>phia0</code> and <code>phib0</code> for the precision parameter, <code>beta0</code> and <code>S0</code> for the coefficients beta, <code>th1a0</code> and <code>th1b0</code> for the lower bound of the support, <code>th2a0</code> and <code>th2b0</code> for the upper bound of the support.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a list giving the starting values of the parameters. The function itself provides all default choices. The following components can be specified here: <code>beta</code>, <code>theta</code>, <code>phi</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xpred</code></td>
<td>
<p>A new design matrix at which estimates of the response model or mean are required. The default is the design matrix returned by the argument <code>formula</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This class of objects is returned by the <code>beta4reg</code> function to represent a fitted Bayesian beta regression model. Objects of this class have methods for the functions <code>print</code> and <code>summary</code>.
</p>
<p>The <code>beta4reg</code> object is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>modelname</code></td>
<td>

<p>the name of the fitted model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>

<p>the <code>terms</code> object used
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>the link function used 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>the model fitted: mean or mode
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>

<p>a named vector of coefficients. The last two elements are the estimates of theta1 and theta2 involved in the support of the four-parameter beta distribution. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>

<p>the matched call
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>the list of hyperparameters used in all priors. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>the list of starting values used for all parameters. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>

<p>the list of MCMC parameters used 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>the number of row observations used in fitting the model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>the number of columns in the model matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>the response observations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>the n by (p+1) orginal design matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>the (p+1) by nsave matrix of posterior samples for the coefficients in the <code>linear.predictors</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>the 2 by nsave matrix of posterior samples for theta1 and theta2 involved in the support.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>the vector of posterior samples for the precision parameter. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpo</code></td>
<td>

<p>the length n vector of the stabilized estiamte of CPO; used for calculating LPML
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pD</code></td>
<td>

<p>the effective number of parameters involved in DIC
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIC</code></td>
<td>

<p>the deviance information criterion (DIC)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pW</code></td>
<td>

<p>the effective number of parameters involved in WAIC
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WAIC</code></td>
<td>

<p>the Watanabe-Akaike information criterion (WAIC)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratetheta</code></td>
<td>

<p>the acceptance rate in the posterior sampling of theta vector involved in the support
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratebeta</code></td>
<td>

<p>the acceptance rate in the posterior sampling of beta coefficient vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratephi</code></td>
<td>

<p>the acceptance rate in the posterior sampling of precision parameter
</p>
</td>
</tr>
</table>
<p>The use of the <code>summary</code> function to the object will return new object with the following additional components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>

<p>A table that presents the posterior summaries for the regression coefficients
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>

<p>A table that presents the posterior summaries for the support boundaries theta1 and theta2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phivar</code></td>
<td>

<p>A table that presents the posterior summaries for the precision phi.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Haiming Zhou and Xianzheng Huang
</p>


<h3>References</h3>

<p>Zhou, H. and Huang, X. (2022). Bayesian beta regression for bounded responses with unknown supports. <em>Computational Statistics &amp; Data Analysis</em>, 167, 107345.
</p>


<h3>See Also</h3>

<p><code>cox.snell.beta4reg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(betaBayes)
library(betareg)

## Data from Ferrari and Cribari-Neto (2004)
data("GasolineYield", package = "betareg")
data("FoodExpenditure", package = "betareg")

## four-parameter beta mean regression
mcmc=list(nburn=2000, nsave=1000, nskip=4, ndisplay=1000);
# Note larger nburn, nsave and nskip should be used in practice.
prior = list(th1a0 = 0, th2b0 = 1) 
# here the natural bound (0,1) is used to specify the prior
# GasolineYield
set.seed(100)
gy_res1 &lt;- beta4reg(yield ~ batch + temp, data = GasolineYield, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(gy_sfit1 &lt;- summary(gy_res1))
cox.snell.beta4reg(gy_res1) # Cox-Snell plot
# FoodExpenditure
set.seed(100)
fe_res1 &lt;- beta4reg(I(food/income) ~ income + persons, data = FoodExpenditure, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(fe_sfit1 &lt;- summary(fe_res1))
cox.snell.beta4reg(fe_res1) # Cox-Snell plot

## two-parameter beta mean regression with support (0,1)
mcmc=list(nburn=2000, nsave=1000, nskip=4, ndisplay=1000);
# Note larger nburn, nsave and nskip should be used in practice.
prior = list(th1a0 = 0, th1b0 = 0, th2a0 = 1, th2b0 = 1)
# this setting forces the support to be (0,1)
# GasolineYield
set.seed(100)
gy_res2 &lt;- beta4reg(yield ~ batch + temp, data = GasolineYield, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(gy_sfit2 &lt;- summary(gy_res2))
cox.snell.beta4reg(gy_res2) # Cox-Snell plot
# FoodExpenditure
set.seed(100)
fe_res2 &lt;- beta4reg(I(food/income) ~ income + persons, data = FoodExpenditure, 
                link = "logit", model = "mean",
                mcmc = mcmc, prior = prior)
(fe_sfit2 &lt;- summary(fe_res2))
cox.snell.beta4reg(fe_res2) # Cox-Snell plot

</code></pre>


</div>