<div class="container">

<table style="width: 100%;"><tr>
<td>rordprobitGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler for Ordered Probit</h2>

<h3>Description</h3>

<p><code>rordprobitGibbs</code> implements a Gibbs Sampler for the ordered probit model with a RW Metropolis step for the cut-offs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rordprobitGibbs(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(y, X, k)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(betabar, A, dstarbar, Ad)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint, s)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">z = X\beta + e</code> with <code class="reqn">e</code> <code class="reqn">\sim</code> <code class="reqn">N(0, I)</code><br><code class="reqn">y = k</code> if c[k] <code class="reqn">\le z &lt;</code> c[k+1] with <code class="reqn">k = 1,\ldots,K</code> <br>
cutoffs = {c[1], <code class="reqn">\ldots</code>, c[k+1]} 
</p>
<p><code class="reqn">\beta</code> <code class="reqn">\sim</code> <code class="reqn">N(betabar, A^{-1})</code> <br><code class="reqn">dstar</code> <code class="reqn">\sim</code> <code class="reqn">N(dstarbar, Ad^{-1})</code>
</p>
<p>Be careful in assessing prior parameter <code>Ad</code>:  0.1 is too small for many applications.
</p>



<h4>Argument Details</h4>

<p><em><code>Data  = list(y, X, k)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>y:        </code> </td>
<td style="text-align: left;"> <code class="reqn">n x 1</code> vector of observations, (<code class="reqn">1, \ldots, k</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>X:        </code> </td>
<td style="text-align: left;"> <code class="reqn">n x p</code> Design Matrix </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>k:        </code> </td>
<td style="text-align: left;"> the largest possible value of y
    </td>
</tr>
</table>
<p><em><code>Prior = list(betabar, A, dstarbar, Ad)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>betabar:  </code> </td>
<td style="text-align: left;"> <code class="reqn">p x 1</code> prior mean (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>A:        </code> </td>
<td style="text-align: left;"> <code class="reqn">p x p</code> prior precision matrix (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>dstarbar: </code> </td>
<td style="text-align: left;"> <code class="reqn">ndstar x 1</code> prior mean,  where <code class="reqn">ndstar=k-2</code> (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Ad:       </code> </td>
<td style="text-align: left;"> <code class="reqn">ndstar x ndstar</code> prior precision matrix (def: I)
    </td>
</tr>
</table>
<p><em><code>Mcmc  = list(R, keep, nprint, s)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:        </code> </td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:     </code> </td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint:   </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>s:        </code> </td>
<td style="text-align: left;"> scaling parameter for RW Metropolis (def: 2.93/<code>sqrt(p)</code>)
    </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betadraw  </code></td>
<td>
 <p><code class="reqn">R/keep x p</code> matrix of betadraws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutdraw   </code></td>
<td>
 <p><code class="reqn">R/keep x (k-1)</code> matrix of cutdraws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dstardraw </code></td>
<td>
 <p><code class="reqn">R/keep x (k-2)</code> matrix of dstardraws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept    </code></td>
<td>
<p> acceptance rate of Metropolis draws for cut-offs</p>
</td>
</tr>
</table>
<h3>Note</h3>

 
<p>set c[1] = -100 and c[k+1] = 100. c[2] is set to 0 for identification. <br></p>
<p>The relationship between cut-offs and dstar is: <br>
c[3] = exp(dstar[1]),  <br>
c[4] = c[3] + exp(dstar[2]), ...,  <br>
c[k] = c[k-1] + exp(dstar[k-2]) 
</p>


<h3>Author(s)</h3>

<p> Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p><em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>See Also</h3>

 <p><code>rbprobitGibbs</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=2000} else {R=10}
set.seed(66)

## simulate data for ordered probit model

simordprobit=function(X, betas, cutoff){
  z = X%*%betas + rnorm(nobs)   
  y = cut(z, br = cutoff, right=TRUE, include.lowest = TRUE, labels = FALSE)  
  return(list(y = y, X = X, k=(length(cutoff)-1), betas= betas, cutoff=cutoff ))
}

nobs = 300 
X = cbind(rep(1,nobs),runif(nobs, min=0, max=5),runif(nobs,min=0, max=5))
k = 5
betas = c(0.5, 1, -0.5)       
cutoff = c(-100, 0, 1.0, 1.8, 3.2, 100)
simout = simordprobit(X, betas, cutoff) 
  
Data=list(X=simout$X, y=simout$y, k=k)

## set Mcmc for ordered probit model
   
Mcmc = list(R=R)   
out = rordprobitGibbs(Data=Data, Mcmc=Mcmc)

cat(" ", fill=TRUE)
cat("acceptance rate= ", accept=out$accept, fill=TRUE)
 
## outputs of betadraw and cut-off draws
  
cat(" Summary of betadraws", fill=TRUE)
summary(out$betadraw, tvalues=betas)
cat(" Summary of cut-off draws", fill=TRUE) 
summary(out$cutdraw, tvalues=cutoff[2:k])

## plotting examples
if(0){plot(out$cutdraw)}
</code></pre>


</div>