<div class="container">

<table style="width: 100%;"><tr>
<td>rMVNorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample from the multivariate normal distribution
</h2>

<h3>Description</h3>

<p>According to the parametrization used, sample from the multivariate
normal distribution.
</p>
<p>The following parametrization can be specified
</p>

<dl>
<dt>standard</dt>
<dd>
<p>In this case we sample from either
<code class="reqn">\mathcal{N}(\mu, \Sigma)</code> or from
<code class="reqn">\mathcal{N}(\mu, Q^{-1}).</code>      
</p>
</dd>
<dt>canonical</dt>
<dd>
<p>In this case we sample from
<code class="reqn">\mathcal{N}(Q^{-1}b,\;Q^{-1}).</code>      
</p>
</dd>
</dl>
<p>Generation of random numbers is performed by Algorithms 2.3-2.5 in Rue and
Held (2005, pp. 34-35). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  rMVNorm(n, mean=0, Sigma=1, Q, param=c("standard", "canonical"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>

<p>For <code>param="standard"</code>, it is 
a vector <code class="reqn">\mu</code> of means. If <code>length(mean)</code> is equal to 1, it
is recycled and all components have the same mean.
</p>
<p>For <code>param="canonical"</code>, it is 
a vector <code class="reqn">b</code> of canonical means. If <code>length(mean)</code> is equal to 1, it
is recycled and all components have the same mean.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>covariance matrix of the multivariate normal
distribution. It is ignored if <code>Q</code> is given at the same time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>precision matrix of the multivariate normal distribution.
</p>
<p>It does not have to be supplied provided <code>Sigma</code> is given and
<code>param="standard"</code>.
</p>
<p>It must be supplied if <code>param="canonical"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a character which specifies the parametrization.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix with sampled points in rows.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Rue, H. and Held, L. (2005).
<em>Gaussian Markov Random Fields: Theory and Applications</em>.
Boca Raton: Chapman and Hall/CRC.  
</p>


<h3>See Also</h3>

<p><code>rnorm</code>, <code>Mvnorm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Mean, covariance matrix, its inverse
### and the canonical mean
mu &lt;- c(0, 2, 0.5)
L &lt;- matrix(c(1, 1, 1,  0, 0.5, 0.5,  0, 0, 0.3), ncol=3)
Sigma &lt;- L %*% t(L)
Q &lt;- chol2inv(t(L))
b &lt;- Q %*% mu

print(Sigma)
print(Q)
print(Sigma %*% Q)

### Sample using different parametrizations
set.seed(775988621)
n &lt;- 10000

### Sample from N(mu, Sigma)
xx1 &lt;- rMVNorm(n=n, mean=mu, Sigma=Sigma)
apply(xx1, 2, mean)
var(xx1)

### Sample from N(mu, Q^{-1})
xx2 &lt;- rMVNorm(n=n, mean=mu, Q=Q)
apply(xx2, 2, mean)
var(xx2)

### Sample from N(Q^{-1}*b, Q^{-1})
xx3 &lt;- rMVNorm(n=n, mean=b, Q=Q, param="canonical")
apply(xx3, 2, mean)
var(xx3)
</code></pre>


</div>