<div class="container">

<table style="width: 100%;"><tr>
<td>simsij</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation function</h2>

<h3>Description</h3>

<p>Proportion estimation procedure for simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simsij(nsims = 100, n = 256, proportion = P2, binsize = 1,
    thrule = "ebayesthresh", van = 8, fam = "DaubLeAsymm", pl = 3,
    prior = "laplace",
    vscale = "independent", plotstep = FALSE, a = NA,truncate = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>
<p>The number of times to repeat the function <span class="env">doall</span> (on random datasets from <span class="env">proportion</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Length of vector to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportion</code></td>
<td>
<p>The function name of the proportion to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>
<p>The binomial size corresponding to the mean function <span class="env">proportion</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thrule</code></td>
<td>
<p>Thresholding procedure to be used in the smoothing.  Possible values are "sureshrink" and "ebayesthresh".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>van</code></td>
<td>
<p>the vanishing moments of the decomposing wavelet basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>the wavelet family to be used for the decomposing transform.Possible values are "DaubLeAsymm" and "DaubExPhase".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>the primary resolution to be used in the wavelet transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Prior to be used in ebayesthresh thresholding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vscale</code></td>
<td>
<p>argument to ebayesthresh thresholding procedure (variance calculation: "independent" or "bylevel").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotstep</code></td>
<td>
<p>Should all steps be plotted in estimation procedure?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the <span class="env">a</span> argument for <code>EbayesThresh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>Should the estimates be truncated to lie in [0,1]?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any other optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a regularly-spaced vector on the unit interval of length <span class="env">length</span>, and uses these values to create corresponding values using the proportion function.  These values are then used as binomial probabilities to sample "observed" binomial random variables.  The observation vector is then denoised using a wavelet transform defined by the arguments <span class="env">van</span>, <span class="env">fam</span>, <span class="env">min.level</span> with thresholding method <span class="env">meth</span>.  This denoising is done for both Anscombe and the Haar-Fisz method for binomial random variables.  The procedure is repeated <span class="env">times</span> times, and the resulting proportion estimates averaged.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>regular grid on which the proportion function is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truep</code></td>
<td>
<p>vector corresponding to <span class="env">x</span> of proportion function values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ans</code></td>
<td>
<p>matrix containing the errors from each of the <span class="env">nsims</span> <span class="env">doall</span> runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Array containing the <span class="env">nsims</span> estimates produced by Anscombe and Haar-Fisz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin</code></td>
<td>
<p>Matrix of the raw binomial samples for each of the <span class="env">nsims</span> runs.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matt Nunes (<a href="mailto:m.nunes@ucl.ac.uk">m.nunes@ucl.ac.uk</a>)</p>


<h3>See Also</h3>

<p><code>hfdenoise</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
a&lt;-simsij(nsims=100)

plot(a$est[1,,1])


##^^ shows 1st binomial Haar-Fisz estimate.

## End(Not run)
</code></pre>


</div>