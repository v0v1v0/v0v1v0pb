<div class="container">

<table style="width: 100%;"><tr>
<td>bvec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Vector Error Correction Objects</h2>

<h3>Description</h3>

<p>'bvec' is used to create objects of class <code>"bvec"</code>.
</p>
<p>A plot function for objects of class <code>"bvec"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bvec(
  y,
  alpha = NULL,
  beta = NULL,
  beta_x = NULL,
  beta_d = NULL,
  r = NULL,
  Pi = NULL,
  Pi_x = NULL,
  Pi_d = NULL,
  w = NULL,
  w_x = NULL,
  w_d = NULL,
  Gamma = NULL,
  Upsilon = NULL,
  C = NULL,
  x = NULL,
  x_x = NULL,
  x_d = NULL,
  A0 = NULL,
  Sigma = NULL,
  data = NULL,
  exogen = NULL
)

## S3 method for class 'bvec'
plot(x, ci = 0.95, type = "hist", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time-series object of differenced endogenous variables,
usually, a result of a call to <code>gen_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a <code class="reqn">Kr \times S</code> matrix of MCMC coefficient draws of the loading matrix <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a <code class="reqn">Kr \times S</code> matrix of MCMC coefficient draws of cointegration matrix <code class="reqn">\beta</code>
corresponding to the endogenous variables of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_x</code></td>
<td>
<p>a <code class="reqn">Mr \times S</code> matrix of MCMC coefficient draws of cointegration matrix <code class="reqn">\beta</code>
corresponding to unmodelled, non-deterministic variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_d</code></td>
<td>
<p>a <code class="reqn">N^{R}r \times S</code> matrix of MCMC coefficient draws of cointegration matrix <code class="reqn">\beta</code>
corresponding to restricted deterministic terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>an integer of the rank of the cointegration matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>a <code class="reqn">K^2 \times S</code> matrix of MCMC coefficient draws of endogenous varaibles in the cointegration matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi_x</code></td>
<td>
<p>a <code class="reqn">KM \times S</code> matrix of MCMC coefficient draws of unmodelled, non-deterministic variables in the cointegration matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi_d</code></td>
<td>
<p>a <code class="reqn">KN^{R} \times S</code> matrix of MCMC coefficient draws of restricted deterministic terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a time-series object of lagged endogenous variables in levels, which enter the
cointegration term, usually, a result of a call to <code>gen_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_x</code></td>
<td>
<p>a time-series object of lagged unmodelled, non-deterministic variables in levels, which enter the
cointegration term, usually, a result of a call to <code>gen_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_d</code></td>
<td>
<p>a time-series object of deterministic terms, which enter the
cointegration term, usually, a result of a call to <code>gen_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>a <code class="reqn">(p-1)K^2 \times S</code> matrix of MCMC coefficient draws of differenced lagged endogenous variables or
a named list, where element <code>coeffs</code> contains a <code class="reqn">(p - 1)K^2 \times S</code> matrix of MCMC coefficient draws
of lagged differenced endogenous variables and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upsilon</code></td>
<td>
<p>an <code class="reqn">sMK \times S</code> matrix of MCMC coefficient draws of differenced unmodelled, non-deterministic variables or
a named list, where element <code>coeffs</code> contains a <code class="reqn">sMK \times S</code> matrix of MCMC coefficient draws of
unmodelled, non-deterministic variables and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>an <code class="reqn">KN^{UR} \times S</code> matrix of MCMC coefficient draws of unrestricted deterministic terms or
a named list, where element <code>coeffs</code> contains a <code class="reqn">KN^{UR} \times S</code> matrix of MCMC coefficient draws of
deterministic terms and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"bvec"</code>, usually, a result of a call to <code>draw_posterior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_x</code></td>
<td>
<p>a time-series object of <code class="reqn">Ms</code> differenced unmodelled regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_d</code></td>
<td>
<p>a time-series object of <code class="reqn">N^{UR}</code> deterministic terms that do not enter the
cointegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0</code></td>
<td>
<p>either a <code class="reqn">K^2 \times S</code> matrix of MCMC coefficient draws of structural parameters or
a named list, where element <code>coeffs</code> contains a <code class="reqn">K^2 \times S</code> matrix of MCMC coefficient
draws of structural parameters and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>a <code class="reqn">K^2 \times S</code> matrix of MCMC draws for the error variance-covariance matrix or
a named list, where element <code>coeffs</code> contains a <code class="reqn">K^2 \times S</code> matrix of MCMC draws for the
error variance-covariance matrix and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed to the covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the original time-series object of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>the original time-series object of unmodelled variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>interval used to calculate credible bands for time-varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>either <code>"hist"</code> (default) for histograms, <code>"trace"</code> for a trace plot
or <code>"boxplot"</code> for a boxplot. Only used for parameter draws of constant coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the vector error correction model with unmodelled exogenous variables (VECX) 
</p>
<p style="text-align: center;"><code class="reqn">A_0 \Delta y_t = \Pi^{+} \begin{pmatrix} y_{t-1} \\ x_{t-1} \\ d^{R}_{t-1} \end{pmatrix} +
\sum_{i = 1}^{p-1} \Gamma_i \Delta y_{t-i} +
\sum_{i = 0}^{s-1} \Upsilon_i \Delta x_{t-i} +
C^{UR} d^{UR}_t + u_t</code>
</p>

<p>the function collects the <code class="reqn">S</code> draws of a Gibbs sampler in a standardised object,
where <code class="reqn">\Delta y_t</code> is a K-dimensional vector of differenced endogenous variables
and <code class="reqn">A_0</code> is a <code class="reqn">K \times K</code> matrix of structural coefficients.
<code class="reqn">\Pi^{+} = \left[ \Pi, \Pi^{x}, \Pi^{d} \right]</code> is
the coefficient matrix of the error correction term, where
<code class="reqn">y_{t-1}</code>, <code class="reqn">x_{t-1}</code> and <code class="reqn">d^{R}_{t-1}</code> are the first lags of endogenous,
exogenous variables in levels and restricted deterministic terms, respectively.
<code class="reqn">\Pi</code>, <code class="reqn">\Pi^{x}</code>, and <code class="reqn">\Pi^{d}</code> are the corresponding coefficient matrices, respectively.
<code class="reqn">\Gamma_i</code> is a coefficient matrix of lagged differenced endogenous variabels.
<code class="reqn">\Delta x_t</code> is an M-dimensional vector of unmodelled, non-deterministic variables
and <code class="reqn">\Upsilon_i</code> its corresponding coefficient matrix. <code class="reqn">d_t</code> is an
<code class="reqn">N^{UR}</code>-dimensional vector of unrestricted deterministics and <code class="reqn">C^{UR}</code>
the corresponding coefficient matrix.
<code class="reqn">u_t</code> is an error term with <code class="reqn">u_t \sim N(0, \Sigma_u)</code>.
</p>
<p>For time varying parameter and stochastic volatility models the respective coefficients and
error covariance matrix of the above model are assumed to be time varying, respectively.
</p>
<p>The draws of the different coefficient matrices provided in <code>alpha</code>, <code>beta</code>,
<code>Pi</code>, <code>Pi_x</code>, <code>Pi_d</code>, <code>A0</code>, <code>Gamma</code>, <code>Ypsilon</code>,
<code>C</code> and <code>Sigma</code> have to correspond to the same MCMC iteration.
</p>


<h3>Value</h3>

<p>An object of class <code>"gvec"</code> containing the following components, if specified:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the original time-series object of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>the original time-series object of unmodelled variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time-series object of differenced endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a time-series object of lagged endogenous variables in levels, which enter the
cointegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_x</code></td>
<td>
<p>a time-series object of lagged unmodelled, non-deterministic variables in levels, which enter the
cointegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_d</code></td>
<td>
<p>a time-series object of deterministic terms, which enter the
cointegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a time-series object of <code class="reqn">K(p - 1)</code> differenced endogenous variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_x</code></td>
<td>
<p>a time-series object of <code class="reqn">Ms</code> differenced unmodelled regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_d</code></td>
<td>
<p>a time-series object of <code class="reqn">N^{UR}</code> deterministic terms that do not enter the
cointegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of coefficient draws of structural parameters. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0_lambda</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of inclusion parameters for coefficients
corresponding to structural parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0_sigma</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of the error covariance matrices of the structural parameters in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>an <code class="reqn">S \times Kr</code> "mcmc" object of coefficient draws of loading parameters. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>an <code class="reqn">S \times ((K + M + N^{R})r)</code> "mcmc" object of coefficient draws of cointegration parameters
corresponding to the endogenous variables of the model. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_x</code></td>
<td>
<p>an <code class="reqn">S \times KM</code> "mcmc" object of coefficient draws of cointegration parameters
corresponding to unmodelled, non-deterministic variables. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_d</code></td>
<td>
<p>an <code class="reqn">S \times KN^{R}</code> "mcmc" object of coefficient draws of cointegration parameters
corresponding to restricted deterministic variables. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of coefficient draws of endogenous variables in the cointegration matrix. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi_x</code></td>
<td>
<p>an <code class="reqn">S \times KM</code> "mcmc" object of coefficient draws of unmodelled, non-deterministic variables in the cointegration matrix. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi_d</code></td>
<td>
<p>an <code class="reqn">S \times KN^{R}</code> "mcmc" object of coefficient draws of restricted deterministic variables in the cointegration matrix. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>an <code class="reqn">S \times (p-1)K^2</code> "mcmc" object of coefficient draws of differenced lagged endogenous variables. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_lamba</code></td>
<td>
<p>an <code class="reqn">S \times (p-1)K^2</code> "mcmc" object of inclusion parameters for coefficients
corresponding to differenced lagged endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_sigma</code></td>
<td>
<p>an <code class="reqn">S \times (p - 1)K^2</code> "mcmc" object of the error covariance matrices of the coefficients of lagged endogenous variables in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upsilon</code></td>
<td>
<p>an <code class="reqn">S \times sMK</code> "mcmc" object of coefficient draws of differenced unmodelled, non-deterministic variables. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upsilon_lambda</code></td>
<td>
<p>an <code class="reqn">S \times sMK</code> "mcmc" object of inclusion parameters for coefficients
corresponding to differenced unmodelled, non-deterministic variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upsilon_sigma</code></td>
<td>
<p>an <code class="reqn">S \times sMK</code> "mcmc" object of the error covariance matrices of the coefficients of unmodelled, non-deterministic variables in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>an <code class="reqn">S \times KN^{UR}</code> "mcmc" object of coefficient draws of deterministic terms that
do not enter the cointegration term. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_lambda</code></td>
<td>
<p>an <code class="reqn">S \times KN^{UR}</code> "mcmc" object of inclusion parameters for coefficients
corresponding to deterministic terms, that do not enter the conintegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_sigma</code></td>
<td>
<p>an <code class="reqn">S \times KN^{UR}</code> "mcmc" object of the error covariance matrices of the coefficients of deterministic terms, which do not enter the cointegration term, in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of variance-covariance draws. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_lambda</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object inclusion parameters for the variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_sigma</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of the error covariance matrices of the coefficients of the error covariance matrix of the measurement equation of a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specifications</code></td>
<td>
<p>a list containing information on the model specification.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# Load data
data("e6")
# Generate model
data &lt;- gen_vec(e6, p = 4, r = 1, const = "unrestricted", season = "unrestricted")
# Obtain data matrices
y &lt;- t(data$data$Y)
w &lt;- t(data$data$W)
x &lt;- t(data$data$X)

# Reset random number generator for reproducibility
set.seed(1234567)

iterations &lt;- 400 # Number of iterations of the Gibbs sampler
# Chosen number of iterations should be much higher, e.g. 30000.

burnin &lt;- 100 # Number of burn-in draws
draws &lt;- iterations + burnin

r &lt;- 1 # Set rank

tt &lt;- ncol(y) # Number of observations
k &lt;- nrow(y) # Number of endogenous variables
k_w &lt;- nrow(w) # Number of regressors in error correction term
k_x &lt;- nrow(x) # Number of differenced regressors and unrestrictec deterministic terms

k_alpha &lt;- k * r # Number of elements in alpha
k_beta &lt;- k_w * r # Number of elements in beta
k_gamma &lt;- k * k_x

# Set uninformative priors
a_mu_prior &lt;- matrix(0, k_x * k) # Vector of prior parameter means
a_v_i_prior &lt;- diag(0, k_x * k) # Inverse of the prior covariance matrix

v_i &lt;- 0
p_tau_i &lt;- diag(1, k_w)

u_sigma_df_prior &lt;- r # Prior degrees of freedom
u_sigma_scale_prior &lt;- diag(0, k) # Prior covariance matrix
u_sigma_df_post &lt;- tt + u_sigma_df_prior # Posterior degrees of freedom

# Initial values
beta &lt;- matrix(c(1, -4), k_w, r)
u_sigma_i &lt;- diag(1 / .0001, k)
g_i &lt;- u_sigma_i

# Data containers
draws_alpha &lt;- matrix(NA, k_alpha, iterations)
draws_beta &lt;- matrix(NA, k_beta, iterations)
draws_pi &lt;- matrix(NA, k * k_w, iterations)
draws_gamma &lt;- matrix(NA, k_gamma, iterations)
draws_sigma &lt;- matrix(NA, k^2, iterations)

# Start Gibbs sampler
for (draw in 1:draws) {
  # Draw conditional mean parameters
  temp &lt;- post_coint_kls(y = y, beta = beta, w = w, x = x, sigma_i = u_sigma_i,
                         v_i = v_i, p_tau_i = p_tau_i, g_i = g_i,
                         gamma_mu_prior = a_mu_prior,
                         gamma_v_i_prior = a_v_i_prior)
  alpha &lt;- temp$alpha
  beta &lt;- temp$beta
  Pi &lt;- temp$Pi
  gamma &lt;- temp$Gamma
  
  # Draw variance-covariance matrix
  u &lt;- y - Pi %*% w - matrix(gamma, k) %*% x
  u_sigma_scale_post &lt;- solve(tcrossprod(u) +
     v_i * alpha %*% tcrossprod(crossprod(beta, p_tau_i) %*% beta, alpha))
  u_sigma_i &lt;- matrix(rWishart(1, u_sigma_df_post, u_sigma_scale_post)[,, 1], k)
  u_sigma &lt;- solve(u_sigma_i)
  
  # Update g_i
  g_i &lt;- u_sigma_i
  
  # Store draws
  if (draw &gt; burnin) {
    draws_alpha[, draw - burnin] &lt;- alpha
    draws_beta[, draw - burnin] &lt;- beta
    draws_pi[, draw - burnin] &lt;- Pi
    draws_gamma[, draw - burnin] &lt;- gamma
    draws_sigma[, draw - burnin] &lt;- u_sigma
  }
}

# Number of non-deterministic coefficients
k_nondet &lt;- (k_x - 4) * k

# Generate bvec object
bvec_est &lt;- bvec(y = data$data$Y, w = data$data$W,
                 x = data$data$X[, 1:6],
                 x_d = data$data$X[, 7:10],
                 Pi = draws_pi,
                 Gamma = draws_gamma[1:k_nondet,],
                 C = draws_gamma[(k_nondet + 1):nrow(draws_gamma),],
                 Sigma = draws_sigma)


# Load data 
data("e6")

# Generate model
model &lt;- gen_vec(data = e6, p = 2, r = 1, const = "unrestricted",
                 iterations = 20, burnin = 10)
# Chosen number of iterations and burn-in should be much higher.

# Add priors
model &lt;- add_priors(model)

# Obtain posterior draws
object &lt;- draw_posterior(model)

# Plot draws
plot(object)

</code></pre>


</div>