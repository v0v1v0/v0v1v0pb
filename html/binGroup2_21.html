<div class="container">

<table style="width: 100%;"><tr>
<td>gtPower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power to reject a hypothesis for one proportion in group testing</h2>

<h3>Description</h3>

<p>This function calculates the power to reject a hypothesis
in a group testing experiment, using confidence intervals for the
decision. This function also calculates the bias of the point estimator
for a given <code class="reqn">n</code>, <code class="reqn">s</code>, and true, unknown proportion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gtPower(
  n,
  s,
  delta,
  p.hyp,
  conf.level = 0.95,
  method = "CP",
  alternative = "two.sided"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer specifying the number of groups. A vector of integers is
also allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>integer specifying the common group size. A vector of integers is
also allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the absolute difference between the true proportion and the
hypothesized proportion. A vector is also allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.hyp</code></td>
<td>
<p>the proportion in the hypotheses, specified as a value between
0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level required for the decision on the
hypotheses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string specifying the confidence interval method
(see <code>propCI</code>) to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>character string defining the alternative hypothesis,
either <kbd>"two.sided"</kbd>, <kbd>"less"</kbd>, or <kbd>"greater"</kbd>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power of a hypothesis test performed by a confidence
interval is defined as the probability that a confidence interval
excludes the threshold parameter (<kbd>p.hyp</kbd>) of the null hypothesis,
as described in Schaarschmidt (2007). Due to discreteness, the power
does not increase monotonically for an increasing number of groups <code class="reqn">n</code>
or group size <code class="reqn">s</code>, but exhibits local maxima and minima, depending
on <code class="reqn">n</code>, <code class="reqn">s</code>, <kbd>p.hyp</kbd>, and <kbd>conf.level</kbd>.
</p>
<p>Additional to the power, the bias of the point estimator is calculated
according to Swallow (1985). If vectors are specified for <code class="reqn">n</code>,
<code class="reqn">s</code>, and (or) delta, a matrix will be constructed and power and
bias are calculated for each line in this matrix.
</p>


<h3>Value</h3>

<p>A matrix containing the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>a vector of the total sample size, <code class="reqn">n*s</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a vector of the number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>a vector of the group sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a vector of the delta values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the power to reject the given null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias</code></td>
<td>
<p>the bias of the estimator for the specified
<code class="reqn">n</code>, <code class="reqn">s</code>, and the true proportion.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This function was originally written as <code>bgtPower</code> by Frank
Schaarschmidt for the <code>binGroup</code> package. Minor modifications have
been made for inclusion of the function in the <code>binGroup2</code> package.
</p>


<h3>References</h3>

<p>Schaarschmidt, F. (2007).
“Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing.”
<em>Communications in Biometry and Crop Science</em>, <b>2</b>, 32–40.
ISSN 1896-0782.
</p>
<p>Swallow, W. (1985).
“Group testing for estimating infection rates and probabilities of disease transmission.”
<em>Phytopathology</em>, <b>75</b>, 882–889.
</p>


<h3>See Also</h3>

<p><code>propCI</code> for confidence intervals and
<code>gtTest</code> for hypothesis tests for one proportion from a
group testing experiment.
</p>
<p>Other estimation functions: 
<code>designEst()</code>,
<code>designPower()</code>,
<code>gtTest()</code>,
<code>gtWidth()</code>,
<code>propCI()</code>,
<code>propDiffCI()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the power for the design
#   in the example given in Tebbs and Bilder(2004):
#   n=24 groups each containing 7 insects
#   if the true proportion of virus vectors
#   in the population is 0.04 (4 percent),
#   the power to reject H0: p&gt;=0.1 using an
#   upper Clopper-Pearson ("CP") confidence interval
#   is calculated with the following call:
gtPower(n = 24, s = 7, delta = 0.06, p.hyp = 0.1,
        conf.level = 0.95, alternative = "less",
        method = "CP")

# Explore development of power and bias for varying n,
#   s, and delta. How much can we decrease the number of
#   groups (costly tests to be performed) by pooling the
#   same number of 320 individuals to groups of
#   increasing size without largely decreasing power?
gtPower(n = c(320, 160, 80, 64, 40, 32, 20, 10, 5),
        s = c(1, 2, 4, 5, 8, 10, 16, 32, 64),
        delta = 0.01,  p.hyp = 0.02)

# What happens to the power for increasing differences
#   between the true proportion and the threshold
#   proportion?
gtPower(n = 50, s = 10,
        delta = seq(from = 0, to = 0.01, by = 0.001),
        p.hyp = 0.01, method = "CP")

# Calculate power with a group size of 1 (individual
#   testing).
gtPower(n = 100, s = 1,
        delta = seq(from = 0, to = 0.01, by = 0.001),
        p.hyp = 0.01, method = "CP")
</code></pre>


</div>