<div class="container">

<table style="width: 100%;"><tr>
<td>nsDist3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate coordinate-specific distance matrices, only for nearest neighbors
and store in an array</h2>

<h3>Description</h3>

<p><code>nsDist3d</code> generates and returns new 3-dimensional arrays containing
the former dist1_sq, dist2_sq, and dist12 matrices, but
only as needed for the k nearest-neighbors of each location.
these 3D matrices (dist1_3d, dist2_3d, and dist12_3d)
are used in the new implementation of calculateAD_ns().
</p>


<h3>Usage</h3>

<pre><code class="language-R">nsDist3d(coords, nID, scale_factor = NULL, isotropic = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>N x 2 matrix; contains the x-y coordinates of stations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nID</code></td>
<td>
<p>N x k matrix; contains indices of nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_factor</code></td>
<td>
<p>Scalar; optional argument for re-scaling the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isotropic</code></td>
<td>
<p>Logical; indicates whether distances should be calculated
separately for each coordinate dimension (FALSE) or simultaneously for all
coordinate dimensions (TRUE). <code>isotropic = TRUE</code> can only be used for
two-dimensional coordinate systems.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Arrays with nearest neighbor distances in each coordinate 
direction.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some coordinates and neighbors
coords &lt;- cbind(runif(100),runif(100))
nID &lt;- determineNeighbors(coords, 10)
# Calculate distances
nsDist3d(coords, nID)

</code></pre>


</div>