<div class="container">

<table style="width: 100%;"><tr>
<td>simPVmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate performance of confidence intervals for predictive values in case-control design</h2>

<h3>Description</h3>

<p>Simulate the power (probability to exclude NPV0/PPV0), the coverage probability, and 0.1, 0.2, and 0.5-quantiles of the distribution of (lower!) asymptotic confidence bounds for predictive values. Different experimental setups may be compared. The function draws data under the binomial assumption and computes the asymptotic confidence bounds (lower bounds only!) for the positive and negative predictive values.</p>


<h3>Usage</h3>

<pre><code class="language-R">simPVmat(se, sp, pr, n1, n0, NPV0, PPV0,
 conf.level = 0.95, NSIM = 500, setnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a (vector of) numeric value(s), specifying sensitivity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>a (vector of) numeric value(s), specifying specitivity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>a (vector of) numeric value(s), specifying prevalence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>a (vector of integer) value(s), specifying the number of truely positive compounds in the trial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>a (vector of integer) value(s), specifying the number of truely negative compounds in the trial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the hypothesized negative predictive value (NPV assumed under H0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the hypothesized positive predictive value (PPV assumed under H0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a single numeric value, the confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NSIM</code></td>
<td>
<p>a single (integer) value, the number of simulations to be run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setnames</code></td>
<td>
<p>optional character vector to the parameter sets in the output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The vector or single values in se, sp, pr, n1, n0, NPV0, PPV0 are put together (shorter vectors recycled to the length of longest vectors). Then each of the resulting parameter settings is simulated as described in <code>simPV</code>
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>INDAT</code></td>
<td>
<p>a dataframe with rows showing the sets of parameters build from the input values and columns: se, sp, pr, NPV0, PPV0, n1, n0, n (total sample size)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPV</code></td>
<td>
<p>a matrix with simulation results for the negative predictive value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPV</code></td>
<td>
<p>a matrix with simulation results for the positive predictive value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NSIM</code></td>
<td>
<p>number of suimulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>nominal confidence level</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Frank Schaarschmidt</p>


<h3>See Also</h3>

<p>This function is meantb to check small sample results obtained by the asymptotci formulas for experimental design from <code>nPV</code>, <code>nNPV</code>, <code>nPPV</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
simPVmat(se=0.8, sp=0.95, pr=1/16,
 n1=c(177, 181), n0=c(554, 87), NPV0=0.98, PPV0=c(0.4, 0.25))


simPVmat(se=0.8, sp=0.95, pr=c(0.05,0.0625, 0.075, 0.1),
 n1=177, n0=554, NPV0=0.98, PPV0=0.4)



</code></pre>


</div>