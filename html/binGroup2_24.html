<div class="container">

<table style="width: 100%;"><tr>
<td>gtSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation function for group testing data</h2>

<h3>Description</h3>

<p>Simulates data in group testing form ready to be
fit by <code>gtReg</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gtSim(
  type = "sp",
  x = NULL,
  gshape = 20,
  gscale = 2,
  par,
  linkf = c("logit", "probit", "cloglog"),
  size1,
  size2,
  sens = 1,
  spec = 1,
  sens.ind = NULL,
  spec.ind = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><kbd>"sp"</kbd> for simple pooling (Dorfman testing with
or without retests), <kbd>"halving"</kbd> for
halving protocol, and <kbd>"array"</kbd> for array testing
(also known as matrix pooling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of user-submitted covariates with which to
simulate the data. Default is <kbd>NULL</kbd>, in which case a gamma
distribution is used to generate the covariates automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gshape</code></td>
<td>
<p>shape parameter for the gamma distribution. The
value must be non-negative. Default value is set to 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gscale</code></td>
<td>
<p>scale parameter for the gamma distribution. The
value must be strictly positive. Default value is set to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>the true coefficients in the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkf</code></td>
<td>
<p>a character string specifying one of the three
link functions to be used: <kbd>"logit"</kbd> (default), <kbd>"probit"</kbd>, or
<kbd>"cloglog"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size1</code></td>
<td>
<p>sample size of the simulated data (for use with
<kbd>"sp"</kbd> and <kbd>"halving"</kbd> methods) or a vector that specifies the
number of rows in each matrix (for use with <kbd>"array"</kbd> method). If
only one matrix is simulated, this value is a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size2</code></td>
<td>
<p>group size in pooling individual samples (for use
with <kbd>"sp"</kbd> and <kbd>"halving"</kbd> methods) or a vector that specifies
the number of columns in each matrix (for use with <kbd>"array"</kbd> method).
If only one matrix is simulated, this value is a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens</code></td>
<td>
<p>sensitivity of the group tests. Default value is
set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>specificity of the group tests. Default value is
set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens.ind</code></td>
<td>
<p>sensitivity of the individual retests. If NULL,
set to be equal to sens.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.ind</code></td>
<td>
<p>specificity of the individual retests. If NULL,
set to be equal to spec.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates group testing data in simple pooling form
(<kbd>type = "sp"</kbd>), for the halving protocol (<kbd>type = "halving"</kbd>),
or in array testing form (<kbd>type = "array"</kbd>).
The covariates are either specified by the <kbd>x</kbd> argument or they
are generated from a gamma distribution with the given <kbd>gshape</kbd>
and <kbd>gscale</kbd> parameters. The individual probabilities are
calculated from the covariates, the coefficients given in <kbd>par</kbd>,
and the link function specified through <kbd>linkf</kbd>. The true binary
individual responses are then simulated from the individual
probabilities.
</p>
<p>Under the matrix pooling protocol (<kbd>type = "array"</kbd>),
the individuals are first organized into (by column) one or more matrices
specified by the number of rows (<kbd>size1</kbd>) and the number of columns
(<kbd>size2</kbd>).
</p>
<p>Then, for all pooling protocols, the true group responses are found
from the individual responses within groups or within rows/columns for
matrix pooling (i.e., if at least one response is positive, the group is
positive; otherwise, the group response is negative).
Finally, the observed group (<kbd>method = "sp"</kbd>) and subgroup
<kbd>method = "halving"</kbd> only), or row and column responses
<kbd>method = "array"</kbd> are simulated using the given <kbd>sens</kbd> and
<kbd>spec</kbd>.
</p>
<p>For the simple pooling and halving protocols, individual retests are
simulated from <kbd>sens.ind</kbd> and <kbd>spec.ind</kbd> for samples in observed
positive groups. Note that with a given group size (specified by <kbd>size2</kbd>
with <kbd>method = "sp"</kbd> or <kbd>method = "halving"</kbd>), the last group may
have fewer individuals.
For the matrix pooling protocol, individual retests are simulated from
<kbd>sens.ind</kbd> and <kbd>spec.ind</kbd> for individuals that lie on the
intersection of an observed positive row and and observed positive column.
In the case where no column (row) tests positive in a matrix, all the
individuals in any observed positive rows (columns) will be assigned a
simulated retest result. If no column or row is observed positive, NULL is
returned.
</p>


<h3>Value</h3>

<p>For simple pooling (<kbd>type = "sp"</kbd>) and the halving
protocol (<kbd>type = "halving"</kbd>), a data frame or for array
testing (<kbd>type = "array"</kbd>), a list, which may include the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gres</code></td>
<td>
<p>the group response, for simple pooling and the halving
protocol only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.resp</code></td>
<td>
<p>the column group response, for array testing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.resp</code></td>
<td>
<p>the row group response, for array testing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupn</code></td>
<td>
<p>the group number, for simple pooling and the halving
protocol only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrayn</code></td>
<td>
<p>the array number, for array testing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coln</code></td>
<td>
<p>the column group number, for array testing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rown</code></td>
<td>
<p>the row group number, for array testing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>the true individual responses. For simple pooling and the
halving protocol, these are included in the data frame of results.
For array testing, these are included in the list of results, with
individual responses presented in matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retest</code></td>
<td>
<p>the results of individual retests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup</code></td>
<td>
<p>the subgroup number, for the halving protocol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the individual probabilities, for array testing only.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This function is a combination of <kbd>sim.gt</kbd>, <kbd>sim.halving</kbd>,
and <kbd>sim.mp</kbd> written by Boan Zhang for the <code>binGroup</code> package.
Minor modifications have been made for inclusion of the functions in the
<code>binGroup2</code> package.
</p>


<h3>See Also</h3>

<p><code>gtReg</code> to fit simulated group testing data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(46)
gt.data &lt;- gtSim(type = "sp", par = c(-12, 0.2),
                 size1 = 700, size2 = 5)

x1 &lt;- sort(runif(100, 0, 30))
x2 &lt;- rgamma(100, shape = 17, scale = 1.5)
gt.data &lt;- gtSim(type = "sp", x = cbind(x1, x2),
                 par = c(-14, 0.2, 0.3), size2 = 4,
                 sens = 0.98, spec = 0.98)

set.seed(46)
gt.data &lt;- gtSim(type = "halving", par = c(-6, 0.1),
                 gshape = 17, gscale = 1.4, size1 = 5000,
                 size2 = 5, sens = 0.95, spec = 0.95)

# 5x6 and 4x5 matrix
set.seed(9128)
sa1a &lt;- gtSim(type = "array", par = c(-7, 0.1),
              size1 = c(5, 4), size2 = c(6, 5),
              sens = 0.95, spec = 0.95)
sa1a$dframe
</code></pre>


</div>