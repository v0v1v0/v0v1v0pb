<div class="container">

<table style="width: 100%;"><tr>
<td>allocationSamplerBinMix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The allocation sampler algorithm.
</h2>

<h3>Description</h3>

<p>This function implements the collapsed allocation sampler of Nobile and Fearnside (2007) at the context of mixtures of multivariate Bernoulli distributions. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">allocationSamplerBinMix(Kmax, alpha, beta, gamma, m, burn, data, 
thinning, z.true, ClusterPrior, ejectionAlpha, Kstart, outputDir, 
metropolisMoves, reorderModels, heat, zStart, LS, rsX, originalX, printProgress)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Kmax</code></td>
<td>

<p>Maximum number of clusters (integer, at least equal to two).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>First shape parameter of the Beta prior distribution (strictly positive). Defaults to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>Second shape parameter of the Beta prior distribution (strictly positive).  Defaults to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p><code>Kmax</code>-dimensional vector (positive) corresponding to the parameters of the Dirichlet prior of the mixture weights. Default value: <code>rep(1,Kmax)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>Number of MCMC iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>The number of initial MCMC iterations that will be discarded as burn-in period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Binary data array (NAs not allowed here).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>

<p>Integer that defines a thinning of the reported MCMC sample. Under the default setting, every 5th MCMC iteration is saved.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.true</code></td>
<td>

<p>An optional vector of cluster assignments considered as the ground-truth clustering of the observations. Useful for simulations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterPrior</code></td>
<td>

<p>Character string specifying the prior distribution of the number of clusters on the set <code class="reqn">\{1,\ldots,K_{max}\}</code>. Available options: <code>poisson</code> or <code>uniform</code>. It defaults to the truncated Poisson distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ejectionAlpha</code></td>
<td>

<p>Probability of ejecting an empty component. Defaults to 0.2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kstart</code></td>
<td>

<p>Initial value for the number of clusters. Defaults to 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputDir</code></td>
<td>

<p>The name of the produced output folder. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metropolisMoves</code></td>
<td>

<p>A vector of character strings with possible values <code>M1</code>, <code>M2</code>, <code>M3</code>, <code>M4</code>. Each entry specifies Metropolis-Hastings type moves on the latent allocation variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorderModels</code></td>
<td>

<p>Character string specifying whether to post-process the MCMC sample of each distinct generated value of <code>K</code>. The default setting is <code>onlyMAP</code> and in this case only the part of the MCMC sample that corresponds to the most probable number of clusters is reordered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heat</code></td>
<td>

<p>The temperature of the simulated chain, that is, a scalar in the set <code class="reqn">(0,1]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zStart</code></td>
<td>

<p><code class="reqn">n</code>-dimensional integer vector of latent allocations to initialize the sampler.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LS</code></td>
<td>

<p>Boolean indicating whether to post-process the MCMC sample using the label switching algorithms.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsX</code></td>
<td>

<p>Optional vector containing the row-sums of the observed data (NAs are allowed). It is required only in the case of missing values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>originalX</code></td>
<td>

<p>Optional array containing the observed data (containing NAs). It is required only in the case of missing values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>

<p>Logical, indicating whether to print the progress of the sampler or not. Default: FALSE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output is reordered according to the following label-switching solving algorithms: ECR, ECR-ITERATIVE-1 and STEPHENS. In most cases the results of these different algorithms are identical. 
</p>


<h3>Note</h3>

<p>This function is recursively called inside the <code>coupledMetropolis</code> function. There is no need to call it separately. 
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>References</h3>

<p>Nobile A and Fearnside A (2007): Bayesian finite mixtures with an unknown number of components: The allocation sampler. Statistics and Computing, 17(2): 147-162.
</p>
<p>Papastamoulis P. and Iliopoulos G. (2010). An artificial allocations based solution to the label switching problem in Bayesian analysis of mixtures of distributions. Journal of Computational and Graphical Statistics, 19: 313-331.
</p>
<p>Papastamoulis P. and Iliopoulos G. (2013). On the convergence rate of Random Permutation Sampler and ECR algorithm in missing data models. Methodology and Computing in Applied Probability, 15(2): 293-304.
</p>
<p>Papastamoulis P. (2014). Handling the label switching problem in latent class models via the ECR algorithm. Communications in Statistics, Simulation and Computation, 43(4): 913-927.
</p>
<p>Papastamoulis P (2016): label.switching: An R package for dealing with the label switching problem in MCMC outputs. Journal of Statistical Software, 69(1): 1-24.
</p>


<h3>See Also</h3>

<p><code>coupledMetropolis</code>
</p>


</div>