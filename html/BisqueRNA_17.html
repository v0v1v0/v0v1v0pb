<div class="container">

<table style="width: 100%;"><tr>
<td>SeuratToExpressionSet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Converts Seurat object to Expression Set</h2>

<h3>Description</h3>

<p>'SeuratToExpressionSet()' returns an Expression Set with phenotype data
indicating cell type (cellType) and individual (SubjectName) for each cell
in a Seurat object. Raw counts data is used for assay data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SeuratToExpressionSet(
  seurat.object,
  delimiter,
  position,
  version = c("v2", "v3")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seurat.object</code></td>
<td>
<p>Seurat object with attributes <em>raw.data</em>,
<em>ident</em>, and <em>cell.names</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delimiter</code></td>
<td>
<p>Character to split cell names with to find individual ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>
<p>Integer indicating 1-indexed position of individual ID after
splitting cell name with <em>delimiter</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>Character string. Either "v2" or "v3. Seurat version used to
create Seurat object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the <em>Seurat</em> and <em>Biobase</em> libraries should be attached
before running this function. The <em>delimiter</em> and <em>position</em> 
arguments are used to infer the individual ID from the cell ID. For example,
a delimiter of "-" and position of "2" indicates that the individual ID for
the cell ID <strong>ACTG-2</strong> would be <strong>2</strong>.
</p>


<h3>Value</h3>

<p>sc.eset Expression set containing relevant phenotype and individual
data, <em>cellType</em> and <em>SubjectName</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  library(Seurat)
  library(Biobase)

  # We make a class to emulate a Seurat v2 object for illustration only
  setClass("testSeuratv2", representation(cell.names = "character",
                                          ident = "character",
                                          raw.data = "matrix"))
  sc.counts &lt;- matrix(0,nrow=3,ncol=3)
  # These barcodes correspond to a delimiter of "-" and position 2 for individual id.
  test.cell.names &lt;- c("ATCG-1", "TAGC-2", "GTCA-3")
  test.ident &lt;- c("cell type a", "cell type b", "cell type c")
  names(test.ident) &lt;- test.cell.names
  colnames(sc.counts) &lt;- test.cell.names
  test.seurat.obj &lt;- new("testSeuratv2",
                         cell.names=test.cell.names,
                         ident=test.ident,
                         raw.data=sc.counts)

  single.cell.expression.set &lt;- SeuratToExpressionSet(test.seurat.obj, delimiter='-',
                                                      position=2, version="v2")


</code></pre>


</div>