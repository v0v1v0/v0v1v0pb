<div class="container">

<table style="width: 100%;"><tr>
<td>custom.baseline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Customized baseline correction
</h2>

<h3>Description</h3>

<p>This function rescales spectrum abscissa by use of <code>breaks</code> and
<code>gaps</code> before baseline correction. The effect is that the
chosen baseline correction algorithm and paramters will have varying
effects along the spectra, effectively giving local control of the amount
of rigidity/flexibility of the estimated baseline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">custom.baseline(spectra, breaks, gaps, trans.win = NULL, just.plot = FALSE, method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>

<p>Matrix with spectra in rows.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>Vector of locations of break points between sections of varying
baseline flexibility (given as abscissa numbers).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gaps</code></td>
<td>

<p>Vector giving the abscissa spacing between each instance of
<code>breaks</code> (and endpoints if not specified in <code>breaks</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans.win</code></td>
<td>

<p>Optional width of transition window around break points used
for smoothing rough breaks by LOWESS (default = NULL).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>just.plot</code></td>
<td>

<p>Plot the rescaled spectra instead of applying the customized
baseline correction if <code>just.plot</code>=TRUE (default = FALSE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Baseline correction method to use (class character).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional named arguments to be passed to the baseline correction method.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the customized baseline correction suggested
by Liland et al. 2011 for local changes in baseline flexibility.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>baseline </code></td>
<td>
<p>Estimated custom baselines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected </code></td>
<td>
<p>Spectra corrected by custom baselines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectra.scaled </code></td>
<td>
<p>Re-scaled spectra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline.scaled </code></td>
<td>
<p>Estimated baselines of re-scaled spectra.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Kristian Hovde Liland and Bj√∏rn-Helge Mevik </p>


<h3>References</h3>

<p> Kristian Hovde Liland et al.:
Customized baseline correction
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(milk)
spectrum1  &lt;- milk$spectra[1,1:10000,drop=FALSE]
ordinary   &lt;- baseline(spectrum1, method="als", lambda=6, p=0.01)
customized &lt;- custom.baseline(spectrum1, 2900, c(1,20), trans.win=100, 
	just.plot=FALSE, method="als", lambda=6, p=0.01)
## Not run: 
plot(1:10000,spectrum1, type='l')
lines(1:10000,getBaseline(ordinary), lty=2, col=2, lwd=2)
lines(1:10000,customized$baseline, lty=3, col=3, lwd=2)

## End(Not run)
</code></pre>


</div>