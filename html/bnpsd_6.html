<div class="container">

<table style="width: 100%;"><tr>
<td>coanc_admix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct the coancestry matrix of an admixture model</h2>

<h3>Description</h3>

<p>The <code>n</code>-by-<code>n</code> coancestry matrix <code>Theta</code> of admixed individuals is determined by the <code>n</code>-by-<code>k</code> admixture proportion matrix <code>Q</code> and the <code>k</code>-by-<code>k</code> intermediate subpopulation coancestry matrix <code>Psi</code>, given by <code>Theta = Q %*% Psi %*% t(Q)</code>.
In the more restricted BN-PSD model, <code>Psi</code> is a diagonal matrix (with FST values for the intermediate subpopulations along the diagonal, zero values off-diagonal).
</p>


<h3>Usage</h3>

<pre><code class="language-R">coanc_admix(admix_proportions, coanc_subpops)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>admix_proportions</code></td>
<td>
<p>The <code>n</code>-by-<code>k</code> admixture proportion matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coanc_subpops</code></td>
<td>
<p>The intermediate subpopulation coancestry, given either as a <code>k</code>-by-<code>k</code> matrix (for the complete admixture model), or the length-<code>k</code> vector of intermediate subpopulation FST values (for the BN-PSD model; implies zero coancestry between subpopulations), or a scalar FST value shared by all intermediate subpopulations (also implies zero coancestry between subpopulations).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As a precaution, function stops if both inputs have names and the column names of <code>admix_proportions</code> and the names in <code>coanc_subpops</code> disagree, which might be because these two matrices are not aligned or there is some other inconsistency.
</p>


<h3>Value</h3>

<p>The <code>n</code>-by-<code>n</code> coancestry matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a trivial case: unadmixed individuals from independent subpopulations
# number of individuals and subpops
n_ind &lt;- 5
# unadmixed individuals
admix_proportions &lt;- diag(rep.int(1, n_ind))
# equal Fst for all subpops
coanc_subpops &lt;- 0.2
# diagonal coancestry matryx
coancestry &lt;- coanc_admix(admix_proportions, coanc_subpops)

# a more complicated admixture model
# number of individuals
n_ind &lt;- 5
# number of intermediate subpops
k_subpops &lt;- 2
# non-trivial admixture proportions
admix_proportions &lt;- admix_prop_1d_linear(n_ind, k_subpops, sigma = 1)
# different Fst for each of the k_subpops
coanc_subpops &lt;- c(0.1, 0.3)
# non-trivial coancestry matrix
coancestry &lt;- coanc_admix(admix_proportions, coanc_subpops)

</code></pre>


</div>