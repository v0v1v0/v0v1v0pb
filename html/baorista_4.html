<div class="container">

<table style="width: 100%;"><tr>
<td>icarfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a random walk ICAR model to Aoristic data</h2>

<h3>Description</h3>

<p>Estimates parameters of a multinomial probability distribution that describes the shape of the of the time-frequency distribution of an observed sets of events with chronological uncertainty. The function is wrapper for fitting a 1D random walk ICAR model via nimble.
</p>


<h3>Usage</h3>

<pre><code class="language-R">icarfit(
  x,
  niter = 1e+05,
  nburnin = 50000,
  thin = 10,
  nchains = 4,
  sigmaPrior = "dexp(rate=1)",
  sigmaSampler = NULL,
  parallel = FALSE,
  seeds = 1:4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A ProbMat class object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of MCMC iterations. Default is 500,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburnin</code></td>
<td>
<p>Number of iterations discarded for burn-in. Default is 250,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nchains</code></td>
<td>
<p>Number of MCMC chains</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaPrior</code></td>
<td>
<p>A string defining prior for the sigma parameter. Default is 'dexp(rate=1)'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaSampler</code></td>
<td>
<p>A list containing settings for the MCMC sampler. Default is null and employs nimble's Default sampler (RW sampler).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical specifying whether the chains should be run in parallel or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seeds</code></td>
<td>
<p>Random seed for each chain. Default is 1:4.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function estimates a vector temporally autocorrelated  probability values on the observed data using MCMC as implemented by the nimble package. The model is effectively non-parametric, and at its core it is an implementation of a 1D random ICAR model. Users can specify the prior for the variance parameter through the argument <code>sigmaPrior</code>. Different settings for this parameter can greatly influence the estimates of the probability vectors. For example using <code>sigmaPrior=dexp(100)</code> instead of the default <code>sigmaPrior=dexp(1)</code> would lead to 'flatter' time-series with higher temporal autocorrelation. The distribution parameters defined in <code>sigmaPrior</code> is also used to generate initialisation values for the MCMC. Please consult the nimble package manual for the syntax required in specifying the prior. MCMC settings such as the choice the sampler, number of iterations, chains, etc can also be specified. Please not that the function is computationally intensive and might require a larger number of iterations to reach satisfactory MCMC convergence.
</p>


<h3>Value</h3>

<p>A <code>fittedICAR</code> class object containing the original ProbMat class object, posteriors of the probabilities for each time-block and the variance parameter along with their MCMC diagnostics (Gelman Rubin statistic and effective sample size).
</p>


</div>