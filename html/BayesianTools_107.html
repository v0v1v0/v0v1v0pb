<div class="container">

<table style="width: 100%;"><tr>
<td>WAIC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>calculates the WAIC</h2>

<h3>Description</h3>

<p>calculates the WAIC
</p>


<h3>Usage</h3>

<pre><code class="language-R">WAIC(bayesianOutput, numSamples = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bayesianOutput</code></td>
<td>
<p>an object of class BayesianOutput. Must implement a log-likelihood density function that can return point-wise log-likelihood values ("sum" argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numSamples</code></td>
<td>
<p>the number of samples to calculate the WAIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional values to be passed on the the getSample function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The WAIC is constructed as
</p>
<p style="text-align: center;"><code class="reqn">WAIC = -2 * (lppd - p_{WAIC})</code>
</p>

<p>The lppd (log pointwise predictive density), defined in Gelman et al., 2013, eq. 4 as
</p>
<p style="text-align: center;"><code class="reqn">lppd = \sum_{i=1}^n \log \left(\frac{1}{S} \sum_{s=1}^S p(y_i | \theta^s)\right)</code>
</p>

<p>The value of <code class="reqn">p_WAIC</code> can be calculated in two ways, the method used is determined by the
<code>method</code> argument.
</p>
<p>Method 1 is defined as,
</p>
<p style="text-align: center;"><code class="reqn">p_{WAIC1} = 2 \sum_{i=1}^{n} (\log (\frac{1}{S} \sum_{s=1}^{S} p(y_i \ \theta^s)) - \frac{1}{S} \sum_{s = 1}^{S} \log p(y_i | \theta^s))</code>
</p>

<p>Method 2 is defined as,
</p>
<p style="text-align: center;"><code class="reqn">p_{WAIC2} = 2 \sum_{i=1}^{n} V_{s=1}^{S} (\log p(y_i | \theta^s))</code>
</p>

<p>where  <code class="reqn">V_{s=1}^{S}</code> is the sample variance.
</p>


<h3>Note</h3>

<p>The function requires that the likelihood passed on to BayesianSetup contains the option sum = T/F, with defaul F. If set to true, the likelihood for each data point must be returned.
</p>


<h3>Author(s)</h3>

<p>Florian Hartig
</p>


<h3>References</h3>

<p>Gelman, Andrew and Jessica Hwang and Aki Vehtari (2013), "Understanding Predictive Information Criteria for Bayesian Models," <a href="http://www.stat.columbia.edu/~gelman/research/unpublished/waic_understand_final.pdf">http://www.stat.columbia.edu/~gelman/research/unpublished/waic_understand_final.pdf</a>.
</p>
<p>Watanabe, S. (2010). "Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular Learning Theory", Journal of Machine Learning Research, <a href="https://www.jmlr.org/papers/v11/watanabe10a.html">https://www.jmlr.org/papers/v11/watanabe10a.html</a>.
</p>


<h3>See Also</h3>

<p><code>DIC</code>, <code>MAP</code>, <code>marginalLikelihood</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">bayesianSetup &lt;- createBayesianSetup(likelihood = testDensityNormal, 
                                     prior = createUniformPrior(lower = rep(-10,2),
                                                                upper = rep(10,2)))

# likelihood density needs to have option sum = FALSE

testDensityNormal(c(1,1,1), sum = FALSE)
bayesianSetup$likelihood$density(c(1,1,1), sum = FALSE)
bayesianSetup$likelihood$density(matrix(rep(1,9), ncol = 3), sum = FALSE)

# running MCMC

out = runMCMC(bayesianSetup = bayesianSetup)

WAIC(out)
</code></pre>


</div>