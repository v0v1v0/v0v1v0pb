<div class="container">

<table style="width: 100%;"><tr>
<td>plot_bunching</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bunching Plot</h2>

<h3>Description</h3>

<p>Creates the bunching plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_bunching(
  z_vector,
  binned_data,
  cf,
  zstar,
  binwidth,
  bins_excl_l = 0,
  bins_excl_r = 0,
  p_title = "",
  p_xtitle = deparse(substitute(z_vector)),
  p_ytitle = "Count",
  p_miny = 0,
  p_maxy = NA,
  p_ybreaks = NA,
  p_title_size = 11,
  p_axis_title_size = 10,
  p_axis_val_size = 8.5,
  p_freq_color = "black",
  p_cf_color = "maroon",
  p_zstar_color = "red",
  p_grid_major_y_color = "lightgrey",
  p_freq_size = 0.5,
  p_freq_msize = 1,
  p_cf_size = 0.5,
  p_zstar_size = 0.5,
  p_b = FALSE,
  b = NA,
  b_sd = NA,
  p_e = FALSE,
  e = NA,
  e_sd = NA,
  p_b_e_xpos = NA,
  p_b_e_ypos = NA,
  p_b_e_size = 3,
  t0 = NA,
  t1 = NA,
  notch = FALSE,
  p_domregion_color = NA,
  p_domregion_ltype = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z_vector</code></td>
<td>
<p>a numeric vector of (unbinned) data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binned_data</code></td>
<td>
<p>binned data with frequency and estimated counterfactual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cf</code></td>
<td>
<p>the counterfactual to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zstar</code></td>
<td>
<p>a numeric value for the the bunching point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>a numeric value for the width of each bin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins_excl_l</code></td>
<td>
<p>number of bins to left of zstar to include in bunching region. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins_excl_r</code></td>
<td>
<p>number of bins to right of zstar to include in bunching region. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_title</code></td>
<td>
<p>plot's title. Default is empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_xtitle</code></td>
<td>
<p>plot's x_axis label. Default is the name of z_vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_ytitle</code></td>
<td>
<p>plot's y_axis label. Default is "Count".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_miny</code></td>
<td>
<p>plot's minimum y_axis value. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_maxy</code></td>
<td>
<p>plot's maximum y_axis value. Default is optimized internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_ybreaks</code></td>
<td>
<p>a numeric vector of y-axis values at which to add horizontal line markers in plot. Default is optimized internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_title_size</code></td>
<td>
<p>size of plot's title. Default is 11.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_axis_title_size</code></td>
<td>
<p>size of plot's axes' title labels. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_axis_val_size</code></td>
<td>
<p>size of plot's axes' numeric labels. Default is 8.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_freq_color</code></td>
<td>
<p>plot's frequency line color. Default is "black".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_cf_color</code></td>
<td>
<p>plot's counterfactual line color. Default is "maroon".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_zstar_color</code></td>
<td>
<p>plot's bunching region marker lines color. Default is "red".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_grid_major_y_color</code></td>
<td>
<p>plot's y-axis major grid line color. Default is "lightgrey".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_freq_size</code></td>
<td>
<p>plot's frequency line thickness. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_freq_msize</code></td>
<td>
<p>plot's frequency line marker size. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_cf_size</code></td>
<td>
<p>plot's counterfactual line thickness. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_zstar_size</code></td>
<td>
<p>plot's bunching region marker line thickness. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_b</code></td>
<td>
<p>whether plot should also include the bunching estimate. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>normalized bunching estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_sd</code></td>
<td>
<p>standard deviation of the normalized bunching estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_e</code></td>
<td>
<p>whether plot should also include the elasticity estimate. Only shown if p_b is TRUE. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>elasticity estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_sd</code></td>
<td>
<p>standard deviation of the elasticity estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_b_e_xpos</code></td>
<td>
<p>plot's x-axis coordinate of bunching/elasticity estimate. Default is set internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_b_e_ypos</code></td>
<td>
<p>plot's y-axis coordinate of bunching/elasticity estimate. Default is set internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_b_e_size</code></td>
<td>
<p>size of plot's printed bunching/elasticity estimate. Default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>numeric value setting the marginal (average) tax rate below zstar in a kink (notch) setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>numeric value setting the marginal (average) tax rate above zstar in a kink (notch) setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notch</code></td>
<td>
<p>whether analysis is for a kink or notch. Default is FALSE (kink).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_domregion_color</code></td>
<td>
<p>plot's dominated region marker line color in notch setting. Default is "blue".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_domregion_ltype</code></td>
<td>
<p>line type for the vertical line type marking the dominated region (zD) in the plot for notch settings. Default is "longdash".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>plot_bunching</code> returns a plot with the frequency, counterfactual and bunching region demarcated. Can also include the bunching and elasticity estimate if specified.
</p>


<h3>See Also</h3>

<p><code>bunchit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bunching_data)
binned_data &lt;- bin_data(z_vector = bunching_data$kink, zstar = 10000,
                        binwidth = 50, bins_l = 20, bins_r = 20)
prepped_data &lt;- prep_data_for_fit(binned_data, zstar = 10000, binwidth = 50,
                                  bins_l = 20, bins_r = 20, poly = 4)
fitted &lt;- fit_bunching(thedata = prepped_data$data_binned,
                       themodelformula = prepped_data$model_formula,
                       binwidth = 50)
plot_bunching(z_vector = bunching_data$kink_vector,
              binned_data = prepped_data$data_binned,
              cf = fitted$cf_density, zstar = 10000,
              binwidth = 50, bins_excl_l = 0 , bins_excl_r = 0,
              b = 1.989, b_sd = 0.005, p_b = TRUE)
</code></pre>


</div>