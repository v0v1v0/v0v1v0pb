<div class="container">

<table style="width: 100%;"><tr>
<td>eMixMargDen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Marginal Densities of A Normal Mixture Averaged over MCMC Draws</h2>

<h3>Description</h3>

<p><code>eMixMargDen</code> assumes that a multivariate mixture of normals has been fitted
via MCMC (using <code>rnmixGibbs</code>). For each MCMC draw, <code>eMixMargDen</code> computes 
the marginal densities for each component in the multivariate mixture on a user-supplied
grid and then averages over the MCMC draws. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">eMixMargDen(grid, probdraw, compdraw)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p> array of grid points, <code>grid[,i]</code> are ordinates for <code>i</code>th dimension of the density </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probdraw</code></td>
<td>
<p> array where each row contains a draw of probabilities of the mixture component </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compdraw</code></td>
<td>
<p> list of lists of draws of mixture component moments </p>
</td>
</tr>
</table>
<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
    <code>length(compdraw)        </code>  </td>
<td style="text-align: left;"> is the number of MCMC draws. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>compdraw[[i]]           </code>  </td>
<td style="text-align: left;"> is a list draws of mu and of the inverse Cholesky root for each of mixture components. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>compdraw[[i]][[j]]      </code>  </td>
<td style="text-align: left;"> is <code>j</code>th component. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>compdraw[[i]][[j]]$mu   </code>  </td>
<td style="text-align: left;"> is mean vector. </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>compdraw[[i]][[j]]$rooti</code> </td>
<td style="text-align: left;"> is the UL decomp of <code class="reqn">\Sigma^{-1}</code>.
  </td>
</tr>
</table>
<h3>Value</h3>

<p>An array of the same dimension as <code>grid</code> with density values.</p>


<h3>Warning</h3>

<p>This routine is a utility routine that does <strong>not</strong> check the input arguments for proper dimensions and type. To avoid errors, call with output from <code>rnmixGibbs</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p> For further discussion, see <em>Bayesian Statistics and Marketing</em>by Rossi, Allenby, and McCulloch. </p>


<h3>See Also</h3>

<p><code>rnmixGibbs</code></p>


</div>