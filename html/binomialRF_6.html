<div class="container">

<table style="width: 100%;"><tr>
<td>k_binomialRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>random forest feature selection based on binomial exact test</h2>

<h3>Description</h3>

<p><code>k_binomialRF</code> is the R implementation of the interaction feature selection algorithm by (Zaim 2019). <code>k_binomialRF</code> extends the <code>binomialRF</code> algorithm by searching for k-way interactions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">k_binomialRF(X, y, fdr.threshold = 0.05, fdr.method = "BY",
  ntrees = 2000, percent_features = 0.3, K = 2, cbinom_dist = NULL,
  sampsize = nrow(X) * 0.4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>class label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.threshold</code></td>
<td>
<p>fdr.threshold for determining which set of features are significant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.method</code></td>
<td>
<p>how should we adjust for multiple comparisons (i.e., <code>p.adjust.methods</code> =c("holm", "hochberg", "hommel", "bonferroni", "BH", "BY","fdr", "none"))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntrees</code></td>
<td>
<p>how many trees should be used to grow the <code>randomForest</code>? (Defaults to 5000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent_features</code></td>
<td>
<p>what percentage of L do we subsample at each tree? Should be a proportion between (0,1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>for multi-way interactions, how deep should the interactions be?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cbinom_dist</code></td>
<td>
<p>user-supplied correlated binomial distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsize</code></td>
<td>
<p>user-supplied sample size for random forest</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data.frame with 4 columns: Feature Name, Frequency Selected, Probability of Selecting it randomly, Adjusted P-value based on <code>fdr.method</code>
</p>


<h3>References</h3>

<p>Zaim, SZ; Kenost, C.; Lussier, YA; Zhang, HH. binomialRF: Scalable Feature Selection and Screening for Random Forests to Identify Biomarkers and Their Interactions, bioRxiv, 2019.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(324)

###############################
### Generate simulation data
###############################

X = matrix(rnorm(1000), ncol=10)
trueBeta= c(rep(10,5), rep(0,5))
z = 1 + X %*% trueBeta
pr = 1/(1+exp(-z))
y = rbinom(100,1,pr)

###############################
### Run interaction model
###############################

require(correlbinom)

rho = 0.33
ntrees = 250
cbinom = correlbinom(rho, successprob =  calculateBinomialP_Interaction(10, .5,2), 
                               trials = ntrees, precision = 1024, model = 'kuk')

k.binom.rf &lt;-k_binomialRF(X,y, fdr.threshold = .05,fdr.method = 'BY',
                      ntrees = ntrees,percent_features = .5,
                      cbinom_dist=cbinom,
                      sampsize=round(nrow(X)*rho))




</code></pre>


</div>