<div class="container">

<table style="width: 100%;"><tr>
<td>simdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>simdata</h2>

<h3>Description</h3>

<p>A function for simulating data under various topologies for continuous and
mixed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simdata(
  graph = "gn4",
  N = 500,
  b0 = 0,
  ss = 1,
  s = 1,
  p = 0.6,
  q = 0.45,
  ssc = 0.2,
  nConfounding = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>A character string of the graph for which data will be
simulated. The graphs that can be chosen are m1_ge, m1_gv, m1_cp, m1_cc,
m1_iv, m2_ge, m2_gv, m2_cp, m2_cc, m2_iv, m3_gv, m3_cp, m3_cc, m3_iv, mp_ge,
mp_gv, gn4, gn5, gn8, gn11, layer, layer_cp, layer_iv, and star.
</p>
<p>The following figures show the graph for each of the topologies listed above.
The nodes with a circle around the name are normally distributed and the
nodes with a diamond around the name are distributed multinomial. The nodes
labeled with a C represent confounding variables. The Principle of Mendelian
Randomization (PMR) can be used on graphs with discrete and continuous
random variables. This introduces the constraint that the continuous random
variables cannot be parents of discrete random variables and edges between
these types of variables only have two states: absent and directed with the
discrete random variable as the parent.
</p>
<p>m1_ge - Topology M1 with three continuous random variables. In this case M1
has two other Markov equivalent graphs.
</p>
<p>m1_gv - Topology M1 with one discrete random variable U and two continuous
random variables. When using the PMR this graph does not have any other
Markov equivalent graphs.
</p>
<p>We consider three types of confounding variables (Yang et al., 2017):
</p>
<p>m1_cp - Topology M1 with n common parent confounding variables.
</p>
<p>m1_cc - Topology M1 with n common child confounding variables.
</p>
<p>m1_iv - Topology M1 with n intermediate confounding variables.
</p>
<p><img src="../help/figures/m1.png" width="75%" alt="Figure: m1.png"></p>
<p>m2_ge - Topology M2 with three continuous random variables. This graph is a v
structure and does not have any other Markov equivalent graphs.
</p>
<p>m2_gv - Topolog M2 with one discrete random variable U and two continuous
random variables. This graph is a v structure and does not have any other
Markov equivalent graphs.
</p>
<p>m2_cp - Topology M2 with n common parent confounding variables.
</p>
<p>m2_cc - Topology M2 with n common child confounding variables.
</p>
<p>m2_iv - Topology M2 with n intermediate confounding variables.
</p>
<p><img src="../help/figures/m2.png" width="75%" alt="Figure: m2.png"></p>
<p>m3_gv - Topolog M3 with one discrete random variable U and two continuous
random variables.
</p>
<p>m3_cp - Topology M3 with n common parent confounding variables.
</p>
<p>m3_cc - Topology M3 with n common child confounding variables.
</p>
<p>m3_iv - Topology M3 with n intermediate confounding variables.
</p>
<p><img src="../help/figures/m3.png" width="75%" alt="Figure: m3.png"></p>
<p>mp_ge - The multi-parent topology with continuous random variables. This
graph is made up of multiple v structures and has no other Markov equivalent
graphs.
</p>
<p>mp_gv - The multi-parent topology with one discrete random variable. This
graph is made up of multiple v structures and has no other Markov equivalent
graphs.
</p>
<p><img src="../help/figures/mp.png" width="55%" alt="Figure: mp.png"></p>
<p>gn4 - Topology GN4 is formed by combining topologies M1 and M2. The Markov
equivalence class for this topology is made up of three different graphs.
</p>
<p>gn5 - Topology GN5 has three other Markov equivalent graphs.
</p>
<p>gn8 - Topology GN8 has three overlapping cycles, two v structures, and two
other Markov equivalent graphs.
</p>
<p>gn11 - Topology GN11 has two sub-graphs separated by a v structure at node
T6.
</p>
<p><img src="../help/figures/gn.png" width="55%" alt="Figure: gn.png"></p>
<p>layer - The layer topology has no other Markov equivalent graphs when using
the PMR and is made up of multiple M1 topologies.
</p>
<p>layer_cp - The layer topology with 2 common parent confounding variables.
</p>
<p>layer_iv - The layer topology with 2 intermediate confounding variables.
</p>
<p><img src="../help/figures/layer.png" width="75%" alt="Figure: layer.png"></p>
<p>star - The star topology has no other Markov equivalent graphs when using the
PMR and is made up of multiple M1 topologies.
</p>
<p><img src="../help/figures/star.png" width="25%" alt="Figure: star.png"></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of observations to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The mean of the variable if it does not have any parents. If the
variable has one or more parents it is the slope in the linear model that is
the mean of the normally distributed variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>The coefficient of the parent nodes (if there are any) in the
linear model that is the mean of the normally distributed variables. This
coefficient is referred to as the signal strength.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The standard deviation of the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The probability of success for a binomial random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The frequency of the reference allele.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssc</code></td>
<td>
<p>The signal strength of the confounding variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nConfounding</code></td>
<td>
<p>The number of confounding variables to simulate.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with the variables across the columns and the observations
down the rows.
</p>


<h3>References</h3>

<p>Yang, F., Wang, J., The GTEx Consortium, Pierce, B. L., and
Chen, L. S. (2017).
Identifying cis-mediators for trans-eQTLs across many human tissues using
genomic mediation analysis. <em>Genome Res.</em> 27, 1859-1871.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data under topology GN4.
data_gn4 &lt;- simdata(graph = 'gn4',
                    N = 500,
                    b0 = 1,
                    ss = 1,
                    s = 1)

# Display the first few rows of the data.
data_gn4[1:5, ]

# Generate data under topology M1 with 3 intermediate confounding variables.
data_m1_iv &lt;- simdata(graph = 'm1_iv',
                      N = 500,
                      b0 = 0,
                      ss = 1,
                      s = 1,
                      q = 0.1,
                      ssc = 0.2,
                      nConfounding = 3)

# Show the first few rows of the data.
data_m1_iv[1:5, ]

</code></pre>


</div>