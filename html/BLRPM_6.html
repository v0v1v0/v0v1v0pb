<div class="container">

<table style="width: 100%;"><tr>
<td>BLRPM.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BLRPM Parameter Estimation function</h2>

<h3>Description</h3>

<p><code>BLRPM.est</code> estimates the five Bartlett-Lewis rectangular pulse model parameters <code>lambda,gamma,beta,eta,mux</code>
for a given time series <code>data</code>. At first the time series statistics at given accumulation levels <code>acc.vals</code>
are calculated. These statistics are given over to the parameter estimation algorithm together with 
parameter starting values <code>par</code>. An objective function <code>O.Fun</code> can be specified, default is <code>BLRPM.OF</code>.
In addition the weights for different statistics and accumulation levels <code>weights.mean, weights.var, weights.cov, weights.pz</code>
can be specified. For the BLRPM objective function the user can select the measure of distance between observation
and model with <code>OF</code>: =1 quadratic, =2: quad extended, =3: absolute, =4: abs extended.
A <code>scale</code> parameter controls different cases in the objective function for differences in the scale of duration
parameters gamma and eta.   
If a debugging is wished, <code>debug</code> can be set to <code>TRUE</code> and a log file is created in working directory.
Several <code>optim</code> parameters can be also defined. For specifics see <code>?optim</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BLRPM.est(RR,acc.vals,pars.in,O.Fun,
weights.mean,weights.var,weights.cov,weights.pz,OF,debug,
scale,method,lower,upper,use.log,maxit,ndeps,trace)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p><code>vector</code> of a precipitation time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc.vals</code></td>
<td>
<p><code>vector</code> of different accumulation levels at which statistics are to be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars.in</code></td>
<td>
<p><code>vector</code> specifying starting values of <code>lambda,gamma,beta,eta,mux</code> for optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>O.Fun</code></td>
<td>
<p><code>objective function</code> to be used during optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.mean</code></td>
<td>
<p><code>value</code> for weight for mean value at first accumulation level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.var</code></td>
<td>
<p><code>vecotr</code> of weights for variances, has to have <code>length(acc.vals)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.cov</code></td>
<td>
<p><code>vecotr</code> of weights for covariances, has to have <code>length(acc.vals)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.pz</code></td>
<td>
<p><code>vecotr</code> of weights for probability of zero rainfall, has to have <code>length(acc.vals)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OF</code></td>
<td>
<p><code>value</code> specifying the type of objective function. 1: quadratic, 2: quad symmetrized, 3: absolute, 4: abs symmetrized
Note: quadratic symmetrized proofed to be most effective and fastest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>set <code>TRUE</code> if debugging is wished, default <code>FALSE</code>. Creates a log file in working directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p><code>value</code> specifying the scaling between gamma and eta in the objective function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>character</code> defining the method to be used in <code>optim</code>, preferences are: "Nelder-Mead", "BFGS", "L-BFGS-B"e</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p><code>vector</code> specifying the lower boundary of parameters for "L-BFGS-B" method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p><code>vector</code> specifying the upper boundary of parameters for "L-BFGS-B" method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.log</code></td>
<td>
<p><code>logical</code>, set <code>TRUE</code> if logarithmic parameters during optimization should be used. Advantage: zero as lower boundary for parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p><code>value</code> specifying the maximum number of itereations durion optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndeps</code></td>
<td>
<p><code>vector</code> specifying the change for each parameter during one interation step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p><code>value</code> specifying output information of <code>optim</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>$est returns <code>vector</code> of estimated parameters <code>lambda,gamma,beta,eta,mux</code>
</p>
<p>$conv returns <code>value</code> of convergence of optimization, see <code>optim</code> for details
</p>
<p>$mess returns <code>character</code> message about optimization if using "L-BFGS-B" method
</p>
<p>$Z returns <code>value</code> of objective function for estimated parameters
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">t.sim=240

lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4

pars &lt;- c(lambda,gamma,beta,eta,mux)

sim &lt;- BLRPM.sim(lambda,gamma,beta,eta,mux,t.sim)
est &lt;- BLRPM.est(sim$RR,pars.in=pars,method="BFGS",use.log=TRUE)

</code></pre>


</div>