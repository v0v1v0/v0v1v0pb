<div class="container">

<table style="width: 100%;"><tr>
<td>BIKM1_LBM_Poisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BIKM1_LBM_Poisson fitting procedure</h2>

<h3>Description</h3>

<p>Produce a blockwise estimation of a contingency matrix of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BIKM1_LBM_Poisson(x,Hmax,Lmax,a=4,alpha=1,beta=0.01,
Hstart=2,Lstart=2,normalization=FALSE,init_choice='smallVBayes',
userparam=NULL,ntry=50,criterion_choice='ICL', mc.cores=1,verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>contingency matrix of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hmax</code></td>
<td>
<p>a positive integer less than number of rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmax</code></td>
<td>
<p>a positive integer less than number of columns.The bikm1 procedure stops while the numbers of rows is higher than Hmax or the number of columns is higher than Lmax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>hyperparameter used in the VBayes algorithm for priors on the mixing proportions.
By default, a=4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>hyperparameter used in the VBayes algorithm for prior on the Poisson parameter.
By default, alpha=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>hyperparameter used in the VBayes algorithm for prior on the Poisson parameter.
By default, beta=0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hstart</code></td>
<td>
<p>a positive integer to initialize the procedure with number of row clusters.
By default, Hstart=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lstart</code></td>
<td>
<p>a positive integer to initialize the procedure with number of column clusters.
By default, Lstart=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization</code></td>
<td>
<p>logical. To use the normalized Poisson modelling in the Latent Block Model. By default normalization=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_choice</code></td>
<td>
<p>character string corresponding to the chosen initialization strategy used for the procedure, which can be "random" or "Gibbs" (higher time computation) or "smallVBayes" or "user".
By default, init_choice="smallVBayes"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userparam</code></td>
<td>
<p>In the case where init_choice is "user", a list containing partitions v and w.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntry</code></td>
<td>
<p>a positive integer corresponding to the number of times which is launched the small VBayes or random initialization strategy. By default ntry=50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion_choice</code></td>
<td>
<p>Character string corresponding to the chosen criterion used for model selection, which can be "ICL" or "BIC".
By default, criterion_choice="ICL".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>a positive integer corresponding to the available number of cores for parallel computing.
By default, mc.cores=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. To display each step and the result. By default verbose=TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a BIKM1_LBM_Poisson object including
</p>
<p><code>model_max</code>: the selected model by the procedure with free energy W, theta, conditional probabilities (r_jh, t_kl), iter, empty_cluster, and the selected partitions v and w.
</p>
<p><code>criterion_choice</code>: the chosen criterion
</p>
<p><code>init_choice</code>: the chosen init choice
</p>
<p><code>criterion tab</code>: matrix containing the criterion values for each selected number of row and column
</p>
<p><code>W_tab</code>: matrix containing the free energy values for each selected number of row and column
</p>
<p><code>criterion_max</code>: maximum of the criterion values
</p>
<p><code>hopt</code>: the selected number of rows
</p>
<p><code>lopt</code>: the selected number of columns
</p>


<h3>References</h3>

<p>Keribin, Celeux and Robert, The Latent Block Model: a useful model for high dimensional data.
https://hal.inria.fr/hal-01658589/document
</p>
<p>Govaert and Nadif. Co-clustering, Wyley (2013).
</p>
<p>Keribin, Brault and Celeux. Estimation and Selection for the Latent Block Model on Categorical Data, Statistics and Computing (2014).
</p>
<p>Robert. Classification crois\'ee pour l'analyse de bases de donn\'ees de grandes dimensions de pharmacovigilance. Paris Saclay (2017).
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(bikm1)
J=200
K=120
h=3
l=2
theta=list()
theta$rho_h=1/h *matrix(1,h,1)
theta$tau_l=1/l *matrix(1,l,1)
theta$gamma_hl=matrix(c(1, 6,4, 1, 7, 1),ncol=2)
data=PoissonBlocRnd(J,K,theta)
res=BIKM1_LBM_Poisson(data$x,3,2,Hstart=3,Lstart=2,
init_choice='user',userparam=list(v=data$xrow,w=data$xcol))

</code></pre>


</div>