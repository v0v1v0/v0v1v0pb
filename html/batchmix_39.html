<div class="container">

<table style="width: 100%;"><tr>
<td>sampleMVN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample mixture of multivariate normal distributions with batch effects</h2>

<h3>Description</h3>

<p>Performs MCMC sampling for a mixture model with batch effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleMVN(
  X,
  K,
  B,
  labels,
  batch_vec,
  mu_proposal_window,
  cov_proposal_window,
  m_proposal_window,
  S_proposal_window,
  R,
  thin,
  concentration,
  m_scale,
  rho,
  theta,
  initial_mu,
  initial_cov,
  initial_m,
  initial_S,
  mu_initialised,
  cov_initialised,
  m_initialised,
  S_initialised,
  sample_m_scale
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The data matrix to perform clustering upon (items to cluster in rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of components to model (upper limit on the number of 
clusters found).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of batches to model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Vector item labels to initialise from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_vec</code></td>
<td>
<p>Observed batch labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_proposal_window</code></td>
<td>
<p>The standard deviation for the Gaussian proposal
density of the cluster means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_proposal_window</code></td>
<td>
<p>The degrees of freedom for the Wishart proposal
density of the cluster covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_proposal_window</code></td>
<td>
<p>The standard deviation for the Gaussian proposal
density of the batch mean effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_proposal_window</code></td>
<td>
<p>The rate for the Gamma proposal density of the 
batch scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of iterations to run for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning factor for samples recorded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concentration</code></td>
<td>
<p>Vector of concentrations for mixture weights
(recommended to be symmetric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_scale</code></td>
<td>
<p>The scale hyperparameter for the batch shift prior 
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The shape of the prior distribution for the batch scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The scale of the prior distribution for the batch scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_mu</code></td>
<td>
<p>A P x K matrix of initial values for the class means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_cov</code></td>
<td>
<p>A P x P x K cube of initial values for the class 
covariance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_m</code></td>
<td>
<p>A P x B matrix of initial values for the batch shift 
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_S</code></td>
<td>
<p>A P x B matrix of initial values for the batch scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_initialised</code></td>
<td>
<p>Bool indicating if the class means are initialised by
the user. If “false“ then initial values are drawn from the prior 
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_initialised</code></td>
<td>
<p>Bool indicating if the class covariance matrices are 
initialised by the user. If “false“ then initial values are drawn from the
prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_initialised</code></td>
<td>
<p>Bool indicating if the batch shift effects are 
initialised by the user. If “false“ then initial values are drawn from the
prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_initialised</code></td>
<td>
<p>Bool indicating if the batch scales are initialised by 
the user. If “false“ then initial values are drawn from the prior 
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_m_scale</code></td>
<td>
<p>Bool indicating if the hyperparameter on the batch 
shift effect is sampled or given as fixed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Named list of the different quantities drawn by the sampler.
</p>


</div>