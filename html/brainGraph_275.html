<div class="container">

<table style="width: 100%;"><tr>
<td>corr.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate correlation matrix and threshold</h2>

<h3>Description</h3>

<p><code>corr.matrix</code> calculates the correlation between all column pairs of a
given data frame, and thresholds the resultant correlation matrix based on a
given density (e.g., <code>0.1</code> if you want to keep only the 10% strongest
correlations). If you want to threshold by a specific correlation coefficient
(via the <code>thresholds</code> argument), then the <code>densities</code> argument is
ignored.
</p>
<p>The <code>plot</code> method will plot “heat maps” of the correlation
matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corr.matrix(resids, densities, thresholds = NULL, what = c("resids",
  "raw"), exclude.reg = NULL, type = c("pearson", "spearman"),
  rand = FALSE)

## S3 method for class 'corr_mats'
x[i, g = NULL]

## S3 method for class 'corr_mats'
plot(x, mat.type = c("thresholded", "raw"),
  thresh.num = 1L, ordered = TRUE, order.by = "lobe",
  graphs = NULL, grp.names = NULL, legend.title = NULL, ...)

## S3 method for class 'corr_mats'
region.names(object)

## S3 method for class 'corr_mats'
nregions(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resids</code></td>
<td>
<p>An object of class <code>brainGraph_resids</code> (the output from
<code>get.resid</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>densities</code></td>
<td>
<p>Numeric vector indicating the resultant network
densities; keeps the top <em>X</em>% of correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>Numeric; absolute correlation value to threshold by
(default: <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>Character string indicating whether to correlate the residuals or
the raw structural MRI values (default: <code>'resids'</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.reg</code></td>
<td>
<p>Character vector of regions to exclude (default:
<code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string indicating which type of correlation coefficient
to calculate (default: <code>'pearson'</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>Logical indicating whether the function is being called for
permutation testing; not intended for general use (default: <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>A <code>corr_mats</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Integer for subsetting by density/threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Integer, character, or logical for subsetting by group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat.type</code></td>
<td>
<p>Character string indicating whether to plot raw or thresholded
(binarized) matrices. Default: <code>'raw'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh.num</code></td>
<td>
<p>Integer specifying which threshold to plot (if
<code>mat.type='thresholded'</code>). Default: <code>1L</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordered</code></td>
<td>
<p>Logical indicating whether to order the vertices by some
grouping. Default: <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.by</code></td>
<td>
<p>Character string indicating how to group vertices. Default:
<code>'lobe'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graphs</code></td>
<td>
<p>A <code>brainGraphList</code> object containing graphs with the
vertex-level attribute of interest. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp.names</code></td>
<td>
<p>Character vector specifying the names of each group of
vertices. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title</code></td>
<td>
<p>Character string for the legend title. Default is to
leave blank</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Unused</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If you wish to exclude regions from your analysis, you can give the indices
of their columns with the <code>exclude.reg</code> argument.
</p>
<p>By default, the Pearson correlation coefficients are calculated, but you can
return Spearman by changing the <code>type</code> argument.
</p>


<h3>Value</h3>

<p>A <code>corr_mats</code> object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R,P</code></td>
<td>
<p>Numeric arrays of correlation coefficients and P-values. The
length of the 3rd dimension equals the number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.thresh</code></td>
<td>
<p>A list of 3-d binary arrays indicating correlations that
are above a certain threshold. The length of the list equals the number
of groups, and the length of the 3rd dimension equals the number of
thresholds/densities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>Numeric matrix of the thresholds supplied. The number of
columns equals the number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>Residuals or raw values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.reg</code></td>
<td>
<p>Excluded regions (if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Pearson or Spearman</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atlas</code></td>
<td>
<p>The brain atlas used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>densities</code></td>
<td>
<p>Numeric vector; the densities of the resulting graphs, if
you chose to threshold each group to have equal densities.</p>
</td>
</tr>
</table>
<h3>Plotting correlation matrices</h3>

<p>There are several ways to control the plot appearance. First, you may plot
the “raw” correlations, or only those of the thresholded (binarized)
matrices. Second, you may order the vertices by a given vertex attribute; by
default, they will be ordered by <em>lobe</em>, but you may also choose to
order by, e.g., <em>network</em> (for the <code>dosenbach160</code> atlas) or by
<em>community membership</em>. In the latter case, you need to pass a
<code>brainGraphList</code> object to the <code>graphs</code> argument; each graph in the
object must have a vertex attribute specified in <code>order.by</code>. Finally,
you can control the legend text with <code>grp.names</code>.
</p>


<h3>Author(s)</h3>

<p>Christopher G. Watson, <a href="mailto:cgwatson@bu.edu">cgwatson@bu.edu</a>
</p>


<h3>See Also</h3>

<p><code>rcorr</code>
</p>
<p>Other Structural covariance network functions: <code>Bootstrapping</code>,
<code>IndividualContributions</code>,
<code>Residuals</code>,
<code>brainGraph_permute</code>,
<code>import_scn</code>, <code>plot_volumetric</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
myResids &lt;- get.resid(lhrh, covars)
corrs &lt;- corr.matrix(myResids, densities=densities)))

## End(Not run)
## Not run: 
corrs &lt;- corr.matrix(myResids, densities)
plot(corrs, order.by='comm', graphs=g.list, grp.names='Community')

## End(Not run)
</code></pre>


</div>