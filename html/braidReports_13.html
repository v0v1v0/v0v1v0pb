<div class="container">

<table style="width: 100%;"><tr>
<td>runBraidAnalysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BRAID Surface Analysis</h2>

<h3>Description</h3>

<p>Performs a convenient pre-built set of BRAID and dose-response analysis
tasks
</p>


<h3>Usage</h3>

<pre><code class="language-R">runBraidAnalysis(
  formula,
  data,
  defaults,
  weights = NULL,
  start = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL,
  useBIC = TRUE,
  ...
)

## S3 method for class 'formula'
runBraidAnalysis(
  formula,
  data,
  defaults,
  weights = NULL,
  start = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL,
  useBIC = TRUE,
  ...
)

## Default S3 method:
runBraidAnalysis(
  formula,
  data,
  defaults,
  weights = NULL,
  start = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL,
  useBIC = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Either an object of class <code>formula</code> such as would be provided
to a modeling function like <code>stats::lm()</code>, or a width-2 numeric array vector
of concentration pairs (including 0 or Inf).  A formula should specify a
single output as a function of two inputs, eg. <code>activity ~ conc1 + conc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If <code>forumula</code> is a symbolic formula, a data frame containing the
specified values. If <code>formula</code> is a numeric array of concentrations, a
numeric vector of response values, the same length as the number of rows of
<code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaults</code></td>
<td>
<p>Default minimal and maximal effect values used to fix effect
parameters during model selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of weights (between 0 and 1) the same length as
the data which determines the weight with which each measurement
will impact the the sum of squared errors.  Weights will be multiplied by
errors <em>before</em> squaring.  If <code>NULL</code> (the default) all weights will be set
to 1. Can be a numeric vector, or the name of a column in <code>data</code> if <code>formula</code>
is a symbolic formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A BRAID parameter vector specifying the first guess where the
non-linear optimization should begin.  May be a length 7, 8, or 9 vector,
though a full length vector is always preferable.  If <code>NULL</code> (the default),
it will be estimated from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>Determines the possible directionality of the BRAID
model.  If 0 (the default) no additional constraints are placed on the
parameters.  If greater than 0, the fitting will require that the maximal
effects are all <em>greater</em> than or equal to the minimal effect.  If less
than 0, the fitting will require that all maximal effect is <em>less</em> than or
equal to the minimal effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A numeric vector of lower bounds on the fitted parameter values.
May be the same length as the number of fitted parameters, or a full,
length-9 vector. Missing or unspecified lower bounds may be included as <code>NA</code>
or <code>Inf</code>; if unspecified, lower bounds on the first five parameters (IDMA,
IDMB, na, nb, and kappa) will be automatically estimated from the data.
Bounds on the minimal and maximal effect parameters however (E0, EfA, EfB,
and Ef) will be assumed to be infinite unless specified.  A value of <code>NULL</code>,
the default, will be treated as all lower parameter bounds being
unspecified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A numeric vector of upper bounds on the fitted parameter values.
Used in the same way as <code>lower</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useBIC</code></td>
<td>
<p>If <code>TRUE</code> (the default), the best (read: most parsimonious)
model will be selected from all tested models using the Bayesian information
criterion (Schwarz 1978).  If <code>FALSE</code> the function will follow the convention
of earlier versions of the <code>braidrm</code> package and use the Akaike information
criterion (Akaike 1974).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>braidrm::findBestBraid()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>braidAnalysis</code>, containing the following values:
</p>

<ul>
<li> <p><code>concs</code>: a width-two array containing the two tested doses for each
measurement
</p>
</li>
<li> <p><code>act</code>: a numeric vector with as many values as <code>concs</code> has rows,
containing the measured values for each measurement
</p>
</li>
<li> <p><code>weights</code>: a numeric vector of weights, the same length as <code>act</code>,
specifying the weight given to each measurement in fitting.  All weights are
1 by default
</p>
</li>
<li> <p><code>braidFit</code>: a fit object of class <code>braidrm</code> containing the best-fit BRAID
surface according to the given constraints
</p>
</li>
<li> <p><code>hillFit1</code>: If the given data contains measurements of the first drug in
isolation, those measurements are fit using basicdrm::findBestHillModel;
the results of this analysis are stored as an object of class <code>hillrm</code> as
<code>hillFit1</code>. If no such measurements are found, this will be <code>NULL</code>
</p>
</li>
<li> <p><code>hillFit2</code>: the corresponding fit for measurements of the second drug
alone, if they are included; <code>NULL</code> otherwise
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">surface &lt;- synergisticExample

analysis &lt;- runBraidAnalysis(measure~concA+concB, surface, defaults=c(0,1))

names(analysis)
</code></pre>


</div>