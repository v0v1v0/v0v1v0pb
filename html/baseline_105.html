<div class="container">

<table style="width: 100%;"><tr>
<td>baseline.rfbaseline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Robust Baseline Estimation </h2>

<h3>Description</h3>

<p>Wrapper for Andreas F. Ruckstuhl, Matthew P. Jacobson, Robert W. Field,
James A. Dodd's algorithm based on LOWESS and weighted regression
</p>


<h3>Usage</h3>

<pre><code class="language-R">baseline.rfbaseline(spectra, span = 2/3, NoXP = NULL, maxit = c(2, 2),
  b = 3.5, weight = NULL, Scale = function(r) median(abs(r))/0.6745,
  delta = NULL, SORT = FALSE, DOT = FALSE, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p> Matrix with spectra in rows </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p> Amount of smoothing (by fraction of points) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NoXP</code></td>
<td>
<p> Amount of smoothing (by number of points) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p> Maximum number of iterations in robust fit </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p> Tuning constant in the biweight function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p> Optional weights to be given to individual observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scale</code></td>
<td>
<p> S function specifying how to calculate the scale of the residuals </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p> Nonnegative parameter which may be used to save computation. (See <code>rfbaseline</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SORT</code></td>
<td>
<p>Boolean variable indicating whether x data must be sorted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DOT</code></td>
<td>
<p> Disregard outliers totally (boolean) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p> Values of initial fit </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Most of the code is the original code as given by the authors. The ability to
sort by X-values has been removed and ability to handle multiple spectra
has been added
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>baseline </code></td>
<td>
<p>Matrix of baselines corresponding to spectra <code>spectra</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected </code></td>
<td>
<p>Matrix of baseline corrected spectra</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Kristian Hovde Liland and Bj√∏rn-Helge Mevik </p>


<h3>References</h3>

<p> Andreas F. Ruckstuhl, Matthew P. Jacobson, Robert W. Field,
James A. Dodd:
Baseline subtraction using robust local regression estimation </p>


<h3>Examples</h3>

<pre><code class="language-R">data(milk)
bc.rbe &lt;- baseline(milk$spectra[1,, drop=FALSE], method='rfbaseline',
  span=NULL, NoXP=1000)
## Not run: 
	plot(bc.rbe)

## End(Not run)
</code></pre>


</div>