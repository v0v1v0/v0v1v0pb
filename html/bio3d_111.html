<div class="container">

<table style="width: 100%;"><tr>
<td>load.enmff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> ENM Force Field Loader </h2>

<h3>Description</h3>

<p>Load force field for elastic network normal mode calculation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">load.enmff(ff = 'calpha')
ff.calpha(r, rmin=2.9, ...)
ff.anm(r, cutoff=15, gamma=1, ...)
ff.pfanm(r, cutoff=NULL, ...)
ff.sdenm(r, atom.id, pdb, ...)
ff.reach(r, atom.id, ...)
ff.aaenm(r, ...)
ff.aaenm2(r, atom.id, pdb, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ff</code></td>
<td>
<p> a character string specifying the force field to use:
‘calpha’, ‘anm’, ‘pfanm’, 
‘reach’, or  ‘sdenm’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p> a numeric vector of c-alpha distances. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmin</code></td>
<td>
<p> lowest allowed atom-atom distance for the force constant
calculation. The default of 2.9A is based on an evaluation of 24
high-resolution X-ray structures (&lt; 1A). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p> numerical, cutoff for pair-wise interactions. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p> numerical, global scaling factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atom.id</code></td>
<td>
<p> atomic index. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> a <code>pdb</code> object as obtained from function <code>read.pdb</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments passed to and from functions. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides a collection of elastic network model (ENM)
force fields for normal modes analysis (NMA) of protein structures. It
returns a function for calculating the residue-residue spring force
constants.
</p>
<p>The ‘calpha’ force field - originally developed by Konrad
Hinsen - is the recommended one for most applications. It employs a
spring force constant differentiating between nearest-neighbour pairs
along the backbone and all other pairs. The force constant function
was parameterized by fitting to a local minimum of a crambin model
using the AMBER94 force field.
</p>
<p>The implementation of the ‘ANM’ (Anisotropic Network Model)
force field originates from the lab of Ivet Bahar. It uses a
simplified (step function) spring force constant based on the
pair-wise distance. A variant of this from the Jernigan lab is the
so-called ‘pfANM’ (parameter free ANM) with interactions that
fall off with the square of the distance.
</p>
<p>The ‘sdENM’ (by Dehouck and Mikhailov) employs residue specific
spring force constants. It has been parameterized through a
statistical analysis of a total of 1500 NMR ensembles.
</p>
<p>The ‘REACH’ force field (by Moritsugu and Smith) is
parameterized based on variance-covariance matrices obtained from MD
simulations. It employs force constants that fall off exponentially
with distance for non-bonded pairs.
</p>
<p>The all-atom ENM force fields (‘aaenm’ and ‘aaenm2’) was
obtained by fitting to a local energy minimum of a crambin model
derived from the AMBER99SB force field (same approach as in Hinsen et
al 2000). It employs a pair force constant function which falls as
r^-6. ‘aanma2’ employs additonally specific force constants for
covalent and intra-residue atom pairs. See also <code>aanma</code>
for more details.
</p>
<p>See references for more details on the individual force fields.
</p>


<h3>Value</h3>

<p>‘load.enmff’ returns a function for calculating the spring 
force constants. The ‘ff’ functions returns a numeric vector of
residue-residue spring force constants. 
</p>


<h3>Note</h3>

<p>The arguments ‘atom.id’ and ‘pdb’ are used
from within function ‘build.hessian’ for functions that are not
simply a function of the pair-wise distance. e.g. the force constants
in the ‘sdENM’ model computes the force constants based on a
function of the residue types and calpha distance. 
</p>


<h3>Author(s)</h3>

<p> Lars Skjaerven </p>


<h3>References</h3>

<p>Skjaerven, L. et al. (2014) <em>BMC Bioinformatics</em> <b>15</b>, 399.
Hinsen, K. et al. (2000) <em>Chemical Physics</em> <b>261</b>, 25–37.
Atilgan, A.R. et al. (2001) <em>Biophysical Journal</em> <b>80</b>, 505–515.
Dehouck Y. &amp; Mikhailov A.S. (2013) <em>PLoS Comput Biol</em> <b>9</b>:e1003209.
Moritsugu K. &amp; Smith J.C. (2008) <em>Biophysical Journal</em> <b>95</b>, 1639–1648.
Yang, L. et al. (2009) <em>PNAS</em> <b>104</b>, 12347-52.
Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>


<h3>See Also</h3>

 <p><code>nma</code>, <code>build.hessian</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Load the c-alpha force field
pfc.fun &lt;- load.enmff('calpha')

## Calculate the pair force constant for a set of C-alpha distances
force.constants &lt;- pfc.fun( seq(4,8, by=0.5) )

## Calculate the complete spring force constant matrix
## Fetch PDB
pdb &lt;- read.pdb( system.file("examples/1hel.pdb", package="bio3d") )

## Fetch only c-alpha coordinates
ca.inds &lt;- atom.select(pdb, 'calpha')
xyz &lt;- pdb$xyz[ca.inds$xyz]

## Calculate distance matrix
dists &lt;- dm.xyz(xyz, mask.lower=FALSE)

## all pair-wise spring force constants
fc.matrix &lt;- apply(dists, 1, pfc.fun)
</code></pre>


</div>