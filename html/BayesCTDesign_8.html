<div class="container">

<table style="width: 100%;"><tr>
<td>plot.bayes_ctd_array</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Data from Two Arm Bayesian Clinical Trial Simulation.</h2>

<h3>Description</h3>

<p><code>plot.bayes_ctd_array()</code> takes an S3 object of class <code>bayes_ctd_array</code>, and
creates a line plot from a one or two dimensional slice of the data generated by a
clinical trial simulation using <code>historic_sim()</code> or <code>simple_sim()</code>.  The
plotted results can be smoothed or unsmoothed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bayes_ctd_array'
plot(
  x = NULL,
  measure = "power",
  tab_type = "WX|YZ",
  smooth = FALSE,
  plot_out = TRUE,
  subj_per_arm_val = NULL,
  a0_val = NULL,
  effect_val = NULL,
  rand_control_diff_val = NULL,
  span = 0.75,
  degree = 2,
  family = "gaussian",
  title = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Name of object of class <code>bayes_ctd_array</code> containing
data from clinical trial simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>Must be equal to <code>power</code>, <code>est</code>, <code>var</code>, <code>bias</code>,
or <code>mse</code>.  Default is <code>power</code>.  Case does not matter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab_type</code></td>
<td>
<p>A character string that must equal <code>WX|YZ</code>, <code>WY|XZ</code>,
<code>WZ|XY</code>, <code>XY|WZ</code>, <code>XZ|WY</code>, <code>YZ|WX</code>, <code>ZX|WY</code>, <code>XW|YZ</code>,
<code>YW|XZ</code>, <code>YX|WZ</code>, <code>ZW|XY</code>, <code>ZX|WY</code>, <code>ZY|WX</code> when
<code>x</code> is generated by <code>historic_sim()</code>.  Default is
<code>WX|YZ</code>.  When <code>x</code> is generated by <code>simple_sim()</code>,
<code>tab_type</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>A true/false parameter indicating whether smoothed results
should be plotted. Note, smoothing of simulation results requires the length of
<code>subj_per_arm_val</code> or <code>a0_val</code> or <code>effect_val</code> or
<code>rand_control_diff_val</code>, whichever populates the x-axis on the graph to
contain enough elements to justify the smoothing.  No checking occurs to
determine if enough elements are present to justify smoothing.  Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_out</code></td>
<td>
<p>A true/false parameter indicating whether the plot should be
produced.  This parameter is useful if the user only wants a table of smoothed
values.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subj_per_arm_val</code></td>
<td>
<p>Must be non-missing, if <code>x</code> is generated
by <code>historic_sim()</code> and sample size is being held constant.
If <code>x</code> is generated by <code>historic_sim()</code> and sample size
is being held constant, <code>subj_per_arm_val</code> must equal a value submitted
to <code>historic_sim()</code> within the <code>subj_per_arm</code> parameter.  When
<code>x</code> is generated by <code>simple_sim()</code>, <code>subj_per_arm_val</code>
is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0_val</code></td>
<td>
<p>Must be non-missing, if <code>x</code> is generated
by <code>historic_sim()</code> and a0, the power prior parameter, is being held
constant.  If <code>x</code> is generated by <code>historic_sim()</code> and
a0 is being held constant, <code>a0_val</code> must equal a value submitted
to <code>historic_sim()</code> within the <code>a0_val</code> parameter.  When
<code>x</code> is generated by <code>simple_sim()</code>, <code>a0_val</code> is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_val</code></td>
<td>
<p>Must be non-missing, if <code>x</code> is generated
by <code>historic_sim()</code> and effect is being held constant.  If
<code>x</code> is generated by <code>historic_sim()</code> and effect is being
held constant, <code>effect_val</code> must equal a value submitted to
<code>historic_sim()</code> within the <code>effect_vals</code> parameter.  When
<code>x</code> is generated by <code>simple_sim()</code>, <code>effect_val</code> is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand_control_diff_val</code></td>
<td>
<p>Must be non-missing, if <code>x</code> is
generated by <code>historic_sim()</code> and differences between randomized
and historical controls are being held constant.  If <code>x</code>
is generated by <code>historic_sim()</code> and control differences are being
held constant, <code>rand_control_diff_val</code> must equal a value submitted to
<code>historic_sim()</code> within the <code>rand_control_diff</code> parameter.  When
<code>x</code> is generated by <code>simple_sim()</code>,
<code>rand_control_diff_val</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>The <code>span</code> parameter value for a call <code>loess()</code>.  Default is 0.75.  If
<code>span</code> is a single number, then that value will be used to smooth the data in all
columns of the table being plotted.  If <code>span</code> is a vector, then it must have length
equal to the number of columns being plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>The <code>degree</code> parameter value for a call <code>loess()</code>.  Default is 2.
The value of <code>degree</code> will be used for all columns being plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The <code>family</code> parameter value for a call <code>loess()</code>.  Default is
"<code>gaussian</code>".  The value of <code>family</code> will be used for all columns being plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Lower and upper limits for y-axis of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the object of class <code>bayes_ctd_array</code> is created by <code>historic_sim()</code>,
the function <code>plot()</code> allows the user to create line plots of user-specified
1- or 2- dimensional slices of the simulation results based on slicing code
described below. If the object of class <code>bayes_ctd_array</code> is created by
<code>simple_sim()</code>, a basic plot of characteristic by sample size and effect is created.
</p>
<p>If the object of class <code>bayes_ctd_array</code> is created by <code>simple_sim()</code>, then
all four trial characteristics (<code>subj_per_arm_val</code>, <code>a0_vals</code>,
<code>effect_val</code>, and <code>rand_control_diff_val</code>) can be ignored as can the
parameter defining what type of plot to create through the parameter <code>tab_type</code>.
A call to <code>plot()</code> will require the user to specify a measure (power, est,
var, bias, or mse).
</p>
<p>If the object of class <code>bayes_ctd_array</code> is created by <code>historic_sim()</code>,
when calling <code>plot()</code> the user must specify a measure to plot
(power, est, var, bias, or mse) and may be required to specify a plot type through
the <code>tab_type</code> parameter.  A plot type, <code>tab_type</code>, will be required if
3 of the 4 trial characteristics are equal to a vector of 2 or more values.  This
plot type specification uses the letters W, X, Y, and Z.  The letter W represents
the subject per arm dimension.  The letter X represents the a0 dimension.  The
letter Y represents the effect dimension.  The letter Z represents the control
difference dimension.  To plot a slice of the 4-dimensional array, these letters
are put into an AB|CD pattern just like in <code>print()</code>.  The two letters
to the right of the vertical bar define which variables are held constant.  The two
letters to the left of the vertical bar define which variables are going to show up
in the plot.  The first letter defines the x-axis variable and the second letter
defines the stratification variable.  The result is a plot of power, estimate,
variance, bias, or mse by the trial characteristic represented by the first letter.
On this plot, one line will be created for each value of the trial characteristic
represented by the second letter.  For example if tab_type equals <code>WX|YZ</code>,
then effect and control differences will be held constant, while sample size will be
represented along the horizontal axis and a0 values will be represented by separate
lines.  The actual values that are plotted on the y-axis depend on what measure is
requested in the parameter <code>measure</code>.
</p>

<ul>
<li> <p><code>tab_type='WX|YZ'</code>, Sample Size by a0
</p>
</li>
<li> <p><code>tab_type='WY|XZ'</code>, Sample Size by Effect
</p>
</li>
<li> <p><code>tab_type='WZ|XY'</code>, Sample Size by Control Differences
</p>
</li>
<li> <p><code>tab_type='XY|WZ'</code>, a0 by Effect
</p>
</li>
<li> <p><code>tab_type='XZ|WY'</code>, a0 by Control Differences
</p>
</li>
<li> <p><code>tab_type='YZ|WX'</code>, Effect by Control Differences
</p>
</li>
<li> <p><code>tab_type='ZX|WY'</code>, Control Differences by a0
</p>
</li>
<li> <p><code>tab_type='XW|YZ'</code>, a0 by Sample Size
</p>
</li>
<li> <p><code>tab_type='YW|XZ'</code>, Effect by Sample Size
</p>
</li>
<li> <p><code>tab_type='YX|WZ'</code>, Effect by a0
</p>
</li>
<li> <p><code>tab_type='ZW|XY'</code>, Control Differences by Sample Size
</p>
</li>
<li> <p><code>tab_type='ZY|WX'</code>, Control Differences by Effect
</p>
</li>
</ul>
<p>It is very important to populate the values of <code>subj_per_arm_val</code>,
<code>a0_val</code>, <code>effect_val</code>, and <code>rand_control_diff_val</code> correctly given
the value of tab_type, when the object of class <code>bayes_ctd_array</code> is created by
<code>historic_sim()</code> and at least 3 of the four parameters have more than one
value.  On, the other hand, if 2 or more of the four parameters have only one value,
then <code>subj_per_arm_val</code>, <code>a0_vals</code>, <code>effect_val</code>,
<code>rand_control_diff_val</code>, as well as <code>tab_type</code> can be ignored.  If the last
two letters are <code>YZ</code>, then <code>effect_val</code> and <code>rand_control_diff_val</code>
must be populated.  If the last two letters are <code>XZ</code>, then <code>a0_val</code> and
<code>rand_control_diff_val</code> must be populated.  If the last two letters are <code>XY</code>,
then <code>a0_val</code> and <code>effect_val</code> must be populated.  If the last two letters
are <code>WZ</code>, then <code>sample_val</code> and <code>rand_control_diff_val</code> must be
populated.  If the last two letters are <code>WY</code>, then <code>sample_size_val</code> and
<code>effect_val</code> must be populated.  If the last two letters are <code>WX</code>, then
<code>sample_size_val</code> and <code>a0_val</code> must be populated.
</p>
<p>If the object of class <code>bayes_ctd_array</code> is created by <code>simple_sim()</code>, the
parameters <code>tab_type</code>, <code>subj_per_arm_val</code>, <code>a0_val</code>, <code>effect_val</code>,
and <code>rand_control_diff_val</code> are ignored.
</p>


<h3>Value</h3>

<p><code>plot()</code> returns a plot for a two dimensional array of simulation
results.  If <code>smooth</code> is <code>TRUE</code>, then the plot is based on a smoothed
version of the simulation results. If <code>smooth</code> is <code>FALSE</code>, then the plot
is based on the raw data from the simulation results.  What actually is plotted
depends on the value of <code>measure</code>.  If <code>plot_out</code> is <code>FALSE</code>, the
plot is not created.  This option is useful when the user wants a table of smoothed
simulation results but does not want the plot. Smoothing of simulation results
requires the length of <code>subj_per_arm_val</code> or <code>a0_val</code> or <code>effect_val</code>
or <code>rand_control_diff_val</code>, whichever populates the x-axis on the graph to
contain enough elements to justify the smoothing.  No checking occurs to
determine if enough elements are present to justify smoothing.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Run a Weibull simulation, using simple_sim().
#For meaningful results, trial_reps needs to be much larger than 2.
weibull_test &lt;- simple_sim(trial_reps = 2, outcome_type = "weibull",
                           subj_per_arm = c(50, 100, 150, 200),
                           effect_vals = c(0.6, 1),
                           control_parms = c(2.82487,3), time_vec = NULL,
                           censor_value = NULL, alpha = 0.05,
                           get_var = TRUE, get_bias = TRUE, get_mse = TRUE,
                           seedval=123, quietly=TRUE)

#Create a plot of the power simulation results.
plot(x=weibull_test, measure="power", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE, subj_per_arm_val=NULL, a0_val=NULL,
     effect_val=NULL, rand_control_diff_val=NULL)
#Create a plot of the hazard ratio simulation results.
plot(x=weibull_test, measure="est", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE, subj_per_arm_val=NULL, a0_val=NULL,
     effect_val=NULL, rand_control_diff_val=NULL)
#Create a plot of the hazard ratio variance simulation results.
plot(x=weibull_test, measure="var", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE, subj_per_arm_val=NULL, a0_val=NULL,
     effect_val=NULL, rand_control_diff_val=NULL)
#Create a plot of the hazard ratio bias simulation results.
plot(x=weibull_test, measure="bias", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE, subj_per_arm_val=NULL, a0_val=NULL,
     effect_val=NULL, rand_control_diff_val=NULL)
#Create a plot of the hazard ratio mse simulation results.
plot(x=weibull_test, measure="mse", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE, subj_per_arm_val=NULL, a0_val=NULL,
     effect_val=NULL, rand_control_diff_val=NULL)


#Run a second Weibull simulation, using simple_sim() and smooth the plot.
#For meaningful results, trial_reps needs to be larger than 100.
weibull_test2 &lt;- simple_sim(trial_reps = 100, outcome_type = "weibull",
                            subj_per_arm = c(50, 75, 100, 125, 150, 175, 200, 225, 250),
                            effect_vals = c(0.6, 1, 1.4),
                            control_parms = c(2.82487,3), time_vec = NULL,
                            censor_value = NULL, alpha = 0.05, get_var = TRUE,
                            get_bias = TRUE, get_mse = TRUE, seedval=123,
                            quietly=TRUE)

#Create a plot of the power simulation results.
plot(x=weibull_test2, measure="power", tab_type=NULL,
     smooth=TRUE, plot_out=TRUE, subj_per_arm_val=NULL, a0_val=NULL,
     effect_val=NULL, rand_control_diff_val=NULL, span=c(1,1,1))



#Run a third weibull simulation, using historic_sim().
#Note: historic_sim() can take a while to run.
#Generate a sample of historical data for use in example.
set.seed(2250)
SampleHistData &lt;- genweibulldata(sample_size=60, scale1=2.82487,
                                 hazard_ratio=0.6, common_shape=3,
                                 censor_value=3)
histdata &lt;- subset(SampleHistData, subset=(treatment==0))
histdata$id &lt;- histdata$id+10000

#For meaningful results, trial_reps needs to be larger than 100.
weibull_test3 &lt;- historic_sim(trial_reps = 100, outcome_type = "weibull",
                              subj_per_arm = c(50, 100, 150, 200, 250),
                              a0_vals = c(0, 0.33, 0.67, 1),
                              effect_vals = c(0.6, 1, 1.4),
                              rand_control_diff = c(0.8, 1, 1.2),
                              hist_control_data = histdata, time_vec = NULL,
                              censor_value = 3, alpha = 0.05, get_var = TRUE,
                              get_bias = TRUE, get_mse = TRUE, seedval=123,
                              quietly=TRUE)

#Create a plot of the power simulation results.
plot(x=weibull_test3, measure="power", tab_type="WX|YZ",
     smooth=FALSE, plot_out=TRUE, effect_val=0.6,
     rand_control_diff_val=1.0)



#Run a Gaussian simulation, using historic_sim()
#Generate a sample of historical Gaussian data for use in example.
set.seed(2250)
samplehistdata &lt;- gengaussiandata(sample_size=60, mu1=25, mean_diff=0, common_sd=3)
histdata &lt;- subset(samplehistdata, subset=(treatment==0))
histdata$id &lt;- histdata$id+10000

#For meaningful results, trial_reps needs to be larger than 100.
gaussian_test &lt;- historic_sim(trial_reps = 100, outcome_type = "gaussian",
                             subj_per_arm = c(150),
                             a0_vals = c(1.0),
                             effect_vals = c(0.15),
                             rand_control_diff = c(-4.0,-3.5,-3.0,-2.5,-2.0,
                                                   -1.5,-1.0,-0.5,0,0.5,1.0),
                             hist_control_data = histdata, time_vec = NULL,
                             censor_value = 3, alpha = 0.05, get_var = TRUE,
                             get_bias = TRUE, get_mse = TRUE, seedval=123,
                             quietly=TRUE)
test_table &lt;- print(x=gaussian_test, measure="power",
                         tab_type=NULL, effect_val=NULL,
                         subj_per_arm_val=NULL)
print(test_table)
#Create a plot of the power simulation results.
plot(x=gaussian_test, measure="power", tab_type=NULL,
     smooth=TRUE, plot_out=TRUE, effect_val=NULL,
     rand_control_diff_val=NULL)



#Generate a sample of historical pwe data for use in example.
set.seed(2250)
nvalHC &lt;- 60
time.vec &lt;- c(0.3,0.9,1.5,2.1,2.4)
lambdaHC.vec &lt;- c(0.19,0.35,0.56,0.47,0.38,0.34)
censor.value &lt;- 3

SampleHistData &lt;- genpwedata(nvalHC, lambdaHC.vec, 1.0, time.vec, censor.value)
histdata &lt;- subset(SampleHistData, subset=(treatment==0))
histdata$indicator &lt;- 2 #If set to 2, then historical controls will be collapsed with
#randomized controls, when time_vec is re-considered and
#potentially restructured.  If set to 1, then historical
#controls will be treated as a separated cohort when
#time_vec is being assessed for restructuring.
histdata$id &lt;- histdata$id+10000

#Run a pwe simulation, using historic_sim().
#For meaningful results, trial_reps needs to be larger than 100.
pwe_test &lt;- historic_sim(trial_reps = 100, outcome_type = "pwe",
                        subj_per_arm = c(25,50,75,100,125,150,175,200,225,250),
                        a0_vals = c(1.0),
                        effect_vals = c(0.6),
                        rand_control_diff = c(1.8),
                        hist_control_data = histdata, time_vec = time.vec,
                        censor_value = 3, alpha = 0.05, get_var = TRUE,
                        get_bias = TRUE, get_mse = TRUE, seedval=123,
                        quietly=TRUE)

#Create a plot of the power simulation results.
plot(x=pwe_test, measure="power", tab_type=NULL,
     smooth=TRUE, plot_out=TRUE, effect_val=NULL,
     rand_control_diff_val=NULL)


</code></pre>


</div>