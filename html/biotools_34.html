<div class="container">

<table style="width: 100%;"><tr>
<td>gencovtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Testing Genetic Covariance
</h2>

<h3>Description</h3>

<p><code>gencovtest()</code> tests genetic covariance components from a MANOVA model. Two different approaches can
be used: (I) a test statistic that takes into account the genetic and environmental effects and (II) a test 
statistic that only considers the genetic information. The first type refers to tests based on the mean 
cross-products ratio, whose distribution is obtained via Monte Carlo simulation of Wishart matrices. The 
second way of testing genetic covariance refers to tests based upon an adaptation of Wilks' and Pillai's 
statistics for evaluating independence of two sets of variables. All these tests are described by Silva (2015).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'manova'
gencovtest(obj, geneticFactor, gcov = NULL, 
	residualFactor = NULL, adjNrep = 1, 
	test = c("MCPR", "Wilks", "Pillai"), 
	nsim = 9999, 
	alternative = c("two.sided", "less", "greater"))
## S3 method for class 'gencovtest'
print(x, digits = 4, ...)
## S3 method for class 'gencovtest'
plot(x, var1, var2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p> an object of class <code>"manova"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneticFactor</code></td>
<td>
<p> a character indicating the genetic factor from which to test covariance components.
It must be declared as a factor in the manova object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcov</code></td>
<td>
<p> optional; a matrix containing estimates of genetic covariances to be tested. If 
<code>NULL</code> (default), an estimate is obtained via method of moments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residualFactor</code></td>
<td>
<p> optional; a character indicating a source in the manova model to be used as
error term. If <code>NULL</code> (default), the usual term "Residuals" will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjNrep</code></td>
<td>
<p> a correction index for dealing with unbalanced data. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p> a character indicating the test. It must be on of the following:
<code>"MCPR"</code> - the empirical type-I test based on Mean Cross-Products Ratios via Wishart simulation,
<code>"Wilks"</code> - a type-II test based on the partial Wilks' Lambda,
<code>"Pillai"</code> - a type-II test based on the partial Pillai's statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p> the number of Monte Carlo simulations. Used only if <code>test = "MCPR"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> the type of alternative hypothesis. Used only if <code>test = "MCPR"</code>. So far,
only the option <code>"two.sided"</code> is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an object of class <code>"gencovtest"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p> the number of digits to be displayed by the print method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var1</code></td>
<td>
<p> a character of integer indicating one of the two response variable or its position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var2</code></td>
<td>
<p> a character of integer indicating one of the two response variable or its position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The genetic covariance matrix is currently estimated via method of moments, following the equation:
</p>
<p style="text-align: center;"><code class="reqn">G = (Mg - Me) / (nrep * adjNrep)</code>
</p>

<p>where <code class="reqn">Mg</code> and <code class="reqn">Me</code> are the matrices of mean cross-products associated with the genetic factor and 
the residuals, respectively; <code class="reqn">nrep</code> is the number of replications, calculated as the ratio between the 
total number of observations and the number of levels of the genetic factor; <code class="reqn">adjNrep</code> is supposed to 
adjust nrep, specially when estimating <code class="reqn">G</code> from unbalanced data.
</p>


<h3>Value</h3>

<p>An object of class <code>gencovtest</code>, a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gcov</code></td>
<td>
<p> a p-dimensional square matrix containing estimates of the genetic covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcor</code></td>
<td>
<p> a p-dimensional square matrix containing estimates of the genetic correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p> the test (as input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p> a p-dimensional square matrix containing the <code>test</code> statistics. 
If <code>test = "MCPR"</code> the mean cross-products ratios are computed; if <code>test = "Wilks"</code>
the Wilks' Lambda is; and <code>test = "Pillai"</code> results on Pillai's <code class="reqn">Tn</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.values</code></td>
<td>
<p> a p-dimensional square matrix containing the associated p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> the type of alternative hypothesis (as input).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p> a p-dimensional square matrix containing the Chi-square (D.f. = 1) approximation for Wilks's 
and Pillai's statistics. Stored only if one of these two tests is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simRatio</code></td>
<td>
<p> an array consisting of <code>nsim</code> p-dimensional matrices containing the simulated mean 
cross-products ratios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfg</code></td>
<td>
<p> the number of degrees of freedom associated with the genetic factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfe</code></td>
<td>
<p> the number of degrees of freedom associated with the residual term.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>When using the MCPR test, be aware that <code>dfg</code> should be equal or greater than the number of variables (p). 
Otherwise the simulation of Wishart matrices may not be done.
</p>
<p>A collinearity diagnosis is carried out using the condition number (CN), for the inferences may be affected by the 
quality of <code class="reqn">G</code>. Thus, if CN &gt; 100, a warning message is displayed.
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Silva, A.R. (2015) <em>On Testing Genetic Covariance</em>. LAP Lambert Academic Publishing. ISBN 3659716553
</p>


<h3>See Also</h3>

<p><code>manova</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># MANOVA
data(maize)
M &lt;- manova(cbind(NKPR, ED, CD, PH) ~ family + env, data = maize)
summary(M)

# Example 1 - MCPR
t1 &lt;- gencovtest(obj = M, geneticFactor = "family")
print(t1)
plot(t1, "ED", "PH")

# Example 2 - Pillai
t2 &lt;- gencovtest(obj = M, geneticFactor = "family", test = "Pillai")
print(t2)
plot(t2, "ED", "PH")

# End (not run)
</code></pre>


</div>