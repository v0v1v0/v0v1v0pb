<div class="container">

<table style="width: 100%;"><tr>
<td>resboot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Rresidual Bootstrap Test (RBT) for treatment-biomarker interaction
</h2>

<h3>Description</h3>

<p>{resboot} is a function to test the existance of treatment-biomarker 
interaction in biomarker threshold model 
</p>
<p>g(Y) = b0+b1*I(w&gt;c) + b2*z + b3*I(w&gt;c)*z.
</p>


<h3>Usage</h3>

<pre><code class="language-R">resboot(x, ...)

## S3 method for class 'formula'
resboot(formula, family, data=list(...), B = 100, epsilon = 0.01, ...)
#
###To test the null hypothesis of interaction between treatment variable  
###(define by z) and biomarker variables (define by w) for survival dataa, 
###use:
#
# fit = resboot(Surv(time, status) ~ w + z + w:z)
#
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula"(or one that can be coerced to 
that class): a symbolic description of the model to be fitted. 
The details of model specification are given under 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>default is family = 'Surv' for survival data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by 
'as.data.frame' to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the enviro
nment from which resboot is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Here covariate x is a design matrix of dimension n * 1 (for two sample test) 
or dimension n * 2 (for treatment * biomarker interaction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstraps, default is B = 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Biomarker (transformed) step length for profile likelihood method, default is epsilon = 0.01</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level regression fitting 
functions (see below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>resboot(y~w + z + w:z) will give residual bootstrap p-value for interaction
between biomarker variable (w) and treatment variable (z).
The null hypothesis is given by H0: b3 = 0, where b3 is the regression 
coefficient for the interaction term I(w&gt;c)*z.
Function print(x) can be used to print a summary of resboot results.
</p>


<h3>Value</h3>


<p>resboot returns an object of class inheriting from "resboot". 
When B &gt; 0, an object of class "resboot" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the estimated maximum of likelihood ratio statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.b</code></td>
<td>
<p>Bootstrap sample of theta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>standard deviation of theta based on resampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>(1-alpha) percent confidence interval for theta based on resampling</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Based on code from Parisa Gavanji.
</p>


<h3>Author(s)</h3>

<p>Bingshu E. Chen (bingshu.chen@queensu.ca)
</p>


<h3>References</h3>

<p>Gavanji, P., Chen, B. E. and Jiang, W.(2018). Residual Bootstrap test for interactions in biomarker threshold models with survival data. Statistics in Biosciences.
</p>


<h3>See Also</h3>



<p><code>bhm</code>
<code>coxph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## Generate a random data set
n = 30
b = c(0.5, 1, 1.5)
data = gendat.surv(n, c0 = 0.40, beta = b)
tm = data[, 1]
status = data[, 2]
trt = data[, 3]
ki67 = data[, 4]
#
### No run
# 
# fit = resboot(Surv(tm, status) ~ ki67+trt+ki67:trt) 
#
</code></pre>


</div>