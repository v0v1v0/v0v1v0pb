<div class="container">

<table style="width: 100%;"><tr>
<td>sim.mp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation Function for Group Testing Data with Matrix Pooling Design
</h2>

<h3>Description</h3>

<p>Simulates data in group testing form ready to be fit by <kbd>gtreg.mp</kbd>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.mp(x = NULL, gshape = 20, gscale = 2, par,
    linkf = c("logit", "probit", "cloglog"),
    n.row, n.col, sens = 1, spec = 1,
    sens.ind = NULL, spec.ind = NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a matrix of user-submitted covariates to simulate the data with, defaults to <kbd>NULL</kbd> in which case a gamma distribution is used to generate the covariates automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gshape</code></td>
<td>

<p>shape parameter of gamma distribution, must be non-negative, set to be 20 by default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gscale</code></td>
<td>

<p>scale parameter of gamma distribution, must be strictly positive, set to be 2 by default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>the true coefficients in the linear predictor 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkf</code></td>
<td>
<p>a character string specifying one of the three link functions to be used: <kbd>"logit"</kbd> (default) or <kbd>"probit"</kbd> or <kbd>"cloglog"</kbd>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.row</code></td>
<td>

<p>a vector that specifies the number of rows in each matrix, a scalar if only one matrix is simulated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.col</code></td>
<td>

<p>a vector that specifies the number of columns in each matrix, a scalar if only one matrix is simulated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens</code></td>
<td>

<p>sensitivity of the group tests, set to be 1 by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>

<p>specificity of the group tests, set to be 1 by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens.ind</code></td>
<td>

<p>sensitivity of the individual retests, set to be equal to sens if not specified otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.ind</code></td>
<td>

<p>specificity of the individual retests, set to be equal to spec if not specified otherwise.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><kbd>sim.mp</kbd> generates group testing data in matrix pooling form. The covariates are either specified by the <kbd>x</kbd> argument or they are generated from a gamma distribution with a given <kbd>gshape</kbd> and <kbd>gscale</kbd>. The individual probabilities are calculated from the covariates, the coefficients given in <kbd>par</kbd> and the link function specified through <kbd>linkf</kbd>. The true binary individual responses are then simulated from the individual probabilities. The individuals are organized into (by column) one or more matrices specified by <kbd>n.row</kbd> and <kbd>n.col</kbd>, and the true group responses are found (i.e., if at least one response is positive, the group is positive; otherwise, the group response is negative). The observed row and column group responses are then simulated using the given <kbd>sens</kbd> and <kbd>spec</kbd> values. Individual retests are simulated from <kbd>sens.ind</kbd> and <kbd>spec.ind</kbd> for individuals that lie on the intersection of an observed positive row and an observed positive column. In the case where no column (row) tests positive in a matrix, all the individuals in any observed positive rows (columns) will be assigned a simulated retest result. If no column or row is observed positive, <kbd>NULL</kbd> is returned. 
</p>


<h3>Value</h3>

<p><kbd>sim.mp</kbd> returns a list with the components
<kbd>dframe</kbd>: the data frame that is actually to be fit,
<kbd>ind</kbd>: the true individual responses presented in matrices and
<kbd>prob</kbd>: the individual probabilities.
</p>
<p><kbd>dframe</kbd> is a data frame with columns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>col.resp</code></td>
<td>
<p>the column group response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.resp</code></td>
<td>
<p>the row group response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrayn</code></td>
<td>
<p>the array number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coln</code></td>
<td>
<p>the column group number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rown</code></td>
<td>
<p>the row group number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retest</code></td>
<td>
<p>the results of individual retests</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Boan Zhang
</p>


<h3>See Also</h3>

<p><code>gtreg.mp</code> for the corresponding function to fit the model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# 5*6 and 4*5 matrix
set.seed(9128)
sa1a&lt;-sim.mp(par=c(-7,0.1), n.row=c(5,4), n.col=c(6,5),
 sens=0.95, spec=0.95)
sa1&lt;-sa1a$dframe


</code></pre>


</div>