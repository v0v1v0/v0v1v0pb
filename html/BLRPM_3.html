<div class="container">

<table style="width: 100%;"><tr>
<td>BL.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating storms and cells</h2>

<h3>Description</h3>

<p>Bartlett-Lewis Rectangular Pulse Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">BL.sim(lambda = 4/240, gamma = 1/10, beta = 0.3, eta = 2, mux = 4,
  t.sim = 240)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>value specifying the generation rate of storms [1/h]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>value specifying the storm duration [1/h]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>value specifying the generation rate of cells [1/h]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>value specifying the cell duration [1/h]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mux</code></td>
<td>
<p>value specifying the cell intensity [mm/h]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.sim</code></td>
<td>
<p>value specifying the simulation time [h]</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model description (Rodriguez-Iturbe et al., 1987):
</p>
<p>The model is a combination of 2 poisson processes and simulates storms and cells.
During the given simulation time storms are generated in a poisson process with rate lambda.
Those storms are given a exponetially distributed duration with parameter gamma. 
During its duration the storm generates in a second poisson process cells with rate beta.
The first cell has to be instantaneous at the time of the storm arrival.
The cell duration is exponentially distributed with parameter eta. For the whole lifetime
each cell is given a constant intensity which is exponentially distributed with parameter 1/mux.
</p>
<p>Aggregation:
</p>
<p>The intensities of all cells alive at time t are summed up for total precipitation at time t.
</p>
<p>Parameter estimation:
</p>
<p>The model parameters (lambda,gamma,beta,eta,mux) can be estimated from simulated or 
observed precipitation time series using the method of moments. Certain moments, e.g. mean, variance 
can be calculated from the time series at different aggregation levels. These moments
can also be calculated theoretically from model parameters. Both sets of statistics can be 
compared in an objective function, similar to a squared error estimator. By numerical optimization
the model parameters can be tuned to match the time series characteristics. 
<code>BL.sim</code> generates model realisations of storms and cells by using given model
parameters <code>lambda,gamma,beta,eta,mux</code> for a given simulation time <code>t.sim</code>
</p>


<h3>Value</h3>

<p><code>BL.sim</code> returns storms; <code>data.frame</code> of all storms containing information about occurence time, end time and number of cells
</p>
<p><code>BL.sim</code> returns cells; <code>data.frame</code> of all cells containing information about occurence time, end time, intensity and storm index
</p>


<h3>Author(s)</h3>

<p>Christoph Ritschel <a href="mailto:christoph.ritschel@met.fu-berlin.de">christoph.ritschel@met.fu-berlin.de</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">lambda &lt;- 4/240
gamma &lt;- 1/10
beta &lt;- 0.3
eta &lt;- 2
mux &lt;- 4
t.sim &lt;- 240
simulation &lt;- BL.sim(lambda,gamma,beta,eta,mux,t.sim)
</code></pre>


</div>