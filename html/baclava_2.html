<div class="container">

<table style="width: 100%;"><tr>
<td>aloocv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate Leave-One-Out Cross-Validation</h2>

<h3>Description</h3>

<p>Approximate leave-one-out cross-validation computed from the posterior
draws of the Markov chain Monte Carlo sampler as implemented in
fit_baclava().
</p>


<h3>Usage</h3>

<pre><code class="language-R">aloocv(
  object,
  data.clinical,
  data.assess,
  J.increment = 75L,
  J.max = 225L,
  ess.target = 50L,
  n.core = 1L,
  verbose = TRUE,
  lib = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The value object returned by fit_baclava().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.clinical</code></td>
<td>
<p>A data.frame object. The clinical data on which the
model is assessed. The data must be structured as for <code>fit_baclava()</code>;
specifically, it must contain
</p>

<ul>
<li>
<p>id: A character, numeric, or integer object. The unique participant
id to which the record pertains. Note these must include those provided in
<code>data.assess</code>. Must be only 1 record for each participant.
</p>
</li>
<li>
<p>age_entry: A numeric object. The age at time of entry into the study.
Note that this data is used to calculate the normalization; to expedite
numerical integration, it is recommended that the ages be rounded to
minimize repeated calculations. Optional input 'round.age.entry' can be
set to FALSE if this approximation is not desired; however, the
computation time will significantly increase.
</p>
</li>
<li>
<p>endpoint_type: A character object. Must be one of {"clinical",
"censored", "preclinical"}. Type "clinical" indicates that disease
was diagnosed in the clinical compartment (i.e., symptomatic). Type
"preclinical" indicates that disease was diagnosed in the pre-clinical
compartment (i.e., during an assessment). Type
"censored" indicates participant was censored.
</p>
</li>
<li>
<p>age_endpoint: A numeric object. The participant's age at the
time the endpoint was evaluated.
</p>
</li>
</ul>
<p>If the sensitivity parameter (beta) is arm-specific, an additional
column <code>arm</code> is required indicating the study arm to which each
participant is assigned. Similarly, if the preclinical Weibull distribution is
group-specific, an additional column <code>grp.rateP</code> is required. See Details
for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.assess</code></td>
<td>
<p>A data.frame object. The disease status assessment data
on which the model is assessed. The data must be structured as for
<code>fit_baclava()</code>; specifically, the data must contain
</p>

<ul>
<li>
<p>id: A character, numeric, or integer object. The unique participant
id to which the record pertains.
</p>
</li>
<li>
<p>age_assess: A numeric object. The participant's age at time of
assessment.
</p>
</li>
<li>
<p>disease_detected: An integer object. Must be binary 0/1, where
1 indicates that disease was detected at the assessment; 0 otherwise.
</p>
</li>
</ul>
<p>If the sensitivity parameter (beta) is screen-type specific, an additional
column <code>screen_type</code> is required indicating the type of each
screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J.increment</code></td>
<td>
<p>An integer object. The number of replicates of each
participant to generate in each iteration of the importance sampling procedure
to attain desired effective sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J.max</code></td>
<td>
<p>An integer object. The maximum number of samples to be
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ess.target</code></td>
<td>
<p>An integer object. The target effective sample size in the
importance sampling procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.core</code></td>
<td>
<p>An integer object. The function allows for the outer loop
across participants to be run in parallel using foreach().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical object. If TRUE, progress information will be
printed. This input will be ignored if n.core &gt; 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lib</code></td>
<td>
<p>An optional character vector allowing for library path
to be provided to cluster.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the predictive fit of a model.
For each individual and each MCMC draw, the function approximates the
marginal likelihood via importance sampling. It samples J.increment values
of the individual's latent variables using the Metropolis-Hastings proposal
distributions and computes the effective sample size (ESS) of the
importance sampling procedure. If the target ESS is not met, J.increment
additional samples are taken, and the ESS is re-evaluated.
This is repeated until either the ESS is
satisfied or J.max samples have been drawn.
</p>


<h3>Value</h3>

<p>A list object. Element <code>summary</code> contains the min, mean, and
the 1
likelihood; and the individual-level and estimated predictive fit.
Element <code>result</code> contains the likelihood, ESS, and J for each
MCMC sample for each participant.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(screen_data)

theta_0 &lt;- list("rate_H" = 7e-4, "shape_H" = 2.0,
                "rate_P" = 0.5  , "shape_P" = 1.0,
                "beta" = 0.9, psi = 0.4)
prior &lt;- list("rate_H" = 0.01, "shape_H" = 1,
              "rate_P" = 0.01, "shape_P" = 1,
              "a_psi" = 1/2 , "b_psi" = 1/2,
              "a_beta" = 38.5, "b_beta" = 5.8)

# This is for illustration only -- the number of MCMC samples should be
# significantly larger and the epsilon values should be tuned.
example &lt;- fit_baclava(data.assess = data.screen,
                       data.clinical = data.clinical,
                       t0 = 30.0,
                       theta_0 = theta_0,
                       prior = prior,
                       thin = 10L)

res &lt;- aloocv(example, data.clinical, data.screen)

</code></pre>


</div>