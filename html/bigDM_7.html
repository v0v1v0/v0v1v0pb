<div class="container">

<table style="width: 100%;"><tr>
<td>connect_subgraphs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Merge disjoint connected subgraphs</h2>

<h3>Description</h3>

<p>The function returns a neighbour list of class <code>nb</code> and its associated spatial adjacency matrix
computed by merging disjoint connected subgraphs through its nearest polygon centroids.
</p>


<h3>Usage</h3>

<pre><code class="language-R">connect_subgraphs(carto, ID.area = NULL, nb = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>carto</code></td>
<td>
<p>object of class <code>SpatialPolygonsDataFrame</code> or <code>sf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID.area</code></td>
<td>
<p>character vector of geographic identifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>optional argument with the neighbours list of class <code>nb</code>.
If <code>NULL</code> (default), this object is computed from the <code>carto</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical value (default <code>FALSE</code>), if <code>TRUE</code> then the computed neighbourhood graph is ploted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function first calls the <code>add_neighbour</code> function to search for isolated areas.
</p>


<h3>Value</h3>

<p>This function returns a list with the following two elements:
</p>

<ul>
<li> <p><code>nb</code>: the modified neighbours list
</p>
</li>
<li> <p><code>W</code>: associated spatial adjacency matrix of class <code>dgCMatrix</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(spdep)

## Load the Spain colorectal cancer mortality data ##
data(Carto_SpainMUN)

## Select the polygons (municipalities) of the 'Comunidad Valenciana' region ##
carto &lt;- Carto_SpainMUN[Carto_SpainMUN$region=="Comunidad Valenciana",]

carto.nb &lt;- poly2nb(carto)
n.comp.nb(carto.nb)$nc # 2 disjoint connected subgraphs

## Plot the spatial polygons and its neighbourhood graph
op &lt;- par(mfrow=c(1,2), pty="s")

plot(carto$geometry, main="Original neighbourhood graph")
plot(carto.nb, st_centroid(st_geometry(carto), of_largest_polygon=TRUE),
     pch=19, cex=0.5, col="red", add=TRUE)

## Use the 'connect_subgraphs' function ##
carto.mod &lt;- connect_subgraphs(carto=carto, ID.area="ID", nb=carto.nb, plot=TRUE)
title(main="Modified neighbourhood graph")

n.comp.nb(carto.mod$nb)$nc==1

par(op)

</code></pre>


</div>