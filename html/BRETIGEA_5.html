<div class="container">

<table style="width: 100%;"><tr>
<td>brainCells</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate brain cell type proportions in bulk expression data with marker genes.</h2>

<h3>Description</h3>

<p>This function uses marker genes estimated in a meta-analysis of brain cell type-associated RNA expression data sets, and uses them as input for the findCells cell type proportion estimation procedure pipeline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brainCells(
  inputMat,
  nMarker = 50,
  species = "combined",
  data_set = "mckenzie",
  celltypes = c("ast", "end", "mic", "neu", "oli", "opc"),
  method = "SVD",
  scale = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputMat</code></td>
<td>
<p>Gene expression data frame or matrix, with rownames corresponding to gene names, some of which are marker genes, and columns corresponding to samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMarker</code></td>
<td>
<p>The number of marker genes (that are present in your expression data set) to use in estimating the surrogate cell type proportion variable for each cell type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>By default, this function uses markers from combined human and mouse measurements, which are the most robust and reliable, as the gene expression patterns are very conserved between these two species. Other options are "human" and "mouse" for data specific to those species. Note that OPCs only have 500 gene symbols in this case, and are taken from only the Darmanis et al or Tasic et al data sets, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_set</code></td>
<td>
<p>Which data set the data should be derived from. Options are "mckenzie" (default), "kelley". Note that the "kelley" data set will ignore the "species" argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>celltypes</code></td>
<td>
<p>Character vector of which cell types to estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>To estimate the cell type proportions, can either use "PCA" or "SVD".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Whether or not to scale the gene expression data from each marker gene prior to using it as an input for dimension reduction.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A sample-by-cell type matrix of estimate cell type proportion variables.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ct_res = brainCells(aba_marker_expression, nMarker = 50, species = "combined")
cor.test(ct_res[, "mic"], as.numeric(aba_pheno_data$ihc_iba1_ffpe), method = "spearman")

</code></pre>


</div>