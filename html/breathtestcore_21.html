<div class="container">

<table style="width: 100%;"><tr>
<td>read_breathtest_excel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reads breathtest data in Excel format</h2>

<h3>Description</h3>

<p>Can read several formats of data sets in Excel, from
2 (<code>minute, pdr or dob</code> for 1 record) to 4 columns (<code>patient_id, 
group, minute, pdr or dob</code>). Conversion from dob to pdf is done for 
assuming 180 cm height and 75 kg weight.
See the example below with several sheets for supported formats
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_breathtest_excel(filename, sheet = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Name of Excel-file to be read</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheet</code></td>
<td>
<p>Name or number of Excel file to be read. When used with 
<code>read_any_breathtest</code>, the first sheet is always read. You must 
call  <code>read_breathtest_excel</code> explicitly to read other worksheets, as shown
in the example below.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Different from the other readXXX function, this returns a list
with a data frame, not a structure of <code>breathtest_data</code>. 
Pass result through <code>cleanup_data</code> to make it compatible with 
other formats.
</p>


<h3>Examples</h3>

<pre><code class="language-R">filename = btcore_file("ExcelSamples.xlsx")
sheets = readxl::excel_sheets(filename)
# First 4 lines of each sheet
for (sheet in sheets) {
  cat("\nSheet ", sheet,"\n")
  ex = readxl::read_excel(filename, sheet = sheet, n_max = 4)
  print(ex)
}  
# To get consistently formatted data from a sheet
bt_data = read_breathtest_excel(filename, sheets[6])
# 3 columns
str(bt_data)
bt_cleaned = cleanup_data(bt_data)
# 4 columns standard format
str(bt_cleaned)
</code></pre>


</div>