<div class="container">

<table style="width: 100%;"><tr>
<td>hyperparamest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain estimates of the hyperparameters of the BHMSMA model
</h2>

<h3>Description</h3>

<p><code>hyperparamest</code> computes the MLEs (maximum likelihood estimates) of the hyperparameters of the BHMSMA model using an empirical Bayes approach for multi-subject or single subject analyses, and returns the hyperparameters estimates along with their covariance matrix estimate (see References).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hyperparamest(n, grid, waveletcoefmat, analysis)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>The number of voxels in one row (or, one column) of the brain slice of interest. Must be a power of 2. The total number of voxels is <code>grid^2</code>. The maximum value of <code>grid</code> for this package is 512.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waveletcoefmat</code></td>
<td>
<p>A matrix of dimension <code>(n,grid^2-1)</code>, containing for each subject the wavelet coefficients of all levels stacked together (by the increasing order of resolution level). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysis</code></td>
<td>
<p>"multi" or "single", depending on whether performing multi-subject analysis or single subject analysis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hyperparam </code></td>
<td>
<p>A vector containing the estimates of the six hyperparameters of the BHMSMA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperparamVar </code></td>
<td>
<p>Estimated covariance matrix of the hyperparameters.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nilotpal Sanyal, Marco Ferreira
</p>
<p>Maintainer: Nilotpal Sanyal &lt;nilotpal.sanyal@gmail.com&gt;
</p>


<h3>References</h3>

<p>Sanyal, Nilotpal, and Ferreira, Marco A.R. (2012). Bayesian hierarchical multi-subject multiscale analysis of functional MRI data. Neuroimage, 63, 3, 1519-1531.
</p>


<h3>See Also</h3>

<p><code>waveletcoef</code>, <code>nlminb</code>, <code>postmixprob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 3
grid &lt;- 8
waveletcoefmat &lt;- array(dim=c(n,grid^2-1),
  rnorm(n*(grid^2-1)))
analysis &lt;- "multi"
hyperest &lt;- hyperparamest(n,grid,waveletcoefmat,analysis)
hyperest$hyperparam
# [1]  1.00000  1.00000  1.00000  1.00000  0.00000 28.37678
</code></pre>


</div>