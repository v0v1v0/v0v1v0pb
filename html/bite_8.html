<div class="container">

<table style="width: 100%;"><tr>
<td>marginal_lik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate marginal likelihood by thermodynamic integration (LTI)</h2>

<h3>Description</h3>

<p>Calculate the marginal likelihood from a logfile generated by <code>mcmc_bite</code> with thermodynamic integration (Lartillot and Philippe, 2006) or stepping stone (Xie et al., 2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">marginal_lik(mcmc.log, burnin = 0, method = "SS")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcmc.log</code></td>
<td>
<p>the output file of a <code>mcmc_bite</code> run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number or proportion of iteration to delete</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>one of "TI" for thermodynamic integration and "SS" for stepping stone integration (the default)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a length one numeric double giving the marginal likelihood of the model.
</p>


<h3>Author(s)</h3>

<p>Theo Gaboriau and Simon Joly
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Load test data
data(Anolis_traits)
data(Anolis_tree)
data(Anolis_map)

## Run a MCMC chain with thermodynamic Integration
set.seed(300)
my.jive &lt;- make_jive(Anolis_tree, Anolis_traits[,-3],
  model.priors = list(mean="BM", logvar="OU"))
bite_ex &lt;- tempdir()
logfile &lt;- sprintf("%s/my.jive_mcmc_TI.log", bite_ex)
mcmc_bite(my.jive, log.file=logfile, ncat=10, sampling.freq=10,
 print.freq=100, ngen=1000, burnin=0) 
 
## import the results in R
res &lt;- read.csv(logfile, header = TRUE, sep = "\t")
 
mlikTI &lt;- marginal_lik(res, burnin = 0.1, method = "TI")
mlikTI

mlikSS &lt;- marginal_lik(res, burnin = 0.1, method = "SS")
mlikSS
</code></pre>


</div>