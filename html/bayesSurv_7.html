<div class="container">

<table style="width: 100%;"><tr>
<td>bayesDensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Summary for the density estimate based on the mixture Bayesian AFT model.
</h2>

<h3>Description</h3>

<p>Function to summarize the results obtained using
<code>bayessurvreg1</code> function.
</p>
<p>Compute the conditional (given the number of mixture components) and
unconditional estimate of the density function based on the values
sampled using the reversible jumps MCMC (MCMC average evaluated in a
grid of values).
</p>
<p>Give also the values of each sampled density
evaluated at that grid (returned as the attribute of the resulting
object). Methods for printing and plotting are also provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayesDensity(dir, stgrid, centgrid, grid, n.grid = 100,
    skip = 0, by = 1, last.iter,
    standard = TRUE, center = TRUE, unstandard = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>directory where to search for files ‘mixmoment.sim’,
‘mweight.sim’, mmean.sim', ‘mvariance.sim’ with the McMC sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stgrid</code></td>
<td>
<p>grid of values at which the sampled standardized
densities are to be evaluated. If <code>missing</code>, the grid is
automatically computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centgrid</code></td>
<td>
<p>grid of values at which the sampled centered (but not
scaled) densities are to be evaluated. If <code>missing</code>. the grid
is automatically computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>grid of values at which the sampled densities are to be
evaluated. If <code>missing</code>,
the grid is guessed from the first 20 sampled mixtures as the sequence starting with the minimal
sampled mixture mean minus 3 standard deviations of the appropriate mixture
component, ending with the maximal sampled mixture mean plus 3
standard deviations of the appropriate mixture
component, of the length given by <code>n.grid</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.grid</code></td>
<td>
<p>the length of the grid if <code>grid = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>number of rows that should be skipped at the beginning of
each *.sim file with the stored sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>additional thinning of the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last.iter</code></td>
<td>
<p>index of the last row from *.sim files that should be
used. If not specified than it is set to the maximum available
determined according to the file <code>mixmoment.sim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>
<p>if <code>TRUE</code> then also standardized (zero mean,
unit variance) sampled densities are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>if <code>TRUE</code> then also centered (zero mean) sampled
densities are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unstandard</code></td>
<td>
<p>of <code>TRUE</code> then also original (unstandardized)
sampled densities are evaluated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>bayesDensity</code> is returned. This object is a
list and has potentially three components: <code>standard</code>,
<code>center</code>  and
<code>unstandard</code>. Each of these three components is a <code>data.frame</code>
with as many rows as number of grid points at which the density was
evaluated and with columns called ‘grid’, ‘unconditional’ and ‘k = 1’,
..., ‘k = k.max’ giving a predictive errr density, either averaged
over all sampled <code class="reqn">k</code>s (unconditional) or averaged over a
psecific number of mixture components.
</p>
<p>Additionally, the object of class <code>bayesDensity</code> has three
attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>a vector of length <code>1 + kmax</code> giving the
frequency of each <code class="reqn">k</code> in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moments</code></td>
<td>
<p>a <code>data.frame</code> with columns called ‘intercept’
and ‘scale’ giving the mean and variance of the sampled mixture at
each iteration of the McMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a <code>data.frame</code> with one column called ‘k’ giving
number of mixture components at each iteration.</p>
</td>
</tr>
</table>
<p>There exist methods to print and plot objects of the class <code>bayesDensity</code>.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Komárek, A. (2006).
<em>Accelerated Failure Time Models for Multivariate
Interval-Censored Data with Flexible Distributional Assumptions</em>.
PhD. Thesis, Katholieke Universiteit Leuven, Faculteit Wetenschappen.
</p>
<p>Komárek, A. and Lesaffre, E. (2007).
Bayesian accelerated failure time model for correlated interval-censored data
with a normal mixture as an error distribution.
<em>Statistica Sinica</em>, <b>17</b>, 549–569.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See the description of R commands for
## the models described in
## Komarek (2006),
## Komarek and Lesaffre (2007),
## 
## R commands available
## in the documentation
## directory of this package
## - ex-cgd.R and
##   https://www2.karlin.mff.cuni.cz/~komarek/software/bayesSurv/ex-cgd.pdf
##
## - ex-tandmobMixture.R and
##   https://www2.karlin.mff.cuni.cz/~komarek/software/bayesSurv/ex-tandmobMixture.pdf
## 
</code></pre>


</div>