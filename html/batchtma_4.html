<div class="container">

<table style="width: 100%;"><tr>
<td>plot_batch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot biomarkers by batch</h2>

<h3>Description</h3>

<p>To provide a simple visualization of potential batch
effects, <code>plot_batch</code> generates a Tukey
box plot overlaid by a jittered
dot plot, inspired by the Stata plugin <code>stripplot</code>.
</p>
<p>Boxes span from the 1st to the 3rd quartile; thick lines
indicate medians; whiskers span up to 1.5 times the
interquartile range; and asterisks indicate means.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_batch(
  data,
  marker,
  batch,
  color = NULL,
  maxlevels = 15,
  title = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>Variable indicating the biomarker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>
<p>Variable indicating the batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Optional: third variable to use for symbol
color and shape. For example, <code>color</code> can be used
to show differences in a confounder.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlevels</code></td>
<td>
<p>Optional: Maximum number of
levels for <code>color</code> parameter to accept as a discrete
variable, rather than a continuous variable.
Defaults to <code>15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Optional: character string that specifies plot
title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional: Passed on to <code>ggplot</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot2 object, which can be further
modified using standard ggplot2 functions. See examples.
</p>


<h3>References</h3>

<p>Cox NJ (2003). STRIPPLOT: Stata module for strip plots
(one-way dot plots). Statistical Software Components
S433401, Boston College Department of Economics,
revised 11 Oct 2020.
</p>
<p>Manimaran S, Selby HM, Okrah K, Ruberman C, Leek JT,
Quackenbush J, Haibe-Kains B, Bravo HC, Johnson WE (2016).
BatchQC: interactive software for evaluating sample
and batch effects in genomic data. Bioinformatics.
doi:10.1093/bioinformatics/btw538
</p>


<h3>See Also</h3>

<p>More powerful visualizations of batch effects exist
in the BatchQC package:
</p>
<p><a href="http://bioconductor.org/packages/release/bioc/html/BatchQC.html">http://bioconductor.org/packages/release/bioc/html/BatchQC.html</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Define example data
df &lt;- data.frame(
  tma = rep(1:2, times = 10),
  biomarker = rep(1:2, times = 10) +
    runif(max = 5, n = 20),
  confounder = rep(0:1, times = 10) +
    runif(max = 10, n = 20)
)

# Visualize batch effects:
plot_batch(
  data = df,
  marker = biomarker,
  batch = tma,
  color = confounder
)

# Label y-axis, changing graph like other ggplots:
plot_batch(
  data = df,
  marker = biomarker,
  batch = tma,
  color = confounder
) +
  ggplot2::labs(y = "Biomarker (variable 'noisy')")
</code></pre>


</div>