<div class="container">

<table style="width: 100%;"><tr>
<td>assign_behavior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assign behavior estimates to observations</h2>

<h3>Description</h3>

<p>Assign behavior estimates to observations
</p>


<h3>Usage</h3>

<pre><code class="language-R">assign_behavior(dat.orig, dat.seg.list, theta.estim.long, behav.names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat.orig</code></td>
<td>
<p>A data frame that contains all of the original data for all
animal IDs. Must be same as was used to originally segment the tracks. Must
have columns <code>obs</code> and <code>time1</code> generated by
<code>filter_time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat.seg.list</code></td>
<td>
<p>A list of data associated with each animal ID where names
of list elements are the ID names and tracks have already been segmented.
Must have columns <code>obs</code> and <code>time1</code> generated by
<code>filter_time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.estim.long</code></td>
<td>
<p>A data frame in long format where each observation
(<em>time1</em>) of each track segment (<em>tseg</em>) of each animal ID
(<em>id</em>) has separate rows for behavior proportion estimates per state.
Columns for behavior and proportion estimates should be labeled
<em>behavior</em> and <em>prop</em>, respectively. Date (in POSIXct format)
should also be included as a column labeled <em>date</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>behav.names</code></td>
<td>
<p>character. A vector of names to label each state (in
order).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame of all animal IDs where columns (with names from
<code>behav.names</code>) include proportions of each behavioral state per
observation, as well as a column that stores the dominant behavior within a
given track segment for which the observation belongs (<code>behav</code>). This
is merged with the original data frame <code>dat.orig</code>, so any observations
that were excluded (not at primary time interval) will show <code>NA</code> for
behavior estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

#load original and segmented data
data(tracks)
data(tracks.seg)

#convert segmented dataset into list
tracks.list&lt;- df_to_list(dat = tracks.seg, ind = "id")

#select only id, tseg, SL, and TA columns
tracks.seg2&lt;- tracks.seg[,c("id","tseg","SL","TA")]

#summarize data by track segment
obs&lt;- summarize_tsegs(dat = tracks.seg2, nbins = c(5,8))

#cluster data with LDA
res&lt;- cluster_segments(dat = obs, gamma1 = 0.1, alpha = 0.1, ngibbs = 1000,
                       nburn = 500, nmaxclust = 7, ndata.types = 2)

#Extract proportions of behaviors per track segment
theta.estim&lt;- extract_prop(res = res, ngibbs = 1000, nburn = 500, nmaxclust = 7)

#Create augmented matrix by replicating rows (tsegs) according to obs per tseg
theta.estim.long&lt;- expand_behavior(dat = tracks.seg, theta.estim = theta.estim, obs = obs,
                               nbehav = 3, behav.names = c("Encamped","ARS","Transit"),
                               behav.order = c(1,2,3))

#Run function
dat.out&lt;- assign_behavior(dat.orig = tracks, dat.seg.list = tracks.list,
                          theta.estim.long = theta.estim.long,
                          behav.names = c("Encamped","ARS","Transit"))



</code></pre>


</div>