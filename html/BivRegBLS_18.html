<div class="container">

<table style="width: 100%;"><tr>
<td>MD.horiz.lines</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Tolerance intervals in a (M,D) plot</h2>

<h3>Description</h3>

<p>Calculate agreement interval and tolerance intervals (bounded by 2 horizontal lines) for the differences (D=Y-X) in a (M,D) plot (also called Bland-Altman plot).</p>


<h3>Usage</h3>

<pre><code class="language-R">MD.horiz.lines(data = NULL, xcol = 1, ycol = 2,
               pred.level = 0.95, TI.conf.level = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1) of the tolerance intervals (beta expectation (type I) and beta gamma content (type II)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TI.conf.level</code></td>
<td>
<p> a numeric value for the confidence level of the beta gamma content tolerance interval (tolerance interval type II).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data argument is mandatory while other arguments are optional. If the data are replicated, the tolerance intervals predict where a future single difference (Di=Yi-Xi) will lie (and not an average difference). Tolerance intervals are better (than agreement interval) and should be preferred. The tolerance intervals are calculated on the univariate distribution of the differences (Di). These intervals are valid under the assumption that there is no proportional bias. If a pattern is observed, the <code>CBLS</code> function (CBLS regression) must be used (with its predictive intervals).</p>


<h3>Value</h3>

<p>A MD.horiz.lines class object: a list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data.MD</code></td>
<td>
<p> a table with the means ((X+Y)/2) and differences (Y-X).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Table.Differences</code></td>
<td>
<p> a table with one row and several descriptive statistics: the mean of the differences, the standard deviation of the mean difference (Di=Yi-Xi) and the standard deviation for a single difference (Yik-Xik), the minimum, 1st quartile, median, 3rd quartile, maximum and number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Intervals.horiz.lines</code></td>
<td>
<p> a table with 3 rows for the agreement interval, the beta expectation tolerance interval and the beta gamma content tolerance interval, with their interpretation (columns).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.</p>


<h3>See Also</h3>

<p><code>CBLS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BivRegBLS)
data(SBP)
res.MD.horiz=MD.horiz.lines(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,pred.level=0.95)
res.MD.horiz$Intervals.horiz.lines
</code></pre>


</div>