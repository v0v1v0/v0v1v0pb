<div class="container">

<table style="width: 100%;"><tr>
<td>barnard.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Barnard's Unconditional Test</h2>

<h3>Description</h3>

<p>Barnard's unconditional test for superiority applied to 2x2 contingency tables
using Score or Wald statistics for the difference between two binomial proportions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">barnard.test(n1, n2, n3, n4, dp = 0.001, pooled = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n1,n2,n3,n4</code></td>
<td>
<p> Elements of the 2x2 contingency table </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p> The resolution to search for the nuisance parameter </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pooled</code></td>
<td>
<p> Z statistic with pooled (Score) or unpooled (Wald) variance </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a 2x2 contingency table, such as <code class="reqn">X=[n_1,n_2;n_3,n_4]</code>, the normalized difference in proportions between the two categories, given in each column, can be written with pooled variance (Score statistic) as
</p>
<p style="text-align: center;"><code class="reqn">T(X)=\frac{\hat{p}_2-\hat{p}_1}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{c_1}+\frac{1}{c_2})}},</code>
</p>

<p>where <code class="reqn">\hat{p}=(n_1+n_3)/(n_1+n_2+n_3+n_4)</code>, <code class="reqn">\hat{p}_2=n_2/(n_2+n_4)</code>, <code class="reqn">\hat{p}_1=n_1/(n_1+n_3)</code>, <code class="reqn">c_1=n_1+n_3</code> and <code class="reqn">c_2=n_2+n_4</code>. Alternatively, with unpooled variance (Wald statistic), the difference in proportions can we written as
</p>
<p style="text-align: center;"><code class="reqn">T(X)=\frac{\hat{p}_2-\hat{p}_1}{\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{c_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{c_2}}}.</code>
</p>

<p>The probability of observing <code class="reqn">X</code> is
</p>
<p style="text-align: center;"><code class="reqn">P(X)=\frac{c_1!c_2!}{n_1!n_2!n_3!n_4!}p^{n_1+n_2}(1-p)^{n_3+n_4},</code>
</p>

<p>where <code class="reqn">p</code> is the unknown nuisance parameter.
</p>
<p>Barnard's test considers all tables with category sizes <code class="reqn">c_1</code> and <code class="reqn">c_2</code> for a given <code class="reqn">p</code>. The p-value is the sum of probabilities of the tables having a score in the rejection region, e.g. having significantly large difference in proportions for a two-sided test. The p-value of the test is the maximum p-value calculated over all <code class="reqn">p</code> between 0 and 1.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>statistic.table </code></td>
<td>
<p>The contingency tables considered in the analysis represented by 'n1' and 'n2', their scores, and whether they are included in the one-sided (1), two-sided (2) tests, or not included at all (0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuisance.matrix </code></td>
<td>
<p>Nuisance parameters, <code class="reqn">p</code>, and the corresponding p-values for both one- and two-sided tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp </code></td>
<td>
<p>The resolution of the search space for the nuisance parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contingency.matrix </code></td>
<td>
<p>The observed 2x2 contingency table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative </code></td>
<td>
<p>One sided or two sided test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic </code></td>
<td>
<p>The standardized difference between the observed proportions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuisance.parameter </code></td>
<td>
<p>The nuisance parameter where the p-value is maximized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value </code></td>
<td>
<p>The p-value for the observed contingency table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pooled </code></td>
<td>
<p>Variance estimator of the Z statistic</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> I am indebted to Peter Calhoun for helping to test the performance and the accuracy of the code. I also thank Rodrigo Duprat, Long Qu, and Nicolas Sounac for their valuable comments. The accuracy has been tested with respect to the existing MATLAB and R implementations as well as the results of StatXact. I have largely been influenced by the works of Trujillo-Ortiz etal. (2004), Cardillo G. (2009), and Galili T. (2010). </p>


<h3>Author(s)</h3>

 
<p>Kamil Erguler, Post-doctoral Fellow, EEWRC, The Cyprus Institute <a href="mailto:k.erguler@cyi.ac.cy">k.erguler@cyi.ac.cy</a>
</p>


<h3>References</h3>


<ol>
<li>
<p> Barnard, G.A. (1945) A new test for 2x2 tables. <em>Nature</em>, 156:177.
</p>
</li>
<li>
<p> Barnard, G.A. (1947) Significance tests for 2x2 tables. <em>Biometrika</em>, 34:123-138.
</p>
</li>
<li>
<p> Suissa, S. and Shuster, J. J. (1985), Exact Unconditional Sample Sizes for the 2x2 Binomial Trial, Journal of the Royal Statistical Society, Ser. A, 148, 317-327.
</p>
</li>
<li>
<p> Cardillo G. (2009) MyBarnard: a very compact routine for Barnard's exact test on 2x2 matrix. URL <a href="http://www.mathworks.com/matlabcentral/fileexchange/25760">http://www.mathworks.com/matlabcentral/fileexchange/25760</a>
</p>
</li>
<li>
<p> Galili T. (2010) URL <a href="http://www.r-statistics.com/2010/02/barnards-exact-test-a-powerful-alternative-for-fishers-exact-test-implemented-in-r/">http://www.r-statistics.com/2010/02/barnards-exact-test-a-powerful-alternative-for-fishers-exact-test-implemented-in-r/</a>
</p>
</li>
<li>
<p> Lin C.Y., Yang M.C. (2009) Improved p-value tests for comparing two independent binomial proportions. <em>Communications in Statistics-Simulation and Computation</em>, 38(1):78-91.
</p>
</li>
<li>
<p> Trujillo-Ortiz, A., R. Hernandez-Walls, A. Castro-Perez, L. Rodriguez-Cardozo N.A. Ramos-Delgado and R. Garcia-Sanchez. (2004). Barnardextest:Barnard's Exact Probability Test. A MATLAB file. [WWW document]. URL <a href="http://www.mathworks.com/">http://www.mathworks.com/</a>
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">barnard.test(8,14,1,3)

## Plotting the search for the nuisance parameter for a one-sided test
bt&lt;-barnard.test(8,14,1,3)
plot(bt$nuisance.matrix[,1:2],
     t="l",xlab="nuisance parameter",ylab="p-value")

## Plotting the tables included in the p-value
bt&lt;-barnard.test(40,14,10,30)
bts&lt;-bt$statistic.table
plot(bts[,1],bts[,2],
     col=hsv(bts[,4]/4,1,1),
     t="p",xlab="n1",ylab="n2")

## Plotting the difference between pooled and unpooled tests
bts&lt;-barnard.test(40,14,10,30,pooled=TRUE)$statistic.table
btw&lt;-barnard.test(40,14,10,30,pooled=FALSE)$statistic.table
plot(bts[,1],bts[,2],
     col=c("black","white")[1+as.numeric(bts[,4]==btw[,4])],
     t="p",xlab="n1",ylab="n2")
</code></pre>


</div>