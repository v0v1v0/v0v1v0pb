<div class="container">

<table style="width: 100%;"><tr>
<td>addBAMMshifts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add <code>BAMM</code>-inferred rate shifts to a phylogeny plot</h2>

<h3>Description</h3>

<p>Adds symbols to a plotted tree to mark the location(s) where
there is a shift in the macroevolutionary dynamics of diversification
or trait evolution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">addBAMMshifts(
  ephy,
  index = 1,
  method = "phylogram",
  cex = 1,
  pch = 21,
  col = 1,
  bg = 2,
  msp = NULL,
  shiftnodes = NULL,
  par.reset = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>An integer indicating which posterior sample to use for
adding shifts to the plotted tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the method used in plotting.
Must be "polar" or "phylogram".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>A numeric indicating the character expansion ("size") of the
plotted points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>An integer indicating the choice of plotting symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>An integer or character string indicating the border color of
the plotting symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>An integer or character string indicating the background color
of the plotting symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msp</code></td>
<td>
<p>If not <code>NULL</code>, an object of class <code>phylo</code> where each
branch length is equal to the marginal probability of a shift
occurring on that branch. Plotted points corresponding to shifts will
be sized by these probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftnodes</code></td>
<td>
<p>An optional vector of node numbers indicating the
locations of shifts to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.reset</code></td>
<td>
<p>A logical indicating whether to reset the graphical
parameters before exiting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>points</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Any given sample from the posterior distribution sampled using
<code>BAMM</code> contains a potentially unique configuration of rate shifts
and associated parameters. There is no single "best" rate shift, but
rather a set of shift configurations (and associated parameters) -
along with their relative probabilities - sampled with MCMC. This
function enables the user to plot the locations of shifts sampled with
<code>BAMM</code> for a given sample from the posterior. 
</p>
<p>If the <code>bammdata</code> object contains just a single sample, these
shifts will be plotted regardless of the value of <code>index</code>.
</p>


<h3>Note</h3>

<p>If a <code>shiftnodes</code> argument is passed care should be taken to
ensure that the nodes are in the same order as in the event data for
the sample index.
</p>


<h3>Author(s)</h3>

<p>Mike Grundler
</p>


<h3>See Also</h3>

<p><code>getShiftNodesFromIndex</code>, <code>plot.bammdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.25, nsamples = 500)

# adding shifts to tree for specific posterior samples
plot(ed, method="polar")
addBAMMshifts(ed, index=5, "polar")

# multi-panel plotting and adding shifts
par(mfrow=c(2,3),mar=c(5,1,1,1))
samples = sample(1:length(ed$eventData), 6)
for (i in 1:6) {
  sed &lt;- subsetEventData(ed, samples[i])
  plot(sed, par.reset=FALSE)
  addBAMMshifts(sed,index=1,method="phylogram",par.reset=FALSE)	
}
</code></pre>


</div>