<div class="container">

<table style="width: 100%;"><tr>
<td>ttestBF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for Bayesian analysis of one- and two-sample designs</h2>

<h3>Description</h3>

<p>This function computes Bayes factors, or samples from the posterior, for
one- and two-sample designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ttestBF(
  x = NULL,
  y = NULL,
  formula = NULL,
  mu = 0,
  nullInterval = NULL,
  paired = FALSE,
  data = NULL,
  rscale = "medium",
  posterior = FALSE,
  callback = function(...) as.integer(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of observations for the first (or only) group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of observations for the second group (or condition, for
paired)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>for independent-group designs, a (optional) formula
describing the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>for one-sample and paired designs, the null value of the mean (or
mean difference)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullInterval</code></td>
<td>
<p>optional vector of length 2 containing lower and upper bounds of an interval hypothesis to test, in standardized units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>if <code>TRUE</code>, observations are paired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>for use with <code>formula</code>, a data frame containing all the
data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rscale</code></td>
<td>
<p>prior scale.  A number of preset values can be given as
strings; see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>if <code>TRUE</code>, return samples from the posterior instead
of Bayes factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Bayes factor provided by <code>ttestBF</code> tests the null hypothesis that
the mean (or mean difference) of a normal population is <code class="reqn">\mu_0</code>
(argument <code>mu</code>). Specifically, the Bayes factor compares two
hypotheses: that the standardized effect size is 0, or that the standardized
effect size is not 0. For one-sample tests, the standardized effect size is
<code class="reqn">(\mu-\mu_0)/\sigma</code>; for two sample tests, the
standardized effect size is <code class="reqn">(\mu_2-\mu_1)/\sigma</code>.
</p>
<p>A noninformative Jeffreys prior is placed on the variance of the normal
population, while a Cauchy prior is placed on the standardized effect size.
The <code>rscale</code> argument controls the scale of the prior distribution,
with <code>rscale=1</code> yielding a standard Cauchy prior. See the references
below for more details.
</p>
<p>For the <code>rscale</code> argument, several named values are recognized:
"medium", "wide", and "ultrawide". These correspond
to <code class="reqn">r</code> scale values of <code class="reqn">\sqrt{2}/2</code>, 1, and <code class="reqn">\sqrt{2}</code>
respectively.
</p>
<p>The Bayes factor is computed via Gaussian quadrature.
</p>


<h3>Value</h3>

<p>If <code>posterior</code> is <code>FALSE</code>, an object of class
<code>BFBayesFactor</code> containing the computed model comparisons is
returned. If <code>nullInterval</code> is defined, then two Bayes factors will
be computed: The Bayes factor for the interval against the null hypothesis
that the standardized effect is 0, and the corresponding Bayes factor for
the compliment of the interval.
</p>
<p>If <code>posterior</code> is <code>TRUE</code>, an object of class <code>BFmcmc</code>,
containing MCMC samples from the posterior is returned.
</p>


<h3>Note</h3>

<p>The default priors have changed from 1 to <code class="reqn">\sqrt{2}/2</code>. The
factor of <code class="reqn">\sqrt{2}</code>  is to be consistent
with Morey et al. (2011) and
Rouder et al. (2012), and the factor of <code class="reqn">1/2</code> in both is to better scale the
expected effect sizes; the previous scaling put more weight on larger
effect sizes. To obtain the same Bayes factors as Rouder et al. (2009),
change the prior scale to 1.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Morey, R. D., Rouder, J. N., Pratte, M. S., &amp; Speckman, P. L.
(2011). Using MCMC chain outputs to efficiently estimate Bayes factors.
Journal of Mathematical Psychology, 55, 368-378
</p>
<p>Morey, R. D. &amp; Rouder, J. N. (2011). Bayes Factor Approaches for Testing
Interval Null Hypotheses. Psychological Methods, 16, 406-419
</p>
<p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G.
(2009). Bayesian t-tests for accepting and rejecting the null hypothesis.
Psychonomic Bulletin &amp; Review, 16, 225-237
</p>


<h3>See Also</h3>

<p><code>integrate</code>, <code>t.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sleep data from t test example
data(sleep)
plot(extra ~ group, data = sleep)

## paired t test
ttestBF(x = sleep$extra[sleep$group==1], y = sleep$extra[sleep$group==2], paired=TRUE)

## Sample from the corresponding posterior distribution
samples = ttestBF(x = sleep$extra[sleep$group==1],
           y = sleep$extra[sleep$group==2], paired=TRUE,
           posterior = TRUE, iterations = 1000)
plot(samples[,"mu"])
</code></pre>


</div>