<div class="container">

<table style="width: 100%;"><tr>
<td>turtles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Turtles Data from Janzen, Tucker, and Paukstis (2000)</h2>

<h3>Description</h3>

<p>This data set contains information about 244 newborn turtles from 31
different clutches. For each turtle, the data set includes information about
survival status (column <code>y</code>; 0 = died, 1 = survived), birth weight in
grams (column <code>x</code>), and clutch (family) membership (column
<code>clutch</code>; an integer between one and 31). The clutches have been ordered
according to mean birth weight.
</p>


<h3>Usage</h3>

<pre><code class="language-R">turtles
</code></pre>


<h3>Format</h3>

<p>A data.frame with 244 rows and 3 variables.
</p>


<h3>Source</h3>

<p>Janzen, F. J., Tucker,  J. K., &amp; Paukstis, G. L. (2000). Experimental
analysis of an early life-history stage: Selection on size of hatchling
turtles. <em>Ecology, 81(8)</em>, 2290-2304.
doi: <a href="https://doi.org/10.2307/177115">10.2307/177115</a>
</p>
<p>Overstall, A. M., &amp; Forster, J. J. (2010). Default Bayesian model
determination methods for generalised linear mixed models.
<em>Computational Statistics &amp; Data Analysis, 54</em>, 3269-3288.
doi: <a href="https://doi.org/10.1016/j.csda.2010.03.008">10.1016/j.csda.2010.03.008</a>
</p>
<p>Sinharay, S., &amp; Stern, H. S. (2005). An empirical comparison of methods for
computing Bayes factors in generalized linear mixed models. <em>Journal
of Computational and Graphical Statistics, 14(2)</em>, 415-435.
doi: <a href="https://doi.org/10.1198/106186005X47471">10.1198/106186005X47471</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

################################################################################
# BAYESIAN GENERALIZED LINEAR MIXED MODEL (PROBIT REGRESSION)
################################################################################

library(bridgesampling)
library(rstan)

data("turtles")

#-------------------------------------------------------------------------------
# plot data
#-------------------------------------------------------------------------------

# reproduce Figure 1 from Sinharay &amp; Stern (2005)
xticks &lt;- pretty(turtles$clutch)
yticks &lt;- pretty(turtles$x)

plot(1, type = "n", axes = FALSE, ylab = "", xlab = "", xlim = range(xticks),
     ylim =  range(yticks))
points(turtles$clutch, turtles$x, pch = ifelse(turtles$y, 21, 4), cex = 1.3,
       col = ifelse(turtles$y, "black", "darkred"), bg = "grey", lwd = 1.3)
axis(1, cex.axis = 1.4)
mtext("Clutch Identifier", side = 1, line = 2.9, cex = 1.8)
axis(2, las = 1, cex.axis = 1.4)
mtext("Birth Weight (Grams)", side = 2, line = 2.6, cex = 1.8)

#-------------------------------------------------------------------------------
# Analysis: Natural Selection Study (compute same BF as Sinharay &amp; Stern, 2005)
#-------------------------------------------------------------------------------

### H0 (model without random intercepts) ###
H0_code &lt;-
"data {
  int&lt;lower = 1&gt; N;
  int&lt;lower = 0, upper = 1&gt; y[N];
  real&lt;lower = 0&gt; x[N];
}
parameters {
  real alpha0_raw;
  real alpha1_raw;
}
transformed parameters {
  real alpha0 = sqrt(10.0) * alpha0_raw;
  real alpha1 = sqrt(10.0) * alpha1_raw;
}
model {
  // priors
  target += normal_lpdf(alpha0_raw | 0, 1);
  target += normal_lpdf(alpha1_raw | 0, 1);

  // likelihood
  for (i in 1:N) {
    target += bernoulli_lpmf(y[i] | Phi(alpha0 + alpha1 * x[i]));
  }
}"

### H1 (model with random intercepts) ###
H1_code &lt;-
"data {
  int&lt;lower = 1&gt; N;
  int&lt;lower = 0, upper = 1&gt; y[N];
  real&lt;lower = 0&gt; x[N];
  int&lt;lower = 1&gt; C;
  int&lt;lower = 1, upper = C&gt; clutch[N];
}
parameters {
  real alpha0_raw;
  real alpha1_raw;
  vector[C] b_raw;
  real&lt;lower = 0&gt; sigma2;
}
transformed parameters {
  vector[C] b;
  real&lt;lower = 0&gt; sigma = sqrt(sigma2);
  real alpha0 = sqrt(10.0) * alpha0_raw;
  real alpha1 = sqrt(10.0) * alpha1_raw;
  b = sigma * b_raw;
}
model {
  // priors
  target += - 2 * log(1 + sigma2); // p(sigma2) = 1 / (1 + sigma2) ^ 2
  target += normal_lpdf(alpha0_raw | 0, 1);
  target += normal_lpdf(alpha1_raw | 0, 1);

  // random effects
  target += normal_lpdf(b_raw | 0, 1);

  // likelihood
  for (i in 1:N) {
    target += bernoulli_lpmf(y[i] | Phi(alpha0 + alpha1 * x[i] + b[clutch[i]]));
  }
}"

set.seed(1)
### fit models ###
stanfit_H0 &lt;- stan(model_code = H0_code,
                   data = list(y = turtles$y, x = turtles$x, N = nrow(turtles)),
                   iter = 15500, warmup = 500, chains = 4, seed = 1)
stanfit_H1 &lt;- stan(model_code = H1_code,
                   data = list(y = turtles$y, x = turtles$x, N = nrow(turtles),
                               C = max(turtles$clutch), clutch = turtles$clutch),
                   iter = 15500, warmup = 500, chains = 4, seed = 1)

set.seed(1)
### compute (log) marginal likelihoods ###
bridge_H0 &lt;- bridge_sampler(stanfit_H0)
bridge_H1 &lt;- bridge_sampler(stanfit_H1)

### compute approximate percentage errors ###
error_measures(bridge_H0)$percentage
error_measures(bridge_H1)$percentage

### summary ###
summary(bridge_H0)
summary(bridge_H1)

### compute Bayes factor ("true" value: BF01 = 1.273) ###
bf(bridge_H0, bridge_H1)


## End(Not run)
</code></pre>


</div>