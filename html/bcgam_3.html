<div class="container">

<table style="width: 100%;"><tr>
<td>persp.bcgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>3D plots for <span class="pkg">bcgam</span> fits</h2>

<h3>Description</h3>

<p>3D plots of fitted surface with credible interval estimates based on a <code>bcgam</code> object and two non-parametrically
modelled predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bcgam'
persp(x, x1, x2, parameter = "mu", level = 0.95,
  x1.grid = 10, x2.grid = 10, lty = 1, lty.inter = 1,
  ticktype = "detailed", col = 4, col.inter = col, surf.inter = TRUE,
  zlim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class inheriting from "bcgam".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>A non-parametrically modelled predictor in a bcgam fit. The predictor in the <code class="reqn">x</code> axis. There is no default variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>A non-parametrically modelled predictor in a bcgam fit. The predictor in the <code class="reqn">y</code> axis. There is no default variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>The type of parameter to be plotted. If parameter=<code>"eta"</code>, then the systematic component
<code class="reqn">\eta</code> is plotted. If parameter=<code>"mu"</code>, then the mean value <code class="reqn">\mu</code> obtained by transforming
<code class="reqn">\eta</code> using the inverse of the link function is plotted. The default is <code>"mu"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Tolerance/credible level. The default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1.grid</code></td>
<td>
<p>A positive integer that specifies how dense the <code class="reqn">x</code> grid will be. The default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2.grid</code></td>
<td>
<p>A positive integer that specifies how dense the <code class="reqn">y</code> grid will be. The default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>What type of surface edges should be drawn for fitted values. The default is a solid line (<code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.inter</code></td>
<td>
<p>What type of surface edges should be drawn for interval estimates. The default is a solid line (<code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticktype</code></td>
<td>
<p>character: "detailed" draws normal ticks; "simple" draws just an arrow parallel to the
axis to indicate direction of increase. The default is <code>"detailed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color of fitted surface. The default is blue (<code>4</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.inter</code></td>
<td>
<p>Color of interval estimates. If not specified, it takes the
same value as <code>col</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surf.inter</code></td>
<td>
<p>Indicator to draw interval estimates (<code>"TRUE"</code>) or not (<code>"FALSE"</code>). 
The default is <code>"TRUE"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>The <code>z</code> limits of the plot. If <code>zlim=NULL</code> and <code>surf.inter="TRUE"</code>, 
then the minimum value of the lower bound estimates and the maximum value of the upper bound estimates are used.
If <code>zlim=NULL</code> and <code>surf.inter="FALSE"</code>, then the minimum and maximum values of the fitted surface are used.
The default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>persp.bcgam</code> produces 3D plots based on the <code>bcgam</code> object. Interval
estimates are based on the specified <code>level</code>. 
</p>
<p>If there are more than two non-parametrically modelled predictors,
then these will be evaluated at the largest values that are smaller than or equal 
to their median values. Categorical covariates will be evaluated at their mode. Also,
continuous covariates will be evaluated at the largest values that are smaller than
or equal to their median values.
</p>
<p>This routine creates 3D plots based on the posterior distribution in the <code>bcgam</code> object.
</p>


<h3>Author(s)</h3>

<p>Cristian Oliva-Aviles and Mary C. Meyer
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
n&lt;-50
x1&lt;-(1:n/n)^{1/3}
x2&lt;-log(1:n/n)
z&lt;-as.factor(rbinom(n, 1, 0.6))
eta&lt;-x1+x2+0.2*as.numeric(z)+rnorm(n, sd=0.2)
mu&lt;-exp(eta)/(1+exp(eta))
y&lt;-(mu&lt;0.6)

bcgam.fit &lt;- bcgam(y~sm.incr(x1)+sm.conc(x2, numknots=8)+z, nloop=10000, family="binomial")
persp(bcgam.fit, x1, x2, parameter="eta", col.inter=2, level=0.90, theta=-55)

## End(Not run)
</code></pre>


</div>