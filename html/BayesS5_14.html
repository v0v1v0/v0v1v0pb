<div class="container">

<table style="width: 100%;"><tr>
<td>S5_additive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simplified shotgun stochastic search algorithm with screening (S5) for additive models
</h2>

<h3>Description</h3>

<p>This is the Simplified Shotgun Stochastic Search with Screening (S5) for high-dimensonal Bayesian variable selection under nonparameteric additive models, which is considered in "Nonlocal Functional Priors for Nonparametric Hypothesis Testing and High-dimensional Model Selection" by Shin and Bhattacharya (2020+). This function utilizes the inverse moment nonlocal functional prior, and see Shin and Bhattacharya (2020+) for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">S5_additive(X, y, K=5, model, tuning = 0.5*nrow(X), tem, ITER = 20, S = 30, C0 = 5, 
verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>the covariate matrix (a standardization is recommneded for nonlocal priors).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a response variable. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>

<p>the degree of freedom for the B-spline basis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>a model prior; Uniform or Bernoulli_Uniform. The default is Bernoulli_Uniform
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning</code></td>
<td>

<p>a tuning parameter for the objective function (tau for the inverse moment prior). The default is 0.5*n.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tem</code></td>
<td>

<p>a temperature schedule. The default is seq(0.4,1,length.out=20)^-2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ITER</code></td>
<td>

<p>the number of iterations in each temperature; default is 20.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>a screening size of variables; default is 30.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0</code></td>
<td>

<p>a number of repetition of  the S5 algorithm C0 times,default is 2. When the total number of variables is huge and real data sets are considered, using a large number of C0 is recommended, e.g., C0=5.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>if TRUE, the function prints the currnet status of the S5 in each temperature; the default is TRUE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the S5 (Shin et al., 2018), you will get all the models searched by S5 algorithm, and their corresponding log (unnormalized) posterior probabilities, and also this function can receive searched model for g-prior,piMoM,and peMoM. 
</p>
<p>Unlike "S5" function that requires an extra step to get more information of the computation procedure, this function provides full information of the results. 
</p>


<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>GAM</code></td>
<td>
<p> the binary vaiables of searched models by S5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OBJ</code></td>
<td>
<p> the corresponding log (unnormalized) posterior probability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p> the matrix of B-spline basis functions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Knots</code></td>
<td>
<p> the boundaries of knots used in generating the B-spline matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p> the degree of freedom of the B-spline basis.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post</code></td>
<td>
<p>the corresponding (normalized) posterior model probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg.prob</code></td>
<td>
<p>the marginal inclusion probabilities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.MAP</code></td>
<td>
<p>the selected variables from the MAP model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.marg</code></td>
<td>
<p>the selected variables whose marginal inclusion probability is larger than 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hppm.prob</code></td>
<td>
<p>the posterior probability of the MAP model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning</code></td>
<td>
<p>the tuning parameter used in the model selection</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Shin Minsuk and Ruoxuan Tian
</p>


<h3>References</h3>

<p>Shin, M. and  Bhattacharya, A.(2020) Nonlocal Functional Priors for Nonparametric Hypothesis Testing and High-dimensional  Model Selection. 
</p>
<p>Shin, M., Bhattacharya, A., Johnson V. E. (2018) A Scalable Bayesian Variable Selection Using Nonlocal Prior Densities in Ultrahigh-dimensional Settings, under revision in Statistica Sinica. 
</p>


<h3>See Also</h3>

<p><code>result</code>, <code>S5_parallel</code>,  <code>SSS</code>  

</p>


<h3>Examples</h3>

<pre><code class="language-R">p0 = 500
n0 = 200

X = matrix(runif(n0*p0,-2,2),n0,p0)
mu = X[,1]^2 + 2*sin(X[,2]*2) + 2*cos(X[,3]*2) + X[,4]
y = mu + rnorm(n0)
X = scale(X)
y = as.vector(y)

#fit_additive = S5_additive(X,y, tuning = 0.1*ncol(X))
#print(fit_additive$ind.hppm) # the MAP model 
#print(fit_additive$hppm.prob) # the posterior probability of the hppm 
#plot(fit_additive$marg.prob,ylim=c(0,1),ylab="marginal inclusion probability") 
# the marginal inclusion probability 
</code></pre>


</div>