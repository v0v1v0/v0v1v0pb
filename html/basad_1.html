<div class="container">

<table style="width: 100%;"><tr>
<td>basad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian variable selection with shrinking and diffusing priors</h2>

<h3>Description</h3>

<p>This function performs the Bayesian variable selection procedure with shrinking and diffusing priors via Gibbs sampling. Three different prior options placed on the coefficients are provided: Gaussian, Student's t, Laplace. The posterior estimates of coefficients are returned and the final model is selected either by using the "BIC" criterion or the median probability model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">basad(x = NULL, y = NULL, K = -1, df = 5, nburn = 1000, niter = 1000,
        alternative = FALSE, verbose = FALSE, nsplit = 20, tau0 = NULL, tau1 = NULL,
        prior.dist = "Gauss", select.cri = "median", BIC.maxsize = 20,
        standardize = TRUE, intercept = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The matrix or data frame of covariates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>An initial value for the number of active covariates in the model. This value is related to the prior probability that a covariate is nonzero. If <code>K</code> is not specified greater than 3, this prior probability will be estimated by a Beta prior using Gibbs sampling (see details below).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The degrees of freedom of t prior when <code>prior.dist == "t"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>The number of iterations for burn-in. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>The number of iterations for estimation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>If <code>TRUE</code>, an alternative sampling scheme from Bhattacharya will be used which can accelerate the speed of the algorithm for very large p. However, when using block updating (by setting <code>nsplit</code> to be greater than 1) this alternative sampling will not be invoked.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, verbose output is sent to the terminal. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsplit</code></td>
<td>
<p>Numbers of splits for the block updating scheme. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau0</code></td>
<td>
<p> The scale of the prior distribution for inactive coefficients (see details below). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau1</code></td>
<td>
<p> The scale of the prior distribution for active coefficients (see details below). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.dist</code></td>
<td>
<p>Choice of the base distribution for spike and slab priors. If <code>prior.dist="t"</code>, the algorithm will place Student's t prior for regression coefficients. If <code>prior.dist="Laplace"</code>, the algorithm will place Laplace prior. Otherwise, it will place the default Gaussian priors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.cri</code></td>
<td>
<p>Model selection criterion. If <code>select.cri="median"</code>, the algorithm will use the median probability model to select the active variables. If <code> select.cri="BIC"</code>, the algorithm will use the BIC criterion to select the active variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC.maxsize</code></td>
<td>
<p> The maximum number of variables that are chosen to apply BIC criterion based on the ranking of their marginal posterior probabilities. If the dimension is less than the default value of 20, all the variables will be considered to apply BIC. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Option for standardization of the covariates. Default is <code>standardize = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Option to include an intercept in the model. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the package, the regression coefficients have following hierarchical structure:
</p>
<p style="text-align: center;"><code class="reqn"> \beta | ( Z = 0, \sigma^2 )  = N(0, \tau_0^2 \sigma^2 ),  \beta | ( Z = 1, \sigma^2 )  = N(0,  \tau_1^2 \sigma^2 )</code>
</p>

<p>where the latent variable <code class="reqn">Z_i</code> of value 0 or 1 indicates whether <code class="reqn">i</code>th variable is in the slab and spike part of the prior. The package provides different prior choices for the coefficients: Gaussian, Student's t, Laplace. Through setting the parameter <code>prior.dist</code>, the coefficients will have the corresponding prior densities as follows:
</p>
<p>1. The Gaussian priors case:
</p>
<p style="text-align: center;"><code class="reqn"> \beta | ( Z = k, \sigma^2 ) =  \frac{1}{ \sqrt{ 2 \pi \tau^2_k \sigma^2} }  e^{ - \frac{   \beta^2  }{ 2 \tau^2_k \sigma^2  }    }  </code>
</p>

<p>2. The Student's t prior case:
</p>
<p style="text-align: center;"><code class="reqn"> \beta | ( Z = k, \sigma^2 ) = \frac{  \Gamma ( \frac{\nu + 1 }{2} )  }{ \Gamma ( \frac{\nu}{2} ) \sqrt{ \pi \nu } \tau_k \sigma } \Bigg(  1 + \frac{1}{\nu}  \Big( \frac{ \beta^2 }{ \tau^2_k \sigma^2 } \Big)   \Bigg)^{  -\frac{ \nu + 1}{ 2 } } </code>
</p>

<p>Where <code class="reqn">\nu</code> is the degrees of freedom
</p>
<p>3. The Laplace prior case:
</p>
<p style="text-align: center;"><code class="reqn">  \beta | ( Z = k, \sigma^2 )  = \frac{1}{2 \tau_k^2 \sigma^2 } \exp \Big(  -\frac{  |\beta|  }{  \tau_{k}^2 \sigma^2  }  \Big) </code>
</p>

<p>The <code class="reqn">\tau_k</code> is the scale for the prior distribution. If users did not set a specific value, the prior scales are specified as follows:
</p>
<p style="text-align: center;"><code class="reqn">
\tau_{0}^2 = \frac{1}{n} a_\tau , \,  \tau_{1}^2 = \max\Big( 100 \tau_{0}^2, \frac{ \tau_{0}  p_n }{ (1 - p_n) \rho  } \Big),
</code>
</p>

<p>where <code class="reqn"> \rho</code> is the prior density evaluated at <code class="reqn"> f_p( b_\tau \times \log{(p_n + 1)})</code>, <code class="reqn"> f_p </code> is the density function for the corresponding prior distribution. The parameter <code class="reqn">a</code> and <code class="reqn">b</code> are <code class="reqn">a_\tau = 1</code> and <code class="reqn">b_\tau = 2.4</code> by default.
</p>
<p>The prior probability <code class="reqn">q_n = P(Z_i = 1)</code> that a covariate is nonzero can be specified by value K. The K represents a prior belief of the upper bound of the true covariates in the model. When user specifies a value of K greater than 3, setting <code class="reqn">q_n = c/p_n</code>, through the calculation(see details in Naveen (2014)):
</p>
<p style="text-align: center;"><code class="reqn"> \Phi( (K - c)/ \sqrt{c} ) = 1 - \alpha </code>
</p>

<p>The prior probability on the models with sizes greater than K will be <code class="reqn">\alpha</code>, and this <code class="reqn">\alpha</code> is set to 0.1 in the package.
</p>


<h3>Value</h3>

<p>An object of class <code>basad</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>all.var</code></td>
<td>
<p> Summary object for all the variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.var</code></td>
<td>
<p> Summary object for the selected variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.names</code></td>
<td>
<p> Variable names for the coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> Verbose details (used for printing). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posteriorZ</code></td>
<td>
<p>A vector of the marginal posterior probabilities for the latent vector Z. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.index</code></td>
<td>
<p>A vector containing the indices of selected variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelZ</code></td>
<td>
<p>A binary vector Z indicating whether the coefficient is true in the selected model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.B</code></td>
<td>
<p> Estimated coefficient values from the posterior distribution through Gibbs sampling. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allB</code></td>
<td>
<p> A matrix of all sampled coefficient values along the entire chain. Each row represents the sampled values under each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allZ</code></td>
<td>
<p> A matrix of all sampled posterior probabilities for the latent variable Z along the entire chain. Each row represents the sampled values under each iteration. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> x-matrix used for the algorithm.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> y vector used for the algorithm. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Qingyan Xiang (<a href="mailto:qyxiang@bu.edu">qyxiang@bu.edu</a>)
</p>
<p>Naveen Narisetty (<a href="mailto:naveen@illinois.edu">naveen@illinois.edu</a>)
</p>


<h3>References</h3>

<p>Narisetty, N. N., &amp; He, X. (2014). Bayesian variable selection with shrinking and diffusing priors. <em>The Annals of Statistics</em>, 42(2), 789-817.
</p>
<p>Bhattacharya, A., Chakraborty, A., &amp; Mallick, B. K. (2016). Fast sampling with Gaussian scale mixture priors in high-dimensional regression. <em>Biometrika</em>, 4(103), 985-991.
</p>
<p>Barbieri, M. M., &amp; Berger, J. O. (2004). Optimal predictive model selection. <em>The Annals of Statistics</em>, 32(3), 870-897.
</p>


<h3>Examples</h3>

<pre><code class="language-R">


#-----------------------------------------------------------
#Generate Data: The simulated high dimensional data
#-----------------------------------------------------------
n =  100; p = 499; nz = 5

rho1=0.25; rho2=0.25; rho3=0.25  ### correlations
Bc = c(0, seq(0.6, 3, length.out = nz), array(0, p - nz))

covr1 = (1 - rho1) * diag(nz) +  array(rho1, c(nz, nz))
covr3 = (1 - rho3) * diag(p - nz) +  array(rho3, c(p - nz, p - nz))
covr2 = array(rho2, c(nz, p - nz))
covr = rbind(cbind(covr1, covr2), cbind(t(covr2), covr3))

covE = eigen(covr)
covsq = covE$vectors %*% diag(sqrt(covE$values)) %*% t(covE$vectors)

Xs = matrix(rnorm(n * p), nrow = n); Xn = covsq %*% t(Xs)
X = cbind(array(1, n), t(Xn))
Y = X %*% Bc + rnorm(n); X &lt;- X[, 2:ncol(X)]


#-----------------------------------------------------------
#Example 1: Run the default setting of the Guassian priors
#-----------------------------------------------------------
obj &lt;- basad(x = X, y = Y)
print(obj)

#-----------------------------------------------------------
#Example 2: Use different priors and slection criterion
#-----------------------------------------------------------
obj &lt;- basad(x = X, y = Y, prior.dist = "t", select.cri = "BIC")
print(obj)

</code></pre>


</div>