<div class="container">

<table style="width: 100%;"><tr>
<td>pow</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power</h2>

<h3>Description</h3>

<p>Computes the exact power for a basket trial.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pow(design, ...)

## S4 method for signature 'OneStageBasket'
pow(
  design,
  p1,
  n,
  lambda,
  weight_fun,
  weight_params = list(),
  globalweight_fun = NULL,
  globalweight_params = list(),
  results = c("ewp", "group"),
  ...
)

## S4 method for signature 'TwoStageBasket'
pow(
  design,
  p1,
  n,
  n1,
  lambda,
  interim_fun,
  interim_params = list(),
  weight_fun,
  weight_params = list(),
  globalweight_fun = NULL,
  globalweight_params = list(),
  results = c("ewp", "group"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>An object of class <code>Basket</code> created by
<code>setupOneStageBasket</code> or <code>setupTwoStageBasket</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>Probabilities under the alternative hypothesis. If
<code>length(p1) ==  1</code>, then this is a common probability for all
baskets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size per basket.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The posterior probability threshold. See details for more
information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_fun</code></td>
<td>
<p>Which function should be used to calculate the pairwise
weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>weight_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalweight_fun</code></td>
<td>
<p>Which function should be used to calculate the
global weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalweight_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>globalweight_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Whether only the experimentwise power (option <code>ewp</code>)
or also the rejection probabilities per group (option <code>group</code>) should
be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>The sample size per basket for the interim analysis in case of a
two-stage design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interim_fun</code></td>
<td>
<p>Which type of interim analysis should be conducted
in case of a two-stage design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interim_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>interim_fun</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pow</code> computes the exact experimentwise power and the
exact rejection probabilities per group. The experimentwise power
is the probability to reject at least one null hypothesis for a basket with
p1 &gt; p0. The rejection probabilities correspond to the type 1 error
rate for baskets with p1 = p0 and to the power for baskets with
p1 &gt; p0.
</p>
<p>If <code>prune = TRUE</code> then the baskets with an observed number of baskets
smaller than the pooled critical value are not borrowed from. The
pooled critical value is the smallest integer c for which all null
hypotheses can be rejected if the number of responses is exactly c for
all baskets.
</p>
<p>This method is implemented for the class <code>OneStageBasket</code>.
</p>


<h3>Value</h3>

<p>If <code>results = "ewp"</code> then the experimentwise power is
returned as a numeric value. If <code>results = "group"</code> then a list with
the rejection probabilities per group and the experimentwise power
is returned. For baskets with p1 = p0 the rejection probabilities
corresponds to the type 1 error rate, for baskets with p1 &gt; p0 the
rejection probabilities corresponds to the power.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>pow(OneStageBasket)</code>: Power for a single-stage basket design.
</p>
</li>
<li> <p><code>pow(TwoStageBasket)</code>: Power for a two-stage basket design.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">design &lt;- setupOneStageBasket(k = 3, p0 = 0.2)
pow(design, p1 = c(0.2, 0.5, 0.5), n = 15, lambda = 0.99,
  weight_fun = weights_fujikawa, weight_params = list(epsilon = 2, tau = 0))
</code></pre>


</div>