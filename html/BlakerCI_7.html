<div class="container">

<table style="width: 100%;"><tr>
<td>binom.blaker.VHadj.limits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Vos-Hudson adjustment of Blaker's binomial confidence limits
</h2>

<h3>Description</h3>

<p>Blaker's binomial confidence limits adjusted so that logical
inconsistencies criticized by Vos and Hudson (2008) are avoided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.blaker.VHadj.limits(x, n, level = 0.95, tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>number of successes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of trials.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>confidence level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>numerical tolerance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>binom.blaker.VHadj.lower.limit</code>:
<code>maxiter</code>, <code>nmax</code>, <code>int.eps</code>
(see <code>BlakerCI-internal</code>). 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Length 2 vector – the lower and upper (adjusted) confidence    limits.
</p>


<h3>Warning</h3>

<p>The stopping rule used is not fully justified: 
</p>
<p>The Clopper-Pearson <code>1 - alpha</code> confidence bounds
for <code>x</code> successes in <code>n</code> trials 
may be expressed as <code>qbeta(alpha/2,x,n-x+1)</code> and
<code>qbeta(1-alpha/2,x+1,n-x)</code>,
and can be generalized this way to real 
(i. e. not only integer) values of <code>x</code>.
</p>
<p>The stopping rule used in <code>binom.blaker.VHadj.limits</code>
relies on the hypothesis that
the generalized lower (upper) Clopper-Pearson confidence bounds 
grow (decrease) whenever the number of trials grows, 
and the proportion of successes grows (decreases) or 
remains unchanged (with obvious exceptions in extremes).
</p>
<p>Though I firmly trust the hypothesis, I can prove it, so far, 
just for integer numbers of successes (i. e. for “ordinary” 
Clopper-Pearson confidence bounds, not the generalized ones), 
and lack a general proof.
Should the hypothesis be invalid, the stopping rule
implemented in <code>binom.blaker.VHadj.limits</code>
would be incorrect, and the process of modifying
the Blaker's confidence bounds could be incomplete
in some cases. 
</p>


<h3>Note</h3>


<p>Vos &amp; Hudson (2008) gave examples of mutually contradictory
inferences yielded by some binomial tests and confidence
intervals, including the Blaker's confidence interval.
Their objections may be interpreted as follows:
When the number of trials is increased so that the success
proportion increases (decreases) or remains the same,
the lower (upper) confidence limit at the same confidence level
should not decrease (increase).<br>
The adjustment implemented in <code>binom.blaker.VHadj.limits</code>
replaces the lower (upper) Blaker's confidence limit
for <code>x</code> successes in <code>n</code> trials
with the infimum (supremum) of the Blaker's lower (upper)
confidence limits over such pairs <code>y</code>, <code>m</code>
that <code>m</code> is not less that <code>n</code>, and 
<code>y/m</code> is not less (greater) than <code>x/n</code>.
</p>
<p>Note that Lecoutre &amp; Poitevineau (2014), refering to the 
criticism by
Vos &amp; Hudson, proposed a modification of the Blaker's
confidence limits. 
Their adjustment, however, eliminates only a subset of
“discrepancies” treated by <code>binom.blaker.VHadj.limits</code>,
namely nonmonotonicities of upper (lower) Blaker's confidence
bounds in the number of trials when the number of successes
(failures) remains the same.
</p>


<h3>Author(s)</h3>

<p>Jan Klaschka <a href="mailto:klaschka@cs.cas.cz">klaschka@cs.cas.cz</a>
</p>


<h3>References</h3>


<p>Vos, P. W. &amp; Hudson, S. (2008).
Problems with binomial two-sided tests and the associated
confidence intervals.
Australian &amp; New Zealand Journal of Statistics
50(1): 81-89.
</p>
<p>Lecoutre, B. &amp; Poitevineau, J. (2014). New results for computing
Blaker's exact confidence interval limits for usual
one-parameter discrete distributions.
Communications in Statistics - Simulation and Computation, 
<a href="http://dx.doi.org/10.1080/03610918.2014.911900">http://dx.doi.org/10.1080/03610918.2014.911900</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">binom.blaker.VHadj.limits(6,13) # [1] 0.2150187 0.7395922

## Note that the lower limit differs from the 
## unadjusted version:

binom.blaker.limits(6,13)       # [1] 0.2158050 0.7395922

## The (unadjusted) lower limit was replaced with the
## Blaker's lower limit (both unadjusted and adjusted) 
## assigned to 7 successes in 15 trials:

binom.blaker.limits(7,15)       # [1] 0.2150187 0.7096627
binom.blaker.VHadj.limits(7,15) # [1] 0.2150187 0.7096627

## The adjustment avoids a contradiction between
## inferences corresponding to
## 6 successes in 13 trials, and 7 successess in 15 trials: 
## Though the latter situation means a higher succes proportion
## in a higher number of trials, it is assigned a smaller
## (unadjusted) Blaker's 95% lower confidence limit. 
</code></pre>


</div>