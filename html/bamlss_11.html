<div class="container">

<table style="width: 100%;"><tr>
<td>bamlss.frame</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create a Model Frame for BAMLSS
</h2>

<h3>Description</h3>

<p>This function parses the <code>data</code> and the model <code>formula</code>, or
extended <code>bamlss.formula</code>, as well as the <code>bamlss.family</code>
into a <code>bamlss.frame</code> object. The <code>bamlss.frame</code> then holds all model
matrices and information that is needed for setting up estimation engines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bamlss.frame(formula, data = NULL, family = "gaussian",
  weights = NULL, subset = NULL, offset = NULL,
  na.action = na.omit, contrasts = NULL,
  knots = NULL, specials = NULL, reference = NULL,
  model.matrix = TRUE, smooth.construct = TRUE,
  ytype = c("matrix", "vector", "integer"),
  scale.x = FALSE, scale.d = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula or extended formula, i.e., the <code>formula</code> can be a
<code>list</code> of formulas where each list entry specifies the details of one parameter
of the modeled response distribution, see <code>bamlss.formula</code>. For incorporating
smooth terms, all model term constructors implemented in <span class="pkg">mgcv</span> such as
<code>s</code>, <code>te</code> and <code>ti</code> can be used, amongst others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> or <code>list</code> containing the model
response variable(s) and covariates specified in the <code>formula</code>.
By default the variables are taken from <code>environment(formula)</code>:
typically the environment from which <code>bamlss</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <code>bamlss.family</code> object, specifying the details of the modeled
distribution such as the parameter names, the density function, link functions, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Prior weights on the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Can be used to supply model offsets for use in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function which indicates what should happen when the data
contain <code>NA</code>'s. The default is set by the <code>na.action</code>
setting of <code>options</code>, and is <code>na.omit</code> if set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>An optional list. See the <code>contrasts.arg</code> of 
<code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>An optional list containing user specified knots, see the documentation of
function <code>gam</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specials</code></td>
<td>
<p>Specify new special terms here to be used with the <code>bamlss.formula</code>,
see also <code>terms.object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>A <code>character</code> specifying a reference category, e.g., when
fitting a multinomial model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.matrix</code></td>
<td>
<p>Logical, should model matrices for linear parts be returned?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.construct</code></td>
<td>
<p>Logical, should model matrices, e.g., as returned from
<code>smooth.construct</code> and <code>smoothCon</code> be part
of returned <code>bamlss.frame</code>?.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytype</code></td>
<td>
<p>For categorical responses, should the response be a vector or matrix. If
<code>ytype == "matrix"</code> <code>bamlss.frame()</code> uses function <code>model.matrix</code>
to construct the response matrix from levels. If the response is a factor
<code>ytype == "integer"</code> will create an integer response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.x</code></td>
<td>
<p>Logical, should the model matrices of the linear parts be scaled?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.d</code></td>
<td>
<p>Logical, should the numeric variables in the model frame be scaled?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to function <code>smooth.construct.bamlss.frame</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function parses the <code>data</code>, the <code>formula</code> or the extended
<code>bamlss.formula</code> as well as the <code>bamlss.family</code> into a model frame
like object, the <code>bamlss.frame</code>. This object holds all necessary model matrices
and information that is needed for model fitting engines. Per default,
all package <span class="pkg">mgcv</span> smooth term constructor functions like
<code>s</code>, <code>te</code>, <code>t2</code> and
<code>ti</code> can be used (see also function <code>smooth.construct</code>),
however, even special user defined constructors can be included, see the examples below.
</p>
<p>Function <code>bamlss.frame()</code> uses function <code>model.matrix.bamlss.frame</code> to
compute all design matrices for simple linear parts, all smooth terms are parsed with
function <code>smooth.construct.bamlss.frame</code>.
</p>
<p>It is also possible to create a <code>"bamlss.frame"</code> using hierarchical formulae, see the
example below.
</p>


<h3>Value</h3>

<p>An list of class <code>"bamlss.frame"</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The initial call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.frame</code></td>
<td>
<p>The <code>model.frame</code> used to compute all design matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The <code>bamlss.formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The <code>bamlss.family</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>The <code>terms.bamlss</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A named list, the elements correspond to the parameters that are specified
within the <code>bamlss.family</code> object. For each parameter the corresponding
<code>formula</code>, a <code>fake.formula</code> only holding the covariate names, a <code>terms</code>
object, a <code>model.matrix</code> for the linear part and a list <code>smooth.construct</code>
holding all information for smooth terms as returned from function
<code>link{smooth.construct.bamlss.frame}</code> is created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response data.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>bamlss</code>, <code>bamlss.formula</code>, <code>bamlss.family</code>,
<code>smooth.construct.bamlss.frame</code>, <code>model.matrix.bamlss.frame</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create a 'bamlss.frame'.
d &lt;- GAMart()
f &lt;- list(
  num ~ fac + s(x1) + s(x2) + te(lon, lat),
  sigma ~ id + s(x2) + s(x3)
)
bf &lt;- bamlss.frame(f, data = d, family = "gaussian")

## Show parts of the 'bamlss.frame'.
print(bf)

## Categorical responses.
f &lt;- list(
  cat ~ fac + s(x1) + s(x2)
)

bf &lt;- bamlss.frame(f, data = d, family = "multinomial", reference = "low")
print(bf)

## The response is a matrix per default.
head(bf$y)

## 0/1 responses.
d &lt;- cbind(d, model.matrix(~ -1 + cat, data = d))

f &lt;- list(
  catnone ~ fac + s(x1),
  catlow ~ s(x2),
  catmedium ~ s(x3)
)

bf &lt;- bamlss.frame(f, data = d, family = "multinomial")
print(bf)

## Hierarchical structures.
f &lt;- list(
  num ~ s(x1) + s(x2) + id,
  id ~ te(lon, lat),
  sigma ~ s(x1) + fac
)

bf &lt;- bamlss.frame(f, data = d, family = "gaussian")
print(bf)

## Special model term constructors,
## set up "new" constructor function and eval
## with bamlss.frame().
s77 &lt;- function(...) {
  sm &lt;- s(...)
  sm$label &lt;- paste("s77(", paste(sm$term, collapse = ","), ")", sep = "")
  sm
}

f &lt;- list(
  num ~ s77(x1) + s(x2) + id,
  sigma ~ s77(x1)
)

bf &lt;- bamlss.frame(f, data = d, family = "gaussian", specials = "s77")
print(bf)
names(bf$x$mu$smooth.construct)
</code></pre>


</div>