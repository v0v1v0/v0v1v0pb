<div class="container">

<table style="width: 100%;"><tr>
<td>dirichlet.o</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixture of Ordinary Dirichlet Model</h2>

<h3>Description</h3>

<p>MCMC generation of posterior distributions for the
usual (unconditional) Dirichlet mixing distribution model, using
an <code class="reqn">m+1</code>-cycle Gibbs sampler</p>


<h3>Usage</h3>

<pre><code class="language-R">dirichlet.o(data, ncycles=10, M=1,d=c(.1,.1,0,1000),
            start=NULL,K=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>is a two-column matrix with a row for each study
in the meta-analysis.  The first column is the log of estimate
of relative risk, often a log(odds ratio).  The second column is
the true or estimated standard error of the log(odds ratio).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncycles</code></td>
<td>
<p>is the number of cycles of the Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>is the precision parameter of the Dirichlet process prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>is a vector of length four with the values of the
hyperparameters, in order, the location and scale of the Gamma
inverse prior, mean and variance multiplier for the normal prior
on mu.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>is an optional vector containing starting values for the
parameters, <code class="reqn">\psi_i, i=1, \ldots, m</code> where <code class="reqn">m</code> is the number of
studies in the meta-analysis, <code class="reqn">\mu</code> and <code class="reqn">\tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>is the number of summands to include when one uses
Sethuraman's (1994) representation for getting the parameter
<code class="reqn">\eta =</code> mean(<code class="reqn">F</code>).  If you do not intend to use this
parameter, then take <code class="reqn">K</code> small, say <code class="reqn">K=10</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates MCMC output for the posterior distribution for
the parameters <code class="reqn">\psi_i, i=1,...,m</code> where <code class="reqn">m</code> is the number of
studies in the meta-analysis, <code class="reqn">\mu</code>, <code class="reqn">\tau</code>, and <code class="reqn">\eta</code>
in the ordinary Dirichlet mixing model for random-effects
meta-analysis.  Notation is taken from <cite>Burr (2012)</cite>,
Model <code class="reqn">2</code> and <code class="reqn">3</code>.
</p>
<p>The MCMC algorithm for estimating the posterior under this model is
given in <cite>Burr and Doss (2005)</cite>.  The chain is a
<code class="reqn">(m+1)</code>-cycle Gibbs sampler which cycles through
the vector of <code class="reqn">\psi_i</code>'s and the triple <code class="reqn">\mu</code>, <code class="reqn">\tau</code>,
<code class="reqn">\eta</code>, and the main part of the computational burden is in the
first part of the cycle, the generation of the vector of
<code class="reqn">\psi_i</code>'s.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call that resulted in this object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncycles</code></td>
<td>
<p>the number of cycles in the Markov chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>the value of the precision parameter for the conditional
Dirichlet model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>the vector length four of hyperparameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>A matrix with <code>ncycles</code> <code class="reqn">+1</code> rows and
<code class="reqn">m+3</code> columns, where <code class="reqn">m</code> is the number of studies in the
meta-analysis.  The rows hold output from the Markov chain runs
(the first row is the initial values).  Columns <code class="reqn">1</code> through
<code class="reqn">m</code> hold the individual study parameters, the <code class="reqn">\psi_i</code>'s.
The next two columns hold the mean and standard deviation
parameters of the centering normal distribution of the Dirichlet
prior, <code class="reqn">\mu</code> and <code class="reqn">\tau</code>, and the final column holds
the parameter <code class="reqn">\eta</code>.  In the ordinary Dirichlet mixing model,
the parameter <code class="reqn">\mu</code> does not equal the mean of the
distribution <code class="reqn">F</code> of the <code class="reqn">\psi_i</code>'s; we denote this
mean <code class="reqn">\eta</code> and estimate it by Sethuraman's (1994) method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.user</code></td>
<td>
<p>logical, TRUE if the user supplied initial values of
the parameter vector, FALSE if input argument <code>start</code> was not
specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>vector of initial parameter values, whether default or
user-supplied</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Burr, Deborah (2012).  “bspmma:  An R package for Bayesian
semi-parametric models for meta-analysis.”  <em>Journal of
Statistical Software</em> 50(4), 1–23.
<a href="http://www.jstatsoft.org/v50/i04/.">http://www.jstatsoft.org/v50/i04/.</a>
</p>
<p>Burr, D. and Doss, H. (2005).  “A Bayesian semiparametric model
for random-effects meta-analysis.”  <em>Journal of the American
Statistical Association 100</em> 242–251.
</p>
<p>Sethuraman, J. (1994).  “A constructive definition of Dirichlet
priors.”  <em>Statistica Sinica 4</em>, 639–650.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(breast.17) # the dataset
breast.data &lt;- as.matrix(breast.17) # put data in matrix object
set.seed(1) # initialize the seed at 1 
diro &lt;- dirichlet.o(breast.data, ncycles=4000, M=5)

## a short description of the model and Markov chain
print(diro1)

## the last mcmc cycle
diro$mcmc[4001,]

## End(Not run)
</code></pre>


</div>