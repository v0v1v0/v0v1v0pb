<div class="container">

<table style="width: 100%;"><tr>
<td>exactcp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional power computation using exact test.</h2>

<h3>Description</h3>

<p>Compute conditional power of single-arm group sequential design with binary
endpoint based on binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exactcp(d, p_1, i, z_i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>An object of the class exactdesign or exactprob.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_1</code></td>
<td>
<p>A scalar or vector representing response rate or probability of
success under the alternative hypothesis. The value(s) should be within
(p_0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Index of the analysis at which the interim statistic is given. Should
be an integer ranges from 1 to K-1. i will be rounded to its nearest whole
value if it is not an integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_i</code></td>
<td>
<p>The interim statistic at analysis i.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Conditional power quantifies the conditional probability of crossing the upper bound given the interim result <code class="reqn">z_i</code>,
<code class="reqn">1\le i&lt;K</code>. Having inherited sample sizes and boundaries from <code>exactdesign</code> or <code>exactprob</code>,
given the interim statistic at <code class="reqn">i</code>th analysis <code class="reqn">z_i</code>, the conditional power is defined as
</p>
<p><code class="reqn">\alpha _{i,K}(p|z_i)=P_{p}(Z_K\ge u_K, Z_{K-1}&gt;l_{K-1}, \ldots, Z_{i+1}&gt;l_{i+1}|Z_i=z_i)</code>
</p>
<p>With exact test, the test statistic at analysis <code class="reqn">k</code> is <code class="reqn">Z_k=\sum_{s=1}^{n_k}X_s</code>
which follows binomial distribution <code class="reqn">b(n_k,p)</code>. Actually, <code class="reqn">Z_k</code> is the total
number of responses up to the kth analysis.
</p>
<p>The increment statistic <code class="reqn">Z_k-Z_{k-1}</code> also follows a binomial distribution <code class="reqn">b(n_k-n_{k-1},p)</code> independently
of <code class="reqn">Z_{1}, \ldots, Z_{k-1}</code>. Then the conditional power can be easily obtained using the same procedure
for deriving unconditional boundary crossing probabilities.
</p>
<p>Note that <code class="reqn">Z_{1}, \ldots, Z_{K}</code> is a non-decreasing sequence, thus the conditional power is 1 when the interim statistic
<code class="reqn">z_i&gt;=u_K</code>.
</p>


<h3>Value</h3>

<p>A list with the elements as follows: </p>
 <ul>
<li>
<p>K: As in d.
</p>
</li>
<li>
<p>n.I: As in d. </p>
</li>
<li>
<p>u_K: As in d. </p>
</li>
<li>
<p>lowerbounds: As in d.
</p>
</li>
<li>
<p>i: i used in computation. </p>
</li>
<li>
<p>z_i: As input. </p>
</li>
<li>
<p>cp: A matrix of
conditional powers under different response rates. </p>
</li>
<li>
<p>p_1: As input.
</p>
</li>
<li>
<p>p_0: As input. </p>
</li>
</ul>
<h3>Reference</h3>

 <ul><li>
<p>Christopher Jennison, Bruce W. Turnbull. Group Sequential Methods with
Applications to Clinical Trials. Chapman and Hall/CRC, Boca Raton, FL, 2000. </p>
</li></ul>
<h3>See Also</h3>

<p><code>exactprob</code>, <code>asymcp</code>,
<code>exactdesign</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">I=c(0.2,0.4,0.6,0.8,0.99)
beta=0.2
betaspend=c(0.1,0.2,0.3,0.3,0.2)
alpha=0.05
p_0=0.3
p_1=0.5
K=4.6
tol=1e-6
tt1=asymdesign(I,beta,betaspend,alpha,p_0,p_1,K,tol)
tt2=exactdesign(tt1)
tt3=exactprob(p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),d=tt2)
exactcp(tt2,p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),1,2)
exactcp(tt3,p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),3,19)
</code></pre>


</div>