<div class="container">

<table style="width: 100%;"><tr>
<td>diagnosticTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing Procedure for Bicluster Diagnostics</h2>

<h3>Description</h3>

<p>Calculate the statistical value of the row, column and multiplicative effect based on discovered biclusters in the data. 
Additionally multiple sampling methods are available to compute the statistical significance through p-values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnosticTest(BCresult, data, number = 1:BCresult@Number, verbose = TRUE,
  statistics = c("F", "Tukey"), sampling = TRUE, samplingtypes = NULL,
  nSim = 1000, alpha = 0.05, save_F = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BCresult</code></td>
<td>
<p>An object of class <code>biclust</code> containing the result of a biclustering algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data matrix, which <code>biclust</code> function was applied to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number</code></td>
<td>
<p>Vector of bicluster numbers of which the diagnostics should be calculated. (default = all available biclusters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean value to print progression of computed statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>Vector select which statistics to compute. (default = <code>c("F","Tukey")</code>)
</p>

<ul>
<li> <p><code>"F"</code> (Row and column F statistics of two-way ANOVA with one replicate for cell)
</p>
</li>
<li> <p><code>"Tukey"</code> (Tukey's test for non-additivity)
</p>
</li>
<li> <p><code>"ModTukey"</code> (<code>mtukey.test</code>)
</p>
</li>
<li> <p><code>"Tusell"</code> (<code>tusell.test</code>)
</p>
</li>
<li> <p><code>"Mandel"</code> (<code>mandel.test</code>)
</p>
</li>
<li> <p><code>"LBI"</code> (<code>lbi.test</code>)
</p>
</li>
<li> <p><code>"JandG"</code> (<code>johnson.graybill.test</code>)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>Boolean value to apply sampling methods to compute statistical significance (default=<code>TRUE</code>). 
If <code>FALSE</code> only the <code>"Theoretical"</code> p-values are computed. 
If <code>TRUE</code>, both the <code>"Theoretical"</code> and <code>samplingtypes</code> p-values are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingtypes</code></td>
<td>
<p>Vector of sampling methods for <code>sampling=TRUE</code>. (default=<code>NULL</code>=<code>c("Permutation","SemiparPerm")</code>)
</p>

<ul>
<li> <p><code>"Permutation"</code> 
</p>
</li>
<li> <p><code>"SemiparPerm"</code> 
</p>
</li>
<li> <p><code>"SemiparBoot"</code> 
</p>
</li>
<li> <p><code>"PermutationCor"</code> 
</p>
</li>
<li> <p><code>"SamplingCor"</code>
</p>
</li>
<li> <p><code>"NormSim"</code>  
</p>
</li>
</ul>
<p>See Details for more info.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSim</code></td>
<td>
<p>Number of permutations/bootstraps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level (default=0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_F</code></td>
<td>
<p>Option to save the permuted/bootstraped statistics. This is necessary for <code>diagnosticPlot2</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Due to the uncertainty of discovering the true bicluster(s) in the data, it's often advisable to not rely on the theoretical p-values but instead retrieve the p-values through a sampling procedure.
</p>
<p>Available p-values/sampling types for each statistical method:
</p>

<ul>
<li> <p><code>"F"</code>: <code>"Theoretical"</code> and <code>"Permutation"</code> for both row and column effect.
</p>
</li>
<li> <p><code>"Tukey"</code>: <code>"Theoretical"</code>, <code>"SemiparPerm"</code> and <code>"SemiparBoot"</code>.
</p>
</li>
<li> <p><code>"ModTukey"</code>: <code>"Theoretical"</code>, <code>"SemiparPerm"</code>, <code>"SemiparBoot"</code>, <code>"PermutationCor"</code> and <code>"SamplingCor"</code>.
</p>
</li>
<li> <p><code>"Tusell"</code>: <code>"SemiparPerm"</code>, <code>"SemiparBoot"</code> and <code>"NormSim"</code>.
</p>
</li>
<li> <p><code>"Mandel"</code>: <code>"Theoretical"</code>, <code>"SemiparPerm"</code> and <code>"SemiparBoot"</code>.
</p>
</li>
<li> <p><code>"LBI"</code>: <code>"SemiparPerm"</code>, <code>"SemiparBoot"</code> and <code>"NormSim"</code>.
</p>
</li>
<li> <p><code>"JandG"</code>: <code>"SemiparPerm"</code>, <code>"SemiparBoot"</code> and <code>"NormSim"</code>.
</p>
</li>
</ul>
<p>More info on the sampling types can be found in the secion below.
If available, the <code>"Theoretical"</code> will always be computed.
By default when <code>sampling=TRUE</code>, a sampling method without replacement is chosen, namely <code>"Permutation"</code> and <code>"SemiparPerm"</code>.
</p>
<p>When <code>save_F=TRUE</code>, the null distributions of the statistics can be visualised with <code>diagnosticPlot2</code>.
</p>
<p><em>Disclaimer:</em> While their functionality did not change, some functions of the <code>additivityTests</code> package were altered in order to be able to return the permuted/bootstrapped statistics and p-values.
</p>


<h3>Value</h3>

<p>Returns a list with <code>length(number)</code> elements. 
Each element corresponds with the requested biclusters and is a list containing:
</p>

<ul>
<li> <p><code>table</code>: a data frame where each row is <code>statistics</code> and <code>samplingtypes</code> (including Theoretical) combination. The data frame contains the <code>Method</code>, <code>Type</code> (p-value type), <code>StatVal</code> (statistical value), <code>CritVal</code> (critical value), <code>pVal</code> and <code>Sign</code> (0/1 significance indicator based on <code>alpha</code>).
</p>
</li>
<li> <p><code>save_F</code>: if <code>save_F=TRUE</code>, a (<code>nSim</code> x number of permuted/bootstrapped p-values) matrix contained the sampled statistics.
</p>
</li>
</ul>
<h3>Sampling Types</h3>

<p>For each sampling type a permuted/bootstrapped BC is created as following:
</p>

<ul>
<li> <p><code>"Permutation"</code>: Sample a BC from the entire dataset with replacement.
</p>
</li>
<li> <p><code>"SemiparPerm"</code>: A semi-parametric permutation procedure. Two-way ANOVA is applied on the original BC and the residual matrix extracted. A new residual matrix is created by sampling <em>without replacement</em> from the original residual matrix. The sampled BC is then generated by adding this sampled residual matrix on top the mean, row and column effect of the ANOVA procedure of the original BC.
</p>
</li>
<li> <p><code>"SemiparBoot"</code>: A semi-parametric bootstrapping procedure. Two-way ANOVA is applied on the original BC and the residual matrix extracted. A new residual matrix is created by sampling <em>with replacement</em> from the original residual matrix. The sampled BC is then generated by adding this sampled residual matrix on top the mean, row and column effect of the ANOVA procedure of the original BC.
</p>
</li>
<li> <p><code>"PermutationCor"</code>: See <code>correction=1</code> parameter of <code>mtukey.test</code>. More info in Simecek and Simeckova (2012).
</p>
</li>
<li> <p><code>"SamplingCor"</code>: See <code>correction=2</code> parameter of <code>mtukey.test</code>. More info in Simecek and Simeckova (2012).
</p>
</li>
<li> <p><code>"NormSim"</code>: Sample a BC from a standard normal distribution. This sampling procedure is used for some methods in the <code>additivityTests</code> package.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ewoud De Troyer
</p>


<h3>References</h3>

<p>Tukey, J.W.: One Degree of Freedom for Non-additivity, <em>Biometrics</em> <strong>5</strong>, pp. 232-242, 1949.
</p>
<p>Simecek, Petr, and Simeckova, Marie. "Modification of Tukey's additivity test." <em>Journal of Statistical Planning and Inference</em>, <strong>2012</strong>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## Not run: 
#Random matrix with embedded bicluster (with multiplicative effect)
test &lt;- matrix(rnorm(5000),100,50)
roweff &lt;- sample(1:5,10,replace=TRUE)
coleff &lt;- sample(1:5,10,replace=TRUE)
test[11:20,11:20] &lt;- test[11:20,11:20] +
  matrix(coleff,nrow=10,ncol=10,byrow=TRUE) +
  matrix(roweff,nrow=10,ncol=10) +
  roweff %*% t(coleff)


#Apply Plaid Biclustering
res &lt;- biclust(test, method=BCPlaid())

#Apply default diagnosticTest
out &lt;- diagnosticTest(BCresult=res, data=test, save_F=TRUE, number=1,
                      statistics=c("F","Tukey","ModTukey","Tusell","Mandel","LBI","JandG"),
                      samplingtypes=c("Permutation","SemiparPerm","SemiparBoot",
                      "PermutationCor","SamplingCor","NormSim"))

out[[1]]$table

## End(Not run)

</code></pre>


</div>