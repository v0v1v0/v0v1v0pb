<div class="container">

<table style="width: 100%;"><tr>
<td>nPV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Asymptotic sample size calculation for inference on negative and positive predictive values in case-control designs.
</h2>

<h3>Description</h3>

<p>Functions to compute sample size (to reach a pre-specified power) and optimal allocation of true positives and true negatives in case-control designs (Steinberg et al., 2008) for binary diagnostic tests (Mercaldo et al. 2007).
</p>


<h3>Usage</h3>

<pre><code class="language-R">nPV(se, sp, prev, NPV0, PPV0,
 NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.05, 0.95), nsteps = 20,
 alpha = 0.05, setnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the expected sensitivity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the expected specificity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the prevalence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the negative predictive value to be rejected under H0: NPV&gt;=NPV0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the positive predictive value to be rejected under H0: PPV&gt;=PPV0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPVpower</code></td>
<td>
<p>a (vector of) numeric value(s), the power that is to be obtained for the test H0: NPV&gt;=NPV0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPVpower</code></td>
<td>
<p>a (vector of) numeric value(s), the power that is to be obtained for the test H0: PPV&gt;=PV0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rangeP</code></td>
<td>
<p> a vector of two numeric values, giving the range of the proportion of truely positives to be considered in experimental design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps</code></td>
<td>
<p>a single (integer) value, the number of steps in rangeP to be considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a single numeric value, the type I error of the test (1-confidence level)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setnames</code></td>
<td>
<p>an optional vector of names for the parameter sets</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function uses <code>nNPVPPV</code> and implement the methods described in section 3.2 of Steinberg et al.(2009).
The results for NPV are the smallest integers fulfilling Eq.(3.6) and NA if necesarry conditions mentioned before are not met, 
the results for PPV are the smallest integers fulfilling Eq.(3.8) and NA if necesarry conditions mentioned before are not met.
</p>
<p>The arguments <code>se</code>, <code>sp</code>, <code>prev</code>, <code>NPV0</code>, <code>PPV0</code>, <code>NPVpower</code>, <code>PPVpower</code> can be given as vectors or single values, where shorter values are recycled to the length of the longest. The proportion of true positives is varied over <code>nstep</code> equidistant values over the range specified in argument <code>rangeP</code>.
On each resulting parameter set, the asymptotic sample size formulas of Steinberg et al.(2009) are applied.
</p>
<p>The result of those calculations may be plot using <code>plotnPV</code> and <code>plotnPV2</code>.
</p>
<p>Warnings are returned by the internal function nNPV and nPPV if the validity of asymptotic formulas under binomial sampling may be doubtable, namely when the asymptotic formulas return a total sample size n for given propP, se, sp, such that
min(n*propP*se, n*propP*(1-se))&lt;5 or min(n*(1-propP)*sp, n*(1-propP)*(1-sp))&lt;5. That is, a warning is returned if the proposed design of the case-control study (n1, n0) = (n*propP, n*(1-propP)) leads to expected counts &lt; 5 for any cell of the 2x2 table.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>outDAT </code></td>
<td>
<p>a data.frame showing the parameter settings (in rows) and the input parameters se, sp, prev, NPV0, PPV0, NPVpower, PPVpower, trueNPV, truePPV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlist</code></td>
<td>
<p> a list with an element for each parameter setting in OUTDAT, listing the results of <code>nNPV</code>, and <code>nPPV</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NSETS</code></td>
<td>
<p> a single (integer), the number of parameter sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsteps</code></td>
<td>
<p> a single (integer), the number of steps in the range of proportions of true positives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rangeP</code></td>
<td>
<p>the input range of the proportion of true positives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propP</code></td>
<td>
<p>the resulting sequence of proportions of true positives considered</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Steinberg DM, Fine J, Chappell R (2009).</em> Sample size for positive and negative predictive value in diagnostic research using case-control designs. Biostatistics 10,1, 94-105.
</p>


<h3>See Also</h3>

<p><code>plotnPV</code> for showing the results in one graphic, and <code>plotnPV</code> for showing the results in a set of subgraphics,
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Reproducing illustration in Section 3.4 and 4.2 of
#Steinberg et al. (2009)

FIG1&lt;-nPV(se=0.8, sp=0.95, prev=1/16, NPV0=0.98, PPV0=0.4,
 NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.01, 0.99), nsteps = 100, alpha = 0.05)

FIG1

DFIG1&lt;-as.data.frame(FIG1)

plot(x=DFIG1$propP, y=DFIG1[,2], ylim=c(0,2000), lty=1,  type="l",
 ylab="total sample size", xlab="proportion of true positives")
lines(x=DFIG1$propP, y=DFIG1[,3], lty=2 )

</code></pre>


</div>