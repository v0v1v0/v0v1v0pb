<div class="container">

<table style="width: 100%;"><tr>
<td>MvInv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Invert jump heights function</h2>

<h3>Description</h3>

<p>Determines the jump heights of an increasing additive process by inverting
the M(v) function. Use a truncation level based on expected moments of the NGG process (<code>thresholdGG</code>).
For internal use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MvInv(eps, u = 0.5, alpha = 1, kappa = 1, gama = 1/2, N = 3001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Dummy argument kept for consistency with past versions of the functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Real number. The value of the latent variable at the current step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric constant. Total mass of the centering measure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Numeric positive constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gama</code></td>
<td>
<p>Numeric constant. Discount parameter of the NRMI process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of steps in the discretization scheme for the grid inversion.
</p>
<p>## The function has been optimised but it is morally defined as:
function(eps, u = 0.5, alpha = 1, kappa = 1, gama = 1 / 2, N = 3001) 
n &lt;- length(w)
v &lt;- rep(NA, n)
x &lt;- -log(seq(from = exp(-1e-05), to = exp(-10), length = N))
f &lt;- alpha / gamma(1 - gama) * x^(-(1 + gama)) * exp(-(u +
kappa) * x)
dx &lt;- diff(x)
h &lt;- (f[-1] + f[-N]) / 2
Mv &lt;- rep(0, N)
for (i in seq(N - 1, 1)) Mv[i] &lt;- Mv[i + 1] + dx[i] * h[i]
for (j in seq(n)) v[j] &lt;- x[which.min(Mv &gt; w[j])]
return(v)
</p>
</td>
</tr>
</table>
</div>