<div class="container">

<table style="width: 100%;"><tr>
<td>murakami_stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Murakami's test statistic.</h2>

<h3>Description</h3>

<p>Compute one of the modified Baumgartner-Weiss-Schindler test statistics proposed
by Murakami, or Neuhauser.
</p>


<h3>Usage</h3>

<pre><code class="language-R">murakami_stat(x, y, flavor = 0L)

murakami_stat_perms(nx, ny, flavor = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of the first sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of the second sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flavor</code></td>
<td>
<p>which ‘flavor’ of test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx</code></td>
<td>
<p>the length of <code>x</code>, the first sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ny</code></td>
<td>
<p>the length of <code>y</code>, the second sample.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given vectors <code class="reqn">X</code> and <code class="reqn">Y</code>, computes <code class="reqn">B_{jX}</code> and <code class="reqn">B_{jY}</code> 
for some <code class="reqn">j</code> as described by Murakami and by Neuhauser, returning either their 
their average or their average distance.
The test statistics approximate the weighted square norm of the
difference in CDFs of the two distributions. 
</p>
<p>The test statistic is based only on the ranks of the input. If the same
monotonic transform is applied to both vectors, the result should be unchanged.
</p>
<p>The various ‘flavor’s of test statistic are:
</p>

<dl>
<dt>0</dt>
<dd>
<p>The statistic of Baumgartner-Weiss-Schindler.</p>
</dd>
<dt>1</dt>
<dd>
<p>Murakami's <code class="reqn">B_1</code> statistic, from his 2006 paper.</p>
</dd>
<dt>2</dt>
<dd>
<p>Neuhauser's difference statistic, denoted by Murakami as <code class="reqn">B_2</code> in his 
2012 paper.</p>
</dd>
<dt>3</dt>
<dd>
<p>Murakami's <code class="reqn">B_3</code> statistic, from his 2012 paper.</p>
</dd>
<dt>4</dt>
<dd>
<p>Murakami's <code class="reqn">B_4</code> statistic, from his 2012 paper.</p>
</dd>
<dt>5</dt>
<dd>
<p>Murakami's <code class="reqn">B_5</code> statistic, from his 2012 paper, with a log weighting.</p>
</dd>
</dl>
<h3>Value</h3>

<p>The BWS test statistic, <code class="reqn">B_j</code>. For <code>murakami_stat_perms</code>, a vector of
the test statistics for <em>all</em> permutations of the input.
</p>


<h3>Note</h3>

<p><code>NA</code> and <code>NaN</code> are not yet dealt with!
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>
<p>M. Neuhauser, 'Exact tests based on the Baumgartner-Weiss-Schindler Statistic–a survey', 
Statistical Papers 46, no. 1 (2005): pp. 1-30.
<a href="https://doi.org/10.1007/BF02762032">doi:10.1007/BF02762032</a>
</p>
<p>M. Neuhauser, 'One-sided two-sample and trend tests based on a modified 
Baumgartner-Weiss-Schindler statistic', J. Nonparametric Statistics 13, no.
5 (2001): pp 729-739.
<a href="https://doi.org/10.1080/10485250108832874">doi:10.1080/10485250108832874</a>
</p>
<p>H. Murakami, 'K-sample rank test based on modified Baumgartner statistic and
its power comparison', J. Jpn. Comp. Statist. 19, no. 1 (2006): pp. 1-13.
<a href="https://doi.org/10.5183/jjscs1988.19.1">doi:10.5183/jjscs1988.19.1</a>
</p>
<p>H. Murakami, 'Modified Baumgartner Statistics for the two-sample and
multisample problems: a numerical comparison', J. Stat. Comp. and Sim.
82, no. 5 (2012): pp. 711-728.
<a href="https://doi.org/10.1080/00949655.2010.551516">doi:10.1080/00949655.2010.551516</a>
</p>
<p>H. Murakami, 'Lepage type statistic based on the modified Baumgartner statistic',
Comp. Stat. &amp; Data Analysis 51 (2007): pp 5061-5067. 
<a href="https://doi.org/10.1016/j.csda.2006.04.026">doi:10.1016/j.csda.2006.04.026</a>
</p>


<h3>See Also</h3>

<p><code>bws_stat</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1234)
x &lt;- runif(1000)
y &lt;- runif(100)
bval &lt;- murakami_stat(x,y,1)


nx &lt;- 6
ny &lt;- 5
# monte carlo
set.seed(1234)
repli &lt;- replicate(3000,murakami_stat(rnorm(nx),rnorm(ny),0L))
# under the null, perform the permutation test:
allem &lt;- murakami_stat_perms(nx,ny,0L)
plot(ecdf(allem)) 
lines(ecdf(repli),col='red') 


</code></pre>


</div>