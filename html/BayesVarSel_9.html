<div class="container">

<table style="width: 100%;"><tr>
<td>histBMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function for histograms-like representations of objects of class
<code>bma.coeffs</code>
</h2>

<h3>Description</h3>

<p>The columns in <code>bma.coeffs</code> are simulations of the model averaged
posterior distribution. This normally is a mixture of a discrete (at zero)
and several continuous distributions. This plot provides a convenient
graphical summary of such distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">histBMA(
  x,
  covariate,
  n.breaks = 100,
  text = TRUE,
  gray.0 = 0.6,
  gray.no0 = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>bma.coeffs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>The name of an explanatory variable whose accompanying
coefficient is to be represented. This must be the name of one of the
columns in <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.breaks</code></td>
<td>
<p>The number of equally lentgh bars for the histogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>If set to TRUE the probability of the coefficient being zero is
added in top of the bar at zero. Note: this probability is based on the
models used in <code>bma.coeffs</code> (see details in that function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gray.0</code></td>
<td>
<p>A numeric value between 0 and 1 that specifies the darkness,
in a gray scale (0 is white and 1 is black) of the bar at zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gray.no0</code></td>
<td>
<p>A numeric value between 0 and 1 that specifies the darkness,
in a gray scale (0 is white and 1 is black) of the bars different from zero</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces a histogram but with the peculiarity that the zero
values in the simulation are represented as bar centered at zero. The area
of all the bars is one and of these, the area of the bar at zero (colored
with <code>gray.0</code>) is, conditionally on the retained models (see details in
<code>BMAcoeff</code>), the probability of that coefficient be
exactly zero. This number is included in the top of the zero bar if
<code>text</code> is set to TRUE.
</p>


<h3>Author(s)</h3>

<p>Gonzalo Garcia-Donato and Anabel Forte
</p>
<p>Maintainer: &lt;anabel.forte@uv.es&gt;
</p>


<h3>See Also</h3>

<p>See <code>BMAcoeff</code>. Also see
<code>Bvs</code> and
<code>GibbsBvs</code> for creating objects of the class
<code>BMAcoeff</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## Not run: 

#Analysis of Crime Data
#load data
data(UScrime)

crime.Bvs&lt;- Bvs(formula= y ~ ., data=UScrime, n.keep=1000)
crime.Bvs.BMA&lt;- BMAcoeff(crime.Bvs, n.sim=10000)
#the best 1000 models are used in the mixture

#Observe the bimodality of the coefficient associated with regressor M
histBMA(crime.Bvs.BMA, "M")

#Note 1:
#The value in top of the bar at zero (0.251 in this case) is the probability of beta_M is
#zero conditional on a model space containing the 1000 models used in the mixture. This value
#should be closed to the exact value
#1-crime.Bvs$inclprob["M"]
#which in this case is 0.2954968
#if n.keep above is close to 2^15

#Note 2:
#The BMA posterior distribution of beta_M has two modes approximately located at 0 and 10
#If we summarize this distribution using the mean
mean(crime.Bvs.BMA[ ,"M"])
#or median
median(crime.Bvs.BMA[ ,"M"])
#we obtain values around 7 (or 7.6) which do not represent this distribution.

#With the Gibbs algorithms:
data(Ozone35)

Oz35.GibbsBvs&lt;- GibbsBvs(formula="y~.", data=Ozone35, prior.betas="gZellner",
prior.models="Constant", n.iter=10000, init.model="Full", n.burnin=100,
time.test = FALSE)
Oz35.GibbsBvs.BMA&lt;- BMAcoeff(Oz35.GibbsBvs, n.sim=10000)

histBMA(Oz35.GibbsBvs.BMA, "x6.x7")
#In this case (Gibbs sampling), the value in top of the bar at zero (0.366)
#basically should coincide (if n.sim is large enough)
#with the estimated complement of the inclusion probability
#1-Oz35.GibbsBvs$inclprob["x6.x7"]
#which in this case is 0.3638

## End(Not run)

</code></pre>


</div>