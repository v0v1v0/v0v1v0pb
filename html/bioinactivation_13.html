<div class="container">

<table style="width: 100%;"><tr>
<td>fit_inactivation_MCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting of dynamic inactivation with MCMC</h2>

<h3>Description</h3>

<p>Fits the parameters of an inactivation model to experimental using
the Markov Chain Monte Carlo fitting algorithm implemented in
the function <code>modMCMC</code> of the package <code>FME</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_inactivation_MCMC(experiment_data, simulation_model, temp_profile,
  starting_points, upper_bounds, lower_bounds, known_params, ...,
  minimize_log = TRUE, tol0 = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>experiment_data</code></td>
<td>
<p>data frame with the experimental data to be adjusted.
It must have a column named “time” and another one named
“N”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation_model</code></td>
<td>
<p>character identifying the model to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_profile</code></td>
<td>
<p>data frame with discrete values of the temperature for
each time. It must have one column named <code>time</code> and another named
<code>temperature</code> providing discrete values of the temperature at
time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting_points</code></td>
<td>
<p>starting values of the parameters for the adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_bounds</code></td>
<td>
<p>named numerical vector defining the upper bounds of the
parameters for the adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_bounds</code></td>
<td>
<p>named numerical vector defining the lower bounds of the
parameters for the adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known_params</code></td>
<td>
<p>named numerical vector with the fixed (i.e., not
adjustable) model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments for <code>modMCMC</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimize_log</code></td>
<td>
<p>logical. If <code>TRUE</code>, the adjustment is based on the
minimization of the error of the logarithmic count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol0</code></td>
<td>
<p>numeric. Observations at time 0 make Weibull-based models singular.
The time for observatins taken at time 0 are changed for this value.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of class <code>FitInactivationMCMC</code> with the following items:
</p>

<ul>
<li> <p><code>modMCMC</code>: a list of class <code>modMCMC</code> with the
information of the adjustment process.
</p>
</li>
<li>
<p> best_prediction: a list of class <code>SimulInactivation</code>
with the prediction generated by the best predictor.
</p>
</li>
<li>
<p> data: a data frame with the data used for the fitting.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## EXAMPLE 1 ------
data(dynamic_inactivation)  # The example data set is used.

get_model_data()  # Retrieve the valid model keys.

simulation_model &lt;- "Peleg"  # Peleg's model will be used

model_data &lt;- get_model_data(simulation_model)
model_data$parameters  # Set the model parameters

dummy_temp &lt;- data.frame(time = c(0, 1.25, 2.25, 4.6),
                         temperature = c(70, 105, 105, 70))  # Dummy temp. profile

## Set known parameters and initial points/bounds for unknown ones

known_params = c(temp_crit = 100)

starting_points &lt;- c(n = 1, k_b = 0.25, N0 = 1e+05)
upper_bounds &lt;- c(n = 2, k_b = 1, N0 = 1e6)
lower_bounds &lt;- c(n = 0.5, k_b = 0.1, N0 = 1e4)

MCMC_fit &lt;- fit_inactivation_MCMC(dynamic_inactivation, simulation_model,
                                     dummy_temp, starting_points,
                                     upper_bounds, lower_bounds,
                                     known_params,
                                     niter = 100)
                                     # It is recommended to increase niter

plot(MCMC_fit)
goodness_of_fit(MCMC_fit)

## END EXAMPLE 1 -----

</code></pre>


</div>