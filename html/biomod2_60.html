<div class="container">

<table style="width: 100%;"><tr>
<td>BIOMOD_RangeSize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analyze the range size differences between projections of species distribution models</h2>

<h3>Description</h3>

<p>This function allows to calculate the absolute number of locations (pixels) lost,
stable and gained, as well as the corresponding relative proportions, between two (or more)
binary projections of (ensemble) species distribution models (<em>which can represent new
time scales or environmental scenarios for example</em>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BIOMOD_RangeSize(proj.current, proj.future)

## S4 method for signature 'data.frame,data.frame'
BIOMOD_RangeSize(proj.current, proj.future)

## S4 method for signature 'SpatRaster,SpatRaster'
BIOMOD_RangeSize(proj.current, proj.future)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>proj.current</code></td>
<td>
<p>a <code>data.frame</code>, <code>RasterLayer</code>
or <code>SpatRaster</code> object containing the initial binary projection(s)
of the (ensemble) species distribution model(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj.future</code></td>
<td>
<p>a <code>data.frame</code>, <code>RasterLayer</code>
or <code>SpatRaster</code> object containing the final binary projection(s)
of the (ensemble) species distribution model(s)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that <b>this function is only relevant to compare binary projections, made on the
same area with the same resolution</b>. <br></p>
<p>Comparison between <code>proj.current</code> and <code>proj.future</code> depends
on the number of projection in both objects:</p>

<table>
<tr>
<td style="text-align: left;">
   <code>proj.current</code> </td>
<td style="text-align: left;"> <code>proj.future</code> </td>
<td style="text-align: left;"> <b>Comparison</b> </td>
</tr>
<tr>
<td style="text-align: left;">
   <b>1 projection</b> (<em>e.g. data.frame with 1 column, SpatRaster with 1 layer</em>) </td>
<td style="text-align: left;"> <b>1 projection</b>  (<em>e.g. data.frame with 1 column, SpatRaster with 1 layer</em>) </td>
<td style="text-align: left;"> comparison of both projection  (<em>e.g. current vs future conditions for the same model ; current vs current condition for two different models</em>) </td>
</tr>
<tr>
<td style="text-align: left;">
   <b><code>n</code> projections</b>  (<em>e.g. data.frame with n column, SpatRaster with n layer</em>) </td>
<td style="text-align: left;"> <b><code>n</code> projections</b>  (<em>e.g. data.frame with n column, SpatRaster with n layer</em>) </td>
<td style="text-align: left;"> comparing projection <code>i</code> in <code>proj.current</code> to projection <code>i</code> in <code>proj.future</code>  (<em>e.g. comparing current vs future condition for n models</em>) </td>
</tr>
<tr>
<td style="text-align: left;">
   <b><code>1</code> projection</b>   (<em>e.g. data.frame with 1 column, SpatRaster with 1 layer</em>) </td>
<td style="text-align: left;"> <b><code>n</code> projections</b>  (<em>e.g. data.frame with n column, SpatRaster with n layer</em>) </td>
<td style="text-align: left;"> comparing projection in <code>proj.current</code> to each projection in <code>proj.future</code>  (<em>e.g. comparing current vs n different future condition (e.g. climate change scenario) for 1 model</em>) </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><code>Diff.By.Pixel</code> object is obtained by applying the simple following formula :
</p>
<p style="text-align: center;"><code class="reqn">proj.future - 2 * proj.current</code>
</p>



<h3>Value</h3>

<p>A <code>list</code> containing two objects :
</p>

<dl>
<dt>Compt.By.Species</dt>
<dd>
<p>a <code>data.frame</code> containing the summary of range change for each
comparison
</p>

<ul>
<li> <p><code>Loss</code> : number of pixels predicted to be lost
</p>
</li>
<li> <p><code>Stable0</code> : number of pixels not currently occupied and not predicted to be
</p>
</li>
<li> <p><code>Stable1</code> : number of pixels currently occupied and predicted to remain
occupied
</p>
</li>
<li> <p><code>Gain</code> : number of pixels predicted to be gained
</p>
</li>
<li> <p><code>PercLoss</code> : percentage of pixels currently occupied and predicted to be lost
(<code>Loss / (Loss + Stable1)</code>)
</p>
</li>
<li> <p><code>PercGain</code> : percentage of pixels predicted to be gained compare to the
number of pixels currently occupied (<code>Gain / (Loss + Stable1)</code>)
</p>
</li>
<li> <p><code>SpeciesRangeChange</code> : percentage of pixels predicted to change (loss or gain)
compare to the number of pixels currently occupied (<code>PercGain - PercLoss</code>)
</p>
</li>
<li> <p><code>CurrentRangeSize</code> : number of pixels currently occupied
</p>
</li>
<li> <p><code>FutureRangeSize0Disp</code> : number of pixels predicted to be occupied, assuming
no migration
</p>
</li>
<li> <p><code>FutureRangeSize1Disp</code> : number of pixels predicted to be occupied, assuming
migration
</p>
</li>
</ul>
</dd>
<dt>Diff.By.Pixel</dt>
<dd>
<p>an object in the same form than the input data (<code>proj.current</code> and
<code>proj.future</code>) and containing a value for each point/pixel of each comparison among :
</p>

<ul>
<li> <p><code>-2</code> : predicted to be lost
</p>
</li>
<li> <p><code>-1</code> : predicted to remain occupied
</p>
</li>
<li> <p><code>0</code> : predicted to remain unoccupied
</p>
</li>
<li> <p><code>1</code> : predicted to be gained
</p>
</li>
</ul>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Wilfried Thuiller, Damien Georges, Bruno Lafourcade
</p>


<h3>See Also</h3>

<p><code>BIOMOD_Projection</code>, <code>BIOMOD_EnsembleForecasting</code>,
<code>bm_PlotRangeSize</code>
</p>
<p>Other Main functions: 
<code>BIOMOD_EnsembleForecasting()</code>,
<code>BIOMOD_EnsembleModeling()</code>,
<code>BIOMOD_FormatingData()</code>,
<code>BIOMOD_LoadModels()</code>,
<code>BIOMOD_Modeling()</code>,
<code>BIOMOD_Projection()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(terra)

# Load species occurrences (6 species available)
data(DataSpecies)
head(DataSpecies)

# Select the name of the studied species
myRespName &lt;- 'GuloGulo'

# Get corresponding presence/absence data
myResp &lt;- as.numeric(DataSpecies[, myRespName])

# Get corresponding XY coordinates
myRespXY &lt;- DataSpecies[, c('X_WGS84', 'Y_WGS84')]

# Load environmental variables extracted from BIOCLIM (bio_3, bio_4, bio_7, bio_11 &amp; bio_12)
data(bioclim_current)
myExpl &lt;- terra::rast(bioclim_current)



# --------------------------------------------------------------- #
file.out &lt;- paste0(myRespName, "/", myRespName, ".AllModels.models.out")
if (file.exists(file.out)) {
  myBiomodModelOut &lt;- get(load(file.out))
} else {

  # Format Data with true absences
  myBiomodData &lt;- BIOMOD_FormatingData(resp.var = myResp,
                                       expl.var = myExpl,
                                       resp.xy = myRespXY,
                                       resp.name = myRespName)

  # Model single models
  myBiomodModelOut &lt;- BIOMOD_Modeling(bm.format = myBiomodData,
                                      modeling.id = 'AllModels',
                                      models = c('RF', 'GLM'),
                                      CV.strategy = 'random',
                                      CV.nb.rep = 2,
                                      CV.perc = 0.8,
                                      OPT.strategy = 'bigboss',
                                      metric.eval = c('TSS','ROC'),
                                      var.import = 3,
                                      seed.val = 42)
}

models.proj &lt;- get_built_models(myBiomodModelOut, algo = "RF")
  # Project single models
  myBiomodProj &lt;- BIOMOD_Projection(bm.mod = myBiomodModelOut,
                                    proj.name = 'CurrentRangeSize',
                                    new.env = myExpl,
                                    models.chosen = models.proj,
                                    metric.binary = 'all',
                                    build.clamping.mask = TRUE)


# --------------------------------------------------------------- #
# Load environmental variables extracted from BIOCLIM (bio_3, bio_4, bio_7, bio_11 &amp; bio_12)
data(bioclim_future)
myExplFuture &lt;- terra::rast(bioclim_future)

# Project onto future conditions
myBiomodProjectionFuture &lt;- BIOMOD_Projection(bm.mod = myBiomodModelOut,
                                              proj.name = 'FutureRangeSize',
                                              new.env = myExplFuture,
                                              models.chosen = models.proj,
                                              metric.binary = 'TSS')

# Load current and future binary projections
CurrentProj &lt;- get_predictions(myBiomodProj,
                               metric.binary = "TSS",
                               model.as.col = TRUE)
FutureProj &lt;- get_predictions(myBiomodProjectionFuture,
                               metric.binary = "TSS",
                               model.as.col = TRUE)
# Compute differences
myBiomodRangeSize &lt;- BIOMOD_RangeSize(proj.current = CurrentProj, proj.future = FutureProj)

myBiomodRangeSize$Compt.By.Models
plot(myBiomodRangeSize$Diff.By.Pixel)

# Represent main results 
bm_PlotRangeSize(bm.range = myBiomodRangeSize)


</code></pre>


</div>