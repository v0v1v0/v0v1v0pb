<div class="container">

<table style="width: 100%;"><tr>
<td>dmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate a mixture density</h2>

<h3>Description</h3>

<p>Evaluates mixture densities of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \sum_{j=1}^k f(x|\theta^{(k)}) w_k</code>
</p>

<p>where the <code class="reqn">w_k</code> are (possibly negative) weights that sum to 1 and 
<code class="reqn">f(x|\theta^{(k)})</code> are densities that are specified via parameters
<code class="reqn">\theta^{(k)}</code>, which are passed in the function argument 
<code>params</code>.
A unique feature of this function is that it is able to evaluate mixture
densities in which some of the mixture weights <code class="reqn">w_k</code> are negative.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmix(x, f, params, wts, log = FALSE, errorNodesWts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Points at which the mixture should be evaluated.  If the density 
is multivariate, then each row of <code>x</code> should contain one set of 
points at which the mixture should be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Density used in the mixture. The function should be defined so it 
is can be called via <code>f(x, params, log, ...)</code>.  The density <code class="reqn">f</code>
is evaluated at the points in <code>x</code> using one set of parameters 
<code>params</code>, i.e., for some specific <code class="reqn">\theta^{(k)}</code>.
if <code>log==TRUE</code>, then <code class="reqn">ln(f)</code> is returned.  Additional parameters
may be passed to <code class="reqn">f</code> via <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Matrix in which each row contains parameters that define
<code class="reqn">f</code>.  The number of rows in <code>params</code> should match the number of 
mixture components <code class="reqn">k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>vector of weights for each mixture component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>TRUE to return the log of the mixture density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorNodesWts</code></td>
<td>
<p>list with elements <code>inds</code> and <code>weights</code> that 
point out which <code>params</code> get used to compute an approximation of the 
quadrature error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>f</code></p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># evaluate mixture density at these locations
x = seq(0, 1, length.out = 100)

# density will be a mixture of beta distributions
f = function(x, theta, log = FALSE) {
  dbeta(x, shape1 = theta[1], shape2 = theta[2], log = log)
}

# beta parameters are randomly assigned
params = matrix(exp(2*runif(10)), ncol=2)

# mixture components are equally weighted
wts = rep(1/nrow(params), nrow(params))

# evaluate mixture density
fmix = dmix(x = x, f = f, params = params, wts = wts)

# plot mixture density
plot(x, fmix, type='l', ylab = expression(f(x)), 
     ylim = c(0, 4))

# plot component densities
for(i in 1:length(wts)){
  curve(f(x, params[i,]), col = 2, add = TRUE)
}
</code></pre>


</div>