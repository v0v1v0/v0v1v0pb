<div class="container">

<table style="width: 100%;"><tr>
<td>selRes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluation of the selection accuracy of a prediction model</h2>

<h3>Description</h3>

<p>This function computes several criteria to assess the selection
accuracy of a prediction model. Of note, this function is only
available for simulated data sets for which true biomarkers are known.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selRes(res)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>an object of class '<code>resBMsel</code>' generated by <code>BMsel</code> with data simulated using <code>simdata</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Based on the 2x2 contingency table (active vs. inactive / selected vs. unselected),
four selection criteria are provided: <br>
- the false discovery rate (<code>FDR</code>) that is the proportion of inactive biomarkers
among the selected ones, <br>
- the false non-discovery rate (<code>FNDR</code>) that is the proportion of active biomarkers
among the unselected ones, <br>
- the false negative rate (<code>FNR</code>) that is the proportion of unselected
biomarkers among the active ones,<br>
- the false positive rate (<code>FPR</code>) that is the proportion of selected
biomarkers among the inactive ones.<br>
These four criteria are between 0 and 1, and must be minimized.<br> 
We also provided two discrimination criteria, translating the ability to discard inactive
biomarkers more likely than active ones independently of the tuning parameters: <br>
- the area under the ROC curve (<code>AUC</code>) depending on the sensitivity [1 - FNR] and specificity [1 - FPR],<br>
- the area under the precision-recall curve (<code>AUPRC</code>) depending on the FNR and FDR (Davis and Goadrich, 2006).<br>
Of note, the AUPRC is more meaningful than the AUC when there are many more inactive than active biomarkers. 
These two criteria are between 0 and 1, and must be maximized.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> of dimension 6 x the number of methods used to fit <code>res</code>.
</p>


<h3>Author(s)</h3>

<p>Nils Ternes, Federico Rotolo, and Stefan Michiels<br>
Maintainer: Nils Ternes <a href="mailto:nils.ternes@yahoo.com">nils.ternes@yahoo.com</a>
</p>


<h3>References</h3>

<p>Davis J and Goadrich M.
The relationship between Precision-Recall and ROC curves.
<em>Proceedings of the 23rd International Conference on Machine Learning</em>.
ACM, Pittsburgh PA, 233-240.<br>
Ternes N, Rotolo F and Michiels S.
Empirical extensions of the lasso penalty to reduce
the false discovery rate in high-dimensional Cox regression models.
<em>Statistics in Medicine</em> 2016;35(15):2561-2573.
doi:<a href="http://onlinelibrary.wiley.com/doi/10.1002/sim.6927/abstract">10.1002/sim.6927</a><br>
Ternes N, Rotolo F, Heinze G and Michiels S.
Identification of biomarker-by-treatment interactions in randomized
clinical trials with survival outcomes and high-dimensional spaces.
<em>Biometrical journal</em>. In press.
doi:<a href="http://onlinelibrary.wiley.com/doi/10.1002/bimj.201500234/abstract">10.1002/bimj.201500234</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">########################################
# Simulated data set
########################################

## Low calculation time
  set.seed(654321)
  sdata &lt;- simdata(
    n = 500, p = 20, q.main = 3, q.inter = 0,
    prob.tt = 0.5, alpha.tt = 0,
    beta.main = -0.8,
    b.corr = 0.6, b.corr.by = 4,
    m0 = 5, wei.shape = 1, recr = 4, fu = 2,
    timefactor = 1)

  resBM &lt;- BMsel(
    data = sdata, 
    method = c("lasso", "lasso-pcvl"), 
    inter = FALSE, 
    folds = 5)
  
  selAcc &lt;- selRes(resBM)

## Not run: 
## Moderate calculation time
  set.seed(123456)
  sdata &lt;- simdata(
    n = 500, p = 100, q.main = 5, q.inter = 5,
    prob.tt = 0.5, alpha.tt = -0.5,
    beta.main = c(-0.5, -0.2), beta.inter = c(-0.7, -0.4),
    b.corr = 0.6, b.corr.by = 10,
    m0 = 5, wei.shape = 1, recr = 4, fu = 2,
    timefactor = 1,
    active.inter = c("bm003", "bm021", "bm044", "bm049", "bm097"))

  resBM &lt;- BMsel(
    data = sdata, 
    method = c("lasso", "lasso-pcvl"), 
    inter = TRUE, 
    folds = 5)
  
  selAcc &lt;- selRes(resBM)

## End(Not run)
</code></pre>


</div>