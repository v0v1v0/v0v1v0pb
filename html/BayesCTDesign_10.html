<div class="container">

<table style="width: 100%;"><tr>
<td>simple_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two Arm Bayesian Clinical Trial Simulation without Historical Data</h2>

<h3>Description</h3>

<p><code>simple_sim()</code> returns an S3 object of class <code>bayes_ctd_array</code>, which
will contain simulation results for power, statistic estimation, bias, variance,
and mse as requested by user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simple_sim(
  trial_reps = 100,
  outcome_type = "weibull",
  subj_per_arm = c(50, 100, 150, 200, 250),
  effect_vals = c(0.6, 1, 1.4),
  control_parms = NULL,
  time_vec = NULL,
  censor_value = NULL,
  alpha = 0.05,
  get_var = FALSE,
  get_bias = FALSE,
  get_mse = FALSE,
  seedval = NULL,
  quietly = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trial_reps</code></td>
<td>
<p>Number of trials to replicate within each combination of
<code>a0_vals</code>, <code>subj_per_arm</code>, <code>effect_vals</code>, and <code>rand_control_parms</code>.
As the number of trials increases, the precision of the estimate will increase.
Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome_type</code></td>
<td>
<p>Outcome distribution. Must be equal to <code>weibull</code>,
<code>lognormal</code>, <code>pwe</code> (Piecewise Exponential), <code>gaussian</code>,
<code>bernoulli</code>, or <code>poisson</code>.  Default is <code>weibull</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subj_per_arm</code></td>
<td>
<p>A vector of sample sizes, all of which must be positive
integers.  Default is <code>c(50, 100, 150, 200, 250)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_vals</code></td>
<td>
<p>A vector of effects that should be reasonable for the
outcome_type being studied, hazard ratios for Weibull, odds ratios for
Bernoulli, mean ratios for Poisson, etc..  When <code>effect_vals</code> contain
the null effect for a given <code>outcome_type</code>, the <code>power</code> component
of <code>data</code> will contain an estimate of Type One Error.  In order to
have a good set of Type One Error estimates, <code>trial_reps</code> need to be
at least 10,000.  In such a case, if the total number of combinations
made up from <code>subj_per_arm</code>, <code>a0_vals</code>, <code>effect_vals</code>, and
<code>rand_control_diff</code> is very large, the time to complete the simulation
can be substantial. Default is <code>c(0.6, 1, 1.4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control_parms</code></td>
<td>
<p>A vector of parameter values defining the outcome
distribution for randomized controls. See Details for what is required for
each <code>outcome_type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_vec</code></td>
<td>
<p>A vector of time values that are used to create time periods
within which the exponential hazard is constant.  Only used for piecewise
exponential models.  Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor_value</code></td>
<td>
<p>A single value at which right censoring occurs when
simulating randomized subject outcomes.  Used with survival outcomes.
Default is <code>NULL</code>, where <code>NULL</code> implies no right censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A number ranging between 0 and 1 that defines the acceptable Type 1
error rate. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_var</code></td>
<td>
<p>A TRUE/FALSE indicator of whether an array of variance
estimates will be returned.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_bias</code></td>
<td>
<p>A TRUE/FALSE indicator of whether an array of bias
estimates will be returned.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_mse</code></td>
<td>
<p>A TRUE/FALSE indicator of whether an array of MSE
estimates will be returned.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seedval</code></td>
<td>
<p>A seed value for pseudo-random number generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>
<p>A TRUE/FALSE indicator of whether notes are printed
to output about simulation progress as the simulation runs.  If
running interactively in RStudio or running in the R console,
<code>quietly</code> can be set to FALSE.  If running in a Notebook or
knitr document, <code>quietly</code> needs to be set to TRUE.  Otherwise
each note will be printed on a separate line and it will take up
a lot of output space.  Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The object <code>bayes_ctd_array</code> has 6 elements: a list containing simulation
results (<code>data</code>), copies of the 4 function arguments <code>subj_per_arm</code>,
<code>a0_vals</code>, <code>effect_vals</code>, and <code>rand_control_diff</code>, and finally
a <code>objtype</code> value indicating that <code>simple_sim()</code> was used. Each element of
<code>data</code> is a four-dimensional array, where each dimension is determined by the
length of parameters <code>subj_per_arm</code>, <code>a0_vals</code>, <code>effect_vals</code>, and
<code>rand_control_diff</code>. The size of <code>data</code> depends on which results are
requested by the user. At a minimum, at least one of <code>subj_per_arm</code>,
<code>a0_vals</code>, <code>effect_vals</code>, or <code>rand_control_diff</code> must contain at
least 2 values, while the other three must contain at least 1 value.  The <code>data</code>
list will always contain two elements: an array of power results (<code>power</code>) and
an array of estimation results (<code>est</code>).  In addition to <code>power</code> and
<code>est</code>, <code>data</code> may also contain elements <code>var</code>, <code>bias</code>, or
<code>mse</code>, depending on the values of <code>get_var</code>, <code>get_bias</code>, and
<code>get_mse</code>. The values returned in <code>est</code> are in the form of hazard ratios,
mean ratios, odds ratios, or mean differences depending on the value of
<code>outcome_type</code>.   For a Gaussian outcome, the estimation results are
differences in group means (experimental group minus control group). For a
logistic outcome, the estimation results are odds ratios (experimental group over
control group). For lognormal and Poisson outcomes, the estimation results are mean
ratios (experimental group over control group). For a piecewise exponential or a
Weibull outcome, the estimation results are hazard ratios (experimental group over
control group).  The values returned in <code>bias</code>, <code>var</code>, and <code>mse</code> are
on the scale of the values returned in <code>est</code>.
</p>
<p>The object <code>bayes_ctd_array</code> has two primary methods, <code>print()</code> and
<code>plot()</code>, for printing and plotting slices of the arrays contained in
<code>bayes_ctd_array$data</code>.
</p>
<p>As dimensions of the four dimensional array increases, the time required to complete
the simulation will increase; however, it will be faster than a similar simulation
based on repeated calls to MCMC routines to analyze each simulated trial.
</p>
<p>The meaning of the estimation results, and the test used to generate power results,
depends on the outcome used. In all cases, power is based on a two-sided test
involving a (1-alpha)100% credible interval, where the interval is used to determine
if the null hypothesis should be rejected (null value outside of the interval) or
not rejected (null value inside the interval). For a Gaussian outcome, the 95%
credible interval is an interval for the difference in group means
(experimental group minus control group), and the test determines if 0 is in or
outside of the interval. For a Bernoulli outcome, the 95% credible interval
is an interval for the odds ratio (experimental group over control group),
and the test determines if 1 is in or outside of the interval. For a lognormal or
a Poisson outcome, the 95% credible interval is an interval for the mean ratio
(experimental group over control group), and the test determines if 1 is in or
outside of the interval. Finally, for a piecewise exponential or a Weibull outcome,
the 95% credible interval is an interval for the hazard ratio (experimental group
over control group), and the test determines if 1 is in or outside of the interval.
</p>
<p>For a Gaussian outcome, the <code>control_parms</code> values should be <code>(mean, sd)</code>,
where mean is the mean parameter for the control group used in a call to <code>rnorm()</code>,
and sd is the common sd parameter for both groups used in a call to<code>rlnorm()</code>.
</p>
<p>For a Bernoulli outcome, the <code>control_parms</code> values should be <code>(prob)</code>, where
prob is the event probability for the control group used in a call to <code>rbinom()</code>.
</p>
<p>For a lognormal outcome, the <code>control_parms</code> values should be <code>(meanlog, sdlog)</code>,
where meanlog is the meanlog parameter for the control group used in a call to
<code>rlnorm()</code>, and sdlog is the common sdlog parameter for both groups used in
a call to <code>rlnorm()</code>.
</p>
<p>For a Poisson outcome, the <code>control_parms</code> value should be <code>(lambda)</code>, where
lambda is the lambda parameter for the control group used in a call to <code>rpois()</code> and
is equal to the mean of a Poisson distribution.
</p>
<p>For a Weibull outcome, the <code>control_parms</code> values should be <code>(scale, shape)</code>,
where scale is the scale parameter for the control group used in a call to
<code>rweibull()</code>, and shape is the common shape parameter for both groups used in
a call to <code>rweibull()</code>.
</p>
<p>For a piecewise exponential outcome, the <code>control_parms</code> values should be a vector
of lambdas used in a call to <code>eha::rpch()</code>.  Each element in <code>control_parms</code>
is a hazard for an interval defined by the <code>time_vec</code> parameter.
</p>
<p>Please refer to the examples for illustration of package use.
</p>


<h3>Value</h3>

<p><code>simple_sim()</code> returns an S3 object of class <code>bayes_ctd_array</code>.
As noted in Details, an object of class <code>bayes_ctd_array</code> has 6 elements: a
list containing simulation results (<code>data</code>), copies of the 4 function
arguments <code>subj_per_arm</code>, <code>a0_vals</code>, <code>effect_vals</code>, and
<code>rand_control_diff</code>, and finally <code>objtype</code> indicating that <code>simple_sim()</code>
was used. See Details for a discussion about the contents of
<code>data</code>. Results from the simulation contained in the <code>bayes_ctd_array</code>
object can be printed or plotted using the <code>print()</code> and
<code>plot()</code> methods. The results can also be accessed using basic list
element identification and array slicing. For example, to get the power results
from a simulation, one could use the code <code>bayes_ctd_array$data$power</code>, where
<code>bayes_ctd_array</code> is replaced with the name of the variable containing the
<code>bayes_ctd_array</code> object. Even though this is a 4-dimensional array, the power
results only occupy a single 2-dimensional table. To print this 2-dimensional table,
one would use the code <code>bayes_ctd_array$data$power[,1,,1]</code>, where
<code>bayes_ctd_array</code> is replaced with the name of the variable containing the
<code>bayes_ctd_array</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Run a Weibull simulation, using simple_sim().
#For meaningful results, trial_reps needs to be much larger than 2.
weibull_test &lt;- simple_sim(trial_reps = 2, outcome_type = "weibull",
                           subj_per_arm = c(50, 100, 150, 200),
                           effect_vals = c(0.6, 1, 1.4),
                           control_parms = c(2.82487,3), time_vec = NULL,
                           censor_value = NULL, alpha = 0.05,
                           get_var = TRUE, get_bias = TRUE, get_mse = TRUE,
                           seedval=123, quietly=TRUE)

#Tabulate the simulation results for power.
test_table &lt;- print(x=weibull_test, measure="power",
                    tab_type=NULL, subj_per_arm_val=NULL, a0_val=NULL,
                    effect_val=NULL, rand_control_diff_val=NULL)
print(test_table)

#Create a plot of the power simulation results.
plot(x=weibull_test, measure="power", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE)
#Create a plot of the estimated hazard ratio simulation results.
plot(x=weibull_test, measure="est", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE)
#Create a plot of the hazard ratio variance simulation results.
plot(x=weibull_test, measure="var", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE)
#Create a plot of the hazard ratio bias simulation results.
plot(x=weibull_test, measure="bias", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE)
#Create a plot of the hazard ratio mse simulation results.
plot(x=weibull_test, measure="mse", tab_type=NULL,
     smooth=FALSE, plot_out=TRUE)
</code></pre>


</div>