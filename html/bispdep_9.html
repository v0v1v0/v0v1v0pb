<div class="container">

<table style="width: 100%;"><tr>
<td>moran.bi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Bivariate Moran's Ixy</h2>

<h3>Description</h3>

<p>A simple function to compute bivariate Moran's Ixy, called by <code>moranbi.test</code> and <code>moranbi.mc</code>;
</p>
<p style="text-align: center;"><code class="reqn">I = \frac{n}{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}}
\frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_i-\bar{x})(y_j-\bar{y})}{\sum_{i=1}^{n}(x_i - \bar{x})^2}
</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">moran.bi(varX, varY, listw, zero.policy=NULL, adjust.n = TRUE, NAOK=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>varX</code></td>
<td>
<p>a numeric vector of the same length as the neighbours list in listw with the values of the variable <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varY</code></td>
<td>
<p>a numeric vector of the same length as the neighbours list in listw with the values of the variable <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.n</code></td>
<td>
<p>default TRUE, if FALSE the number of observations is not adjusted for no-neighbour observations, if TRUE, the number of observations is adjusted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAOK</code></td>
<td>
<p>if 'TRUE' then any 'NA' or 'NaN' or 'Inf' values in x are passed on to the foreign function.  If 'FALSE', the presence of 'NA' or 'NaN' or 'Inf' values is regarded as an error</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Bivariate Moran's I</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kx</code></td>
<td>
<p>sample kurtosis of the variable X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ky</code></td>
<td>
<p>sample kurtosis of the variable Y</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Czaplewski, R.L., Reich, R.M. 1993. Expected value and variance of Moran's bivariate spatial autocorrelation statistic for a permutation test, Research paper RM-309, Fort Collins, CO U.S. Department of Agriculture, Forest Service, Rocky Mountain Forest and Range Experiment Station, p, 13.</p>


<h3>See Also</h3>

<p><code>moranbi.test</code>, <code>moranbi.mc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(spdep)
data(oldcol)
col.W &lt;- nb2listw(COL.nb, style="W")
crime &lt;- COL.OLD$CRIME
inc &lt;- COL.OLD$INC
str(moran.bi(crime, inc, col.W, zero.policy = TRUE, NAOK=FALSE))
set.seed(123)
is.na(crime) &lt;- sample(1:length(crime), 5)
is.na(inc) &lt;- sample(1:length(inc), 10)
str(moran.bi(crime, inc, col.W, zero.policy = TRUE, NAOK=TRUE))
</code></pre>


</div>