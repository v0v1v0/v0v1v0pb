<div class="container">

<table style="width: 100%;"><tr>
<td>post_coint_kls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Draw for Cointegration Models</h2>

<h3>Description</h3>

<p>Produces a draw of coefficients for cointegration models with a prior on
the cointegration space as proposed in Koop et al. (2010) and a draw of
non-cointegration coefficients from a normal density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">post_coint_kls(
  y,
  beta,
  w,
  sigma_i,
  v_i,
  p_tau_i,
  g_i,
  x = NULL,
  gamma_mu_prior = NULL,
  gamma_v_i_prior = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code class="reqn">K \times T</code> matrix of differenced endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a <code class="reqn">M \times r</code> cointegration matrix <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a <code class="reqn">M \times T</code> matrix of variables in the cointegration term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_i</code></td>
<td>
<p>an inverse of the <code class="reqn">K \times K</code> variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_i</code></td>
<td>
<p>a numeric between 0 and 1 specifying the shrinkage of the cointegration space prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_tau_i</code></td>
<td>
<p>an inverted <code class="reqn">M \times M</code> matrix specifying the central location
of the cointegration space prior of <code class="reqn">sp(\beta)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_i</code></td>
<td>
<p>a <code class="reqn">K \times K</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code class="reqn">N \times T</code> matrix of differenced regressors and unrestricted deterministic terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_mu_prior</code></td>
<td>
<p>a <code class="reqn">KN \times 1</code> prior mean vector of non-cointegration coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_v_i_prior</code></td>
<td>
<p>an inverted <code class="reqn">KN \times KN</code> prior covariance matrix of non-cointegration coefficients.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function produces posterior draws of the coefficient
matrices <code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and <code class="reqn">\Gamma</code> for the model
</p>
<p style="text-align: center;"><code class="reqn">y_{t} = \alpha \beta^{\prime} w_{t-1} + \Gamma z_{t} + u_{t},</code>
</p>

<p>where <code class="reqn">y_{t}</code> is a K-dimensional vector of differenced endogenous variables.
<code class="reqn">w_{t}</code> is an <code class="reqn">M \times 1</code> vector of variables in the cointegration term,
which include lagged values of endogenous and exogenous variables in levels and
restricted deterministic terms. <code class="reqn">z_{t}</code> is an N-dimensional vector of
differenced endogenous and exogenous explanatory variabes as well as unrestricted
deterministic terms. The error term is <code class="reqn">u_t \sim \Sigma</code>.
</p>
<p>Draws of the loading matrix <code class="reqn">\alpha</code> are obtained using the prior on the cointegration space
as proposed in Koop et al. (2010). The posterior covariance matrix is
</p>
<p style="text-align: center;"><code class="reqn">\overline{V}_{\alpha} = \left[\left(v^{-1} (\beta^{\prime} P_{\tau}^{-1} \beta) \otimes G_{-1}\right) + \left(ZZ^{\prime} \otimes \Sigma^{-1} \right) \right]^{-1}</code>
</p>

<p>and the posterior mean by
</p>
<p style="text-align: center;"><code class="reqn">\overline{\alpha} = \overline{V}_{\alpha} + vec(\Sigma^{-1} Y Z^{\prime}),</code>
</p>

<p>where <code class="reqn">Y</code> is a <code class="reqn">K \times T</code> matrix of differenced endogenous variables and
<code class="reqn">Z = \beta^{\prime} W</code> with <code class="reqn">W</code> as an <code class="reqn">M \times T</code> matrix of
variables in the cointegration term.
</p>
<p>For a given prior mean vector <code class="reqn">\underline{\Gamma}</code> and prior covariance matrix <code class="reqn">\underline{V_{\Gamma}}</code>
the posterior covariance matrix of non-cointegration coefficients in <code class="reqn">\Gamma</code> is obtained by
</p>
<p style="text-align: center;"><code class="reqn">\overline{V}_{\Gamma} = \left[ \underline{V}_{\Gamma}^{-1} + \left(X X^{\prime} \otimes \Sigma^{-1} \right) \right]^{-1}</code>
</p>

<p>and the posterior mean by
</p>
<p style="text-align: center;"><code class="reqn">\overline{\Gamma} = \overline{V}_{\Gamma} \left[ \underline{V}_{\Gamma}^{-1} \underline{\Gamma} + vec(\Sigma^{-1} Y X^{\prime}) \right],</code>
</p>

<p>where <code class="reqn">X</code> is an <code class="reqn">M \times T</code> matrix of
explanatory variables, which do not enter the cointegration term.
</p>
<p>Draws of the cointegration matrix <code class="reqn">\beta</code> are obtained using the prior on the cointegration space
as proposed in Koop et al. (2010). The posterior covariance matrix of the unrestricted cointegration
matrix <code class="reqn">B</code> is
</p>
<p style="text-align: center;"><code class="reqn">\overline{V}_{B} = \left[\left(A^{\prime} G^{-1} A \otimes v^{-1} P_{\tau}^{-1} \right) + \left(A^{\prime} \Sigma^{-1} A \otimes WW^{\prime} \right) \right]^{-1}</code>
</p>

<p>and the posterior mean by
</p>
<p style="text-align: center;"><code class="reqn">\overline{B} = \overline{V}_{B} + vec(W Y_{B}^{-1} \Sigma^{-1} A),</code>
</p>

<p>where <code class="reqn">Y_{B} = Y - \Gamma X</code> and <code class="reqn">A = \alpha (\alpha^{\prime} \alpha)^{-\frac{1}{2}}</code>.
</p>
<p>The final draws of <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are calculated using
<code class="reqn">\beta = B (B^{\prime} B)^{-\frac{1}{2}}</code> and
<code class="reqn">\alpha = A (B^{\prime} B)^{\frac{1}{2}}</code>.
</p>


<h3>Value</h3>

<p>A named list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a draw of the <code class="reqn">K \times r</code> loading matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a draw of the <code class="reqn">M \times r</code> cointegration matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>a draw of the <code class="reqn">K \times M</code> cointegration matrix <code class="reqn">\Pi = \alpha \beta^{\prime}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>a draw of the <code class="reqn">K \times N</code> coefficient matrix for non-cointegration parameters.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Koop, G., León-González, R., &amp; Strachan R. W. (2010). Efficient posterior
simulation for cointegrated models with priors on the cointegration space.
<em>Econometric Reviews, 29</em>(2), 224-242. <a href="https://doi.org/10.1080/07474930903382208">doi:10.1080/07474930903382208</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load data
data("e6")

# Generate model data
temp &lt;- gen_vec(e6, p = 1, r = 1)
y &lt;- t(temp$data$Y)
ect &lt;- t(temp$data$W)

k &lt;- nrow(y) # Endogenous variables
tt &lt;- ncol(y) # Number of observations

# Initial value of Sigma
sigma &lt;- tcrossprod(y) / tt
sigma_i &lt;- solve(sigma)

# Initial values of beta
beta &lt;- matrix(c(1, -4), k)

# Draw parameters
coint &lt;- post_coint_kls(y = y, beta = beta, w = ect, sigma_i = sigma_i,
                        v_i = 0, p_tau_i = diag(1, k), g_i = sigma_i)

</code></pre>


</div>