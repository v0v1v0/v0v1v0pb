<div class="container">

<table style="width: 100%;"><tr>
<td>two.grp.fixed.a0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model fitting for two groups (treatment and control group, no covariates) with fixed a0</h2>

<h3>Description</h3>

<p>Model fitting using power priors for two groups (treatment and control group, no covariates) with fixed <code class="reqn">a_0</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">two.grp.fixed.a0(
  data.type,
  y.c,
  n.c,
  v.c,
  historical = matrix(0, 1, 4),
  prior.mu.c.shape1 = 1,
  prior.mu.c.shape2 = 1,
  nMC = 10000,
  nBI = 250
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.type</code></td>
<td>
<p>Character string specifying the type of response. The options are "Normal", "Bernoulli", "Poisson" and "Exponential".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.c</code></td>
<td>
<p>Sum of responses for the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.c</code></td>
<td>
<p>Sample size of the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.c</code></td>
<td>
<p>(For normal data only) sample variance of responses for the control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>historical</code></td>
<td>
<p>(Optional) matrix of historical dataset(s). If <code>data.type</code> is "Normal", <code>historical</code> is a matrix with four columns:
</p>

<ul>
<li>
<p> The first column contains the sum of responses for the control group.
</p>
</li>
<li>
<p> The second column contains the sample size of the control group.
</p>
</li>
<li>
<p> The third column contains the sample variance of responses for the control group.
</p>
</li>
<li>
<p> The fourth column contains the discounting parameter value <code class="reqn">a_0</code> (between 0 and 1).
</p>
</li>
</ul>
<p>For all other data types, <code>historical</code> is a matrix with three columns:
</p>

<ul>
<li>
<p> The first column contains the sum of responses for the control group.
</p>
</li>
<li>
<p> The second column contains the sample size of the control group.
</p>
</li>
<li>
<p> The third column contains the discounting parameter value <code class="reqn">a_0</code> (between 0 and 1).
</p>
</li>
</ul>
<p>Each row represents a historical dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.mu.c.shape1</code></td>
<td>
<p>First hyperparameter of the initial prior for <code class="reqn">\mu_c</code>. The default is 1. Does not apply if <code>data.type</code> is "Normal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.mu.c.shape2</code></td>
<td>
<p>Second hyperparameter of the initial prior for <code class="reqn">\mu_c</code>. The default is 1. Does not apply if <code>data.type</code> is "Normal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMC</code></td>
<td>
<p>(For normal data only) number of iterations (excluding burn-in samples) for the Gibbs sampler. The default is 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBI</code></td>
<td>
<p>(For normal data only) number of burn-in samples for the Gibbs sampler. The default is 250.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power prior is applied on the data of the control group only.
Therefore, only summaries of the responses of the control group need to be entered.
</p>
<p>If <code>data.type</code> is "Bernoulli", "Poisson" or "Exponential", a single response from the treatment group is assumed to follow Bern(<code class="reqn">\mu_t</code>), Pois(<code class="reqn">\mu_t</code>) or Exp(rate=<code class="reqn">\mu_t</code>), respectively,
where <code class="reqn">\mu_t</code> is the mean of responses for the treatment group. The distributional assumptions for the control group data are analogous.
</p>
<p>If <code>data.type</code> is "Bernoulli", the initial prior for <code class="reqn">\mu_t</code> is beta(<code>prior.mu.t.shape1</code>, <code>prior.mu.t.shape2</code>).
If <code>data.type</code> is "Poisson", the initial prior for <code class="reqn">\mu_t</code> is Gamma(<code>prior.mu.t.shape1</code>, rate=<code>prior.mu.t.shape2</code>).
If <code>data.type</code> is "Exponential", the initial prior for <code class="reqn">\mu_t</code> is Gamma(<code>prior.mu.t.shape1</code>, rate=<code>prior.mu.t.shape2</code>).
The initial priors used for the control group data are analogous.
</p>
<p>If <code>data.type</code> is "Normal", the responses are assumed to follow <code class="reqn">N(\mu_c, \tau^{-1})</code> where <code class="reqn">\mu_c</code> is the mean of responses for the control group
and <code class="reqn">\tau</code> is the precision parameter. Each historical dataset <code class="reqn">D_{0k}</code> is assumed to have a different precision parameter <code class="reqn">\tau_k</code>.
The initial prior for <code class="reqn">\tau</code> is the Jeffery's prior, <code class="reqn">\tau^{-1}</code>, and the initial prior for <code class="reqn">\tau_k</code> is <code class="reqn">\tau_k^{-1}</code>. The initial prior for the <code class="reqn">\mu_c</code> is the uniform improper prior.
Posterior samples are obtained through Gibbs sampling.
</p>


<h3>Value</h3>

<p>The function returns a S3 object with a <code>summary</code> method. If <code>data.type</code> is "Normal", posterior samples of <code class="reqn">\mu_c</code>, <code class="reqn">\tau</code> and <code class="reqn">\tau_k</code>'s (if historical data is given) are returned
in the list item named <code>posterior.params</code>.
For all other data types, two scalars, <code class="reqn">c_1</code> and <code class="reqn">c_2</code>, are returned in the list item named <code>posterior.params</code>, representing the two parameters of the posterior distribution of <code class="reqn">\mu_c</code>.
For Bernoulli responses, the posterior distribution of <code class="reqn">\mu_c</code> is beta(<code class="reqn">c_1</code>, <code class="reqn">c_2</code>).
For Poisson responses, the posterior distribution of <code class="reqn">\mu_c</code> is Gamma(<code class="reqn">c_1</code>, <code class="reqn">c_2</code>) where <code class="reqn">c_2</code> is the rate parameter.
For exponential responses, the posterior distribution of <code class="reqn">\mu_c</code> is Gamma(<code class="reqn">c_1</code>, <code class="reqn">c_2</code>) where <code class="reqn">c_2</code> is the rate parameter.
</p>


<h3>References</h3>

<p>Chen, Ming-Hui, et al. "Bayesian design of noninferiority trials for medical devices using historical data." Biometrics 67.3 (2011): 1163-1170.
</p>


<h3>See Also</h3>

<p><code>power.two.grp.fixed.a0</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data.type &lt;- "Bernoulli"
y.c &lt;- 70
n.c &lt;- 100

# Simulate three historical datasets
historical &lt;- matrix(0, ncol=3, nrow=3)
historical[1,] &lt;- c(70, 100, 0.3)
historical[2,] &lt;- c(60, 100, 0.5)
historical[3,] &lt;- c(50, 100, 0.7)

set.seed(1)
result &lt;- two.grp.fixed.a0(data.type=data.type, y.c=y.c, n.c=n.c, historical=historical)
summary(result)
</code></pre>


</div>