<div class="container">

<table style="width: 100%;"><tr>
<td>pnbd.EstimateParameters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pareto/NBD Parameter Estimation</h2>

<h3>Description</h3>

<p>The best-fitting parameters are determined using the
<code>pnbd.cbs.LL</code> function. The sum of the log-likelihood for each
customer (for a set of parameters) is maximized in order to estimate
parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pnbd.EstimateParameters(
  cal.cbs,
  par.start = c(1, 1, 1, 1),
  max.param.value = 10000,
  method = "L-BFGS-B",
  hardie = TRUE,
  hessian = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cal.cbs</code></td>
<td>
<p>calibration period CBS (customer by sufficient statistic). It
must contain columns for frequency ("x"), recency ("t.x"), and total time
observed ("T.cal"). Note that recency must be the time between the start of
the calibration period and the customer's last transaction, not the time
between the customer's last transaction and the end of the calibration
period. If your data is compressed (see <code>dc.compress.cbs</code>), a
fourth column labelled "custs" (number of customers with a specific
combination of recency, frequency and length of calibration period) will
make this function faster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.start</code></td>
<td>
<p>initial Pareto/NBD parameters - a vector with r, alpha, s,
and beta, in that order. r and alpha are unobserved parameters for the NBD
transaction process. s and beta are unobserved parameters for the Pareto
(exponential gamma) dropout process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.param.value</code></td>
<td>
<p>the upper bound on parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the optimization method(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hardie</code></td>
<td>
<p>if TRUE, have <code>pnbd.LL</code> use <code>h2f1</code>
instead of <code>hypergeo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>set it to TRUE if you want the Hessian matrix, and then you
might as well have the complete  <code>optimx</code> object
returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A set of starting parameters must be provided for this method. If no
parameters are provided, (1,1,1,1) is used as a default. It may be useful to
use starting values for r and s that represent your best guess of the
heterogeneity in the buy and die rate of customers. It may be necessary to
run the estimation from multiple starting points to ensure that it converges.
To compare the log-likelihoods of different parameters, use
<code>pnbd.cbs.LL</code>.
</p>
<p>The lower bound on the parameters to be estimated is always zero, since
Pareto/NBD parameters cannot be negative. The upper bound can be set with the
max.param.value parameter.
</p>
<p>This function may take some time to run. It uses <code>optimx</code>
for maximum likelihood estimation, not <code>optim</code>.
</p>


<h3>Value</h3>

<p>Unnamed vector of estimated parameters by default, <code>optimx</code>
object with everything if <code>hessian</code> is TRUE.
</p>


<h3>References</h3>

<p>Fader, Peter S.; Hardie, and Bruce G.S.. "Overcoming the BG/NBD
Model's #NUM! Error Problem." December. 2013. Web.
<a href="http://brucehardie.com/notes/027/bgnbd_num_error.pdf">http://brucehardie.com/notes/027/bgnbd_num_error.pdf</a>
</p>


<h3>See Also</h3>

<p><code>pnbd.cbs.LL</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cdnowSummary)

cal.cbs &lt;- cdnowSummary$cbs
# cal.cbs already has column names required by method

# starting-point parameters
startingparams &lt;- c(0.5, 6, 0.9, 8)

# estimated parameters
est.params &lt;- pnbd.EstimateParameters(cal.cbs = cal.cbs, 
                                      par.start = startingparams, 
                                      method = 'L-BFGS-B',
                                      hardie = TRUE)
                                      
# complete object returned by \code{\link[optimx]{optimx}}
optimx.set &lt;- pnbd.EstimateParameters(cal.cbs = cal.cbs, 
                                      par.start = startingparams, 
                                      hardie = TRUE, 
                                      hessian = TRUE)

# log-likelihood of estimated parameters
pnbd.cbs.LL(est.params, cal.cbs, TRUE)
</code></pre>


</div>