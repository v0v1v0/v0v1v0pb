<div class="container">

<table style="width: 100%;"><tr>
<td>mktrj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> PCA / NMA Atomic Displacement Trajectory </h2>

<h3>Description</h3>

<p>Make a trajectory of atomic displacments along a given principal
component / normal mode.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mktrj(...)

## S3 method for class 'pca'
mktrj(pca = NULL, pc = 1, mag = 1, step = 0.125, file =
NULL, pdb = NULL, rock=TRUE, ...)

## S3 method for class 'nma'
mktrj(nma = NULL, mode = 7, mag = 10, step = 1.25, file = NULL, 
      pdb = NULL, rock=TRUE,  ...)

## S3 method for class 'enma'
mktrj(enma = NULL, pdbs = NULL, s.inds = NULL, m.inds = NULL,
      mag = 10, step = 1.25, file = NULL, rock = TRUE, ncore = NULL, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p> an object of class <code>"pca"</code> as obtained with
function <code>pca.xyz</code> or <code>pca</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nma</code></td>
<td>
<p> an object of class <code>"nma"</code> as obtained with
function <code>nma.pdb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enma</code></td>
<td>
<p> an object of class <code>"enma"</code> as obtained with
function <code>nma.pdbs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p> the PC number along which displacements should be made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mag</code></td>
<td>
<p> a magnification factor for scaling the displacements. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p> the step size by which to increment along the pc/mode. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p> a character vector giving the output PDB file name. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> an object of class <code>"pdb"</code> as obtained from 
<code>read.pdb</code> or class <code>"pdbs"</code> as obtained from
<code>read.fasta.pdb</code>. If not NULL, used as reference to write
the PDB file. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rock</code></td>
<td>
<p> logical, if TRUE the trajectory rocks. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p> the mode number along which displacements should be made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdbs</code></td>
<td>
<p> a list object of class <code>"pdbs"</code> (obtained with
<code>pdbaln</code> or <code>read.fasta.pdb</code>) which
corresponds to the <code>"enma"</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.inds</code></td>
<td>
<p> index or indices pointing to the structure(s) in the
<code>enma</code> object for which the trajectory shall be generated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.inds</code></td>
<td>
<p> the mode number(s) along which displacements should be
made. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore </code></td>
<td>
<p> number of CPU cores used to do the calculation.
<code>ncore&gt;1</code> requires package ‘parallel’ installed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments passed to and from functions
(e.g. to function <code>write.pdb</code>). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Trajectory frames are built from reconstructed Cartesian coordinates
produced by interpolating from the mean structure along a given
<code>pc</code> or <code>mode</code>, in increments of <code>step</code>.
</p>
<p>An optional magnification factor can be used to amplify
displacements.  This involves scaling by <code>mag</code>-times the standard
deviation of the conformer distribution along the given <code>pc</code>
(i.e. the square root of the associated eigenvalue).
</p>


<h3>Note</h3>

<p> Molecular graphics software such as VMD or PyMOL is useful
for viewing trajectories see e.g: <br><a href="http://www.ks.uiuc.edu/Research/vmd/">http://www.ks.uiuc.edu/Research/vmd/</a>. </p>


<h3>Author(s)</h3>

<p> Barry Grant, Lars Skjaerven </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>


<h3>See Also</h3>

<p><code>pca</code>, <code>nma</code>,
<code>nma.pdbs</code>,
<code>pymol.modes</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

##- PCA example
attach(transducin)

# Calculate principal components
pc.xray &lt;- pca(pdbs, fit=TRUE)

# Write PC trajectory of pc=1
outfile = tempfile()
a &lt;- mktrj(pc.xray, file = outfile)
outfile

detach(transducin)


##- NMA example
## Fetch stucture
pdb &lt;- read.pdb( system.file("examples/1hel.pdb", package="bio3d") )

## Calculate (vibrational) normal modes
modes &lt;- nma(pdb)

## Visualize modes
outfile = file.path(tempdir(), "mode_7.pdb")
mktrj(modes, mode=7, pdb=pdb, file = outfile)
outfile


## End(Not run)
</code></pre>


</div>