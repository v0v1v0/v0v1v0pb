<div class="container">

<table style="width: 100%;"><tr>
<td>cohorts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize macroevolutionary cohorts</h2>

<h3>Description</h3>

<p>Plots the matrix of pairwise correlations in rate regimes
between all tips in a phylogeny.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cohorts(
  x,
  ephy,
  col,
  pal,
  lwd = 1,
  ofs = 0,
  use.plot.bammdata = FALSE,
  useraster = FALSE,
  LARGE = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of pairwise correlations generated by
<code>getCohortMatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A vector of colors passed to the function <code>image</code>. These
will be used to color the values in <code>x</code>. See documentation for
<code>image</code>. If <code>col = 'temperature'</code>, the color palette from
<code>rich.colors</code> from the gplots package will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pal</code></td>
<td>
<p>The palette to use if <code>use.plot.bammdata=TRUE</code>. See
options documented in the help file for <code>plot.bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>A numeric indicating the width of branches in the phylogeny.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofs</code></td>
<td>
<p>A numeric controlling the offset of the phylogeny from the
matrix plot. Appropriate values will probably be in the interval
[0,0.1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.plot.bammdata</code></td>
<td>
<p>Logical. should a phylorate plot be generated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useraster</code></td>
<td>
<p>A logical indicating whether the function <code>image</code>
should plot the matrix as a raster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LARGE</code></td>
<td>
<p>An integer. If trees have more tips than <code>LARGE</code>,
<code>useraster</code> will be coerced to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>plot.bammdata</code> if
<code>use.plot.bammdata=TRUE</code> or <code>plot.phylo</code> if 
<code>use.plot.bammdata=FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plotting function creates an image of the <code>BAMM</code>
correlation matrix between tip lineages of the phylogeny. Each
correlation is the posterior frequency with which a pair of lineages
occurs in the same macroevolutionary rate regime. Correlations are
mapped to a set of colors, with warmer colors corresponding to higher
correlations than cooler colors. The set of colors is specified by the
<code>col</code> argument and a legend is plotted to guide interpretation of
the color-correlation map. Trees are plotted on the margins of the
matrix image. The correlation between any two tips can be inferred by
finding their intersection within the matrix image.
</p>
<p><strong>IMPORTANT</strong>: the legend DOES NOT apply to the phylorate plots
shown in the margin if <code>use.plot.bammdata=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Mike Grundler
</p>


<h3>See Also</h3>

<p><code>plot.bammdata</code>, <code>getCohortMatrix</code>,
<code>image</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.1, nsamples=500)
x &lt;- getCohortMatrix(ed)
cohorts(x, ed)
cohorts(x, ed, col='temperature')
cohorts(x, ed, ofs=0.05, col='temperature')
cohorts(x, ed, pal="temperature", col='temperature', use.plot.bammdata=TRUE)
# gray scale
cohorts(x, ed, col=gray(seq(0.2,0.9,length.out=128)),
        use.plot.bammdata=FALSE)
</code></pre>


</div>