<div class="container">

<table style="width: 100%;"><tr>
<td>bm_PseudoAbsences</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select pseudo-absences</h2>

<h3>Description</h3>

<p>This internal <span class="pkg">biomod2</span> function allows to select pseudo-absences according 
to 4 different methods : <code>random</code>, <code>sre</code>, <code>disk</code> or <code>user.defined</code> (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bm_PseudoAbsences(
  resp.var,
  expl.var,
  nb.rep = 1,
  strategy = "random",
  nb.absences = NULL,
  sre.quant = 0,
  dist.min = 0,
  dist.max = NULL,
  user.table = NULL
)

bm_PseudoAbsences_user.defined(resp.var, expl.var, ...)

## S4 method for signature 'ANY,SpatVector'
bm_PseudoAbsences_user.defined(resp.var, expl.var, user.table)

## S4 method for signature 'ANY,SpatRaster'
bm_PseudoAbsences_user.defined(resp.var, expl.var, user.table)

bm_PseudoAbsences_random(resp.var, expl.var, ...)

## S4 method for signature 'ANY,SpatVector'
bm_PseudoAbsences_random(resp.var, expl.var, nb.absences, nb.rep)

## S4 method for signature 'ANY,SpatRaster'
bm_PseudoAbsences_random(resp.var, expl.var, nb.absences, nb.rep)

bm_PseudoAbsences_sre(resp.var, expl.var, ...)

## S4 method for signature 'ANY,SpatVector'
bm_PseudoAbsences_sre(resp.var, expl.var, sre.quant, nb.absences, nb.rep)

## S4 method for signature 'ANY,SpatRaster'
bm_PseudoAbsences_sre(resp.var, expl.var, sre.quant, nb.absences, nb.rep)

bm_PseudoAbsences_disk(resp.var, expl.var, ...)

## S4 method for signature 'ANY,SpatVector'
bm_PseudoAbsences_disk(
  resp.var,
  expl.var,
  dist.min,
  dist.max,
  nb.absences,
  nb.rep
)

## S4 method for signature 'ANY,SpatRaster'
bm_PseudoAbsences_disk(
  resp.var,
  expl.var,
  dist.min,
  dist.max,
  nb.absences,
  nb.rep
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resp.var</code></td>
<td>
<p>a <code>vector</code>, <code>SpatialPoints</code> or 
<code>SpatialPointsDataFrame</code> object containing binary data (<code>0</code> : absence, 
<code>1</code> : presence, <code>NA</code> : indeterminate) for a single species that will be used to 
find the pseudo-absences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expl.var</code></td>
<td>
<p>a <code>matrix</code>, <code>data.frame</code>, <code>SpatialPointsDataFrame</code> 
or <code>SpatRaster</code> object containing the explanatory variables (in 
columns or layers) that will be used to find the pseudo-absences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.rep</code></td>
<td>
<p>an <code>integer</code> corresponding to the number of sets (repetitions) of 
pseudo-absence points that will be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strategy</code></td>
<td>
<p>a <code>character</code> corresponding to the pseudo-absence selection strategy, 
must be among <code>random</code>, <code>sre</code>, <code>disk</code> or <code>user.defined</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.absences</code></td>
<td>
<p>(<em>optional, default</em> <code>NULL</code>) <br>
If <code>strategy = 'random'</code> or <code>strategy = 'sre'</code> or <code>strategy = 'disk'</code>, an 
<code>integer</code> corresponding to the number of pseudo-absence points that will be selected for 
each pseudo-absence repetition (true absences included)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sre.quant</code></td>
<td>
<p>(<em>optional, default</em> <code>0</code>) <br>
If <code>strategy = 'sre'</code>, a <code>numeric</code> between <code>0</code> and <code>0.5</code> defining the 
half-quantile used to make the <code>sre</code> pseudo-absence selection (see <code>bm_SRE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.min</code></td>
<td>
<p>(<em>optional, default</em> <code>0</code>) <br>
If <code>strategy = 'disk'</code>, a <code>numeric</code> defining the minimal distance to presence points 
used to make the <code>disk</code> pseudo-absence selection (in meters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.max</code></td>
<td>
<p>(<em>optional, default</em> <code>NULL</code>) <br>
If <code>strategy = 'disk'</code>, a <code>numeric</code> defining the maximal distance to presence points 
used to make the <code>disk</code> pseudo-absence selection (in meters)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user.table</code></td>
<td>
<p>(<em>optional, default</em> <code>NULL</code>) <br>
If <code>strategy = 'user.defined'</code>, a <code>matrix</code> or <code>data.frame</code> with as many rows as 
<code>resp.var</code> values, as many columns as <code>nb.rep</code>, and containing <code>TRUE</code> or 
<code>FALSE</code> values defining which points will be used to build the species distribution 
model(s) for each repetition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(<em>optional, one or several of the above arguments depending on the selected 
method</em>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Concerning random selection :</b>
</p>
<p>The idea is to select pseudo-absences randomly in spatial locations where the species has not 
been sampled. This method is the simplest one and the most appropriate if lacking information 
about the presence sampling (non-exhaustive, biased sampling, etc). <br><br></p>
<p><b>Concerning SRE selection (see <code>bm_SRE</code>) :</b>
</p>
<p>The idea is to select pseudo-absences in spatial locations whose environmental conditions are 
different from those of the presence points. This method is appropriate when most of the 
environmental space of the species has been sampled. <br><br></p>
<p><b>Concerning disk selection :</b>
</p>
<p>The idea is to select pseudo-absences, not too close from presence points, but not too far 
away either. This method is appropriate when most of the spatial range of the species has 
been sampled. <br><br></p>
<p><b>Concerning user defined selection :</b>
</p>
<p>The user can provide pseudo-absences locations through a table containing spatial locations 
in rows, pseudo-absences repetitions in columns, and <code>TRUE/FALSE</code> values indicating 
whether each point is to be considered as pseudo-absence or not for each dataset.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing the following elements :
</p>

<ul>
<li> <p><code>xy</code> : the coordinates of the species observations
</p>
</li>
<li> <p><code>sp</code> : the values of the species observations (<code>0</code>, <code>1</code> or <code>NA</code>)
</p>
</li>
<li> <p><code>env</code> : the explanatory variables
</p>
</li>
<li> <p><code>pa.tab</code> : the corresponding table of selected pseudo-absences (indicated by 
<code>TRUE</code> or <code>FALSE</code>)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Wilfried Thuiller, Damien Georges
</p>


<h3>See Also</h3>

<p><code>bm_SRE</code>, <code>BIOMOD.formated.data.PA</code>, 
<code>BIOMOD_FormatingData</code>
</p>
<p>Other Secundary functions: 
<code>bm_BinaryTransformation()</code>,
<code>bm_CrossValidation()</code>,
<code>bm_FindOptimStat()</code>,
<code>bm_MakeFormula()</code>,
<code>bm_ModelingOptions()</code>,
<code>bm_PlotEvalBoxplot()</code>,
<code>bm_PlotEvalMean()</code>,
<code>bm_PlotRangeSize()</code>,
<code>bm_PlotResponseCurves()</code>,
<code>bm_PlotVarImpBoxplot()</code>,
<code>bm_RunModelsLoop()</code>,
<code>bm_SRE()</code>,
<code>bm_SampleBinaryVector()</code>,
<code>bm_SampleFactorLevels()</code>,
<code>bm_Tuning()</code>,
<code>bm_VariablesImportance()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(terra)

# Load species occurrences (6 species available)
data(DataSpecies)
head(DataSpecies)

# Select the name of the studied species
myRespName &lt;- 'GuloGulo'

# Get corresponding presence/absence data
myResp &lt;- as.numeric(DataSpecies[, myRespName])

# Get corresponding XY coordinates
myRespXY &lt;- DataSpecies[, c('X_WGS84', 'Y_WGS84')]

# Load environmental variables extracted from BIOCLIM (bio_3, bio_4, bio_7, bio_11 &amp; bio_12)
data(bioclim_current)
myExpl &lt;- terra::rast(bioclim_current)




# --------------------------------------------------------------- #
# Create the different pseudo-absence datasets

# Transform true absences into potential pseudo-absences
myResp.PA &lt;- ifelse(myResp == 1, 1, NA)
myResp.PA.vect &lt;- vect(cbind(myRespXY, myResp.PA), geom = c("X_WGS84","Y_WGS84"))

# random method
PA.r &lt;- bm_PseudoAbsences(resp.var = myResp.PA.vect,
                          expl.var = myExpl,
                          nb.rep = 4,
                          nb.absences = 1000,
                          strategy = 'random')

# disk method
PA.d &lt;- bm_PseudoAbsences(resp.var = myResp.PA.vect,
                          expl.var = myExpl,
                          nb.rep = 4,
                          nb.absences = 500,
                          strategy = 'disk',
                          dist.min = 5,
                          dist.max = 35)

# SRE method
PA.s &lt;- bm_PseudoAbsences(resp.var = myResp.PA.vect,
                          expl.var = myExpl,
                          nb.rep = 4,
                          nb.absences = 1000,
                          strategy = 'sre',
                          sre.quant = 0.025)

# user.defined method
myPAtable &lt;- data.frame(PA1 = ifelse(myResp == 1, TRUE, FALSE),
                        PA2 = ifelse(myResp == 1, TRUE, FALSE))
for (i in 1:ncol(myPAtable)) myPAtable[sample(which(myPAtable[, i] == FALSE), 500), i] = TRUE
PA.u &lt;- bm_PseudoAbsences(resp.var = myResp.PA.vect,
                          expl.var = myExpl,
                          strategy = 'user.defined',
                          user.table = myPAtable)

str(PA.r)
head(PA.r$pa.tab)
apply(PA.r$pa.tab, 2, table)

head(PA.d$pa.tab)
apply(PA.d$pa.tab, 2, table)

head(PA.s$pa.tab)
apply(PA.s$pa.tab, 2, table)

tail(PA.u$pa.tab)
apply(PA.u$pa.tab, 2, table)


# random method : different number of PA
PA.r_mult &lt;- bm_PseudoAbsences(resp.var = myResp.PA.vect,
                               expl.var = myExpl,
                               nb.rep = 4,
                               nb.absences = c(1000, 500, 500, 200),
                               strategy = 'random')

str(PA.r_mult)
head(PA.r_mult$pa.tab)
apply(PA.r_mult$pa.tab, 2, table)


</code></pre>


</div>