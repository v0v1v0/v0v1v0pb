<div class="container">

<table style="width: 100%;"><tr>
<td>bsm_lg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basic Structural (Time Series) Model</h2>

<h3>Description</h3>

<p>Constructs a basic structural model with local level or local trend
component and seasonal component.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bsm_lg(
  y,
  sd_y,
  sd_level,
  sd_slope,
  sd_seasonal,
  beta,
  xreg = NULL,
  period,
  a1 = NULL,
  P1 = NULL,
  D = NULL,
  C = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector or a <code>ts</code> object of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_y</code></td>
<td>
<p>Standard deviation of the noise of observation equation.
Should be an object of class <code>bssm_prior</code> or scalar
value defining a known value such as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_level</code></td>
<td>
<p>Standard deviation of the noise of level equation.
Should be an object of class <code>bssm_prior</code> or scalar
value defining a known value such as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_slope</code></td>
<td>
<p>Standard deviation of the noise of slope equation.
Should be an object of class <code>bssm_prior</code>, scalar
value defining a known value such as 0, or missing, in which case the slope
term is omitted from the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_seasonal</code></td>
<td>
<p>Standard deviation of the noise of seasonal equation.
Should be an object of class <code>bssm_prior</code>, scalar
value defining a known value such as 0, or missing, in which case the
seasonal term is omitted from the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A prior for the regression coefficients.
Should be an object of class <code>bssm_prior</code> or <code>bssm_prior_list</code>
(in case of multiple coefficients) or missing in case of no covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>A matrix containing covariates with number of rows matching the
length of <code>y</code>. Can also be <code>ts</code>, <code>mts</code> or similar object
convertible to matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Length of the seasonal pattern.
Must be a positive value greater than 2 and less than the length of the
input time series. Default is <code>frequency(y)</code>,
which can also return non-integer value (in which case error is given).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>
<p>Prior means for the initial states (level, slope, seasonals).
Defaults to vector of zeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P1</code></td>
<td>
<p>Prior covariance matrix for the initial states (level, slope,
seasonals).Default is diagonal matrix with 100 on the diagonal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Intercept terms for observation equation, given as a length n
numeric vector or a scalar in case of time-invariant intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Intercept terms for state equation, given as a m times n matrix
or m times 1 matrix in case of time-invariant intercept.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>bsm_lg</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1)
n &lt;- 50
x &lt;- rnorm(n)
level &lt;- numeric(n)
level[1] &lt;- rnorm(1)
for (i in 2:n) level[i] &lt;- rnorm(1, -0.2 + level[i-1], sd = 0.1)
y &lt;- rnorm(n, 2.1 + x + level)
model &lt;- bsm_lg(y, sd_y = halfnormal(1, 5), sd_level = 0.1, a1 = level[1], 
  P1 = matrix(0, 1, 1), xreg = x, beta = normal(1, 0, 1),
  D = 2.1, C = matrix(-0.2, 1, 1))
  
ts.plot(cbind(fast_smoother(model), level), col = 1:2)

prior &lt;- uniform(0.1 * sd(log10(UKgas)), 0, 1)
# period here is redundant as frequency(UKgas) = 4
model_UKgas &lt;- bsm_lg(log10(UKgas), sd_y = prior, sd_level =  prior,
  sd_slope =  prior, sd_seasonal =  prior, period = 4)

# Note small number of iterations for CRAN checks
mcmc_out &lt;- run_mcmc(model_UKgas, iter = 5000)
summary(mcmc_out, return_se = TRUE)
# Use the summary method from coda:
summary(expand_sample(mcmc_out, "theta"))$stat
mcmc_out$theta[which.max(mcmc_out$posterior), ]
sqrt((fit &lt;- StructTS(log10(UKgas), type = "BSM"))$coef)[c(4, 1:3)]

</code></pre>


</div>