<div class="container">

<table style="width: 100%;"><tr>
<td>infer_GRN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform GRN inference</h2>

<h3>Description</h3>

<p>This function performs Gene Regulatory Network inference on
a subset of the expression matrix, for a set of potential targets
</p>


<h3>Usage</h3>

<pre><code class="language-R">infer_GRN(
  expression.matrix,
  metadata,
  anno,
  seed = 13,
  targets,
  condition,
  samples,
  inference_method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expression.matrix</code></td>
<td>
<p>the expression matrix; rows correspond to genes and
columns correspond to samples; usually preprocessed by
<code>preprocessExpressionMatrix</code>; a list  (of the same length as
modality) can be provided if #' <code>length(modality) &gt; 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>a data frame containing metadata for the samples contained
in the expression.matrix; must contain at minimum two columns:
the first column must contain the column names of the expression.matrix,
while the last column is assumed to contain the experimental conditions
that will be tested for differential expression; a list  (of the same
length as modality) can be provided if #' <code>length(modality) &gt; 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anno</code></td>
<td>
<p>annotation data frame containing a match between the row names
of the expression.matrix (usually ENSEMBL IDs) and the gene names that
should be rendered within the app and in output files; this object is
created by <code>generateShinyApp</code> using the org.db specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed to be set when running GRN inference, to ensure
reproducibility of outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>the target genes of interest around which the GRN is built;
must be row names of the expression matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>name of the metadata column to select samples from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>names of the sample groups to select; must appear in
<code>metadata[[condition]]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inference_method</code></td>
<td>
<p>method used for GRN inference; only supported method
is currently GENIE3.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The adjacency matrix of the inferred network
</p>


<h3>Examples</h3>

<pre><code class="language-R">expression.matrix.preproc &lt;- as.matrix(read.csv(
  system.file("extdata", "expression_matrix_preprocessed.csv", package = "bulkAnalyseR"), 
  row.names = 1
))[1:500, ]

metadata &lt;- data.frame(
  srr = colnames(expression.matrix.preproc), 
  timepoint = rep(c("0h", "12h", "36h"), each = 2)
)

anno &lt;- AnnotationDbi::select(
  getExportedValue('org.Mm.eg.db', 'org.Mm.eg.db'),
  keys = rownames(expression.matrix.preproc),
  keytype = 'ENSEMBL',
  columns = 'SYMBOL'
) %&gt;%
  dplyr::distinct(ENSEMBL, .keep_all = TRUE) %&gt;%
  dplyr::mutate(NAME = ifelse(is.na(SYMBOL), ENSEMBL, SYMBOL))

res &lt;- infer_GRN(
  expression.matrix = expression.matrix.preproc,
  metadata = metadata,
  anno = anno,
  seed = 13,
  targets = c("Hecw2", "Akr1cl"),
  condition = "timepoint",
  samples = "0h",
  inference_method = "GENIE3"
)
</code></pre>


</div>