<div class="container">

<table style="width: 100%;"><tr>
<td>bdm.pakde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perplexity-adaptive kernel density estimation</h2>

<h3>Description</h3>

<p>Starts the paKDE algorithm (second step of the mapping protocol).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bdm.pakde(bdm, layer = 1, threads = 2, type = "SOCK", ppx = 100,
  itr = 100, tol = 1e-05, g = 200, g.exp = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bdm</code></td>
<td>
<p>A <var>bdm</var> instance as generated by <code>bdm.init()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>The number of the t-SNE layer (1 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>The number of parallel threads (in principle only limited by hardware resources, <code>i.e.</code> number of cores and available memory)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of cluster: 'SOCK' (default) for intra-node parallelization, 'MPI' (<code>message passing interface</code>) for inter-node parallelization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppx</code></td>
<td>
<p>The value of perplexity to compute similarities in the low-dimensional embedding (100 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itr</code></td>
<td>
<p>The number of iterations for computing input similarities (100 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance lower bound for computing input similarities (1e-05 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>The resolution of the density space grid (<code class="reqn">g*g</code> cells, 200 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.exp</code></td>
<td>
<p>A numeric factor to avoid border effects. The grid limits will be expanded so as to enclose the density of the kernel of the most extreme embedded datapoints up to <code>g.exp</code> times <code class="reqn">\sigma</code>. By default, (<code>g.exp = 3</code>) the grid limits are expanded so as to enclose the 0.9986 of the probability mass of the most extreme kernels.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When computing the <var>paKDE</var> the embedding area is discretized as a grid of size <code>g*g</code> cells. In order to avoid border effects, the limits of the grid are expanded by default so as to enclose at least the 0.9986 of the cumulative distribution function (<code class="reqn">3 \sigma</code>) of the kernels of the most extreme mapped points in each direction.
</p>
<p>The presence of outliers in the embedding can lead to undesired expansion of the grid limits. We can overcome this using lower values of <var>g.exp</var>. By setting <code>g.exp = 0</code> the grid limits will be equal to the range of the embedding.
</p>
<p>The values <var>g.exp = c(1, 2, 3, 4, 5, 6)</var> enclose cdf values of <var>0.8413, 0.9772, 0.9986, 0.99996, 0.99999, 1.0</var> respectively.
</p>


<h3>Value</h3>

<p>A copy of the input <var>bdm</var> instance with new element <var>bdm$pakde</var> (paKDE output). <code>bdm$pakde[[layer]]$layer = 'NC'</code> stands for not computed layers.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# --- load mapped dataset
bdm.example()
# --- run paKDE
## Not run: 
exMap &lt;- bdm.pakde(exMap, threads = 4, ppx = 200, g = 200, g.exp = 3)

## End(Not run)
# --- plot paKDE output
bdm.pakde.plot(exMap)
</code></pre>


</div>