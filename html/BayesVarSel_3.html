<div class="container">

<table style="width: 100%;"><tr>
<td>BMAcoeff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Model Averaged estimations of regression coefficients</h2>

<h3>Description</h3>

<p>Samples of the model averaged objective posterior distribution of regression
coefficients
</p>


<h3>Usage</h3>

<pre><code class="language-R">BMAcoeff(x, n.sim = 10000, method = "svd")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>Bvs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>Number of simulations to be produced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Text specifying the matrix decomposition used to determine the
matrix root of 'sigma' when simulating from the multivariate t distribution.
Possible methods are eigenvalue decomposition ('"eigen"', default), singular
value decomposition ('"svd"'), and Cholesky decomposition ('"chol"'). See
the help of command <code>rmvnorm</code> in package <code>mvtnorm</code> for more
details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The distribution that is sampled from is the discrete mixture of the
(objective) posterior distributions of the regression coefficients with
weights proportional to the posterior probabilities of each model. That is,
from
</p>
<p><code class="reqn">latex</code>
</p>
<p>The models used in the mixture above are the retained best models (see the
argument <code>n.keep</code> in Bvs) if <code>x</code> was generated
with <code>Bvs</code> and the sampled models with the associated frequencies if
<code>x</code> was generated with <code>GibbsBvs</code>. The formula for the objective
posterior distribution within each model <code class="reqn">latex</code> is
taken from Bernardo and Smith (1994) page 442.
</p>
<p>Note: The above mixture is potentially highly multimodal and this command
ends with a multiple plot with the densities of the different regression
coefficients to show the user this peculiarity. Hence which summaries should
be used to describe this distribution is a delicate issue and standard
functions like the mean and variance are not recommendable.
</p>


<h3>Value</h3>

<p><code>BMAcoeff</code> returns an object of class <code>bma.coeffs</code> which
is a matrix with <code>n.sim</code> rows with the simulations. Each column of the
matrix corresponds to a regression coefficient in the full model.
</p>


<h3>Author(s)</h3>

<p>Gonzalo Garcia-Donato and Anabel Forte
</p>
<p>Maintainer: &lt;anabel.forte@uv.es&gt;
</p>


<h3>See Also</h3>

<p>See <code>histBMA</code> for a histogram-like
representation of the columns in the object. See
<code>Bvs</code> and
<code>GibbsBvs</code> for creating objects of the class
<code>Bvs</code>. See <code>Mvnorm for details about argument
method.</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

#Analysis of Crime Data
#load data
data(UScrime)

crime.Bvs&lt;- Bvs(formula= y ~ ., data=UScrime, n.keep=1000)
crime.Bvs.BMA&lt;- BMAcoeff(crime.Bvs, n.sim=10000)
#the best 1000 models are used in the mixture

#We could force all  possible models to be included in the mixture
crime.Bvs.all&lt;- Bvs(formula= y ~ ., data=UScrime, n.keep=2^15)
crime.Bvs.BMA&lt;- BMAcoeff(crime.Bvs.all, n.sim=10000)
#(much slower as this implies ordering many more models...)

#With the Gibbs algorithms:
data(Ozone35)

Oz35.GibbsBvs&lt;- GibbsBvs(formula= y ~ ., data=Ozone35, prior.betas="gZellner",
prior.models="Constant", n.iter=10000, init.model="Full", n.burnin=100,
time.test = FALSE)
Oz35.GibbsBvs.BMA&lt;- BMAcoeff(Oz35.GibbsBvs, n.sim=10000)



## End(Not run)

</code></pre>


</div>