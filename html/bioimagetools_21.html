<div class="container">

<table style="width: 100%;"><tr>
<td>segment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Segmentation of 3D images using EM algorithms</h2>

<h3>Description</h3>

<p>Segmentation of 3D images using EM algorithms
</p>


<h3>Usage</h3>

<pre><code class="language-R">segment(
  img,
  nclust,
  beta,
  z.scale = 0,
  method = "cem",
  varfixed = TRUE,
  maxit = 30,
  mask = array(TRUE, dim(img)),
  priormu = rep(NA, nclust),
  priormusd = rep(NULL, nclust),
  min.eps = 10^{
     -7
 },
  inforce.nclust = FALSE,
  start = NULL,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>img</code></td>
<td>
<p>is a 3d array representing an image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclust</code></td>
<td>
<p>is the number of clusters/classes to be segmented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>is a matrix of size nclust x nclust, representing the prior weight of classes neighboring each other.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.scale</code></td>
<td>
<p>ratio of voxel dimension in x/y direction and z direction. Will be multiplied on beta for neighboring voxel in z direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>only "cem" classification EM algorithm implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varfixed</code></td>
<td>
<p>is a logical variable. If TRUE, the variance is equal in each class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>is the maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>is a logical array, representing the voxels to be used in the segmentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priormu</code></td>
<td>
<p>is a vector with mean of the normal prior of the expected values of all classes. Default is NA, which represents no prior assumption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priormusd</code></td>
<td>
<p>is a vector with standard deviations of the normal prior of the expected values of all classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.eps</code></td>
<td>
<p>stop criterion. Minimal change in sum of squared estimate of mean in order to stop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inforce.nclust</code></td>
<td>
<p>if TRUE enforces number of clusters to be nclust. Otherwise classes might be removed during algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>if TRUE, function remains silent during running time</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with "class": 3d array of class per voxel; "mu" estimated means; "sigma": estimated standard deviations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
original&lt;-array(1,c(300,300,50))
for (i in 1:5)original[(i*60)-(0:20),,]&lt;-original[(i*60)-(0:20),,]+1
for (i in 1:10)original[,(i*30)-(0:15),]&lt;-original[,(i*30)-(0:15),]+1
original[,,26:50]&lt;-4-aperm(original[,,26:50],c(2,1,3))

img&lt;-array(rnorm(300*300*50,original,.2),c(300,300,50))
img&lt;-img-min(img)
img&lt;-img/max(img)

try1&lt;-segment(img,3,beta=0.5,z.scale=.3)
print(sum(try1$class!=original)/prod(dim(original)))

beta&lt;-matrix(rep(-.5,9),nrow=3)
beta&lt;-beta+1.5*diag(3)
try2&lt;-segment(img,3,beta,z.scale=.3)
print(sum(try2$class!=original)/prod(dim(original)))

par(mfrow=c(2,2))
img(original)
img(img)
img(try1$class)
img(try2$class)

## End(Not run)
</code></pre>


</div>