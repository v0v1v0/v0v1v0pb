<div class="container">

<table style="width: 100%;"><tr>
<td>bin_cor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binned correlation 
</h2>

<h3>Description</h3>

<p>The <code>bin_cor</code> function convert an irregular time series to 
a binned one and its parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bin_cor(ts1, ts2, FLAGTAU=3, ofilename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts1, ts2</code></td>
<td>

<p>ts1 and ts2 are the unevenly spaced time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FLAGTAU</code></td>
<td>

<p>FLAGTAU defines the method used to estimate the persistence or memory of 
the unevenly spaced time series. Options (by default is 3): <br>
If 1 then est_tau = tau_x + tau_y     [Eq. 7.44, Mudelsee (2010, 2014)]. <br>
If 2 then est_tau = max(tau_x, tau_y) [Eq. 7.45, Mudelsee (2010, 2014)]. <br>
If 3 then est_tau = dist_x_y/ln(a_x_y_est) [Eq. 7.48, Mudelsee (2010, 2014).] <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofilename</code></td>
<td>

<p>The output filename (ASCII format) containing the binned time series.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>bin_cor</code> function convert an irregular times series to 
a binned time series and depends on the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <em>dplR</em> package to carry 
out this task. <em>dplR</em> (<em>redfitTauest</em> function) estimate the 
persistence contained in the irregular climate time series by means of 
the method of Mudelsee (2002). 
</p>


<h3>Value</h3>

<p>A list of 16 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Binned_time_series</code></td>
<td>
<p>An object containing the binned time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Auto._cor._coef._ts1</code></td>
<td>
<p>The autocorrelation for the binned time series number 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Persistence_ts1</code></td>
<td>
<p>The persistence or memory for the binned time series number 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Auto._cor._coef._ts2</code></td>
<td>
<p>The autocorrelation for the binned time series number 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Persistence_ts2</code></td>
<td>
<p>The persistence or memory for the binned time series number 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin width</code></td>
<td>
<p>The bin width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Number_of_bins</code></td>
<td>
<p>The number of bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Average spacing</code></td>
<td>
<p>The mean value of the times for the binned time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR. ts1</code></td>
<td>
<p>Variance of ts1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR. bin ts1</code></td>
<td>
<p>Variance of the binned ts1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR. ts2</code></td>
<td>
<p>Variance for ts2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR. bin ts2</code></td>
<td>
<p>Variance of the binned ts2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR. ts1 - VAR bints1</code></td>
<td>
<p>Variance of ts1 minus variance of the binned ts1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR. ts2 - VAR bints2</code></td>
<td>
<p>Variance of ts2 minus variance of the binned ts2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>% of VAR. lost ts1</code></td>
<td>
<p>Percentage of variance lost for ts1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>% of VAR. lost ts2</code></td>
<td>
<p>Percentage of variance lost for ts2.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Needs <em>dplR</em> (<em>redfitTauest</em> function) to estimate the 
persistence contained in the irregular time series by means of the 
method of Mudelsee (2002). Please, look at the code <em>tauest_dplR.R</em> 
in the directory <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> of our BINCOR package. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br>
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br> 
EPOC UMR CNRS 5805 - U. de Bordeaux, Pessac, FRANCE.<br>
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br>
Web2: <a href="http://www.researchgate.net/profile/Josue_Polanco-Martinez">http://www.researchgate.net/profile/Josue_Polanco-Martinez</a>.<br>
Email: <a href="josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> 
</p>


<h3>References</h3>

<p>Bunn, A., Korpela, M., Biondi, F., Campelo, F., Mérian, P., Qeadan, F.,
Zang, C., Buras, A., Cecile, J., Mudelsee, M., Schulz, M. (2015). 
Dendrochronology Program Library in R. R package version 1.6.3.
URL <a href="https://CRAN.R-project.org/package=dplR">https://CRAN.R-project.org/package=dplR</a>. <br></p>
<p>Mudelsee, M. (2002). TAUEST: A computer program for estimating persistence 
in unevenly spaced weather/climate time series. Computers &amp; Geosciences 28 
(1), 69–72. <br>
URL <a href="http://www.climate-risk-analysis.com/software/">http://www.climate-risk-analysis.com/software/</a>. <br></p>
<p>Mudelsee, M. (2010). Climate Time Series Analysis: Classical Statistical and
Bootstrap Methods. Springer. <br></p>
<p>Mudelsee, M. (2014). Climate Time Series Analysis: Classical Statistical and
Bootstrap Methods, Second Edition. Springer. <br></p>
<p>Polanco-Martínez, J.M., Medina-Elizalde, M.A., Sánchez Goñi, M.F., 
M. Mudelsee. (2018). BINCOR: an R package to estimate the correlation 
between two unevenly spaced time series. Ms. under review (second round).
</p>


<h3>Examples</h3>

<pre><code class="language-R"> #####################################################################
 #::  Figure 1 D (Polanco-Martínez et al. (2018), (mimeo)). 
 #####################################################################
 library("BINCOR") 

 #####################################################################
 #:: Loading the time series under analysis: example 1 (ENSO vs. NHSST) 
 #####################################################################
 data(ENSO) 
 data(NHSST)

 #####################################################################
 # Testing our bin_cor function
 #####################################################################
 bincor.tmp    &lt;- bin_cor(ENSO.dat, NHSST.dat, FLAGTAU=3, "output_ENSO_NHSST.tmp")
 binnedts      &lt;- bincor.tmp$Binned_time_series
</code></pre>


</div>