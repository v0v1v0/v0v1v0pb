<div class="container">

<table style="width: 100%;"><tr>
<td>stop_chain</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply the MCMC algorithm in blocks until conditions are met</h2>

<h3>Description</h3>

<p>Sample blocks of a given size until either the estimated log marginal likelihood falls within a given confidence interval, there is sufficient confidence that the evidence model gamma = 1 is at most a certain quantity, or a certain number of blocks have been sampled.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stop_chain(
  y,
  blocks_remaining,
  start_zs,
  start_logit_omegas,
  start_log_phis,
  temperatures,
  tolerance = 1,
  confidence = 0.95,
  simulations = 1000,
  log_evidence_threshold = -Inf,
  y_log_lik_t_equals_1_traces = matrix(ncol = length(temperatures), nrow = 0),
  full_block_traces = list(),
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Logical vector of case (<code>TRUE</code>) control (<code>FALSE</code>) status.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks_remaining</code></td>
<td>
<p>Maximum number of blocks left before termination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_zs</code></td>
<td>
<p>Initial (logical) z-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_logit_omegas</code></td>
<td>
<p>Initial values of logit_omega (numeric vector - one value per chain).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_log_phis</code></td>
<td>
<p>Initial values of log_phi (numeric vector - one value per chain).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperatures</code></td>
<td>
<p>Numeric vector of temperatures of power posteriors. One chain will be created for each element of the vector at the corresponding temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>Maximum width for confidence_interval of log marginal likelihood to allow before stopping the chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>Numeric value of statistical confidence with which returning interval should contain the true value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulations</code></td>
<td>
<p>Integer value of number of simulations to use in estimation of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_evidence_threshold</code></td>
<td>
<p>Numeric value used to determine whether to stop the sampling procedure after successive blocks. If we are confident (to the level of <code>confidence</code>) that the evidence for model gamma = 1 is under this value, sampling is halted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_log_lik_t_equals_1_traces</code></td>
<td>
<p>Numeric matrix of log probabilities of <code>y</code> at different temperatures (columns) in different iterations (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_block_traces</code></td>
<td>
<p>List of outputs of calls to MCMC routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>To print execution progress or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>call_cpp</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>BeviMed</code>.
</p>


</div>