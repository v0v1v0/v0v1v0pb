<div class="container">

<table style="width: 100%;"><tr>
<td>DAGinterventionMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo estimation of intervention effects for a DAG or chain of sampled DAGs</h2>

<h3>Description</h3>

<p><code>DAGinterventionMC</code> takes a DAG or a sampled chain of DAGs (for example from
the <code>partitionMCMC</code> function of the BiDAG package) and computes,
for binary data, a Monte Carlo estimate of the intervention effect of 
each node on all others by simulating data from the DAG. 
By default each node is intervened upon and the downstream effects
estimated by further sampling. A faster but less robust and accurate version is
also offered which reweights a single simulated dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DAGinterventionMC(
  incidences,
  dataParams,
  sampleSize,
  sample = TRUE,
  fixNode = TRUE,
  reducedVarianceSampling = TRUE,
  unrollDBN = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>incidences</code></td>
<td>
<p>a single adjacency matrix of a list of adjacency matrices
of sampled DAGs, with entry [i,j] equal to 1 when a directed edge exists from
node i to node j</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataParams</code></td>
<td>
<p>the data and parameters used to learn the DAGs derived from the
<code>scoreparameters</code> function of the BiDAG package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleSize</code></td>
<td>
<p>the number of Monte Carlo samples to draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>logical indicating whether to sample the parameters of each node
from the posterior (TRUE, default) or to take the expectation (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixNode</code></td>
<td>
<p>logical indicating whether to intervene on each node (TRUE, default)
and resample downstream nodes or to sample once and reweight the sample (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reducedVarianceSampling</code></td>
<td>
<p>logical indicating whether to perform Bernoulli
samping for each node (FALSE) or to sample from a distribution with the same mean
and lower variance (TRUE, default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unrollDBN</code></td>
<td>
<p>logical indicating whether to unroll a DBN to a full DAG over
all time slices (TRUE, default) or to use the compact representation (FALSE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a single matrix or a list of matrices containing the full set of
intervention effects for each input DAG. Entry [i,j] is the downstream
effect on node j of intervening on node i
(the difference observed at node j when setting node i to 1 and 0)
</p>


<h3>See Also</h3>

<p><code>scoreparameters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
scoreParam &lt;- BiDAG::scoreparameters("bde", BiDAG::Asia)
causalmatMC &lt;- DAGinterventionMC(BiDAG::Asiamat, scoreParam, 1e4)

</code></pre>


</div>