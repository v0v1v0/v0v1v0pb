<div class="container">

<table style="width: 100%;"><tr>
<td>bsc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basis matrix and knot Jacobian for B-spline of order 0 (step function) and higher</h2>

<h3>Description</h3>

<p>This function is analogous but not equivalent to <code>splines:bs()</code> and <code>splines2::bSpline()</code>.
It is also several times faster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bsc(x, xk, n = 3L, cjac = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector, abscissa points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xk</code></td>
<td>
<p>Numeric vector, knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer scalar, polynomial order (3 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cjac</code></td>
<td>
<p>Logical scalar, if <code>TRUE</code> makes to calculate Jacobian of basis
vectors as function of knot positions (FALSE by default)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For n==0, step function is defined as constant on each interval
<code>[xk[i]; xk[i+1][</code>, i.e. closed on the left and open on the right
except for the last interval which is closed on the right too. The
Jacobian for step function is considered 0 in every x point even if
in points where x=xk, the derivative is not defined.<br>
For n==1, Jacobian is discontinuous in such points so for
these points we take the derivative from the right.
</p>


<h3>Value</h3>

<p>Numeric matrix (for cjac=FALSE), each column correspond to a
B-spline calculated on x; or List (for cjac=TRUE) with components </p>

<dl>
<dt>mat</dt>
<dd>
<p>basis matrix of dimension <code>nx x nw</code>, where nx is the length
of x and <code>nw=nk-n-1</code> is the number of basis vectors</p>
</dd>
<dt>jac</dt>
<dd>
<p>array of dimension <code>nx x (n+2) x nw</code> where n+2
is the number of support knots for each basis vector
</p>
</dd>
</dl>
<h3>See Also</h3>

<p>[splines::bs()], [splines2::bSpline()]
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x=seq(0, 5, length.out=101)
  # cubic basis matrix
  n=3
  m=bsc(x, xk=c(rep(0, n+1), 1:4, rep(5, n+1)), n=n)
  matplot(x, m, t="l")
  stopifnot(all.equal.numeric(c(m), c(splines::bs(x, knots = 1:4, degree = n, intercept = TRUE))))
</code></pre>


</div>