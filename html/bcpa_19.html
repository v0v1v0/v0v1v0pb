<div class="container">

<table style="width: 100%;"><tr>
<td>WindowSweep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform window sweep for BCPA</h2>

<h3>Description</h3>

<p>This is the workhorse function of the BCPA.  It performs a sweep of the time 
series, searching for most significant change points and identifying the 
parsimonious model according to an adjusted BIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WindowSweep(
  data,
  variable,
  time.var = "T.mid",
  windowsize = 50,
  windowstep = 1,
  units = "hours",
  K = 2,
  tau = TRUE,
  range = 0.6,
  progress = TRUE,
  plotme = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data to be analyzed.  Generically, the output of the 
<code>GetVT</code> function containing step lengths, absolute and turning 
angles, etc, but can be any data frame with a column representing times and 
any column (or set of columns) that can be converted to a time series for 
change point analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>a character string representing the response variable to 
apply the BCPA to.  For example <code>"V*cos(theta)"</code>  for persistence 
velocity, <code>"log(V)"</code> for log of velocity if the data are outputs of 
'codeGetVT'.   Otherwise, any column (e.g. <code>"Depth"</code>) in the 
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.var</code></td>
<td>
<p>character string for the time variable.  The default is 
<code>T.mid</code>  from the output of the 'codeGetVT'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowsize</code></td>
<td>
<p>integer size of the analysis window as a number of data 
points (not time units).  Should probably be no smaller than 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowstep</code></td>
<td>
<p>integer step size of analysis. Values greater than 1 speed 
the analysis up.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>if the times are POSIX, <code>units</code> (one of "secs", "mins", 
"hours", "days", "weeks") determine the unit of the <code>windowstep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>sensitivity parameter for the adjusted BIC.  Smaller values make 
for a less sensitive model selection, i.e. more likely that the null model 
of no significant changes will be selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a logical indicating whether the autocorrelation "rho" or the 
characteristic time "tau" should be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>a number between 0 and 1 that determines the extent of each 
window that is scanned for changepoints.  I.e., if the window is 100 
datapoints long, at the default <code>range=0.6</code>, changepoints will be 
scanned between 20 and 80.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>logical - whether or not to output a progress bar as the 
analysis is being performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotme</code></td>
<td>
<p>logical - whether or not to plot the analysis as it is 
happening.  This slows the analysis considerably, especially in non-dynamic 
graphic environments like RStudio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to the 
<code>PartitionParameters</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>windowsweep</code>, which is a list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ws</code></td>
<td>
<p>a data frame containing the change point, selected model, and 
parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the time variable - in the units specified in the data object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.POSIX</code></td>
<td>
<p>the time variable as a POSIX object (containing Y-M-D H:S)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowsize</code></td>
<td>
<p>the window size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowstep</code></td>
<td>
<p>the window step size</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eliezer Gurarie
</p>


<h3>See Also</h3>

<p>for internal functions: <code>GetModels</code>, 
<code>GetBestBreak</code>, <code>GetDoubleL</code>; for summarizing 
output: <code>ChangePointSummary</code>; for plotting output: 
<code>plot.bcpa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Using the included simulated  movement data
require(bcpa)
data(Simp)
plot(Simp)
Simp.VT &lt;- GetVT(Simp)
## note: column names of Simp.VT include:
###  "S" - step length
### "Theta" - turning angle
###  T.start" "T.end"   "T.mid"  "T.POSIX" - time variables

if(interactive())
  Simp.ws &lt;- WindowSweep(Simp.VT, "V*cos(Theta)", windowsize = 50, 
                         windowstep = 1, progress=TRUE) else
  Simp.ws &lt;- WindowSweep(Simp.VT, "V*cos(Theta)", windowsize = 50, 
                         windowstep = 1, progress=FALSE)

plot(Simp.ws, threshold = 7)
plot(Simp.ws, type = "flat", clusterwidth = 3)
PathPlot(Simp, Simp.ws)
PathPlot(Simp, Simp.ws, type="flat")
DiagPlot(Simp.ws)

# Example of application on one dimensional data (e.g. depth)

# simulate some data with three change points: surface, medium, deep, surface

## random times within 100 hours of now
n.obs &lt;- 100
time = sort(Sys.time() - runif(n.obs, 0, n.obs) * 60 * 60)

d1 &lt;- 50; d2 &lt;- 100
t1 &lt;- 25; t2 &lt;- 65; t3 &lt;- 85
sd1 &lt;- 1; sd2 &lt;- 5; sd3 &lt;- 10

dtime &lt;- as.numeric(difftime(time, min(time), units="hours"))
phases &lt;- cut(dtime, c(-1, t1, t2, t3, 200), labels = c("P1","P2","P3","P4")) 
means &lt;- c(0,d1,d2,0)[phases]
sds &lt;- c(sd1,sd2,sd3,sd1)[phases]
depth &lt;- rnorm(n.obs,means, sds)
# make all depths positive!
depth &lt;- abs(depth)
mydata &lt;- data.frame(time, depth)

# perform windowsweep
ws &lt;- WindowSweep(mydata, "depth", time.var = "time", windowsize = 30, 
                  windowstep = 1, progress=interactive())
plot(ws)
plot(ws, type = "flat", cluster = 6)
ChangePointSummary(ws, cluster = 6)
</code></pre>


</div>