<div class="container">

<table style="width: 100%;"><tr>
<td>kma.similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Similarity/dissimilarity index between two functions</h2>

<h3>Description</h3>

<p>kma.similarity computes a similarity/dissimilarity measure between two functions <code class="reqn">f</code> and <code class="reqn">g</code>. Users can choose among different types of measures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kma.similarity(x.f = NULL, y0.f = NULL, y1.f = NULL,
x.g = NULL, y0.g = NULL, y1.g = NULL, similarity.method, unif.grid = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.f</code></td>
<td>
<p>vector <em>length.f</em>: abscissa grid where function <code class="reqn">f</code>  and his first derivatives <code class="reqn">f'</code> is evaluated. <em>length.f</em>: numbrt of abscissa values where <code class="reqn">f</code> is evaluated. <code>x.f</code> must always be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0.f</code></td>
<td>
<p>vector <em>length.f</em> or matrix <em>length.f</em> X <em>d</em>: evaluations of function <code class="reqn">f</code> on the abscissa grid <code>x.f</code>. <em>length.f</em>: number of abscissa values where <code class="reqn">f</code> is evaluated. <em>d</em> (only if <code class="reqn">f</code> and <code class="reqn">g</code> are multidimensional) number of function's components, i.e. <code class="reqn">f</code> is <code class="reqn">d</code>-dimensional curve.  Default value of <code>y0.f</code> is <code>NULL</code>. The vector<code>y0.f</code> must be provided if the chosen <code>similarity.method</code> concerns original functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.f</code></td>
<td>
<p>vector <em>length.f</em> or matrix <em>length.f</em> X <em>d</em>: evaluations of <code class="reqn">f</code> first derivative, i.e., <code class="reqn">f'</code>, on the abscissa grid <code>x.f</code>. Default value of <code>y1.f</code> is <code>NULL</code>. The vector <code>y1.f</code> must be provided if the chosen <code>similarity.method</code> concerns function first derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.g</code></td>
<td>
<p>vector <em>length.g</em>: abscissa grid where function <code class="reqn">g</code>  and his first derivatives <code class="reqn">g'</code> is evaluated. <em>length.g</em>: numbrt of abscissa values where <code class="reqn">g</code> is evaluated. <code>x.g</code> must always be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0.g</code></td>
<td>
<p>vector  <em>length.g</em> or matrix <em>length.g</em> X <em>d</em>: evaluations of function <code class="reqn">g</code> on the abscissa grid <code>x.g</code>.  <em>length.g</em>: number of abscissa values where <code class="reqn">g</code> is evaluated. <em>d</em> (only if <code class="reqn">f</code> and <code class="reqn">g</code> are multidimensional) number of function's components, i.e. <code class="reqn">g</code> is <code class="reqn">d</code>-dimensional curve. Default value of <code>y0.g</code> is <code>NULL</code>. The vector <code>y0.g</code> must be provided if the chosen <code>similarity.method</code> concerns original functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.g</code></td>
<td>
<p>vector <em>length.g</em> or matrix <em>length.g</em> X <em>d</em>: evaluations of <code class="reqn">g</code> first derivative, i.e., <code class="reqn">g'</code>, on the abscissa grid <code>x.g</code>. Default value is of <code>y1.g</code> <code>NULL</code>. The vector <code>y1.g</code> must be provided if the chosen <code>similarity.method</code> concerns function first derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>similarity.method</code></td>
<td>
<p>character: similarity/dissimilarity between <code class="reqn">f</code> and <code class="reqn">g</code>. Possible choices are: <code>'d0.pearson'</code>, <code>'d1.pearson'</code>, <code>'d0.L2'</code>, <code>'d1.L2'</code>,
<code>'d0.L2.centered'</code>, <code>'d1.L2.centered'</code>. Default value is <code>'d1.pearson'</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unif.grid</code></td>
<td>
<p>boolean: if equal to <code>TRUE</code> the similarity measure is computed over an uniform grid built in the intersection domain of the two functions, that is an additional discretization is performed. If equal to <code>FALSE</code> the additional discretization is not performed, so the functions are supposed to be already defined on the same abscissa grid and the grid is supposed to be fine enough to well compute similarity.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We report the list of the currently available similarities/dissimilarities. Note that all norms and inner products are computed over <code class="reqn">D</code>, that is the intersection of the domains of <code class="reqn">f</code> and <code class="reqn">g</code>. <code class="reqn">\overline{f}</code> and <code class="reqn">\overline{g}</code> denote the mean value, respectively, of functions <code class="reqn">f</code> and <code class="reqn">g</code>.
</p>
<p>1. <code>'d0.pearson'</code>: this similarity measure is the cosine of the angle between the two functions <code class="reqn">f</code> and <code class="reqn">g</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\frac{&lt;f,g&gt;_{L^2}}{\|{f}\|_{L^2} \|{g}\|_{L^2}}</code>
</p>

<p>2. <code>'d1.pearson'</code>: this similarity measure is the cosine of the angle between the two function derivatives <code class="reqn">f'</code> and <code class="reqn">g'</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\frac{&lt;f',g'&gt;_{L^2}}{\|{f'}\|_{L^2} \|{g'}\|_{L^2}}</code>
</p>

<p>3. <code>'d0.L2'</code>: this dissimilarity measure is the L2 distance of the two functions <code class="reqn">f</code> and <code class="reqn">g</code> normalized by the length of the common domain <code class="reqn">D</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\|{f-g}\|_{L^2}}{|D|}</code>
</p>

<p>4. <code>'d1.L2'</code>: this dissimilarity measure is the L2 distance of the two function first derivatives <code class="reqn">f'</code> and <code class="reqn">g'</code> normalized by the length of the common domain <code class="reqn">D</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\|{f'-g'}\|_{L^2}}{|D|}</code>
</p>

<p>5. <code>'d0.L2.centered'</code>: this dissimilarity measure is the L2 distance of <code class="reqn">f-\overline{f}</code> and <code class="reqn">g-\overline{g}</code> normalized by the length of the common domain <code class="reqn">D</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\|{(f-\overline{f})-(g-\overline{g})}\|_{L^2}}{|D|}</code>
</p>

<p>6. <code>'d1.L2.centered'</code>: this dissimilarity measure is the L2 distance of <code class="reqn">f'-\overline{f'}</code> and <code class="reqn">g'-\overline{g'}</code> normalized by the length of the common domain <code class="reqn">D</code>.
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\|{(f'-\overline{f'})-(g'-\overline{g'})}\|_{L^2}}{|D|}</code>
</p>

<p>For multidimensional functions, if <code>similarity.method='d0.pearson'</code> or <code>'d1.pearson'</code> the similarity/dissimilarity measure is computed via the average of the indexes in all directions.
</p>
<p>The coherence properties specified in Sangalli et al. (2010) implies that if <code>similarity.method</code> is set to <code>'d0.L2'</code>, <code>'d1.L2'</code>, <code>'d0.L2.centered'</code> or <code>'d1.L2.centered'</code>, value of <code>warping.method</code> must be <code>'shift'</code> or <code>'NOalignment'</code>. If <code>similarity.method</code> is set to <code>'d0.pearson'</code> or <code>'d1.pearson'</code> all values for <code>warping.method</code> are allowed.
</p>


<h3>Value</h3>

<p>scalar: similarity/dissimilarity measure between the two functions <code class="reqn">f</code> and <code class="reqn">g</code> computed via the similarity/dissimilarity measure specified.
</p>


<h3>Author(s)</h3>

<p>Alice Parodi, Mirco Patriarca, Laura Sangalli, Piercesare Secchi, Simone Vantini, Valeria Vitelli.
</p>


<h3>References</h3>

<p>Sangalli, L.M., Secchi, P., Vantini, S., Vitelli, V., 2010. <em>"K-mean alignment for curve clustering"</em>. Computational Statistics and Data Analysis, 54, 1219-1233.
</p>
<p>Sangalli, L.M., Secchi, P., Vantini, S., 2014. <em>"Analysis of AneuRisk65 data: K-mean Alignment"</em>. Electronic Journal of Statistics, Special Section on "Statistics of Time Warpings and Phase Variations", Vol. 8, No. 2, 1891-1904.
</p>


<h3>See Also</h3>

<p><code>kma</code>
</p>


</div>