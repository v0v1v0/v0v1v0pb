<div class="container">

<table style="width: 100%;"><tr>
<td>write.pop.projection.summary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Writing Projection Summary and Trajectory Files
</h2>

<h3>Description</h3>

<p>Functions for creating ASCII files containing projection summaries, such as the median, the lower and upper bound of the 80 and 95% probability intervals, respectively, as well as containing individual trajectories.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.pop.projection.summary(pop.pred, what = NULL, expression = NULL, 
    output.dir = NULL, ...)
    
write.pop.trajectories(pop.pred, expression = "PXXX", 
    output.file = "pop_trajectories.csv", byage = FALSE, 
    observed = FALSE,  wide = FALSE, digits = NULL,
    include.name = FALSE, sep = ",", na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop.pred</code></td>
<td>
<p>Object of class <code>bayesPop.prediction</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>A character vector specifying what kind of projection to write. Total population is specified by “pop”. Vital events are specified by “births”, “deaths”, “sr” (survival rate), “fertility” and “pfertility” (percent fertility). Each of these strings can (some must) have a suffix “sex” and/or “age” if sex- and/or age-specific measure is desired. For example, “popage”, “birthssexage”, “deaths”, “deathssex”, are all valid values. Note that for survival, only “srsexage” is allowed. For percent fertility, only “pfertilityage” is allowed. Suffix “sex” cannot be used in combination with “fertility”. Moreover, “fertility” (without age) corresponds to the total fertility rate. If the argument is <code>NULL</code>, all valid combinations are used.  The argument is not used if <code>expression</code> is given. Note that vital events can be only used if the prediction object contains vital events, i.e. if it was generated with the <code>keep.vital.events</code> argument being <code>TRUE</code> (see <code>pop.predict</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression</code></td>
<td>
<p>Expression defining the measure to be written. If it is not <code>NULL</code>, argument <code>what</code> is ignored. For expression syntax see <code>pop.expressions</code>. The country components of the expression should be given as “XXX”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.dir</code></td>
<td>
<p>Directory in which the resulting files will be stored. If <code>NULL</code> <code>pop.pred$output.directory</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.file</code></td>
<td>
<p>File name to write the trajectories into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byage</code></td>
<td>
<p>Logical indicating if the expression is defined by age, i.e. if it includes curly braces (<code>TRUE</code>), of if it is defined by time (<code>FALSE</code>), see <code>pop.expressions</code> for more detail on the expression syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>Logical indicating if observed data should be written (<code>TRUE</code>) or projected trajectories (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wide</code></td>
<td>
<p>Logical indicating if the data format should be wide. By default, trajectories are written in long format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>To how many decimal digits should the indicator be rounded. By default no rounding takes place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.name</code></td>
<td>
<p>Logical indicating if country names should be included in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>The field separator string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Logical indicating if records with <code>NA</code> values should be included in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>For <code>write.pop.projection.summary</code>, these are:
</p>

<ul>
<li>
<p> if <code>expression</code> is given, then one can use here <code>file.suffix</code> (defines the file suffix) and/or <code>expression.label</code> which defaults to the actual expression and is put as the first line in the resulting file;
</p>
</li>
<li>
<p> logical <code>include.observed</code> determines if observed data should be included;
</p>
</li>
<li>
<p> integer <code>digits</code> defines the number of decimal places in the resulting file;
</p>
</li>
<li>
<p> for 5-year projections, logical <code>end.time.only</code> determines if the time columns should be in form of time periods (as XXXX-YYYY) or just the end years (YYYY);
</p>
</li>
<li>
<p> logical <code>adjust</code> determines if the numbers should be adjusted; in such a case, <code>adj.to.file</code> and <code>allow.negative.adj</code> give the file name to which to adjust and a switch if negatives are allowed for the adjustments, respectively.
</p>
</li>
</ul>
<p>For <code>write.pop.trajectories</code>, these are arguments passed to <code>get.pop.ex</code> (if <code>byage</code> is <code>FALSE</code>) or <code>get.pop.exba</code> (if <code>byage</code> is <code>TRUE</code>). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>write.pop.projection.summary</code> function creates one file per value of <code>what</code>, or <code>expression</code>, called ‘<span class="file">projection_summary_</span>’<em>suffix</em>‘<span class="file">.csv</span>’, where <em>suffix</em> is either <code>what</code> or, if an expression is given, the value of <code>file.suffix</code>. It is a comma-separated table with the following columns:
</p>

<ul>
<li> <p>“country_name”: country name 
</p>
</li>
<li> <p>“country_code”: country code 
</p>
</li>
<li> <p>“variant”: name of the variant, such as “median”, “lower 80”, “upper 80”, “lower 95”, “upper 95”
</p>
</li>
<li>
<p> period1: e.g. “2005-2010”, or “2010”: Given population measure for the first time period
</p>
</li>
<li>
<p> period2: e.g. “2010-2015”, or “2015”: Given population measure for the second time period
</p>
</li>
<li> <p>... further time period columns	
</p>
</li>
</ul>
<p>If  <code>expression</code> is given, <code>expression.label</code> (by default the full expression) is written as the first line of the file starting with #. The file contains one line per country, and possibly sex and age.
</p>
<p>Function <code>write.pop.trajectories</code> writes out all trajectories, either in long format (default) or, if <code>wide = TRUE</code> in wide format (years become columns).
</p>


<h3>Note</h3>

<p>If the <code>expression</code> argument is used, the same applies as for <code>pop.map</code> in terms of Performance and Caching.
</p>


<h3>Author(s)</h3>

<p>Hana Sevcikova
</p>


<h3>See Also</h3>

<p><code>pop.predict</code>, <code>pop.map</code>, <code>pop.expressions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">outdir &lt;- tempfile()
dir.create(outdir)
sim.dir &lt;- file.path(find.package("bayesPop"), "ex-data", "Pop")
pred &lt;- get.pop.prediction(sim.dir=sim.dir, write.to.cache=FALSE)

# proportion of 65+ years old to the whole population
write.pop.projection.summary(pred, expression="PXXX[14:27] / PXXX", file.suffix="age65plus", 
    output.dir=outdir, include.observed=TRUE, digits=2)
    
# various measures
write.pop.projection.summary(pred, what=c("pop", "popsexage", "popsex"),
    output.dir=outdir)

unlink(outdir, recursive=TRUE)
</code></pre>


</div>