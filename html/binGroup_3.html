<div class="container">

<table style="width: 100%;"><tr>
<td>Array.Measures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Operating characteristics for array testing without master pooling</h2>

<h3>Description</h3>

<p>Calculate the expected number of tests and accuracy measures
for each individual using array testing without master pooling
</p>


<h3>Usage</h3>

<pre><code class="language-R">Array.Measures(p, se, sp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>matrix of probabilities corresponding to each individual's risk 
of disease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the sensitivity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>the specificity of the diagnostic test.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the operating characteristics for
array testing without master pooling. Operating characteristics calculated
are expected number of tests, pooling sensitivity, pooling specificity, 
pooling positive predictive value, and pooling negative predictive value 
for each individual.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the expected number of tests for the array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSe</code></td>
<td>
<p>a matrix containing each individual's pooling sensitivity, 
corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSp</code></td>
<td>
<p>a matrix containing each individual's pooling specificity, 
corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPV</code></td>
<td>
<p>a matrix containing each individual's pooling positive predictive
value, corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPV</code></td>
<td>
<p>a matrix containing each individual's pooling negative predictive
value, corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function returns the pooling positive and negative
predictive values for all individuals in the array even though these
measures are diagnostic specific; i.e., PPV (NPV) should only be considered
for those individuals who have tested positive (negative).
</p>


<h3>Author(s)</h3>

<p>This function was originally written by Christopher S. McMahan for 
McMahan et al. (2012). The function was obtained from 
<a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a>.
</p>


<h3>References</h3>

<p>McMahan, C., Tebbs, J., Bilder, C. (2012).
“Two-Dimensional Informative Array Testing.”
<em>Biometrics</em>, <b>68</b>(3), 793–804.
ISSN 0006341X, doi: <a href="https://doi.org/10.1111/j.1541-0420.2011.01726.x">10.1111/j.1541-0420.2011.01726.x</a>.
</p>


<h3>See Also</h3>

<p><code>MasterPool.Array.Measures</code> for calculating operating 
characteristics under non-informative array testing with master pooling, 
<code>hierarchical.desc2</code> for three-stage hierarchical and 
non-informative two-stage hierarchical testing, and 
<code>inf.dorf.measures</code> for informative two-stage hierarchical 
testing. See <code>p.vec.func</code> for generating a vector of 
individual risk probabilities for informative group testing and 
<code>Informative.array.prob</code> for arranging individual risk
probabilities in a matrix for informative array testing.  
</p>
<p><a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a>
</p>
<p>Other Operating characteristic functions: <code>MasterPool.Array.Measures</code>,
<code>hierarchical.desc2</code>,
<code>inf.dorf.measures</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the operating characteristics for 
#   non-informative array testing without master
#   pooling, with a 5x5 array and an overall disease 
#   risk of p = 0.02.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
p.mat &lt;- matrix(data=0.02, ncol=5, nrow=5)
Array.Measures(p=p.mat, se=0.95, sp=0.95)

# Calculate the operating characteristics for 
#   informative array testing without master
#   pooling, with a 3x3 array and an overall disease
#   risk of p = 0.03 and alpha = 2.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
set.seed(8791)
p.vec &lt;- p.vec.func(p=0.03, alpha=2, grp.sz=9)
p.mat &lt;- Informative.array.prob(prob.vec=p.vec, nr=3, 
nc=3, method="gd")
Array.Measures(p=p.mat, se=0.99, sp=0.99)
</code></pre>


</div>