<div class="container">

<table style="width: 100%;"><tr>
<td>plotblockrand</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Create a pdf file of randomization cards </h2>

<h3>Description</h3>

<p>Creates a pdf file of randomization cards based on the output from
<code>blockrand</code>.  This file can then be printed and the cards put into
envelopes for use by a study coordinator for assigning subjects to treatment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotblockrand(x, file = "blockrand.pdf", top, middle, bottom,
blockrand.text, width = 11, height = 8.5, par.args, id.col = "id",
stratum.col = "stratum",
treat.col = "treatment", cut.marks = FALSE, top.ho, top.vo, middle.ho,
middle.vo, bottom.ho, bottom.vo, nrow=2, ncol=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A data frame, usually the output from <code>blockrand</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p> The name of the pdf file to create (include the .pdf in
the name) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top</code></td>
<td>
<p> A character vector or list (see details) with the template
to be printed at the top of each card</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>middle</code></td>
<td>
<p> A character vector or list (see details) with the
template to be printed in the middle of each card (positioned to be
visible through the window of an envelope) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom</code></td>
<td>
<p> A single character string to be printed at the bottom
of each card </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockrand.text</code></td>
<td>
<p>A list with default values to use for other options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p> Passed to <code>pdf</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p> Passed to <code>pdf</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.args</code></td>
<td>
<p> A list containing additional arguments to <code>par</code>
before plotting the text </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.col</code></td>
<td>
<p> Name or number of the column in <code>x</code> that contains
the id's of the subjects </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum.col</code></td>
<td>
<p> Name or number of the column in <code>x</code> that
contains the names of the strata </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat.col</code></td>
<td>
<p> Name or number of the column in <code>x</code> that
contains the treatment assignments </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.marks</code></td>
<td>
<p> Logical, should cut marks be plotted as well (useful
if printing on plain paper then cutting apart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top.ho</code></td>
<td>
<p>Shift top text to the right(left)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top.vo</code></td>
<td>
<p>Shift top text up(down)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>middle.ho</code></td>
<td>
<p>Shift middle text to the right(left)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>middle.vo</code></td>
<td>
<p>Shift middle text up(down)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom.ho</code></td>
<td>
<p>Shift bottom text to the right(left)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom.vo</code></td>
<td>
<p>Shift bottom text up(down)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>Number of rows of cards to print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>Number of columns of cards to print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Optional arguments passed to <code>pdf</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a pdf file with randomization "cards".  It puts
4 cards per page.  You can either print the file onto perforated cards
(Avery 8387) or onto regular paper then cut the cards apart.  The top
of each card can then be folded over (extra protection from someone
trying to read the upcoming treatments) and the card placed in an
envelope (letter size) with a window and sealed.  The envelopes are
then used by a study coordinator to assign subjects to treatments as
they are enrolled into the trial.
</p>
<p>Each card is split into 3 parts, top, middle, and bottom.
</p>
<p>The top
part is printed flush left and is the part that will be folded over
for better security.  Information on the treatment assignment goes
here along with any other information you want.
</p>
<p>The middle part is printed centered so that it will appear through the
window of the envelope.  The subject ID number and stratification
information should go here.
</p>
<p>The bottom part is limited to a single line that will be printed flush
right at the bottom of the card.  This can be used for additional
instructions to the study coordinator (e.g. call the statistician at
123-4567 to record assignment).
</p>
<p>The <code>top</code>, <code>middle</code>, and <code>bottom</code> templates can be
vectors or lists.  If the vectors
have length greater than 1, then each element of the vector will be
printed on a separate line (if there are 3 elements in <code>top</code> then
there will be 3 lines at the top, etc.), <code>bottom</code> should only
have a single element.  If <code>top</code>, <code>middle</code>, or <code>bottom</code>
are lists then they should have an element named "text"
that consists of a character vector containing the template.  The
lists can then also have optional elements named "font" and "col",
these vectors should be the same length as the "text" vector and
represent the fonts and colors to use for the corresponding lines of
text (for example if <code>font</code> is <code>c(1,2,1)</code> then the 2nd line
will be printed bold).
</p>
<p>If the template in <code>top</code> or <code>middle</code> contains "%ID%" (not
including the quotes, but including the percent signs) then this
string will be replaced with the contents of the ID column for each
card.  If they contain "%STRAT%" then it will be replaced with the
contents of the stratum column.  If <code>top</code> contains "%TREAT%" then
it will be replaced with the contents of the treatment column (note
that this is not available in the <code>middle</code> template).
</p>
<p>If any of the arguments <code>top</code>, <code>middle</code>, or <code>bottom</code>
are missing then the function will look for a corresponding element in
the <code>blockrand.text</code> argument (a list) to use as the template.
If the list does not exist, or the list does not have a corresponding
element, then that portion of the card will be blank.  Specifying the
argument when calling the function will override the <code>blockrand.text</code>
list.
</p>
<p>The arguments <code>top.ho</code>, <code>middle.ho</code>, and <code>bottom.ho</code>
move the corresponding parts to the right (left if negative).  The
units are approximately <code>strwidth("W")</code> so specifying a value of
<code>0.5</code> will move the section about half a character to the right.
The arguments
<code>top.vo</code>, <code>middle.vo</code>, and <code>bottom.vo</code> move the
corresponding parts up (down if negative).  The units are approximately
<code>1.5*strheight("Wj")</code>.
</p>
<p>If any of the offset arguments are not specified then the
corresponding element of the list "blockrand.text" is used if it
exists otherwise they are 0.
</p>
<p>The idea of the "blockrand.text" list is to set common defaults for
your system (the default positions work for me, but you may want to
tweak things for your system) including templates that are commonly
used in your institution.  Individual pieces can then be overridden
with the function arguments.  You can have a list saved with your
defaults and pass that list to the <code>blockrand.text</code> argument.
</p>


<h3>Value</h3>

<p>This function does not return anything useful, it is run for the side
effect of creating a pdf file.  The pdf file will have 4 cards per page
and 1 card for each line of <code>x</code>.
</p>


<h3>Note</h3>

<p>Adobe Acrobat (and possibly other pdf viewers) will often try to
rescale the page when printing, for best results turn this feature off
before printing.
</p>


<h3>Author(s)</h3>

<p>Greg Snow <a href="mailto:538280@gmail.com">538280@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class="language-R">## stratified by sex, 100 in stratum, 2 treatments
male &lt;- blockrand(n=100, id.prefix='M', block.prefix='M',stratum='Male')
female &lt;- blockrand(n=100, id.prefix='F', block.prefix='F',stratum='Female')

my.study &lt;- rbind(male,female)

## Not run: 
plotblockrand(my.study,'mystudy.pdf',
   top=list(text=c('My Study','Patient: %ID%','Treatment: %TREAT%'),
            col=c('black','black','red'),font=c(1,1,4)),
   middle=list(text=c("My Study","Sex: %STRAT%","Patient: %ID%"),
               col=c('black','blue','green'),font=c(1,2,3)),
   bottom="Call 123-4567 to report patient entry",
   cut.marks=TRUE)

### or

my.blockrand.text &lt;- list(
   top=list(text=c('My Study','Patient: %ID%','Treatment: %TREAT%'),
            col=c('black','black','red'),font=c(1,1,4)),
   middle=list(text=c("My Study","Sex: %STRAT%","Patient: %ID%"),
               col=c('black','blue','green'),font=c(1,2,3)),
   bottom="Call 123-4567 to report patient entry")

plotblockrand(my.study, 'mystudy.pdf', blockrand.text=my.blockrand.text,
     cut.marks=TRUE)

## End(Not run)
</code></pre>


</div>