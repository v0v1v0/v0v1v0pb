<div class="container">

<table style="width: 100%;"><tr>
<td>vsb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance estimator for spatially balanced samples</h2>

<h3>Description</h3>

<p>Variance estimator of HT estimator of population total.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vsb(probs, ys, xs, k = 3L, type = "kdtree2", bucketSize = 40)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A vector of length n with inclusion probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ys</code></td>
<td>
<p>A vector of length n containing the target variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xs</code></td>
<td>
<p>An n by p matrix of (standardized) auxiliary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of neighbours to construct the means around.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The method used in finding nearest neighbours.
Must be one of <code>"kdtree0"</code>, <code>"kdtree1"</code>, <code>"kdtree2"</code>, and
<code>"notree"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bucketSize</code></td>
<td>
<p>The maximum size of the terminal nodes in the k-d-trees.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>k = 0L</code>, the variance estimate is constructed by using all units that
have the minimum distance.
</p>
<p>If <code>k &gt; 0L</code>, the variance estimate is constructed by using the <code>k</code> closest
units. If multiple units are located on the border, all are used.
</p>


<h3>Value</h3>

<p>The variance estimate.
</p>


<h3>k-d-trees</h3>

<p>The <code>type</code>s "kdtree" creates k-d-trees with terminal node bucket sizes
according to <code>bucketSize</code>.
</p>

<ul>
<li>
<p>"kdtree0" creates a k-d-tree using a median split on alternating variables.
</p>
</li>
<li>
<p>"kdtree1" creates a k-d-tree using a median split on the largest range.
</p>
</li>
<li>
<p>"kdtree2" creates a k-d-tree using a sliding-midpoint split.
</p>
</li>
<li>
<p>"notree" does a naive search for the nearest neighbour.
</p>
</li>
</ul>
<h3>References</h3>

<p>Grafstr√∂m, A., &amp; Schelin, L. (2014).
How to select representative samples.
Scandinavian Journal of Statistics, 41(2), 277-290.
</p>


<h3>See Also</h3>

<p>Other measure: 
<code>sb()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(12345);
N = 1000;
n = 100;
prob = rep(n/N, N);
x = matrix(runif(N * 2), ncol = 2);
y = runif(N);
s = lpm2(prob, x);
vsb(prob[s], y[s], x[s, ]);
vsb(prob[s], y[s], x[s, ], 0L);

## End(Not run)

</code></pre>


</div>