<div class="container">

<table style="width: 100%;"><tr>
<td>makessa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Makes Objects to Fit Smoothing Spline ANOVA Models
</h2>

<h3>Description</h3>

<p>This function creates a list containing the necessary information to fit a smoothing spline anova model (see <code>bigssa</code>). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">makessa(formula,data=NULL,type=NULL,nknots=NULL,rparm=NA,
        lambdas=NULL,skip.iter=TRUE,se.fit=FALSE,rseed=1234,
        gcvopts=NULL,knotcheck=TRUE,gammas=NULL,weights=NULL,
        random=NULL,remlalg=c("FS","NR","EM","none"),remliter=500,
       remltol=10^-4,remltau=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>An object of class "<code>formula</code>": a symbolic description of the model to be fitted (see Details and Examples for more information).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Optional data frame, list, or environment containing the variables in <code>formula</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>List of smoothing spline types for predictors in <code>formula</code> (see Details). Options include <code>type="cub"</code> for cubic, <code>type="acub"</code> for another cubic, <code>type="per"</code> for cubic periodic, <code>type="tps"</code> for cubic thin-plate, and <code>type="nom"</code> for nominal.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nknots</code></td>
<td>

<p>Two possible options: (a) scalar giving total number of random knots to sample, or (b) vector indexing which rows of <code>data</code> to use as knots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rparm</code></td>
<td>

<p>List of rounding parameters for each predictor. See Details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>

<p>Vector of global smoothing parameters to try. Default uses <code>lambdas=10^-c(9:0)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip.iter</code></td>
<td>

<p>Logical indicating whether to skip the iterative smoothing parameter update. Using <code>skip.iter=FALSE</code> should provide a more optimal solution, but the fitting time may be substantially longer. See Computational Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>

<p>Logical indicating if the standard errors of the fitted values should be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rseed</code></td>
<td>

<p>Random seed for knot sampling. Input is ignored if <code>nknots</code> is an input vector of knot indices. Set <code>rseed=NULL</code> to obtain a different knot sample each time, or set <code>rseed</code> to any positive integer to use a different seed than the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gcvopts</code></td>
<td>

<p>Control parameters for optimization. List with 3 elements: (a) <code>maxit</code>: maximum number of algorithm iterations, (b) <code>gcvtol</code>: covergence tolerance for iterative GCV update, and (c) <code>alpha</code>: tuning parameter for GCV minimization. Default: <code>gcvopts=list(maxit=5,gcvtol=10^-5,alpha=1)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knotcheck</code></td>
<td>

<p>If <code>TRUE</code>, only unique knots are used (for stability).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammas</code></td>
<td>

<p>List of initial smoothing parameters for each predictor. See Details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Vector of positive weights for fitting (default is vector of ones).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p>Adds random effects to model (see Random Effects section).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remlalg</code></td>
<td>

<p>REML algorithm for estimating variance components (see Random Effects section). Input is ignored if <code>is.null(random)</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remliter</code></td>
<td>

<p>Maximum number of iterations for REML estimation of variance components. Input is ignored if <code>random=NULL</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remltol</code></td>
<td>

<p>Convergence tolerance for REML estimation of variance components. Input is ignored if <code>random=NULL</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remltau</code></td>
<td>

<p>Initial estimate of variance parameters for REML estimation of variance components. Input is ignored if <code>random=NULL</code>.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>bigssa</code> and below example for more details.
</p>


<h3>Value</h3>

<p>An object of class "makessa", which can be input to <code>bigssa</code>.
</p>


<h3>Warning </h3>

<p>When inputting a "makessa" class object into <code>bigssa</code>, the formula input to <code>bigssa</code> must be a nested version of the original formula input to <code>makessa</code>. In other words, you cannot add any new effects after a "makessa" object has been created, but you can drop (remove) effects from the model.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Gu, C. (2013). <em>Smoothing spline ANOVA models, 2nd edition</em>. New York: Springer.
</p>
<p>Helwig, N. E. (2013). <em>Fast and stable smoothing spline analysis of variance models for large samples with applications to electroencephalography data analysis</em>. Unpublished doctoral dissertation. University of Illinois at Urbana-Champaign.
</p>
<p>Helwig, N. E. (2016). Efficient estimation of variance components in nonparametric mixed-effects models with large samples. <em>Statistics and Computing, 26</em>, 1319-1336.
</p>
<p>Helwig, N. E. (2017). <a href="http://dx.doi.org/10.3389/fams.2017.00015">Regression with ordered predictors via ordinal smoothing splines</a>. Frontiers in Applied Mathematics and Statistics, 3(15), 1-13.
</p>
<p>Helwig, N. E. and Ma, P. (2015). Fast and stable multiple smoothing parameter selection in smoothing spline analysis of variance models with large samples. <em>Journal of Computational and Graphical Statistics, 24</em>, 715-732.
</p>
<p>Helwig, N. E. and Ma, P. (2016). Smoothing spline ANOVA for super-large samples: Scalable computation via rounding parameters. <em>Statistics and Its Interface, 9</em>, 433-444.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##########   EXAMPLE  ##########

# function with two continuous predictors
set.seed(773)
myfun &lt;- function(x1v,x2v){
  sin(2*pi*x1v) + log(x2v+.1) + cos(pi*(x1v-x2v))
}
x1v &lt;- runif(500)
x2v &lt;- runif(500)
y &lt;- myfun(x1v,x2v) + rnorm(500)

# fit 2 possible models (create information 2 separate times)
system.time({
  intmod &lt;- bigssa(y~x1v*x2v,type=list(x1v="cub",x2v="cub"),nknots=50)
  addmod &lt;- bigssa(y~x1v+x2v,type=list(x1v="cub",x2v="cub"),nknots=50)
})

# fit 2 possible models (create information 1 time)
system.time({
  makemod &lt;- makessa(y~x1v*x2v,type=list(x1v="cub",x2v="cub"),nknots=50)
  int2mod &lt;- bigssa(y~x1v*x2v,makemod)
  add2mod &lt;- bigssa(y~x1v+x2v,makemod)
})

# check difference (no difference)
crossprod( intmod$fitted.values - int2mod$fitted.values )
crossprod( addmod$fitted.values - add2mod$fitted.values )

</code></pre>


</div>