<div class="container">

<table style="width: 100%;"><tr>
<td>Airy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Airy Functions (and Their First Derivative)</h2>

<h3>Description</h3>

<p>Compute the Airy functions <code class="reqn">Ai</code> or <code class="reqn">Bi</code> or their first
derivatives,
<code class="reqn">\frac{d}{dz} Ai(z)</code> and
<code class="reqn">\frac{d}{dz} Bi(z)</code>.
</p>
<p>The Airy functions are solutions of the differential equation
</p>
<p style="text-align: center;"><code class="reqn">w'' = z w</code>
</p>

<p>for <code class="reqn">w(z)</code>, and are related to each other and to the
(modified) Bessel functions via (many identities, see
<a href="https://dlmf.nist.gov/9.6">https://dlmf.nist.gov/9.6</a>), e.g., if
<code class="reqn">\zeta := \frac{2}{3} z \sqrt{z} = \frac{2}{3} z^{\frac{3}{2}}</code>,
</p>
<p style="text-align: center;"><code class="reqn">Ai(z) = \pi^{-1}\sqrt{z/3}K_{1/3}(\zeta) =
            \frac{1}{3}\sqrt{z}\left(I_{-1/3}(\zeta) - I_{1/3}(\zeta)\right),</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">Bi(z) = \sqrt{z/3} \left(I_{-1/3}(\zeta) + I_{1/3}(\zeta)\right).</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">AiryA(z, deriv = 0, expon.scaled = FALSE, verbose = 0)
AiryB(z, deriv = 0, expon.scaled = FALSE, verbose = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>complex or numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>order of derivative; must be 0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expon.scaled</code></td>
<td>
<p>logical indicating if the result should be scaled
by an exponential factor (typically to avoid under- or over-flow).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>integer defaulting to 0, indicating the level of verbosity
notably from C code.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, when <code>expon.scaled</code> is false, <code>AiryA()</code>
computes the complex Airy function <code class="reqn">Ai(z)</code> or its derivative
<code class="reqn">\frac{d}{dz} Ai(z)</code> on <code>deriv=0</code> or <code>deriv=1</code>
respectively. <br>
When <code>expon.scaled</code> is true, it returns
<code class="reqn">\exp(\zeta) Ai(z)</code> or
<code class="reqn">\exp(\zeta) \frac{d}{dz} Ai(z)</code>,
effectively removing the exponential decay in
<code class="reqn">-\pi/3 &lt; \arg(z) &lt; \pi/3</code> and
the exponential growth in
<code class="reqn">\pi/3 &lt; \left|\arg(z)\right| &lt; \pi</code>,
where <code class="reqn">\zeta= \frac{2}{3} z \sqrt{z}</code>, and
<code class="reqn">\arg(z) = </code><code>Arg(z)</code>.
</p>
<p>While the Airy functions <code class="reqn">Ai(z)</code> and <code class="reqn">d/dz Ai(z)</code> are
analytic in the whole <code class="reqn">z</code> plane, the corresponding scaled
functions (for <code>expon.scaled=TRUE</code>) have a cut along the
negative real axis.

</p>
<p>By default, when <code>expon.scaled</code> is false, <code>AiryB()</code>
computes the complex Airy function <code class="reqn">Bi(z)</code> or its derivative
<code class="reqn">\frac{d}{dz} Bi(z)</code> on <code>deriv=0</code> or <code>deriv=1</code>
respectively. <br>
When <code>expon.scaled</code> is true, it returns
<code class="reqn">exp(-\left|\Re(\zeta)\right|) Bi(z)</code> or
<code class="reqn">exp(-\left|\Re(\zeta)\right|)\frac{d}{dz}Bi(z)</code>,
to remove the exponential behavior in both the left and right half
planes where, as above,
<code class="reqn">\zeta= \frac{2}{3}\cdot z \sqrt{z}</code>.
</p>


<h3>Value</h3>

<p>a complex or numeric vector of the same length (and class) as <code>z</code>.
</p>


<h3>Author(s)</h3>

<p>Donald E. Amos, Sandia National Laboratories, wrote the original
fortran code.
Martin Maechler did the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> interface.
</p>


<h3>References</h3>

<p>see <code>BesselJ</code>; notably for many results the
</p>
<p>Digital Library of Mathematical Functions (DLMF), Chapter 9
<em>Airy and Related Functions</em> at <a href="https://dlmf.nist.gov/9">https://dlmf.nist.gov/9</a>.
</p>


<h3>See Also</h3>

<p><code>BesselI</code> etc; the Hankel functions <code>Hankel</code>.
</p>
<p>The CRAN package <a href="https://CRAN.R-project.org/package=Rmpfr"><span class="pkg">Rmpfr</span></a> has <code>Ai(x)</code> for
arbitrary precise "mpfr"-numbers <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The AiryA() := Ai() function -------------

curve(AiryA, -20, 100, n=1001)
curve(AiryA,  -1, 100, n=1011, log="y") -&gt; Aix
curve(AiryA(x, expon.scaled=TRUE), -1, 50, n=1001)
## Numerically "proving" the 1st identity above :
z &lt;- Aix$x; i &lt;- z &gt; 0; head(z &lt;- z[i &lt;- z &gt; 0])
Aix &lt;- Aix$y[i]; zeta &lt;- 2/3*z*sqrt(z)
stopifnot(all.equal(Aix, 1/pi * sqrt(z/3)* BesselK(zeta, nu = 1/3),
                    tol = 4e-15)) # 64b Lnx: 7.9e-16;  32b Win: 1.8e-15

## This gives many warnings (248 on nb-mm4, F24) about lost accuracy, but on Windows takes ~ 4 sec:
curve(AiryA(x, expon.scaled=TRUE),  1, 10000, n=1001, log="xy")

## The AiryB() := Bi() function -------------

curve(AiryB, -20, 2, n=1001); abline(h=0,v=0, col="gray",lty=2)
curve(AiryB, -1, 20, n=1001, log = "y") # exponential growth (x &gt; 0)

curve(AiryB(x,expon.scaled=TRUE), -1, 20,    n=1001)
curve(AiryB(x,expon.scaled=TRUE),  1, 10000, n=1001, log="x")
</code></pre>


</div>