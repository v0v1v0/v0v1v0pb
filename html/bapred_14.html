<div class="container">

<table style="width: 100%;"><tr>
<td>combatba</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Batch effect adjustment using ComBat
</h2>

<h3>Description</h3>

<p>Performs batch effect adjustment using the parametric version of ComBat and additionally returns information necessary for addon batch effect adjustment with ComBat.
</p>


<h3>Usage</h3>

<pre><code class="language-R">combatba(x, batch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>matrix. The covariate matrix. Observations in rows, variables in columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>

<p>factor. Batch variable. Each factor level (or 'category') corresponds to one of the batches. For example, if there are four batches, this variable would have four factor levels and observations with the same factor level would belong to the same batch.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>combatba</code> returns an object of class <code>combat</code>.
An object of class "<code>combat</code>" is a list containing the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xadj</code></td>
<td>
<p> matrix of adjusted (training) data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanoverall</code></td>
<td>
<p> vector containing the overall means of the variables. Used in addon adjustment. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.pooled</code></td>
<td>
<p> vector containing the pooled variances of the variables. Used in addon adjustment. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>
<p> batch variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbatches</code></td>
<td>
<p> number of batches </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The original ComBat-code is used in <code>combatba</code>:
<a href="http://www.bu.edu/jlab/wp-assets/ComBat/Download.html">http://www.bu.edu/jlab/wp-assets/ComBat/Download.html</a> (Access date: 2015/06/19)
</p>


<h3>Author(s)</h3>

<p>Roman Hornung
</p>


<h3>References</h3>

<p>Johnson, W. E., Rabinovic, A., Li, C. (2007). Adjusting batch effects in microarray expression data using empirical bayes methods. Biostatistics 8:118-127, &lt;doi: <a href="https://doi.org/10.1093/biostatistics/kxj037">10.1093/biostatistics/kxj037</a>&gt;.
</p>
<p>Luo, J., Schumacher, M., Scherer, A., Sanoudou, D., Megherbi, D., Davison, T., Shi, T., Tong, W., Shi, L., Hong, H., Zhao, C., Elloumi, F., Shi, W., Thomas, R., Lin, S., Tillinghast, G., Liu, G., Zhou, Y., Herman, D., Li, Y., Deng, Y., Fang, H., Bushel, P., Woods, M., Zhang, J. (2010). A comparison of batch effect removal methods for enhancement of prediction performance using maqc-ii microarray gene expression data. The Pharmacogenomics Journal 10:278-291, &lt;doi: <a href="https://doi.org/10.1038/tpj.2010.57">10.1038/tpj.2010.57</a>&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(autism)

combatba(x=X, batch=batch)
</code></pre>


</div>