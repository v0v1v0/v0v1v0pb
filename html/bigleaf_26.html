<div class="container">

<table style="width: 100%;"><tr>
<td>Gb.Su</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Boundary Layer Conductance according to Su et al. 2001</h2>

<h3>Description</h3>

<p>A physically based formulation for the canopy boundary layer conductance
to heat transfer according to Su et al. 2001.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Gb.Su(
  data,
  Tair = "Tair",
  pressure = "pressure",
  ustar = "ustar",
  wind = "wind",
  H = "H",
  zh,
  zr,
  d,
  z0m = NULL,
  Dl,
  fc = NULL,
  LAI = NULL,
  N = 2,
  Cd = 0.2,
  hs = 0.01,
  stab_formulation = c("Dyer_1970", "Businger_1971"),
  Sc = NULL,
  Sc_name = NULL,
  constants = bigleaf.constants()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame or matrix containing all required variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tair</code></td>
<td>
<p>Air temperature (degC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pressure</code></td>
<td>
<p>Atmospheric pressure (kPa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ustar</code></td>
<td>
<p>Friction velocity (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind</code></td>
<td>
<p>Wind speed (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Sensible heat flux (W m-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zh</code></td>
<td>
<p>Canopy height (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>Reference height (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Zero-plane displacement height (-), can be calculated using <code>roughness.parameters</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0m</code></td>
<td>
<p>Roughness length for momentum (m). If not provided, calculated from <code>roughness.parameters</code> 
within <code>wind.profile</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dl</code></td>
<td>
<p>Leaf characteristic dimension (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fc</code></td>
<td>
<p>Fractional vegetation cover [0-1] (if not provided, calculated from LAI)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAI</code></td>
<td>
<p>One-sided leaf area index (-)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of leaf sides participating in heat exchange (defaults to 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cd</code></td>
<td>
<p>Foliage drag coefficient (-)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>Roughness height of the soil (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stab_formulation</code></td>
<td>
<p>Stability correction function used (If <code>stab_correction = TRUE</code>).
Either <code>"Dyer_1970"</code> or <code>"Businger_1971"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sc</code></td>
<td>
<p>Optional: Schmidt number of additional quantities to be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sc_name</code></td>
<td>
<p>Optional: Name of the additional quantities, has to be of same length than 
<code>Sc_name</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constants</code></td>
<td>
<p>Kelvin - conversion degree Celsius to Kelvin <br>
pressure0 - reference atmospheric pressure at sea level (Pa) <br>
Tair0 - reference air temperature (K) <br>
Sc_CO2 - Schmidt number for CO2 <br> 
Pr - Prandtl number (if <code>Sc</code> is provided)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formulation is based on the kB-1 model developed by Massman 1999. 
Su et al. 2001 derived the following approximation:
</p>
<p style="text-align: center;"><code class="reqn">kB-1 = (k Cd fc^2) / (4Ct ustar/u(zh)) + kBs-1(1 - fc)^2</code>
</p>

<p>If fc (fractional vegetation cover) is missing, it is estimated from LAI:
</p>
<p style="text-align: center;"><code class="reqn">fc = 1 - exp(-LAI/2)</code>
</p>

<p>The wind speed at the top of the canopy is calculated using function
<code>wind.profile</code>.
</p>
<p>Ct is the heat transfer coefficient of the leaf (Massman 1999):
</p>
<p style="text-align: center;"><code class="reqn">Ct = Pr^-2/3 Reh^-1/2 N</code>
</p>

<p>where Pr is the Prandtl number (set to 0.71), and Reh is the Reynolds number for leaves:
</p>
<p style="text-align: center;"><code class="reqn">Reh = Dl wind(zh) / v</code>
</p>

<p>kBs-1, the kB-1 value for bare soil surface, is calculated according 
to Su et al. 2001:
</p>
<p style="text-align: center;"><code class="reqn">kBs^-1 = 2.46(Re)^0.25 - ln(7.4)</code>
</p>

<p>Gb (=1/Rb) for water vapor and heat are assumed to be equal in this package.
Gb for other quantities x is calculated as (Hicks et al. 1987):
</p>
<p style="text-align: center;"><code class="reqn">Gb_x = Gb / (Sc_x / Pr)^0.67</code>
</p>

<p>where Sc_x is the Schmidt number of quantity x, and Pr is the Prandtl number (0.71).
</p>


<h3>Value</h3>

<p>A data.frame with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Gb_h</code></td>
<td>
<p>Boundary layer conductance for heat transfer (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb_h</code></td>
<td>
<p>Boundary layer resistance for heat transfer (s m-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kB_h</code></td>
<td>
<p>kB-1 parameter for heat transfer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gb_Sc_name</code></td>
<td>
<p>Boundary layer conductance for <code>Sc_name</code> (m s-1). Only added if <code>Sc_name</code> and 
<code>Sc_name</code> are provided</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If the roughness length for momentum (<code>z0m</code>) is not provided as input, it is estimated 
from the function <code>roughness.parameters</code> within <code>wind.profile</code>. This function
estimates a single <code>z0m</code> value for the entire time period! If a varying <code>z0m</code> value 
(e.g. across seasons or years) is required, <code>z0m</code> should be provided as input argument.
</p>


<h3>References</h3>

<p>Su, Z., Schmugge, T., Kustas, W. &amp; Massman, W., 2001: An evaluation of
two models for estimation of the roughness height for heat transfer between
the land surface and the atmosphere. Journal of Applied Meteorology 40, 1933-1951.
</p>
<p>Massman, W., 1999: A model study of kB H- 1 for vegetated surfaces using
'localized near-field' Lagrangian theory. Journal of Hydrology 223, 27-43.
</p>
<p>Hicks, B.B., Baldocchi, D.D., Meyers, T.P., Hosker, J.R., Matt, D.R., 1987:
A preliminary multiple resistance routine for deriving dry deposition velocities
from measured quantities. Water, Air, and Soil Pollution 36, 311-330.
</p>


<h3>See Also</h3>

<p><code>Gb.Thom</code>, <code>Gb.Choudhury</code>, <code>aerodynamic.conductance</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Canopy boundary layer resistance (and kB-1 parameter) for a set of meteorological conditions,
# a leaf characteristic dimension of 1cm, and an LAI of 5
df &lt;- data.frame(Tair=25,pressure=100,wind=c(3,4,5),ustar=c(0.5,0.6,0.65),H=c(200,230,250)) 
Gb.Su(data=df,zh=25,zr=40,d=17.5,Dl=0.01,LAI=5)

# the same meteorological conditions, but larger leaves
Gb.Su(data=df,zh=25,zr=40,d=17.5,Dl=0.1,LAI=5)

# same conditions, large leaves, and sparse canopy cover (LAI = 1.5)
Gb.Su(data=df,zh=25,zr=40,d=17.5,Dl=0.1,LAI=1.5)

</code></pre>


</div>