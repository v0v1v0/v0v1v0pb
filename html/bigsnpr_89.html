<div class="container">

<table style="width: 100%;"><tr>
<td>snp_scaleAlpha</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial(n, p) scaling</h2>

<h3>Description</h3>

<p>Binomial(n, p) scaling where <code>n</code> is fixed and <code>p</code> is estimated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snp_scaleAlpha(alpha = -1)

snp_scaleBinom(nploidy = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Assumes that the average contribution (e.g. heritability)
of a SNP of frequency <code class="reqn">p</code> is proportional to
<code class="reqn">[2p(1-p)]^{1+\alpha}</code>. The <code>center</code> is then <code class="reqn">2 p</code> and the <code>scale</code>
is <code class="reqn">[2p(1-p)]^{-\alpha/2}</code>. Default is <code>-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nploidy</code></td>
<td>
<p>Number of trials, parameter of the binomial distribution.
Default is <code>2</code>, which corresponds to diploidy, such as for the human genome.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You will probably not use this function as is but as the
<code>fun.scaling</code> parameter of other functions of package <code>bigstatsr</code>.
</p>


<h3>Value</h3>

<p>A new <strong>function</strong> that returns a data.frame of two vectors
"center" and "scale" which are of the length of <code>ind.col</code>.
</p>


<h3>References</h3>

<p>This scaling is widely used for SNP arrays.
Patterson N, Price AL, Reich D (2006). Population Structure and Eigenanalysis.
PLoS Genet 2(12): e190. <a href="https://doi.org/10.1371/journal.pgen.0020190">doi:10.1371/journal.pgen.0020190</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)

a &lt;- matrix(0, 93, 170)
p &lt;- 0.2
a[] &lt;- rbinom(length(a), 2, p)
X &lt;- add_code256(big_copy(a, type = "raw"), code = c(0, 1, 2, rep(NA, 253)))
X.svd &lt;- big_SVD(X, fun.scaling = snp_scaleBinom())
str(X.svd)
plot(X.svd$center)
abline(h = 2 * p, col = "red")
plot(X.svd$scale)
abline(h = sqrt(2 * p * (1 - p)), col = "red")
</code></pre>


</div>