<div class="container">

<table style="width: 100%;"><tr>
<td>blm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a binomial linear regression model</h2>

<h3>Description</h3>

<p>A direct probability model for regression with a binary outcome from observational data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">blm(formula, data, na.action = na.omit, weights = NULL, 
    strata = NULL, par.init = NULL, warn=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula for linear model for binary outcome, <code>event~x1+x2+...</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame containing the variables of <code>formula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>function specifying how missing data should be handled, na.action</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of weights equal to the number of observations. For population-based case-control study, weights are the inverse sampling fractions for controls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>vector indicating the stratification for weighted regression with stratified observational data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.init</code></td>
<td>
<p>vector (optional) of initial parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical indicator whether to include warnings during algorithm fitting. Default of <code>FALSE</code> suppresses warnings when testing for feasible parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>constrOptim</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>blm</code> model coefficients are the solutions to the maximum of a pseudo log-likelihood using a constrained optimization algorithm with an adaptive barrier method, <code>constrOptim</code> (Lange, 2010). Variance estimates are based on Taylor linearization (Shah, 2002). When <code>weights</code> are not NULL, it is assumed that the study is a case-control design.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>blm</code>.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>References</h3>

<p>Kovalchik S, Varadhan R (2013). Fitting Additive Binomial Regression Models with the R Package blm. <em>Journal of Statistical Software</em>, 54(1), 1-18. URL: <a href="https://www.jstatsoft.org/v54/i01/">https://www.jstatsoft.org/v54/i01/</a>.
</p>
<p>Lange, K. (2010) <em>Numerical Analysis for Statisticians</em>, Springer.
</p>
<p>Shah, BV. (2002) Calculus of Taylor deviations. Joint Statistical Meetings.
</p>


<h3>See Also</h3>

<p>constrOptim</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ccdata)

fit &lt;- blm(y~female+packyear, weights = ccdata$w,strata=ccdata$strata,
				data=ccdata)

summary(fit)


data(aarp)

# ABSOLUTE RISK OF BLADDER CANCER BY 70 YEARS
# FOR DIFFERENT GENDER AND RISK GROUP

fit &lt;- blm(bladder70~female * smoke_status, 
			      data = aarp, 
			      weight=aarp$w)

logLik(fit)

# INTERCEPT IS BASELINE RISK
# ALL OTHER COEFFICIENTS ARE RISK DIFFERENCES FROM BASELINE

summary(fit)

# RISK DIFFERENCE CONFIDENCE INTERVALS (PER 1,000 PERSONS)
confint(fit)*1000
</code></pre>


</div>