<div class="container">

<table style="width: 100%;"><tr>
<td>make.analysis.obj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set up data for QTL mapping </h2>

<h3>Description</h3>

<p>Create commonly used objects for the analysis of a backcross or
intercross experiment or of recombinant inbred lines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.analysis.obj(data, map.frame, marker.frame, marker.levels=NULL,
method="F2", casewt=NULL,varcov=FALSE,mode.mat=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A <code>data.frame</code> (or vector) of phenotype and
(optionally) covariate information </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map.frame</code></td>
<td>
<p> A <code>map.frame.object</code> (see <code> make.map.frame </code>)  encoding the map
information and other details of the study </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.frame</code></td>
<td>
<p> A <code>marker.frame.object</code>.  A matrix or data.frame
of marker state information.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.levels</code></td>
<td>
<p>A vector of length six or <code>NULL</code>. If
<code>NULL</code> then the defaults for the elements are:
</p>

<table>
<tr>
<td style="text-align: left;">
 Element    </td>
<td style="text-align: center;">  F2.default </td>
<td style="text-align: center;">  BC.default</td>
<td style="text-align: center;"> RI.default </td>
</tr>
<tr>
<td style="text-align: left;">
 1  </td>
<td style="text-align: center;">   <code>"AA"</code>           </td>
<td style="text-align: center;">     <code>"AA"</code>
 </td>
<td style="text-align: center;">     <code>"AA"</code>   </td>
</tr>
<tr>
<td style="text-align: left;">
 2  </td>
<td style="text-align: center;">   <code>"Aa"</code>           </td>
<td style="text-align: center;">     <code>"Aa"</code>
 </td>
<td style="text-align: center;">      <code>"aa"</code>  </td>
</tr>
<tr>
<td style="text-align: left;">
   3  </td>
<td style="text-align: center;">   <code>"aa"</code>           </td>
<td style="text-align: center;">    <code>"nil"</code>
   </td>
<td style="text-align: center;">       <code>"nil"</code>  </td>
</tr>
<tr>
<td style="text-align: left;">
   4  </td>
<td style="text-align: center;">   <code>"A-"</code>  </td>
<td style="text-align: center;">  <code>"nil"</code>
   </td>
<td style="text-align: center;">   <code>"nil"</code>     </td>
</tr>
<tr>
<td style="text-align: left;">
   5  </td>
<td style="text-align: center;">  <code>"a-"</code>   </td>
<td style="text-align: center;">    <code>"nil"</code>
   </td>
<td style="text-align: center;">   <code>"nil"</code>      </td>
</tr>
<tr>
<td style="text-align: left;">
   6  </td>
<td style="text-align: center;">  <code>"--"</code>     </td>
<td style="text-align: center;">    <code>"--"</code>
   </td>
<td style="text-align: center;">   <code>"--"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>NA's are allowed in <code>marker.frame</code> as well as the sixth
element(<code>"--"</code> by default) to denote missing data.  To use other
coding schemes replace "AA" and "aa" by codes for homozygous states,
"Aa" by the code for heterozygotes, "A-" by the code for 'not aa',
"a-" by the code for 'not AA', and <code>"--"</code> by the missing code.
Positions 3:5 are just placeholders if <code>method!="F2"</code>, but must
be present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of "F2", "BC1", "RI.self", or "RI.sib" </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>casewt</code></td>
<td>
<p>If there are multiple observations on one genotype (such
as in recombinant inbreds) this can be used to assign a weight to
each observation. The wisdom of doing this is debatable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p>If FALSE, don't create a varcov.object. Otherwise give an
index into data to select a dependent variable. See <code> varcov</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.mat</code></td>
<td>
<p>If <code>NULL</code> use the default. For
<code>method=="F2"</code> ( and the default <code>marker.levels</code> of
<code>AA</code>, <code>Aa</code>, and <code>aa</code> ), 
this is a 3 by 2 matrix:
</p>

<table>
<tr>
<td style="text-align: left;">
     Genotype </td>
<td style="text-align: right;"> add </td>
<td style="text-align: right;"> dom </td>
</tr>
<tr>
<td style="text-align: left;">
     AA </td>
<td style="text-align: right;"> 1 </td>
<td style="text-align: right;"> -1 </td>
</tr>
<tr>
<td style="text-align: left;">
     Aa </td>
<td style="text-align: right;"> 0 </td>
<td style="text-align: right;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
     aa </td>
<td style="text-align: right;"> -1 </td>
<td style="text-align: right;"> -1 </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
</tr>
</table>
<p>For <code>method=="BC1"</code> ( and the default <code>marker.levels</code> of
<code>AA</code> and <code>Aa</code> ),it is
</p>

<table>
<tr>
<td style="text-align: left;">
     Genotype </td>
<td style="text-align: right;"> </td>
</tr>
<tr>
<td style="text-align: left;">
     AA </td>
<td style="text-align: right;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
     Aa </td>
<td style="text-align: right;"> -1 </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
</tr>
</table>
<p>and for RIL methods ( and the default <code>marker.levels</code> of
<code>AA</code> and <code>aa</code> ),it is
</p>

<table>
<tr>
<td style="text-align: left;">
     Genotype </td>
<td style="text-align: right;"> </td>
</tr>
<tr>
<td style="text-align: left;">
     AA </td>
<td style="text-align: right;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
     aa </td>
<td style="text-align: right;"> -1 </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
</tr>
</table>
<p>Other choices of <code>marker.levels</code> will relabel the corresponding
rows.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A lot of stuff is bundled together in one object. The function is
really just a wrapper calling other <code>make.*</code> functions.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p><code>data.frame</code> of phenotype, covariate information,
and regressors created by <code> make.regressor.matrix </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p>A varcov.object. See  <code> make.varcov </code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.names</code></td>
<td>
<p>The names of the regressors from <code>
      make.regressor.matrix </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The <code> method </code> argument in the call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state.matrix</code></td>
<td>
<p>See <code> make.state.matrix </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.right</code></td>
<td>
<p>See <code> make.loc.right </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map.frame</code></td>
<td>
<p>See <code> make.map.frame </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>casewt</code></td>
<td>
<p>The <code> casewt </code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.mat</code></td>
<td>
<p>The <code>mode.mat</code> used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>A string giving the version of BQTL from qhich the
objects was created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The function call</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> This can be quite a LARGE object.It might be better
in crosses with lots (say, thousands) of markers, or in which many
'virtual' markers are used, or on computers with limited RAM to
store each component separately. Not all components are used in
every type of analysis. </p>


<h3>Author(s)</h3>

<p>Charles C. Berry <a href="mailto:cberry@ucsd.edu">cberry@ucsd.edu</a></p>


<h3>See Also</h3>

<p><code>make.map.frame</code> for definition of the marker map, The
internally used functions are: <code>make.loc.right</code>,
<code>make.state.matrix</code>, <code>make.regressor.matrix</code>,
<code>make.varcov</code>,  and <code>make.marker.numeric</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data( little.bc.pheno )
data( little.mf.5 )
data( little.bc.markers )
names(little.bc.pheno)
little.ana.bc &lt;- make.analysis.obj(little.bc.pheno$bc.phenotype,
                                   little.mf.5,little.bc.markers,
                                   method="BC1")
summary( little.ana.bc )


</code></pre>


</div>