<div class="container">

<table style="width: 100%;"><tr>
<td>adonis_pertables</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> 
Function to assess the efects of taxonomic uncertainty on permutational multivariate analysis of variance using distance matrices
</h2>

<h3>Description</h3>

<p>This function asses the effects of taxonomic uncertainty on the R2 coefficients and the p-values of a permutational multivariate analysis of variance using distance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adonis_pertables(formula = X ~ ., data, permutations = 5, method = "bray")
## S3 method for class 'adonis_pertables'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A typical model formula such as 'Y ~ A + B*C', but where 'Y' is a pertables object (i.e. a list of simulated community data matrices obtained with <code>pertables</code>; 'A', 'B', and 'C' may be factors or continuous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data frame from which 'A', 'B', and 'C' would be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>
<p>Number of replicate permutations used for the hypothesis tests (F tests) for each simulated community data matrices obtained with <code>pertables</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The name of any method used in 'vegdist' to calculate pairwise distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>adonis_pertables</code> object to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional graphical parameters passed to plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>adonis_pertables</code> returns an object of class<code>adonis_pertables</code>, basically a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>raw </code></td>
<td>
<p>An object of class <code>adonis</code>, i.e. the results of applying <code>mantel</code> to the original biological data table without the unidentified species. This includes p-values for each explanatory variable showing the probability of obtaining the same F statistic under different scenarios of taxonomic uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation </code></td>
<td>
<p>A list with the results of the simulation: <code>F</code>, i.e. a data.frame with all the simulated pseudo-F (columns) for each explanatory variable (rows); <code>R2</code>, i.e. a data.frame with all the simulated R2 coefficients (columns) for each explanatory variable (rows); <code>pvalue</code>, i.e. a data.frame with all the simulated p-values (columns) for each explanatory variable (rows); <code>R2.quant</code>, i.e. a data.frame with the summary of <code>R2</code> by quantiles; <code>p.quant</code>,, i.e. a data.frame with the summary of <code>pvalue</code> by quantiles.</p>
</td>
</tr>
</table>
<p>The objects of class <code>adonis_pertables</code> have  <code>print</code> and <code>plot</code> S3 methods for a simple access to results. See the examples. 
</p>


<h3>Author(s)</h3>

<p>Luis Cayuela and Marcelino de la Cruz
</p>


<h3>References</h3>

<p>Cayuela, L., De la Cruz, M. and Ruokolainen, K. (2011). A method to incorporate the effect of taxonomic uncertainty on multivariate analyses of ecological data. <em>Ecography</em>, 34: 94-102. <a href="http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x">http://dx.doi.org/10.1111/j.1600-0587.2009.05899.x</a>.   
</p>


<h3>See Also</h3>

<p><code>pertables</code>, <code>adonis</code></p>


<h3>Examples</h3>

<pre><code class="language-R"> 


data(Amazonia)
data(soils)

# Define a new index that includes the terms used in the \code{Amazonia} dataset to define
# undetermined taxa at different taxonomic levels

index.Amazon &lt;- c(paste("sp.", rep(1:20), sep=""), "Indet.", "indet.")

# Generate a pertables object (i.e. a list of biological data tables simulated from taxonomic
# uncertainty)
 ## Not run: 
Amazonia100 &lt;- pertables(Amazonia, index=index.Amazon, nsim=100)

# Assess the effects of taxonomic uncertainty on a PERMANOVA (i.e., adonis) test:

Amazonia.adonis &lt;- adonis_pertables(Amazonia100 ~ Ca + K + Mg + Na, data=soils)

Amazonia.adonis

plot(Amazonia.adonis)

## End(Not run)
# Fast example for Rcheck

Amazonia4.p2 &lt;- pertables.p2(Amazonia[1:50,], index=index.Amazon, nsim=4, ncl=2, iseed=4)
set.seed(2)
Amazonia.adonis &lt;- adonis_pertables(Amazonia4.p2  ~ Ca + K + Mg + Na, data=soils)

Amazonia.adonis

plot(Amazonia.adonis)

</code></pre>


</div>