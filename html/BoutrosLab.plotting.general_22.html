<div class="container">

<table style="width: 100%;"><tr>
<td>create.qqplot.comparison</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make a quantile-quantile plot of two samples</h2>

<h3>Description</h3>

<p>Takes two samples and creates a qq plot for comparing two distributions, possibly conditioned on other variables</p>


<h3>Usage</h3>

<pre><code class="language-R">create.qqplot.comparison(
	x,
	data = NULL,
	filename = NULL,
	groups = NULL,
	main = NULL,
	main.just = 'center',
	main.x = 0.5,
	main.y = 0.5,
	main.cex = 3,
	aspect = 'fill',
	prepanel = NULL,
	xlab.label = NULL,
	ylab.label = NULL,
	xlab.cex = 2,
	ylab.cex = 2,
	xlab.col = 'black',
	ylab.col = 'black',
	xlimits = NULL,
	ylimits = NULL,
	xat = TRUE,
	yat = TRUE,
	xaxis.lab = NA,
	yaxis.lab = NA,
	xaxis.cex = 1.5,
	yaxis.cex = 1.5,
	xaxis.fontface = 'bold',
	yaxis.fontface = 'bold',
	xaxis.log = FALSE,
	yaxis.log = FALSE,
	xaxis.rot = 0,
	yaxis.rot = 0,
	xaxis.col = 'black',
	yaxis.col = 'black',
	xaxis.tck = 1,
	yaxis.tck = 1,
	xlab.top.label = NULL,
	xlab.top.cex = 2,
	xlab.top.col = 'black',
	xlab.top.just = 'center',
	xlab.top.x = 0.5,
	xlab.top.y = 0,
	add.grid = FALSE,
	xgrid.at = xat,
	ygrid.at = yat,
	type = 'p',
	cex = 0.75,
	pch = 19,
	col = 'black',
	lwd = 1,
	lty = 1,
	axes.lwd = 2.25,
	key = list(text = list(lab = c(''))),
	legend = NULL,
	add.rectangle = FALSE,
	xleft.rectangle = NULL,
	ybottom.rectangle = NULL,
	xright.rectangle = NULL,
	ytop.rectangle = NULL,
	col.rectangle = 'transparent',
	alpha.rectangle = 1,
	top.padding = 3,
	bottom.padding = 0.7,
	left.padding = 0.5,
	right.padding = 0.1,
	height = 6,
	width = 6,
	size.units = 'in',
	resolution = 1600,
	enable.warnings = FALSE,
	description = 'Created with BoutrosLab.plotting.general',
	style = 'BoutrosLab',
	preload.default = 'custom',
	use.legacy.settings = FALSE,
	inside.legend.auto = FALSE
	);
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A formula or a list of two numeric vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data source if x is a formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Filename for tiff output, or if NULL returns the trellis object itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aspect</code></td>
<td>
<p>This argument controls the physical aspect ratio of the panels, defaults to “fill”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prepanel</code></td>
<td>
<p>A function that takes the same arguments as the “panel”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.grid</code></td>
<td>
<p>Default manner of drawing grid lines - for custom grids, use type = c('p','g') and set the xat, yat, xgrid.at, ygrid.at parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>The grouping variable in the data-frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The main plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.just</code></td>
<td>
<p>The justification of the main title for the plot, default is centered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.x</code></td>
<td>
<p>The x location of the main title, deault is 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.y</code></td>
<td>
<p>The y location of the main title, default is 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.label</code></td>
<td>
<p>The label for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.label</code></td>
<td>
<p>The label for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.cex</code></td>
<td>
<p>Size of the overall plot title, defaults to 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.cex</code></td>
<td>
<p>Size of x-axis label, defaults to 2.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.cex</code></td>
<td>
<p>Size of y-axis label, defaults to 2.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.col</code></td>
<td>
<p>Colour of the x-axis label, defaults to “black”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.col</code></td>
<td>
<p>Colour of the y-axis label, defaults to “black”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.top.label</code></td>
<td>
<p>The label for the top x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.top.cex</code></td>
<td>
<p>Size of top x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.top.col</code></td>
<td>
<p>Colour of the top x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.top.just</code></td>
<td>
<p>Justification of the top x-axis label, defaults to centered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.top.x</code></td>
<td>
<p>The x location of the top x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.top.y</code></td>
<td>
<p>The y location of the top y-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlimits</code></td>
<td>
<p>Two-element vector giving the x-axis limits, defaults to automatic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimits</code></td>
<td>
<p>Two-element vector giving the y-axis limits, defaults to automatic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xat</code></td>
<td>
<p>Vector listing where the x-axis labels should be drawn, defaults to automatic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yat</code></td>
<td>
<p>Vector listing where the y-axis labels should be drawn, defaults to automatic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xgrid.at</code></td>
<td>
<p>Vector listing where the x-axis grid lines should be drawn, defaults to xat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ygrid.at</code></td>
<td>
<p>Vector listing where the y-axis grid lines should be drawn, defaults to yat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.lab</code></td>
<td>
<p>Vector listing x-axis tick labels, defaults to automatic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.lab</code></td>
<td>
<p>Vector listing y-axis tick labels, defaults to automatic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.col</code></td>
<td>
<p>Colour of the x-axis tick labels, defaults to “black”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.col</code></td>
<td>
<p>Colour of the y-axis tick labels, defaults to “black”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.cex</code></td>
<td>
<p>Size of x-axis scales, defaults to 1.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.cex</code></td>
<td>
<p>Size of y-axis scales, defaults to 1.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.fontface</code></td>
<td>
<p>Fontface for the x-axis scales</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.fontface</code></td>
<td>
<p>Fontface for the y-axis scales</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.log</code></td>
<td>
<p>Logical indicating whether x-variable should be in logarithmic scale (and what base if numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.log</code></td>
<td>
<p>Logical indicating whether y-variable should be in logarithmic scale (and what base if numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.rot</code></td>
<td>
<p>Counterclockwise rotation of text in x-axis scales in degrees, defaults to 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.rot</code></td>
<td>
<p>Counterclockwise rotation of text in y-axis scales in degrees, defaults to 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.tck</code></td>
<td>
<p>Specifies the length of the tick marks for x-axis, defaults to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis.tck</code></td>
<td>
<p>Specifies the length of the tick marks for y-axis, defaults to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Plot type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Character expansion for plotting symbol</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plotting character</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Point/line colour</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Specifies line width, defaults to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Specifies line style, defaults to 1 (solid)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes.lwd</code></td>
<td>
<p>Thickness of width of axes lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>A list giving the key (legend). The default suppresses drawing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Add a legend to the plot.  Helpful for adding multiple keys and adding keys to the margins of the plot. See xyplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top.padding</code></td>
<td>
<p>A number giving the top padding in multiples of the lattice default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom.padding</code></td>
<td>
<p>A number giving the bottom padding in multiples of the lattice default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left.padding</code></td>
<td>
<p>A number giving the left padding in multiples of the lattice default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right.padding</code></td>
<td>
<p>A number giving the right padding in multiples of the lattice default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>Figure height, defaults to 6 inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Figure width, defaults to 6 inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.units</code></td>
<td>
<p>Figure units, defaults to inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>Figure resolution in dpi, defaults to 1600</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enable.warnings</code></td>
<td>
<p>Print warnings if set to TRUE, defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>
<p>Short description of image/plot; default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.rectangle</code></td>
<td>
<p>Allow a rectangle to be drawn, default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xleft.rectangle</code></td>
<td>
<p>Specifies the left x coordinate of the rectangle to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ybottom.rectangle</code></td>
<td>
<p>Specifies the bottom y coordinate of the rectangle to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xright.rectangle</code></td>
<td>
<p>Specifies the right x coordinate of the rectangle to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ytop.rectangle</code></td>
<td>
<p>Specifies the top y coordinate of the rectangle to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.rectangle</code></td>
<td>
<p>Specifies the colour to fill the rectangle's area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.rectangle</code></td>
<td>
<p>Specifies the colour bias of the rectangle to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>style</code></td>
<td>
<p>defaults to “BoutrosLab”, also accepts “Nature”, which changes parameters according to Nature formatting requirements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preload.default</code></td>
<td>
<p>ability to set multiple sets of diffrent defaults depending on publication needs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.legacy.settings</code></td>
<td>
<p>boolean to set wheter or not to use legacy mode settings (font)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inside.legend.auto</code></td>
<td>
<p>boolean specifying whether or not to use the automatic inside legend function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>filename</code> is <code>NULL</code> then returns the trellis object, otherwise creates a plot and returns a 0/1 success code.</p>


<h3>Author(s)</h3>

<p>Ying Wu</p>


<h3>See Also</h3>

<p><code>qq</code>, <code>lattice</code> or the Lattice book for an overview of the package.</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(12345);

create.qqplot.comparison(
    # filename = tempfile(pattern = 'QQcomparison_Simple', fileext = '.tiff'),
    x = list(rnorm(100), rnorm(100)),
    resolution = 50
    );

# Minimal Input
create.qqplot.comparison(
    # filename = tempfile(pattern = 'QQcomparison_Minimal_Input', fileext = '.tiff'),
    x = list(microarray[1:500,2], microarray[1:500,2]),
    main = 'Minimal input',
    description = 'QQplot comparison created by BoutrosLab.plotting.general',
    resolution = 50
    );

# Axes &amp; Labels
create.qqplot.comparison(
    # filename = tempfile(pattern = 'QQcomparison_Axes_Labels', fileext = '.tiff'),
    x = list(microarray[1:500,2], microarray[1:500,2]),
    main = 'Axes &amp; labels',
    # adding axes and labels
    xlab.label = 'Sample 1',
    ylab.label = 'Sample 2',
    xlab.cex = 1.5,
    ylab.cex = 1.5,
    # adding grid for good measure
    add.grid = TRUE,
    description = 'QQplot comparison created by BoutrosLab.plotting.general',
    resolution = 100
    );

# Formula input

# 'Formula' format of data
chr.locations &lt;- microarray$Chr[1:500];
chr.locations &lt;- replace(chr.locations, which(chr.locations == 1), 'Chromosome 1');
chr.locations &lt;- replace(chr.locations, which(chr.locations == 2), 'Chromosome 2');

qqplot.data &lt;- data.frame(
    sample = c(rep('Sample 1', 500), rep('Sample 2', 500)),
    value = c(microarray[1:500,1], microarray[1:500,2]),
    chr = chr.locations
    );


create.qqplot.comparison(
    # filename = tempfile(pattern = 'QQcomparison_Formula', fileext = '.tiff'),
    # Using a different input method
    x = sample ~ value,
    data = qqplot.data,
    main = 'Formula input',
    xlab.label = 'Sample 1',
    ylab.label = 'Sample 2',
    xaxis.lab = seq(0, 15, 5),
    yaxis.lab = seq(0, 15, 5),
    xlimits = c(0, 17),
    ylimits = c(0, 17),
    xlab.cex = 1.5,
    ylab.cex = 1.5,
    add.grid = TRUE,
    description = 'QQplot comparison created by BoutrosLab.plotting.general',
    resolution = 200
    );


# Groups &amp; Legend
create.qqplot.comparison(
 # filename = tempfile(pattern = 'QQcomparison_Groups_Legend', fileext = '.tiff'),
    x = sample ~ value,
    data = qqplot.data,
    # Using fake grouping for the sake of illustration
    groups = qqplot.data$chr,
    # Set colours to differente the gruops
    col = default.colours(3),
    # Setting different plotting characters
    pch = c(15, 16),
    main = 'Groups &amp; legend',
    xlab.label = 'Sample 1',
    ylab.label = 'Sample 2',
    xlab.cex = 1.5,
    ylab.cex = 1.5,
    add.grid = TRUE,
    # Adding legend to explain groups
    key = list(
        text = list(
            lab = c('1','2'),
            cex = 1.5,
            col = 'black'
            ),
        points = list(
            pch = c(15, 16),
            col = default.colours(2),
            cex = 1
            ),
        x = 0.04,
        y = 0.95,
        padding.text = 2
        ),
    description = 'QQplot comparison created by BoutrosLab.plotting.general',
    resolution = 200
    );

# Multiple qq plots
create.qqplot.comparison(
    # filename = tempfile(pattern = 'QQcomparison_Multiple', fileext = '.tiff'),
    x = sample ~ value | chr,
    data = qqplot.data,
    main = 'Multiple plots',
    xlab.label = 'Sample 1',
    ylab.label = 'Sample 2',
    xlab.cex = 1.5,
    ylab.cex = 1.5,
    add.grid = TRUE,
    description = 'QQplot comparison created by BoutrosLab.plotting.general',
    resolution = 200
    );

# Nature style
create.qqplot.comparison(
    # filename = tempfile(pattern = 'QQcomparison_Nature_style', fileext = '.tiff'),
    x = sample ~ value,
    data = qqplot.data,
    main = 'Nature style',
    xlab.cex = 1.5,
    ylab.cex = 1.5,
    add.grid = TRUE,

   # set style to Nature 
    style = 'Nature',
    
    # demonstrating how to italicize character variables
    ylab.label = expression(paste('italicized ', italic('a'))),
  
    # demonstrating how to create en-dashes
    xlab.label = expression(paste('en dashs: 1','\u2013', '10'^'\u2013', ''^3)),

    description = 'QQplot comparison created by BoutrosLab.plotting.general',
    resolution = 200
    );

</code></pre>


</div>