<div class="container">

<table style="width: 100%;"><tr>
<td>sam_JAGS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Markov Chain Monte Carlo for BAMLSS using JAGS
</h2>

<h3>Description</h3>

<p>This sampler function for BAMLSS is an interface to the JAGS library
using package <code>rjags</code>. The function basically interprets the
<code>bamlss.frame</code> into BUGS code, similar to the <code>jagam</code> function of
package <code>mgcv</code>. I.e., the function uses the random effects representation of
smooth terms, see the transformer function <code>randomize</code> to generate the BUGS code.
</p>
<p>Note that estimating BAMLSS with JAGS is not very efficient.
Also note that this function is more experimental and support is only provided for a small
number of <code>bamlss.family</code> objects.
</p>
<p>Function <code>BUGSeta()</code> therefore computes the code and data for one parameter of
the modeled distribution. Function <code>BUGSmodel()</code> then collects all parameter model code
and data, which can be send to JAGS.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Sampler functions:
sam_JAGS(x, y, family, start = NULL,
  tdir = NULL, n.chains = 1, n.adapt = 100,
  n.iter = 4000, thin = 2, burnin = 1000,
  seed = NULL, verbose = TRUE, set.inits = TRUE,
  save.all = FALSE, modules = NULL, ...)

JAGS(x, y, family, start = NULL,
  tdir = NULL, n.chains = 1, n.adapt = 100,
  n.iter = 4000, thin = 2, burnin = 1000,
  seed = NULL, verbose = TRUE, set.inits = TRUE,
  save.all = FALSE, modules = NULL, ...)

## Function to interpret an additive predictor into BUGS code:
BUGSeta(x, id = NULL, ...)

## Function to interpret the full BAMLSS:
BUGSmodel(x, family, is.stan = FALSE, reference = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For function <code>sam_JAGS()</code> and <code>BUGSmodel()</code> the <code>x</code> list, as returned from
function <code>bamlss.frame</code>, holding all model matrices and other information that is
used for fitting the model. For function <code>BUGSeta()</code> argument <code>x</code> is one element of
the <code>x</code> object, i.e., one parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The model response, as returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <span class="pkg">bamlss</span> family object, see <code>family.bamlss</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named numeric vector containing possible starting values, the names are based on
function <code>parameters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tdir</code></td>
<td>
<p>The path to the temporary directory that should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.chains</code></td>
<td>
<p>Specifies the number of sequential MCMC chains that should be run with JAGS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.adapt</code></td>
<td>
<p>Specifies the number of iterations that should be used as an initial adaptive phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Sets the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Defines the thinning parameter for MCMC simulation. E.g., <code>thin = 10</code> means,
that only every 10th sampled parameter will be stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Sets the burn-in phase of the sampler, i.e., the number of starting samples that
should be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Sets the seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print information during runtime of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.inits</code></td>
<td>
<p>Should initial values of BAMLSS <code>parameters</code> be provided to JAGS,
if available. Set in argument <code>start</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.all</code></td>
<td>
<p>Should all JAGS files be saved in <code>tdir</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modules</code></td>
<td>
<p>Specify additional modules that should be loaded, see function <code>load.module</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Character, the current parameter name for which the BUGS code should be produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.stan</code></td>
<td>
<p>Should the BUGS code be translated to STAN code. Note that this is only experimental.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>A <code>character</code> specifying a reference category, e.g., when
fitting a multinomial model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function <code>sam_JAGS()</code> returns samples of parameters. The samples are provided as a <code>mcmc</code>
matrix. If <code>n.chains &gt; 1</code>, the samples are provided as a <code>mcmc.list</code>.
</p>
<p>Function <code>BUGSeta()</code> returns the BUGS model code and preprocessed data for one
additive predictor. Function <code>BUGSmodel()</code> then combines all single BUGS code chunks and
the data and creates the final BUGS model code that can be send to JAGS.
</p>


<h3>Note</h3>

<p>Note that for setting up a new family object to be used with <code>sam_JAGS()</code> additional
information needs to be supplied. The extra information must be placed within the
family object in an element named <code>"bugs"</code>. The following entries should be supplied
within the <code>..$bugs</code> list:
</p>

<ul>
<li> <p><code>"dist"</code>. The name of the distribution in BUGS/JAGS model language.
</p>
</li>
<li> <p><code>"eta"</code>. The function that computes the BUGS code for one structured additive predictor.
Function <code>BUGSeta()</code> is used per default.
</p>
</li>
<li> <p><code>"model"</code>. The function that merges all single predictor BUGS model code and data.
The default function is <code>BUGSmodel()</code>.
</p>
</li>
<li> <p><code>"reparam"</code>. A named vector of character strings that specify a re-parametrization.
</p>
</li>
</ul>
<p>See also the example code of <code>family.bamlss</code>.
</p>


<h3>See Also</h3>

<p><code>bamlss</code>, <code>bamlss.frame</code>,
<code>bamlss.engine.setup</code>, <code>set.starting.values</code>, <code>bfit</code>,
<code>GMCMC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: ## Simulated data example illustrating
## how to call the sampler function.
## This is done internally within
## the setup of function bamlss().
d &lt;- GAMart()
f &lt;- num ~ s(x1, bs = "ps")
bf &lt;- bamlss.frame(f, data = d, family = "gaussian")

## First, find starting values with optimizer.
opt &lt;- with(bf, opt_bfit(x, y, family))

## Sample with JAGS.
if(require("rjags")) {
  samps &lt;- with(bf, sam_JAGS(x, y, family, start = opt$parameters))
  plot(samps)

  b &lt;- bamlss(f, data = d, family = "gaussian", sampler = sam_JAGS)
  plot(b)
}

## End(Not run)
</code></pre>


</div>