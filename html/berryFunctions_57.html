<div class="container">

<table style="width: 100%;"><tr>
<td>linReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>linear regression with plotting</h2>

<h3>Description</h3>

<p>uses <code>lm</code>; plots data if add=FALSE, draws the regression line
with <code>abline</code> and writes the formula with <code>legend</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">linReg(
  x,
  y = NULL,
  data = NULL,
  add = FALSE,
  digits = 2,
  quiet = FALSE,
  pch = 16,
  col = "black",
  colline = "red",
  colband = addAlpha(colline),
  level = 0.95,
  plotrange = par("usr")[1:2],
  lwd = 1,
  xlab = deparse(substitute(x)),
  ylab = deparse(substitute(y)),
  main = "linear regression",
  pos1 = "top",
  pos2 = NULL,
  inset = 0,
  legargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric or formula (see examples). Vector with values of explanatory variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric. Vector with values of dependent variable. DEFAULT: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataframe. If x is a formula, the according columns from data are used as x and y. DEFAULT: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical. If TRUE, line and text are added to the existing graphic. DEFAULT: FALSE (plots datapoints first and then the line.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Numeric vector of length <code class="reqn">\ge 1</code>. Specifies number of digits a,b,r,e are rounded to
in the formula "y=a*x+b \n R^2=r \n RMSE=e", respectively.
If a value is negative, the complete respective entry is left away.
If values are not specified, they are set equal to the first. DEFAULT: 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Silence NA-removal warnings in <code>rmse</code>? DEFAULT: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Point Character of datapoints, see <code>par</code>. DEFAULT: 16</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color of points. DEFAULT: "black"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colline</code></td>
<td>
<p>Color of the regression line, see <code>par</code>. DEFAULT: "red"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colband</code></td>
<td>
<p>Color of the confidence region band. DEFAULT: addAlpha(col)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence level, see <code>predict.lm</code>. DEFAULT: 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotrange</code></td>
<td>
<p>x range for which regression line and uncertainty band should
be plotted. Is passed to <code>seqR</code> and can hence be a vector.
DEFAULT: par("usr")[1:2]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Numeric. Linewidth, see <code>par</code>. DEFAULT: 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Axis label if add=FALSE. DEFAULT: deparse(substitute(x))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Axis label if add=FALSE. DEFAULT: deparse(substitute(y))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title if add=FALSE. Changed (if not specified) for x=formula with data. DEFAULT: "linear regression"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos1</code></td>
<td>
<p><code>xy.coords</code>-acceptable position of the formula. DEFAULT: "top"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos2</code></td>
<td>
<p>For numerical coordinates, this is the y-position. DEFAULT: NULL, as in <code>legend</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inset</code></td>
<td>
<p>Numeric vector of length <code class="reqn">\le 2</code>. inset distance(s) from the margins as a fraction of the plot region when formula legend is placed by keyword. DEFAULT: 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legargs</code></td>
<td>
<p>list of arguments passed to legend, like list(cex=0.8, xpd=TRUE, bg="white"), ...
xpd specifies whether formula can be written only inside the plot region (when FALSE)
or inside the figure region including mar (when TRUE) or in the entire device region including oma (when NA). DEFAULT: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>plot</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>None, used for plotting and drawing.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2011-2012, 2015
</p>


<h3>See Also</h3>

<p><code>lm</code>, <code>mReg</code>, <code>expReg</code>, <code>legend</code>, <code>par</code>, <code>abline</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
a &lt;- 1:30
b &lt;- a/2.345+rnorm(30,0,3)

linReg(a,b)
linReg(a,b, ylab="Hallo", pch=1, colline=3, main="Regression by Berry")
linReg(a, b, pos1=15, pos2=0) # position of topleft corner of legend
linReg(a, b, pos1=NA) # to suppress legend
linReg(a, b, plotrange=5:20) # only for plotting, all data points are used!
linReg(a,b, digits=c(2,3,2,-1) ) # Do not write RMSE into legend

# Formula specification:
linReg(b~a)
linReg(Fertility~Education, data=swiss, col="blue", colline="green")
# col is for points, colline + colband for regression line + conf.int.

# For more flexibility with the datapoints, plot first, then use linReg with add=TRUE:
plot(a,b, xlim=c(-5,45))
linReg(a, b, pos1="bottomright", add=TRUE, inset=.1) # inset: distance from plot border
linReg(a, b, digits=c(7,4,3), add=TRUE, colline=3, lty=2, lwd=4, level=0.8)
linReg(a, b, pos1="topleft", inset=c(-0.1, 0.3), legargs=list(xpd=TRUE), add=TRUE)

</code></pre>


</div>