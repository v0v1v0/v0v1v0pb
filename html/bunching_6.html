<div class="container">

<table style="width: 100%;"><tr>
<td>do_bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap</h2>

<h3>Description</h3>

<p>Estimate bunching on bootstrapped samples, using residual-based bootstrapping with replacement.
</p>


<h3>Usage</h3>

<pre><code class="language-R">do_bootstrap(
  zstar,
  binwidth,
  firstpass_prep,
  residuals,
  n_boot = 100,
  correct = TRUE,
  correct_iter_max = 200,
  notch = FALSE,
  zD_bin = NA,
  seed = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zstar</code></td>
<td>
<p>a numeric value for the the bunching point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>a numeric value for the width of each bin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstpass_prep</code></td>
<td>
<p>(binned) data that includes all variables necessary for fitting the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>residuals from (first pass) fitted bunching model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_boot</code></td>
<td>
<p>number of bootstrapped iterations. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>implements correction for integration constraint. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct_iter_max</code></td>
<td>
<p>maximum iterations for integration constraint correction. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notch</code></td>
<td>
<p>whether analysis is for a kink or notch. Default is FALSE (kink).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zD_bin</code></td>
<td>
<p>the bin marking the upper end of the dominated region (notch case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a numeric value for bootstrap seed (random re-sampling of residuals). Default is NA.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>do_bootstrap</code> returns a list with the following bootstrapped estimates:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>b_vector</code></td>
<td>
<p>A vector with the bootstrapped normalized excess mass estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_sd</code></td>
<td>
<p>The standard deviation of the bootstrapped b_vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_vector</code></td>
<td>
<p>A vector with the bootstrapped excess mass estimates (not normalized).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_sd</code></td>
<td>
<p>The standard deviation of the bootstrapped B_vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal_buncher_vector</code></td>
<td>
<p>A vector with the bootstrapped estimates of the location (z value) of the marginal buncher.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal_buncher_sd</code></td>
<td>
<p>The standard deviation of the bootstrapped marginal_buncher_vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_vector</code></td>
<td>
<p>A vector with the bootstrapped estimates of the fraction of bunchers in the dominated region (only in notch case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_vector_sd</code></td>
<td>
<p>The standard deviation of the bootstrapped alpha_vector.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>bunchit</code>, <code>prep_data_for_fit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bunching_data)
binned_data &lt;- bin_data(z_vector = bunching_data$kink, zstar = 10000,
                        binwidth = 50, bins_l = 20, bins_r = 20)
prepped_data &lt;- prep_data_for_fit(binned_data, zstar = 10000, binwidth = 50,
                                  bins_l = 20, bins_r = 20, poly = 4)
firstpass &lt;- fit_bunching(prepped_data$data_binned,
                          prepped_data$model_formula,
                          binwidth = 50)
residuals_for_boot &lt;- fit_bunching(prepped_data$data_binned,
                                   prepped_data$model_formula,
                                   binwidth = 50)$residuals
boot_results &lt;- do_bootstrap(zstar = 10000, binwidth = 50,
                             firstpass_prep = prepped_data,
                             residuals = residuals_for_boot,
                             seed = 1)
boot_results$b_sd
</code></pre>


</div>