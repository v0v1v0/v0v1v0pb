<div class="container">

<table style="width: 100%;"><tr>
<td>bdsvd.structure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data Matrix Structure According to the Detected Block Structure.</h2>

<h3>Description</h3>

<p>Either sorts the data matrix <code class="reqn">X</code> according to the detected block structure <code class="reqn">X_1 , ... , X_b</code>, ordered by the number
of variables that the blocks contain. Or returns the detected submatrices each individually in a list object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bdsvd.structure(X, block.structure, output = "matrix", block.order)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data matrix of dimension <code class="reqn">n x p</code> with possibly <code class="reqn">p &gt;&gt; n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.structure</code></td>
<td>
<p>Output of <code>bdsvd()</code> or <code>single.bdsvd()</code> which identified the block structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Should the output be the data matrix ordered according to the blocks (<code>"matrix"</code>), or
a list containing the submatrices (<code>"submatrices"</code>). Default is <code>"matrix"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.order</code></td>
<td>
<p>A vector that contains the order of the blocks detected by <code>bdsvd()</code> or <code>single.bdsvd()</code>.
The vector must contain the index of each blocks exactly once. Default is <code>1:b</code> where <code>b</code> is the total number of blocks.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Either the data matrix <code>X</code> with columns sorted according to the detected blocks, or a list containing the detected
submatrices.
</p>


<h3>References</h3>

<p><cite>Bauer, J.O. (202Xa). High-dimensional block diagonal covariance structure detection using singular vectors.</cite>
</p>


<h3>See Also</h3>

<p>bdsvd, single.bdsvd
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Toying with the illustrative example from Bauer (202Xa).


p &lt;- 150 #Number of variables. In Bauer (202Xa), p = 3000.
n &lt;- 500 #Number of observations
b &lt;- 3   #Number of blocks
design &lt;- "c"

#Simulate data matrix X
set.seed(1)
Sigma &lt;- bdsvd.cov.sim(p = p, b = b, design = design)
X &lt;- mvtnorm::rmvnorm(n, mean=rep(0, p), sigma=Sigma)
colnames(X) &lt;- seq_len(p)

#Compute iterative BD-SVD
bdsvd.obj &lt;- bdsvd(X, standardize = FALSE)

#Obtain the data matrix X, sorted by the detected blocks
colnames(bdsvd.structure(X, bdsvd.obj, output = "matrix") )
colnames(bdsvd.structure(X, bdsvd.obj, output = "matrix", block.order = c(2,1,3)) )

#Obtain the detected submatrices X_1, X_2, and X_3
colnames(bdsvd.structure(X, bdsvd.obj, output = "submatrices")[[1]] )
colnames(bdsvd.structure(X, bdsvd.obj, output = "submatrices")[[2]] )
colnames(bdsvd.structure(X, bdsvd.obj, output = "submatrices")[[3]] )

</code></pre>


</div>