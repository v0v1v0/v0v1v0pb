<div class="container">

<table style="width: 100%;"><tr>
<td>model.thresh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating change-points in the piecewise-constant or piecewise-linear mean of a noisy data sequence via thresholding</h2>

<h3>Description</h3>

<p>This function estimates the number and locations of change-points in the piecewise-constant or piecewise-linear mean of a noisy data sequence via thresholding.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model.thresh(cptpath.object, sigma = NULL, th.const = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cptpath.object</code></td>
<td>
<p>A solution-path object, returned by a <code>sol.[name]</code> routine. The <code>cptpath.object$type</code> variable decides the model type: piecewise-constant (<code>type == "const"</code>),
piecewise-linear and continuous (<code>type == "lin.cont"</code>) or piecewise-linear and discontinuous (<code>type == "lin.discont"</code>). In the piecewise-linear model (whether continuous or not), the output of <code>sol.idetect_seq</code> or <code>sol.not</code> should be supplied as
<code>cptpath.object</code>. Note that the field <code>cptpath.object$x</code> contains the input data sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>An estimate of the standard deviation of the noise in the data <code>cptpath.object$x</code>. Can be a functional of <code>cptpath.object$x</code> or a specific value if known.
The default in the piecewise-constant model is the Median Absolute Deviation of the vector <code>diff(cptpath.object$x)/sqrt(2)</code>, tuned to the Gaussian distribution.
In the piecewise-linear models, <code>diff(cptpath.object$x, differences = 2)/sqrt(6)</code> is used by default.
Note that <code>model.thresh</code> works particularly well when the noise is i.i.d. Gaussian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.const</code></td>
<td>
<p>A positive real number used to define the threshold for the detection process. The default used in the piecewise-constant model is 1.15, while in the piecewise-linear model, the value is taken equal to 1.4.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An S3 object of class <code>cptmodel</code>, which contains the following fields: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>solution.path</code></td>
<td>
<p>The solution path method used to obtain <code>cptpath.object</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The model type used, inherited from the given <code>cptpath.object</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.selection</code></td>
<td>
<p>The model selection method used to return the final change-point estimators object, here its value is <code>"thresh"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.of.cpt</code></td>
<td>
<p>The number of estimated change-points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpts</code></td>
<td>
<p>The locations of estimated change-points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>An estimate of the mean of the vector <code>cptpath.object$x</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>sol.idetect</code>, <code>sol.idetect_seq</code>, <code>sol.not</code>, <code>sol.tguh</code>, <code>sol.wbs</code>, <code>sol.wbs2</code>, <code>breakfast</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">f &lt;- rep(rep(c(0, 1), each = 50), 10)
x &lt;- f + rnorm(length(f))
model.thresh(sol.idetect_seq(x))
</code></pre>


</div>