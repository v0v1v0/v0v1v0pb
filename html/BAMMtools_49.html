<div class="container">

<table style="width: 100%;"><tr>
<td>stepBF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify the optimal number of shifts using Bayes factors</h2>

<h3>Description</h3>

<p>stepBF is a function to determine the overall best fitting number of shifts 
using Bayes factor evidence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepBF(BFmat, step.size = 20, expectedNumberOfShifts = 1, inputType = "matrix")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BFmat</code></td>
<td>
<p>square Bayes factor matrix or a named vector of posterior probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.size</code></td>
<td>
<p>how much Bayes factor support is required to accept a more complex model, see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedNumberOfShifts</code></td>
<td>
<p>expected number of shifts under the prior (only needed for <code>inputType = 'postProb'</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputType</code></td>
<td>
<p>describes the input: <code>'matrix'</code> or <code>'postProb'</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>stepBF takes either a square Bayes factor matrix (such as output by <code>computeBayesFactors</code>) or a named 
vector of posterior probabilities. If posterior probabilities are supplied, the model prior
(<code>expectedNumberOfShifts</code>) must also be provided.
If the input is a Bayes factor matrix, specify <code>inputType = 'matrix'</code>, otherwise if the input is
a named vector of posterior probabilities, specify <code>inputType = 'postProb'</code>.
</p>
<p>The <code>step.size</code> argument is how much Bayes factor support is needed to accept a more complex model. 
By default, this value is 1, so any more complex model that has a better Bayes factor than the previous model 
will be accepted. Increasing the step size greatly reduces the Type I error at the cost of inflating Type II 
error. So, with increasing step.size, you will infer fewer shifts.
</p>


<h3>Value</h3>

<p>a list of 3 items: the number of shifts for the best model, the number of shifts for the second best model,
and the Bayes factor support for the best model over the second best.
</p>


<h3>Author(s)</h3>

<p>Jonathan Mitchell
</p>


<h3>References</h3>

<p><a href="http://bamm-project.org/">http://bamm-project.org/</a>
</p>


<h3>See Also</h3>

<p><code>computeBayesFactors</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mcmc.whales)
# remove 10% burnin
mcmc.whales &lt;- mcmc.whales[floor(0.1 * nrow(mcmc.whales)):nrow(mcmc.whales), ]
# from a square matrix of Bayes factor values (inputType = 'matrix')
bfmat &lt;- computeBayesFactors(mcmc.whales, expectedNumberOfShifts = 1, burnin = 0)
stepBF(bfmat, step.size = 1, inputType = 'matrix')
# or from a vector of posterior probabilities (inputType = 'postProb')
postProb &lt;- table(mcmc.whales$N_shifts) / nrow(mcmc.whales)
stepBF(postProb, step.size = 1, inputType = 'postProb')

</code></pre>


</div>