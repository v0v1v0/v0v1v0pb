<div class="container">

<table style="width: 100%;"><tr>
<td>rmnpGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler for Multinomial Probit</h2>

<h3>Description</h3>

<p><code>rmnpGibbs</code> implements the McCulloch/Rossi Gibbs Sampler for the multinomial probit model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmnpGibbs(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(y, X, p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(betabar, A, nu, V)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint, beta0, sigma0)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">w_i = X_i\beta + e</code> with <code class="reqn">e</code> <code class="reqn">\sim</code> <code class="reqn">N(0, \Sigma)</code>. 
Note: <code class="reqn">w_i</code> and <code class="reqn">e</code> are <code class="reqn">(p-1) x 1</code>.<br><code class="reqn">y_i = j</code> if <code class="reqn">w_{ij} &gt; max(0,w_{i,-j})</code> for <code class="reqn">j=1, \ldots, p-1</code> and 
where <code class="reqn">w_{i,-j}</code> means elements of <code class="reqn">w_i</code> other than the <code class="reqn">j</code>th. <br><code class="reqn">y_i = p</code>,  if all <code class="reqn">w_i &lt; 0</code>
</p>
<p><code class="reqn">\beta</code> is not identified. However, <code class="reqn">\beta</code>/sqrt(<code class="reqn">\sigma_{11}</code>) and 
<code class="reqn">\Sigma</code>/<code class="reqn">\sigma_{11}</code> are identified.  See reference or example below for details.
</p>
<p><code class="reqn">\beta</code>  <code class="reqn">\sim</code> <code class="reqn">N(betabar,A^{-1})</code> <br><code class="reqn">\Sigma</code> <code class="reqn">\sim</code> <code class="reqn">IW(nu,V)</code> <br></p>



<h4>Argument Details</h4>

<p><em><code>Data  = list(y, X, p)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>y:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n x 1</code> vector of multinomial outcomes (1, ..., p) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>X:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n*(p-1) x k</code> design matrix. To make <code class="reqn">X</code> matrix use <code>createX</code> with <code>DIFF=TRUE</code> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>p:       </code> </td>
<td style="text-align: left;"> number of alternatives
    </td>
</tr>
</table>
<p><em><code>Prior = list(betabar, A, nu, V)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>betabar: </code> </td>
<td style="text-align: left;"> <code class="reqn">k x 1</code> prior mean (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>A:       </code> </td>
<td style="text-align: left;"> <code class="reqn">k x k</code> prior precision matrix (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nu:      </code> </td>
<td style="text-align: left;"> d.f. parameter for Inverted Wishart prior (def: (p-1)+3) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>V:       </code> </td>
<td style="text-align: left;"> PDS location parameter for Inverted Wishart prior (def: nu*I) 
    </td>
</tr>
</table>
<p><em><code>Mcmc  = list(R, keep, nprint, beta0, sigma0)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:       </code> </td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:    </code> </td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint:  </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>beta0:   </code> </td>
<td style="text-align: left;"> initial value for beta (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sigma0:  </code> </td>
<td style="text-align: left;"> initial value for sigma (def: I)
    </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betadraw  </code></td>
<td>
<p><code class="reqn">R/keep x k</code> matrix of betadraws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmadraw </code></td>
<td>
<p><code class="reqn">R/keep x (p-1)*(p-1)</code> matrix of sigma draws â€“ each row is the vector form of sigma</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p>For further discussion, see Chapter 4, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>See Also</h3>

 <p><code>rmvpGibbs</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=2000} else {R=10}
set.seed(66)

simmnp = function(X, p, n, beta, sigma) {
  indmax = function(x) {which(max(x)==x)}
  Xbeta = X%*%beta
  w = as.vector(crossprod(chol(sigma),matrix(rnorm((p-1)*n),ncol=n))) + Xbeta
  w = matrix(w, ncol=(p-1), byrow=TRUE)
  maxw = apply(w, 1, max)
  y = apply(w, 1, indmax)
  y = ifelse(maxw &lt; 0, p, y)
  return(list(y=y, X=X, beta=beta, sigma=sigma))
}

p = 3
n = 500
beta = c(-1,1,1,2)
Sigma = matrix(c(1, 0.5, 0.5, 1), ncol=2)
k = length(beta)
X1 = matrix(runif(n*p,min=0,max=2),ncol=p)
X2 = matrix(runif(n*p,min=0,max=2),ncol=p)
X = createX(p, na=2, nd=NULL, Xa=cbind(X1,X2), Xd=NULL, DIFF=TRUE, base=p)

simout = simmnp(X,p,500,beta,Sigma)

Data1 = list(p=p, y=simout$y, X=simout$X)
Mcmc1 = list(R=R, keep=1)

out = rmnpGibbs(Data=Data1, Mcmc=Mcmc1)

cat(" Summary of Betadraws ", fill=TRUE)
betatilde = out$betadraw / sqrt(out$sigmadraw[,1])
attributes(betatilde)$class = "bayesm.mat"
summary(betatilde, tvalues=beta)

cat(" Summary of Sigmadraws ", fill=TRUE)
sigmadraw = out$sigmadraw / out$sigmadraw[,1]
attributes(sigmadraw)$class = "bayesm.var"
summary(sigmadraw, tvalues=as.vector(Sigma[upper.tri(Sigma,diag=TRUE)]))

## plotting examples
if(0){plot(betatilde,tvalues=beta)}
</code></pre>


</div>