<div class="container">

<table style="width: 100%;"><tr>
<td>MasterPool.Array.Measures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Operating characteristics for array testing with master pooling</h2>

<h3>Description</h3>

<p>Calculate the expected number of tests and accuracy measures
for each individual using array testing with master pooling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MasterPool.Array.Measures(results, n, pmat, Se, Sp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>an object containing results (expected number of tests and 
accuracy measures) from <code>Array.Measures</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>size of a row/column in the square array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmat</code></td>
<td>
<p>matrix of individual risk probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Se</code></td>
<td>
<p>the sensitivity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sp</code></td>
<td>
<p>the specificity of the diagnostic test.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function assumes that the array is square (i.e., the row
and column size are equal) and utilizes the equations from Kim et al. 
(2007) for square array testing with master pooling. This function 
calculates the operating characteristics for array testing with master 
pooling. Operating characteristics calculated are expected number of tests, 
pooling sensitivity, pooling specificity, pooling positive predictive value, 
and pooling negative predictive value for each individual.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ET</code></td>
<td>
<p>the expected number of tests for the array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSe</code></td>
<td>
<p>a matrix containing each individual's pooling sensitivity, 
corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSp</code></td>
<td>
<p>a matrix containing each individual's pooling specificity, 
corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPV</code></td>
<td>
<p>a matrix containing each individual's pooling positive predictive
value, corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NPV</code></td>
<td>
<p>a matrix containing each individual's pooling negative predictive
value, corresponding to the input matrix of individual probabilities.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function returns the pooling positive and negative
predictive values for all individuals in the array even though these
measures are diagnostic specific; i.e., PPV (NPV) should only be considered
for those individuals who have tested positive (negative).
</p>


<h3>Author(s)</h3>

<p>Brianna D. Hitt
</p>


<h3>References</h3>

<p>Kim, H., Hudgens, M., Dreyfuss, J., Westreich, D., Pilcher, C. (2007).
“Comparison of group testing algorithms for case identification in the presence of test error.”
<em>Biometrics</em>, <b>63</b>(4), 1152–1163.
ISSN 0006341X, doi: <a href="https://doi.org/10.1111/j.1541-0420.2007.00817.x">10.1111/j.1541-0420.2007.00817.x</a>.
</p>


<h3>See Also</h3>

<p><code>Array.Measures</code> for calculating operating 
characteristics under array testing without master pooling, 
<code>hierarchical.desc2</code> for three-stage hierarchical and 
non-informative two-stage hierarchical testing, and 
<code>inf.dorf.measures</code> for informative two-stage hierarchical 
testing.
</p>
<p>Other Operating characteristic functions: <code>Array.Measures</code>,
<code>hierarchical.desc2</code>,
<code>inf.dorf.measures</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the operating characteristics for 
#   non-informative array testing with master
#   pooling, with a 6x6 array and an overall 
#   disease risk of p = 0.10.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
p.mat &lt;- matrix(data=0.10, ncol=6, nrow=6)
results &lt;- Array.Measures(p=p.mat, se=0.90, sp=0.90)
MasterPool.Array.Measures(results=results, n=36, 
pmat=p.mat, Se=0.90, Sp=0.90)
</code></pre>


</div>