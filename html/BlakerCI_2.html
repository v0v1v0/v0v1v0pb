<div class="container">

<table style="width: 100%;"><tr>
<td>binom.blaker.acc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Blaker's binomial acceptability function, optionally
unimodalized.
</h2>

<h3>Description</h3>

<p>Calculates values of the acceptability function for the binomial
distribution (see function <code>acceptbin</code> in Blaker (2000))
in a sequence of points (for, e.g., plotting purposes).
The acceptability function may optionally be 
“unimodalized”, i.e. replaced with the smallest
greater or equal unimodal function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.blaker.acc(x, n, p, type = c("orig", "unimod"),
      acc.tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>number of successes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of trials.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector (length 1 allowed) of hypothesized binomial parameters
(between 0 and 1).
In case of more than one point, an increasing sequence required. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>for <code>type = "orig"</code>, original acceptability function
calculated.<br>
For <code>type = "unimod"</code>, smallest unimodal function
greater or equal to the acceptability function calculated
instead. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc.tol</code></td>
<td>

<p>numerical tolerance (relevant only for <code>type = "unimod"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to 
<code>binom.blaker.acc.single.p</code>;
in fact, just <code>maxiter</code> (see <code>BlakerCI-internal</code>). 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>type = "orig"</code>, essentially the same is calculated
as – for single points – by <code>acceptbin</code> function
from Blaker (2000).
</p>
<p>Single values of the “unimodalized” acceptability function 
(for <code>type = "unimod"</code>) are computed by an iterative
numerical algorithm implemented in internal function
<br><code>binom.blaker.acc.single.p</code>.
The function cited is called just once in each of the intervals
where the acceptability function is continuous
(namely in the leftmost one of those points of <code>p</code> 
that fall into the interval when dealing with points
below <code>x/n</code>, and the rightmost one when above 
<code>x/n</code>). The rest is done by function
<code>cummax</code>.  
This is considerably faster than calling 
<code>binom.blaker.acc.single.p</code>
for every point of <code>p</code>.
Note that applying <code>cummax</code> directly to
a vector of unmodified acceptability values
is even faster and provides a unimodal output;
it may, nevertheless, lack accuracy (see Examples). 
</p>


<h3>Value</h3>

<p>Vector of acceptability values (with or without unimodalization)
in points of <code>p</code>.
</p>


<h3>Note</h3>


<p>Inspired by M.P. Fay (2010), mentioning
“unavoidable inconsistencies” between tests with non-unimodal
acceptability functions and confidence intervals derived from them.
When the acceptability functions are unimodalized
and the test modified accordingly (i.e. p-values slightly increased
in some cases), a perfectly matching test-CI pair is obtained. 
</p>


<h3>Author(s)</h3>

<p>Jan Klaschka <a href="mailto:klaschka@cs.cas.cz">klaschka@cs.cas.cz</a>
</p>


<h3>References</h3>

<p>Blaker, H. (2000) Confidence curves and improved exact confidence 
intervals for discrete distributions.
Canadian Journal of Statistics 28: 783-798.<br>
(Corrigenda: Canadian Journal of Statistics 29: 681.)
</p>




<p>Fay, M.P. (2010). Two-sided Exact Tests and Matching Confidence 
Intervals for Discrete Data. 
R Journal 2(1): 53-58.
</p>







<h3>Examples</h3>

<pre><code class="language-R">p &lt;- seq(0,1,length=1001)
acc &lt;- binom.blaker.acc(3,10,p)
acc1 &lt;- binom.blaker.acc(3,10,p,type="unimod")
## The two functions look the same at first glance.
plot(p,acc,type="l")
lines(p,acc1,col="red")
legend(x=.7,y=.8,c("orig","unimod"),col=c("black","red"),lwd=1)

## There is, nevertheless, a difference.
plot(p,acc1-acc,type="l")

## Focussing on the difference about p=0.4:
p &lt;- seq(.395,.405,length=1001)
acc &lt;- binom.blaker.acc(3,10,p)
acc1 &lt;- binom.blaker.acc(3,10,p,type="unimod")
plot(p,acc,type="l",ylim=c(.749,.7495))
lines(p,acc1,col="red")
legend(x=.402,y=.7494,c("orig","unimod"),col=c("black","red"),lwd=1)

## Difference between type="unimod" and mere applying
## cummax to values obtained via type="orig":
p &lt;- seq(0,1,length=1001)
x &lt;- 59
n &lt;- 355
## Upper confidence limit (at 0.95 level) is slightly above 0.209:
binom.blaker.limits(x,n) ## [1] 0.1300807 0.2090809
## Unmodified acceptability value fall below 0.05 at p = .209
## left to the limit (so that the null hypothesis p = .209
## would be rejected despite the fact that p lies within
## the confidence interval):
acc &lt;- binom.blaker.acc(59,355,p)
rbind(p,acc)[,207:211]
##           [,1]       [,2]       [,3]       [,4]       [,5]
## p   0.20600000 0.20700000 0.20800000 0.20900000 0.21000000
## acc 0.06606867 0.05759836 0.05014189 0.04999082 0.04330283
##
## Modified acceptability is above 0.05 at p = 0.05 (so that
## hypothesis p = 0.05 is not rejected by the modified test):
acc1 &lt;- binom.blaker.acc(59,355,p,type="unimod")
rbind(p,acc1)[,207:211]
##            [,1]       [,2]       [,3]       [,4]       [,5]
## p    0.20600000 0.20700000 0.20800000 0.20900000 0.21000000
## acc1 0.06608755 0.05759836 0.05014189 0.05000009 0.04331409
##
## Applying cummax to unmodified acceptabilities guarantees unimodality 
## but lacks accuracy, leaving the value at p = 0.209 below 0.05:
m &lt;- max(which(p &lt;= 59/355))
acc2 &lt;- acc
acc2[1:m] &lt;- cummax(acc2[1:m])
acc2[1001:(m+1)] &lt;- cummax(acc2[1001:(m+1)])
rbind(p,acc2)[,207:211]
##            [,1]       [,2]       [,3]       [,4]       [,5]
## p    0.20600000 0.20700000 0.20800000 0.20900000 0.21000000
## acc2 0.06606867 0.05759836 0.05014189 0.04999082 0.04330283

</code></pre>


</div>