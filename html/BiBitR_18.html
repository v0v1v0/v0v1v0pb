<div class="container">

<table style="width: 100%;"><tr>
<td>UpdateBiclust_RowNoise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update a Biclust or BiBitWorkflow Object with a new Noise Level</h2>

<h3>Description</h3>

<p>Apply a new noise level on a Biclust object result or BiBitWorkflow result. See Details on how both objects are affected.
</p>


<h3>Usage</h3>

<pre><code class="language-R">UpdateBiclust_RowNoise(result, matrix, noise = 0.1, noise_select = 0,
  removeBC = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>A Biclust or BiBitWorkflow Object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>Accompanying binary data matrix which was used to obtain <code>result</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>The new noise level which should be used in the rows of the biclusters. (default=<code>0.1</code>, namely allow 10% noise.).
</p>

<ul>
<li> <p><code>noise=0</code>: No noise allowed.
</p>
</li>
<li> <p><code>0&lt;noise&lt;1</code>: The <code>noise</code> parameter will be a noise percentage. The number of allowed 0's in a row in the bicluster will depend on the column size of the bicluster.
More specifically <code>zeros_allowed = ceiling(noise * columnsize)</code>. For example for <code>noise=0.10</code> and a bicluster column size of <code>5</code>, the number of allowed 0's would be <code>1</code>.
</p>
</li>
<li> <p><code>noise&gt;=1</code>: The <code>noise</code> parameter will be the number of allowed 0's in a row in the bicluster independent from the column size of the bicluster. In this noise option, the noise parameter should be an integer.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_select</code></td>
<td>
<p>Should the allowed noise level be automatically selected for each pattern? (Using ad hoc method to find the elbow/kink in the Noise Scree plots)
</p>

<ul>
<li> <p><code>noise_select=0</code>: Do <em>NOT</em> automatically select the noise levels. Use the the noise level given in the <code>noise</code> parameter (default)
</p>
</li>
<li> <p><code>noise_select=1</code>: Using the Noise Scree plot (with 'Added Rows' on the y-axis), find the noise level where the current number of added rows at this noise level is larger than the mean of 'added rows' at the lower noise levels. 
After locating this noise level, lower the noise level by 1. This is your automatically selected elbow/kink and therefore your noise level.
</p>
</li>
<li> <p><code>noise_select=2</code>: Applies the same steps as for <code>noise_select=1</code>, but instead of decreasing the noise level by only 1, keep decreasing the noise level until the number of added rows isn't decreasing anymore either.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removeBC</code></td>
<td>
<p><em>(Only applicable when result is a Biclust object)</em> Logical value if after applying a new noise level, duplicate and non-maximal BC's should be deleted.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt><em>Biclust S4 Object</em></dt>
<dd>
<p>Using the column patterns of the Biclust result, new grows are grown using the inputted <code>noise</code> level.
The <code>removeBC</code> parameter decides if duplicate and non-maximal BC's should be deleted. Afterwards a new <code>Biclust</code> S4 object is returned with the new biclusters.
</p>
</dd>
<dt><em>BiBitWorkflow S3 Object</em></dt>
<dd>
<p>The merged column patterns (after cutting the hierarchical tree) are extracted from the BiBitWorkflow object, namely the <code>$info$MergedColPatterns</code> slot. 
Afterwards, using the new <code>noise</code> level, new rows are grown and the returned object is an updated <code>BiBitWorkflow</code> object. (e.g. The final Biclust slot, MergedNoiseThresholds, coverage,etc. are updated)
</p>
</dd>
</dl>
<h3>Value</h3>

<p>A <code>Biclust</code> or <code>BiBitWorkflow</code> Object (See Details)
</p>


<h3>Author(s)</h3>

<p>Ewoud De Troyer
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Prepare some data ##
set.seed(254)
mat &lt;- matrix(sample(c(0,1),5000*50,replace=TRUE,prob=c(1-0.15,0.15)),
              nrow=5000,ncol=50)
mat[1:200,1:10] &lt;- matrix(sample(c(0,1),200*10,replace=TRUE,prob=c(1-0.9,0.9)),
                          nrow=200,ncol=10)
mat[300:399,6:15] &lt;- matrix(sample(c(0,1),100*10,replace=TRUE,prob=c(1-0.9,0.9)),
                            nrow=100,ncol=10)
mat[400:599,21:30] &lt;- matrix(sample(c(0,1),200*10,replace=TRUE,prob=c(1-0.9,0.9)),
                             nrow=200,ncol=10)
mat[700:799,29:38] &lt;- matrix(sample(c(0,1),100*10,replace=TRUE,prob=c(1-0.9,0.9)),
                             nrow=100,ncol=10)
mat &lt;- mat[sample(1:5000,5000,replace=FALSE),sample(1:50,50,replace=FALSE)]

## Apply BiBitWorkflow ##
out &lt;- BiBitWorkflow(matrix=mat,minr=50,minc=5,noise=0.1,cut_type="number",cut_pm=4)
summary(out$Biclust)

## Update Rows with new noise level on Biclust Obect -&gt; returns Biclust Object ##
out_new &lt;- UpdateBiclust_RowNoise(result=out$Biclust,matrix=mat,noise=0.3)
summary(out_new)
out_new@info$Noise.Threshold # New Noise Levels

## Update Rows with new noise level on BiBitWorkflow Obect -&gt; returns BiBitWorkflow Object ##
out_new2 &lt;- UpdateBiclust_RowNoise(result=out,matrix=mat,noise=0.2)
summary(out_new2$Biclust)
out_new2$info$MergedNoiseThresholds # New Noise Levels

## End(Not run)
</code></pre>


</div>