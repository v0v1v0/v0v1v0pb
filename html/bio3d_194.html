<div class="container">

<table style="width: 100%;"><tr>
<td>plot.dmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot Distance Matrix </h2>

<h3>Description</h3>

<p>Plot a distance matrix (DM) or a difference distance matrix (DDM).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dmat'
plot(x, key = TRUE, resnum.1 = c(1:ncol(x)), resnum.2 = resnum.1,
          axis.tick.space = 20, zlim = range(x, finite = TRUE),
          nlevels = 20, levels = pretty(zlim, nlevels),
          color.palette = bwr.colors,
          col = color.palette(length(levels) - 1),
          axes = TRUE, key.axes, xaxs = "i", yaxs = "i", las = 1,
          grid = TRUE, grid.col = "yellow", grid.nx = floor(ncol(x)/30),
          grid.ny = grid.nx, center.zero = TRUE, flip=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a numeric distance matrix generated by the function
<code>dm</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p> logical, if TRUE a color key is plotted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resnum.1</code></td>
<td>
<p> a vector of residue numbers for annotating the x axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resnum.2</code></td>
<td>
<p> a vector of residue numbers for annotating the y axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.tick.space</code></td>
<td>
<p> the separation between each axis tick mark. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p> z limits for the distances to be plotted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p> if <code>levels</code> is not specified, the range of 'z' values
is divided into approximately this many levels. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p> a set of levels used to partition the range of 'z'.
Must be *strictly* increasing (and finite).  Areas with 'z' values
between consecutive levels are painted with the same color. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p> a color palette function, used to assign
colors in the plot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p> an explicit set of colors to be used in the plot. This
argument overrides any palette function specification. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p> logical, if TRUE plot axes are drawn. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.axes</code></td>
<td>
<p> statements which draw axes on the plot key. It
overrides the default axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxs</code></td>
<td>
<p> the x axis style.  The default is to use internal labeling. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxs</code></td>
<td>
<p> the y axis style.  The default is to use internal labeling. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p> the style of labeling to be used.  The default is to use
horizontal labeling. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p> logical, if TRUE overlaid grid is drawn. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.col</code></td>
<td>
<p> color of the overlaid grid. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.nx</code></td>
<td>
<p> number of grid cells in the x direction.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.ny</code></td>
<td>
<p> number of grid cells in the y direction.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.zero</code></td>
<td>
<p> logical, if TRUE levels are forced to be
equidistant around zero, assuming that zlim ranges from less than to
more than zero. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p> logical, indicating whether the second axis should be
fliped. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional graphical parameters for image. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Called for its effect.
</p>


<h3>Note</h3>

<p>This function is based on the <code>layout</code> and legend key code in the
function <code>filled.contour</code> by Ross Ihaka.  As with
<code>filled.contour</code> the output is a combination of two plots: the
legend and (in this case) <code>image</code> (rather than a contour plot).
</p>


<h3>Author(s)</h3>

<p> Barry Grant </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695â€“2696.T
</p>
<p>Much of this function is based on the <code>filled.contour</code> function
by Ross Ihaka.
</p>


<h3>See Also</h3>

 <p><code>dm</code>, <code>filled.contour</code>,
<code>contour</code>, <code>image</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Read PDB file
pdb &lt;- read.pdb( system.file("examples/1hel.pdb", package="bio3d") )

# DM
d &lt;- dm(pdb,"calpha")

# Plot DM
##filled.contour(d, nlevels = 4)
##plot(d)
plot(d,
     resnum.1 = pdb$atom[pdb$calpha,"resno"],
     color.palette = mono.colors,
     xlab="Residue Number", ylab="Residue Number")

## Not run: 
# Download and align two PDB files
pdbs &lt;- pdbaln( get.pdb( c( "4q21", "521p"), path=tempdir(), overwrite=TRUE))

# Get distance matrix
a &lt;- dm.xyz(pdbs$xyz[1,])
b &lt;- dm.xyz(pdbs$xyz[2,])

# Calculate DDM
c &lt;- a - b

# Plot DDM
plot(c,key=FALSE, grid=FALSE)

plot(c, axis.tick.space=10,
     resnum.1=pdbs$resno[1,],
     resnum.2=pdbs$resno[2,],
     grid.col="black",
     xlab="Residue No. (4q21)", ylab="Residue No. (521p)")


## End(Not run)
</code></pre>


</div>