<div class="container">

<table style="width: 100%;"><tr>
<td>betta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Modelling total diversity with betta</h2>

<h3>Description</h3>

<p>This function tests for heterogeneity of total diversity (observed plus
unobserved) across multiple sites. It can account or test for fixed effects
that may explain diversity. It returns the significance of the covariates in
explaining diversity and a hypothesis test for heterogeneity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">betta(
  chats = NULL,
  ses,
  X = NULL,
  initial_est = NULL,
  formula = NULL,
  data = NULL,
  p.digits = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chats</code></td>
<td>
<p>A vector of estimates of total diversity at different sampling
locations. ‘<span class="samp">⁠breakaway⁠</span>’ estimates are suggested in the high-diversity
case but not enforced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ses</code></td>
<td>
<p>The standard errors in <code>chats</code>, the diversity estimates. This
can either be a vector of standard errors (with the arguments <code>chats</code> and
<code>X</code>), or the name of the variable in the dataframe <code>data</code> that contains
the standard errors (with the arguments <code>formula</code> and <code>data</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric matrix of covariates. If not supplied, an intercept-only
model will be fit. This is optional with the <code>chats</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_est</code></td>
<td>
<p>(Optional) A vector of length 1 + ncol(X) giving the starting values for the likelihood maximisation search. The first element is the starting estimate for sigma^2_u, and the remaining elements are the starting elements for beta. Defaults to NULL, in which case the starting values outlined in the paper are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object of the form <code class="reqn">y ~ x | group</code>. Required with
the <code>data</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe containing the response, response standard errors, covariates,
and grouping variable. Required with the <code>formula</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.digits</code></td>
<td>
<p>(Optional) A number that specifies the number of digits to which p-values will be rounded. The default value is 3 digits.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p> A coefficient table for the model parameters. The
columns give the parameter estimates, standard errors, and p-values,
respectively. This model is only as effective as your diversity estimation
procedure; for this reason please confirm that your estimates are
appropriate and that your model is not misspecified. betta_pic may be
useful for this purpose.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p> Estimated covariance matrix of the
parameter estimates.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssq_u</code></td>
<td>
<p> The estimate of the heterogeneity
variance.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homogeneity</code></td>
<td>
<p> The test statistic and p-value for the test
of homogeneity.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global</code></td>
<td>
<p> The test statistic and p-value for the
test of model explanatory power.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blups</code></td>
<td>
<p> The conditional expected
values of the diversity estimates (conditional on the random effects). The
authors propose that if the practitioner believes that information from one
diversity estimator may inform the others, then using the ‘<span class="samp">⁠condfits⁠</span>’ as
estimators of total diversity rather than ‘<span class="samp">⁠Chats⁠</span>’ may reduce variance
of diversity estimates by “sharing strength” across the samples.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blupses</code></td>
<td>
<p> The estimated standard deviation (standard errors) in the
blups.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglikelihood</code></td>
<td>
<p> The log likelihood of the fitted model.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p> The Akaike information criterion for the fitted model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicc</code></td>
<td>
<p> The finite sample correction of the Akaike information criterion for the fitted model.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_squared_wls</code></td>
<td>
<p>  The weighted R^2 statistic, appropriate for heteroskedastic linear models. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>function.args</code></td>
<td>
<p>A list containing
values initially passed to betta_random.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Ecologists who are interested in the way species richness varies with
covariate information often run a regression-type analysis on the observed
diversity using their covariate information as predictors. However, in many
settings (especially microbial), rare and unobserved taxa play a hugely
important role in explaining the subtleties of the ecosystem, however, a
regression analysis on the observed diversity level fails to account for
these unobserved taxa. By predicting the total level of diversity (for
example, via <code>breakaway</code>) and estimating the standard error in
the estimate, one can take account of these unobserved, but important, taxa.
In order to account for the estimated nature of the response, a mixed model
approach is taken, whereby the varying levels of confidence in the estimates
contributes to a diagonal but heteroscedastic covariance matrix. Given
covariates constitute the fixed effects in the mixed model, and significance
of the random effect term “sigsq_u” reflects heterogeneity in the sample,
that is, variability that cannot be explained by only the covariates. The
authors believe this to be the first attempt at modelling total diversity in
a way that accounts for its estimated nature.
</p>


<h3>Author(s)</h3>

<p>Amy Willis
</p>


<h3>References</h3>

<p>Willis, A., Bunge, J., and Whitman, T. (2015). Inference for
changes in biodiversity. <em>arXiv preprint.</em>
</p>
<p>Willis, A. and Bunge, J. (2015). Estimating diversity via frequency ratios.
<em>Biometrics.</em>
</p>


<h3>See Also</h3>

<p><code>breakaway</code>; <code>breakaway_nof1</code>;
<code>apples</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
















df &lt;- data.frame(chats = c(2000, 3000, 4000, 3000), ses = c(100, 200, 150, 180),
                 Cont_var = c(100, 150, 100, 50))

# formula notation
betta(formula = chats ~ Cont_var, ses = ses, data = df)

# direct input
betta(c(2000, 3000, 4000, 3000), c(100, 200, 150, 180), cbind(1, c(100, 150, 100,
    50)))

## handles missing data
betta(c(2000, 3000, 4000, 3000), c(100, 200, 150, NA))

## A test for heterogeneity of apples diversity estimates vs butterfly estimates
betta(c(1552, 1500, 884), c(305, 675, 205), cbind(1, c(0, 0, 1)))






















</code></pre>


</div>