<div class="container">

<table style="width: 100%;"><tr>
<td>detect.blocks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Block Detection</h2>

<h3>Description</h3>

<p>This function returns the block structure of a matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect.blocks(V, threshold = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Numeric matrix which either contains the loadings or is a covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>All absolute values of <code>V</code> below the threshold are set to zero.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>Block</code> containing the features and columns indices corresponding to each detected block.
</p>


<h3>References</h3>

<p><cite>Bauer, J.O. (202Xa). High-dimensional block diagonal covariance structure detection using singular vectors.</cite>
</p>


<h3>See Also</h3>

<p>bdsvd, single.bdsvd
</p>


<h3>Examples</h3>

<pre><code class="language-R">#In the first example, we replicate the simulation study for the ad hoc procedure
#Est_0.1 from Bauer (202Xa). In the second example, we manually compute the first step
#of BD-SVD, which can be done using the bdsvd() and/or single.bdsvd(), for constructed
#sparse loadings

#Example 1: Replicate the simulation study (a) from Bauer (202Xa) for the ad hoc
#procedure Est_0.1.

p &lt;- 500 #Number of variables
n &lt;- 125 #Number of observations
b &lt;- 500 #Number of blocks
design &lt;- "a"

#Simulate data matrix X
set.seed(1)
Sigma &lt;- bdsvd.cov.sim(p = p, b = b, design = design)
X &lt;- mvtnorm::rmvnorm(n, mean=rep(0, p), sigma=Sigma)
colnames(X) &lt;- 1:p

#Perform the ad hoc procedure
detect.blocks(cvCovEst::scadEst(dat = X, lambda = 0.2), threshold = 0)

#Example 2: Manually compute the first step of BD-SVD
#for some loadings V that mirror the two blocks
#("A", "B") and c("C", "D").

V &lt;- matrix(c(1,0,
              1,0,
              0,1,
              0,1), 4, 2, byrow = TRUE)

rownames(V) &lt;- c("A", "B", "C", "D")
detected.blocks &lt;- detect.blocks(V)

#Variables in block one with corresponding column index:
detected.blocks[[1]]@features
detected.blocks[[1]]@block.columns

#Variables in block two with corresponding column index:
detected.blocks[[2]]@features
detected.blocks[[2]]@block.columns

</code></pre>


</div>