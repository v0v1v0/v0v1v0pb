<div class="container">

<table style="width: 100%;"><tr>
<td>plot.dccm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> DCCM Plot </h2>

<h3>Description</h3>

<p>Plot a dynamical cross-correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dccm'
plot(x, resno=NULL, sse=NULL, colorkey=TRUE,
                    at=c(-1, -0.75, -0.5,  -0.25, 0.25, 0.5, 0.75, 1),
                    main="Residue Cross Correlation",
                    helix.col = "gray20", sheet.col = "gray80",
                    inner.box=TRUE, outer.box=FALSE,
                    xlab="Residue No.", ylab="Residue No.",
                    margin.segments=NULL, segment.col=vmd_colors(), segment.min=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a numeric matrix of atom-wise cross-correlations as output by
the ‘dccm’ function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resno</code></td>
<td>
<p> an optional vector with length equal to that of
<code>x</code> that will be used to annotate the x- and y-axis. This is typically
a vector of residue numbers. Can be also provided with a ‘pdb’ object,
in which ‘resno’ of all C-alpha atoms will be used. If NULL residue 
positions from 1 to the length of <code>x</code> will be used. See examples below. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sse</code></td>
<td>
<p> secondary structure object as returned from
<code>dssp</code>, <code>stride</code> or <code>read.pdb</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorkey</code></td>
<td>
<p> logical, if TRUE a key is plotted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p> numeric vector specifying the levels to be colored. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> a main title for the plot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>helix.col</code></td>
<td>
<p> The colors for rectangles representing alpha helices. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheet.col</code></td>
<td>
<p> The colors for rectangles representing beta strands. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner.box</code></td>
<td>
<p> logical, if TRUE an outer box is drawn. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer.box</code></td>
<td>
<p> logical, if TRUE an outer box is drawn. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> a label for the x axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p> a label for the y axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin.segments</code></td>
<td>
<p> a numeric vector of cluster membership as 
obtained from cutree() or other community detection method. This 
will be used for bottom and left margin annotation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment.col</code></td>
<td>
<p> a vector of colors used for each cluster group in 
margin.segments. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment.min</code></td>
<td>
<p> a single element numeric vector that will cause 
margin.segments with a length below this value to be excluded from
the plot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional graphical parameters for contourplot. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the ‘contourplot’ function from the lattice package for plot customization options, and the functions <code>dssp</code> and <code>stride</code> for further details.
</p>


<h3>Value</h3>

<p>Called for its effect.
</p>


<h3>Note</h3>

<p> Be sure to check the correspondence of your ‘sse’ object with the
‘cij’ values being plotted as no internal checks are currently performed.
</p>


<h3>Author(s)</h3>

<p> Barry Grant </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>


<h3>See Also</h3>

 <p><code>plot.bio3d</code>, <code>plot.dmat</code>,
<code>filled.contour</code>, <code>contour</code>,
<code>image</code> <code>plot.default</code>, <code>dssp</code>,
<code>stride</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
  ##-- Read example trajectory file
  trtfile &lt;- system.file("examples/hivp.dcd", package="bio3d")
  trj &lt;- read.dcd(trtfile)

  ## Read reference PDB and trim it to match the trajectory
  pdb &lt;- trim(read.pdb("1W5Y"), 'calpha')

  ## select residues 24 to 27 and 85 to 90 in both chains
  inds &lt;- atom.select(pdb, resno=c(24:27,85:90))

  ## lsq fit of trj on pdb
  xyz &lt;- fit.xyz(pdb$xyz, trj, fixed.inds=inds$xyz, mobile.inds=inds$xyz)

  ## Dynamic cross-correlations of atomic displacements
  cij &lt;- dccm(xyz)

  ## Default plot
  plot.dccm(cij)

  ## Change the color scheme and the range of colored data levels
  plot.dccm(cij, contour=FALSE, col.regions=bwr.colors(200), at=seq(-1,1,by=0.01) )

  ## Add secondary structure annotation to plot margins
  plot.dccm(cij, sse=pdb) 

  ## Add additional margin annotation for chains
  ## Also label x- and y-axis with PDB residue numbers
  ch &lt;- ifelse(pdb$atom$chain=="A", 1,2)
  plot.dccm(cij, resno=pdb, sse=pdb, margin.segments=ch)

  ## Plot with cluster annotation from dynamic network analysis
  #net &lt;- cna(cij)
  #plot.dccm(cij, margin.segments=net$raw.communities$membership)

  ## Focus on major communities (i.e. exclude those below a certain total length)
  #plot.dccm(cij, margin.segments=net$raw.communities$membership, segment.min=25)


## End(Not run)

</code></pre>


</div>