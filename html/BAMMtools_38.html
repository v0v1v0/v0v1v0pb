<div class="container">

<table style="width: 100%;"><tr>
<td>plot.bammshifts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot distinct rate shift configurations on a phylogeny</h2>

<h3>Description</h3>

<p>Plots a random distinct rate shift configuration sampled by
<code>BAMM</code> on a phylogeny.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bammshifts'
plot(
  x,
  ephy,
  method = "phylogram",
  pal = "RdYlBu",
  rank = NULL,
  index = NULL,
  spex = "s",
  legend = TRUE,
  add.freq.text = TRUE,
  logcolor = FALSE,
  breaksmethod = "linear",
  color.interval = NULL,
  JenksSubset = 20000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>bammshifts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string for which plotting method to use.
"phylogram" uses rectangular coordinates. "polar" uses polar
coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pal</code></td>
<td>
<p>The color palette to use in <code>plot.bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>The rank of the core shift configuration to plot. For the
default (<code>NULL</code>) a random configuration is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>The posterior sample to plot. For the default (<code>NULL</code>)
a random sample is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spex</code></td>
<td>
<p>A character string indicating what type of macroevolutionary
rates should be plotted. "s" (default) indicates speciation rates, "e"
indicates extinction rates, and 'netdiv' indicates net diversification
rates. Ignored if <code>ephy$type = "trait"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Logical indicating whether to plot a legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.freq.text</code></td>
<td>
<p>A logical indicating whether the frequency of each
sampled shift configuration should be added to each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logcolor</code></td>
<td>
<p>Logical. Should colors be plotted on a log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaksmethod</code></td>
<td>
<p>Method used for determining color breaks. See help
file for <code>assignColorBreaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.interval</code></td>
<td>
<p>Min and max value for the mapping of rates. One of
the two values can be <code>NA</code>. See details in
<code>plot.bammdata</code> for further details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JenksSubset</code></td>
<td>
<p>If <code>breaksmethod = "jenks"</code>, the number of
regularly-spaced samples to subset from the full rates vector. Only
relevant for large datasets. See help file for
<code>assignColorBreaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to <code>plot.bammdata</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A rate shift configuration is the set of nodes of the phylogeny
where a shift occurs in the macroevolutionary rate dynamic of
diversification or trait evolution. Each posterior sample is a
potentially distinct rate shift configuration. Different
configurations may imply different macroevolutionary scenarios. This
function helps visualize the different distinct rate shift
configurations sampled by <code>BAMM</code>.
</p>
<p>A core shift configuration is defined by a set of nodes that have
shift probabilities that are substantially elevated relative to what
you expect under the prior alone. These core configurations are
inferred in <code>distinctShiftConfigurations</code>. It is almost
certain that more than one core shift configuration will be sampled by
<code>BAMM</code>. Moreover, each core shift configuration may contain many
subconfigurations. A subconfiguration contains the core shift node
configuration and zero or more additional shift nodes that occur with
low marginal probability.  
</p>
<p>Points are added to the branches subtending the nodes of each rate
configuration. The size of the point is proportional to the marginal
probability that a shift occurs on a specific branch. If the
instantaneous rate at a shift's origin represents an initial increase
above the ancestral instantaneous rate the point is red. If the
instantaneous rate at a shift's origin represents an initial decrease
below the ancestral instantaneous rate the point is blue.
</p>


<h3>Author(s)</h3>

<p>Mike Grundler, Dan Rabosky
</p>


<h3>References</h3>

<p><a href="http://bamm-project.org/">http://bamm-project.org/</a>
</p>


<h3>See Also</h3>

<p><code>distinctShiftConfigurations</code>,
<code>plot.bammdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)

ed &lt;- getEventData(whales, events.whales, burnin=0.25, nsamples=500)

sc &lt;- distinctShiftConfigurations(ed, expectedNumberOfShifts = 1,
                                  threshold = 5)

plot(sc, ed)
</code></pre>


</div>