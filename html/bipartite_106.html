<div class="container">

<table style="width: 100%;"><tr>
<td>sortmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Organise matrix by topology </h2>

<h3>Description</h3>

<p>Sortmatrix is used to organize matrix rows and columns in order to highlight one of the three available topologies: nested, modular, and compound
</p>


<h3>Usage</h3>

<pre><code class="language-R">sortmatrix(matrix, topology="compound", sort_by="degrees", row_partitions=NULL, 
      col_partitions=NULL, mod_similarity=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>the interaction matrix (rows and columns are nodes; cells are links between nodes). The matrix may be binary (only 0s and 1s) or weighted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topology</code></td>
<td>
<p>defines for which topology the visualization is optimized. We implemented 3 topologies: nested, modular, and compound (modular with internally nested modules). Defaults to <span class="option">"nested"</span>. If <span class="option">topology = "nested"</span>, network is sorted by decreasing marginal totals. If <span class="option">topology = "modular""</span>, network is sorted based on row and column partitions. If <span class="option">topology = "compound"</span>, network is first sorted on row and column partitions, then sorted by decreasing marginal totals within each partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort_by</code></td>
<td>
<p>defines whether the marginal totals used for sorting are the binary marginal totals (<span class="option">sort_by = "degrees"</span>) or the weighted marginal totals (<span class="option">sort_by = "weights"</span>). If the matrix is binary, sort_by must be set to <span class="option">"degrees"</span>, which is also the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_partitions</code></td>
<td>
<p>vector with row partitions to be applied in modular and compound topologies. The length of the vector must be the number of rows in the matrix, each value is the partition of the respective row, following the row sequence in the matrix. Partition can be defined by numeric or character values. Not used if topology is <span class="option">"nested"</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_partitions</code></td>
<td>
<p>same as row_partitions, but for columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_similarity</code></td>
<td>
<p>logical; if <span class="option">mod_similarity=TRUE</span>, the order of modules is defined based on the similarity between them. So that more similar modules are closer in the plot. Similarity is based on Euclidian distances.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>More than a visualization choice, the use of binary or weighted marginal totals is related to the definition of weighted nestedness. One of the most used index, WNODF (Almeida-Neto and Ulrich 2011), requires binary nestedness to account for weighted nestedness. If this index and the definition of nestedness it reflects, is used, it may be more logical to define sort_by as degrees. Other indices, as WNODA (Pinheiro et al. 2019) do not require binary nestedness, thus, there is no reason to sort by degrees rather than weights.</p>


<h3>Value</h3>

<p>The output of sortmatrix is a list with 5 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>is the sorted matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_partitions</code></td>
<td>
<p>a vector with the partitions for rows, in the new order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_partitions</code></td>
<td>
<p>a vector with the partitions for columns, in the new order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_row</code></td>
<td>
<p>a vector with the position of each row of the input matrix in the sorted matrix. order_col: a vector with the position of each column of the input matrix in the sorted matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Rafael Barros Pereira Pinheiro <a href="mailto:rafael-bpp@hotmail.com">rafael-bpp@hotmail.com</a>, Gabriel Felix, Marco Mello, and the team of the Ecological Synthesis Lab, University of São Paulo</p>


<h3>References</h3>

<p>Almeida-Neto, M. and Ulrich, W. 2011. A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environ. Model. Softw.</em> <b>26</b>, 173–178
</p>
<p>Lewinsohn, T.M. et al. 2006. Structure in plant-animal interaction assemblages. <em>Oikos</em> <b>113</b>,  174–184
</p>
<p>Pinheiro, R.B.P. et al. 2019. A new model explaining the origin of different topologies in interaction networks. <em>Ecology</em> <b>100</b>, 1–30
</p>


<h3>See Also</h3>

<p>The output of <code>sortmatrix</code> is used by <code>plotmatrix</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">sortmatrix (Safariland, topology = "nested", sort_by = "weights")

# see example in help for "plotmatrix"
</code></pre>


</div>