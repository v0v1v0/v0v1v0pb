<div class="container">

<table style="width: 100%;"><tr>
<td>bets.likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Profile) Likelihood function</h2>

<h3>Description</h3>

<p>(Profile) Likelihood function
</p>


<h3>Usage</h3>

<pre><code class="language-R">bets.likelihood(
  params,
  data,
  likelihood = c("conditional", "unconditional"),
  M = Inf,
  r = NULL,
  L = NULL,
  params_init = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A vector of parameters (with at least one of the following entries: rho, r, ip_q50, ip_q95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with three columns: B, E, S</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>Use the conditional or unconditional likelihood function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Right truncation for symptom onset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Parameter for epidemic growth (overrides <code>{params}</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Day of travel quarantine</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_init</code></td>
<td>
<p>Initial parameters for computing the profile likelihood</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Non-default values of <code>M</code> and <code>r</code> are only available for conditional likelihood.
</p>


<h3>Value</h3>

<p>Log-likelihood function if <code>params</code> has all four entries, rho, r, ip_q50, ip_q95 (or three entires—r, ip_q50, ip_q95—if computing the conditional likelihood). Otherwise returns the profile likelihood for the parameters in <code>params</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(wuhan_exported)

data &lt;- wuhan_exported
data$B &lt;- data$B - 0.75
data$E &lt;- data$E - 0.25
data$S &lt;- data$S - 0.5

params &lt;- c(r = 0.2,
            ip_q50 = 5,
            ip_q95 = 12)

# Conditional likelihood
bets.likelihood(params, data)

# Conditional likelihood with right truncation
bets.likelihood(params, subset(data, S &lt;= 60), M = 60)

# Conditional likelihood with fixed r (not recommended)
bets.likelihood(params, data, r = 0)

# Unconditional likelihood
params["rho"] &lt;- 1
bets.likelihood(params, data, likelihood = "unconditional", L = 54)

# Profile conditional likelihood
bets.likelihood(c(r = 0.2), data, params_init = params)

</code></pre>


</div>