<div class="container">

<table style="width: 100%;"><tr>
<td>MCMI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate the Sampling Distribution of Regression Parameters
Using the Monte Carlo Method for Data with Missing Values</h2>

<h3>Description</h3>

<p>Generate the Sampling Distribution of Regression Parameters
Using the Monte Carlo Method for Data with Missing Values
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMI(
  object,
  mi,
  R = 20000L,
  type = "hc3",
  g1 = 1,
  g2 = 1.5,
  k = 0.7,
  decomposition = "eigen",
  pd = TRUE,
  tol = 1e-06,
  fixed_x = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mi</code></td>
<td>
<p>Object of class <code>mids</code> (output of <code>mice::mice()</code>),
object of class <code>amelia</code> (output of <code>Amelia::amelia()</code>),
or a list of multiply imputed data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Positive integer.
Number of Monte Carlo replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string.
Sampling covariance matrix type.
Possible values are
<code>"mvn"</code>,
<code>"adf"</code>,
<code>"hc0"</code>,
<code>"hc1"</code>,
<code>"hc2"</code>,
<code>"hc3"</code>,
<code>"hc4"</code>,
<code>"hc4m"</code>, and
<code>"hc5"</code>.
<code>type = "mvn"</code> uses the normal-theory sampling covariance matrix.
<code>type = "adf"</code> uses the asymptotic distribution-free
sampling covariance matrix.
<code>type = "hc0"</code> through <code>"hc5"</code> uses different versions of
heteroskedasticity-consistent sampling covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1</code></td>
<td>
<p>Numeric.
<code>g1</code> value for <code>type = "hc4m"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>Numeric.
<code>g2</code> value for <code>type = "hc4m"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Numeric.
Constant for <code>type = "hc5"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decomposition</code></td>
<td>
<p>Character string.
Matrix decomposition of the sampling variance-covariance matrix
for the data generation.
If <code>decomposition = "chol"</code>, use Cholesky decomposition.
If <code>decomposition = "eigen"</code>, use eigenvalue decomposition.
If <code>decomposition = "svd"</code>, use singular value decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>Logical.
If <code>pd = TRUE</code>,
check if the sampling variance-covariance matrix
is positive definite using <code>tol</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numeric.
Tolerance used for <code>pd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_x</code></td>
<td>
<p>Logical.
If <code>fixed_x = TRUE</code>, treat the regressors as fixed.
If <code>fixed_x = FALSE</code>, treat the regressors as random.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer.
Seed number for reproducibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multiple imputation
is used to deal with missing values in a data set.
The vector of parameter estimates
and the corresponding sampling covariance matrix
are estimated for each of the imputed data sets.
Results are combined to arrive at the pooled vector of parameter estimates
and the corresponding sampling covariance matrix.
The pooled estimates are then used to generate the sampling distribution
of regression parameters.
See <code>MC()</code> for more details on the Monte Carlo method.
</p>


<h3>Value</h3>

<p>Returns an object
of class <code>mc</code> which is a list with the following elements:
</p>

<dl>
<dt>call</dt>
<dd>
<p>Function call.</p>
</dd>
<dt>args</dt>
<dd>
<p>Function arguments.</p>
</dd>
<dt>lm_process</dt>
<dd>
<p>Processed <code>lm</code> object.</p>
</dd>
<dt>scale</dt>
<dd>
<p>Sampling variance-covariance matrix of parameter estimates.</p>
</dd>
<dt>location</dt>
<dd>
<p>Parameter estimates.</p>
</dd>
<dt>thetahatstar</dt>
<dd>
<p>Sampling distribution of parameter estimates.</p>
</dd>
<dt>fun</dt>
<dd>
<p>Function used ("MCMI").</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Ivan Jacob Agaloos Pesigan
</p>


<h3>References</h3>

<p>Dudgeon, P. (2017).
Some improvements in confidence intervals
for standardized regression coefficients.
<em>Psychometrika</em>, <em>82</em>(4), 928–951.
<a href="https://doi.org/10.1007/s11336-017-9563-z">doi:10.1007/s11336-017-9563-z</a>
</p>
<p>MacKinnon, D. P., Lockwood, C. M., &amp; Williams, J. (2004).
Confidence limits for the indirect effect:
Distribution of the product and resampling methods.
<em>Multivariate Behavioral Research</em>, <em>39</em>(1), 99-128.
<a href="https://doi.org/10.1207/s15327906mbr3901_4">doi:10.1207/s15327906mbr3901_4</a>
</p>
<p>Pesigan, I. J. A., &amp; Cheung, S. F. (2023).
Monte Carlo confidence intervals for the indirect effect with missing data.
<em>Behavior Research Methods</em>.
<a href="https://doi.org/10.3758/s13428-023-02114-4">doi:10.3758/s13428-023-02114-4</a>
</p>
<p>Preacher, K. J., &amp; Selig, J. P. (2012).
Advantages of Monte Carlo confidence intervals for indirect effects.
<em>Communication Methods and Measures</em>, <em>6</em>(2), 77–98.
<a href="https://doi.org/10.1080/19312458.2012.679848">doi:10.1080/19312458.2012.679848</a>
</p>


<h3>See Also</h3>

<p>Other Beta Monte Carlo Functions: 
<code>BetaMC()</code>,
<code>DeltaRSqMC()</code>,
<code>DiffBetaMC()</code>,
<code>MC()</code>,
<code>PCorMC()</code>,
<code>RSqMC()</code>,
<code>SCorMC()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data ---------------------------------------------------------------------
data("nas1982", package = "betaMC")
nas1982_missing &lt;- mice::ampute(nas1982)$amp # data set with missing values

# Multiple Imputation
mi &lt;- mice::mice(nas1982_missing, m = 5, seed = 42, print = FALSE)

# Fit Model in lm ----------------------------------------------------------
## Note that this does not deal with missing values.
## The fitted model (`object`) is updated with each imputed data
## within the `MCMI()` function.
object &lt;- lm(QUALITY ~ NARTIC + PCTGRT + PCTSUPP, data = nas1982_missing)

# Monte Carlo --------------------------------------------------------------
mc &lt;- MCMI(
  object,
  mi = mi,
  R = 100, # use a large value e.g., 20000L for actual research
  seed = 0508
)
mc
# The `mc` object can be passed as the first argument
# to the following functions
#   - BetaMC
#   - DeltaRSqMC
#   - DiffBetaMC
#   - PCorMC
#   - RSqMC
#   - SCorMC

</code></pre>


</div>