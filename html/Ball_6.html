<div class="container">

<table style="width: 100%;"><tr>
<td>bcov.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ball Covariance Test</h2>

<h3>Description</h3>

<p>Ball Covariance test of independence. 
Ball covariance are generic dependence measures in Banach spaces.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcov.test(x, ...)

## Default S3 method:
bcov.test(
  x,
  y = NULL,
  num.permutations = 99,
  method = c("permutation", "limit"),
  distance = FALSE,
  weight = FALSE,
  seed = 1,
  num.threads = 0,
  ...
)

## S3 method for class 'formula'
bcov.test(formula, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix, data.frame, or a list containing at least two numeric vectors, matrices, or data.frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector, matrix, or data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.permutations</code></td>
<td>
<p>the number of permutation replications. When <code>num.permutations = 0</code>, the function just returns
the Ball Covariance statistic. Default: <code>num.permutations = 99</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>if <code>method = "permutation"</code>, a permutation procedure is carried out to compute the <code class="reqn">p</code>-value;
if <code> method = "limit"</code>, an approximate null distribution is used when <code>weight = "constant"</code>.
Any unambiguous substring can be given. Default <code>method = "permutation"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>if <code>distance = TRUE</code>, the elements of <code>x</code> and <code>y</code> are considered as distance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a logical or character string used to choose the weight form of Ball Covariance statistic.. 
If input is a character string, it must be one of <code>"constant"</code>, <code>"probability"</code>, or <code>"chisquare"</code>. 
Any unambiguous substring can be given. 
If input is a logical value, it is equivalent to <code>weight = "probability"</code> if <code>weight = TRUE</code> while 
equivalent to <code>weight = "constant"</code> if <code>weight = FALSE</code>.
Default: <code>weight = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed. Default <code>seed = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.threads</code></td>
<td>
<p>number of threads. If <code>num.threads = 0</code>, then all of available cores will be used. Default <code>num.threads = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>~ u + v</code>, where each of <code>u</code> and <code>v</code> are numeric variables giving the data values for one sample. The samples must be of the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see <code>model.frame</code>) containing the variables in the formula formula. By default the variables are taken from environment(formula).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain <code>NA</code>s. Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bcov.test</code> is non-parametric tests of independence in Banach spaces. 
It can detect the dependence between two random objects (variables) and 
the mutual dependence among at least three random objects (variables).
</p>
<p>If two samples are pass to arguments <code>x</code> and <code>y</code>, the sample sizes (i.e. number of rows or length of the vector) 
of the two variables must agree. If a <code>list</code> object is passed to <code>x</code>, this <code>list</code> must contain at least
two numeric vectors, matrices, or data.frames, and each element of this <code>list</code> 
must with the same sample size. Moreover, data pass to <code>x</code> or <code>y</code> 
must not contain missing or infinite values. 
If <code>distance = TRUE</code>, <code>x</code> is considered as a distance matrix or a list containing distance matrices, 
and <code>y</code> is considered as a distance matrix; otherwise, these arguments are treated as data.
</p>
<p><code>bcov.test</code> utilizes the Ball Covariance statistics (see <code>bcov</code>) to measure dependence and 
derives a <code class="reqn">p</code>-value via replicating the random permutation <code>num.permutations</code> times.
</p>
<p>See Pan et al 2018 for theoretical properties of the test, including statistical consistency.
</p>


<h3>Value</h3>

<p>If <code>num.permutations &gt; 0</code>, <code>bcov.test</code> returns a <code>htest</code> class object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Ball Covariance statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>permutation replications of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.info</code></td>
<td>
<p>a <code>list</code> mainly containing two vectors, the first vector is the Ball Covariance statistics 
with different weights, the second is the <code class="reqn">p</code>-values of weighted Ball Covariance tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>description of data.</p>
</td>
</tr>
</table>
<p>If <code>num.permutations = 0</code>, <code>bcov.test</code> returns a statistic value.
</p>


<h3>Note</h3>

<p>Actually, <code>bcov.test</code> simultaneously computing Ball Covariance statistics with 
<code>"constant"</code>, <code>"probability"</code>, and <code>"chisquare"</code> weights.
Users can get other Ball Covariance statistics with different weight and their corresponding <code class="reqn">p</code>-values 
in the <code>complete.info</code> element of output. We give a quick example below to illustrate.
</p>


<h3>Author(s)</h3>

<p>Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu, Jin Zhu
</p>


<h3>References</h3>

<p>Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu &amp; Jin Zhu (2019) Ball Covariance: A Generic Measure of Dependence in Banach Space, Journal of the American Statistical Association, DOI: 10.1080/01621459.2018.1543600
</p>
<p>Jin Zhu, Wenliang Pan, Wei Zheng, and Xueqin Wang (2021). Ball: An R Package for Detecting Distribution Difference and Association in Metric Spaces, Journal of Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.
</p>


<h3>See Also</h3>

<p><code>bcov</code>, <code>bcor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)

################# Quick Start #################
noise &lt;- runif(50, min = -0.3, max = 0.3)
x &lt;- runif(50, 0, 4*pi)
y &lt;- cos(x) + noise
# plot(x, y)
res &lt;- bcov.test(x, y)
res
## get all Ball Covariance statistics:
res[["complete.info"]][["statistic"]]
## get all test result:
res[["complete.info"]][["p.value"]]

################# Quick Start #################
x &lt;- matrix(runif(50 * 2, -pi, pi), nrow = 50, ncol = 2)
noise &lt;- runif(50, min = -0.1, max = 0.1)
y &lt;- sin(x[,1] + x[,2]) + noise
bcov.test(x = x, y = y, weight = "prob")

################# Ball Covariance Test for Non-Hilbert Data #################
# load data:
data("ArcticLake")
# Distance matrix between y:
Dy &lt;- nhdist(ArcticLake[["x"]], method = "compositional")
# Distance matrix between x:
Dx &lt;- dist(ArcticLake[["depth"]])
# hypothesis test with BCov:
bcov.test(x = Dx, y = Dy, distance = TRUE)

################  Weighted Ball Covariance Test  #################
data("ArcticLake")
Dy &lt;- nhdist(ArcticLake[["x"]], method = "compositional")
Dx &lt;- dist(ArcticLake[["depth"]])
# hypothesis test with weighted BCov:
bcov.test(x = Dx, y = Dy, distance = TRUE, weight = "prob")

################# Mutual Independence Test #################
x &lt;- rnorm(50)
y &lt;- (x &gt; 0) * x + rnorm(50)
z &lt;- (x &lt;= 0) * x + rnorm(50)
data_list &lt;- list(x, y, z)
bcov.test(data_list)
data_list &lt;- lapply(data_list, function(x) {
  as.matrix(dist(x))
})
bcov.test(data_list, distance = TRUE)
bcov.test(data_list, distance = FALSE, weight = "chi")

################# Mutual Independence Test for Meteorology data #################
data("meteorology")
bcov.test(meteorology)

################  Testing via approximate limit distribution  #################
## Not run: 
set.seed(1)
n &lt;- 2000
x &lt;- rnorm(n)
y &lt;- rnorm(n)
bcov.test(x, y, method = "limit")
bcov.test(x, y)

## End(Not run)

################  Formula interface  ################
## independence test:
bcov.test(~ CONT + INTG, data = USJudgeRatings)
## independence test with chisquare weight:
bcov.test(~ CONT + INTG, data = USJudgeRatings, weight = "chi")
## mutual independence test:
bcov.test(~ CONT + INTG + DMNR, data = USJudgeRatings)
</code></pre>


</div>