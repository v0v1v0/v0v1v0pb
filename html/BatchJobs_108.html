<div class="container">

<table style="width: 100%;"><tr>
<td>submitJobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Submit jobs or chunks of jobs to batch system via cluster function.</h2>

<h3>Description</h3>

<p>If the internal submit cluster function completes successfully, the <code>retries</code>
counter is set back to 0 and the next job or chunk is submitted.
If the internal submit cluster function returns a fatal error, the submit process
is completely stopped and an exception is thrown.
If the internal submit cluster function returns a temporary error, the submit process
waits for a certain time, which is determined by calling the user-defined
<code>wait</code>-function with the current <code>retries</code> counter, the counter is
increased by 1 and the same job is submitted again. If <code>max.retries</code> is
reached the function simply terminates.
</p>
<p>Potential temporary submit warnings and errors are logged inside your file
directory in the file “submit.log”.
To keep track you can use <code>tail -f [file.dir]/submit.log</code> in another
terminal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">submitJobs(
  reg,
  ids,
  resources = list(),
  wait,
  max.retries = 10L,
  chunks.as.arrayjobs = FALSE,
  job.delay = FALSE,
  progressbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>[<code>Registry</code>]<br>
Registry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>[<code>integer</code>]<br>
Vector for job id or list of vectors of chunked job ids.
Only corresponding jobs are submitted. Chunked jobs will get executed
sequentially as a single job for the scheduler.
Default is all jobs which were not yet submitted to the batch system.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resources</code></td>
<td>
<p>[<code>list</code>]<br>
Required resources for all batch jobs. The elements of this list
(e.g. something like “walltime” or “nodes” are defined by your template job file.
Defaults can be specified in your config file.
Default is empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wait</code></td>
<td>
<p>[<code>function(retries)</code>]<br>
Function that defines how many seconds should be waited in case of a temporary error.
Default is exponential back-off with <code>10*2^retries</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.retries</code></td>
<td>
<p>[<code>integer(1)</code>]<br>
Number of times to submit one job again in case of a temporary error
(like filled queues). Each time <code>wait</code> is called to wait a certain
number of seconds.
Default is 10 times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunks.as.arrayjobs</code></td>
<td>
<p>[<code>logical(1)</code>]<br>
If ids are passed as a list of chunked job ids, execute jobs in a chunk
as array jobs. Note that your scheduler and your template must be adjusted to
use this option. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>job.delay</code></td>
<td>
<p>[<code>function(n, i)</code> or <code>logical(1)</code>]<br>
Function that defines how many seconds a job should be delayed before it starts.
This is an expert option and only necessary to change when you want submit
extremely many jobs. We then delay the jobs a bit to write the submit messages as
early as possible to avoid writer starvation.
<code>n</code> is the number of jobs and <code>i</code> the number of the ith job.
The default function used with <code>job.delay</code> set to <code>TRUE</code> is no delay for
100 jobs or less and otherwise <code>runif(1, 0.1*n, 0.2*n)</code>.
If set to <code>FALSE</code> (the default) delaying jobs is disabled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>[<code>logical(1)</code>]<br>
Set to <code>FALSE</code> to disable the progress bar.
To disable all progress bars, see <code>makeProgressBar</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>[<code>integer</code>]. Vector of submitted job ids.
</p>


<h3>Examples</h3>

<pre><code class="language-R">reg = makeRegistry(id = "BatchJobsExample", file.dir = tempfile(), seed = 123)
f = function(x) x^2
batchMap(reg, f, 1:10)
submitJobs(reg)
waitForJobs(reg)

# Submit the 10 jobs again, now randomized into 2 chunks:
chunked = chunk(getJobIds(reg), n.chunks = 2, shuffle = TRUE)
submitJobs(reg, chunked)
</code></pre>


</div>