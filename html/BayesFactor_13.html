<div class="container">

<table style="width: 100%;"><tr>
<td>anovaBF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute Bayes factors for ANOVA designs</h2>

<h3>Description</h3>

<p>This function computes Bayes factors for all main-effects and interaction
contrasts in an ANOVA design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anovaBF(
  formula,
  data,
  whichRandom = NULL,
  whichModels = "withmain",
  iterations = 10000,
  progress = getOption("BFprogress", interactive()),
  rscaleFixed = "medium",
  rscaleRandom = "nuisance",
  rscaleEffects = NULL,
  multicore = FALSE,
  method = "auto",
  noSample = FALSE,
  callback = function(...) as.integer(0)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula containing all factors to include in the analysis
(see Examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing data for all factors in the formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichRandom</code></td>
<td>
<p>a character vector specifying which factors are random</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichModels</code></td>
<td>
<p>which set of models to compare; see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>How many Monte Carlo simulations to generate, if relevant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>if <code>TRUE</code>, show progress with a text progress bar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rscaleFixed</code></td>
<td>
<p>prior scale for standardized, reduced fixed effects. A
number of preset values can be given as strings; see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rscaleRandom</code></td>
<td>
<p>prior scale for standardized random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rscaleEffects</code></td>
<td>
<p>A named vector of prior settings for individual factors,
overriding rscaleFixed and rscaleRandom. Values are scales, names are factor names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicore</code></td>
<td>
<p>if <code>TRUE</code> use multiple cores through the <code>doMC</code>
package. Unavailable on Windows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>approximation method, if needed. See <code>nWayAOV</code> for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noSample</code></td>
<td>
<p>if <code>TRUE</code>, do not sample, instead returning NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callback</code></td>
<td>
<p>callback function for third-party interfaces</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Models, priors, and methods of computation are provided in Rouder et al.
(2012).
</p>
<p>The ANOVA model for a vector of observations <code class="reqn">y</code> is </p>
<p style="text-align: center;"><code class="reqn"> y = \mu + X_1
\theta_1 + \ldots + X_p\theta_p +\epsilon,</code>
</p>
<p> where
<code class="reqn">\theta_1,\ldots,\theta_p</code> are vectors of main-effect and interaction
effects, <code class="reqn">X_1,\ldots,X_p</code> are corresponding design matrices, and
<code class="reqn">\epsilon</code> is a vector of zero-centered noise terms with variance
<code class="reqn">\sigma^2</code>.  Zellner and Siow (1980) inspired g-priors are placed on
effects, but with a separate g-prior parameter for each covariate:
</p>
<p style="text-align: center;"><code class="reqn">\theta_1~N(0,g_1\sigma^2), \ldots,  \theta_p~N(0,g_p \sigma^2).</code>
</p>
<p>  A
Jeffries prior is placed on <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code>.  Independent
scaled inverse-chi-square priors with one degree of freedom are placed on
<code class="reqn">g_1,\ldots,g_p</code>.  The square-root of the scale for g's corresponding to
fixed and random effects is given by <code>rscaleFixed</code> and
<code>rscaleRandom</code>, respectively.
</p>
<p>When a factor is treated as random, there are as many main effect terms in
the vector <code class="reqn">\theta</code> as levels.  When a factor is treated as fixed, the
sums-to-zero linear constraint is enforced by centering the corresponding
design matrix, and there is one fewer main effect terms as levels.  The
Cornfield-Tukey model of interactions is assumed.  Details are provided in
Rouder et al. (2012)
</p>
<p>Bayes factors are computed by integrating the likelihood with respect to the
priors on parameters.  The integration of all parameters except
<code class="reqn">g_1,\ldots,g_p</code> may be expressed in closed-form; the integration of
<code class="reqn">g_1,\ldots,g_p</code> is performed through Monte Carlo sampling, and
<code>iterations</code> is the number of iterations used to estimate the Bayes
factor.
</p>
<p><code>anovaBF</code> computes Bayes factors for either all submodels or select
submodels missing a single main effect or covariate, depending on the
argument <code>whichModels</code>. If no random factors are specified, the null
model assumed by <code>anovaBF</code> is the grand-mean only model. If random
factors are specified, the null model is the model with an additive model on
all random factors, plus a grand mean. Thus, <code>anovaBF</code> does not
currently test random factors. Testing random factors is possible with
<code>lmBF</code>.
</p>
<p>The argument <code>whichModels</code> controls which models are tested. Possible
values are 'all', 'withmain', 'top', and 'bottom'. Setting
<code>whichModels</code> to 'all' will test all models that can be created by
including or not including a main effect or interaction. 'top' will test all
models that can be created by removing or leaving in a main effect or
interaction term from the full model. 'bottom' creates models by adding
single factors or interactions to the null model. 'withmain' will test all
models, with the constraint that if an interaction is included, the
corresponding main effects are also included.
</p>
<p>For the <code>rscaleFixed</code> and <code>rscaleRandom</code> arguments, several named
values are recognized: "medium", "wide", and "ultrawide", corresponding to
<code class="reqn">r</code> scale values of 1/2, <code class="reqn">\sqrt{2}/2</code>, and 1,
respectively. In addition, <code>rscaleRandom</code> can be set to the "nuisance",
which sets <code class="reqn">r=1</code> (and is thus equivalent to "ultrawide"). The "nuisance"
setting is for medium-to-large-sized effects assumed to be in the data but
typically not of interest, such as variance due to participants.
</p>


<h3>Value</h3>

<p>An object of class <code>BFBayesFactor</code>, containing the computed
model comparisons. Bayes factors can be extracted using extractBF(), as.vector()
or as.data.frame().
</p>


<h3>Note</h3>

<p>The function <code>anovaBF</code> will compute Bayes factors for all
possible combinations of fixed factors and interactions, against the null
hypothesis that <em>all</em> effects are 0. The total number of tests
computed will be <code class="reqn">2^{2^K - 1}</code> for <code class="reqn">K</code> fixed factors.
This number increases very quickly with the number of factors. For
instance, for a five-way ANOVA, the total number of tests exceeds two
billion. Even though each test takes a fraction of a second, the time
taken for all tests could exceed your lifetime. An option is included to
prevent this: <code>options('BFMaxModels')</code>, which defaults to 50,000, is
the maximum number of models that 'anovaBF' will analyze at once. This can
be increased by increasing the option value.
</p>
<p>It is possible to reduce the number of models tested by only testing the
most complex model and every restriction that can be formed by removing
one factor or interaction using the <code>whichModels</code> argument. Setting
this argument to 'top' reduces the number of tests to <code class="reqn">2^K-1</code>, which
is more manageable. The Bayes factor for each restriction against the most
complex model can be interpreted as a test of the removed
factor/interaction. Setting <code>whichModels</code> to 'withmain' will not
reduce the number of tests as much as 'top' but the results may be more
interpretable, since an interaction is only allowed when all interacting
effects (main or interaction) are also included in the model.
</p>


<h3>Author(s)</h3>

<p>Richard D. Morey (<a href="mailto:richarddmorey@gmail.com">richarddmorey@gmail.com</a>)
</p>


<h3>References</h3>

<p>Gelman, A. (2005) Analysis of Varianceâ€”why it is more
important than ever.  Annals of Statistics, 33, pp. 1-53.
</p>
<p>Rouder, J. N., Morey, R. D., Speckman, P. L., Province, J. M., (2012)
Default Bayes Factors for ANOVA Designs. Journal of Mathematical
Psychology.  56.  p. 356-374.
</p>
<p>Zellner, A. and Siow, A., (1980) Posterior Odds Ratios for Selected
Regression Hypotheses.  In Bayesian Statistics: Proceedings of the First
Interanational Meeting held in Valencia (Spain).  Bernardo, J. M.,
Lindley, D. V., and Smith A. F. M. (eds), pp. 585-603.  University of
Valencia.
</p>


<h3>See Also</h3>

<p><code>lmBF</code>, for testing specific models, and
<code>regressionBF</code> for the function similar to <code>anovaBF</code> for
linear regression models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Classical example, taken from t.test() example
## Student's sleep data
data(sleep)
plot(extra ~ group, data = sleep)

## traditional ANOVA gives a p value of 0.00283
summary(aov(extra ~ group + Error(ID/group), data = sleep))

## Gives a Bayes factor of about 11.6
## in favor of the alternative hypothesis
anovaBF(extra ~ group + ID, data = sleep, whichRandom = "ID",
    progress=FALSE)

## Demonstrate top-down testing
data(puzzles)
result = anovaBF(RT ~ shape*color + ID, data = puzzles, whichRandom = "ID",
    whichModels = 'top', progress=FALSE)
result

## In orthogonal designs, the top down Bayes factor can be
## interpreted as a test of the omitted effect
</code></pre>


</div>