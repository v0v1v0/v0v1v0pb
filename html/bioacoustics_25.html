<div class="container">

<table style="width: 100%;"><tr>
<td>threshold_detection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Amplitude threshold detector above Signal to Noise Ratio (SNR)</h2>

<h3>Description</h3>

<p>This function is a modified version of the Bat Bioacoustics freeware developed by Christopher Scott (2012).
It combines several detection, filtering and audio feature extraction algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">threshold_detection(
  wave,
  threshold = 14,
  channel = "left",
  time_exp = 1,
  min_dur = 1.5,
  max_dur = 80,
  min_TBE = 20,
  max_TBE = 1000,
  EDG = 0.996,
  LPF,
  HPF = 16000,
  FFT_size = 256,
  FFT_overlap = 0.875,
  start_thr = 40,
  end_thr = 20,
  SNR_thr = 10,
  angle_thr = 40,
  duration_thr = 80,
  NWS = 100,
  KPE = 1e-05,
  KME = 1e-05,
  settings = FALSE,
  acoustic_feat = TRUE,
  metadata = FALSE,
  spectro_dir = NULL,
  time_scale = 0.1,
  ticks = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>either a path to a file, or a Wave object.
</p>
<p>Audio files will be automatically decoded internally using the function read_audio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>integer. Sensitivity of the audio event detection function (peak-picking algorithm) in dB.
A threshold value of 14 dB above SNR is recommended. Higher values increase the risk of leaving audio events undetected (false negative).
In a noisy recording (low SNR) this sensitivity threshold may be set at 12 dB,
but a value below 10 dB is not recommended. Default setting is 14 dB above SNR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>character. Channel to keep for analysis in a stereo recording: 'left' or 'right'.
Do not need to be specified for mono recordings, recordings with more than two channels are not
yet supported. Default setting is 'left'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_exp</code></td>
<td>
<p>integer. Time expansion factor of the recording.
Set to 1 for real-time recording or above for time expanded recording. Default setting is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_dur</code></td>
<td>
<p>numeric. Minimum duration threshold in milliseconds (ms).
Extracted audio events shorter than this threshold are ignored. Default setting is 1.5 ms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_dur</code></td>
<td>
<p>numeric. Maximum duration threshold in milliseconds (ms).
Extracted audio events longer than this threshold are ignored. The default setting is 80 ms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_TBE</code></td>
<td>
<p>numeric. Minimum time window between two audio events in milliseconds (ms). If the time interval between two
successive audio events is shorter than this window, they are ignored. The default setting is 20 ms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_TBE</code></td>
<td>
<p>numeric. Maximum time window between two audio events in milliseconds (ms). If the time interval between two
successive audio events is longer than this window, they are ignored. The default setting is 1000 ms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EDG</code></td>
<td>
<p>numeric. Exponential Decay Gain from 0 to 1. Sets the degree of temporal masking at the end of each audio event.
This filter avoids extracting noise or echoes at the end of the audio event. The default setting is 0.996.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LPF</code></td>
<td>
<p>integer. Low-Pass Filter (Hz). Frequencies above the cutoff are greatly attenuated.
Default is set internally at the Nyquist frequency of the recording.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HPF</code></td>
<td>
<p>integer. High-Pass Filter (Hz). Frequencies below the cutoff are greatly attenuated.
Default setting is 16000 Hz. A default of 1000 Hz is recommended for most bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FFT_size</code></td>
<td>
<p>integer. Size of the Fast Fourrier Transform (FFT) window. Default setting is 256.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FFT_overlap</code></td>
<td>
<p>numeric. Percentage of overlap between two FFT windows (from 0 to 1). Default setting is 0.875.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_thr</code></td>
<td>
<p>integer. Right to left amplitude threshold (dB) for audio event extraction, from the audio event centroid.
The last FFT where the amplitude level is equal or above this threshold is considered the start of the audio event.
Default setting is 40 dB. 20 dB is recommended for extracting bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_thr</code></td>
<td>
<p>integer. Left to right amplitude threshold (dB) for audio event extraction, from the audio event centroid.
The last FFT where the amplitude level is equal or above this threshold is considered the end of the audio event.
Default setting is 20 dB. 30 dB is recommended for extracting bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNR_thr</code></td>
<td>
<p>integer. SNR threshold (dB) at which the extraction of the audio event stops.
Default setting is 10 dB. 8 dB is recommended for bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle_thr</code></td>
<td>
<p>integer. Angle threshold (°) at which the audio event extraction stops.
Default setting is 40°. 125° is recommended for extracting bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration_thr</code></td>
<td>
<p>integer. Maximum duration threshold in milliseconds (ms) after which the monitoring of the background noise is resumed.
Default setting is 80 ms for bat echolocation calls. A higher threshold value is recommended for extracting bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NWS</code></td>
<td>
<p>integer. Length of the time window used for background noise estimation in the recording (ms).
A longer window size is less sensitive to local variations in the background noise.
Default setting is 100 ms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KPE</code></td>
<td>
<p>numeric. Set the Process Error parameter of the Kalman filter.
Default setting is 1e-05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KME</code></td>
<td>
<p>numeric. Set the Measurement Error parameter of the Kalman filter.
Default setting is 1e-05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>settings</code></td>
<td>
<p>logical. <code>TRUE</code> or <code>FALSE</code>. Save on a list the parameters set with the threshold_detection function.
Default setting is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acoustic_feat</code></td>
<td>
<p>logical. <code>TRUE</code> or <code>FALSE</code>. Extracts the acoustic and signal quality parameters from each audio event in a data frame.
The sequences of smoothed amplitude (dB) and frequency (Hz) bins of each audio event, temporal values (in ms)
of the beginning and the end of each audio event are also extracted in separate lists. Default setting is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>logical. <code>TRUE</code> or <code>FALSE</code>. Extracts on a list the metadata embedded with the Wave file
GUANO metadata extraction is not -yet- implemented. Default setting is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectro_dir</code></td>
<td>
<p>character (path) or <code>NULL</code>. Generate an HTML page with the spectrograms numbered by order
of detection in the recording. Spectrograms are generated as individual .PNG files and stored in the
'spectro_dir/spectrograms' subdirectory. The R working directory is used if <code>spectro_dir</code> is <code>NULL</code>.
<code>spectro_dir</code> is set to <code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_scale</code></td>
<td>
<p>numeric. Time resolution of the spectrogram in milliseconds (ms) per pixel (px). Default setting is 0.1 ms for bat echolocation calls.
A default of 2 ms/px is recommended for most bird vocalizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticks</code></td>
<td>
<p>either logical or numeric. If <code>TRUE</code> tickmarks are drawn on the (frequency)
y-axis and their positions are computed automatically. If numeric, sets the
lower and upper limits of the tickmarks and their interval (in Hz). Default setting is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class 'bioacoustics_output'.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(myotis)
Output &lt;- threshold_detection(myotis, time_exp = 10, HPF = 16000, LPF = 200000)
Output$data

</code></pre>


</div>