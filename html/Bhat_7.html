<div class="container">

<table style="width: 100%;"><tr>
<td>global</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random search for a global function minimum</h2>

<h3>Description</h3>

<p>This function generates MCMC samples from a (posterior) density function f
(not necessarily normalized) in search of a global minimum of f.  It uses a
simple Metropolis algorithm to generate the samples.  Global monitors the
mcmc samples and returns the minimum value of f, as well as a sample
covariance (covm) that can be used as input for the Bhat function mymcmc.
</p>


<h3>Usage</h3>

<pre><code class="language-R">global(
  x,
  nlogf,
  beta = 1,
  mc = 1000,
  scl = 2,
  skip = 1,
  nfcn = 0,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list with components 'label' (of mode character), 'est' (the
parameter vector with the initial guess), 'low' (vector with lower bounds),
and 'upp' (vector with upper bounds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlogf</code></td>
<td>
<p>negative log of the density function (not necessarily
normalized)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>'inverse temperature' parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>length of MCMC search run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scl</code></td>
<td>
<p>not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>number of cycles skipped for graphical output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfcn</code></td>
<td>
<p>number of function calls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical variable. If TRUE the chain and the negative log
density (nlogf) is plotted</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>standard output reports a summary of the acceptance fraction, the current
values of nlogf and the parameters for every (100*skip) th cycle. Plotted
chains show values only for every (skip) th cycle.
</p>


<h3>Value</h3>

<p>list with the following components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>fmin </code></td>
<td>
<p> minimum value of
nlogf for the samples obtained </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin </code></td>
<td>
<p> parameter values at fmin </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covm </code></td>
<td>
<p> covariance matrix of differences between consecutive samples
in chain </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is part of the Bhat package
</p>


<h3>Author(s)</h3>

<p>E. Georg Luebeck (FHCRC)
</p>


<h3>References</h3>

<p>too numerous to be listed here
</p>


<h3>See Also</h3>

<p><code>dfp</code>, <code>newton</code>,
<code>logit.hessian</code> <code>mymcmc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# generate some Poisson counts on the fly
  dose &lt;- c(rep(0,50),rep(1,50),rep(5,50),rep(10,50))
  data &lt;- cbind(dose,rpois(200,20*(1+dose*.5*(1-dose*0.05))))

# neg. log-likelihood of Poisson model with 'linear-quadratic' mean: 
  nlogf &lt;- function (x) { 
  ds &lt;- data[, 1]
  y  &lt;- data[, 2]
  g &lt;- x[1] * (1 + ds * x[2] * (1 - x[3] * ds)) 
  return(sum(g - y * log(g)))
  }

# initialize global search
  x &lt;- list(label=c("a","b","c"), est=c(10, 0.25, 0.05), low=c(0,0,0), upp=c(100,10,.1))
# samples from posterior density (~exp(-nlogf))) with non-informative
# (random uniform) priors for "a", "b" and "c".
out &lt;- global(x, nlogf, beta = 1., mc=1000, scl=2, skip=1, nfcn = 0, plot=TRUE)
# start MCMC from some other point: e.g. try x$est &lt;- c(16,.2,.02)

</code></pre>


</div>