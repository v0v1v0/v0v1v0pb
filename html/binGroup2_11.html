<div class="container">

<table style="width: 100%;"><tr>
<td>designPower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Number of groups or group size needed to achieve a power level in
one parameter group testing</h2>

<h3>Description</h3>

<p>For a fixed number of groups (group size), determine the
group size (number of groups) needed to obtain a specified power level to
reject a hypothesis for a proportion in one parameter group testing.
</p>


<h3>Usage</h3>

<pre><code class="language-R">designPower(
  n,
  s,
  fixed = "s",
  delta,
  p.hyp,
  conf.level = 0.95,
  power = 0.8,
  alternative = "two.sided",
  method = "CP",
  biasrest = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer specifying the maximum number of groups <kbd>n</kbd> allowed
when <kbd>fixed="s"</kbd> or the fixed number of groups when <kbd>fixed="n"</kbd>.
When <kbd>fixed="s"</kbd>, a vector of two integers giving the range of <kbd>n</kbd>
which power shall be iterated over is also allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>integer specifying the fixed group size (number of units per group)
when <kbd>fixed="s"</kbd> or the maximum group size allowed in the planning of
the design when <kbd>fixed="n"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>character string specifying whether the number of groups
<kbd>"n"</kbd> or the group size <kbd>"s"</kbd> is to be held at a fixed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the absolute difference between the true proportion and the
hypothesized proportion which shall be detectable with the specified power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.hyp</code></td>
<td>
<p>the proportion in the hypotheses, specified as a value between
0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the decision. The default
confidence level is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>level of power to be achieved, specified as a
probability between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>character string defining the alternative hypothesis,
either <kbd>"two.sided"</kbd>, <kbd>"less"</kbd>, or <kbd>"greater"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string specifying the confidence interval method
(see <code>propCI</code>) to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biasrest</code></td>
<td>
<p>a value between 0 and 1, specifying the absolute bias
maximally allowed for a point estimate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power of a hypothesis test performed by a confidence interval
is defined as the probability that a confidence interval excludes the
threshold parameter (<kbd>p.hyp</kbd>) of the hypothesis.
</p>
<p>When <kbd>fixed="s"</kbd>, this function increases the number of groups until a
pre-specified level of power is reached or the maximum number of groups
<kbd>n</kbd> is reached. Since the power does not increase monotonically with
increasing <kbd>n</kbd> for single proportions but oscillates between local
maxima and minima, the simple iteration given here will generally result in
selecting <kbd>n</kbd> for which the given confidence interval method shows a
local minimum of coverage if the null hypothesis is true. Bias decreases
monotonically with increasing the number of groups (if other parameters are
fixed). The resulting problems of choosing a number of groups which results
in satisfactory power are solved in the following manner:
</p>
<p>In the case that the pre-specified power is reached within the given
range of <kbd>n</kbd>, the smallest <kbd>n</kbd> is returned for which at least
this power is reached, as well as the actual power for this <kbd>n</kbd>.
</p>
<p>In the case that the pre-specified power is not reached within the given
value, that <kbd>n</kbd> is returned for which maximum power is achieved, and
the corresponding value of power.
</p>
<p>In the case that the bias restriction is violated even for the largest
<kbd>n</kbd> within the given range of <kbd>n</kbd>, simply that <kbd>n</kbd> will be
returned for which power was largest in the given range.
</p>
<p>Especially for large <kbd>n</kbd>, the calculation time may become large
(particularly for the Blaker interval). Alternatively, the function
<code>gtPower</code> might be used to calculate power and bias
only for some particular combinations of the input arguments.
</p>
<p>When <kbd>fixed="n"</kbd>, this function increases the size of groups until a
pre-specified level of power is reached. Since the power does not increase
monotonically with increasing <kbd>s</kbd> for single proportions but oscillates
between local maxima and minima, the simple iteration given here will
generally result in selecting <kbd>s</kbd> for which the given confidence
interval method shows a local minimum of coverage if the null hypothesis
is true. Since the positive bias of the estimator in group testing
increases with increasing group size, this function checks whether the bias
is smaller than a pre-specified level (<kbd>bias.rest</kbd>). If the bias violates
this restriction for a given combination <kbd>n</kbd>, <kbd>s</kbd>, and <kbd>delta</kbd>,
<kbd>s</kbd> will not be further increased and the actual power of the last
acceptable group size <kbd>s</kbd> is returned.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nout</code></td>
<td>
<p>the number of groups necessary to reach the power with the
specified parameters, when <kbd>fixed="s"</kbd> only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sout</code></td>
<td>
<p>the group size necessary to meet the conditions, when
<kbd>fixed="n"</kbd> only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powerout</code></td>
<td>
<p>the power for the specified parameters and the selected
number of groups <kbd>n</kbd> when <kbd>fixed="s"</kbd> or the selected group
size <kbd>s</kbd> when <kbd>fixed="n"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biasout</code></td>
<td>
<p>the bias for the specified parameters and the selected
number of groups <kbd>n</kbd> when <kbd>fixed="s"</kbd> or the selected group
size <kbd>s</kbd> when <kbd>fixed="n"</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power.reached</code></td>
<td>
<p>a logical value indicating whether the
specified level of power was reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias.reached</code></td>
<td>
<p>a logical value indicating whether the maximum
allowed bias was reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nit</code></td>
<td>
<p>the number of groups for each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sit</code></td>
<td>
<p>the group size for each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powerit</code></td>
<td>
<p>the power achieved for each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biasit</code></td>
<td>
<p>the bias for each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>the iteration at which the maximum power was reached,
or the total number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.hyp</code></td>
<td>
<p>the hypothesized proportion specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the absolute difference between the true proportion and the
hypothesized proportion specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the desired power specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biasrest</code></td>
<td>
<p>the maximum absolute bias specified by the user.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>The <code>nDesign</code> and <code>sDesign</code> functions were originally
written by Frank Schaarschmidt for the <code>binGroup</code> package. Minor
modifications were made for inclusion in the <code>binGroup2</code> package.
</p>


<h3>References</h3>

<p>Swallow, W. (1985).
“Group testing for estimating infection rates and probabilities of disease transmission.”
<em>Phytopathology</em>, <b>75</b>, 882–889.
</p>


<h3>See Also</h3>

<p><code>gtPower</code> for calculation of power and bias depending
on <kbd>n</kbd>, <kbd>s</kbd>, <kbd>delta</kbd>, <kbd>p.hyp</kbd>, <kbd>conf.level</kbd>,
and <kbd>method</kbd>, and <code>designEst</code> to choose the group size
<kbd>s</kbd> according to the minimal mse of the estimator, as given in
Swallow (1985).
</p>
<p>Other estimation functions: 
<code>designEst()</code>,
<code>gtPower()</code>,
<code>gtTest()</code>,
<code>gtWidth()</code>,
<code>propCI()</code>,
<code>propDiffCI()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Assume the objective is to show that a proportion is
#   smaller than 0.005 (i.e. 0.5 percent) with a power
#   of 0.80 (i.e. 80 percent) if the unknown proportion
#   in the population is 0.003 (i.e. 0.3 percent);
#   thus, a delta of 0.002 shall be detected.
# A 95% Clopper Pearson CI shall be used.
# The maximum group size because of limited sensitivity
#   of the diagnostic test might be s=20 and we can
#   only afford to perform maximally 100 tests:
designPower(n = 100, s = 20, delta = 0.002,
            p.hyp = 0.005, fixed = "s",
            alternative = "less", method = "CP",
            power = 0.8)

# One might accept to detect delta=0.004,
#   i.e. reject H0: p&gt;=0.005 with power 80 percent
#   when the true proportion is 0.001:
designPower(n = 100, s = 20, delta = 0.004, p.hyp = 0.005, fixed = "s",
             alternative = "less", method = "CP", power = 0.8)

# Power for a design with a fixed group size of s = 1
#   (individual testing).
designPower(n = 200, s = 1, delta = 0.05, p.hyp = 0.10,
            fixed = "s", method = "CP", power = 0.80)

# Assume that objective is to show that a proportion
#   is smaller than 0.005 (i.e. 0.5%) with a
#   power of 0.80 (i.e. 80%) if the unknown proportion
#   in the population is 0.003 (i.e. 0.3%); thus, a
#   delta = 0.002 shall be detected.
# A 95% Clopper-Pearson CI shall be used.
# The maximum number of groups might be 30, where the
#   overall sensitivity is not limited until group
#   size s=100.
designPower(s = 100, n = 30, delta = 0.002, p.hyp = 0.005, fixed = "n",
             alternative = "less", method = "CP", power = 0.8)

# One might accept to detect delta=0.004,
#   i.e. reject H0: p&gt;=0.005 with power 80 percent
#   when the true proportion is 0.001:
designPower(s = 100, n = 30, delta = 0.004, p.hyp = 0.005, fixed = "n",
             alternative = "less", method = "CP", power = 0.8)
designPower(s = 100, n = 30, delta = 0.004, p.hyp = 0.005, fixed = "n",
             alternative = "less", method = "score", power = 0.8)
</code></pre>


</div>