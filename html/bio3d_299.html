<div class="container">

<table style="width: 100%;"><tr>
<td>write.pdb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Write PDB Format Coordinate File </h2>

<h3>Description</h3>

<p>Write a Protein Data Bank (PDB) file for a given ‘xyz’
Cartesian coordinate vector or matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.pdb(pdb = NULL, file = "R.pdb", xyz = pdb$xyz, type = NULL, resno = NULL,
 resid = NULL, eleno = NULL, elety = NULL, chain = NULL, insert = NULL, 
 alt = NULL, o = NULL, b = NULL, segid = NULL, elesy = NULL, charge = NULL, 
 append = FALSE, verbose = FALSE, chainter = FALSE, end = TRUE, sse = FALSE, 
 print.segid = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> a PDB structure object obtained from
<code>read.pdb</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p> the output file name. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyz</code></td>
<td>
<p> Cartesian coordinates as a vector or 3xN matrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> vector of record types, i.e. "ATOM" or "HETATM", 
with length equal to length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resno</code></td>
<td>
<p> vector of residue numbers of length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p> vector of residue types/ids of length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eleno</code></td>
<td>
<p> vector of element/atom numbers of length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elety</code></td>
<td>
<p> vector of element/atom types of length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p> vector of chain identifiers with length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insert</code></td>
<td>
<p> vector of insertion code with length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt</code></td>
<td>
<p> vector of alternate record with length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p> vector of occupancy values of length equal to
length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p> vector of B-factors of length equal to length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segid</code></td>
<td>
<p> vector of segment id of length equal to length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elesy</code></td>
<td>
<p> vector of element symbol of length equal to length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>charge</code></td>
<td>
<p> vector of atomic charge of length equal to length(xyz)/3. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p> logical, if TRUE output is appended to the bottom of an
existing file (used primarly for writing multi-model files). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> logical, if TRUE progress details are printed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chainter</code></td>
<td>
<p> logical, if TRUE a TER line is inserted at termination
of a chain. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p> logical, if TRUE END line is written. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sse</code></td>
<td>
<p> logical, if TRUE secondary structure annotations are written. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.segid</code></td>
<td>
<p> logical, if FALSE segid will not be written. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only the <code>xyz</code> argument is strictly required.  Other arguments
assume a default poly-ALA C-alpha structure with a blank chain id,
occupancy values of 1.00 and B-factors equal to 0.00.
</p>
<p>If the input argument <code>xyz</code> is a matrix then each row is assumed
to be a different structure/frame to be written to a
“multimodel” PDB file, with frames separated by “END”
records.
</p>


<h3>Value</h3>

<p>Called for its effect.
</p>


<h3>Note</h3>

<p>Check that:
(1) <code>chain</code> is one character long e.g. “A”, and 
(2) <code>resno</code> and <code>eleno</code> do not exceed “9999”.
</p>


<h3>Author(s)</h3>

<p>Barry Grant
with contributions from Joao Martins.
</p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>
<p>For a description of PDB format (version3.3) see:<br><a href="http://www.wwpdb.org/documentation/format33/v3.3.html">http://www.wwpdb.org/documentation/format33/v3.3.html</a>.
</p>


<h3>See Also</h3>

 <p><code>read.pdb</code>, <code>read.dcd</code>,
<code>read.fasta.pdb</code>, <code>read.fasta</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# PDB server connection required - testing excluded

# Read a PDB file
pdb &lt;- read.pdb( "1bg2" )

# Renumber residues
nums &lt;- as.numeric(pdb$atom[,"resno"])
nums &lt;- nums - (nums[1] - 1)

# Write out renumbered PDB file
outfile = file.path(tempdir(), "eg.pdb")
write.pdb(pdb=pdb, resno = nums, file = outfile)

invisible( cat("\nSee the output file:", outfile, sep = "\n") )

</code></pre>


</div>