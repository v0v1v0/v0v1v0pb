<div class="container">

<table style="width: 100%;"><tr>
<td>next.subtrial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine the starting dose and the dose-searching space for next subtrial in waterfall design</h2>

<h3>Description</h3>

<p>Determine the starting dose and the dose-searching space for next subtrial after
the current subtrial is completed when using the waterfall design
</p>


<h3>Usage</h3>

<pre><code class="language-R">next.subtrial(
  target,
  npts,
  ntox,
  p.saf = 0.6 * target,
  p.tox = 1.4 * target,
  cutoff.eli = 0.95,
  extrasafe = FALSE,
  offset = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npts</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients treated at each dose combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntox</code></td>
<td>
<p>a <code>J*K</code> matrix <code>(J&lt;=K)</code> containing the number of patients who experienced dose-limiting
toxicities at each dose combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.saf</code></td>
<td>
<p>the highest toxicity probability that is deemed subtherapeutic (i.e. below
the MTD) such that dose escalation should be undertaken. The default value
is <code>p.saf=0.6*target</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.tox</code></td>
<td>
<p>the lowest toxicity probability that is deemed overly toxic such that
deescalation is required. The default value is <code>p.tox=1.4*target</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate an overly toxic dose for safety. We recommend
the default value of (<code>cutoff.eli=0.95</code>) for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrasafe</code></td>
<td>
<p>set <code>extrasafe=TRUE</code> to impose a more stringent stopping rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>a small positive number (between 0 and 0.5) to control how strict the
stopping rule is when <code>extrasafe=TRUE</code>. A larger value leads to a
more strict stopping rule. The default value <code>offset=0.05</code> generally
works well.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the waterfall design, this function is used to obtain the starting dose and
dose-searching space for the next subtrial when the current subtrial is completed.
The input data include: the number of patients treated at each dose combination
(i.e., <code>npts</code>), the number of patients who experienced dose-limiting
toxicities at each dose combination (i.e., <code>ntox</code>).
</p>


<h3>Value</h3>

<p><code>next.subtrial()</code> returns a list object, containing the starting dose
(<code>$starting_dose</code>) and the dose-searching space for the the next subtrial
(<code>$next_subtrial</code>).
</p>


<h3>Author(s)</h3>

<p>Suyu Liu, Liangcai Zhang and Ying Yuan
</p>


<h3>References</h3>

<p>Liu S. and Yuan, Y. (2015). Bayesian Optimal Interval Designs for Phase I Clinical
Trials, <em>Journal of the Royal Statistical Society: Series C</em>, 64, 507-523.
</p>
<p>Lin R. and Yin, G. (2017). Bayesian Optimal Interval Designs for Dose Finding in
Drug-combination Trials, <em>Statistical Methods in Medical Research</em>, 26, 2155-2167.
</p>
<p>Yan, F., Zhang, L., Zhou, Y., Pan, H., Liu, S. and Yuan, Y. (2020).BOIN: An R Package
for Designing Single-Agent and Drug-Combination Dose-Finding Trials Using Bayesian Optimal
Interval Designs. <em>Journal of Statistical Software</em>, 94(13),1-32.&lt;doi:10.18637/jss.v094.i13&gt;.
</p>
<p>Zhang L. and Yuan, Y. (2016). A Simple Bayesian Design to Identify the Maximum
Tolerated Dose Contour for Drug Combination Trials, <em>Statistics in Medicine</em>, 35, 4924-4936.
</p>


<h3>See Also</h3>

<p>Tutorial: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/BOIN2.6_tutorial.pdf</a>
</p>
<p>Paper: <a href="http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf">http://odin.mdacc.tmc.edu/~yyuan/Software/BOIN/paper.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## determine the starting dose and dose searching space for next subtrial
n &lt;- matrix(c(6, 0, 0, 0,
           6, 10, 12, 0,
           9, 12, 0, 0), ncol=4, byrow=TRUE)
y &lt;- matrix(c(0, 0, 0, 0,
            1, 1, 4, 0,
            2, 3, 0, 0), ncol=4, byrow=TRUE)
nxt.trial &lt;- next.subtrial(target=0.3, npts=n, ntox=y)
summary(nxt.trial)

</code></pre>


</div>