<div class="container">

<table style="width: 100%;"><tr>
<td>bcorsis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ball Correlation based Sure Independence Screening (BCor-SIS)</h2>

<h3>Description</h3>

<p>Generic non-parametric sure independence screening (SIS) procedure based on Ball Correlation.
Ball correlation is a generic measure of dependence in Banach spaces.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcorsis(
  x,
  y,
  d = "small",
  weight = c("constant", "probability", "chisquare"),
  method = "standard",
  distance = FALSE,
  category = FALSE,
  parms = list(d1 = 5, d2 = 5, df = 3),
  num.threads = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix or data.frame included <code class="reqn">n</code> rows and <code class="reqn">p</code> columns. 
Each row is an observation vector and each column corresponding to a explanatory variable, generally <code class="reqn">p &gt;&gt; n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector, matrix, or data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the hard cutoff rule suggests selecting <code class="reqn">d</code> variables. Setting <code>d = "large"</code> or 
<code>d = "small"</code> means <code>n - 1</code> or <code>floor(n/log(n))</code> 
variables are selected. If <code>d</code> is a integer, <code>d</code> variables are selected. Default: <code>d = "small"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a logical or character string used to choose the weight form of Ball Covariance statistic.. 
If input is a character string, it must be one of <code>"constant"</code>, <code>"probability"</code>, or <code>"chisquare"</code>. 
Any unambiguous substring can be given. 
If input is a logical value, it is equivalent to <code>weight = "probability"</code> if <code>weight = TRUE</code> while 
equivalent to <code>weight = "constant"</code> if <code>weight = FALSE</code>.
Default: <code>weight = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>specific method for the BCor-SIS procedure. It must be one of <code>"standard"</code>,
<code>"lm"</code>, <code>"gam"</code>, <code>"interaction"</code>, or <code>"survival"</code>.
Setting <code>method = "standard"</code> means performing standard SIS procedure 
while the options <code>"lm"</code> and <code>"gam"</code> mean carrying out iterative SIS procedure with ordinary 
linear regression and generalized additive models, respectively.
The options <code>"interaction"</code> and <code>"survival"</code> are designed for detecting variables 
with potential linear interaction and associated with left censored responses, respectively. 
Any unambiguous substring can be given. Default: <code>method = "standard"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>if <code>distance = TRUE</code>, <code>y</code> will be considered as a distance matrix. 
Arguments only available when <code>method = "standard"</code> and <code>method = "interaction"</code>. Default: <code>distance = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>category</code></td>
<td>
<p>a logical value or integer vector indicating columns to be selected as categorical variables.
If <code>category</code> is an integer vector, the positive/negative integers select/discard the corresponding columns;
If <code>category</code> is a logical value, <code>category = TRUE</code> select all columns, <code>category = FALSE</code> select none column.
Default: <code>category = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>parameters list only available when <code>method = "lm"</code> or <code>"gam"</code>. 
It contains three parameters: <code>d1</code>, <code>d2</code>, and <code>df</code>. <code>d1</code> is the
number of initially selected variables, <code>d2</code> is the number of variables added in each iteration.
<code>df</code> is a degree freedom of basis in generalized additive models playing a role only when <code>method = "gam"</code>. 
Default: <code>parms = list(d1 = 5, d2 = 5, df = 3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.threads</code></td>
<td>
<p>number of threads. If <code>num.threads = 0</code>, then all of available cores will be used. Default <code>num.threads = 0</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bcorsis</code> performs a model-free generic sure independence screening procedure, 
BCor-SIS, to pick out variables from <code>x</code> which are potentially associated with <code>y</code>. 
BCor-SIS relies on Ball correlation, a universal dependence measure in Banach spaces.
Ball correlation (BCor) ranges from 0 to 1. A larger BCor implies they are likely to be associated while 
Bcor is equal to 0 implies they are unassociated. (See <code>bcor</code> for details.)
Consequently, BCor-SIS pick out variables with larger Bcor values with <code>y</code>.
</p>
<p>Theory and numerical result indicate that BCor-SIS has following advantages:
</p>

<ul>
<li>
<p> BCor-SIS can retain the efficient variables even when the dimensionality (i.e., <code>ncol(x)</code>) is 
an exponential order of the sample size (i.e., <code>exp(nrow(x))</code>);
</p>
</li>
<li>
<p> It is distribution-free and model-free;
</p>
</li>
<li>
<p> It is very robust;
</p>
</li>
<li>
<p> It is works well for complex data, such as shape and survival data;
</p>
</li>
</ul>
<p>If <code>x</code> is a matrix, the sample sizes of <code>x</code> and <code>y</code> must agree.
If <code>x</code> is a <code>list</code> object, each element of this <code>list</code> must with the same sample size.
<code>x</code> and <code>y</code> must not contain missing or infinite values. 
</p>
<p>When <code>method = "survival"</code>, the matrix or data.frame pass to <code>y</code> must have exactly two columns, where the first column is 
event (failure) time while the second column is a dichotomous censored status.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ix </code></td>
<td>
<p> the indices vector corresponding to variables selected by BCor-SIS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p> the method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight </code></td>
<td>
<p> the weight used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.info </code></td>
<td>
<p> a <code>list</code> mainly containing a <code class="reqn">p \times 3</code> matrix, 
where each row is a variable and each column is a weight Ball Correlation statistic. 
If <code>method = "gam"</code> or <code>method = "lm"</code>, <code>complete.info</code> is an empty list.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>bcorsis</code> simultaneously computing Ball Correlation statistics with 
<code>"constant"</code>, <code>"probability"</code>, and <code>"chisquare"</code> weights.
Users can get other Ball Correlation statistics with different weight in the <code>complete.info</code> element of output. 
We give a quick example below to illustrate.
</p>


<h3>Author(s)</h3>

<p>Wenliang Pan, Weinan Xiao, Xueqin Wang, Hongtu Zhu, Jin Zhu
</p>


<h3>References</h3>

<p>Wenliang Pan, Xueqin Wang, Weinan Xiao &amp; Hongtu Zhu (2018) A Generic Sure Independence Screening Procedure, Journal of the American Statistical Association, DOI: 10.1080/01621459.2018.1462709
</p>


<h3>See Also</h3>

<p><code>bcor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

############### Quick Start for bcorsis function ###############
set.seed(1)
n &lt;- 150
p &lt;- 3000
x &lt;- matrix(rnorm(n * p), nrow = n)
eps &lt;- rnorm(n)
y &lt;- 3 * x[, 1] + 5 * (x[, 3])^2 + eps
res &lt;- bcorsis(y = y, x = x)
head(res[["ix"]])
head(res[["complete.info"]][["statistic"]])

############### BCor-SIS: Censored Data Example ###############
data("genlung")
result &lt;- bcorsis(x = genlung[["covariate"]], y = genlung[["survival"]], 
                  method = "survival")
index &lt;- result[["ix"]]
top_gene &lt;- colnames(genlung[["covariate"]])[index]
head(top_gene, n = 1)


############### BCor-SIS: Interaction Pursuing ###############
set.seed(1)
n &lt;- 150
p &lt;- 3000
x &lt;- matrix(rnorm(n * p), nrow = n)
eps &lt;- rnorm(n)
y &lt;- 3 * x[, 1] * x[, 5] * x[, 10] + eps
res &lt;- bcorsis(y = y, x = x, method = "interaction")
head(res[["ix"]])

############### BCor-SIS: Iterative Method ###############
library(mvtnorm)
set.seed(1)
n &lt;- 150
p &lt;- 3000
sigma_mat &lt;- matrix(0.5, nrow = p, ncol = p)
diag(sigma_mat) &lt;- 1
x &lt;- rmvnorm(n = n, sigma = sigma_mat)
eps &lt;- rnorm(n)
rm(sigma_mat); gc(reset = TRUE)
y &lt;- 3 * (x[, 1])^2 + 5 * (x[, 2])^2 + 5 * x[, 8] - 8 * x[, 16] + eps
res &lt;- bcorsis(y = y, x = x, method = "lm", d = 15)
res &lt;- bcorsis(y = y, x = x, method = "gam", d = 15)
res[["ix"]]

############### Weighted BCor-SIS: Probability weight ###############
set.seed(1)
n &lt;- 150
p &lt;- 3000
x &lt;- matrix(rnorm(n * p), nrow = n)
eps &lt;- rnorm(n)
y &lt;- 3 * x[, 1] + 5 * (x[, 3])^2 + eps
res &lt;- bcorsis(y = y, x = x, weight = "prob")
head(res[["ix"]])
# Alternative, chisq weight:
res &lt;- bcorsis(y = y, x = x, weight = "chisq")
head(res[["ix"]])

############### BCor-SIS: GWAS data ###############
set.seed(1)
n &lt;- 150
p &lt;- 3000
x &lt;- sapply(1:p, function(i) {
  sample(0:2, size = n, replace = TRUE)
})
eps &lt;- rnorm(n)
y &lt;- 6 * x[, 1] - 7 * x[, 2] + 5 * x[, 3] + eps
res &lt;- bcorsis(x = x, y = y, category = TRUE)
head(res[["ix"]])
head(res[["complete.info"]][["statistic"]])

x &lt;- cbind(matrix(rnorm(n * 2), ncol = 2), x)
# remove the first two columns:
res &lt;- bcorsis(x = x, y = y, category = c(-1, -2))
head(res[["ix"]])

x &lt;- cbind(x[, 3:5], matrix(rnorm(n * p), ncol = p))
res &lt;- bcorsis(x = x, y = y, category = 1:3)
head(res[["ix"]], n = 10)

## End(Not run)
</code></pre>


</div>