<div class="container">

<table style="width: 100%;"><tr>
<td>brnb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bias reduction for negative binomial regression models</h2>

<h3>Description</h3>

<p><code>brnb()</code> is a function that fits negative binomial regression
models using implicit and explicit bias reduction methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brnb(
  formula,
  data,
  subset,
  weights = NULL,
  offset = NULL,
  link = "log",
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  control = list(...),
  na.action,
  model = TRUE,
  x = FALSE,
  y = TRUE,
  contrasts = NULL,
  intercept = TRUE,
  singular.ok = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>"formula"</code> (or one that
can be coerced to that class): a symbolic description of the
model to be fitted.  The details of model specification are given
under ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing
the variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>glm</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of ‘prior weights’ to be used
in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.
This should be <code>NULL</code> or a numeric vector of length equal to
the number of cases.  One or more <code>offset</code> terms can be
included in the formula instead or as well, and if more than one is
specified their sum is used.  See <code>model.offset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>The link function. Currently must be one of <code>"log"</code>,
<code>"sqrt"</code> or <code>"identity"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values for the parameters in the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>
<p>starting values for the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>
<p>starting values for the vector of means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of parameters for controlling the fitting
process. See <code>brglmControl()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code>options</code>, and is
<code>na.fail</code> if that is unset.  The ‘factory-fresh’
default is <code>na.omit</code>.  Another possible value is
<code>NULL</code>, no action.  Value <code>na.exclude</code> can be useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a logical value indicating whether <em>model frame</em>
should be included as a component of the returned value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>For <code>glm</code>:
logical values indicating whether the response vector and model
matrix used in the fitting process should be returned as components
of the returned value.
</p>
<p>For <code>glm.fit</code>: <code>x</code> is a design matrix of dimension
<code>n * p</code>, and <code>y</code> is a vector of observations of length
<code>n</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical. Should an intercept be included in the
<em>null</em> model?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>logical; if <code>FALSE</code> a singular fit is an
error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For <code>glm</code>: arguments to be used to form the default
<code>control</code> argument if it is not supplied directly.
</p>
<p>For <code>weights</code>: further arguments passed to or from other methods.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A detailed description of the fitting procedure is given in the
iteration vignette (see, <code>vignette("iteration", "brglm2")</code> and
Kosmidis et al, 2020). The number of iterations when estimating
parameters are controlled by the <code>maxit</code> argument of
<code>brglmControl()</code>.
</p>
<p>The type of score adjustment to be used is specified through the
<code>type</code> argument (see <code>brglmControl()</code> for details).
</p>
<p>The available options are:
</p>

<ul>
<li> <p><code>type = "AS_mixed"</code>: the mixed bias-reducing score
adjustments in Kosmidis et al (2020) that result in mean bias
reduction for the regression parameters and median bias reduction
for the dispersion parameter, if any; default.
</p>
</li>
<li> <p><code>type = "AS_mean"</code>: the mean bias-reducing score
adjustments in Firth (1993) and Kosmidis &amp; Firth (2009).
</p>
</li>
<li> <p><code>type = "AS_median"</code>: the median bias-reducing score
adjustments in Kenne Pagui et al. (2017)
</p>
</li>
<li> <p><code>type = "MPL_Jeffreys"</code>: maximum penalized likelihood
with powers of the Jeffreys prior as penalty.
</p>
</li>
<li> <p><code>type = "ML"</code>: maximum likelihood.
</p>
</li>
<li> <p><code>type = "correction"</code>: asymptotic bias correction, as in
Cordeiro &amp; McCullagh (1991).
</p>
</li>
</ul>
<p>The choice of the parameterization for the dispersion is controlled
by the <code>transformation</code> argument (see <code>brglmControl()</code> for
details).  The default is <code>"identity"</code>. Using <code>transformation = "inverse"</code> uses the dispersion parameterization that
<code>MASS::glm.nb()</code> uses.
</p>


<h3>Value</h3>

<p>A fitted model object of class <code>"brnb"</code> inheriting
from <code>"negbin"</code> and <code>"brglmFit"</code>. The
object is similar to the output of <code>brglmFit()</code> but contains
four additional components: <code>theta</code> for the maximum likelihood
estimate of the dispersion parameter as in <code>MASS::glm.nb()</code>,
<code>vcov.mean</code> for the estimated variance-covariance matrix of the
regression coefficients, <code>vcov.dispersion</code> for the estimated
variance of the dispersion parameter in the chosen
parameterization (using the expected information), and
<code>twologlik</code> for twice the log-likelihood function.
</p>


<h3>Author(s)</h3>

<p>Euloge Clovis Kenne Pagui <code style="white-space: pre;">⁠[aut]⁠</code> <a href="mailto:kenne@stat.unipd.it">kenne@stat.unipd.it</a>, Ioannis Kosmidis <code style="white-space: pre;">⁠[aut, cre]⁠</code> <a href="mailto:ioannis.kosmidis@warwick.ac.uk">ioannis.kosmidis@warwick.ac.uk</a>
</p>


<h3>References</h3>

<p>Cordeiro G M, McCullagh P (1991). Bias correction in generalized
linear models. <em>Journal of the Royal Statistical Society. Series B
(Methodological)</em>, <strong>53</strong>, 629-643. <a href="https://doi.org/10.1111/j.2517-6161.1991.tb01852.x">doi:10.1111/j.2517-6161.1991.tb01852.x</a>.
</p>
<p>Firth D (1993). Bias reduction of maximum likelihood estimates.
<em>Biometrika</em>. <strong>80</strong>, 27-38. <a href="https://doi.org/10.2307/2336755">doi:10.2307/2336755</a>.
</p>
<p>Kenne Pagui E C, Salvan A, Sartori N (2017). Median bias
reduction of maximum likelihood estimates. <em>Biometrika</em>, <strong>104</strong>,
923–938. <a href="https://doi.org/10.1093/biomet/asx046">doi:10.1093/biomet/asx046</a>.
</p>
<p>Kosmidis I, Kenne Pagui E C, Sartori N (2020). Mean and median bias
reduction in generalized linear models. <em>Statistics and Computing</em>,
<strong>30</strong>, 43-59. <a href="https://doi.org/10.1007/s11222-019-09860-6">doi:10.1007/s11222-019-09860-6</a>.
</p>
<p>Kosmidis I, Firth D (2009). Bias reduction in exponential family
nonlinear models. <em>Biometrika</em>, <strong>96</strong>, 793-804. <a href="https://doi.org/10.1093/biomet/asp055">doi:10.1093/biomet/asp055</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example in Saha, K., &amp; Paul, S. (2005). Bias-corrected maximum
## likelihood estimator of the negative binomial dispersion
## parameter.  Biometrics, 61, 179--185.
#
# Number of revertant colonies of salmonella data
salmonella &lt;- data.frame(freq = c(15, 16, 16, 27, 33, 20,
                                  21, 18, 26, 41, 38, 27,
                                  29, 21, 33, 60, 41, 42),
                         dose = rep(c(0, 10, 33, 100, 333, 1000), 3),
                         observation = rep(1:3, each = 6))

# Maximum likelihood fit with glm.nb of MASS
salmonella_fm &lt;- freq ~ dose + log(dose + 10)
fitML_glmnb &lt;- MASS::glm.nb(salmonella_fm, data = salmonella)

# Maximum likelihood fit with brnb
fitML &lt;- brnb(salmonella_fm, data = salmonella,
              link = "log", transformation = "inverse", type = "ML")

# Mean bias-reduced fit
fitBR_mean &lt;- update(fitML, type = "AS_mean")

# Median bias-reduced fit
fitBR_median &lt;- update(fitML, type = "AS_median")

# Mixed bias-reduced fit
fitBR_mixed &lt;- update(fitML, type = "AS_mixed")

# Mean bias-corrected fit
fitBC_mean &lt;- update(fitML, type = "correction")

# Penalized likelihood with Jeffreys-prior penalty
fit_Jeffreys &lt;- update(fitML, type = "MPL_Jeffreys")

# The parameter estimates from glm.nb and brnb with type = "ML" are
# numerically the same
all.equal(c(coef(fitML_glmnb), fitML_glmnb$theta),
            coef(fitML, model = "full"), check.attributes = FALSE)

# Because of the invariance properties of the maximum likelihood,
# median reduced-bias, and mixed reduced-bias estimators the
# estimate of a monotone function of the dispersion should be
# (numerically) the same as the function of the estimate of the
# dispersion:

# ML
coef(fitML, model = "dispersion")
1 / coef(update(fitML, transformation = "identity"), model = "dispersion")

# Median BR
coef(fitBR_median, model = "dispersion")
1 / coef(update(fitBR_median, transformation = "identity"), model = "dispersion")

# Mixed BR
coef(fitBR_mixed, model = "dispersion")
1 / coef(update(fitBR_mixed, transformation = "identity"), model = "dispersion")

## The same is not true for mean BR
coef(fitBR_mean, model = "dispersion")
1 / coef(update(fitBR_mean, transformation = "identity"), model = "dispersion")


## An example  from Venables &amp; Ripley (2002, p.169).
data("quine", package = "MASS")
quineML &lt;- brnb(Days ~ Sex/(Age + Eth*Lrn), link = "sqrt", transformation="inverse",
                data = quine, type="ML")
quineBR_mean &lt;- update(quineML, type = "AS_mean")
quineBR_median &lt;- update(quineML, type = "AS_median")
quineBR_mixed &lt;- update(quineML, type = "AS_mixed")
quine_Jeffreys &lt;- update(quineML, type = "MPL_Jeffreys")

fits &lt;- list(ML = quineML,
             AS_mean = quineBR_mean,
             AS_median = quineBR_median,
             AS_mixed = quineBR_mixed,
             MPL_Jeffreys = quine_Jeffreys)
sapply(fits, coef, model = "full")


</code></pre>


</div>