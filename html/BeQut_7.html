<div class="container">

<table style="width: 100%;"><tr>
<td>qrjm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>qrjm</code> fits quantile regression joint model</h2>

<h3>Description</h3>

<p>Function using 'JAGS' software via <code>jagsUI</code> package to estimate the quantile regression joint model assuming asymmetric Laplace distribution for residual error.
Joint modeling concerns longitudinal data and time-to-event
</p>


<h3>Usage</h3>

<pre><code class="language-R">qrjm(
  formFixed,
  formRandom,
  formGroup,
  formSurv,
  survMod = "weibull",
  param = "value",
  timeVar,
  data,
  tau,
  RE_ind = FALSE,
  n.chains = 3,
  n.iter = 10000,
  n.burnin = 5000,
  n.thin = 1,
  n.adapt = 5000,
  precision = 10,
  C = 1000,
  save_jagsUI = TRUE,
  save_va = FALSE,
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formFixed</code></td>
<td>
<p>formula for fixed part of longitudinal submodel with response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formRandom</code></td>
<td>
<p>formula for random part of longitudinal submodel without response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formGroup</code></td>
<td>
<p>formula specifying the cluster variable (e.g. = ~ subject)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formSurv</code></td>
<td>
<p>survival formula as formula in survival package for latency submodel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survMod</code></td>
<td>
<p>specifying the baseline risk function for Cox proportional hazard model (only "weibull" is available until now)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>shared association including in joint modeling: the classical shared random effects or the current value denoting by "sharedRE" (default) or "value", respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeVar</code></td>
<td>
<p>string specify the names of time variable (time of repeated measurements)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataset of observed variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the quantile(s) to be estimated. This must be a number between 0 and 1, otherwise the execution is stopped. If more than one quantile is specified, rounding off to the 4th decimal must give nonâ€“duplicated values of <code>tau</code>, otherwise the execution is stopped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RE_ind</code></td>
<td>
<p>Boolean denoting if the random effects are assumed independent ; default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.chains</code></td>
<td>
<p>the number of parallel chains for the model; default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>integer specifying the total number of iterations; default is 10000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.burnin</code></td>
<td>
<p>integer specifying how many of <code>n.iter</code> to discard as burn-in ; default is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>integer specifying the thinning of the chains; default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.adapt</code></td>
<td>
<p>integer specifying the number of iterations to use for adaptation; default is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>variance by default for vague prior distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>value used in the zero trick; default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_jagsUI</code></td>
<td>
<p>If <code>TRUE</code> (by default), the output of <code>jagsUI</code> package is returned by the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_va</code></td>
<td>
<p>If <code>TRUE</code> (is <code>FALSE</code> by default), the draws of auxiliary variable W is returned by the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>see <code>jagsUI::jags()</code> function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>Bqrjm</code> object is a list with the following elements:
</p>

<dl>
<dt><code>mean</code></dt>
<dd>
<p>list of posterior mean for each parameter</p>
</dd>
<dt><code>median</code></dt>
<dd>
<p>list of posterior median for each parameter</p>
</dd>
<dt><code>modes</code></dt>
<dd>
<p>list of posterior mode for each parameter</p>
</dd>
<dt><code>StErr</code></dt>
<dd>
<p>list of standard error for each parameter</p>
</dd>
<dt><code>StDev</code></dt>
<dd>
<p>list of standard deviation for each parameter</p>
</dd>
<dt><code>ICs</code></dt>
<dd>
<p>list of the credibility interval at 0.95 for each parameters excepted for covariance parameters in covariance matrix of random effects. Otherwise, use save_jagsUI=TRUE to have the associated quantiles.</p>
</dd>
<dt><code>data</code></dt>
<dd>
<p>data included in argument</p>
</dd>
<dt><code>sims.list</code></dt>
<dd>
<p>list of the MCMC chains of the parameters and random effects</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>list of arguments giving details about the estimation</p>
</dd>
<dt><code>random_effect</code></dt>
<dd>
<p>list for each quantile including both posterior mean and posterior standard deviation of subject-specific random effects</p>
</dd>
<dt><code>out_jagsUI</code></dt>
<dd>
<p>only if <code>save_jagsUI=TRUE</code> in argument: list including posterior mean, median, quantiles (2.5%, 25%, 50%, 75%, 97.5%), standart deviation for each parameter and each random effect.
Moreover, this list also returns the MCMC draws, the Gelman and Rubin diagnostics (see output of jagsUI objects)</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Antoine Barbieri
</p>


<h3>References</h3>

<p>Ming Yang, Sheng Luo, and Stacia DeSantis (2019).
<em>Bayesian quantile regression joint models: Inference and dynamic predictions</em>.
Statistical Methods in Medical Research, 28(8):2524-2537. doi: 10.1177/0962280218784757.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

#---- load data
data(dataLong)

#---- Fit quantile regression joint model for the first quartile
qrjm_75 &lt;- qrjm(formFixed = y ~ visit,
               formRandom = ~ visit,
               formGroup = ~ ID,
               formSurv = Surv(time, event) ~ X1 + X2,
               survMod = "weibull",
               param = "value",
               timeVar= "visit",
               data = dataLong,
               tau = 0.75)

#---- Visualize the trace for beta parameters
jagsUI::traceplot(qrjm_75$out_jagsUI, parameters = "beta")

#---- Get the estimated coefficients: posterior means
qrjm_75$mean

#---- Summary of output
summary(qrjm_75)


</code></pre>


</div>