<div class="container">

<table style="width: 100%;"><tr>
<td>BiasedUrn-Univariate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Biased urn models: Univariate distributions</h2>

<h3>Description</h3>

<p>Statistical models of biased sampling in the form of noncentral 
hypergeometric distributions, 
including Wallenius' noncentral hypergeometric distribution and
Fisher's noncentral hypergeometric distribution 
(also called extended hypergeometric distribution).
</p>
<p>These are distributions that you can get when taking colored balls
from an urn without replacement, with bias.  
The univariate distributions are used when there are two colors of balls.  
The multivariate distributions are used when there are more 
than two colors of balls.
</p>
<p>Please see <code>vignette("UrnTheory")</code>
for a definition of these distributions and how
to decide which distribution to use in a specific case.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dWNCHypergeo(x, m1, m2, n, odds, precision=1E-7)
dFNCHypergeo(x, m1, m2, n, odds, precision=1E-7)
pWNCHypergeo(x, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
pFNCHypergeo(x, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
qWNCHypergeo(p, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
qFNCHypergeo(p, m1, m2, n, odds, precision=1E-7, lower.tail=TRUE)
rWNCHypergeo(nran, m1, m2, n, odds, precision=1E-7)
rFNCHypergeo(nran, m1, m2, n, odds, precision=1E-7)
meanWNCHypergeo(m1, m2, n, odds, precision=1E-7)
meanFNCHypergeo(m1, m2, n, odds, precision=1E-7)
varWNCHypergeo(m1, m2, n, odds, precision=1E-7)
varFNCHypergeo(m1, m2, n, odds, precision=1E-7)
modeWNCHypergeo(m1, m2, n, odds, precision=1E-7)
modeFNCHypergeo(m1, m2, n, odds, precision=0)
oddsWNCHypergeo(mu, m1, m2, n, precision=0.1)
oddsFNCHypergeo(mu, m1, m2, n, precision=0.1)
numWNCHypergeo(mu, n, N, odds, precision=0.1)
numFNCHypergeo(mu, n, N, odds, precision=0.1)
minHypergeo(m1, m2, n)
maxHypergeo(m1, m2, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Number of red balls sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>Initial number of red balls in the urn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>Initial number of white balls in the urn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Total number of balls sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Total number of balls in urn before sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odds</code></td>
<td>
<p>Probability ratio of red over white balls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Cumulative probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nran</code></td>
<td>
<p>Number of random variates to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Mean x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>Desired precision of calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>if TRUE (default), probabilities are
<code class="reqn">P(X \le x)</code>, otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Allowed parameter values</b> <br>
All parameters must be non-negative.  <code>n</code> cannot exceed <code>N = m1 + m2</code>.  
The code has been tested with odds in the range 
<code class="reqn">10^{-9} \ldots 10^9</code> and zero.  The code may work with odds
outside this range, but errors or NAN can occur for extreme values of odds.
A ball with odds = 0 is equivalent to no ball.  
<code>mu</code> must be within the possible range of <code>x</code>.
</p>
<p><b>Calculation time</b> <br>
The calculation time depends on the specified precision.
</p>


<h3>Value</h3>

<p><code>dWNCHypergeo</code> and <code>dFNCHypergeo</code> return the probability mass function for
Wallenius' and Fisher's noncentral hypergeometric distribution, respectively.  
A single value is returned if <code>x</code> is a scalar.  
Multiple values are returned if <code>x</code> is a vector.
<br></p>
<p><code>pWNCHypergeo</code> and <code>pFNCHypergeo</code> return the 
cumulative probability function for
Wallenius' and Fisher's noncentral hypergeometric distribution, respectively.  
A single value is returned if <code>x</code> is a scalar.  
Multiple values are returned if <code>x</code> is a vector.
<br></p>
<p><code>qWNCHypergeo</code> and <code>qFNCHypergeo</code> return the quantile function for
Wallenius' and Fisher's noncentral hypergeometric distribution, respectively.  
A single value is returned if <code>p</code> is a scalar.  
Multiple values are returned if <code>p</code> is a vector.
<br></p>
<p><code>rWNCHypergeo</code> and <code>rFNCHypergeo</code> return 
random variates with Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.
<br></p>
<p><code>meanWNCHypergeo</code> and <code>meanFNCHypergeo</code> calculate the mean
of Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  A simple and fast approximation is used when 
<code class="reqn">precision \geq 0.1</code>.
<br></p>
<p><code>varWNCHypergeo</code> and <code>varFNCHypergeo</code> calculate the variance
of Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.  A simple and fast approximation is used when 
<code class="reqn">precision \geq 0.1</code>.
<br></p>
<p><code>modeWNCHypergeo</code> and <code>modeFNCHypergeo</code> calculate the mode
of Wallenius' and Fisher's noncentral hypergeometric 
distribution, respectively.
<br></p>
<p><code>oddsWNCHypergeo</code> and <code>oddsFNCHypergeo</code> estimate the odds
of Wallenius' and Fisher's noncentral hypergeometric 
distribution from a measured mean.
A single value is returned if <code>mu</code> is a scalar.  
Multiple values are returned if <code>mu</code> is a vector.  
A simple and fast approximation is used regardless of the specified precision.  
Exact calculation is not supported.  
See <code>demo(OddsPrecision)</code>.
<br></p>
<p><code>numWNCHypergeo</code> and <code>numFNCHypergeo</code> estimate the 
number of balls of each color in the urn before sampling from
an experimental mean and a known odds ratio for
Wallenius' and Fisher's noncentral hypergeometric distributions.  
The returned numbers <code>m1</code> and <code>m2</code> are not integers.  
A vector of <code>m1</code> and <code>m2</code> is returned if <code>mu</code> is a scalar.  
A matrix is returned if <code>mu</code> is a vector.
A simple approximation is used regardless of the specified precision.  
Exact calculation is not supported.  
The precision of calculation is indicated by <code>demo(OddsPrecision)</code>.  
<br></p>
<p><code>minHypergeo</code> and <code>maxHypergeo</code> calculate the 
minimum and maximum value of <code>x</code>.  The value is valid for 
Wallenius' and Fisher's noncentral hypergeometric distribution
as well as for the (central) hypergeometric distribution.
</p>


<h3>References</h3>

<p><a href="https://www.agner.org/random/">https://www.agner.org/random/</a>
</p>
<p>Fog, A. 2008a. Calculation methods for Wallenius’ noncentral hypergeometric distribution.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790269">doi:10.1080/03610910701790269</a>
</p>
<p>Fog, A. 2008b. Sampling methods for Wallenius’ and Fisher’s noncentral hypergeometric distributions.  <em>Communications in Statistics—Simulation and Computation</em> <b>37</b>, 2 <a href="https://doi.org/10.1080/03610910701790236">doi:10.1080/03610910701790236</a>
</p>


<h3>See Also</h3>

<p><code>vignette("UrnTheory")</code>
<br><code>BiasedUrn-Multivariate</code>.
<br><code>BiasedUrn</code>.
<br><code>fisher.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># get probability
dWNCHypergeo(12, 25, 32, 20, 2.5)
</code></pre>


</div>