<div class="container">

<table style="width: 100%;"><tr>
<td>quantregOR2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian quantile regression in the OR2 model</h2>

<h3>Description</h3>

<p>This function estimates Bayesian quantile regression in the OR2 model (ordinal quantile model with
exactly 3 outcomes) and reports the posterior mean, posterior standard deviation, 95
percent posterior credible intervals and inefficiency factor of <code class="reqn">(\beta, \sigma)</code>. The output also displays the log of
marginal likelihood and the DIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quantregOR2(y, x, b0, B0 , n0, d0, gammacp2, burn, mcmc, p, accutoff, maxlags, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed ordinal outcomes, column vector of size <code class="reqn">(n x 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate matrix of size <code class="reqn">(n x k)</code> including a column of ones with or without column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>prior mean for <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>
<p>prior covariance matrix for <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>prior shape parameter of the inverse-gamma distribution for <code class="reqn">\sigma</code>, default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0</code></td>
<td>
<p>prior scale parameter of the inverse-gamma distribution for <code class="reqn">\sigma</code>, default is 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammacp2</code></td>
<td>
<p>one and only cut-point other than 0, default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>number of burn-in MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>number of MCMC iterations, post burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>quantile level or skewness parameter, p in (0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accutoff</code></td>
<td>
<p>autocorrelation cut-off to identify the number of lags and form batches to compute the inefficiency factor, default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlags</code></td>
<td>
<p>maximum lag at which to calculate the acf in inefficiency factor calculation, default is 400.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether to print the final output and provide additional information or not, default is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates Bayesian quantile regression for the
OR2 model using a Gibbs sampling procedure. The function takes the prior distributions
and other information as inputs and then iteratively samples <code class="reqn">\beta</code>, <code class="reqn">\sigma</code>,
latent weight <code class="reqn">\nu</code>, and latent variable z from their respective
conditional distributions.
</p>
<p>The function also provides the logarithm of marginal likelihood and the DIC. These
quantities can be utilized to compare two or more competing models at the same quantile.
The model with a higher (lower) log marginal likelihood (DIC) provides a
better model fit.
</p>


<h3>Value</h3>

<p>Returns a bqrorOR2 object with components
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>summary</code>: </td>
<td>
<p>summary of the MCMC draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postMeanbeta</code>: </td>
<td>
<p>posterior mean of <code class="reqn">\beta</code> from the complete Gibbs run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postMeansigma</code>: </td>
<td>
<p>posterior mean of <code class="reqn">\sigma</code> from the complete Gibbs run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postStdbeta</code>: </td>
<td>
<p>posterior standard deviation of <code class="reqn">\beta</code> from the complete Gibbs run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postStdsigma</code>: </td>
<td>
<p>posterior standard deviation of <code class="reqn">\sigma</code> from the complete Gibbs run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>dicQuant</code>: </td>
<td>
<p>all quantities of DIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>logMargLike</code>: </td>
<td>
<p>an estimate of log marginal likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>ineffactor</code>: </td>
<td>
<p>inefficiency factor for each component of <code class="reqn">\beta</code> and <code class="reqn">\sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>betadraws</code>: </td>
<td>
<p>dataframe of the <code class="reqn">\beta</code> draws from the complete Gibbs run, size is <code class="reqn">(k x nsim)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>sigmadraws</code>: </td>
<td>
<p>dataframe of the <code class="reqn">\sigma</code> draws from the complete Gibbs run, size is <code class="reqn">(1 x nsim)</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Rahman, M. A. (2016). '"Bayesian Quantile Regression for Ordinal Models."'
Bayesian Analysis, 11(1): 1-24.  DOI: 10.1214/15-BA939
</p>


<h3>See Also</h3>

<p>rnorm, qnorm,
Gibbs sampling
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(101)
data("data25j3")
y &lt;- data25j3$y
xMat &lt;- data25j3$x
k &lt;- dim(xMat)[2]
b0 &lt;- array(rep(0, k), dim = c(k, 1))
B0 &lt;- 10*diag(k)
n0 &lt;- 5
d0 &lt;- 8
output &lt;- quantregOR2(y = y, x = xMat, b0, B0, n0, d0, gammacp2 = 3,
burn = 10, mcmc = 40, p = 0.25, accutoff = 0.5, maxlags = 400, verbose = TRUE)

# Summary of MCMC draws :

#            Post Mean Post Std Upper Credible Lower Credible Inef Factor
#    beta_1   -4.5185   0.9837        -3.1726        -6.2000     1.5686
#    beta_2    6.1825   0.9166         7.6179         4.8619     1.5240
#    beta_3    5.2984   0.9653         6.9954         4.1619     1.4807
#    sigma     1.0879   0.2073         1.5670         0.8436     2.4228

# Log of Marginal Likelihood: -404.57
# DIC: 801.82

</code></pre>


</div>