<div class="container">

<table style="width: 100%;"><tr>
<td>ssm_nlg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General multivariate nonlinear Gaussian state space models</h2>

<h3>Description</h3>

<p>Constructs an object of class <code>ssm_nlg</code> by defining the corresponding
terms of the observation and state equation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssm_nlg(
  y,
  Z,
  H,
  T,
  R,
  Z_gn,
  T_gn,
  a1,
  P1,
  theta,
  known_params = NA,
  known_tv_params = matrix(NA),
  n_states,
  n_etas,
  log_prior_pdf,
  time_varying = rep(TRUE, 4),
  state_names = paste0("state", 1:n_states)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observations as multivariate time series (or matrix) of length
<code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z, H, T, R</code></td>
<td>
<p>An external pointers (object of class <code>externalptr</code>)
for the C++ functions which define the corresponding model functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_gn, T_gn</code></td>
<td>
<p>An external pointers (object of class <code>externalptr</code>)
for the C++ functions which define the gradients of the corresponding model
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>
<p>Prior mean for the initial state as object of class
<code>externalptr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P1</code></td>
<td>
<p>Prior covariance matrix for the initial state as object of class
<code>externalptr</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Parameter vector passed to all model functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known_params</code></td>
<td>
<p>A vector of known parameters passed to all model
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known_tv_params</code></td>
<td>
<p>A matrix of known parameters passed to all model
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_states</code></td>
<td>
<p>Number of states in the model (positive integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_etas</code></td>
<td>
<p>Dimension of the noise term of the transition equation
(positive integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_prior_pdf</code></td>
<td>
<p>An external pointer (object of class
<code>externalptr</code>) for the C++ function which
computes the log-prior density given theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_varying</code></td>
<td>
<p>Optional logical vector of length 4, denoting whether
the values of
Z, H, T, and R vary with respect to time variable (given identical states).
If used, this can speed up some computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state_names</code></td>
<td>
<p>A character vector containing names for the states.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The nonlinear Gaussian model is defined as
</p>
<p style="text-align: center;"><code class="reqn">y_t = Z(t, \alpha_t, \theta) + H(t, \theta) \epsilon_t, 
(\textrm{observation equation})</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha_{t+1} = T(t, \alpha_t, \theta) + R(t, \theta)\eta_t, 
(\textrm{transition equation})</code>
</p>

<p>where <code class="reqn">\epsilon_t \sim N(0, I_p)</code>, <code class="reqn">\eta_t \sim N(0, I_m)</code> and
<code class="reqn">\alpha_1 \sim N(a_1, P_1)</code> independently of each other, and functions
<code class="reqn">Z, H, T, R</code> can depend on <code class="reqn">\alpha_t</code> and parameter vector
<code class="reqn">\theta</code>.
</p>
<p>Compared to other models, these general models need a bit more effort from
the user, as you must provide the several small C++ snippets which define the
model structure. See examples in the vignette and <code>cpp_example_model</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>ssm_nlg</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Takes a while on CRAN
set.seed(1)
n &lt;- 50
x &lt;- y &lt;- numeric(n)
y[1] &lt;- rnorm(1, exp(x[1]), 0.1)
for(i in 1:(n-1)) {
 x[i+1] &lt;- rnorm(1, sin(x[i]), 0.1)
 y[i+1] &lt;- rnorm(1, exp(x[i+1]), 0.1)
}

pntrs &lt;- cpp_example_model("nlg_sin_exp")

model_nlg &lt;- ssm_nlg(y = y, a1 = pntrs$a1, P1 = pntrs$P1, 
  Z = pntrs$Z_fn, H = pntrs$H_fn, T = pntrs$T_fn, R = pntrs$R_fn, 
  Z_gn = pntrs$Z_gn, T_gn = pntrs$T_gn,
  theta = c(log_H = log(0.1), log_R = log(0.1)), 
  log_prior_pdf = pntrs$log_prior_pdf,
  n_states = 1, n_etas = 1, state_names = "state")

out &lt;- ekf(model_nlg, iekf_iter = 100)
ts.plot(cbind(x, out$at[1:n], out$att[1:n]), col = 1:3)

</code></pre>


</div>