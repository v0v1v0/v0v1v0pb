<div class="container">

<table style="width: 100%;"><tr>
<td>loadExcel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Load/Clean Excel sheet</h2>

<h3>Description</h3>

<p>Load and clean one sheet from an Excel file
</p>


<h3>Usage</h3>

<pre><code class="language-R">loadExcel(
  file = NA,
  sheet = 1,
  folder = ".",
  pk = NA,
  remDup = TRUE,
  remNAcol = TRUE,
  remNArow = TRUE,
  convDates = TRUE,
  tzSel = "America/New_York"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>file (can use wildcards, e.g., "*.xlsx")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheet</code></td>
<td>
<p>worksheet name to load from Excel file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folder</code></td>
<td>
<p>folder (i.e., directory to look in, can use relative path )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>
<p>vector of columns that form the primary key for data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remDup</code></td>
<td>
<p>logical field indicating whether duplicate rows are deleted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remNAcol</code></td>
<td>
<p>logical field indicating whether columns with all NA are deleted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remNArow</code></td>
<td>
<p>logical field indicating whether rows with all NA are deleted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convDates</code></td>
<td>
<p>vector or logical field indicating whether date-like columns
should be converted to POSIXct format (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tzSel</code></td>
<td>
<p>time zone to use for date conversions (default: "America/New_York")</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function reads in a single sheet from an Excel file using
readxl::read_excel to load the data
</p>
<p>After reading data in with readxl::read_excel, some specific additional
steps are implemented:
</p>
<p>1. Double quotes are removed from beginning and ending of all
fields. The purpose is to maintaion leading zeroes (e.g., USGS flow gages).
To effectively use this functionality, data maintained in a spreadsheet
would be enclosed in quotes (e.g., "01578310"). If exported to csv or txt
files the field would be in triple quotes (e.g., """01578310"""). Any
column read in as integer is converted to numeric.
</p>
<p>2. Rows and columns with no data (i.e., all NA) are deleted unless default
settings for remNAcol and remNArow are changed to FALSE.
</p>
<p>3. Completely duplicate rows are deleted unless default setting for remDup
is changed to FALSE.
</p>
<p>4. If a primary key (either single or multiple columns) is selected, the
function enforces the primary key by deleting duplicate entries based on
the primary key. Columns corresponding to the primary key (when specified)
are moved to the first columns.
</p>
<p>5. If convDates is a vector (i.e., <code>c('beginDate', 'endDate')</code>), then
a date conversion to <code>as.POSIXct</code> is attempted for the corresponding
columns found in the input file. If TRUE, then a date conversion is
attempted for all columns found in the input file with 'date' in the name,
If FALSE, no date conversion is attempted.
</p>
<p>Some other common time zones include the following: America/New_York,
America/Chicago, America/Denver, America/Los_Angeles, America/Anchorage,
America/Honolulu, America/Jamaica, America/Managua, America/Phoenix,
America/Metlakatla
</p>
<p>A brief table reporting the results of the import are printed.
</p>
<p>Note that columns containing just F, T, FALSE, TRUE are stored as logical fields
</p>


<h3>Value</h3>

<p>Returns data frame
</p>


</div>