<div class="container">

<table style="width: 100%;"><tr>
<td>hfdenoise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation function</h2>

<h3>Description</h3>

<p>Proportion estimation procedure for simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hfdenoise(n = 256, proportion = P2, binsize = 1, thrule = "ebayesthresh",
    van = 8, fam = "DaubLeAsymm", pl = 3, prior = "laplace", vscale = "independent", 
plotstep = FALSE, truncate = FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Length of vector to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportion</code></td>
<td>
<p>The function name of the proportion to be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>
<p>The binomial size corresponding to the mean function <span class="env">proportion</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thrule</code></td>
<td>
<p>Thresholding procedure to be used in the smoothing.  Possible values are "sureshrink" and "ebayesthresh".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>van</code></td>
<td>
<p>the vanishing moments of the decomposing wavelet basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>the wavelet family to be used for the decomposing transform.Possible values are "DaubLeAsymm" and "DaubExPhase".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>the primary resolution to be used in the wavelet transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Prior to be used in ebayesthresh thresholding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vscale</code></td>
<td>
<p>argument to ebayesthresh thresholding procedure (variance calculation: "independent" or "bylevel").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotstep</code></td>
<td>
<p>Should all steps be plotted in estimation procedure?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>
<p>Should the estimates be truncated to lie in [0,1]?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any other optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a regularly-spaced vector on the unit interval of length <span class="env">length</span>, and uses these values to create corresponding values using the proportion function.  These values are then used as binomial probabilities to sample "observed" binomial random variables.  The observation vector is then denoised using a wavelet transform defined by the arguments <span class="env">pl</span>, <span class="env">van</span>, <span class="env">fam</span> with thresholding method <span class="env">thrule</span>.  This denoising is done for both Anscombe and the Haar-Fisz method for binomial random variables.  The procedure is repeated <span class="env">times</span> times, and the resulting proportion estimates averaged.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>regular grid on which the proportion function is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truep</code></td>
<td>
<p>vector corresponding to <span class="env">x</span> of proportion function values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fhat</code></td>
<td>
<p>Binomial Haar-Fisz estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fhata</code></td>
<td>
<p>Anscombe inverse sine estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fhatf</code></td>
<td>
<p>Freeman-Tukey average inverse sine estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl1</code></td>
<td>
<p>lokern estimate using <span class="env">binhf.wd</span> as a preprocessor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl2</code></td>
<td>
<p>lokern estimate using Anscombe as a preprocessor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bbwd</code></td>
<td>
<p>wd object of binomial Haar-Fisz before thresholding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>awd</code></td>
<td>
<p>wd object of Anscombe before thresholding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>data from which estimates were computed (sampled from <span class="env">truep</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bb</code></td>
<td>
<p>data after being preprocessed with binomial Haar-Fisz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>Thresholded wd object of <span class="env">bbwd</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmp</code></td>
<td>
<p>Thresholded (binomial Haar-Fisz) data before postprocessing.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matt Nunes (<a href="mailto:m.nunes@ucl.ac.uk">m.nunes@ucl.ac.uk</a>)</p>


<h3>See Also</h3>

<p><code>simsij</code></p>


<h3>Examples</h3>

<pre><code class="language-R">sim&lt;-hfdenoise()

plot(sim$x,sim$truep,type="l", xlab="",ylab="Binomial Proportion")

##^^ shows original proportion to estimate.

lines(sim$x,sim$fhat,col=2)
lines(sim$x,sim$fhata,col=3)

##^^shows the estimates of the proportion from the two transforms.

</code></pre>


</div>