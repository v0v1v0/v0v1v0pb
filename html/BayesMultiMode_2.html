<div class="container">

<table style="width: 100%;"><tr>
<td>bayes_mixture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creating a S3 object of class <code>bayes_mixture</code>
</h2>

<h3>Description</h3>

<p>Creates an object of class <code>bayes_mixture</code> which can subsequently be used as argument in <code>bayes_mode()</code>.
This function is useful for users who want to use the mode inference capabilities of <code>BayesMultiMode</code> with mixture
estimated using external software.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayes_mixture(
  mcmc,
  data,
  burnin = 0,
  dist = NA_character_,
  pdf_func = NULL,
  dist_type = NA_character_,
  loglik = NULL,
  vars_to_keep = NA_character_,
  vars_to_rename = NA_character_,
  loc = NA_character_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>A matrix of MCMC draws with one column per variable, e.g. eta1, eta2, ..., mu1, mu2, etc...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Vector of observation used for estimating the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of draws to discard as burnin; default is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Distribution family of the mixture components supported by
the package (i.e. <code>"normal"</code>, <code>"student"</code>, <code>"skew_normal"</code> or <code>"shifted_poisson"</code>).
If left unspecified, <code>pdf_func</code> is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf_func</code></td>
<td>
<p>(function) Pdf or pmf of the mixture components;
this input is used only if <code>dist</code> is left unspecified.
pdf_func should have two arguments : (i) the observation where the pdf is evaluated;
(ii) a named vector representing the function parameters. For instance a normal pdf would take the form:
<code>pdf_func &lt;- function(x, pars) dnorm(x, pars['mu'], pars['sigma'])</code>.
The names of <code>pars</code> should correspond to variables in <code>mcmc</code>, e.g. <code>"mu1"</code>, <code>"mu2"</code> etc...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_type</code></td>
<td>
<p>Either <code>"continuous"</code> or <code>"discrete"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Vector showing the log likelihood at each MCMC draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_to_keep</code></td>
<td>
<p>(optional) Character vector containing the names
of the variables to keep in <code>mcmc</code>, e.g. <code>c("eta", "mu", "sigma")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars_to_rename</code></td>
<td>
<p>(optional) Use for renaming variables/parameters in <code>mcmc</code>.
A named character vector where the names are the new variable names
and the elements the variables in <code>mcmc</code>, e.g. c("new_name" = "old_name").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>(for continuous mixtures other than Normal mixtures) String indicating the location parameter
of the distribution; the latter is used to initialise the MEM algorithm.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of class <code>bayes_mixture</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Same as argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>Matrix of MCMC draws where the rows corresponding to burnin have been discarded;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc_all</code></td>
<td>
<p>Matrix of MCMC draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log likelihood at each MCMC draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>Same as argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf_func</code></td>
<td>
<p>The pdf/pmf of the mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_type</code></td>
<td>
<p>Type of the distribution, i.e. continuous or discrete.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars_names</code></td>
<td>
<p>Names of the mixture components' parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>Name of the location parameter of the mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_var</code></td>
<td>
<p>Number of parameters in the mixture distribution.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# Example with a Student t ================================================

# Constructing synthetic mcmc output
mu = c(0.5,6)
mu_mat = matrix(rep(mu, 100) + rnorm(200, 0, 0.1),
            ncol = 2, byrow = TRUE)

omega = c(1,2)
sigma_mat = matrix(rep(omega, 100) + rnorm(200, 0, 0.1),
            ncol = 2, byrow = TRUE)

nu = c(5,5)
nu_mat = matrix(rep(nu, 100) + rnorm(200, 0, 0.1),
            ncol = 2, byrow = TRUE)

eta = c(0.8,0.2)
eta_mat = matrix(rep(eta[1], 100) + rnorm(100, 0, 0.05),
            ncol = 1)
eta_mat = cbind(eta_mat,1-eta_mat)

xi_mat = matrix(0,100,2)

fit = cbind(eta_mat, mu_mat, sigma_mat, nu_mat, xi_mat)
colnames(fit) = c("eta1", "eta2", "mu1", "mu2",
                  "omega1", "omega2", "nu1", "nu2", "xi1", "xi2")
                  
# sampling observations
data = c(sn::rst(eta[1]*1000, mu[1], omega[1], nu = nu[1]),
        sn::rst(eta[2]*1000, mu[2], omega[2], nu = nu[2]))
        
pdf_func = function(x, pars) {
  sn::dst(x, pars["mu"], pars["sigma"], pars["xi"], pars["nu"])
}

dist_type = "continuous"

BM = bayes_mixture(fit, data, burnin = 50,
pdf_func = pdf_func, dist_type = dist_type,
vars_to_rename = c("sigma" = "omega"), loc = "xi")
# plot(BM)
</code></pre>


</div>