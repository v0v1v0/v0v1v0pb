<div class="container">

<table style="width: 100%;"><tr>
<td>bws_cdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CDF of the Baumgartner-Weiss-Schindler test under the null.</h2>

<h3>Description</h3>

<p>Computes the CDF of the Baumgartner-Weiss-Schindler test statistic under the
null hypothesis of equal distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bws_cdf(b, maxj = 5L, lower_tail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a vector of BWS test statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxj</code></td>
<td>
<p>the maximum value of j to take in the approximate computation
of the CDF via equation (2.5). Baumgartner <em>et. al.</em> claim that a
value of 3 is sufficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_tail</code></td>
<td>
<p>boolean, when <code>TRUE</code> returns <code class="reqn">\Psi</code>, otherwise
compute the upper tail, <code class="reqn">1-\Psi</code>, which is more useful for hypothesis tests.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given value <code class="reqn">b</code>, computes the CDF of the BWS statistic under
the null, denoted as <code class="reqn">\Psi(b)</code> by 
Baumgartner <em>et al.</em>  The CDF is computed from 
equation (2.5) via numerical quadrature.
</p>
<p>The expression for the CDF contains the integral
</p>
<p style="text-align: center;"><code class="reqn">\int_0^1 \frac{1}{\sqrt{r^3 (1-r)}} \mathrm{exp}\left(\frac{rb}{8} - \frac{\pi^2 (4j+1)^2}{8rb}\right) \mathrm{dr}</code>
</p>

<p>By making the change of variables <code class="reqn">x = 2r - 1</code>, this can
be re-expressed as an integral of the form
</p>
<p style="text-align: center;"><code class="reqn">\int_{-1}^1 \frac{1}{\sqrt{1-x^2}} f(x) \mathrm{dx},</code>
</p>

<p>for some function <code class="reqn">f(x)</code> involving <code class="reqn">b</code> and <code class="reqn">j</code>. 
This integral can be approximated
via Gaussian quadrature using Chebyshev nodes (of the first kind), which
is the approach we take here.
</p>


<h3>Value</h3>

<p>A vector of the CDF of <code class="reqn">b</code>, <code class="reqn">\Psi(b)</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>


<h3>See Also</h3>

<p><code>bws_stat</code>, <code>bws_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# do it 500 times
set.seed(123)
bvals &lt;- replicate(500, bws_stat(rnorm(50),rnorm(50)))
pvals &lt;- bws_cdf(bvals)
# these should be uniform!
 
  plot(ecdf(pvals)) 


# compare to Table 1 of Baumgartner et al.
bvals &lt;- c(1.933,2.493,3.076,3.880,4.500,5.990)
tab1v &lt;- c(0.9,0.95,0.975,0.990,0.995,0.999)
pvals &lt;- bws_cdf(bvals,lower_tail=TRUE)
show(data.frame(B=bvals,BWS_psi=tab1v,our_psi=pvals))

</code></pre>


</div>