<div class="container">

<table style="width: 100%;"><tr>
<td>prepare_predictions.brmsfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare Predictions</h2>

<h3>Description</h3>

<p>This method helps in preparing <span class="pkg">brms</span> models for certin post-processing
tasks most notably various forms of predictions. Unless you are a package
developer, you will rarely need to call <code>prepare_predictions</code> directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'brmsfit'
prepare_predictions(
  x,
  newdata = NULL,
  re_formula = NULL,
  allow_new_levels = FALSE,
  sample_new_levels = "uncertainty",
  incl_autocor = TRUE,
  oos = NULL,
  resp = NULL,
  ndraws = NULL,
  draw_ids = NULL,
  nsamples = NULL,
  subset = NULL,
  nug = NULL,
  smooths_only = FALSE,
  offset = TRUE,
  newdata2 = NULL,
  new_objects = NULL,
  point_estimate = NULL,
  ndraws_point_estimate = 1,
  ...
)

prepare_predictions(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object typically of class <code>'brmsfit'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data.frame for which to evaluate predictions. If
<code>NULL</code> (default), the original data of the model is used. <code>NA</code>
values within factors (excluding grouping variables) are interpreted as if
all dummy variables of this factor are zero. This allows, for instance, to
make predictions of the grand mean when using sum coding. <code>NA</code> values
within grouping variables are treated as a new level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_formula</code></td>
<td>
<p>formula containing group-level effects to be considered in
the prediction. If <code>NULL</code> (default), include all group-level effects;
if <code>NA</code> or <code>~0</code>, include no group-level effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_new_levels</code></td>
<td>
<p>A flag indicating if new levels of group-level
effects are allowed (defaults to <code>FALSE</code>). Only relevant if
<code>newdata</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_new_levels</code></td>
<td>
<p>Indicates how to sample new levels for grouping
factors specified in <code>re_formula</code>. This argument is only relevant if
<code>newdata</code> is provided and <code>allow_new_levels</code> is set to
<code>TRUE</code>. If <code>"uncertainty"</code> (default), each posterior sample for a
new level is drawn from the posterior draws of a randomly chosen existing
level. Each posterior sample for a new level may be drawn from a different
existing level such that the resulting set of new posterior draws
represents the variation across existing levels. If <code>"gaussian"</code>,
sample new levels from the (multivariate) normal distribution implied by the
group-level standard deviations and correlations. This options may be useful
for conducting Bayesian power analysis or predicting new levels in
situations where relatively few levels where observed in the old_data. If
<code>"old_levels"</code>, directly sample new levels from the existing levels,
where a new level is assigned all of the posterior draws of the same
(randomly chosen) existing level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incl_autocor</code></td>
<td>
<p>A flag indicating if correlation structures originally
specified via <code>autocor</code> should be included in the predictions.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oos</code></td>
<td>
<p>Optional indices of observations for which to compute
out-of-sample rather than in-sample predictions. Only required in models
that make use of response values to make predictions, that is, currently
only ARMA models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Optional names of response variables. If specified, predictions
are performed only for the specified response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>Positive integer indicating how many posterior draws should
be used. If <code>NULL</code> (the default) all draws are used. Ignored if
<code>draw_ids</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_ids</code></td>
<td>
<p>An integer vector specifying the posterior draws to be used.
If <code>NULL</code> (the default), all draws are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamples</code></td>
<td>
<p>Deprecated alias of <code>ndraws</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Deprecated alias of <code>draw_ids</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nug</code></td>
<td>
<p>Small positive number for Gaussian process terms only. For
numerical reasons, the covariance matrix of a Gaussian process might not be
positive definite. Adding a very small number to the matrix's diagonal
often solves this problem. If <code>NULL</code> (the default), <code>nug</code> is
chosen internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooths_only</code></td>
<td>
<p>Logical; If <code>TRUE</code> only predictions related to
smoothing splines (i.e., <code>s</code> or <code>t2</code>) will be computed.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Logical; Indicates if offsets should be included in the
predictions. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata2</code></td>
<td>
<p>A named <code>list</code> of objects containing new data, which
cannot be passed via argument <code>newdata</code>. Required for some objects
used in autocorrelation structures, or <code>stanvars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_objects</code></td>
<td>
<p>Deprecated alias of <code>newdata2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_estimate</code></td>
<td>
<p>Shall the returned object contain only point estimates
of the parameters instead of their posterior draws? Defaults to
<code>NULL</code> in which case no point estimate is computed. Alternatively, may
be set to <code>"mean"</code> or <code>"median"</code>. This argument is primarily
implemented to ensure compatibility with the <code>loo_subsample</code>
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws_point_estimate</code></td>
<td>
<p>Only used if <code>point_estimate</code> is not
<code>NULL</code>. How often shall the point estimate's value be repeated?
Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>validate_newdata</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>'brmsprep'</code> or <code>'mvbrmsprep'</code>,
depending on whether a univariate or multivariate model is passed.
</p>


</div>