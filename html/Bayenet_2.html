<div class="container">

<table style="width: 100%;"><tr>
<td>Bayenet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a robust Bayesian elastic net variable selection model for genetic study.</h2>

<h3>Description</h3>

<p>fit a robust Bayesian elastic net variable selection model for genetic study.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bayenet(
  X,
  Y,
  clin,
  max.steps = 10000,
  robust = TRUE,
  sparse = TRUE,
  penalty = c("lasso", "elastic net"),
  debugging = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the matrix of predictors (genetic factors). Each row should be an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the continuous response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clin</code></td>
<td>
<p>a matrix of clinical variables. Clinical variables are not subject to penalize. Clinical variables will be centered and a column of 1 will be added to the Clinical matrix as the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.steps</code></td>
<td>
<p>the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>logical flag. If TRUE, robust methods will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical flag. If TRUE, spike-and-slab priors will be used to shrink coefficients of irrelevant covariates to zero exactly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>two choices are available. "lasso" for lasso penalty. "elastic net" for elastic net penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debugging</code></td>
<td>
<p>logical flag. If TRUE, progress will be output to the console and extra information will be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider the data model described in "<code>dat</code>":
</p>
<p style="text-align: center;"><code class="reqn">Y_{i} = \alpha_{0} + \sum_{k=1}^{q}\gamma_{k}C_{ik}+\sum_{j=1}^{p}\beta_{j}X_{ij}+\epsilon_{i},</code>
</p>

<p>where <code class="reqn">\alpha_{0}</code> is the intercept, <code class="reqn">\gamma_{k}</code>'s and <code class="reqn">\beta_{j}</code>'s are the regression coefficients corresponding to effects of clinical factors and genetic variants, respectively.
</p>
<p>When penalty="elastic net" (default), the elastic net penalty is adopted. If penalty="lasso", the lasso penalty is used.
</p>
<p>When sparse=TRUE (default), spike–and–slab priors are imposed to identify important main and interaction effects. If sparse=FALSE, Laplacian shrinkage will be used.
</p>
<p>When robust=TRUE (default), the distribution of <code class="reqn">\epsilon_{i}</code> is defined as a Laplace distribution with density
<code class="reqn">
f(\epsilon_{i}|\nu) = \frac{\nu}{2}\exp\left\{-\nu |\epsilon_{i}|\right\}
</code>, (<code class="reqn">i=1,\dots,n</code>), which leads to a Bayesian formulation of LAD regression. If robust=FALSE, <code class="reqn">\epsilon_{i}</code> follows a normal distribution.
</p>
<p>Both <code class="reqn">X</code> and <code class="reqn">clin</code> will be standardized before the generation of interaction terms to avoid the multicollinearity between main effects and interaction terms.
</p>
<p>Please check the references for more details about the prior distributions.
</p>


<h3>Value</h3>

<p>an object of class ‘Bayenet’ is returned, which is a list with component:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>the posterior samples of coefficients from the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>the estimated value of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>the total number of burn-ins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the total number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>the design matrix of all effects.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lu, X. and Wu, C. (2023). Bayesian quantile elastic net with spike-and-slab priors.
</p>


<h3>See Also</h3>

<p><code>Selection</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dat)

max.steps=5000
fit= Bayenet(X, Y, clin, max.steps, penalty="lasso")

## coefficients of parameters
fit$coefficient

## Estimated values of main G effects 
fit$coefficient$G

## Estimated values of clincal effects 
fit$coefficient$clin


</code></pre>


</div>