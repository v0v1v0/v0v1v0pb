<div class="container">

<table style="width: 100%;"><tr>
<td>quantregOR1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian quantile regression in the OR1 model</h2>

<h3>Description</h3>

<p>This function estimates Bayesian quantile regression in the OR1 model (ordinal quantile model with 3
or more outcomes) and reports the posterior mean, posterior standard deviation, 95
percent posterior credible intervals, and inefficiency factor of <code class="reqn">(\beta, \delta)</code>. The output
also displays the log of marginal likelihood and the DIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quantregOR1(y, x, b0, B0, d0, D0, burn, mcmc, p, tune, accutoff, maxlags, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed ordinal outcomes, column vector of size <code class="reqn">(n x 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate matrix of size <code class="reqn">(n x k)</code> including a column of ones with or without column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>prior mean for <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>
<p>prior covariance matrix for <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0</code></td>
<td>
<p>prior mean for <code class="reqn">\delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D0</code></td>
<td>
<p>prior covariance matrix for <code class="reqn">\delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>number of burn-in MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>number of MCMC iterations, post burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>quantile level or skewness parameter, p in (0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune</code></td>
<td>
<p>tuning parameter to adjust MH acceptance rate, default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accutoff</code></td>
<td>
<p>autocorrelation cut-off to identify the number of lags and form batches to compute the inefficiency factor, default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlags</code></td>
<td>
<p>maximum lag at which to calculate the acf in inefficiency factor calculation, default is 400.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether to print the final output and provide additional information or not, default is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates Bayesian quantile regression for the
OR1 model using a combination of Gibbs sampling
and Metropolis-Hastings algorithm. The function takes the prior distributions and
other information as inputs and then iteratively samples <code class="reqn">\beta</code>, latent weight w,
<code class="reqn">\delta</code>, and latent variable z from their respective
conditional distributions.
</p>
<p>The function also provides the logarithm of marginal likelihood and the DIC. These
quantities can be utilized to compare two or more competing models at the same quantile.
The model with a higher (lower) log marginal likelihood (DIC) provides a
better model fit.
</p>


<h3>Value</h3>

<p>Returns a bqrorOR1 object with components:
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>summary</code>: </td>
<td>
<p>summary of the MCMC draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postMeanbeta</code>: </td>
<td>
<p>posterior mean of <code class="reqn">\beta</code> from the complete MCMC run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postMeandelta</code>: </td>
<td>
<p>posterior mean of <code class="reqn">\delta</code> from the complete MCMC run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postStdbeta</code>: </td>
<td>
<p>posterior standard deviation of <code class="reqn">\beta</code> from the complete MCMC run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>postStddelta</code>: </td>
<td>
<p>posterior standard deviation of <code class="reqn">\delta</code> from the complete MCMC run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>gammacp</code>: </td>
<td>
<p>vector of cut points including (Inf, -Inf).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>catprob</code>: </td>
<td>
<p>probability for each category, calculated at the posterior mean and the mean of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>acceptancerate</code>: </td>
<td>
<p>acceptance rate of the proposed draws of <code class="reqn">\delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>dicQuant</code>: </td>
<td>
<p>all quantities of DIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>logMargLike</code>: </td>
<td>
<p>an estimate of the log marginal likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>ineffactor</code>: </td>
<td>
<p>inefficiency factor for each component of <code class="reqn">\beta</code> and <code class="reqn">\delta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>betadraws</code>: </td>
<td>
<p>dataframe of the <code class="reqn">\beta</code> draws from the complete MCMC run, size is <code class="reqn">(k x nsim)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>deltadraws</code>: </td>
<td>
<p>dataframe of the <code class="reqn">\delta</code> draws from the complete MCMC run, size is <code class="reqn">((J-2) x nsim)</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Rahman, M. A. (2016). '"Bayesian Quantile Regression for Ordinal Models."'
Bayesian Analysis, 11(1): 1-24. DOI: 10.1214/15-BA939
</p>


<h3>See Also</h3>

<p>rnorm, qnorm,
Gibbs sampler, Metropolis-Hastings algorithm
</p>


<h3>Examples</h3>

<pre><code class="language-R"> set.seed(101)
 data("data25j4")
 y &lt;- data25j4$y
 xMat &lt;- data25j4$x
 k &lt;- dim(xMat)[2]
 J &lt;- dim(as.array(unique(y)))[1]
 b0 &lt;- array(rep(0, k), dim = c(k, 1))
 B0 &lt;- 10*diag(k)
 d0 &lt;- array(0, dim = c(J-2, 1))
 D0 &lt;- 0.25*diag(J - 2)
 output &lt;- quantregOR1(y = y, x = xMat, b0 ,B0, d0, D0,
 burn = 10, mcmc = 40, p = 0.25, tune = 1, accutoff = 0.5, maxlags = 400, verbose = TRUE)

 # Summary of MCMC draws:


 #             Post Mean  Post Std   Upper Credible Lower Credible Inef Factor
 # beta_1       -2.6202   0.3588        -2.0560        -3.3243       1.1008
 # beta_2        3.1670   0.5894         4.1713         2.1423       3.0024
 # beta_3        4.2800   0.9141         5.7142         2.8625       2.8534
 # delta_1       0.2188   0.4043         0.6541        -0.4384       3.6507
 # delta_2       0.4567   0.3055         0.7518        -0.2234       3.1784

 # MH acceptance rate: 36%
 # Log of Marginal Likelihood: -554.61
 # DIC: 1375.33

</code></pre>


</div>