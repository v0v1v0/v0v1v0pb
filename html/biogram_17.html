<div class="container">

<table style="width: 100%;"><tr>
<td>construct_ngrams</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct and filter n-grams</h2>

<h3>Description</h3>

<p>Builds and selects important n-grams stepwise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">construct_ngrams(
  target,
  seq,
  u,
  n_max,
  conf_level = 0.95,
  gap = TRUE,
  use_heuristics = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p><code>integer</code> vector with target information (e.g. class labels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq</code></td>
<td>
<p>a vector or matrix describing sequence(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code>integer</code>, <code>numeric</code> or <code>character</code> vector of all
possible unigrams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_max</code></td>
<td>
<p>size of constructed n-grams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> gaps are used. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_heuristics, </code></td>
<td>
<p>if <code>FALSE</code> then all n-grams are tested. This may
slow down computations significantly</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>construct_ngrams</code> starts by 
extracting unigrams from the sequences, pasting them together in all combination and 
choosing from them significant features (with p-value below <code>conf_level</code>). The 
chosen n-grams are further extended to the specified by <code>n_max</code> size by pasting 
unigrams at both ends.
</p>
<p>The <code>gap</code> parameter determines if <code>construct_ngrams</code> performs the
feature selection on exact n-grams (<code>gap</code> equal to FALSE) or on all features in the 
Hamming distance 1 from the n-gram (<code>gap</code> equal to TRUE).
</p>


<h3>Value</h3>

<p>a vector of n-grams.
</p>


<h3>See Also</h3>

<p>Feature filtering method: <code>test_features</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># to make the example faster, we run construct_ngrams() on the 
# subset of data
deg_seqs &lt;- degenerate(human_cleave[c(1L:100, 801L:900), 1L:9],
list(`1` = c(1, 6, 8, 10, 11, 18),
     `2` = c(2, 13, 14, 16, 17),
     `3` = c(5, 19, 20),
     `4` = c(7, 9, 12, 15),
     '5' = c(3, 4)))
bigrams &lt;- construct_ngrams(human_cleave[c(1L:100, 801L:900), "tar"], deg_seqs, 1L:5, 2)
</code></pre>


</div>