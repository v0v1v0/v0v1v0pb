<div class="container">

<table style="width: 100%;"><tr>
<td>SamplePosteriorDepGamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw samples from the posterior for the hazard, using the piecewise
exponential (histogram) prior with dependent Gamma heights</h2>

<h3>Description</h3>

<p>The sampler is described in the Supplement to Castillo and Van der Pas
(2020) and uses MCMC within Gibbs, with a Gamma proposal with shape
parameter equal to the number of events in each interval plus some epsilon
(to prevent proposals equal to zero if there are no events in an interval)
and rate parameter equal to the parameter alpha (set by the user) divided by
histogram height on the previous interval, plus the total amount of time all
individuals were exposed during this interval. Most users of the package will
not work with this function directly, but instead use the main function
BayesSurv, in which this particular function is incorporated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SamplePosteriorDepGamma(
  failures,
  exposures,
  N = 1000,
  alpha.dep = 1,
  alpha0.dep = 1.5,
  beta0.dep = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>failures</code></td>
<td>
<p>A vector of length <code class="reqn">K</code> (the total number of intervals),
containing for each interval the number of individuals who had an event
during that interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposures</code></td>
<td>
<p>A vector of length <code class="reqn">K</code> (the total number of intervals),
containing for each interval the total amount of time all individuals
together were under follow-up during that interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of draws to take.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.dep</code></td>
<td>
<p>The main parameter <code class="reqn">\alpha</code> for the dependent Gamma
prior, as described in the documentation for BayesSurv. It is
recommended to take <code>alpha.dep</code> smaller than <code>alpha0.dep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0.dep</code></td>
<td>
<p>The shape parameter for the Gamma prior on the histogram
height for the first interval. It is recommended to take <code>alpha.dep</code>
smaller than <code>alpha0.dep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0.dep</code></td>
<td>
<p>The rate parameter for the Gamma prior on the histogram
height for the first interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The samples returned by this function are draws from the posterior for the
hazard function. To obtain draws from the posterior for the cumulative
hazard, one can use numerical integration. One way to achieve this is by
first finding the values of the cumulative hazard at the end of each interval,
e.g. by <code>t(apply(samples*time.max/K, 1, cumsum))</code>, where <code>samples</code>
is the output from the present function and <code>time.max</code> and <code>K</code> are
as described for BayesSurv, and then using <code>approxfun()</code> to linearly
interpolate in between. To obtain posterior samples from the survival, one
could then use SurvivalFromCumhaz.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>A <code class="reqn">N</code> by <code class="reqn">K</code> (the number of draws by the
number of intervals) matrix, with each row containing a draw from the
posterior for the hazard, based on a histogram prior with dependent
Gamma heights.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Castillo and Van der Pas (2020). Multiscale Bayesian survival
analysis. &lt;arXiv:2005.02889&gt;.
</p>


<h3>See Also</h3>

<p>BayesSurv, which computes the posterior mean and credible
bands for the cumulative hazard and survival functions, as well as the
posterior mean for the hazard. Within BayesSurv, the present
function is called.
</p>


</div>