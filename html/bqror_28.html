<div class="container">

<table style="width: 100%;"><tr>
<td>qrminfundtheorem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimizes the negative of log-likelihood in the OR1 model</h2>

<h3>Description</h3>

<p>This function minimizes the negative of log-likelihood in the OR1 model
with respect to the cut-points <code class="reqn">\delta</code> using the
fundamental theorem of calculus.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qrminfundtheorem(deltaIn, y, x, beta, cri0, cri1, stepsize, maxiter, h, dh, sw, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>deltaIn</code></td>
<td>
<p>initialization of cut-points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed ordinal outcomes, column vector of size <code class="reqn">(n x 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate matrix of size <code class="reqn">(n x k)</code> including a column of ones with or without column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p><code class="reqn">\beta</code>, a column vector of size <code class="reqn">(k x 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cri0</code></td>
<td>
<p>initial criterion, <code class="reqn">cri0 = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cri1</code></td>
<td>
<p>criterion lies between (0.001 to 0.0001).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p>learning rate lies between (0.1, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>change in each value of <code class="reqn">\delta</code>, holding other <code class="reqn">\delta</code>
constant for first derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dh</code></td>
<td>
<p>change in each value of <code class="reqn">\delta</code>, holding other <code class="reqn">\delta</code> constant
for second derivaties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sw</code></td>
<td>
<p>iteration to switch from BHHH to inv(-H) algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>quantile level or skewness parameter, p in (0,1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First derivative from first principle
</p>
<p style="text-align: center;"><code class="reqn">dy/dx=[f(x+h)-f(x-h)]/2h</code>
</p>

<p>Second derivative from first principle
</p>
<p style="text-align: center;"><code class="reqn">f'(x-h)=(f(x)-f(x-h))/h</code>
</p>

<p style="text-align: center;"><code class="reqn">f''(x)= [{(f(x+h)-f(x))/h} - (f(x)-f(x-h))/h]/h</code>
</p>

<p style="text-align: center;"><code class="reqn">= [(f(x+h)+f(x-h)-2 f(x))]/h^2</code>
</p>

<p>cross partial derivatives
</p>
<p style="text-align: center;"><code class="reqn">f(x) = [f(x+dh,y)-f(x-dh,y)]/2dh</code>
</p>

<p style="text-align: center;"><code class="reqn">f(x,y)=[{(f(x+dh,y+dh) - f(x+dh,y-dh))/2dh} - {(f(x-dh,y+dh) -
f(x-dh,y-dh))/2dh}]/2dh</code>
</p>

<p style="text-align: center;"><code class="reqn">= 0.25* [{(f(x+dh,y+dh)-f(x+dh,y-dh))} -{(f(x-dh,y+dh)-f(x-dh,y-dh))}]/dh2</code>
</p>



<h3>Value</h3>

<p>Returns a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>deltamin</code>: </td>
<td>
<p>cutpoint vector that minimizes the log-likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>negsum</code>: </td>
<td>
<p>negative sum of log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>logl</code>: </td>
<td>
<p>log-likelihood values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>G</code>: </td>
<td>
<p>gradient vector, <code class="reqn">(n x k)</code> matrix with i-th row as the score
for the i-th unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>H</code>: </td>
<td>
<p>Hessian matrix.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>differential calculus, functional maximization,
mldivide
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(101)
deltaIn &lt;- c(-0.002570995,  1.044481071)
data("data25j4")
y &lt;- data25j4$y
xMat &lt;- data25j4$x
p &lt;- 0.25
beta &lt;- c(0.3990094, 0.8168991, 2.8034963)
cri0     &lt;- 1
cri1     &lt;- 0.001
stepsize &lt;- 1
maxiter  &lt;- 10
h        &lt;- 0.002
dh       &lt;- 0.0002
sw       &lt;- 20
output &lt;- qrminfundtheorem(deltaIn, y, xMat, beta, cri0, cri1, stepsize, maxiter, h, dh, sw, p)

# deltamin
#   0.8266967 0.3635708
# negsum
#   645.4911
# logl
#    -0.7136999
#    -1.5340787
#    -1.1072447
#    -1.4423124
#    -1.3944677
#    -0.7941271
#    -1.6544072
#    -0.3246632
#    -1.8582422
#    -0.9220822
#    -2.1117739 .. soon
# G
#    0.803892784  0.00000000
#   -0.420190546  0.72908381
#   -0.421776117  0.72908341
#   -0.421776117 -0.60184063
#   -0.421776117 -0.60184063
#    0.151489598  0.86175120
#    0.296995920  0.96329114
#   -0.421776117  0.72908341
#   -0.340103190 -0.48530164
#    0.000000000  0.00000000
#   -0.421776117 -0.60184063.. soon
# H
#   -338.21243  -41.10775
#   -41.10775 -106.32758

</code></pre>


</div>