<div class="container">

<table style="width: 100%;"><tr>
<td>scoreparameters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Initializing score object</h2>

<h3>Description</h3>

<p>This function returns an object of class scoreparameters containing the data and parameters needed for calculation of the BDe/BGe score, or a user defined score.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scoreparameters(
  scoretype = c("bge", "bde", "bdecat", "usr"),
  data,
  bgepar = list(am = 1, aw = NULL, edgepf = 1),
  bdepar = list(chi = 0.5, edgepf = 2),
  bdecatpar = list(chi = 0.5, edgepf = 2),
  dbnpar = list(samestruct = TRUE, slices = 2, b = 0, stationary = TRUE, rowids = NULL,
    datalist = NULL, learninit = TRUE),
  usrpar = list(pctesttype = c("bge", "bde", "bdecat")),
  mixedpar = list(nbin = 0),
  MDAG = FALSE,
  DBN = FALSE,
  weightvector = NULL,
  bgnodes = NULL,
  edgepmat = NULL,
  nodeslabels = NULL
)

## S3 method for class 'scoreparameters'
print(x, ...)

## S3 method for class 'scoreparameters'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scoretype</code></td>
<td>
<p>the score to be used to assess the DAG structure:
"bge" for Gaussian data, "bde" for binary data, 
"bdecat" for categorical data,
"usr" for a user defined score; when "usr" score is chosen, one must define a function (which evaluates the log score of a node given its parents) in the following format: usrDAGcorescore(j,parentnodes,n,param), where 'j' is node to be scores, 'parentnodes' are the parents of this node, 'n' number of nodes in the netwrok and 'param' is an object of class 'scoreparameters'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data matrix with n columns (the number of variables) and a number of rows equal to the number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bgepar</code></td>
<td>
<p>a list which contains parameters for BGe score:
</p>

<ul>
<li>
<p> am (optional) a positive numerical value, 1 by default
</p>
</li>
<li>
<p> aw (optional) a positive numerical value should be more than <code>n+1</code>, <code>n+am+1</code> by default
</p>
</li>
<li>
<p> edgepf (optional) a positive numerical value providing the edge penalization factor to be combined with the BGe score, 1 by default (no penalization)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdepar</code></td>
<td>
<p>a list which contains parameters for BDe score for binary data:
</p>

<ul>
<li>
<p> chi (optional) a positive number of prior pseudo counts used by the BDe score, 0.5 by default
</p>
</li>
<li>
<p> edgepf (optional) a positive numerical value providing the edge penalization factor to be combined with the BDe score, 2 by default
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdecatpar</code></td>
<td>
<p>a list which contains parameters for BDe score for categorical data:
</p>

<ul>
<li>
<p> chi (optional) a positive number of prior pseudo counts used by the BDe score, 0.5 by default
</p>
</li>
<li>
<p> edgepf (optional) a positive numerical value providing the edge penalization factor to be combined with the BDe score, 2 by default
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbnpar</code></td>
<td>
<p>which type of score to use for the slices
</p>

<ul>
<li>
<p> samestruct logical, when TRUE the structure of the first time slice is assumed to be the same as internal structure of all other time slices
</p>
</li>
<li>
<p> slices integer representing the number of time slices in a DBN
</p>
</li>
<li>
<p> b the number of static variables; all static variables have to be in the first b columns of the data;  for DBNs static variables have the same meaning as bgnodes for usual Bayesian networks; for DBNs parameters parameter <code>bgnodes</code> is ignored
</p>
</li>
<li>
<p> rowids optional vector of time IDs; usefull for identifying data for initial time slice
</p>
</li>
<li>
<p> datalist indicates is data is passed as a list for a two step DBN; useful for unbalanced number of samples in timi slices
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usrpar</code></td>
<td>
<p>a list which contains parameters for the user defined score
</p>

<ul><li>
<p> pctesttype (optional) conditional independence test ("bde","bge","bdecat")
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixedpar</code></td>
<td>
<p>a list which contains parameters for the BGe and BDe score for mixed data
</p>

<ul><li>
<p> nbin a positive integer number of binary nodes in the network (the binary nodes are always assumed in first nbin columns of the data)
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MDAG</code></td>
<td>
<p>logical, when TRUE the score is initialized for a model with multiple sets of parameters but the same structure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DBN</code></td>
<td>
<p>logical, when TRUE the score is initialized for a dynamic Baysian network; FALSE by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightvector</code></td>
<td>
<p>(optional) a numerical vector of positive values representing the weight of each observation; should be NULL(default) for non-weighted data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bgnodes</code></td>
<td>
<p>(optional) a vector that contains  column indices in the data defining the nodes that are forced to be root nodes in the sampled graphs; root nodes are nodes which have no parents but can be parents of other nodes in the network; in case of DBNs bgnodes represent static variables and defined via element <code>b</code> of the parameters <code>dbnpar</code>; parameter <code>bgnodes</code> is ignored for DBNs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgepmat</code></td>
<td>
<p>(optional) a matrix of positive numerical values providing the per edge penalization factor to be added to the score, NULL by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodeslabels</code></td>
<td>
<p>(optional) a vector of characters which denote the names of nodes in the Bayesian network; by default column names of the data will be taken</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class 'scoreparameters'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class 'scoreparameters'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>scoreparameters</code>, which includes all necessary information for calculating the BDe/BGe score
</p>


<h3>Author(s)</h3>

<p>Polina Suter, Jack kuipers
</p>


<h3>References</h3>

<p>Geiger D and Heckerman D (2002). Parameter priors for directed acyclic graphical models and the characterization of several probability distributions. The Annals of Statistics 30, 1412-1440.
</p>
<p>Kuipers J, Moffa G and Heckerman D (2014). Addendum on the scoring of Gaussian acyclic graphical models. The Annals of Statistics 42, 1689-1691.
</p>
<p>Heckerman D and Geiger D (1995). Learning Bayesian networks: A unification for discrete and Gaussian domains. In Eleventh Conference on Uncertainty in Artificial Intelligence, pages 274-284.
</p>
<p>Scutari M (2016). An Empirical-Bayes Score for Discrete Bayesian Networks. Journal of Machine Learning Research 52, 438-448
</p>


<h3>Examples</h3>

<pre><code class="language-R">myDAG&lt;-pcalg::randomDAG(20, prob=0.15, lB = 0.4, uB = 2) 
myData&lt;-pcalg::rmvDAG(200, myDAG) 
myScore&lt;-scoreparameters("bge", myData)
</code></pre>


</div>