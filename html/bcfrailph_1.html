<div class="container">

<table style="width: 100%;"><tr>
<td>bcfrailph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Semi-parametric bivariate correlated frailty model.</h2>

<h3>Description</h3>

<p>Fit a semiparametric Bivariate correlated frailty model with Proportional Hazard structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcfrailph(
  formula,
  data,
  initfrailp = NULL,
  frailty = c("gamma", "lognormal"),
  weights = NULL,
  control = bcfrailph.control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~ operator, and the terms on the right. The response must be a survival object as returned by the Surv function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe contain survival time, censor, covariate etc with data in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initfrailp</code></td>
<td>
<p>Initial estimates for the frailty parameters. If not specified, initial frailty variance will be obtained from coxph with univariate frailty model and for correlation c(0.5) will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frailty</code></td>
<td>
<p>A type of frailty distribution to be used in fit. Either gamma or lognormal. The default is gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of case weights for gamma model. the default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Arguments to control bcfrailph fit. The default is <code>bcfrailph.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of  that contains  the following components.
</p>

<ul>
<li> <p><code>coefficients</code> - A vector of estimated Covariate coefficients.
</p>
</li>
<li> <p><code>frailparest</code> - A vector of estimated Frailty parameters i.e. frailty variance and correlation.
</p>
</li>
<li> <p><code>stderr</code>-A vector containing the Standard error of the Estimated parameters both covariate coefficients and  frailty parameters.
</p>
</li>
<li> <p><code>loglilk0</code>- Log likelihood of without frailty model or loglik of coxph fit.
</p>
</li>
<li> <p><code>loglilk</code>-Log likelihood of Cox PH model with frailty.
</p>
</li>
<li> <p><code>Iloglilk</code>- Log likelihood of with frailty. For gamma fit it is I-likelihood or the likelihood after integrating out the frailty term.For lognormal fit it is the approximate likelihood.
</p>
</li>
<li> <p><code>bhaz</code>- an array containing unique event times and estimated baseline hazard.
</p>
</li>
<li> <p><code>X</code>-Matrix of observed covariates.
</p>
</li>
<li> <p><code>time</code>-the observed survival time.
</p>
</li>
<li> <p><code>censor</code>-censoring indicator.
</p>
</li>
<li> <p><code>resid</code>-the martingale residuals.
</p>
</li>
<li> <p><code>lin.prid</code>-the vector of linear predictors.
</p>
</li>
<li> <p><code>frail</code>-estimated Frailty values.
</p>
</li>
<li> <p><code>iteration</code>-Number of outer iterations.
</p>
</li>
<li> <p><code>e.time</code>-the vector of unique event times.
</p>
</li>
<li> <p><code>n.event</code>- the number of events at each of the unique event times.
</p>
</li>
<li> <p><code>convergence</code>-an indicator, 1 if converge and 0 otherwise.
</p>
</li>
<li> <p><code>history</code>-an array containing records of estimates and other information on each iterations.
</p>
</li>
</ul>
<h3>Note</h3>

<p>Parameters of Bivariate correlated gamma frailty model was estimated using a modified EM approach given in Kifle et al (2022).
Parameters of Bivariate correlated lognormal frailty model is based on the penalized partial likelihood approach by Rippatti and Palmgren (2000).
</p>


<h3>References</h3>

<p>Kifle YG, Chen DG, Haileyesus MT (2022). Multivariate Frailty Models using Survey Weights with Applications to Twins Infant Mortality in Ethiopia. Statistics and Its Interface,106(4), 1\-10.
</p>
<p>Rippatti, S. and Palmgren, J (2000). Estimation of multivariate frailty models using penalized partial likelihood. Biometrics, 56: 1016-1022.
</p>


<h3>See Also</h3>

<p><code>bcfrailph.control</code>,<code>simbcfrailph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4)
simdata&lt;-simbcfrailph(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
dataa&lt;-simdata$data

fitbcfrgam=bcfrailph(Surv(time,censor)~ X1+frailty(PID) ,data=dataa,frailty="gamma")
fitbcfrgam


# for lognormal

set.seed(18)
simdata&lt;-simbcfrailph(psize=100, cenr= c(0.2),beta=c(1,-0.7,0.5),
frailty=c("lognormal"),frailpar=c(0.5,-0.25),bhaz=c("exponential"),
bhazpar=list(scale = c(0.1)),covartype= c("N","N","B"),
covarpar=list(fargs=c(0,0,1),sargs=c(1,1,0.5)),comncovar=2)
dataa&lt;-simdata$data

#fit
fitbcfrlogn=bcfrailph(Surv(time,censor)~ X1+X2+X3+frailty(PID) ,data=dataa,frailty="lognormal")
fitbcfrlogn

## one can set the initial parameter for the frailty parameters
fitbcfrailph=bcfrailph(Surv(time,censor)~ X1+frailty(PID),data=dataa,initfrailp = c(0.1,0.5),
frailty="lognormal")
fitbcfrailph

# Not run

#if covariates are not included
fitmoe=try(bcfrailph(Surv(time,censor)~0+frailty(PID),data=dataa,
frailty="lognormal"),silent = TRUE)

fitmoe=try(bcfrailph(Surv(time,censor)~1+frailty(PID),data=dataa),silent = TRUE)

# if control is not specified correctly.
# if one needs to change only max.iter to be 100,

fitmoe=try(bcfrailph(Surv(time,censor)~ X1+frailty(PID),data=dataa,
control=c(max.iter=100)),silent = TRUE)

#the correct way is
fitmoe=bcfrailph(Surv(time,censor)~ X1+frailty(PID),data=dataa,
control=bcfrailph.control(max.iter=100))
fitmoe

#if initial frailty parameters are in the boundary of parameter space
fitmoe=try(bcfrailph(Surv(time,censor)~ X1+frailty(PID),data=dataa,
initfrailp=c(0.2,1)),silent = TRUE)

fitmoe=try(bcfrailph(Surv(time,censor)~ X1+frailty(PID),data=dataa,
initfrailp=c(0,0.1)),silent = TRUE)

#if a frailty distribution other than gamma and lognormal are specified

fitmoe=try(bcfrailph(Surv(time,censor)~ X1,data=dataa,,frailty="exp"),silent = TRUE)

# End Not run


</code></pre>


</div>