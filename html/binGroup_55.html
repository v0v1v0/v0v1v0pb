<div class="container">

<table style="width: 100%;"><tr>
<td>NI.Dorf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the optimal testing configuration for non-informative 
two-stage hierarchical testing</h2>

<h3>Description</h3>

<p>Find the optimal testing configuration (OTC) for 
non-informative two-stage hierarchical (Dorfman) testing and 
calculate the associated operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NI.Dorf(p, Se, Sp, group.sz, obj.fn, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the probability of disease, which can be specified as an overall
probability of disease or a homogeneous vector of individual probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Se</code></td>
<td>
<p>the sensitivity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sp</code></td>
<td>
<p>the specificity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.sz</code></td>
<td>
<p>a single group size for which to calculate operating
characteristics, or a range of group sizes over which to find the OTC. 
The details of group size specification are given under 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj.fn</code></td>
<td>
<p>a list of objective functions which are minimized to find the
OTC. The expected number of tests per individual, "<kbd>ET</kbd>", will always 
be calculated. Additional options include "<kbd>MAR</kbd>" 
(the expected number of tests divided by the expected number of correct 
classifications, described in Malinovsky et al. (2016)), and "<kbd>GR</kbd>" 
(a linear combination of the expected number of tests, the number of 
misclassified negatives, and the number of misclassified positives, 
described in Graff &amp; Roeloffs (1972)). See Hitt et al. (2018) at
<a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a> for additional details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a matrix of up to six sets of weights for the GR function. 
Each set of weights is specified by a row of the matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function finds the OTC and computes the associated 
operating characteristics for non-informative two-stage
hierarchical (Dorfman) testing. Operating characteristics calculated 
are expected number of tests, pooling sensitivity, pooling specificity, 
pooling positive predictive value, and pooling negative predictive value 
for the algorithm. See Hitt et al. (2018) at
<a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a>, Dorfman (1943), or
Kim et al. (2007) for additional details on the implementation 
of non-informative two-stage hierarchical testing.
</p>
<p>The value(s) specified by <kbd>group.sz</kbd> represent the initial (stage 1) 
group size. If a single value is provided for <kbd>group.sz</kbd>, operating
characteristics will be calculated and no optimization will be performed.
If a range of group sizes is specified, the OTC will be found over all 
group sizes.
</p>
<p>The displayed pooling sensitivity, pooling specificity, pooling positive 
predictive value, and pooling negative predictive value are weighted 
averages of the corresponding individual accuracy measures for all 
individuals within the initial group for a hierarchical algorithm.
Expressions for these averages are provided in the Supplementary 
Material for Hitt et al. (2018). These expressions are based on accuracy 
definitions given by Altman and Bland (1994a, 1994b).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the probability of disease, as specified by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Se</code></td>
<td>
<p>the sensitivity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sp</code></td>
<td>
<p>the specificity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.ET, opt.MAR, opt.GR</code></td>
<td>
<p>a list for each objective function specified 
by the user, containing:
</p>

<dl>
<dt>OTC</dt>
<dd>
<p>a list specifying elements of the optimal testing configuration, 
which include:
</p>

<dl>
<dt>Stage1</dt>
<dd>
<p>pool size for the first stage of testing, i.e. the initial
group size.</p>
</dd>
</dl>
</dd>
<dt>p.vec</dt>
<dd>
<p>the vector of individual probabilities.</p>
</dd>
<dt>ET</dt>
<dd>
<p>the expected testing expenditure for the OTC.</p>
</dd>
<dt>value</dt>
<dd>
<p>the value of the objective function per individual.</p>
</dd>
<dt>PSe</dt>
<dd>
<p>the overall pooling sensitivity for the algorithm. Further 
details are given under 'Details'.</p>
</dd>
<dt>PSp</dt>
<dd>
<p>the overall pooling specificity for the algorithm. Further 
details are given under 'Details'.</p>
</dd>
<dt>PPPV</dt>
<dd>
<p>the overall pooling positive predictive value for the algorithm. 
Further details are given under 'Details'.</p>
</dd>
<dt>PNPV</dt>
<dd>
<p>the overall pooling negative predictive value for the algorithm. 
Further details are given under 'Details'.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Brianna D. Hitt
</p>


<h3>References</h3>

<p>Altman, D., Bland, J. (1994).
“Diagnostic tests 1: sensitivity and specificity.”
<em>BMJ</em>, <b>308</b>, 1552.
</p>
<p>Altman, D., Bland, J. (1994).
“Diagnostic tests 2: predictive values.”
<em>BMJ</em>, <b>309</b>, 102.
</p>
<p>Dorfman, R. (1943).
“The Detection of Defective Members of Large Populations.”
<em>The Annals of Mathematical Statistics</em>, <b>14</b>(4), 436–440.
ISSN 0003-4851, doi: <a href="https://doi.org/10.1214/aoms/1177731363">10.1214/aoms/1177731363</a>, <a href="https://www.jstor.org/stable/2235930">https://www.jstor.org/stable/2235930</a>.
</p>
<p>Graff, L., Roeloffs, R. (1972).
“Group testing in the presence of test error; an extension of the Dorfman procedure.”
<em>Technometrics</em>, <b>14</b>(1), 113–122.
ISSN 15372723, doi: <a href="https://doi.org/10.1080/00401706.1972.10488888">10.1080/00401706.1972.10488888</a>, <a href="https://www.tandfonline.com/doi/abs/10.1080/00401706.1972.10488888">https://www.tandfonline.com/doi/abs/10.1080/00401706.1972.10488888</a>.
</p>
<p>Hitt, B., Bilder, C., Tebbs, J., McMahan, C. (2018).
“The Optimal Group Size Controversy for Infectious Disease Testing: Much Ado About Nothing?!”
Manuscript submitted for publication.
</p>
<p>Kim, H., Hudgens, M., Dreyfuss, J., Westreich, D., Pilcher, C. (2007).
“Comparison of group testing algorithms for case identification in the presence of test error.”
<em>Biometrics</em>, <b>63</b>(4), 1152–1163.
ISSN 0006341X, doi: <a href="https://doi.org/10.1111/j.1541-0420.2007.00817.x">10.1111/j.1541-0420.2007.00817.x</a>.
</p>
<p>Malinovsky, Y., Albert, P., Roy, A. (2016).
“Reader reaction: A note on the evaluation of group testing algorithms in the presence of misclassification.”
<em>Biometrics</em>, <b>72</b>(1), 299–302.
ISSN 15410420, doi: <a href="https://doi.org/10.1111/biom.12385">10.1111/biom.12385</a>.
</p>


<h3>See Also</h3>

<p><code>Inf.Dorf</code> for informative two-stage hierarchical (Dorfman) testing, 
<code>NI.D3</code> for non-informative three-stage hierarchical testing, 
<code>Inf.D3</code> for informative three-stage hierarchical testing,
and <code>OTC</code> for finding the optimal testing configuration for a number 
of standard group testing algorithms.
</p>
<p><a href="http://chrisbilder.com/grouptesting">http://chrisbilder.com/grouptesting</a>
</p>
<p>Other OTC functions: <code>Inf.Array</code>,
<code>Inf.D3</code>, <code>Inf.Dorf</code>,
<code>NI.A2M</code>, <code>NI.Array</code>,
<code>NI.D3</code>, <code>OTC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Find the OTC for non-informative two-stage 
#   hierarchical (Dorfman) testing over a range 
#   of group sizes.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
NI.Dorf(p=0.01, Se=0.95, Sp=0.95, group.sz=2:100, 
obj.fn=c("ET", "MAR"))

# Calculate the operating characteristics for a specified 
#   initial group size for non-informative two-stage 
#   hierarchical (Dorfman) testing.
# This example takes less than 1 second to run.
# Estimated running time was calculated using a 
#   computer with 16 GB of RAM and one core of an 
#   Intel i7-6500U processor.
NI.Dorf(p=rep(0.025, 50), Se=0.90, Sp=0.90, group.sz=50,
obj.fn=c("ET", "MAR", "GR"), weights=matrix(data=c(1,1,10,10), 
nrow=2, ncol=2, byrow=TRUE))
</code></pre>


</div>