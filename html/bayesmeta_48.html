<div class="container">

<table style="width: 100%;"><tr>
<td>plot.bayesmeta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generate summary plots for a <code>bayesmeta</code> object.
</h2>

<h3>Description</h3>

<p>Generates a forest plot, and joint and marginal posterior density plots
for the two parameters of the random-effects meta-analysis model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'bayesmeta'
plot(x, main=deparse(substitute(x)),
     which=1:4, prior=FALSE, forest.margin=8,
     mulim=c(NA,NA), taulim=c(NA,NA),
     violin=FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a <code>bayesmeta</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>a <code>character</code> string giving the main title for the plot(s).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>an indicator of which plots to generate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>an indicator whether to also draw the prior density in marginal
posterior density plots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest.margin</code></td>
<td>

<p>the width of the margin to the left of the forest plot. This may
require some manual tweaking so that the study labels fit properly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mulim, taulim</code></td>
<td>

<p>(optional) ranges of effect (mu) and heterogeneity (tau) values
to be used for plotting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>violin</code></td>
<td>

<p>an indicator whether to draw the forest plot as a “violin plot”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the value of the <code>which</code> argument, one or several
plots are generated, namely
</p>

<ol>
<li>
<p> a forest plot, including a 95% credible interval (diamond) and
a 95% prediction interval (rectangle) for the effect <code class="reqn">\mu</code>. The
shown intervals for <code class="reqn">\mu</code> are based on posterior medians and
shortest credible intervals (from <code>x$summary</code>).
If <code>violin=TRUE</code>, the forest plot is plotted as a
“violin plot”, i.e., via Gaussian densities for the
estimates <code class="reqn">y_i</code> (and their associated uncertainties),
and the posterior densities for the effect <code class="reqn">\mu</code>, and for the
predictive distribution.
</p>
</li>
<li>
<p> a plot of the joint posterior density of heterogeneity
(<code class="reqn">\tau</code>) and effect (<code class="reqn">\mu</code>). Red lines trace the
contours of constant density corresponding to approximate 2D
credible regions (based on a <code class="reqn">\chi^2</code>-approximation to the
logarithmic posterior density) as labelled. The credible
regions are only an approximation based on a
‘well-behaved’, unimodal posterior; contour lines are
omitted if the posterior mode is not finite. Blue lines show the
conditional mean effect <code class="reqn">\mu</code> as a function of the
heterogeneity <code class="reqn">\tau</code> (solid line) along with conditional
95% confidence bounds (dashed lines). Green lines indicate
marginal medians and shortest 95% credible intervals for
<code class="reqn">\tau</code> and <code class="reqn">\mu</code>. 
</p>
</li>
<li>
<p> the marginal posterior probability density of the effect
<code class="reqn">\mu</code> with median and shortest 95% credible interval
indicated. Depending on the <code>prior</code> argument, a dashed line
showing the prior density is added. Note that for improper priors
the scaling is arbitrary and may be inappropriate for the plot.
</p>
</li>
<li>
<p> the marginal posterior probability density of the heterogeneity
<code class="reqn">\tau</code> with median and shortest 95% credible interval
indicated. Depending on the <code>prior</code> argument, a dashed line
showing the prior density is added. Note that for improper priors
the scaling is arbitrary and may be inappropriate for the plot.
</p>
</li>
</ol>
<p>The joint posterior density plot (2) especially highlights the dependence
of the effect estimate on the heterogeneity parameter. In a
‘conventional’ frequentist meta-analysis, one would commonly first
estimate the heterogeneity <code class="reqn">\tau</code>, and then fix this value and
estimate the effect <code class="reqn">\mu</code> based on the assumption that the
heterogeneity estimate was the true value. In the joint density plot,
this would correspond to considering vertical “slices” of the
parameter space, a slice at <code class="reqn">\tau=0</code> for the fixed-effects model,
and a slice a a different <code class="reqn">\tau</code> value for the random-effects
model, where the blue lines would then indicate the corresponding
estimate and confidence interval for <code class="reqn">\mu</code>.
</p>
<p>Note that when using the <code>prior=TRUE</code> argument, the added line
may end up be outside the plotted range, especially when using
improper priors with arbitrary normalisation (consider adding it
“manually” instead).
</p>


<h3>Value</h3>

<p>Returns the supplied <code>bayesmeta</code> object (<code>x</code>).
</p>


<h3>Author(s)</h3>

<p>Christian Roever <a href="mailto:christian.roever@med.uni-goettingen.de">christian.roever@med.uni-goettingen.de</a>
</p>


<h3>References</h3>

<p>C. Roever.
Bayesian random-effects meta-analysis using the bayesmeta R package.
<em>Journal of Statistical Software</em>, <b>93</b>(6):1-51, 2020.
<a href="https://doi.org/10.18637/jss.v093.i06">doi:10.18637/jss.v093.i06</a>.
</p>
<p>C. Guddat, U. Grouven, R. Bender and G. Skipka.
A note on the graphical presentation of prediction intervals in
random-effects meta-analyses.
<em>Systematic Reviews</em>, <b>1</b>(34), 2012.
<a href="https://doi.org/10.1186/2046-4053-1-34">doi:10.1186/2046-4053-1-34</a>.
</p>
<p>R.D. Riley, J.P. Higgins and J.J. Deeks.
Interpretation of random effects meta-analyses.
<em>BMJ</em>, <b>342</b>:d549, 2011.
<a href="https://doi.org/10.1136/bmj.d549">doi:10.1136/bmj.d549</a>.
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code>, <code>forestplot.bayesmeta</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# example data by Snedecor and Cochran:
data("SnedecorCochran")

# analyze using a weakly informative prior
# (may take a few seconds to compute!):
ma &lt;- bayesmeta(y=SnedecorCochran[,"mean"], sigma=sqrt(SnedecorCochran[,"var"]),
                label=SnedecorCochran[,"no"],
                mu.prior.mean=50, mu.prior.sd=50,
                tau.prior=function(x){dhalfcauchy(x, scale=10)})

# show some plots:
plot(ma, main="Snedecor/Cochran data", prior=TRUE)
plot(ma, main="Snedecor/Cochran data", which=1, violin=TRUE)

## End(Not run)
</code></pre>


</div>