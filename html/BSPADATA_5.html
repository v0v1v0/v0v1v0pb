<div class="container">

<table style="width: 100%;"><tr>
<td>hetero_sem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bayesian fitting of Spatial Error Model (SEM) model with heteroscedastic normal error term.

</h2>

<h3>Description</h3>

<p>Performs the Bayesian fitting of Heterocedastic Spatial Error Model (SEM) model with normal error term

</p>


<h3>Usage</h3>

<pre><code class="language-R">hetero_sem(formulamean,formulavar,data,W,nsim,burn,step,prior,
           initial,kernel="normal",seed=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formulamean</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the mean.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulavar</code></td>
<td>
<p> Object of class formula with the description of the model to be fitted for the variance.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Data frame object with covariates of model

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p> Object of class matrix, nb or listw related to Spatial Contiguity Matrix, Anselin(1988)

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>A number that indicates the amount of iterations

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>A number that indicates the amount of iterations to be burn at the beginning of the chain

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>


<p>A number that indicates the length between samples in chain that generate the point estimates for each parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>List with prior distributions of the parameters in the hom_sem model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>

<p>List with the initial values for the chains of each the parameters of the hom_sem model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>


<p>Distribution used in transition kernel to get samples of lambda, it can be  "uniform" or "normal"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Random seed for generating the samples of the posterior distributions.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>hetero_sem is a function made in order to fit Spatial Error Model (SEM) with a normal heteroscedatic disturbance term through MCMC methods as Metropolis-Hastings algorithm, under two proposals for trasition kernel to get samples of spatial lag parameter, lambda, and aided by working variables approach to get samples of conditional posterior distribution of gamma vector.
</p>


<h3>Value</h3>






<p>List with the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Data frame with summary statistics of the marginal posterior distributions of the parameters of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Acceptance_Rate</code></td>
<td>
<p>List with the acceptance rate for the samples of gamma and lambda </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Criteria</code></td>
<td>
<p>List with values of both the Bayesian Information Criterion (BIC) and the Deviance Information Criterion (DIC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chains</code></td>
<td>
<p>Object of class mcmc with the samples of the marginal posterior distribution of each of the parameters of the model</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jorge  Sicacha-Parada &lt;jasicachap@unal.edu.co&gt;, Edilberto Cepeda-Cuervo &lt;ecepedac@unal.edu.co&gt;

</p>


<h3>References</h3>


<p>1. Cepeda C. E. (2001). Modelagem da variabilidade em modelos lineares generalizados. Unpublished Ph.D. tesis. Instituto de Matematicas.
Universidade Federal do Rio do Janeiro.
</p>
<p>2.Cepeda, E. and Gamerman D. (2005). Bayesian Methodology for modeling parameters in the two-parameter exponential family. Estadistica 57, 93 105.
</p>
<p>3.Cepeda C., E. and Gamerman D. (2001). Bayesian Modeling of Variance Heterogeneity in Normal Regression Models. Brazilian Journal of Probability and Statistics. 14, 207-221.
</p>
<p>4.Luc Anselin, Spatial Econometrics: Methods and Models, Kluwer Academic, Boston, 1988.
</p>
<p>5. D. Gamerman, Markov Chains Monte Carlo: Stochastic Simulation for bayesian Inference, Chapman and Hall, 1997.
</p>
<p>6. James Le Sage and Kelley Pace, Introduction to Spatial Econometrics, Chapman &amp; Hall/CRC, Boca Raton, 2009.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(oldcol)
n=49
x0=rep(1,n)
x1=runif(n,0,400)
x2=runif(n,10,23)
x3=runif(n,0,10)
X=cbind(x0,x1,x2)
Z=cbind(x0,x1,x3)
gammas=c(-8,0.026,-0.4)
Sigma=diag(c(exp(Z%*%gammas)))
W=COL.nb
matstand=nb2mat(W)
A=diag(n)-0.75*matstand
mu=-35+0.35*x1-1.7*x2
Sigma2=t(solve(A))%*%Sigma%*%solve(A)
y=t(rmvnorm(1,mu,Sigma2))

formulamean &lt;- y ~ x0 + x1 + x2
formulavar &lt;- ~ x0 + x1 +x3
data &lt;- data.frame(y=y,x0=x0,x1=x1,x2=x2,x3=x3)
prior = list(b_pri=rep(0,3),B_pri=diag(rep(1000,3)),g_pri=rep(0,3),
             G_pri=diag(rep(1000,3)))
initial = list(beta_0=rep(0,3),gamma_0=c(0,0,0),lambda_0=0.5)

hetero_sem(formulamean,formulavar,data,W=W,nsim=500,burn=25,step=5,prior = prior,
           initial = initial,kernel="normal")

</code></pre>


</div>