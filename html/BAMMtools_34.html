<div class="container">

<table style="width: 100%;"><tr>
<td>maximumShiftCredibility</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate maximum shift credibility configuration</h2>

<h3>Description</h3>

<p>This is one estimate of the "best" rate shift configuration,
considering only those shift configurations that were actually sampled
using <code>BAMM</code>'s reversible jump MCMC simulator. This is analogous
to the "maximum clade credibility tree" from a Bayesian phylogenetic
analysis. It is not necessarily the same as the shift configuration
with the maximum a posteriori probability.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maximumShiftCredibility(ephy, maximize = "product")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>BAMMdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximize</code></td>
<td>
<p>Maximize the marginal probability of the product or sum of
branch-specific shifts.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is one point estimate of the overall "best" rate shift
configuration. Following an MCMC simulation, the marginal shift
probabilities on each individual branch are computed using
<code>marginalShiftProbsTree</code>. The shift configuration that
maximizes the product (or sum, if specified) of these marginal
branch-specific shift probabilities is the <em>maximum shift
credibility configuration</em>.  
</p>
<p>This option is only recommended if you have no clear "winner" in your
credible set of shift configurations (see
<code>credibleShiftSet</code>). If you have a number of
largely-equiprobable shift configurations in your 95% credible set,
you may wish to try this function as an alternative for identifying a
single best shift configuration. Otherwise, it is recommended that you
present the shift configuration with the maximum a posteriori
probability (see <code>getBestShiftConfiguration</code>).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li>
<p> bestconfigs: A vector of the index values of MCMC samples
with shift configurations equal to the maximum. Usually, more
than one state sampled during the MCMC simulation will have an
identical (maximized) marginal probability. All samples given
in this vector will have an identical shift configuration.
</p>
</li>
<li>
<p> scores: The optimality score (product or sum of marginal
shift probabilities) for all sampled shift configurations in
the <code>BAMMdata</code> object.
</p>
</li>
<li>
<p> optimalityType: Whether the product or sum of marginal
shift probabilities was used to compute the maximum shift
credibility configuration.
</p>
</li>
<li>
<p> sampleindex: A representative sample that is equal to the
maximum shift credibility configuration (e.g., this can be
plotted with <code>addBAMMshifts</code>).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>See Also</h3>

<p><code>marginalShiftProbsTree</code>,
<code>addBAMMshifts</code>, <code>cumulativeShiftProbsTree</code>,
<code>credibleShiftSet</code>,
<code>getBestShiftConfiguration</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.25, nsamples=500)
best_config &lt;- maximumShiftCredibility(ed)
plot(ed)
addBAMMshifts(ed, method='phylogram', index=best_config$sampleindex)
</code></pre>


</div>