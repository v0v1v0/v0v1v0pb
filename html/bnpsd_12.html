<div class="container">

<table style="width: 100%;"><tr>
<td>draw_p_subpops</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw allele frequencies for independent subpopulations</h2>

<h3>Description</h3>

<p>The allele frequency matrix <code>P</code> for <code>m_loci</code> loci (rows) and <code>k_subpops</code> independent subpopulations (columns) are drawn from the Balding-Nichols distribution with ancestral allele frequencies <code>p_anc</code> and FST parameters <code>inbr_subpops</code> equivalent to
<code>P[ i, j ] &lt;- rbeta( 1, nu_j * p_anc[i], nu_j * ( 1 - p_anc[i] ) )</code>,
where <code>nu_j &lt;- 1 / inbr_subpops[j] - 1</code>.
The actual function is more efficient than the above code.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_p_subpops(p_anc, inbr_subpops, m_loci = NA, k_subpops = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p_anc</code></td>
<td>
<p>The scalar or length-<code>m_loci</code> vector of ancestral allele frequencies per locus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inbr_subpops</code></td>
<td>
<p>The scalar or length-<code>k_subpops</code> vector of subpopulation FST values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_loci</code></td>
<td>
<p>If <code>p_anc</code> is scalar, optionally provide the desired number of loci (lest only one locus be simulated).
Stops if both <code>length(p_anc) &gt; 1</code> and <code>m_loci</code> is not <code>NA</code> and they disagree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_subpops</code></td>
<td>
<p>If <code>inbr_subpops</code> is a scalar, optionally provide the desired number of subpopulations (lest a single subpopulation be simulated).
Stops if both <code>length(inbr_subpops) &gt; 1</code> and <code>k_subpops</code> is not <code>NA</code> and they disagree.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>m_loci</code>-by-<code>k_subpops</code> matrix of independent subpopulation allele frequencies.
If <code>p_anc</code> is length-<code>m_loci</code> with names, these are copied to the row names of this output matrix.
If <code>inbr_subpops</code> is length-<code>k_subpops</code> with names, these are copied to the column names of this output matrix.
</p>


<h3>See Also</h3>

<p><code>draw_p_subpops_tree()</code> for version for subpopulations related by a tree, which can therefore be non-independent.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a typical, non-trivial example
# number of loci
m_loci &lt;- 10
# random vector of ancestral allele frequencies
p_anc &lt;- draw_p_anc(m_loci)
# FST values for two subpops
inbr_subpops &lt;- c(0.1, 0.3)
# matrix of intermediate subpop allele freqs
p_subpops &lt;- draw_p_subpops(p_anc, inbr_subpops)

# special case of scalar p_anc
p_subpops &lt;- draw_p_subpops(p_anc = 0.5, inbr_subpops, m_loci = m_loci)
stopifnot ( nrow( p_subpops ) == m_loci )

# special case of scalar inbr_subpops
k_subpops &lt;- 2
p_subpops &lt;- draw_p_subpops(p_anc, inbr_subpops = 0.2, k_subpops = k_subpops)
stopifnot ( ncol( p_subpops ) == k_subpops )

# both main parameters scalars but return value still matrix
p_subpops &lt;- draw_p_subpops(p_anc = 0.5, inbr_subpops = 0.2, m_loci = m_loci, k_subpops = k_subpops)
stopifnot ( nrow( p_subpops ) == m_loci )
stopifnot ( ncol( p_subpops ) == k_subpops )

# passing scalar parameters without setting dimensions separately results in a 1x1 matrix
p_subpops &lt;- draw_p_subpops(p_anc = 0.5, inbr_subpops = 0.2)
stopifnot ( nrow( p_subpops ) == 1 )
stopifnot ( ncol( p_subpops ) == 1 )

</code></pre>


</div>