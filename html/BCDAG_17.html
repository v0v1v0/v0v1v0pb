<div class="container">

<table style="width: 100%;"><tr>
<td>rDAGWishart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random samples from a compatible DAG-Wishart distribution</h2>

<h3>Description</h3>

<p>This function implements a direct sampling from a compatible DAG-Wishart distribution with parameters <code>a</code> and <code>U</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rDAGWishart(n, DAG, a, U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DAG</code></td>
<td>
<p><code class="reqn">(q, q)</code> adjacency matrix of the DAG</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>common shape hyperparameter of the compatible DAG-Wishart, <code class="reqn">a &gt; q - 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>position hyperparameter of the compatible DAG-Wishart, a <code class="reqn">(q, q)</code> s.p.d. matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assume the joint distribution of random variables <code class="reqn">X_1, \dots, X_q</code> is zero-mean Gaussian with covariance matrix Markov w.r.t. a Directed Acyclic Graph (DAG).
The allied Structural Equation Model (SEM) representation of a Gaussian DAG-model allows to express the covariance matrix as a function of the (Cholesky) parameters <code class="reqn">(D,L)</code>,
collecting the regression coefficients and conditional variances of the SEM.
</p>
<p>The DAG-Wishart distribution (Cao et. al, 2019) with shape hyperparameter <code class="reqn">a = (a_1, ..., a_q)</code> and position hyperparameter <code class="reqn">U</code> (a s.p.d. <code class="reqn">(q,q)</code> matrix) provides a conjugate prior for parameters <code class="reqn">(D,L)</code>.
In addition, to guarantee compatibility among Markov equivalent DAGs (same marginal likelihood), the default choice (here implemented) <code class="reqn">a_j = a + |pa(j)| - q + 1</code> <code class="reqn">(a &gt; q - 1)</code>, with <code class="reqn">|pa(j)|</code> the number of parents of node <code class="reqn">j</code> in the DAG,
was introduced by Peluso and Consonni (2020).
</p>


<h3>Value</h3>

<p>A list of two elements: a <code class="reqn">(q,q,n)</code> array collecting <code class="reqn">n</code> sampled matrices <code class="reqn">L</code> and a <code class="reqn">(q,q,n)</code> array collecting <code class="reqn">n</code> sampled matrices <code class="reqn">D</code>
</p>


<h3>Author(s)</h3>

<p>Federico Castelletti and Alessandro Mascaro
</p>


<h3>References</h3>

<p>F. Castelletti and A. Mascaro (2021). Structural learning and estimation of joint causal effects among network-dependent variables. <em>Statistical Methods and Applications</em>, Advance publication.
</p>
<p>X. Cao, K. Khare and M. Ghosh (2019). Posterior graph selection and estimation consistency for high-dimensional Bayesian DAG models. <em>The Annals of Statistics</em> 47 319-348.
</p>
<p>S. Peluso and G. Consonni (2020). Compatible priors for model selection of high-dimensional Gaussian DAGs. <em>Electronic Journal of Statistics</em> 14(2) 4110 - 4132.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Randomly generate a DAG on q = 8 nodes with probability of edge inclusion w = 0.2
q = 8
w = 0.2
set.seed(123)
DAG = rDAG(q = q, w = w)
# Draw from a compatible DAG-Wishart distribution with parameters a = q and U = diag(1,q)
outDL = rDAGWishart(n = 5, DAG = DAG, a = q, U = diag(1, q))
outDL
</code></pre>


</div>