<div class="container">

<table style="width: 100%;"><tr>
<td>binom.optim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimal binomial confidence intervals</h2>

<h3>Description</h3>

<p>Uses optimization to minimize the integrated mean squared error
between the calculated coverage and the desired confidence level
for a given binomial confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.optim(n, conf.level = 0.95, method = binom.lrt,
            k = n%/%2 + 1, p0 = 0, transform = TRUE,
            plot = FALSE, tol = .Machine$double.eps^0.5,
            start = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of independent trials in the binomial experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used to estimate the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>The minimum probability of success to allow in the
optimization. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>logical; If <code>TRUE</code> the optimizer will do an
unconstrained optimization on the signficance probability in the
logit space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; If <code>TRUE</code> the results are sent to <code>binom.plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The minimum significance level to allow in the
optimization. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A starting value on the optimal confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function minimizes the squared error between the expected coverage
probability and the desired confidence level.
</p>
<p style="text-align: center;"><code class="reqn">\alpha_{opt}=\arg\min_{\alpha}\int_{0}^{1}[C(p,n)-(1-\alpha)^2dp</code>
</p>

<p>The optimizer will adjust confidence intervals for all <code>x</code> =
<code>0</code> to <code>n</code> depending on the value of <code>k</code> provided. If
<code>k</code> is one, only the confidence levels for <code>x</code> = <code>0</code> and
<code>n</code> are adjusted. If <code>k</code> = <code>[n/2]</code> then all confidence
intervals are adjusted. This assumes the confidence intervals are the
same length for <code>x</code> = <code>x[k]</code> and <code>x[n - k + 1]</code>, which is
the case for all methods provided in this package except
<code>binom.cloglog</code>.</p>


<h3>Value</h3>

<p>A <code>list</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Final confidence levels. The length of this vector is
<code>k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>The final minimized value from <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>The number of function and gradient calls from
<code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Convergence code from <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>Any message returned by the L-BFGS-B or BFGS
optimizer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>A <code>data.frame</code> returned from a call to
<code>method</code> using the optimized confidence levels.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code>binom.confint</code>, <code>binom.plot</code>,
<code>binom.coverage</code>, <code>optim</code></p>


<h3>Examples</h3>

<pre><code class="language-R">binom.optim(10, k = 1) ## determine optimal significance for x = 0, 10 only
binom.optim(3, method = binom.wilson) ## determine optimal significance for all x
</code></pre>


</div>