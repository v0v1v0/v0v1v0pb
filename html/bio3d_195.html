<div class="container">

<table style="width: 100%;"><tr>
<td>plot.cna</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Protein Structure Network Plots in 2D and 3D.  </h2>

<h3>Description</h3>

<p>Plot a protein dynamic network as obtained from the <em>cna</em> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'cna'
plot(x, pdb = NULL, weights=NULL, vertex.size=NULL,
            layout=NULL, col=NULL, full=FALSE, scale=TRUE, color.edge = FALSE, 
            interactive=FALSE, ...)
  ## S3 method for class 'ecna'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A protein network graph object (or a list of such objects) as obtained from the
‘cna’ function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> A PDB structure object obtained from ‘read.pdb’. 
If supplied this will be used to guide the network plot ‘layout’, 
see ‘layout.cna’ for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> A numeric vector containing the edge weights for the
network. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.size</code></td>
<td>
<p> A numeric vector of node/community sizes. If NULL
the size will be taken from the input network graph object ‘x’. 
Typically for ‘full=TRUE’ nodes will be of an equal size and 
for ‘full=FALSE’ community node size will be proportional to 
the residue membership of each community. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p> Either a function or a numeric matrix. It specifies how the
vertices will be placed on the plot. See ‘layout.cna’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p> A vector of colors used for node/vertex rendering. If NULL
these values are taken from the input network
‘V(x$community.network)$color’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p> Logical, if TRUE the full all-atom network rather than the 
clustered community network will be plotted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> Logical, if TRUE weights are scaled with respect to the network. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.edge</code></td>
<td>
<p> Logical, if TRUE edges are colored with respect to their weights. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p> Logical, if TRUE interactive graph will be drawn where users
can manually adjust the network (positions of vertices, colors of edges, etc.).
Needs Tcl/Tk support in the installed R build. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional graphical parameters for ‘plot.igraph’. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calls ‘plot.igraph’ from the igraph package to 
plot cna networks the way we like them.
</p>
<p>The plot layout is user settable, we like the options of: 
‘layout.cna’, ‘layout.fruchterman.reingold’,  
‘layout.mds’ or ‘layout.svd’. Note that first of these 
uses PDB structure information to produce a more meaningful layout.
</p>
<p>Extensive plot modifications are possible by setting additional graphical 
parameters (...). These options are detailed in ‘igraph.plotting’. 
Common parameters to alter include:
</p>

<dl>
<dt>vertex.label:</dt>
<dd>
<p>Node labels, <code>V(x$network)$name</code>. Use NA to omit.</p>
</dd>
<dt>vertex.label.color:</dt>
<dd>
<p>Node label colors, see also <code>vertex.label.cex</code> etc. </p>
</dd>
<dt>edge.color:</dt>
<dd>
<p>Edge colors,  <code>E(x$network)$color</code>. </p>
</dd>
<dt>mark.groups:</dt>
<dd>
<p>Community highlighting, a community list object, see also <code>mark.col</code> etc.</p>
</dd>
</dl>
<h3>Value</h3>

<p>Produces a network plot on the active graphics device.
Also returns the plot layout coordinates silently, which can be passed to the 
‘identify.cna’ function.
</p>


<h3>Note</h3>

<p> Be sure to check the correspondence of your ‘pdb’ object with your
network object ‘x’, as few internal checks are currently performed by the 
‘layout.cna’ function.
</p>


<h3>Author(s)</h3>

<p> Barry Grant and Guido Scarabelli </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>


<h3>See Also</h3>

 <p><code>plot.igraph</code>, 
<code>plot.communities</code>,
<code>igraph.plotting</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# PDB server connection required - testing excluded

if (!requireNamespace("igraph", quietly = TRUE)) {
   message('Need igraph installed to run this example')
} else {

##-- Build a CNA object
pdb &lt;- read.pdb("4Q21")
modes &lt;- nma(pdb)
cij &lt;- dccm(modes)
net &lt;- cna(cij, cutoff.cij=0.2)

# Plot coarse grain network based on dynamically coupled communities
xy &lt;- plot.cna(net)
#plot.dccm(cij, margin.segments=net$communities$membership)

# Chose a different PDB informed layout for plot
plot.cna(net, pdb)

# Play with plot layout and colors...
plot.cna(net, layout=igraph::layout.mds(net$community.network), col=c("blue","green") ) 

# Plot full residue network colored by communities - will be slow due to number of edges!!
plot.cna(net, pdb, full=TRUE)

# Alter plot settings
plot.cna(net, pdb, full=TRUE, vertex.size=3, weights=1, vertex.label=NA)

}

</code></pre>


</div>