<div class="container">

<table style="width: 100%;"><tr>
<td>test_module</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run BioCro module test cases</h2>

<h3>Description</h3>

<p>Modules can be tested using test cases, which are sets of known outputs that
correspond to particular inputs. The functions here provide ways to create
test cases and test modules.
</p>
<p><code>test_module</code> runs one test case for a module, returning an error message
if its output does not match the expected value.
</p>
<p><code>case</code> helps define test cases for module testing by combining the
required elements into a list with the correct names as required by
<code>test_module</code>.
</p>
<p><code>cases_from_csv</code> helps define test cases for module testing by creating a
list of test cases from a <code>csv</code> file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  test_module(module_name, case_to_test)

  case(inputs, expected_outputs, description)

  cases_from_csv(module_name, directory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>module_name</code></td>
<td>

<p>A string specifying one BioCro module, formatted like
<code>library_name:local_module_name</code>, where <code>library_name</code> is the name
of a library that contains a module with local name
<code>local_module_name</code>; such fully-qualified module names can be formed
manually or with <code>module_paste</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case_to_test</code></td>
<td>

<p>A list with three named elements that describe a module test case:
</p>

<ul>
<li> <p><code>inputs</code>: A list of module inputs, i.e., a list of named
numeric elements corresponding to the module's input quantities.
</p>
</li>
<li> <p><code>expected_outputs</code>: A list of expected module outputs, i.e., a
list of named numeric elements corresponding to the expected values
of the module's output quantities.
</p>
</li>
<li> <p><code>description</code>: A string describing the test case, e.g.
<code>"temp below tbase"</code>. The description should be succinct and
not contain any newline characters.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputs</code></td>
<td>

<p>See the corresponding entry in <code>test_case</code> above.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected_outputs</code></td>
<td>

<p>See the corresponding entry in <code>test_case</code> above.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>description</code></td>
<td>

<p>See the corresponding entry in <code>test_case</code> above.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directory</code></td>
<td>

<p>The directory where module test case files are stored, e.g.
<code>file.path('tests', 'module_test_cases')</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>test_module</code> function forms the basis for the BioCro module testing
system. (See <code>module_testing</code> for more information.) The functions
<code>case</code> and <code>cases_from_csv</code> are complementary to <code>test_module</code>
because they help to pass suitably-formatted test cases to <code>test_module</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>test_module</code></td>
<td>

<p>If the test passes, an empty string; otherwise, an informative message about
what went wrong.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>

<p>A list with three named elements (<code>inputs</code>, <code>expected_outputs</code>,
and <code>description</code>) formed from the input arguments.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cases_from_csv</code></td>
<td>

<p>A list of test cases created by the <code>case</code> function that are each
suitable for passing to the <code>test_module</code> function.
</p>
</td>
</tr>
</table>
<h3>See Also</h3>


<ul>
<li> <p><code>modules</code>
</p>
</li>
<li> <p><code>module_case_files</code>
</p>
</li>
<li> <p><code>module_paste</code>
</p>
</li>
<li> <p><code>module_testing</code>
</p>
</li>
<li> <p><code>test_module_library</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example 1: Defining an individual test case for the 'BioCro' module library's
# 'thermal_time_linear' module and running the test. This test will pass, so the
# return value will be an empty string: `character(0)`
test_module(
  'BioCro:thermal_time_linear',
  case(
    list(time = 101, sowing_time = 100, tbase = 20, temp = 44),
    list(TTc = 1.0),
    'temp above tbase'
  )
)

# Example 2: Defining an individual test case for the 'BioCro' module library's
# 'thermal_time_linear' module and running the test. This test will fail, so the
# return value will be a message indicating the failure.
test_module(
  'BioCro:thermal_time_linear',
  case(
    list(time = 101, sowing_time = 100, tbase = 20, temp = 44),
    list(TTc = 2.0),
    'temp above tbase'
  )
)

# Example 3: Loading a set of test cases from a file and running one of them.
# Note: here we use the `initialize_csv` function first to ensure that there is
# a properly defined test file in a temporary directory.

td &lt;- tempdir()

module_name &lt;- 'BioCro:thermal_time_linear'
initialize_csv(module_name, td)
cases &lt;- cases_from_csv(module_name, td)
test_module(module_name, cases[[1]])
</code></pre>


</div>