<div class="container">

<table style="width: 100%;"><tr>
<td>make_p_ind_admix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct individual-specific allele frequency matrix under the PSD admixture model</h2>

<h3>Description</h3>

<p>Here <code>m</code> is the number of loci, <code>n</code> the number of individuals, and <code>k</code> the number of intermediate subpopulations.
The <code>m</code>-by-<code>n</code> individual-specific allele frequency matrix <code>p_ind</code> is constructed from the <code>m</code>-by-<code>k</code> intermediate subpopulation allele frequency matrix <code>p_subpops</code> and the <code>n</code>-by-<code>k</code> admixture proportion matrix <code>admix_proportions</code> equivalent to
<code>p_ind &lt;- p_subpops %*% t( admix_proportions )</code>.
This function is a wrapper around <code>tcrossprod()</code>, but also ensures the output allele frequencies are in [0, 1] (otherwise not guaranteed due to limited machine precision).
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_p_ind_admix(p_subpops, admix_proportions)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p_subpops</code></td>
<td>
<p>The <code>m</code>-by-<code>k</code> matrix of intermediate subpopulation allele frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>admix_proportions</code></td>
<td>
<p>The <code>n</code>-by-<code>k</code> matrix of admixture proportions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If both <code>admix_proportions</code> and <code>p_subpops</code> have column names, and if they disagree, the function stops as a precaution, as this suggests the data is misaligned or inconsistent in some way.
</p>


<h3>Value</h3>

<p>The <code>m</code>-by-<code>n</code> matrix of individual-specific allele frequencies <code>p_ind</code>.
Row names equal those from <code>p_subpops</code>, and column names equal rownames from <code>admix_proportions</code>, if present.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data dimensions
# number of loci
m_loci &lt;- 10
# number of individuals
n_ind &lt;- 5
# number of intermediate subpops
k_subpops &lt;- 2

# FST values for k = 2 subpops
inbr_subpops &lt;- c(0.1, 0.3)

# non-trivial admixture proportions
admix_proportions &lt;- admix_prop_1d_linear(n_ind, k_subpops, sigma = 1)

# random vector of ancestral allele frequencies
p_anc &lt;- draw_p_anc(m_loci)

# matrix of intermediate subpop allele freqs
p_subpops &lt;- draw_p_subpops(p_anc, inbr_subpops)

# matrix of individual-specific allele frequencies
p_ind &lt;- make_p_ind_admix(p_subpops, admix_proportions)

</code></pre>


</div>