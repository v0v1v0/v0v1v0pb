<div class="container">

<table style="width: 100%;"><tr>
<td>mpsedist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum Product of Spacing Fit of Univariate Distributions.</h2>

<h3>Description</h3>

<p>Fit of univariate distributions for non-censored data using 
maximum product of spacing estimation (mpse), also called maximum spacing 
estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpsedist(data, distr, start = NULL, fix.arg = NULL,
  optim.method = "default", lower = -Inf, upper = Inf,
  custom.optim = NULL, weights = NULL, silent = TRUE, gradient = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector with the observed values for non-censored data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A character string <code>"name"</code> naming a distribution for which
the corresponding density function <code>dname</code> and the corresponding 
distribution function <code>pname</code> must be classically defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values of parameters of the 
named distribution or a function of data computing initial values and 
returning a named list. This argument may be omitted (default) for some 
distributions for which reasonable starting values are computed (see the 
'details' section of <code>mledist</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters 
of the named distribution or a function of data computing (fixed) parameter
values and returning a named list. Parameters with fixed value are thus NOT
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p><code>"default"</code> (see details) or an optimization method 
to pass to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Left bounds on the parameters for the <code>"L-BFGS-B"</code> method 
(see <code>optim</code>) or the <code>constrOptim</code> function (as an 
equivalent linear constraint).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Right bounds on the parameters for the <code>"L-BFGS-B"</code> method 
(see <code>optim</code>) or the <code>constrOptim</code> function (as an 
equivalent linear constraint).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom.optim</code></td>
<td>
<p>A function carrying the optimization (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of weights to be used in the fitting 
process. Should be <code>NULL</code> or a numeric vector with strictly positive 
numbers. If non-<code>NULL</code>, weighted mpse is used, otherwise ordinary 
mpse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>A function to return the gradient of the optimization
objective function for the <code>"BFGS"</code>, <code>"CG"</code> and <code>"L-BFGS-B"</code>
methods. If it is <code>NULL</code>, a finite-difference approximation will be
used, see <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the <code>optim</code>, 
<code>constrOptim</code> or <code>custom.optim</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>mpsedist</code> function carries out the maximum product of 
spacing estimation numerically, by maximization of the arithmetic mean of
<code class="reqn">\log(F(k) - F(k-1))</code>.
</p>
<p>The optimization process is the same as 
<code>mledist</code>, see the 'details' section of that 
function.
</p>
<p>Optionally, a vector of <code>weights</code> can be used in the fitting process. 
By default (when <code>weigths=NULL</code>), ordinary mpse is carried out, 
otherwise the specified weights are used to compute a weighted arithmetic
mean.
</p>
<p>We believe this function should be added to the package 
<code>fitdistrplus</code>. Until it is accepted and incorporated into that
package, it will remain in the package <code>BMT</code>. This function is 
internally called in <code>BMTfit.mpse</code>.
</p>


<h3>Value</h3>

<p><code>mpsedist</code> returns a list with following components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of 
<code>optim</code> defined as below or defined by the user in the 
user-supplied optimization function.
</p>
<p><code>0</code> indicates successful convergence.
</p>
<p><code>1</code> indicates that the iteration limit of <code>optim</code> has been
reached.
</p>
<p><code>10</code> indicates degeneracy of the Nealder-Mead simplex.
</p>
<p><code>100</code> indicates that <code>optim</code> encountered an internal 
error. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p> the value of the optimization objective function at the solution found. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p> the log-likelihood. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p> a symmetric matrix computed by <code>optim</code> as an
estimate of the Hessian at the solution found or computed in the
user-supplied optimization function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.function </code></td>
<td>
<p> the name of the optimization function used.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p> the named list giving the values of parameters of the named
distribution that must kept fixed rather than estimated by maximum
likelihood or <code>NULL</code> if there are no such parameters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>when <code>optim</code> is used, the name of the
algorithm used, <code>NULL</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or 
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls to
the log-likelihood function and its gradient respectively. This excludes
those calls needed to compute the Hessian, if requested, and any calls to
log-likelihood function to compute a finite-difference approximation to the
gradient. <code>counts</code> is returned by <code>optim</code> or the
user-supplied optimization function, or set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the 
message, see the source code.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Camilo Jose Torres-Jimenez [aut,cre] <a href="mailto:cjtorresj@unal.edu.co">cjtorresj@unal.edu.co</a>
</p>


<h3>Source</h3>

<p>Based on the function mledist of the R package: fitdistrplus
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package 
for Fitting Distributions</em>. Journal of Statistical Software, 64(4), 1-34.
</p>
<p>Functions <code>checkparam</code> and <code>start.arg.default</code> are needed and 
were copied from the same package (fitdistrplus version: 1.0-9).
</p>


<h3>References</h3>

<p>Cheng, R. and N. Amin (1983). <em>Estimating parameters in 
continuous univariate distributions with a shifted origin</em>. Journal of the 
Royal Statistical Society. Series B (Methodological), 394-403.
</p>
<p>Ranneby, B. (1984). <em>The maximum spacing method. an estimation method 
related to the maximum likelihood method</em>. Scandinavian Journal of 
Statistics, 93-112.
</p>


<h3>See Also</h3>

<p><code>mqdedist</code>, <code>mledist</code>, 
<code>mmedist</code>, <code>qmedist</code>, 
<code>mgedist</code>, and <code>optim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># (1) basic fit of a normal distribution 
set.seed(1234)
x1 &lt;- rnorm(n = 100)
mean(x1); sd(x1)
mpse1 &lt;- mpsedist(x1, "norm")
mpse1$estimate

# (2) defining your own distribution functions, here for the Gumbel 
# distribution for other distributions, see the CRAN task view dedicated 
# to probability distributions
dgumbel &lt;- function(x, a, b) 1/b*exp((a-x)/b)*exp(-exp((a-x)/b))
pgumbel &lt;- function(q, a, b) exp(-exp((a-q)/b))
qgumbel &lt;- function(p, a, b) a-b*log(-log(p))
mpse1 &lt;- mpsedist(x1, "gumbel", start = list(a = 10, b = 5))
mpse1$estimate

# (3) fit a discrete distribution (Poisson)
set.seed(1234)
x2 &lt;- rpois(n = 30, lambda = 2)
mpse2 &lt;- mpsedist(x2, "pois")
mpse2$estimate

# (4) fit a finite-support distribution (beta)
set.seed(1234)
x3 &lt;- rbeta(n = 100, shape1 = 5, shape2 = 10)
mpse3 &lt;- mpsedist(x3, "beta")
mpse3$estimate

# (5) fit frequency distributions on USArrests dataset.
x4 &lt;- USArrests$Assault
mpse4pois &lt;- mpsedist(x4, "pois")
mpse4pois$estimate
mpse4nbinom &lt;- mpsedist(x4, "nbinom")
mpse4nbinom$estimate

# (6) weighted fit of a normal distribution 
set.seed(1234)
w1 &lt;- runif(101)
mpse1 &lt;- mpsedist(x1, "norm", weights = w1)
mpse1$estimate

</code></pre>


</div>