<div class="container">

<table style="width: 100%;"><tr>
<td>master_sound_file</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a master sound file</h2>

<h3>Description</h3>

<p><code>master_sound_file</code> creates a master sound file to be used in playback experiments related to sound degradation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">master_sound_file(
  X,
  file.name,
  dest.path = getOption("dest.path", "."),
  overwrite = FALSE,
  delay = 1,
  gap.duration = 1,
  amp.marker = 2,
  flim = c(0, 4),
  cex = 14,
  path = getOption("sound.files.path", ".")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Object of class 'data.frame', 'selection_table' or 'extended_selection_table' (the last 2 classes are created by the function <code>selection_table</code> from the warbleR package) with the reference to the model sounds. Must contain the following columns: 1) "sound.files": name of the .wav files, 2) "selec": unique selection identifier (within a sound file), 3) "start": start time and 4) "end": end time of selections, 5)  "bottom.freq": low frequency for bandpass and 6) "top.freq": high frequency for bandpass. An optional 'sound.id' column can be included to use a custom label for each sound in the output. This column must contain a unique id for each sound (labels cannot repeated). If not supplied the function will make it by combining the sound file and selection columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>
<p>Character string indicating the name of the sound file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dest.path</code></td>
<td>
<p>Character string containing the directory path where the sound file will be saved.
If <code>NULL</code> (default) then the current working directory will be used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Logical argument to determine if the function will overwrite any existing sound file with the same file name. Default is the current working directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>Numeric vector of length 1 to control the duration (in s) of a silence gap at the beginning (and at the end) of the sound file. This can be useful to allow some time at the start of the playback experiment. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap.duration</code></td>
<td>
<p>Numeric vector of length 1 to control the duration (in s) of silence gaps to be placed in between sounds. Default is 1 s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amp.marker</code></td>
<td>
<p>Numeric vector of length 1 to use as a constant to amplify markers amplitude. This is useful to increase the amplitude of markers in relation to those of sounds, so it is picked up at further distances. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flim</code></td>
<td>
<p>Numeric vector of length 2 to control the frequency range in which the markers would be found. If <code>NULL</code> markers would be display across the whole frequency range. Default is c(0, 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Numeric vector of length 1 indicating the font size for the start and end markers. Default is 14.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Character string containing the directory path where the sound files are found. Only needed when 'X' is not an extended selection table. If not supplied the current working directory is used. Can be set globally for the current R session via the "sound.files.path" option (see <code>options</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is intended to simplify the creation of master sound files for playback experiments in sound degradation studies. The function clips sounds from sound files (or wave objects from extended selection tables) and concatenates them in a single sound file. The function also adds acoustic markers at the start and end of the playback that can be used to time-sync test (re-recorded) sounds to facilitate the streamlining of degradation quantification. There is no predefined limit to the duration of the output master sound file, although long this be constrained by computer memory. As a reference, master sound files of up to 10 min have been created in a 16GB RAM laptop computer.
</p>


<h3>Value</h3>

<p>A .wav file in 'path' as well as a data frame in the R environment with the annotations (i.e. time position) of sounds in the master sound file and an additional column 'sound.id' that provides a unique id for each sound in the sound file. This is useful for identifying/labeling sounds in test (re-recorded) sound files for downstream analyses.
</p>


<h3>Author(s)</h3>

<p>Marcelo Araya-Salas (<a href="mailto:marcelo.araya@ucr.ac.cr">marcelo.araya@ucr.ac.cr</a>)
</p>


<h3>References</h3>


<p>Araya-Salas M., E. Grabarczyk, M. Quiroz-Oliva, A. Garcia-Rodriguez, A. Rico-Guevara. (2023), baRulho: an R package to quantify degradation in animal acoustic signals .bioRxiv 2023.11.22.568305.

</p>


<h3>See Also</h3>

<p><code>exp_raven</code>
</p>
<p>Other prepare acoustic data: 
<code>synth_sounds()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
  # load example data from warbleR
  data(list = c(
    "Phae.long1", "Phae.long2", "Phae.long3", "Phae.long4",
    "lbh_selec_table"
  ))

  # save sound files to temporary folder
  writeWave(Phae.long1, file.path(tempdir(), "Phae.long1.wav"))
  writeWave(Phae.long2, file.path(tempdir(), "Phae.long2.wav"))
  writeWave(Phae.long3, file.path(tempdir(), "Phae.long3.wav"))
  writeWave(Phae.long4, file.path(tempdir(), "Phae.long4.wav"))

  # make an extended selection table
  est &lt;- selection_table(
    X = lbh_selec_table, extended = TRUE,
    path = tempdir()
  )

  # create master sound file
  master.sel.tab &lt;- master_sound_file(
    X = est, file.name = "example_master",
    dest.path = tempdir(), gap.duration = 0.3
  )

## Not run: 
  # the following code exports the selection table to Raven
  # using the Rraven package
  Rraven::exp_raven(master.sel.tab, path = tempdir(),
  file.name = "example_master_selection_table")
  
## End(Not run)
}

</code></pre>


</div>