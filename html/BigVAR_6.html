<div class="container">

<table style="width: 100%;"><tr>
<td>BigVAR.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simple function to fit BigVAR model with fixed penalty parameter</h2>

<h3>Description</h3>

<p>Simple function to fit BigVAR model with fixed penalty parameter
</p>


<h3>Usage</h3>

<pre><code class="language-R">BigVAR.fit(
  Y,
  p,
  struct,
  lambda,
  alpha = NULL,
  VARX = list(),
  separate_lambdas = F,
  MN = F,
  C = as.double(NULL),
  intercept = TRUE,
  tf = F,
  tol = 1e-04,
  RVAR = F,
  refit_fraction = 1,
  beta = NULL,
  gamma = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p><code class="reqn">T \times k</code> multivariate time series or Y <code class="reqn">T \times (k+m)</code> endogenous and exogenous series, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Predetermined maximal lag order (for modeled series)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>struct</code></td>
<td>
<p>The choice of penalty structure (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>vector or matrix of penalty parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>grid of candidate parameters for the alpha in the Sparse Lag and Sparse Own/Other VARX-L</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARX</code></td>
<td>
<p>List containing VARX model specifications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate_lambdas</code></td>
<td>
<p>indicator for separate penalty parameters for each time series (default <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MN</code></td>
<td>
<p>Minnesota Prior Indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>vector of coefficients to shrink toward a random walk (if <code>MN</code> is <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>True or False: option to fit an intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tf</code></td>
<td>
<p>transfer function indicator (i.e. VARX in which p=0 &amp; s&gt;0) (default false)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>optimization tolerance (default 1e-4)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RVAR</code></td>
<td>
<p>True or False: option to refit based upon the support selected using the Relaxed-VAR procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit_fraction</code></td>
<td>
<p>fraction of least squares refit to incorporate (default 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>optional <code class="reqn">k\times (k\times p + m\times s +1)</code> coefficient matrix to use as a 'warm start' (default <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>additional parameter for SCAD/MCP penalty (default 3)
</p>
<p>@details The choices for 'struct' are as follows
</p>

<ul>
<li>
<p>  'Basic' (Basic VARX-L)
</p>
</li>
<li>
<p>  'BasicEN' (Basic Elastic Net VARX-L)
</p>
</li>
<li>
<p>  'Lag' (Lag Group VARX-L) 
</p>
</li>
<li>
<p>  'SparseLag' (Lag Sparse Group VARX-L) 
</p>
</li>
<li>
<p>  'OwnOther' (Own/Other Group VARX-L) 
</p>
</li>
<li>
<p>  'SparseOO' (Own/Other Sparse Group VARX-L) 
</p>
</li>
<li>
<p>  'EFX' (Endogenous First VARX-L)
</p>
</li>
<li>
<p>  'HLAGC' (Componentwise HLAG) 
</p>
</li>
<li>
<p>  'HLAGOO' (Own/Other HLAG) 
</p>
</li>
<li>
<p>  'HLAGELEM' (Elementwise HLAG)
</p>
</li>
<li>
<p>  'Tapered' (Lag weighted Lasso VAR)
</p>
</li>
<li>
<p>  'BGR' (Bayesian Ridge Regression (cf. Banbura et al))
</p>
</li>
<li>
<p>  'MCP' (Minimax Concave Penalty (cf. Breheny and Huang))
</p>
</li>
<li>
<p>  'SCAD' (Smoothly Clipped Absolute Deviation (cf. Breheny and Huang))
</p>
</li>
</ul>
<p>VARX specifications consist of a list with entry k denoting the series that are to be modeled and entry s to denote the maximal lag order for exogenous series.
</p>
<p>The argument alpha is ignored unless the structure choice is 'SparseLag' or 'Lag.'  By default 'alpha' is set to <code>NULL</code> and will be initialized as 1/(k+1) in <code>cv.BigVAR</code> and <code>BigVAR.est</code>.  Any user supplied values must be between 0 and 1.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The specifications 'Basic', 'Lag,' 'SparseLag,' 'SparseOO,' and 'OwnOther' can accommodate both VAR and VARX models.  EFX only applies to VARX models.  'HLAGC,' 'HLAGOO,' 'HLAGELEM,' and 'Tapered' can only be used with VAR models.  Our implementation of the SCAD and MCP penalties is heavily influenced by the implementation in <code>ncvreg</code>.
</p>


<h3>References</h3>

<p>Banbura, Marta, Domenico Giannone, and Lucrezia Reichlin. 'Large Bayesian vector auto regressions.' Journal of Applied Econometrics 25.1 (2010): 71-92.
Breheny P, Huang J (2011). “Coordinate descent algorithms for nonconvex penalized regression, with applications to biological feature selection.” Annals of Applied Statistics, 5(1), 232–253.
William B Nicholson, Jacob Bien, and David S Matteson. 'High Dimensional Forecasting via Interpretable Vector Autoregression.' arXiv preprint arXiv:1412.5250, 2016.
William B. Nicholson, David S. Matteson, Jacob Bien,VARX-L: Structured regularization for large vector autoregressions with exogenous variables, International Journal of Forecasting, Volume 33, Issue 3, 2017, Pages 627-651,
William B Nicholson, David S. Matteson, and Jacob Bien (2016), 'BigVAR: Tools for Modeling Sparse High-Dimensional Multivariate Time Series' arxiv:1702.07094
</p>


<h3>See Also</h3>

<p><code>cv.BigVAR</code>,<code>BigVAR.est</code>,<code>constructModel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># VARX Example
# Fit a Basic VARX-L with k=2, m=1, s=2, p=4, lambda=1e-2
VARX=list()
VARX$k=2 # indicates that the first two series are modeled
VARX$s=2 # sets 2 as the maximal lag order for exogenous series
data(Y)
BigVAR.fit(Y,p=4,'Basic',lambda=1e-2,VARX=VARX)
</code></pre>


</div>