<div class="container">

<table style="width: 100%;"><tr>
<td>calculateU_ns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the (sparse) matrix U</h2>

<h3>Description</h3>

<p><code>calculateU_ns</code> calculates the (sparse) matrix U (i.e., the Cholesky 
of the inverse covariance matrix) using a nonstationary covariance function.
The output only contains non-zero values and is stored as three vectors: 
(1) the row indices, (2) the column indices, and (3) the non-zero values.
NOTE: this code assumes the all inputs correspond to the ORDERED locations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculateU_ns(
  dist1_3d,
  dist2_3d,
  dist12_3d,
  Sigma11,
  Sigma22,
  Sigma12,
  log_sigma_vec,
  log_tau_vec,
  nu,
  nID,
  cond_on_y,
  N,
  k,
  d,
  M = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist1_3d</code></td>
<td>
<p>N x (k+1) x (k+1) array of distances in the x-coordinate 
direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist2_3d</code></td>
<td>
<p>N x (k+1) x (k+1) array of distances in the y-coordinate 
direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist12_3d</code></td>
<td>
<p>N x (k+1) x (k+1) array of cross-distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma11</code></td>
<td>
<p>N-vector; 1-1 element of the Sigma() process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma22</code></td>
<td>
<p>N-vector; 2-2 element of the Sigma() process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma12</code></td>
<td>
<p>N-vector; 1-2 element of the Sigma() process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_sigma_vec</code></td>
<td>
<p>N-vector; process standard deviation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_tau_vec</code></td>
<td>
<p>N-vector; nugget standard deviation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Scalar; Matern smoothness parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nID</code></td>
<td>
<p>N x k matrix of (ordered) neighbor indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond_on_y</code></td>
<td>
<p>A matrix indicating whether the conditioning set for each 
(ordered) location is on the latent process (y, <code>1</code>) or the observed 
values (z, <code>0</code>). Calculated in <code>sgvSetup</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Scalar; number of data measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Scalar; number of nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Scalar; dimension of the spatial domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Scalar; number of prediction sites.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a sparse matrix representation of the Cholesky of the
precision matrix for a fixed set of covariance parameters.
</p>


</div>