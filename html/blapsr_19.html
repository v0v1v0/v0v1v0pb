<div class="container">

<table style="width: 100%;"><tr>
<td>penaltyplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the approximate posterior distribution of the penalty vector.</h2>

<h3>Description</h3>

<p>The routine gives a graphical representation of the univariate
approximate posterior distribution of the (log-)penalty parameters for
objects of class <em>coxlps</em>, <em>curelps</em>, <em>amlps</em> and
<em>gamlps</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">penaltyplot(object, dimension, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>coxlps</code>, <code>curelps</code>, <code>amlps</code>
or <code>gamlps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>
<p>For objects of class <code>amlps</code> and <code>gamlps</code>, the
penalty vector can have a dimension larger than one, i.e. more than a
single smooth term is present in the considered additive model. In that case,
<code>dimension</code> is the penalty dimension to be plotted
corresponding either to a scalar indicating the desired dimension or to a
vector indicating more than one dimension. For instance, dimension = c(1,3)
displays two separate plots of the (approximate) posterior distribution of
the (log-)penalty parameter associated to the first and the third smooth
function respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to the routine.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When q, the number of smooth term in a (generalized) additive model is
smaller than five, the exploration of the posterior penalty space is based
on a grid strategy. In particular, the multivariate grid of dimension q is
constructed by taking the Cartesian product of univariate grids in each
dimension j = 1,...q. These univariate grids are obtained from a skew-normal
fit to the conditional posterior p(vj|vmap[-j]),D), where vj is the
(log-)penalty value associated to the jth smooth function and vmap[-j] is
the posterior maximum of the (log-)penalty vector omitting the jth
dimension. The routine displays the latter skew-normal distributions. When
q&gt;=5, inference is based on vmap and the grid is omitted to avoid
computational overflow. In that case, the posterior distribution of the
(log-)posterior penalty vector v is approximated by a multivariate Gaussian
and the routine shows the marginal distributions.
</p>


<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Classic simulated data example (with simgamdata)

set.seed(123)
sim.data &lt;- simgamdata(setting = 2, n = 250, dist = "gaussian", scale = 0.25)
plot(sim.data)         # Scatter plot of response
data &lt;- sim.data$data  # Simulated data frame
# Fit model
fit &lt;- amlps(y ~ z1 + z2 + sm(x1) + sm(x2), data = data, K = 15)
fit

# Penalty plot
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
penaltyplot(fit, dimension = c(1, 2))
par(opar)

</code></pre>


</div>