<div class="container">

<table style="width: 100%;"><tr>
<td>BIOMASS-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BIOMASS: Estimating Aboveground Biomass and Its Uncertainty in Tropical Forests</h2>

<h3>Description</h3>

<p>Contains functions to estimate aboveground biomass/carbon and its uncertainty in tropical forests. These functions allow to (1) retrieve and to correct taxonomy, (2) estimate wood density and its uncertainty, (3) construct height-diameter models, (4) manage tree and plot coordinates, (5) estimate the aboveground biomass/carbon at the stand level with associated uncertainty. To cite 'BIOMASS', please use citation("BIOMASS"). See more in the article of Réjou-Méchain et al. (2017) <a href="https://doi.org/10.1111/2041-210X.12753">doi:10.1111/2041-210X.12753</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dominique Lamonica <a href="mailto:dominique.lamonica@ird.fr">dominique.lamonica@ird.fr</a>
</p>
<p>Authors:
</p>

<ul>
<li>
<p> Maxime Réjou-Méchain <a href="mailto:maxime.rejou@gmail.com">maxime.rejou@gmail.com</a> [data contributor]
</p>
</li>
<li>
<p> Guillaume Cornu <a href="mailto:gcornu@cirad.fr">gcornu@cirad.fr</a> (<a href="https://orcid.org/0000-0002-7523-5176">ORCID</a>)
</p>
</li>
<li>
<p> Arthur Pere
</p>
</li>
<li>
<p> Ariane Tanguy
</p>
</li>
<li>
<p> Camille Piponiot
</p>
</li>
<li>
<p> Bruno Hérault <a href="mailto:bruno.herault@cirad.fr">bruno.herault@cirad.fr</a>
</p>
</li>
</ul>
<p>Other contributors:
</p>

<ul>
<li>
<p> Jerome Chave <a href="mailto:jerome.chave@univ-tlse3.fr">jerome.chave@univ-tlse3.fr</a> [data contributor]
</p>
</li>
<li>
<p> Ted Feldpausch <a href="mailto:T.R.Feldpausch@exeter.ac.uk">T.R.Feldpausch@exeter.ac.uk</a> [data contributor]
</p>
</li>
<li>
<p> Philippe Verley <a href="mailto:philippe.verley@ird.fr">philippe.verley@ird.fr</a> [contributor]
</p>
</li>
</ul>
<h3>References</h3>

<p>Réjou-Méchain M., Tanguy A., Piponiot C., Chave J., Hérault B. (2017). BIOMASS :
An R Package for estimating above-ground biomass and its uncertainty in tropical forests.
Methods in Ecology and Evolution, 8(9), 1163-1167.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/umr-amap/BIOMASS">https://github.com/umr-amap/BIOMASS</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/umr-amap/BIOMASS/issues">https://github.com/umr-amap/BIOMASS/issues</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
library(BIOMASS)

# Dataset containing plot inventory data from Karnataka, India (Ramesh et al. 2010)
data(KarnatakaForest)
str(KarnatakaForest)

# Dataset containing height and diameter measurements from two 1-ha plots
# established in the lowland rainforest of French Guiana, at the Nouragues
# Ecological Research Station
data(NouraguesHD)
str(NouraguesHD)

#############################################################################
# WOOD DENSITY

# 1-RETRIEVE AND CORRECT TAXONOMY

# Checking typos in taxonomy
Taxo &lt;- correctTaxo(genus = KarnatakaForest$genus, species = KarnatakaForest$species)
KarnatakaForest$genusCorr &lt;- Taxo$genusCorrected
KarnatakaForest$speciesCorr &lt;- Taxo$speciesCorrected

# Retrieving APG III Families and Orders from Genus names
APG &lt;- getTaxonomy(KarnatakaForest$genusCorr, findOrder = TRUE)
KarnatakaForest$familyAPG &lt;- APG$family
KarnatakaForest$orderAPG &lt;- APG$order

# 2-RETRIEVE WOOD DENSITY
dataWD &lt;- getWoodDensity(
  genus = KarnatakaForest$genusCorr,
  species = KarnatakaForest$speciesCorr,
  stand = KarnatakaForest$plotID
)

#############################################################################
# TREE HEIGHT

# Compare different local H-D models
modelHD(
  D = NouraguesHD$D, H = NouraguesHD$H,
  drawGraph = TRUE, useWeight = TRUE
)

# Compute the local H-D model with the lowest RSE
HDmodel &lt;- modelHD(
  D = NouraguesHD$D, H = NouraguesHD$H,
  method = "log2", useWeight = TRUE
)

# Compute plot-specific H-D models
HDmodelPerPlot &lt;- modelHD(NouraguesHD$D, NouraguesHD$H,
  method = "weibull",
  useWeight = TRUE, plot = NouraguesHD$plotId
)

RSEmodels &lt;- sapply(HDmodelPerPlot, function(x) x$RSE)
Coeffmodels &lt;- lapply(HDmodelPerPlot, function(x) x$coefficients)

# Retrieve height data from a local HD model
dataHlocal &lt;- retrieveH(D = KarnatakaForest$D, model = HDmodel)

# Retrieve height data from a Feldpaush et al. (2012) averaged model
dataHfeld &lt;- retrieveH(D = KarnatakaForest$D, region = "SEAsia")

# Retrieve height data from Chave et al. (2012) equation 6
dataHchave &lt;- retrieveH(
  D = KarnatakaForest$D,
  coord = cbind(KarnatakaForest$long, KarnatakaForest$lat)
)

#############################################################################
# AGB CALCULATION

KarnatakaForest$WD &lt;- dataWD$meanWD
KarnatakaForest$H &lt;- dataHlocal$H
KarnatakaForest$Hfeld &lt;- dataHfeld$H

# Compute AGB(Mg) per tree
AGBtree &lt;- computeAGB(
  D = KarnatakaForest$D, WD = KarnatakaForest$WD,
  H = KarnatakaForest$H
)

# Compute AGB(Mg) per plot
AGBplot &lt;- summaryByPlot(AGBtree, KarnatakaForest$plotId)

# Compute AGB(Mg) per tree without height information (Eq. 7 from Chave et al. (2014))
AGBplotChave &lt;- summaryByPlot(
  computeAGB(
    D = KarnatakaForest$D, WD = KarnatakaForest$WD,
    coord = KarnatakaForest[, c("long", "lat")]
  ),
  plot = KarnatakaForest$plotId
)

# Compute AGB(Mg) per tree with Feldpausch et al. (2012) regional H-D model
AGBplotFeld &lt;- summaryByPlot(
  computeAGB(
    D = KarnatakaForest$D, WD = KarnatakaForest$WD,
    H = KarnatakaForest$Hfeld
  ),
  plot = KarnatakaForest$plotId
)

#############################################################################
# PROPAGATING ERRORS

KarnatakaForest$sdWD &lt;- dataWD$sdWD
KarnatakaForest$HfeldRSE &lt;- dataHfeld$RSE

# Per plot using the local HD model constructed above (modelHD)
resultMC &lt;- AGBmonteCarlo(
  D = KarnatakaForest$D, WD = KarnatakaForest$WD, errWD = KarnatakaForest$sdWD,
  HDmodel = HDmodel, Dpropag = "chave2004"
)
resMC &lt;- summaryByPlot(resultMC$AGB_simu, KarnatakaForest$plotId)

# Per plot using the Feldpaush regional HD averaged model
AGBmonteCarlo(
  D = KarnatakaForest$D, WD = KarnatakaForest$WD,
  errWD = KarnatakaForest$sdWD, H = KarnatakaForest$Hfeld,
  errH = KarnatakaForest$HfeldRSE, Dpropag = "chave2004"
)
resMC &lt;- summaryByPlot(resultMC$AGB_simu, KarnatakaForest$plotId)

# Per plot using Chave et al. (2014) Equation 7
resultMC &lt;- AGBmonteCarlo(
  D = KarnatakaForest$D, WD = KarnatakaForest$WD, errWD = KarnatakaForest$sdWD,
  coord = KarnatakaForest[, c("long", "lat")],
  Dpropag = "chave2004"
)
resMC &lt;- summaryByPlot(resultMC$AGB_simu, KarnatakaForest$plotId)

</code></pre>


</div>