<div class="container">

<table style="width: 100%;"><tr>
<td>mtarmissing</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of missing values of observed, covariate and threshold processes</h2>

<h3>Description</h3>

<p>Estimation using Bayesian methodology of missing values in observed(output), covariate and threshold processes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mtarmissing(ini_obj,niter = 1000, chain = FALSE, level = 0.95,
burn = NULL, cU = 0.5, b = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ini_obj</code></td>
<td>
<p>class “<code>regime_inipars</code>” object, here specificate in pars: l, orders and r known. Not NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>numeric type, number of runs of MCMC. Default 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>logical type, if return chains of parameters. Default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric type, confident interval for estimations. Default 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>numeric type, number of initial runs. Default NULL (10% of niter)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cU</code></td>
<td>
<p>numeric type, coefficient of the diagonal covariance matrix of process Ut = (Zt,Xt). Default 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>numeric type greater or equal 1, autoregressive order of Ut = (Zt,Xt). Default NULL meaning 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The MTAR model
</p>
<p><code class="reqn">Y_t= \phi^{(j)}_{0}+ \sum_{i=1}^{p_j} \phi_{i}^{(j)}Y_{t-i}+  \sum_{i=1}^{q_j}\beta_{i}^{(j)}X_{t-i} + \sum{i=1}^{d_j}\delta_{i}^{(j)}Z_{t-i} +\Sigma_{(j)}^{1/2} \epsilon_{t}  if  r_{j-1}&lt; Z_t \le r_{j},</code>
</p>
<p>is written into a state space model with regime-switching where the matrices depend on the threshold variable. In order to estimate the missing data in the observed vector <code class="reqn">Y_t</code>, it is necessary to obtain samples of the full conditional distribution of the state vector <code class="reqn">\alpha_t</code>, for all times <code class="reqn">t=1,\cdots,T</code> using Kalman Filter. It is assumed that the process <code class="reqn">U_t=(X_t,Z_t)</code> is a Markov chain, and in order to get samples of the full conditional distribution of <code class="reqn">U_t, t=1,\cdots,T</code>, it is supposed that kernel and initial distribution
are Gaussian for simplicity. However, in the next updates, we are going to get flexibility at this point.
</p>


<h3>Value</h3>

<p>Return list type object of class “<code>regime_missing</code>”
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tsregime</code></td>
<td>
<p>ini_obj$tsregime_obj with estimated observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>confident interval and mean of estimated missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Chain</code></td>
<td>
<p>if chain TRUE, chains of the estimated missing values</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("datasim")
yt = datasim$Sim
# some missing data
data_yt = yt$Yt
data_zt = yt$Zt
posNA = sample(c(1:500),8)
data_yt[c(posNA),] = c(NA,NA)
posNA = sample(c(1:500),8)
data_zt[c(posNA)] = NA
data_final = tsregime(data_yt,data_zt,r = yt$r)
autoplot.tsregime(data_final,1)
autoplot.tsregime(data_final,2)

initial = mtarinipars(tsregime_obj = data_final,
list_model = list(pars = list(l = 2,r = datasim$Sim$r,
orders = list(pj = c(1,1), qj = c(0,0),dj = c(0,0)))))

missingest = mtarmissing(ini_obj = initial,chain = TRUE,
niter = 500,burn = 500)
print(missingest)
autoplot.regime_missing(missingest,1)
datasim$Sim$Yt[is.na(data_yt[,1]),]
missingest$tsregime$Yt[is.na(data_yt[,1]),]

</code></pre>


</div>