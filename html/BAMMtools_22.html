<div class="container">

<table style="width: 100%;"><tr>
<td>getCohortMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the pairwise correlation in rate regimes between all tips
in a <code>bammdata</code> object</h2>

<h3>Description</h3>

<p>Takes a <code>bammdata</code> object and computes the pairwise
correlation in evolutionary rate regimes between all tips in the
phylogeny. This can be used to identify cohorts of taxa that share
common macroevolutionary rate parameters. It can also be used to
construct a correlation matrix for GLS analyses using
<code>BAMM</code>-estimated tip rates of speciation, extinction, or
phenotypic evolution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getCohortMatrix(ephy)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The cohort matrix is important for interpreting and visualizing
macroevolutionary dynamics. Each entry [i, j] of the cohort matrix is
the probability that taxon i and taxon j share a common
macroevolutionary rate regime. To compute this, we simply tabulate the
percentage of samples from the posterior where taxon i and taxon j
were placed in the same rate regime. If there is no rate heterogeneity
in the dataset (e.g., the data are best explained by a single rate
regime), then all species will tend to share the same rate regime and
all values of the cohort matrix will approach 1. 
</p>
<p>A value of 0 between any two taxa means that at least one rate shift
occurred on the nodal path connecting them in 100% of samples from
the posterior. A value of 0.50 would imply that 50% of samples from
the posterior included a rate shift on the path connecting taxa i and
j. See below (Examples) for an illustration of this.
</p>


<h3>Value</h3>

<p>A numeric matrix of dimension k x k, where k is the number of
species in the phylogeny included in the <code>bammdata</code> object.
Species names are included as row names and column names. The matrix
is symmetric, such that the values for entry [i , j] will mirror those
for [j , i].
</p>


<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>References</h3>

<p><a href="http://bamm-project.org/">http://bamm-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, nsamples=500)

cormat &lt;- getCohortMatrix(ed)

dim(cormat)
hist(cormat, breaks=50)
</code></pre>


</div>