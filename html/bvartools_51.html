<div class="container">

<table style="width: 100%;"><tr>
<td>stochvol_ksc1998</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stochastic Volatility</h2>

<h3>Description</h3>

<p>Produces a draw of log-volatilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stochvol_ksc1998(y, h, sigma, h_init, constant)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code class="reqn">T \times K</code> matrix containing the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a <code class="reqn">T \times K</code> vector of the current draw of log-volatilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a <code class="reqn">K \times 1</code> vector of variances of log-volatilities,
where the <code class="reqn">i</code>th element corresponds to the <code class="reqn">i</code>th column in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_init</code></td>
<td>
<p>a <code class="reqn">K \times 1</code> vector of the initial states of log-volatilities,
where the <code class="reqn">i</code>th element corresponds to the <code class="reqn">i</code>th column in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant</code></td>
<td>
<p>a <code class="reqn">K \times 1</code> vector of constants that should be added to <code class="reqn">y^2</code>
before taking the natural logarithm. The <code class="reqn">i</code>th element corresponds to
the <code class="reqn">i</code>th column in <code>y</code>. See 'Details'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each column in <code>y</code> the function produces a posterior
draw of the log-volatility <code class="reqn">h</code> for the model
</p>
<p style="text-align: center;"><code class="reqn">y_{t} = e^{\frac{1}{2}h_t} \epsilon_{t},</code>
</p>

<p>where <code class="reqn">\epsilon_t \sim N(0, 1)</code> and <code class="reqn">h_t</code> is assumed to evolve according to a random walk
</p>
<p style="text-align: center;"><code class="reqn">h_t = h_{t - 1} + u_t,</code>
</p>

<p>with <code class="reqn">u_t \sim N(0, \sigma^2)</code>.
</p>
<p>The implementation is based on the algorithm of Kim, Shephard and Chip (1998) and performs the
following steps:
</p>

<ol>
<li>
<p> Perform the transformation <code class="reqn">y_t^* = ln(y_t^2 + constant)</code>.
</p>
</li>
<li>
<p> Obtain a sample from the seven-component normal mixture for
approximating the log-<code class="reqn">\chi_1^2</code> distribution.
</p>
</li>
<li>
<p> Obtain a draw of log-volatilities.
</p>
</li>
</ol>
<p>The implementation follows the code provided on the website to the textbook
by Chan, Koop, Poirier, and Tobias (2019).
</p>


<h3>Value</h3>

<p>A vector of log-volatility draws.
</p>


<h3>References</h3>

<p>Chan, J., Koop, G., Poirier, D. J., &amp; Tobias J. L. (2019). <em>Bayesian econometric methods</em>
(2nd ed.). Cambridge: Cambridge University Press.
</p>
<p>Kim, S., Shephard, N., &amp; Chib, S. (1998). Stochastic volatility. Likelihood inference and comparison
with ARCH models. <em>Review of Economic Studies 65</em>(3), 361â€“393. <a href="https://doi.org/10.1111/1467-937X.00050">doi:10.1111/1467-937X.00050</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("us_macrodata")
y &lt;- matrix(us_macrodata[, "r"])

# Initialise log-volatilites
h_init &lt;- matrix(log(var(y)))
h &lt;- matrix(rep(h_init, length(y)))

# Obtain draw
stochvol_ksc1998(y - mean(y), h, matrix(.05), h_init, matrix(0.0001))

</code></pre>


</div>