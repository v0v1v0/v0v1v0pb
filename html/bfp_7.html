<div class="container">

<table style="width: 100%;"><tr>
<td>BmaSamples</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian model averaging over multiple fractional polynomial
models</h2>

<h3>Description</h3>

<p>Draw samples from the Bayesian model average over the models in
saved in a <code>BayesMfp</code>-object. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">BmaSamples(object, sampleSize = length(object) * 10, postProbs =
posteriors(object), gridList = list(), gridSize = 203, newdata=NULL,
verbose = TRUE, includeZeroSamples=FALSE)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>valid <code>BayesMfp</code> object containing the
models over which to average</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleSize</code></td>
<td>
<p>sample size (default is 10 times the number of models)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postProbs</code></td>
<td>
<p>vector of posterior probabilites (will be normalized
within the function, defaults to the normalized posterior probabilities)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridList</code></td>
<td>
<p>optional list of appropriately named grid vectors for FP evaluation,
default is a length (<code>gridSize</code> - 2) grid per covariate additional to the observed values
(two are at the minimum and maximum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridSize</code></td>
<td>
<p>see above (default: 203)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>new covariate data.frame with exactly the names (and
preferably ranges) as before (default: no new covariate data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>should information on sampling progress be printed?
(default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includeZeroSamples</code></td>
<td>
<p>should the function and coefficient samples
include zero samples, from models where these covariates are not
included at all? (default: <code>FALSE</code>, so the zero samples are
not included)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return an object of class <code>BmaSamples</code>, which is a list with
various elements that describe the <code>BayesMfp</code> object over which
was averaged, model frequencies in the samples, the samples themselves
etc:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>priorSpecs</code></td>
<td>
<p>the utilized prior specifications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>termNames</code></td>
<td>
<p>a list of character vectors containing the names of
uncertain covariate groups, fractional polynomial terms and fixed
variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftScaleMax</code></td>
<td>
<p>matrix with 4 columns containing preliminary
transformation parameters, maximum degrees and cardinalities of the
powersets of the fractional polynomial terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the shifted and scaled design matrix for the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomSeed</code></td>
<td>
<p>if a seed existed at function call
(<code>get(".Random.seed", .GlobalEnv)</code>), it is saved here</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelFreqs</code></td>
<td>
<p>The table of model frequencies in the BMA sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelData</code></td>
<td>
<p>data frame containing the normalized posterior
probabilities of the models in the underlying <code>BayesMfp</code>
object, corresponding log marginal likelihoods, model prior
probabilities, posterior expected covariance and shrinkage factors,
coefficients of determination, powers and inclusions, and finally
model average weights and relative frequencies in the BMA sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleSize</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>BMA samples of the regression variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>BMA samples of the shrinkage factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>samples of the intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bfp</code></td>
<td>
<p>named list of the FP function samples, where each element
contains one FP covariate and is a matrix (samples x grid), with the
following attributes:
</p>

<dl>
<dt>whereObsVals</dt>
<dd>
<p>where in the scaled grid are the originally
observed covariate values? (integer vector of the indexes)</p>
</dd>
<dt>scaledGrid</dt>
<dd>
<p>numeric vector with the positions of the scaled
grid points, corresponding to the columns of the samples matrix</p>
</dd>
<dt>counter</dt>
<dd>
<p>how often has this covariate been included in the BMA
sample? (identical to the number of rows in the samples matrix)</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uc</code></td>
<td>
<p>named list of the uncertain fixed form covariates, where each
element contains the coefficient samples of one group: in a matrix
with the attribute <code>counter</code> as number of samples in the rows,
and the columns are appropriately named to correspond to the single
design variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>fitted values of all models in <code>object</code>, in a matrix
with layout models x observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictions</code></td>
<td>
<p>samples from the predictive distribution at the
covariates given in <code>newdata</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictMeans</code></td>
<td>
<p>means of the predictive distribution at the
covariates given in <code>newdata</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>BmaSamples Methods, <code>BayesMfp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## construct a BayesMfp object
set.seed(19)

x1 &lt;- rnorm (n=15)
x2 &lt;- rbinom (n=15, size=20, prob=0.5) 
x3 &lt;- rexp (n=15)

y &lt;- rt (n=15, df=2)

test &lt;- BayesMfp (y ~ bfp (x2, max = 4) + uc (x1 + x3), nModels = 200, method="exhaustive")

## now draw samples from the Bayesian model average
testBma &lt;- BmaSamples (test)
testBma

## We can also draw predictive samples for new data points, but then
## we need to supply the new data to BmaSamples:
newdata &lt;- data.frame(x1 = rnorm(15),
                      x2 = rbinom(n=15, size=5, prob=0.2) + 1,
                      x3 = rexp(n=15))
testBma &lt;- BmaSamples(test, newdata=newdata)
predict(testBma)

## test that inclusion of zero samples works
testBma &lt;- BmaSamples (test, includeZeroSamples=TRUE)
testBma
</code></pre>


</div>