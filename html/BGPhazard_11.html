<div class="container">

<table style="width: 100%;"><tr>
<td>CCuMRes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Semiparametric Cure Rate Model with an Unknown Threshold and
Covariate Information</h2>

<h3>Description</h3>

<p>Posterior inference for the bayesian semiparmetric cure rate model with
covariates in survival analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CCuMRes(
  data,
  covs.x = names(data)[seq.int(3, ncol(data))],
  covs.y = names(data)[seq.int(3, ncol(data))],
  type.t = 3,
  K = 50,
  utao = NULL,
  alpha = rep(0.01, K),
  beta = rep(0.01, K),
  c.r = rep(0, K - 1),
  c.nu = 1,
  var.theta.str = 25,
  var.delta.str = 25,
  var.theta.ini = 100,
  var.delta.ini = 100,
  type.c = 4,
  a.eps = 0.1,
  b.eps = 0.1,
  epsilon = 1,
  iterations = 5000,
  burn.in = floor(iterations * 0.2),
  thinning = 3,
  printtime = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Double tibble. Contains failure times in the first column,
status indicator in the second, and, from the third to the last column, the
covariate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs.x</code></td>
<td>
<p>Character. Names of covariables to be part of the
multiplicative part of the hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs.y</code></td>
<td>
<p>Character. Names of covariables to determine the cure
threshold por each patient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.t</code></td>
<td>
<p>Integer. 1=computes uniformly-dense intervals; 2=
partition arbitrarily defined by the user with parameter utao and 3=same length intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Integer. Partition length for the hazard function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>utao</code></td>
<td>
<p>vector. Partition specified by the user when type.t = 2. The first value of 
the vector has to be 0 and the last one the maximum observed time, either censored or uncensored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Nonnegative entry vector. Small entries are recommended in
order to specify a non-informative prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Nonnegative entry vector. Small entries are recommended in order
to specify a non-informative prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.r</code></td>
<td>
<p>Nonnegative vector. The higher the entries, the higher the correlation of two consective intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.nu</code></td>
<td>
<p>Tuning parameter for the proposal distribution for c. 
Only when <code>type.c</code> is 3 or 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.theta.str</code></td>
<td>
<p>Double. Variance of the proposal normal distribution
for theta in the Metropolis-Hastings step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.delta.str</code></td>
<td>
<p>Double. Variance of the proposal normal distribution
for delta in the Metropolis-Hastings step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.theta.ini</code></td>
<td>
<p>Double. Variance of the prior normal distribution for theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.delta.ini</code></td>
<td>
<p>Double. Variance of the prior normal distribution for delta.
from the acceptance ratio in the Metropolis-Hastings algorithm for delta*.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.c</code></td>
<td>
<p>1=defines <code>c.r</code> as a zero-entry vector; 2=lets the user
define <code>c.r</code> freely; 3=assigns <code>c.r</code> an exponential prior
distribution with mean 1; 4=assigns <code>c.r</code> an exponential hierarchical 
distribution with mean <code>epsilon</code> which in turn has a Ga(a.eps, b.eps)
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.eps</code></td>
<td>
<p>Double. Shape parameter for the prior gamma distribution of
epsilon when <code>type.c = 4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.eps</code></td>
<td>
<p>Double. Scale parameter for the prior gamma distribution of
epsilon when <code>type.c = 4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Double. Mean of the exponencial distribution assigned to
<code>c.r</code> when <code>type.c = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Integer. Number of iterations including the <code>burn.in</code>
to be computed for the Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>Integer. Length of the burn-in period for the Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>Integer. Factor by which the chain will be thinned. Thinning
the Markov chain reduces autocorrelation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printtime</code></td>
<td>
<p>Logical. If <code>TRUE</code>, prints out the execution time.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the Gibbs sampler with the full conditional distributions of
all model parameters (Nieto-Barajas &amp; Yin, 2008) and arranges the resulting Markov
chain into a tibble which can be used to obtain posterior summaries. Prior
distributions for the regression coefficients Theta and Delta are assumend
independent normals with zero mean and variance <code>var.theta.ini</code>,
<code>var.delta.ini</code>, respectively.
</p>


<h3>Note</h3>

<p>It is recommended to verify chain's stationarity. This can be done by
checking each element individually. See <code>CCuPlotDiag</code>.
</p>


<h3>References</h3>

<p>- Nieto-Barajas, L. E., &amp; Yin, G. (2008). Bayesian
semiparametric cure rate model with an unknown threshold. Scandinavian
Journal of Statistics, 35(3), 540-556.
https://doi.org/10.1111/j.1467-9469.2007.00589.x
</p>
<p>- Nieto-barajas, L. E. (2002). Discrete time Markov gamma processes and time
dependent covariates in survival analysis. Statistics, 2-5.
</p>


<h3>See Also</h3>

<p>CCuPlotDiag, CCuPloth
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# data(BMTKleinbook)
    # res &lt;- CCuMRes(BMTKleinbook, covs.x = c("tTransplant","hodgkin","karnofsky","waiting"),
    #                covs.y = c("tTransplant","hodgkin","karnofsky","waiting"),
    #                        type.t = 2, K = 72, length = 30,
    #                        alpha = rep(2,72), beta = rep(2,72), c.r = rep(50, 71), type.c = 2,
    #                        var.delta.str = .1, var.theta.str = 1,
    #                        var.delta.ini = 100, var.theta.ini = 100,
    #                        iterations = 100, burn.in = 10, thinning = 1)



</code></pre>


</div>