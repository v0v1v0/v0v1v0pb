<div class="container">

<table style="width: 100%;"><tr>
<td>make.state.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create state.matrix.object
</h2>

<h3>Description</h3>

<p>Create a state.matrix.object to be used encode marker information in a
form in which it can be used in subsequent calculations. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.state.matrix(marker.frame, marker.distances, method="F2")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marker.frame</code></td>
<td>

<p>Actually, this is a misnomer. This is NOT
a<code>marker.frame.object</code>. Rather it is obtained by by call like
<code>make.marker.numeric(marker.frame.object)</code> (see <code>
      make.marker.numeric </code>) and it is coerced to 
a matrix. It  encodes marker allele states. One column is used for each 
marker or pseudo-marker (basically a placeholder with all missing
values). The entries are in 1:6, if NA's are present, they are
recoded to 6.  The columns are arranged in
linkage groups with presumed order reflected in the actual order of the
columns.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.distances</code></td>
<td>

<p>Distances between the markers in the 'lambda' metric. -log(lambda)/2
is the Haldance map distance. Linkage groups are separated by values
of 0.0. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>method = "F2" is the default, and   "BC1", "RI.self", and "RI.sib" are
other options. The assumed setup is as follows (strains are A and a):
</p>

<table>
<tr>
<td style="text-align: left;">
    marker state </td>
<td style="text-align: center;">  F2.code </td>
<td style="text-align: center;">  BC.code</td>
<td style="text-align: center;"> RI.code </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"AA"</code>  </td>
<td style="text-align: center;">    1    </td>
<td style="text-align: center;">     1   </td>
<td style="text-align: center;">    1</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"Aa"</code> </td>
<td style="text-align: center;">     2  </td>
<td style="text-align: center;">      2 </td>
<td style="text-align: center;"> </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"aa"</code>  </td>
<td style="text-align: center;">    3   </td>
<td style="text-align: center;">        </td>
<td style="text-align: center;">      2 </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"A-"</code> (not aa)    </td>
<td style="text-align: center;">  4      </td>
<td style="text-align: center;">   </td>
<td style="text-align: center;">     </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"a-"</code> (not AA) </td>
<td style="text-align: center;">    5    </td>
<td style="text-align: center;">     </td>
<td style="text-align: center;">        </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"--"</code> (unknown) </td>
<td style="text-align: center;">    6 </td>
<td style="text-align: center;">        6   </td>
<td style="text-align: center;">    6</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Value</h3>

<p>n by k by q array. q is  3 for method="F2" and 2 for others methods.  Each
element encodes the probability of the allele state conditional on the
marker states. 
</p>


<h3>Note</h3>

<p>It might have been better to design this array so that the third
subscript moves fastest.  In large problems, the current structure may
involve excessive memory access.</p>


<h3>References</h3>

<p>Lander E.S. and Green P. (1987) Construction of multilocus genetic linkage maps
in humans. <em>Proceedings of the National Academy of Sciences of the
United States of America</em>, <b>84</b>(8), 2363â€“7.
</p>
<p>Jiang C. and Zeng Z-B.  (1997) Mapping quantitative trait loci with dominant and
missing markers in various crosses from tow inbred lines. <em>Genetica</em>
<b>101</b>, 47-58.  
</p>


</div>