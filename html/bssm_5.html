<div class="container">

<table style="width: 100%;"><tr>
<td>asymptotic_var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic Variance of IS-type Estimators</h2>

<h3>Description</h3>

<p>The asymptotic variance MCMCSE^2 is based on Corollary 1
of Vihola et al. (2020) from weighted samples from IS-MCMC. The default
method is based on the integrated autocorrelation time (IACT) by Sokal
(1997) which seem to work well for reasonable problems, but it is also
possible to use the Geyer's method as implemented in <code>ess_mean</code> of the
<code>posterior</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">asymptotic_var(x, w, method = "sokal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A numeric vector of weights. If missing, set to 1 (i.e. no
weighting is assumed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for computing IACT. Default is <code>"sokal"</code>,
other option <code>"geyer"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A single numeric value of asymptotic variance estimate.
</p>


<h3>References</h3>

<p>Vihola M, Helske J, Franks J. (2020). Importance sampling type estimators
based on approximate marginal Markov chain Monte Carlo.
Scand J Statist. 1-38. https://doi.org/10.1111/sjos.12492
</p>
<p>Sokal A. (1997). Monte Carlo Methods in Statistical Mechanics: Foundations
and New Algorithms.
In: DeWitt-Morette C, Cartier P, Folacci A (eds) Functional Integration.
NATO ASI Series (Series B: Physics), vol 361. Springer, Boston, MA.
https://doi.org/10.1007/978-1-4899-0319-8_6
</p>
<p>Gelman, A, Carlin J B, Stern H S, Dunson, D B, Vehtari A, Rubin D B. (2013).
Bayesian Data Analysis, Third Edition. Chapman and Hall/CRC.
</p>
<p>Vehtari A, Gelman A, Simpson D, Carpenter B, BÃ¼rkner P-C. (2021).
Rank-normalization, folding, and localization: An improved Rhat for
assessing convergence of MCMC. Bayesian analysis, 16(2):667-718.
https://doi.org/10.1214/20-BA1221
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 1e4 
x &lt;- numeric(n)
phi &lt;- 0.7
for(t in 2:n) x[t] &lt;- phi * x[t-1] + rnorm(1)
w &lt;- rexp(n, 0.5 * exp(0.001 * x^2))
# different methods:
asymptotic_var(x, w, method = "sokal")
asymptotic_var(x, w, method = "geyer")

data("negbin_model")
# can be obtained directly with summary method
d &lt;- suppressWarnings(as_draws(negbin_model))
sqrt(asymptotic_var(d$sd_level, d$weight))

</code></pre>


</div>