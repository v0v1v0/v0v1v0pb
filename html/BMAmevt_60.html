<div class="container">

<table style="width: 100%;"><tr>
<td>scores3D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logarithmic score and <code class="reqn">L^2</code> distance  between two densities on the simplex (trivariate case).</h2>

<h3>Description</h3>

<p>Computes the Kullback-Leibler divergence and the <code class="reqn">L^2</code> distance between the "true" density (<code>true.dens</code>) and an estimated density (<code>est.dens</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">scores3D(true.dens, est.dens, npoints, eps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>true.dens</code></td>
<td>
<p>A <code>npoints*npoints</code> matrix: The reference density, typically the distribution from which data was simulated. Must be a valid <code>density</code> argument to be passed to <code>dgridplot</code>, with <code>equi=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.dens</code></td>
<td>
<p>The estimated density: of the same type as <code>true.dens</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>Number of grid points  used to construct the density matrices (see <code>discretize</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Minimum distance from a grid point to the simplex boundary (see <code>discretize</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The integration is made <em>via</em> <code>rect.integrate</code>: The discretization grid corresponding to the two matrices must be constructed
with <code>discretize(npoints, eps, equi=FALSE)</code>.
</p>


<h3>Value</h3>

<p>A list made of
</p>

<ul>
<li> <p><code>check.true</code>: The result of the rectangular integration of
<code>true.dens</code>. It should be equal to one. If not, re size the grid.
</p>
</li>
<li> <p><code>check.true</code>:
Idem, replacing <code>true.dens</code> with <code>est.dens</code>.
</p>
</li>
<li> <p><code>L2score</code>: The estimated <code class="reqn">L^2</code> distance.
</p>
</li>
<li> <p><code>KLscore</code>: The estimated Kullback-Leibler divergence between the two re-normalized densities, using <code>check.true</code> and <code>check.est</code> as normalizing constants (this ensures that the divergence is always positive). 
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">dens1=dpairbeta.grid(par=c(0.8,2,5,8),npoints=150,eps=1e-3,
                     equi=FALSE)
dens2=dnestlog.grid(par=c(0.5,0.8,0.4,0.6),npoints=150,eps=1e-3, equi=FALSE)

scores3D(true.dens=dens1,
  est.dens=dens2,
  npoints=150, eps=1e-4)

</code></pre>


</div>