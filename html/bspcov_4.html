<div class="container">

<table style="width: 100%;"><tr>
<td>cv.bandPPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CV for Bayesian Estimation of a Banded Covariance Matrix</h2>

<h3>Description</h3>

<p>Performs leave-one-out cross-validation (LOOCV) to calculate the predictive log-likelihood for a post-processed posterior of a banded covariance matrix and selects the optimal parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.bandPPP(X, kvec, epsvec, prior = list(), nsample = 2000, ncores = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a n <code class="reqn">\times</code> p data matrix with column mean zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kvec</code></td>
<td>
<p>a vector of natural numbers specifying the bandwidth of covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsvec</code></td>
<td>
<p>a vector of small positive numbers decreasing to <code class="reqn">0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list giving the prior information.
The list includes the following parameters (with default values in parentheses):
<code>A (I)</code> giving the positive definite scale matrix for the inverse-Wishart prior,
<code>nu (p + k)</code> giving the degree of freedom of the inverse-Wishar prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>a scalar value giving the number of the post-processed posterior samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>a scalar value giving the number of CPU cores.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The predictive log-likelihood for each <code class="reqn">k</code> and <code class="reqn">\epsilon_n</code> is estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
 \sum_{i=1}^n \log S^{-1} \sum_{s=1}^S p(X_i \mid B_k^{(\epsilon_n)}(\Sigma_{i,s})),
 </code>
</p>

<p>where <code class="reqn">X_i</code> is the ith observation, <code class="reqn">\Sigma_{i,s}</code> is the sth posterior sample based on <code class="reqn">(X_1,\ldots,X_{i-1},X_{i+1},\ldots,X_n)</code>, and <code class="reqn">B_k^{(\epsilon_n)}</code> represents the banding post-processing function.
For more details, see (3) in Lee, Lee and Lee (2023+).
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>elpd</code></td>
<td>
<p>a M <code class="reqn">\times</code> 3 dataframe having the expected log predictive density (ELPD) for each k and eps, where M = length(kvec) * length(epsvec).</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Kwangmin Lee
</p>


<h3>References</h3>

<p>Lee, K., Lee, K., and Lee, J. (2023+), "Post-processes posteriors for banded covariances",
<em>Bayesian Analysis</em>, DOI: 10.1214/22-BA1333.
</p>
<p>Gelman, A., Hwang, J., and Vehtari, A. (2014). "Understanding predictive information criteria for Bayesian models." <em>Statistics and computing</em>,
24(6), 997-1016.
</p>


<h3>See Also</h3>

<p>bandPPP
</p>


<h3>Examples</h3>

<pre><code class="language-R">

Sigma0 &lt;- diag(1,50)
X &lt;- mvtnorm::rmvnorm(25,sigma = Sigma0)
kvec &lt;- 1:2
epsvec &lt;- c(0.01,0.05)
res &lt;- bspcov::cv.bandPPP(X,kvec,epsvec,nsample=10,ncores=4)
plot(res)


</code></pre>


</div>