<div class="container">

<table style="width: 100%;"><tr>
<td>dfp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function minimization with box-constraints</h2>

<h3>Description</h3>

<p>This Davidon-Fletcher-Powell optimization algorithm has been ‘hand-tuned’
for minimal setup configuration and for efficency. It uses an internal
logit-type transformation based on the pre-specified box-constraints.
Therefore, it usually does not require rescaling (see help for the R optim
function). <code>dfp</code> automatically computes step sizes for each parameter
to operate with sufficient sensitivity in the functional output.
Performance is comparable to the BFGS algorithm in the R function
<code>optim</code>. <code>dfp</code> interfaces with <code>newton</code> to ascertain
convergence, compute the eigenvalues of the Hessian, and provide 95%
confidence intervals when the function to be minimized is a negative
log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dfp(x, f, tol = 1e-05, nfcn = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list with components 'label' (of mode character), 'est' (the
parameter vector with the initial guess), 'low' (vector with lower bounds),
and 'upp' (vector with upper bounds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>the function that is to be minimized over the parameter vector
defined by the list <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a tolerance used to determine when convergence should be
indicated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfcn</code></td>
<td>
<p>number of function calls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to be passed to 'f'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dfp function minimizes a function <code>f</code> over the parameters
specified in the input list <code>x</code>. The algorithm is based on Fletcher's
"Switching Method" (Comp.J. 13,317 (1970))
</p>
<p>the code has been 'transcribed' from Fortran source code into R
</p>


<h3>Value</h3>

<p>list with the following components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>fmin </code></td>
<td>
<p> the function
value f at the minimum </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label </code></td>
<td>
<p> the labels taken from list <code>x</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est </code></td>
<td>
<p> a vector of the estimates at the minimum. dfp does not
overwrite <code>x</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status </code></td>
<td>
<p> 0 indicates convergence, 1 indicates
non-convergence </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfcn </code></td>
<td>
<p> no. of function calls </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is part of the Bhat exploration tool
</p>


<h3>Author(s)</h3>

<p>E. Georg Luebeck (FHCRC)
</p>


<h3>References</h3>

<p>Fletcher's Switching Method (Comp.J. 13,317, 1970)
</p>


<h3>See Also</h3>

<p>optim, <code>newton</code>, <code>ftrf</code>,
<code>btrf</code>, <code>logit.hessian</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
        # generate some Poisson counts on the fly
          dose &lt;- c(rep(0,50),rep(1,50),rep(5,50),rep(10,50))
          data &lt;- cbind(dose,rpois(200,20*(1+dose*.5*(1-dose*0.05))))

        # neg. log-likelihood of Poisson model with 'linear-quadratic' mean: 
          lkh &lt;- function (x) { 
          ds &lt;- data[, 1]
          y  &lt;- data[, 2]
          g &lt;- x[1] * (1 + ds * x[2] * (1 - x[3] * ds)) 
          return(sum(g - y * log(g)))
          }

	# for example define
          x &lt;- list(label=c("a","b","c"),est=c(10.,10.,.01),low=c(0,0,0),upp=c(100,20,.1))

	# call:
	  results &lt;- dfp(x,f=lkh)

</code></pre>


</div>