<div class="container">

<table style="width: 100%;"><tr>
<td>rgwish</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling from G-Wishart distribution</h2>

<h3>Description</h3>

<p>Generates random matrices, distributed according to the G-Wishart distribution with parameters <code class="reqn">b</code> and <code class="reqn">D</code>, <code class="reqn">W_G(b, D)</code> with respect to the graph structure <code class="reqn">G</code>. 
Note this fuction works for both non-decomposable and decomposable graphs. 
</p>


<h3>Usage</h3>

<pre><code class="language-R"> rgwish( n = 1, adj = NULL, b = 3, D = NULL, threshold = 1e-8 ) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of samples required. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>

<p>adjacency matrix corresponding to the graph structure which can be non-decomposable or decomposable. It should be an upper triangular matrix in which <code class="reqn">a_{ij}=1</code> 
if there is a link between notes <code class="reqn">i</code> and <code class="reqn">j</code>, otherwise <code class="reqn">a_{ij}=0</code>.
<code>adj</code> could be an object of class <code>"graph"</code>, from function <code>graph.sim</code>.
It also could be an object of class "<code>sim</code>", from function <code>bdgraph.sim</code>.
It also could be an object of class "<code>bdgraph</code>", from functions <code>bdgraph.mpl</code> or <code>bdgraph</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>degree of freedom for G-Wishart distribution, <code class="reqn">W_G(b, D)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>positive definite <code class="reqn">(p \times p)</code> "scale" matrix for G-Wishart distribution, <code class="reqn">W_G(b, D)</code>. 
The default is an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p> threshold value for the convergence of sampling algorithm from G-Wishart.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Sampling from G-Wishart distribution, <code class="reqn">K \sim W_G(b, D)</code>, with density:
</p>
<p style="text-align: center;"><code class="reqn">Pr(K) \propto |K| ^ {(b - 2) / 2} \exp \left\{- \frac{1}{2} \mbox{trace}(K \times D)\right\},</code>
</p>

<p>which <code class="reqn">b &gt; 2</code> is the degree of freedom and <code class="reqn">D</code> is a symmetric positive definite matrix.
</p>


<h3>Value</h3>

<p>A numeric array, say <code class="reqn">A</code>, of dimension <code class="reqn">(p \times p \times n)</code>, where each <code class="reqn">A[,,i]</code> is a positive 
definite matrix, a realization of the G-Wishart distribution, <code class="reqn">W_G(b, D)</code>.
Note, for the case <code class="reqn">n=1</code>, the output is a matrix.
</p>


<h3>Author(s)</h3>

<p> Reza Mohammadi <a href="mailto:a.mohammadi@uva.nl">a.mohammadi@uva.nl</a> </p>


<h3>References</h3>

<p>Lenkoski, A. (2013). A direct sampler for G-Wishart variates, <em>Stat</em>, 2:119-128, <a href="https://doi.org/10.1002/sta4.23">doi:10.1002/sta4.23</a>
</p>
<p>Mohammadi, R. and Wit, E. C. (2019). <span class="pkg">BDgraph</span>: An <code>R</code> Package for Bayesian Structure Learning in Graphical Models, <em>Journal of Statistical Software</em>, 89(3):1-30, <a href="https://doi.org/10.18637/jss.v089.i03">doi:10.18637/jss.v089.i03</a> 
</p>
<p>Mohammadi, A. and Wit, E. C. (2015). Bayesian Structure Learning in Sparse Gaussian Graphical Models, <em>Bayesian Analysis</em>, 10(1):109-138, <a href="https://doi.org/10.1214/14-BA889">doi:10.1214/14-BA889</a>
</p>


<h3>See Also</h3>

 <p><code>gnorm</code>, <code>rwish</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Generating a 'circle' graph as a non-decomposable graph
adj &lt;- graph.sim( p = 5, graph = "circle" )
adj    # adjacency of graph with 5 nodes
  
sample &lt;- rgwish( n = 1, adj = adj, b = 3, D = diag( 5 ) )
round( sample, 2 ) 

sample &lt;- rgwish( n = 5, adj = adj )
round( sample, 2 )  
</code></pre>


</div>