<div class="container">

<table style="width: 100%;"><tr>
<td>getBranchShiftPriors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute prior odds of a rate shift on each branch of a phylogeny
from BAMM output</h2>

<h3>Description</h3>

<p>Computes the prior probability of a rate shift event for each
branch. These results are important for identifying topological rate
shift locations on phylogenies with marginal probabilities that exceed
those predicted under the prior alone.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getBranchShiftPriors(phy, expectedNumberOfShifts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedNumberOfShifts</code></td>
<td>
<p>The expected number of shifts under the
prior.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the prior odds on the distribution of
numbers of rate shift events per branch under the prior. It returns an
object which is nothing more than a copy of the original phylogenetic
tree but where each branch length has been replaced by the prior
probability of a rate shift on each branch.
</p>
<p>The significance of this function is that it lets us explicitly
determine which branches have shift probabilities that are elevated
relative to the prior expectation.
</p>


<h3>Value</h3>

<p>A class <code>phylo</code> with all the components of the original class
<code>phylo</code> object, with the following changes:
</p>
<table><tr style="vertical-align: top;">
<td><code>edge.length</code></td>
<td>
<p>Branch lengths now represent the prior probability
of a rate shift on each branch.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>References</h3>

<p><a href="http://bamm-project.org/">http://bamm-project.org/</a>
</p>


<h3>See Also</h3>

<p><code>distinctShiftConfigurations</code>,
<code>plot.bammshifts</code>, <code>summary.credibleshiftset</code>,
<code>plot.credibleshiftset</code>, <code>credibleShiftSet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales)
prior_tree1 &lt;- getBranchShiftPriors(whales, expectedNumberOfShifts = 1)
prior_tree10 &lt;- getBranchShiftPriors(whales, expectedNumberOfShifts = 10)
# plot prior expectations for branches based on these two counts:
plot(prior_tree1$edge.length ~ prior_tree10$edge.length, xlim=c(0,0.05),
     ylim=c(0,0.05), asp=1)
lines(x=c(0,1), y=c(0,1))
</code></pre>


</div>