<div class="container">

<table style="width: 100%;"><tr>
<td>expand_behavior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand behavior estimates from track segments to observations</h2>

<h3>Description</h3>

<p>Expand behavior estimates from track segments to observations
</p>


<h3>Usage</h3>

<pre><code class="language-R">expand_behavior(dat, theta.estim, obs, nbehav, behav.names, behav.order)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data frame of the animal ID, track segment labels, and all other
data per observation. Animal ID, date, track segment, and observation
number columns must be labeled <em>id</em>, <em>date</em>, <em>tseg</em>, and
<em>time1</em>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.estim</code></td>
<td>
<p>A matrix (returned by <code>extract_prop</code>)
containing the proportions of each behavioral state as separate columns for
each track segment (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>A data frame summarizing the number of observations within each
bin per movement variable that is returned by
<code>summarize_tsegs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbehav</code></td>
<td>
<p>numeric. The number of behavioral states that will be retained
in 1 to nmaxclust.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>behav.names</code></td>
<td>
<p>character. A vector of names to label each state (in
order).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>behav.order</code></td>
<td>
<p>numeric. A vector that identifies the order in which the
user would like to rearrange the behavioral states. If satisfied with order
returned by the LDA model, this still must be specified.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A new data frame that expands behavior proportions for each
observation within all track segments, including the columns labeled
<em>time1</em> and <em>date</em> from the original <code>dat</code> data frame.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

#load data
data(tracks.seg)

#select only id, tseg, SL, and TA columns
tracks.seg2&lt;- tracks.seg[,c("id","tseg","SL","TA")]

#summarize data by track segment
obs&lt;- summarize_tsegs(dat = tracks.seg2, nbins = c(5,8))

#cluster data with LDA
res&lt;- cluster_segments(dat = obs, gamma1 = 0.1, alpha = 0.1, ngibbs = 1000,
                       nburn = 500, nmaxclust = 7, ndata.types = 2)

#Extract proportions of behaviors per track segment
theta.estim&lt;- extract_prop(res = res, ngibbs = 1000, nburn = 500, nmaxclust = 7)

#Create augmented matrix by replicating rows (tsegs) according to obs per tseg
theta.estim.long&lt;- expand_behavior(dat = tracks.seg, theta.estim = theta.estim, obs = obs,
                               nbehav = 3, behav.names = c("Encamped","ARS","Transit"),
                               behav.order = c(1,2,3))



</code></pre>


</div>