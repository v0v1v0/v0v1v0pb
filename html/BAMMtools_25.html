<div class="container">

<table style="width: 100%;"><tr>
<td>getMarginalBranchRateMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute mean branch rates for <code>bammdata</code> object</h2>

<h3>Description</h3>

<p>For each sample in the posterior, computes the mean rate for
each branch in the focal phylogeny (speciation, extinction, trait
evolution). If the <code>bammdata</code> object contains <em>nsamples</em>
samples and the target phylogeny has <em>nbranches</em> branches, the
function will compute a matrix of <em>nbranches</em> x <em>nsamples</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getMarginalBranchRateMatrix(ephy, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print progress during processing of <code>bammdata</code> object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a <code>type = 'diversification'</code> <code>bammdata</code> object is
passed as an argument, the function will return matrices for both
speciation and extinction. If <code>type = 'trait'</code> object, the matrix
will simply be the corresponding phenotypic rates. Branch-specific
rates are the mean rates computed by integrating the relevant
rate-through-time function along each branch, then dividing by the
length of the branch.
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>

<ul>
<li>
<p> lambda_branch_matrix: A <code>nbranches x nsamples</code> matrix
of mean speciation rates for each branch.
</p>
</li>
<li>
<p> mu_branch_matrix: A <code>nbranches x nsamples</code> matrix of
mean extinction rates for each branch.
</p>
</li>
<li>
<p> beta_branch_matrix: A <code>nbranches x nsamples</code> matrix of
mean phenotypic rates for each branch.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales)
data(events.whales)
ed &lt;- getEventData(whales, events.whales, nsamples = 10)
mbr &lt;- getMarginalBranchRateMatrix(ed)
dim(mbr$lambda_branch_matrix)
</code></pre>


</div>