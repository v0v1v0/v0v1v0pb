<div class="container">

<table style="width: 100%;"><tr>
<td>hierMeanReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical Normal Means Regression Model</h2>

<h3>Description</h3>

<p>fits a hierarchical normal model of the form <code class="reqn">E[y_{ij}] = \mu_{j} +
\beta_{1}x_{i1}+\dots+\beta_{p}x_{ip}</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">hierMeanReg(
  design,
  priorTau,
  priorPsi,
  priorVar,
  priorBeta = NULL,
  steps = 1000,
  startValue = NULL,
  randomSeed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>a list with elements y = response vector, group = grouping
vector, x = matrix of covariates or NULL if there are no covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorTau</code></td>
<td>
<p>a list with elements tau0 and v0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorPsi</code></td>
<td>
<p>a list with elements psi0 and eta0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorVar</code></td>
<td>
<p>a list with elements s0 and kappa0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorBeta</code></td>
<td>
<p>a list with elements b0 and bMat or NULL if x is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>the number of Gibbs sampling steps to take</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startValue</code></td>
<td>
<p>a list with possible elements tau, psi, mu, sigmasq and
beta. tau, psi and sigmasq must all be scalars. mu and beta must be vectors
with as many elements as there are groups and covariates respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomSeed</code></td>
<td>
<p>a random seed for the random number generator</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with variables: </p>
<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Samples from the posterior
distribution of tau</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Samples from the posterior distribution of
psi</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Samples from the posterior distribution of mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Samples from the posterior distribution of beta if there are any
covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaSq</code></td>
<td>
<p>Samples from the posterior distribution of
<code class="reqn">\sigma^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Samples from the posterior distribution of
sigma</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
priorTau = list(tau0 = 0, v0 = 1000)
priorPsi = list(psi0 = 500, eta0 = 1)
priorVar = list(s0 = 500, kappa0 = 1)
priorBeta = list(b0 = c(0,0), bMat = matrix(c(1000,100,100,1000), ncol = 2))

data(hiermeanRegTest.df)
data.df = hiermeanRegTest.df
design = list(y = data.df$y, group = data.df$group,
               x = as.matrix(data.df[,3:4]))
r=hierMeanReg(design, priorTau, priorPsi, priorVar, priorBeta)

oldPar = par(mfrow = c(3,3))
plot(density(r$tau))
plot(density(r$psi))
plot(density(r$mu.1))
plot(density(r$mu.2))
plot(density(r$mu.3))
plot(density(r$beta.1))
plot(density(r$beta.2))
plot(density(r$sigmaSq))
par(oldPar)

## example with no covariates
priorTau = list(tau0 = 0, v0 = 1000)
priorPsi = list(psi0 = 500, eta0 = 1)
priorVar = list(s0 = 500, kappa0 = 1)

data(hiermeanRegTest.df)
data.df = hiermeanRegTest.df
design = list(y = data.df$y, group = data.df$group, x = NULL)
r=hierMeanReg(design, priorTau, priorPsi, priorVar)

oldPar = par(mfrow = c(3,2))
plot(density(r$tau))
plot(density(r$psi))
plot(density(r$mu.1))
plot(density(r$mu.2))
plot(density(r$mu.3))
plot(density(r$sigmaSq))
par(oldPar)


</code></pre>


</div>