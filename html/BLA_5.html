<div class="container">

<table style="width: 100%;"><tr>
<td>blqr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Boundary line model determination using quantile regression</h2>

<h3>Description</h3>

<p>This function fits a boundary model to the upper bounds of a scatter plot of
<code>x</code> and <code>y</code> by estimating the conditional quantile (0-1) of the
response variable, <code>y</code>, across values of the predictor variables, <code>x</code>.
This is achieved using optimization procedure and hence requires some starting
guess parameters of a proposed model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blqr(x,y,model, equation=NULL,start,tau=0.95,optim.method="Nelder-Mead",
     xmin=min(bound$x),xmax=max(bound$x), plot=TRUE,line_col="red",lwd=1,
     line_smooth=1000,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of values for the independent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of values for the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Selects the functional form of the boundary line. It includes
<code>"blm"</code> for linear model, <code>"lp"</code> for linear plateau model, <code>"mit"</code>
for the Mitscherlich model, <code>"schmidt"</code> for the Schmidt model,
<code>"logistic"</code> for logistic model, <code>"logisticND"</code> for logistic model
proposed by Nelder (1961), <code>"inv-logistic"</code> for the inverse logistic
model, <code>"double-logistic"</code> for the double logistic model, <code>"qd"</code>
for quadratic model and the <code>"trapezium"</code> for the trapezium model.For custom
models, set <code>model = "other"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equation</code></td>
<td>
<p>A custom model function writen in the form of an R function. Applies
only when argument <code>model="other"</code>, else it is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A numeric vector of initial starting values for optimization
in fitting the boundary model. Its length and arrangement depend on the
suggested model: </p>

<ul>
<li>
<p> For the <code>"blm"</code> model, it is a vector of length 2 arranged as intercept
and slope.
</p>
</li>
<li>
<p> For the <code>"lp"</code> model, it is a vector of length 3 arranged as intercept,
slope and maximum response.
</p>
</li>
<li>
<p> For the <code>"logistic"</code> and <code>"inv-logistic"</code> models, it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li>
<p> For the <code>"logisticND"</code> model proposed by Nelder (1961), it is a
vector of length 3 arranged as the scaling parameter, shape parameter and maximum
response.
</p>
</li>
<li>
<p> For the <code>"double-logistic"</code> model, it is a vector of length 6 arranged
as the scaling parameter one, shape parameter one, maximum response, maximum
response, scaling parameter two and shape parameter two.
</p>
</li>
<li>
<p> For the <code>"qd"</code> model, it is a vector of length 3 arranged as constant,
linear coefficient and quadratic coefficient.
</p>
</li>
<li>
<p> For the <code>"trapezium"</code> model, it is a vector of length 3  arranged as
intercept one, slope one, maximum response, intercept two and slope two.
</p>
</li>
<li>
<p> For the <code>"mit"</code> model, it is a vector of length 3 arranged as the
intercept, shape parameter and the maximum response.
</p>
</li>
<li>
<p> For the <code>"schmidt"</code> model, it is a vector of length 3 arranged as scaling
parameter, shape parameter (x-value at maximum response ) and maximum response.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The quantile value (0- 1) that represents the boundary
(<code>default is tau = 0.95</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>Describes the method used to optimize the model as in the
<code>optim()</code> function. The methods include <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> and <code>"Brent"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>Numeric value that describes the minimum <code>x</code> value to which the
boundary line is to be fitted (default is <code>min(x)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>A numeric value that describes the maximum <code>x</code> value to which the
boundary line is to be fitted (default is <code>max(x)</code>). <code>xmin</code> and
<code>xmax</code> determine the subset of the data set used to fit boundary model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If <code>TRUE</code>, a plot is part of the output. If <code>FALSE</code>, plot
is not part of output (default is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_col</code></td>
<td>
<p>Selects the color of the boundary line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Determines the thickness of the boundary line on the plot (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_smooth</code></td>
<td>
<p>Parameter that describes the smoothness of the boundary line.
(default is 1000). The higher the value, the smoother the line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Some inbuilt models are available for the <code>blqr()</code> function. The suggest model
forms are as follows: </p>

<ol>
<li>
<p> Linear model (<code>"blm"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept and <code class="reqn">\beta_2</code> is the slope.
</p>
</li>
<li>
<p> Linear plateau model (<code>"lp"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= {\rm min}(\beta_1+\beta_2x, \beta_0)</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept , <code class="reqn">\beta_2</code> is the slope  and <code class="reqn">\beta_0</code>
is the maximum response.
</p>
</li>
<li>
<p> The logistic (<code>"logistic"</code>) and inverse logistic (<code>"inv-logistic"</code>)
models
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p style="text-align: center;"><code class="reqn"> y= \beta_0 - \frac{\beta_0}{1+e^{\beta_2(\beta_1-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter , <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li>
<p> Logistic model (<code>"logisticND"</code>)  (Nelder (1961))
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_0}{1+(\beta_1 \times e^{-\beta_2x})}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter, <code class="reqn">\beta_2</code> is a shape
parameter and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li>
<p> Double logistic model (<code>"double-logistic"</code>)
</p>
<p style="text-align: center;"><code class="reqn"> y= \frac{\beta_{0,1}}{1+e^{\beta_2(\beta_1-x)}} -
 \frac{\beta_{0,2}}{1+e^{\beta_4(\beta_3-x)}}</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a scaling parameter one, <code class="reqn">\beta_2</code> is a shape parameter
one, <code class="reqn">\beta_{0,1}</code> and <code class="reqn">\beta_{0,2}</code> are the maximum response ,
<code class="reqn">\beta_3</code> is a scaling parameter two and  <code class="reqn">\beta_4</code> is a shape parameter two.
</p>
</li>
<li>
<p> Quadratic model (<code>"qd"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y=\beta_1 + \beta_2x + \beta_3x^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is a constant, <code class="reqn">\beta_2</code> is a linear coefficient
and  <code class="reqn">\beta_3</code> is the quadratic coefficient.
</p>
</li>
<li>
<p> Trapezium model (<code>"trapezium"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y={\rm min}(\beta_1+\beta_2x, \beta_0, \beta_3 + \beta_4x)</code>
</p>

<p>where  <code class="reqn">\beta_1</code> is the intercept one, <code class="reqn">\beta_2</code> is the slope one,
<code class="reqn">\beta_0</code> is the maximum response, <code class="reqn">\beta_3</code> is the intercept two
and <code class="reqn">\beta_3</code> is the slope two.
</p>
</li>
<li>
<p> Mitscherlich model (<code>"mit"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 - \beta_1*\beta_2^x</code>
</p>

<p>where <code class="reqn">\beta_1</code> is the intercept, <code class="reqn">\beta_2</code> is a shape parameter
and <code class="reqn">\beta_0</code> is the maximum response.
</p>
</li>
<li>
<p> Schmidt model (<code>"schmidt"</code>)
</p>
<p style="text-align: center;"><code class="reqn">y= \beta_0 + \beta_1(x-\beta_2)^2</code>
</p>

<p>where <code class="reqn">\beta_1</code> is ascaling parameter, <code class="reqn">\beta_2</code> is a
shape parameter (x-value at maximum response ) and <code class="reqn">\beta_0</code> is the
maximum response .
</p>
</li>
<li>
<p> Custom model ("other")
This option allows you to create your own model form using the function
<code>function()</code>. The custom model should be assigned to the argument
<code>equation</code>. Note that the parameters for the custom model should be
<code>a</code> and <code>b</code> for a two parameter model; <code>a</code>, <code>b</code> and <code>c</code>
for a three parameter model; <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> for a
four parameter model and so on.
</p>
</li>
</ol>
<p>The function <code>blbin()</code> utilities the optimization procedure of the
<code>optim()</code> function to determine the model parameters. There is a tendency
for optimization algorithms to settle at a local optimum. To remove the risk of
settling for local optimum parameters, it is advised that the function is run
using several starting values and the results with the smallest error
(weighted residue sum square) can be taken as a representation of the global
optimum.
</p>
<p>The common errors encountered due to poor start values </p>

<ol>
<li>
<p> function cannot be evaluated at initial parameters
</p>
</li>
<li>
<p> initial value in 'vmmin' is not finite</p>
</li>
</ol>
<h3>Value</h3>

<p>A list of length 5 consisting of the fitted model, equation form, parameters
of the boundary line, the weighted residue sum square. Additionally, a graphical
representation of the boundary line on the scatter plot is produced.
</p>


<h3>Author(s)</h3>

<p>Chawezi Miti &lt;chawezi.miti@nottingham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Cade, B. S., &amp; Noon, B. R. (2003). A gentle introduction to quantile regression
for ecologists. Frontiers in Ecology and the Environment, 1(8), 412-420.
</p>
<p>Nelder, J.A. 1961. The fitting of a generalization of the logistic curve.
Biometrics 17: 89–110.
</p>
<p>Phillips, B.F. &amp; Campbell, N.A. 1968. A new method of fitting the von Bertelanffy
growth curve using data on the whelk. Dicathais, Growth 32: 317–329.
</p>
<p>Schmidt, U., Thöni, H., &amp; Kaupenjohann, M. (2000). Using a boundary line approach
to analyze N2O flux data from agricultural soils. Nutrient Cycling in Agroecosystems,
57, 119-129.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x&lt;-log(SoilP$P)
y&lt;-SoilP$yield
start&lt;-c(4,3,13.6)

blqr(x,y, start=start,model = "lp", tau=0.99,
      xlab=expression("ET mm ha"^-1),
      ylab=expression("Wheat yield/ ton ha"^-1),
      pch=16, col="grey")

</code></pre>


</div>