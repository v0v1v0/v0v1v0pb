<div class="container">

<table style="width: 100%;"><tr>
<td>fdr.bama</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Mediation Analysis Controlling For False Discovery</h2>

<h3>Description</h3>

<p><code>fdr.bama</code> uses the permutation test to estimate the null PIP
distribution for each mediator and determines a threshold (based off of the
<code>fdr</code> parameter) for significance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdr.bama(
  Y,
  A,
  M,
  C1,
  C2,
  beta.m,
  alpha.a,
  burnin,
  ndraws,
  weights = NULL,
  npermutations = 200,
  fdr = 0.1,
  k = 2,
  lm0 = 1e-04,
  lm1 = 1,
  lma1 = 1,
  l = 1,
  mc.cores = 1,
  type = "PSOCK"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Length <code>n</code> numeric outcome vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Length <code>n</code> numeric exposure vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p><code>n x p</code> numeric matrix of mediators of Y and A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C1</code></td>
<td>
<p><code>n x nc1</code> numeric matrix of extra covariates to include in the
outcome model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C2</code></td>
<td>
<p><code>n x nc2</code> numeric matrix of extra covariates to include in the
mediator model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.m</code></td>
<td>
<p>Length <code>p</code> numeric vector of initial <code>beta.m</code> in the
outcome model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.a</code></td>
<td>
<p>Length <code>p</code> numeric vector of initial <code>alpha.a</code> in
the mediator model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of iterations to run the MCMC before sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>Number of draws to take from MCMC after the burnin period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Length <code>n</code> numeric vector of weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npermutations</code></td>
<td>
<p>The number of permutations to generate while estimating
the null pip distribution. Default is 200</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>False discovery rate. Default is 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Shape parameter prior for inverse gamma. Default is 2.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm0</code></td>
<td>
<p>Scale parameter prior for inverse gamma for the small normal
components. Default is 1e-4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm1</code></td>
<td>
<p>Scale parameter prior for inverse gamma for the large normal
component of beta_m. Default is 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lma1</code></td>
<td>
<p>Scale parameter prior for inverse gamma for the large normal
component of alpha_a. Default is 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Scale parameter prior for the other inverse gamma distributions.
Default is 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>The number of cores to use while running <code>fdr.bama</code>.
<code>fdr.bama</code> uses the <code>parallel</code> package for parallelization,
so see that for more information. Default is 1 core</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of cluster to make when <code>mc.cores &gt; 1</code>. See
<code>makeCluster</code> in the <code>parallel</code> package for more details.
Default is "PSOCK"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>fdr.bama</code> returns a object of type "fdr.bama" with 5 elements:
</p>

<dl>
<dt>bama.out</dt>
<dd>
<p>Output from the <code>bama</code> run.</p>
</dd>
<dt>pip.null</dt>
<dd>
<p>A <code>p x npermutations</code> matrices containing the
estimated null PIP distribution for each mediator.
</p>
</dd>
<dt>threshold</dt>
<dd>
<p>The cutoff significance threshold for each PIP controlling
for the false discovery rate.
</p>
</dd>
<dt>fdr</dt>
<dd>
<p>The false discovery rate used to calculate <code>threshold</code>.</p>
</dd>
<dt>call</dt>
<dd>
<p>The R call that generated the output.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Alexander Rix
</p>


<h3>References</h3>

<p>Song, Y, Zhou, X, Zhang, M, et al. Bayesian shrinkage estimation of high
dimensional causal mediation effects in omics studies. Biometrics. 2019;
1-11. <a href="https://doi.org/10.1111/biom.13189">doi:10.1111/biom.13189</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(bama)

Y &lt;- bama.data$y
A &lt;- bama.data$a

# grab the mediators from the example data.frame
M &lt;- as.matrix(bama.data[, paste0("m", 1:100)], nrow(bama.data))

# We just include the intercept term in this example as we have no covariates
C1 &lt;- matrix(1, 1000, 1)
C2 &lt;- matrix(1, 1000, 1)
beta.m  &lt;- rep(0, 100)
alpha.a &lt;- rep(0, 100)

set.seed(12345)

out &lt;- fdr.bama(Y, A, M, C1, C2, beta.m, alpha.a, burnin = 100,
                ndraws = 120, npermutations = 10)

# The package includes a function to summarise output from 'fdr.bama'
summary(out)

</code></pre>


</div>