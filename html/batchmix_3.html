<div class="container">

<table style="width: 100%;"><tr>
<td>batchSemiSupervisedMixtureModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Batch semisupervised mixture model</h2>

<h3>Description</h3>

<p>A Bayesian mixture model with batch effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">batchSemiSupervisedMixtureModel(
  X,
  R,
  thin,
  initial_labels,
  fixed,
  batch_vec,
  type,
  K_max = length(unique(initial_labels)),
  alpha = NULL,
  concentration = NULL,
  mu_proposal_window = 0.5^2,
  cov_proposal_window = 0.002,
  m_proposal_window = 0.3^2,
  S_proposal_window = 0.01,
  t_df_proposal_window = 0.015,
  m_scale = NULL,
  rho = 3,
  theta = 1,
  initial_class_means = NULL,
  initial_class_covariance = NULL,
  initial_batch_shift = NULL,
  initial_batch_scale = NULL,
  initial_class_df = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data to cluster as a matrix with the items to cluster held in rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of iterations in the sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The factor by which the samples generated are thinned, e.g. if
“thin=50“ only every 50th sample is kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_labels</code></td>
<td>
<p>Initial clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>Which items are fixed in their initial label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_vec</code></td>
<td>
<p>Labels identifying which batch each item being clustered is
from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character indicating density type to use. One of 'MVN'
(multivariate normal distribution) or 'MVT' (multivariate t distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_max</code></td>
<td>
<p>The number of components to include (the upper bound on the
number of clusters in each sample). Defaults to the number of unique labels
in “initial_labels“.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The concentration parameter for the stick-breaking prior and the
weights in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concentration</code></td>
<td>
<p>Initial concentration vector for component weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_proposal_window</code></td>
<td>
<p>The proposal window for the cluster mean proposal
kernel. The proposal density is a Gaussian distribution, the window is the
variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_proposal_window</code></td>
<td>
<p>The proposal window for the cluster covariance
proposal kernel. The proposal density is a Wishart distribution, this
argument is the reciprocal of the degree of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_proposal_window</code></td>
<td>
<p>The proposal window for the batch mean proposal
kernel. The proposal density is a Gaussian distribution, the window is the
variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_proposal_window</code></td>
<td>
<p>The proposal window for the batch standard deviation
proposal kernel. The proposal density is a Gamma distribution, this
argument is the reciprocal of the rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_df_proposal_window</code></td>
<td>
<p>The proposal window for the degrees of freedom
for the multivariate t distribution (not used if type is not 'MVT'). The
proposal density is a Gamma distribution, this argument is the reciprocal of
the rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_scale</code></td>
<td>
<p>The scale hyperparameter for the batch shift prior
distribution. This defines the scale of the batch effect upon the mean and
should be in (0, 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The shape of the prior distribution for the batch scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The scale of the prior distribution for the batch scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_class_means</code></td>
<td>
<p>A $P x K$ matrix of initial values for the class
means. Defaults to draws from the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_class_covariance</code></td>
<td>
<p>A $P x P x K$ array of initial values for
the class covariance matrices. Defaults to draws from the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_batch_shift</code></td>
<td>
<p>A $P x B$ matrix of initial values for the batch
shift effect Defaults to draws from the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_batch_scale</code></td>
<td>
<p>A $P x B$ matrix of initial values for the batch
scales Defaults to draws from the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_class_df</code></td>
<td>
<p>A $K$ vector of initial values for the class degrees
of freedom. Defaults to draws from the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logiccal indicating if warning about proposal windows should
be printed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list containing the sampled partitions, cluster and batch
parameters, model fit measures and some details on the model call.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Data in a matrix format
X &lt;- matrix(c(rnorm(100, 0, 1), rnorm(100, 3, 1)), ncol = 2, byrow = TRUE)

# Initial labelling
labels &lt;- c(
  rep(1, 10),
  sample(c(1, 2), size = 40, replace = TRUE),
  rep(2, 10),
  sample(c(1, 2), size = 40, replace = TRUE)
)

fixed &lt;- c(rep(1, 10), rep(0, 40), rep(1, 10), rep(0, 40))

# Batch
batch_vec &lt;- sample(seq(1, 5), replace = TRUE, size = 100)

# Density choice
type &lt;- "MVN"

# Sampling parameters
R &lt;- 1000
thin &lt;- 50

# MCMC samples and BIC vector
samples &lt;- batchSemiSupervisedMixtureModel(
  X,
  R,
  thin,
  labels,
  fixed,
  batch_vec,
  type
)

# Given an initial value for the parameters
initial_class_means &lt;- matrix(c(1, 1, 3, 4), nrow = 2)
initial_class_covariance &lt;- array(c(1, 0, 0, 1, 1, 0, 0, 1),
  dim = c(2, 2, 2)
)

# We can use values from a previous chain
initial_batch_shift &lt;- samples$batch_shift[, , R / thin]
initial_batch_scale &lt;- matrix(
  c(1.2, 1.3, 1.7, 1.1, 1.4, 1.3, 1.2, 1.2, 1.1, 2.0),
  nrow = 2
)

samples &lt;- batchSemiSupervisedMixtureModel(X,
  R,
  thin,
  labels,
  fixed,
  batch_vec,
  type,
  initial_class_means = initial_class_means,
  initial_class_covariance = initial_class_covariance,
  initial_batch_shift = initial_batch_shift,
  initial_batch_scale = initial_batch_scale
)

</code></pre>


</div>