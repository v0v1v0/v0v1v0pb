<div class="container">

<table style="width: 100%;"><tr>
<td>batchmix-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Mixture Modelling for Joint Model-Based
Clustering/Classification and Batch Correction</h2>

<h3>Description</h3>

<p>Semi-supervised and unsupervised Bayesian mixture models that
simultaneously infer the cluster/class structure and a batch correction.
Densities available are the multivariate normal and the multivariate t.
The model sampler is implemented in C++. This package is aimed at analysis of
low-dimensional data generated across several batches. See
(Coleman et al. (2022))[https://doi.org/10.1101/2022.01.14.476352] for
details of the model.
</p>


<h3>Author(s)</h3>

<p>Stephen Coleman &lt;stcolema@tcd.ie&gt;, Paul D.W. Kirk, Chris Wallace
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/stcolema/batchmix">https://github.com/stcolema/batchmix</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/stcolema/batchmix/issues">https://github.com/stcolema/batchmix/issues</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
# Data in a matrix format
X &lt;- matrix(c(rnorm(100, 0, 1), rnorm(100, 3, 1)), ncol = 2, byrow = TRUE)

# Initial labelling
labels &lt;- c(
  rep(1, 10),
  sample(c(1, 2), size = 40, replace = TRUE),
  rep(2, 10),
  sample(c(1, 2), size = 40, replace = TRUE)
)

# Which labels are observed
fixed &lt;- c(rep(1, 10), rep(0, 40), rep(1, 10), rep(0, 40))

# Batch
batch_vec &lt;- sample(seq(1, 5), replace = TRUE, size = 100)

# Sampling parameters
R &lt;- 1000
thin &lt;- 50

# Classification
samples &lt;- runBatchMix(X,
  R,
  thin,
  batch_vec,
  "MVN",
  initial_labels = labels,
  fixed = fixed,
)

# Clustering
samples &lt;- runBatchMix(X, R, thin, batch_vec, "MVT")

</code></pre>


</div>