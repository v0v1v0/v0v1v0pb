<div class="container">

<table style="width: 100%;"><tr>
<td>exactprob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Boundary crossing probabilities computation using exact test.</h2>

<h3>Description</h3>

<p>Calculate boundary crossing probabilities of single-arm group sequential design with binary endpoint using binomial distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">exactprob(K = 0, p_0, p_1, n.I, u_K, lowerbounds, d = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The maximum number of analyses, including the interim and the final. Should be an integer within (1,20]. K will be
rounded to the nearest whole number if it is not an integer. The default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_0</code></td>
<td>
<p>The response rate or the probability of success under null hypothesis. Should be a scalar within (0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_1</code></td>
<td>
<p>A scalar or vector representing response rate or probability of success under the alternative hypothesis. The
value(s) should be within (p_0,1). It is a mandatory input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.I</code></td>
<td>
<p>A vector of length K which contains sample sizes required at each analysis. Should be a positive and increasing
sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u_K</code></td>
<td>
<p>The upper boundary for the last analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerbounds</code></td>
<td>
<p>Non-decreasing lower boundaries for each analysis, in which each element is no less than -1 (no lower bound). With length K,
the last lower bound must be identical to u_K. With length K-1, the last element must be no greater than u_K and u_K will
be automatically added into the sequence. Note the lower bound must be less than the corresponding sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>An object of the class exactdesign.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is similar to <code>asymprob</code> except that the former uses binomial distribution and the latter
uses the normal asymptotic distribution. With <code>K=0</code>
(as default), <code>d</code> must be an object of class exactdesign. Meanwhile, other
arguments except for <code>p_1</code> will be inherited from <code>d</code> and the input values will be
ignored. With <code>K!=0</code>, the probabilities are derived from the input arguments. In
this circumstance, all the arguments except for <code>d</code> are required.
</p>
<p>The computation is based on the single-arm group sequential exact test
described in <code>exactdesign</code>. Therefore, for the output matrix of
upper bound crossing probabilities, the values for the first K-1 analyses are
zero since there is only one upper bound for the last analysis.
</p>


<h3>Value</h3>

<p>An object of the class exactprob. This class contains:
</p>

<ul>
<li>
<p>p_0: As input with <code>d=NULL</code> or as in <code>d</code>.
</p>
</li>
<li>
<p>p_1: As input.
</p>
</li>
<li>
<p>K: K used in computation.
</p>
</li>
<li>
<p>n.I: As input with <code>d=NULL</code> or as in <code>d</code>.
</p>
</li>
<li>
<p>u_K: As input with <code>d=NULL</code> or as in <code>d</code>.
</p>
</li>
<li>
<p>lowerbounds: lowerbounds used in computation.
</p>
</li>
<li>
<p>problow: Probabilities of crossing the lower bounds at each analysis.
</p>
</li>
<li>
<p>probhi: Probability of crossing the upper bounds at each analysis.
</p>
</li>
</ul>
<h3>Reference</h3>

 <ul>
<li>
<p>Christopher Jennison, Bruce W. Turnbull. Group Sequential Methods with
Applications to Clinical Trials. Chapman and Hall/CRC, Boca Raton, FL, 2000.
</p>
</li>
<li>
<p>Keaven M. Anderson, Dan (Jennifer) Sun, Zhongxin (John) Zhang. gsDesign: An R
Package for Designing Group Sequential Clinical Trials. R package version 3.0-1. </p>
</li>
</ul>
<h3>Note</h3>

<p>The calculation of boundary crossing probabilities here borrowed strength from the
source code of function <code>gsBinomialExact</code> in package gsDesign and we really appreciate
their work.
</p>


<h3>See Also</h3>

<p><code>exactdesign</code>, <code>exactcp</code>, <code>asymprob</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">I=c(0.2,0.4,0.6,0.8,0.99)
beta=0.2
betaspend=c(0.1,0.2,0.3,0.3,0.2)
alpha=0.05
p_0=0.3
p_1=0.5
K=4.6
tol=1e-6
tt1=asymdesign(I,beta,betaspend,alpha,p_0,p_1,K,tol)
tt2=exactdesign(tt1)
tt3=exactprob(p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),d=tt2)
tt3=exactprob(K=5,p_0=0.4,p_1=c(0.5,0.6,0.7,0.8),n.I=c(15,20,25,30,35),u_K=15,
lowerbounds=c(3,5,10,12,15))
</code></pre>


</div>