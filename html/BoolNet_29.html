<div class="container">

<table style="width: 100%;"><tr>
<td>plotSequence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot a sequence of states
</h2>

<h3>Description</h3>

<p>Visualizes sequences of states in synchronous Boolean networks, either by drawing a table of the involved states in two colors, or by drawing a graph of transitions between the successive states.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSequence(network, 
             startState, 
             includeAttractorStates = c("all","first","none"), 
             sequence,
             title = "", 
             mode=c("table","graph"),
             plotFixed = TRUE, grouping = list(),
             onColor="#4daf4a", 
             offColor = "#e41a1c",
             layout, 
             drawLabels=TRUE, 
             drawLegend=TRUE, 
             highlightAttractor=TRUE,
             reverse = FALSE,
             borderColor = "black", 
             eps=0.1,
             attractor.sep.lwd = 2, 
             attractor.sep.col = "blue",
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>

<p>An object of class <code>BooleanNetwork</code> or <code>SymbolicBooleanNetwork</code> for which a sequence of state transitions is calculated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startState</code></td>
<td>

<p>The start state of the sequence
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includeAttractorStates</code></td>
<td>

<p>Specifies whether the actual attractor states are included in the plot or not (see also <code>getPathToAttractor</code>). If <code>includeAttractorStates = "all"</code> (which is the default behaviour), the sequence ends when the attractor was traversed once. If <code>includeAttractorStates = "first"</code>, only the first state of attractor is added to the sequence. If includeAttractorStates = "none", the sequence ends with the last non-attractor state. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence</code></td>
<td>

<p>The alternative call to <code>plotSequence</code> requires the specification of the sequence itself instead of the network and the start state. The sequence must be provided as a data frame with the genes in the columns and the successive states in the rows. For example, sequences can be obtained using <code>getPathToAttractor</code> or <code>getAttractorSequence</code> (however, the specialized plot <code>plotAttractors</code> exists for attractors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>An optional title for the plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Switches between two kinds of attractor plots. See Details for more information. Default is "table".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotFixed</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code>.
If this is true, genes with fixed values are included in the plot. Otherwise, these genes are not drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code> and specifies a structure to form groups of genes in the plot. This is a list with the following elements: 
</p>

<dl>
<dt>class</dt>
<dd>
<p>A vector of names for the groups. These names will be printed in the region belonging to the group in the plot.</p>
</dd>  	
<dt>index</dt>
<dd>
<p>A list with the same length as <code>class</code>. Each element is a vector of gene names or gene indices belonging to the group.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onColor</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code> and specifies the color value for the 1/ON values in the table. Defaults to green.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offColor</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code> and specifies the color value for the 0/OFF values in the table. Defaults to red.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>If <code>mode="graph"</code>, this parameter specifies a layouting function that determines the placement of the nodes in the graph. Please refer to the <code>layout</code> manual entry in the <span class="pkg">igraph</span> package for further details. By default, the nodes are placed in a horizontal line.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawLabels</code></td>
<td>
<p>This parameter is only relevant if <code>mode="graph"</code>. It determines whether the nodes of the graph are annotated with the corresponding values of the genes in the attractor states.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawLegend</code></td>
<td>
<p>Specifies whether a color key for the ON/OFF states is drawn if <code>mode="table"</code>. Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlightAttractor</code></td>
<td>

<p>If set to true, the attractor states are highlighted in the plot. If <code>mode="table"</code>, a line is drawn at the begin of the attractor, and the states are labeled correspondingly. If <code>mode="graph"</code>, the attractor transitions are drawn as bold lines. Information on the attractor must be supplied in the attribute <code>attractor</code> of the sequence, which is a vector of indices of the states that belong to the attractor. This attribute is usually present if the sequence was obtained using <code>getPathToAttractor</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>

<p>Specifies the order of the genes in the plot. By default, the first gene is placed in the first row of the plot. If <code>reverse=TRUE</code> (which was the default until <span class="pkg">BoolNet</span> version 2.0.2), the first gene in the network is placed in the bottom row of the plot. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borderColor</code></td>
<td>

<p>Specifies the border or seprating color of states in an attractor. Defaults to <code>"black"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Specifies plotting margin for the sequence of states. Defaults to <code>0.1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attractor.sep.lwd</code></td>
<td>

<p>Specifies the line width of the attractor separator. Defaults to <code>2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attractor.sep.col</code></td>
<td>

<p>Specifies the line color of the attractor separator. Defaults to <code>"blue"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further graphical parameters to be passed to <code>plot.igraph</code> if <code>mode="graph"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function comprises two different types of plots: 
</p>
<p>The "table" mode visualizes the gene values of the states in the sequence. The figure is a table with the genes in the rows and the successive states of the sequence in the columns. Cells of the table are (by default) red for 0/OFF values and green for 1/ON values. If <code>grouping</code> is set, the genes are rearranged according to the indices in the group, horizontal separation lines are plotted between the groups, and the group names are printed.
</p>
<p>The "graph" mode visualizes the transitions between different states. It creates a graph in which the vertices are the states in the sequence and the edges are state transitions among these states.
</p>
<p>The function can be called with different types of inputs: The user can specify the parameters <code>network</code>, <code>startState</code> and <code>includeAttractorStates</code>), in which case <code>getPathToAttractor</code> is called to obtain the sequence. Alternatively, the sequence can be supplied directly as a data frame in the <code>sequence</code> parameter.
</p>


<h3>Value</h3>

<p>If <code>mode="table"</code>, a matrix corresponding to the table is returned. The matrix has the genes in the rows and the states of the attractors in the columns. If <code>sequence</code> was supplied, this corresponds to the transposed input whose rows may be rearranged if <code>grouping</code> was set.
</p>
<p>If <code>mode="graph"</code>, an object of class <code>igraph</code> describing the graph for the sequence is returned.  
</p>


<h3>See Also</h3>

<p><code>sequenceToLaTeX</code>, <code>plotAttractors</code>, <code>attractorsToLaTeX</code>, <code>getPathToAttractor</code>, <code>getAttractorSequence</code>, <code>simulateSymbolicModel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load example data
data(cellcycle)

# alternative 1: supply network and start state
# and plot sequence as a table
plotSequence(network=cellcycle, 
             startState=rep(1,10), 
             includeAttractorStates="all")

# alternative 2: calculate sequence in advance
sequence &lt;- getPathToAttractor(cellcycle, 
                               state=rep(1,10), 
                               includeAttractorStates="all")

# plot sequence as a graph
plotSequence(sequence=sequence, 
             mode="graph")

## End(Not run)
</code></pre>


</div>