<div class="container">

<table style="width: 100%;"><tr>
<td>welchPSD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power spectral density estimation using Welch's method.</h2>

<h3>Description</h3>

<p>Estimates a time series' power spectral density using <em>Welch's
method</em>, i.e., by subdividing the data into segments, computing
spectra for each, and averaging over the results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">welchPSD(x, seglength, two.sided = FALSE, windowfun = tukeywindow,
         method = c("mean", "median"), windowingPsdCorrection = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a time series (<code>ts</code> object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seglength</code></td>
<td>
<p>the length of the subsegments to be used (in units of
time relative to <code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>a <code>logical</code> flag indicating whether the result is
supposed to be one-sided (default) or two-sided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowfun</code></td>
<td>
<p>The windowing function to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The "averaging" method to be used – either
<code>"mean"</code> or <code>"median"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowingPsdCorrection</code></td>
<td>
<p>a <code>logical</code> flag indicating whether
an overall correction for the windowing is supposed to be applied to
the result – this essentially specifies whether the result is
supposed to reflect the PSD of the <em>windowed</em> or of the
"<em>un-windowed"</em> time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to the windowing function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The time series will be divided into overlapping sub-segments, each
segment is windowed and its "empirical" spectrum is computed. The
average of these spectra is the resulting PSD estimate. For
robustness, the median may also be used instead of the mean.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>frequency</code></td>
<td>
<p>the Fourier frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the estimated spectral power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>the number of (by definition) non-zero imaginary
components of the Fourier series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>a <code>logical</code> flag indicating one- or
two-sidedness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>
<p>the number of (overlapping) segments used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Roever, <a href="mailto:christian.roever@med.uni-goettingen.de">christian.roever@med.uni-goettingen.de</a></p>


<h3>References</h3>

<p>Welch, P. D.
The use of Fast Fourier Transform for the estimation of Power Spectra:
A method based on time averaging over short, modified periodograms.
<em>IEEE Transactions on Audio and Electroacoustics</em>,
<b>AU-15</b>(2):70–73, 1967.
doi: <a href="https://doi.org/10.1109/TAU.1967.1161901">10.1109/TAU.1967.1161901</a>.
</p>
<p>Press, W. H., Teukolsky, S. A., Vetterling, W. T., Flannery,
B. P. <em>Numerical recipes in C</em>. Cambridge University
Press, 1992.
</p>


<h3>See Also</h3>

<p><code>empiricalSpectrum</code>,
<code>tukeywindow</code>,
<code>spectrum</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load example data:
data(sunspots)
# compute and plot the "plain" spectrum:
spec1 &lt;- empiricalSpectrum(sunspots)
plot(spec1$frequency, spec1$power, log="y", type="l")

# plot Welch spectrum using segments of length 10 years:
spec2 &lt;- welchPSD(sunspots, seglength=10)
lines(spec2$frequency, spec2$power, col="red")

# use 20-year segments and a flatter Tukey window:
spec3 &lt;- welchPSD(sunspots, seglength=20, r=0.2)
lines(spec3$frequency, spec3$power, col="blue")
</code></pre>


</div>