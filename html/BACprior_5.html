<div class="container">

<table style="width: 100%;"><tr>
<td>BACprior.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sensitivity of the Bayesian Adjustment for Confounding Algorithm to the Value of the Hyperparameter Omega When the Outcome and the Exposure Are Continuous Variables.
</h2>

<h3>Description</h3>

<p>The BACprior.lm function provides estimates of the posterior mean and posterior standard deviation of the exposure effect for selected values of omega in the covariate inclusion indicators' prior distribution. The output allows the user to evaluate how sensitive the BAC procedure is to the choice of the hyperparameter omega value.</p>


<h3>Usage</h3>

<pre><code class="language-R">BACprior.lm(Y, X, U, 
omega = c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf),
maxmodels = 150, cutoff = 0.0001, return.best = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>A vector of observed values for the continuous outcome.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A vector of observed values for the continuous exposure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>

<p>A matrix of observed values for the potential confounders, where each column contains observed values for a potential confounder. A recommended implementation is to only consider pre-exposure covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>

<p>A vector of omega values for which the sensitivity analysis is performed. The default is <code>c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf)</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxmodels</code></td>
<td>

<p>The maximum number of outcome and exposure models of each size to be considered. Larger numbers improves the approximation, but can greatly increase the computational burden. The default is <code>150</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>

<p>Minimum posterior probability needed for an outcome model to be considered in the weighted average of the posterior mean and standard deviation of the exposure effect. Smaller values of <code>cutoff</code> improves the approximation, but add computational complexity. The default is <code>0.0001</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.best</code></td>
<td>
<p>If <code>TRUE</code>, <code>BACprior.lm</code> returns outcome models meeting the <code>cutoff</code> criterion and their posterior probabilities. The default if <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only the best <code>maxmodels</code> of each size are recorded for both the outcome and exposure models. The marginal likelihoods of these models are a function of the corresponding BIC values. The posterior mean of the exposure effect parameter is the weighted average of the maximum likelihood estimates, where the weights are the posterior probabilities of the outcome models. The standard deviation of the exposure effect parameter accounts for both the within- and between-model variability (Hoeting et al., 1999), where the within-model variability is given by the standard error of the maximum likelihood exposure effect estimate for the model.
</p>
<p><code>BAC.prior.lm</code> assumes there are no missing values. The objects <code>X</code>, <code>Y</code> and <code>U</code> should be processed beforehand so that every case is complete. The <code>na.omit</code> function which removes cases with missing data or an imputation package might be helpful.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>A matrix in which the first column contains the selected <code>omega</code> values, the second column contains the posterior mean of the exposure effect for each <code>omega</code> value and the third column contains the standard deviation of the exposure effect for each <code>omega</code> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.models</code></td>
<td>
<p>Only returned if <code>return.best = TRUE</code>. A logical matrix whose columns represent the different potential confounders in <code>U</code> and whose lines indicate which covariates are included in a given outcome model. Only outcome models that have a posterior probability larger than the <code>cutoff</code> value for at least one <code>omega</code> value are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior.prob</code></td>
<td>
<p>Only returned if <code>return.best = TRUE</code>. A matrix containing the posterior probability of each outcome model in the set of <code>best.models</code> for the different <code>omega</code> values. Each line represents a different outcome model and each column corresponds to one of the selected omega value.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If either the null outcome model (intercept + exposure only) or the null exposure model (intercept only) have a nonnegligible weight, the approximate inferences given by this function might be poor. This occurs since the <code>regsubset</code> function used to find the best models of each size does not return null models.
</p>


<h3>Author(s)</h3>

<p>Denis Talbot, Genevieve Lefebvre, Juli Atherton.
</p>


<h3>References</h3>

<p>Hoeting, J.A., Madigan D., Raftery, A.E., Volinsky C.T. (1999). <em>Bayesian model averaging : A tutorial</em>, Statistical Science, 16, 382-417.
</p>
<p>Lefebvre, G., Atherton, J., Talbot, D. (2014). <em>The effect of the prior distribution in the Bayesian Adjustment for Confounding algorithm</em>, Computational Statistics &amp; Data Analysis, 70, 227-240.
</p>
<p>Wang, C., Parmigiani, G., Dominici, F. (2012). <em>Bayesian effect estimation accounting for adjustment uncertainty</em>, Biometrics, 68 (3), 661-671.
</p>



<h3>See Also</h3>

<p><code>regsubsets</code>, <code>na.omit</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Required package to simulate from a multivariate normal distribution.
require(mvtnorm);
	
# Simulate data
# n = 500 observations with 10 covariates.
# (U1, U2, U4, U6, U7, U8, U9, U10) is multivariate normal
# with mean vector 0, variances of 1 and pairwise correlations of 0.25.
# U3 and U5 are causal effects of U2 and U4, respectively.
# X is a causal effect of U1, U2 and U4.
# Y is a causal effect of X, U3, U4 and U5.
# The true exposure effect is 0.1.
	ncov = 10;
	n = 500;
	U = rmvnorm(n = n, mean = rep(0, ncov),
	 sigma = diag(0.75, nrow = ncov) + matrix(0.25, nrow = ncov, ncol = ncov));
	U[,3] = U[,2] + rnorm(n);
	U[,5] = U[,4] + rnorm(n);
	X = 0.5*U[,1] + 0.5*U[,2] + U[,4] + rnorm(n);
	Y = U[,3] + 0.3*U[,4] + U[,5] + 0.1*X + rnorm(n);

	BACprior.lm(Y, X, U, omega = c(1, 1.5, 2, 5, 10, 50, 100, Inf));
	</code></pre>


</div>