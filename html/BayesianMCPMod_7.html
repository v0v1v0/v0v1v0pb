<div class="container">

<table style="width: 100%;"><tr>
<td>getModelFits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>getModelFits</h2>

<h3>Description</h3>

<p>Fits dose-response curves for the specified dose-response models, based on the posterior distributions.
For the simplified fit, multivariate normal distributions will be approximated and reduced by one-dimensional normal distributions.
For the default case, the Nelder-Mead algorithm is used.
In detail, for both approaches the mean vector <code class="reqn">\theta^{Y}</code> and the covariance <code class="reqn">\Sigma</code> of the (mixture) posterior distributions and the corresponding posterior weights <code class="reqn">\tilde{\omega}_{l}</code> for <code class="reqn">l \in {1,...,L}</code> are used as basis
For the full fit a GLS estimator is used to minimize the following expression for the respective dose-response models <code class="reqn">m</code>
</p>
<p style="text-align: center;"><code class="reqn"> \hat{\theta}_{m}=argmin_{\theta_{m}} \sum_{l=1}^{L} \tilde{\omega}_{l}(\theta_{l_{i}}^{Y}-f(dose_{i},\hat{\theta}_{m}))'\Sigma_{l}^{-1}(\theta_{l_{i}}^{Y}-f(dose_{i},\hat{\theta}_{m}))</code>
</p>

<p>Therefore the function nloptr of the nloptr package is utilized.
In the simplified case <code class="reqn">L=1</code>, as the dimension of the posterior is reduced to 1 first.
The generalized AIC values are calculated via the formula
</p>
<p style="text-align: center;"><code class="reqn">gAIC_{m} = \sum_{l=1}^{L} \tilde{\omega}_{l} \sum_{i=0}^{K} \frac{1}{\Sigma_{l_{i,i}}} (\theta_{l_i}^Y - f(dose_{i},\hat{\theta}_{m}))^2 + 2p </code>
</p>

<p>where <code class="reqn">p</code> denotes the number of estimated parameters and <code class="reqn">K</code> the number of active dose levels.
Here as well for the simplified case the formula reduces to one summand as <code class="reqn">L=1</code>.
Corresponding gAIC based weights for model <code class="reqn">M</code> are calculated as outlined in Schorning et al. (2016)
</p>
<p style="text-align: center;"><code class="reqn">
\Omega_I (M) = \frac{\exp(-0.5 gAIC_{M})}{\sum_{m=1}^{Q} \exp(-0.5 gAIC_{m})}
</code>
</p>

<p>where <code class="reqn">Q</code> denotes the number of models included in the averaging procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getModelFits(models, dose_levels, posterior, simple = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>List of model names for which a fit will be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose_levels</code></td>
<td>
<p>A vector containing the different dosage levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>A getPosterior object, containing the (multivariate) posterior distribution per dosage level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simple</code></td>
<td>
<p>Boolean variable, defining whether simplified fit will be applied. Default FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class modelFits. A list containing information about the fitted model coefficients, the prediction per dose group as well as maximum effect and generalized AIC (and corresponding weight) per model.
</p>


<h3>References</h3>

<p>Schorning K, Bornkamp B, Bretz F, Dette H. 2016. Model selection versus model averaging in dose finding studies. Stat Med; 35; 4021-4040.
</p>


<h3>Examples</h3>

<pre><code class="language-R">posterior_list &lt;- list(Ctrl = RBesT::mixnorm(comp1 = c(w = 1, m = 0, s = 1), sigma = 2),
                       DG_1 = RBesT::mixnorm(comp1 = c(w = 1, m = 3, s = 1.2), sigma = 2),
                       DG_2 = RBesT::mixnorm(comp1 = c(w = 1, m = 4, s = 1.5), sigma = 2) ,  
                       DG_3 = RBesT::mixnorm(comp1 = c(w = 1, m = 6, s = 1.2), sigma = 2) ,
                       DG_4 = RBesT::mixnorm(comp1 = c(w = 1, m = 6.5, s = 1.1), sigma = 2))
models         &lt;- c("emax", "exponential", "sigEmax", "linear")
dose_levels    &lt;- c(0, 1, 2, 4, 8)

fit        &lt;- getModelFits(models      = models,
                           posterior   = posterior_list,
                           dose_levels = dose_levels)
fit_simple &lt;- getModelFits(models      = models,
                           posterior   = posterior_list,
                           dose_levels = dose_levels,
                           simple      = TRUE)
                           
</code></pre>


</div>