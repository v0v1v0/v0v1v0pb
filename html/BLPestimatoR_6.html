<div class="container">

<table style="width: 100%;"><tr>
<td>estimateBLP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs a BLP demand estimation.</h2>

<h3>Description</h3>

<p>Performs a BLP demand estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateBLP(
  blp_data,
  par_theta2,
  solver_method = "BFGS",
  solver_maxit = 10000,
  solver_reltol = 1e-06,
  standardError = "heteroskedastic",
  extremumCheck = FALSE,
  printLevel = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_theta2</code></td>
<td>
<p>matrix with column and rownames providing a starting value for the optimization routine (see details),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver_method</code></td>
<td>
<p>character specifying the solver method in <code>optim</code> (further arguments can be passed to <code>optim</code> by ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver_maxit</code></td>
<td>
<p>integer specifying maximum iterations for the optimization routine (default=10000),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver_reltol</code></td>
<td>
<p>integer specifying tolerance for the optimization routine (default= 1e-6),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardError</code></td>
<td>
<p>character specifying assumptions about the GMM residual (homoskedastic , heteroskedastic (default), or cluster)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extremumCheck</code></td>
<td>
<p>if <code>TRUE</code>, second derivatives are checked for the existence of minimum at the point estimate (default = FALSE),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printLevel</code></td>
<td>
<p>level of output information ranges from 0 (no GMM results) to 4 (every norm in the contraction mapping)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for <code>optim</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be "unobs_sd".
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and "unobs_sd".
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named "(Intercept)".
</p>


<h3>Value</h3>

<p>Returns an object of class "blp_est". This object contains, among others, all estimates for preference parameters and standard errors.
</p>


<h3>Examples</h3>

<pre><code class="language-R">K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

blp_est &lt;- estimateBLP(blp_data =blp_data,
                       par_theta2 = theta_guesses,
                       extremumCheck = FALSE ,
                       printLevel = 1 )
summary(blp_est)

</code></pre>


</div>