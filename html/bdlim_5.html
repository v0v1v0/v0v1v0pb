<div class="container">

<table style="width: 100%;"><tr>
<td>bdlim4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the BDLIM model with all 4 patterns of modification</h2>

<h3>Description</h3>

<p>Fit the BDLIM model with all 4 patterns of modification
</p>


<h3>Usage</h3>

<pre><code class="language-R">bdlim4(
  y,
  exposure,
  covars,
  group,
  id = NULL,
  df,
  nits,
  nburn = round(nits/2),
  nthin = 1,
  parallel = FALSE,
  family = "gaussian"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of outcomes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposure</code></td>
<td>
<p>A matrix of exposures with one row for each individual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>A matrix or data.frame of covariates This should not include the grouping factor (see group below). This may include factor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A vector of group memberships. This should be a factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>An optional vector of individual IDs if there are repeated measures or other groupings that a random intercept should be included for. This must be a factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom for the weight functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nits</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>Number of MCMC iterations to be discarded as burn in. The default is half if the MCMC iterations. This is only used for WAIC in this function but is passed to summary and plot functions and used there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthin</code></td>
<td>
<p>Thinning factors for the MCMC. This is only used for WAIC in this function but is passed to summary and plot functions and used there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical to use parallel computing for 4 models. If TRUE then the min of 4 and number of cores available will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Family of model to be used. Supported options are "gaussian" for a normal/Gaussian linear model and "binomial" for a logistic model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of results from each different pattern of modification and model compassion metrics
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# run BDLIM with modification by ChildSex
fit_sex &lt;- bdlim4(
  y = sbd_bdlim$bwgaz,
  exposure = sbd_bdlim[,paste0("pm25_",1:37)],
  covars = sbd_bdlim[,c("MomPriorBMI","MomAge","race","Hispanic",
                                   "EstMonthConcept","EstYearConcept")],
  group = as.factor(sbd_bdlim$ChildSex),
  df = 5,
  nits = 5000,
  parallel = FALSE
)

# show model comparison results
fit_sex

#summarize results
sfit_sex &lt;- summary(fit_sex)
sfit_sex
# graph the estimated distributed lag functions for each group
plot(sfit_sex)


</code></pre>


</div>