<div class="container">

<table style="width: 100%;"><tr>
<td>preprocessExpressionMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pre-process the expression matrix before generating the shiny app</h2>

<h3>Description</h3>

<p>This function denoises the expression matrix using the noisyR package
and then normalises it. It is recommended to use this function before using
<code>generateShinyApp</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">preprocessExpressionMatrix(
  expression.matrix,
  denoise = TRUE,
  output.plot = FALSE,
  normalisation.method = c("quantile", "rpm", "tmm", "deseq2", "median"),
  n_million = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expression.matrix</code></td>
<td>
<p>the expression matrix; rows correspond to genes and
columns correspond to samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denoise</code></td>
<td>
<p>whether to use noisyR to denoise the expression matrix;
proceeding without denoising data is not recommended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.plot</code></td>
<td>
<p>whether to create an expression-similarity plot for the
noise analysis (printed to the console); default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalisation.method</code></td>
<td>
<p>the normalisation method to be used; default is
quantile; any unrecognised input will result in no normalisation being
applied, but proceeding with un-normalised data is not recommended;
currently supported normalisation methods are:
</p>

<dl>
<dt>quantile</dt>
<dd>
<p>Quantile normalisation using the <code>normalize.quantiles</code>
function from the <code>preprocessCore</code> package</p>
</dd>
<dt>rpm</dt>
<dd>
<p>RPM (reads per million) normalisation, where each
sample is scaled by 1 (or more using the n_million parameter) million and
divided by the total number of reads in that sample</p>
</dd>
<dt>tmm</dt>
<dd>
<p>Trimmed Mean of M values normalisation using the
<code>calcNormFactors</code> function from the <code>edgeR</code> package</p>
</dd>
<dt>deseq2</dt>
<dd>
<p>Size factor normalisation using the
<code>estimateSizeFactorsForMatrix</code> function from the <code>DESeq2</code> package</p>
</dd>
<dt>median</dt>
<dd>
<p>Normalisation using the median, where each
sample is scaled by the median expression in the sample divided by the
total number of reads in that sample</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_million</code></td>
<td>
<p>scaling factor for RPM normalisation; default is 1 million</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed on to <code>noisyr::noisyr_counts()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The denoised, normalised expression matrix; some rows (genes)
may have been removed by noisyR.
</p>


<h3>Examples</h3>

<pre><code class="language-R">expression.matrix &lt;- as.matrix(read.csv(
  system.file("extdata", "expression_matrix.csv", package = "bulkAnalyseR"), 
  row.names = 1
))[1:10, 1:4]
expression.matrix.preproc &lt;- preprocessExpressionMatrix(expression.matrix)
</code></pre>


</div>