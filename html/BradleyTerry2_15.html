<div class="container">

<table style="width: 100%;"><tr>
<td>glmmPQL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PQL Estimation of Generalized Linear Mixed Models</h2>

<h3>Description</h3>

<p>Fits GLMMs with simple random effects structure via Breslow and Clayton's
PQL algorithm.
The GLMM is assumed to be of the form g(<b>μ</b>) =
<b>Xβ</b> + <b>Ze</b> where <code class="reqn">g</code> is the link
function, <b>μ</b> is the
vector of means and <b>X</b>, <b>Z</b> are design matrices for the fixed effects
<b>β</b> and random
effects <b>e</b> respectively.
Furthermore the random effects are assumed to be i.i.d.
N(0, σ<sup>2</sup>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmmPQL(
  fixed,
  random = NULL,
  family = "binomial",
  data = NULL,
  subset = NULL,
  weights = NULL,
  offset = NULL,
  na.action = NULL,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  control = glmmPQL.control(...),
  sigma = 0.1,
  sigma.fixed = FALSE,
  model = TRUE,
  x = FALSE,
  contrasts = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a formula for the fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>a design matrix for the random effects, with number of rows
equal to the length of variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a family
function, a family function or the result of a call to a family function.
(See <code>family()</code> for details of family functions.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible
by <code>as.data.frame()</code> to a data frame) containing the variables in
the model.  If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>glmmPQL</code> called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional logical or numeric vector specifying a subset of
observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of ‘prior weights’ to be used in
the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>an optional numeric vector to be added to the linear predictor
during fitting. One or more <code>offset</code> terms can be included in the
formula instead or as well, and if more than one is specified their sum is
used.  See <code>model.offset()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>s.  The default is set by the <code>na.action</code> setting of
<code>options()</code>, and is <code>na.fail()</code> if that is unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting values for the parameters in the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>
<p>starting values for the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>
<p>starting values for the vector of means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of parameters for controlling the fitting process.
See the <code>glmmPQL.control()</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a starting value for the standard deviation of the random
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.fixed</code></td>
<td>
<p>logical: whether or not the standard deviation of the
random effects should be fixed at its starting value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>logical: whether or not the model frame should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>logical: whether or not the design matrix for the fixed effects
should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> argument of
<code>model.matrix()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>glmmPQL.control()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"BTglmmPQL"</code> which inherits from
<code>"glm"</code> and <code>"lm"</code>: </p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p> a named vector of
coefficients, with a <code>"random"</code> attribute giving the estimated random
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p> the working residuals from the final iteration
of the IWLS loop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>the design matrix for the random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p> the fitted mean values, obtained by transforming the
linear predictors by the inverse of the link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the
numeric rank of the fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the <code>family</code>
object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>up to a constant, minus twice the maximized log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>a version of Akaike's <em>An Information Criterion</em>, minus
twice the maximized log-likelihood plus twice the number of parameters,
computed by the <code>aic</code> component of the family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.deviance</code></td>
<td>
<p>the deviance for the null model, comparable with
<code>deviance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the numer of iterations of the PQL algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the working weights, that is the weights in the final
iteration of the IWLS loop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.weights</code></td>
<td>
<p>the weights initially
supplied, a vector of <code>1</code>'s if none were.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the
residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom
for the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if requested (the default) the <code>y</code> vector
used. (It is a vector even for a binomial model.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>if requested,
the model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>if requested (the default), the model
frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical. Was the PQL algorithm judged to have
converged?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula
supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the <code>terms</code> object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the
<code>data</code> argument used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>the offset vector used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>the value of the <code>control</code> argument used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>(where relevant) the contrasts used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>
<p>(where
relevant) a record of the levels of the factors used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>(where relevant) information returned by <code>model.frame</code>
on the special handling of <code>NA</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the estimated standard
deviation of the random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.fixed</code></td>
<td>
<p>logical: whether or not
<code>sigma</code> was fixed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varFix</code></td>
<td>
<p>the variance-covariance matrix of the
fixed effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varSigma</code></td>
<td>
<p>the variance of <code>sigma</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Heather Turner
</p>


<h3>References</h3>

<p>Breslow, N. E. and Clayton, D. G. (1993) Approximate inference
in Generalized Linear Mixed Models. <em>Journal of the American
Statistical Association</em> <strong>88</strong>(421), 9–25.
</p>
<p>Harville, D. A. (1977) Maximum likelihood approaches to variance component
estimation and to related problems. <em>Journal of the American
Statistical Association</em> <strong>72</strong>(358), 320–338.
</p>


<h3>See Also</h3>

<p><code>predict.BTglmmPQL()</code>,<code>glmmPQL.control()</code>,<code>BTm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###############################################
## Crowder seeds example from Breslow &amp; Clayton
###############################################

summary(glmmPQL(cbind(r, n - r) ~ seed + extract,
        random = diag(nrow(seeds)),
        family = "binomial", data = seeds))

summary(glmmPQL(cbind(r, n - r) ~ seed*extract,
                random = diag(nrow(seeds)),
                family = "binomial", data = seeds))

</code></pre>


</div>