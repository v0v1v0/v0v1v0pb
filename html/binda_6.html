<div class="container">

<table style="width: 100%;"><tr>
<td>dichotomize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dichotomize Continuous Data Set With Labels</h2>

<h3>Description</h3>

<p><code>dichotomize</code> converts a matrix containing continous measurements into a binary matrix.
</p>
<p><code>optimizeThreshold</code> determines optimal thresholds for dichotomization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dichotomize(X, thresh)
optimizeThreshold(X, L, lambda.freqs, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>data matrix (columns correspond to variables, rows to samples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>vector of thresholds, one for each variable (column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>factor containing the class labels, one for each sample (row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.freqs</code></td>
<td>
<p>shrinkage parameter for class frequencies (if not specified it is estimated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>report shrinkage intensity and other information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dichotomize</code> assigns 0 if a matrix entry is lower than given column-specific threshold, otherwise it assigns 1.
</p>
<p><code>optimizeThreshold</code> uses (approximate) mutual information to 
determine the optimal thresholds.  Specifically, the thresholds are chosen to maximize the
mutual information between response and each variable.  The same criterion is also used in
<code>binda.ranking</code>.  For detailed description of the dichotomization procedure see Gibb and Strimmer (2015).
</p>
<p>Class frequencies are estimated using <code>freqs.shrink</code>.
</p>


<h3>Value</h3>

<p><code>dichotomize</code> returns a binary matrix.
</p>
<p><code>optimizeThreshold</code> returns a vector containing the variable thresholds.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Gibb, S., and K. Strimmer. 2015.  Differential protein expression and peak selection in mass spectrometry data by binary discriminant analysis. Bioinformatics 31:3156-3162.
&lt;DOI:10.1093/bioinformatics/btv334&gt;
</p>


<h3>See Also</h3>

 <p><code>binda.ranking</code>, <code>freqs.shrink</code>, <code>mi.plugin</code>,  <code>is.binaryMatrix</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load binda library
library("binda")

# example data with 6 variables (in columns) and 4 samples (in rows)
X = matrix(c(1, 1, 1, 1.75, 0.4,    0,
             1, 1, 2,    2, 0.4, 0.09,
             1, 0, 1,    1, 0.5,  0.1,
             1, 0, 1,  0.5, 0.6,  0.1), nrow=4, byrow=TRUE)
colnames(X) = paste0("V", 1:ncol(X))

# class labels
L = factor(c("Treatment", "Treatment", "Control", "Control") )
rownames(X) = paste0(L, rep(1:2, times=2))

X
#          V1 V2 V3   V4  V5   V6
#Treatment1  1  1  1 1.75 0.4 0.00
#Treatment2  1  1  2 2.00 0.4 0.09
#Control1    1  0  1 1.00 0.5 0.10
#Control2    1  0  1 0.50 0.6 0.10

# find optimal thresholds (one for each variable)
thr = optimizeThreshold(X, L)
thr
#  V1   V2   V3   V4   V5   V6 
#1.00 1.00 2.00 1.75 0.50 0.10

# convert into binary matrix
# if value is lower than threshold -&gt; 0 otherwise -&gt; 1
Xb = dichotomize(X, thr)
is.binaryMatrix(Xb) # TRUE
Xb
#          V1 V2 V3 V4 V5 V6
#Treatment1  1  1  0  1  0  0
#Treatment2  1  1  1  1  0  0
#Control1    1  0  0  0  1  1
#Control2    1  0  0  0  1  1
#attr(,"thresh")
#  V1   V2   V3   V4   V5   V6 
#1.00 1.00 2.00 1.75 0.50 0.10
</code></pre>


</div>