<div class="container">

<table style="width: 100%;"><tr>
<td>ModProb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logarithm of unnormalized probability of a given model</h2>

<h3>Description</h3>

<p>This function calculates the logarithm of unnormalized
probability of a given set of covariates for both survival and binary
response data. It uses the inverse moment nonlocal prior (iMOM) for
non zero coefficients and beta binomial prior for the model space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ModProb(
  X,
  resp,
  mod_cols,
  nlptype = "piMOM",
  tau,
  r,
  a,
  b,
  family = c("logistic", "survival")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design matrix. It is assumed that the design matrix has
standardized columns. It is recommended that to use the output of
<code>PreProcess</code> function of the package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>For logistic regression models, this variable is the binary
response vector. For Cox proportional hazard models this is a two column
matrix where the first column contains the survival time vector and the
second column is the censoring status for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_cols</code></td>
<td>
<p>A vector of column indices of the design matrix,
representing the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlptype</code></td>
<td>
<p>Determines the type of nonlocal prior that is used in the
analyses. It can be "piMOM" for product inverse moment prior, or "pMOM" for
product moment prior. The default is set to piMOM prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Hyperparameter <code>tau</code> of the iMOM prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Hyperparameter <code>r</code> of the iMOM prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>First parameter in the beta binomial prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Second parameter in the beta binomial prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Determines the type of data analysis. <code>logistic</code> is for
binary outcome and logistic regression model whereas,
<code>survival</code> represents survival outcomes and the Cox proportional
hazard model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns the unnormalized probability for the selected model.
</p>


<h3>Author(s)</h3>

<p>Amir Nikooienejad
</p>


<h3>References</h3>

<p>Nikooienejad, A., Wang, W., and Johnson, V. E. (2016). Bayesian
variable selection for binary outcomes in high dimensional genomic studies
using nonlocal priors. Bioinformatics, 32(9), 1338-1345.<br><br>
Nikooienejad, A., Wang, W., &amp; Johnson, V. E. (2020). Bayesian variable
selection for survival data using inverse moment priors. Annals of Applied
Statistics, 14(2), 809-828.
</p>


<h3>See Also</h3>

<p><code>CoefEst</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Simulating Logistic Regression Data
n &lt;- 400
p &lt;- 1000
set.seed(123)
Sigma &lt;- diag(p)
full &lt;- matrix(c(rep(0.5, p*p)), ncol=p)
Sigma &lt;- full + 0.5*Sigma
cholS &lt;- chol(Sigma)
Beta &lt;- c(1,1.8,2.5)
X = matrix(rnorm(n*p), ncol=p)
X = X%*%cholS
beta &lt;- numeric(p)
beta[c(1:length(Beta))] &lt;- Beta
XB &lt;- X%*%beta
probs &lt;- as.vector(exp(XB)/(1+exp(XB)))
y &lt;- rbinom(n,1,probs)

### Calling the function for a subset of the true model, with an arbitrary
### parameters for prior densities
mod &lt;- c(1:3)
Mprob &lt;- ModProb(X, y, mod, tau = 0.7, r = 1, a = 7, b = 993,
                 family = "logistic")

Mprob
</code></pre>


</div>