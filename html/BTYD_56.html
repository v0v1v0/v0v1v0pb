<div class="container">

<table style="width: 100%;"><tr>
<td>dc.ElogToCbsCbt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Event Log to CBS and CBT Matrices</h2>

<h3>Description</h3>

<p>Uses an event log to return calibration period CBT and CBS, holdout period
CBT and CBS, and summary data for each customer (including times of first and
last transactions).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dc.ElogToCbsCbt(
  elog,
  per = "week",
  T.cal = max(elog$date),
  T.tot = max(elog$date),
  merge.same.date = TRUE,
  cohort.birth.per = T.cal,
  dissipate.factor = 1,
  statistic = "freq"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>elog</code></td>
<td>
<p>event log, which is a data frame with columns for customer ID
("cust"), date ("date"), and optionally other columns such as "sales". Each
row represents an event, such as a transaction. The "date" column must
contain date objects, not character strings or factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per</code></td>
<td>
<p>interval of time for customer-by-sufficient-statistic matrix.
May be "day", "week", "month", "quarter", or "year".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.cal</code></td>
<td>
<p>R date object indicating when the calibration period ends.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.tot</code></td>
<td>
<p>T.tot    R date object indicating when holdout period ends.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge.same.date</code></td>
<td>
<p>If TRUE, transactions from the same period count as
a single transaction instead of counting as multiple transactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohort.birth.per</code></td>
<td>
<p>Time interval used to filter the event log. Can be
specified as a Date object or a vector of two Dates. If one date object is
used, the birth period is from the minimum date in the dataset through the
given date. If two dates are given, the birth period is set between
(inclusive) the two dates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dissipate.factor</code></td>
<td>
<p>integer indicating how much of the dataset to
eliminate. If left as 1, none of the dataset is eliminated.
(dissipate.factor-1)/(dissipate.factor) events will be removed from the
event log. For example, if 2 is provided, 1/2 of the event log is
eliminated, and if 10 is provided, 9/10 of the event log is eliminated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Determines type of CBT returned: can be: "reach",
"freq", "total.spend", or "average.spend." (note: spend requires $sales
column in elog)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function automatically removes customers' first transactions, meaning
that the output matrices will only contain repeat transaction information.
</p>


<h3>Value</h3>

<p>A list of items: - <code style="white-space: pre;">⁠$cal⁠</code> list with CBS and CBT from the calibration
period - <code style="white-space: pre;">⁠$holdout⁠</code> list with CBS and CBT from holdout period -
<code style="white-space: pre;">⁠$cust.data⁠</code> data frame with each customer's first and last transaction
details
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
# Create event log from file "cdnowElog.csv", which has
# customer IDs in the second column, dates in the third column, and
# sales numbers in the fifth column.
elog &lt;- dc.ReadLines(system.file("data/cdnowElog.csv", package="BTYD"),2,3,5)

elog[,"date"] &lt;- as.Date(elog[,"date"], "%Y%m%d")

data &lt;- dc.ElogToCbsCbt(elog, per="week", T.cal=as.Date("1997-09-30"))
</code></pre>


</div>