<div class="container">

<table style="width: 100%;"><tr>
<td>filter.cmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Contact Map Consensus Filtering </h2>

<h3>Description</h3>

<p>This function filters a tridimensional contact matrix (NxNxZ), where N is
the residue number and Z is the simulation number) selecting only
contacts present in at least P simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter.cmap(cm, cutoff.sims = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cm</code></td>
<td>
<p> An array of dimensions NxNxZ or a list of NxN matrices
containing binary contact values as obtained from
<code>cmap</code>. Here, ‘N’ is the residue number and ‘Z’
the simulation number. The matrix elements should be 1 if two
residues are in contact and 0 if they are not in contact. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.sims</code></td>
<td>
<p> A single element numeric vector corresponding to
the minimum number of simulations a contact between two residues
must be present. If not, it will be set to 0 in the output matrix. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output matrix is a nXn binary matrix (n = residue number). Elements
equal to 1 correspond to residues in contact, elements equal to 0 to
residues not in contact. 
</p>


<h3>See Also</h3>

<p><code>cmap</code>, <code>plot.cmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
   ## load example data
  pdbfile &lt;- system.file("examples/hivp.pdb", package="bio3d")
  pdb &lt;- read.pdb(pdbfile)

  trtfile &lt;- system.file("examples/hivp.dcd", package="bio3d")
  trj &lt;- read.dcd(trtfile, verbose=FALSE)

  ## split the trj example in two
  num.of.frames &lt;- dim(trj)[1]
  trj1 &lt;- trj[1:(num.of.frames/2),]
  trj2 &lt;- trj[((num.of.frames/2)+1):num.of.frames,]

  ## Lets work with Calpha atoms only
  ca.inds &lt;- atom.select(pdb, "calpha")
  #noh.inds &lt;- atom.select(pdb, "noh")

  ## calculate single contact map matrices
  cms &lt;- list()
  cms[[1]] &lt;- cmap(trj1[,ca.inds$xyz], pcut=0.3, scut=0, dcut=7, mask.lower=FALSE)
  cms[[2]] &lt;- cmap(trj1[,ca.inds$xyz], pcut=0.3, scut=0, dcut=7, mask.lower=FALSE)

  ## calculate average contact matrix
  cm.filter &lt;- filter.cmap(cms, cutoff.sims=2)

  ## plot the result
  par(pty="s", mfcol=c(1,3))
  plot.cmap(cms[[1]])
  plot.cmap(cms[[2]])
  plot.cmap(cm.filter)

## End(Not run)
</code></pre>


</div>