<div class="container">

<table style="width: 100%;"><tr>
<td>ffdEvidenceFETS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ffdEvidenceFETS</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>This function can be used to build activation maps for task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ffdEvidenceFETS(
  ffdc,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos1 = 30,
  r1 = 1,
  perVol = 0.1,
  Test = "LTT",
  Ncores = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the observed voxel at time t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n0=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perVol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*perVol</code> can be considered irrelevant and discarded from the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Test</code></td>
<td>
<p>test type either <code>"LTT"</code> (Average cluster effect) or <code>"JointTest"</code> (Joint effect).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ncores</code></td>
<td>
<p>a positive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Every voxel from the 4D array image is clustered with its nearest neighbors. There are as many clusters as voxels in the image. Then, activation maps are obtained by fitting a multivariate dynamic linear model on every cluster of voxels. 
The resulting activation evidence measure for every voxel is obtained using the Forward Estimated Trajectories Sampler (FETS) algorithm. To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of the type <code>res[[p]][x,y,z]</code>, where <code>p</code> represents the column position in
the covariates matrix and <code>[x,y,z]</code> represent the voxel position in the brain image.
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
“Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.”
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
“BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.”
<em>arXiv e-prints</em>, arXiv–2111.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdEvidenceFETS(ffdc = fMRI.data, covariates = Covariates,
                       m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                       n0 = 1, Nsimu1 = 100, Cutpos1 = 30, 
                       r1 = 2, Test = "JointTest",  Ncores = 1)
str(res)

## End(Not run)
</code></pre>


</div>