<div class="container">

<table style="width: 100%;"><tr>
<td>boxcoxtype</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Box-Cox-type link function for logistic mixed-effects Models</h2>

<h3>Description</h3>

<p>The <code>boxcoxtype()</code> performs a grid search over the parameter <code>Lambda</code>
for logistic mixed-effects models and then optimizes over this grid,
to calculate the maximum likelihood estimator of the transformation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boxcoxtype(
  formula,
  random = ~1,
  k = 3,
  trials = 1,
  data,
  find.in.range = c(-2, 2),
  s = 20,
  plot.opt = 1,
  random.distribution = "np",
  ...
)

boxcoxpower(Lambda = 0)

binomial(link = boxcoxpower(0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>a formula defining the random model. Set <code>random= ~1</code> to model
logistic-type overdispersion model. For a two-level logistic-type model,
set <code>random= ~1|groups</code>, where groups are at the upper level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of mass points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>optional prior weights for the data. For Bernoulli distribution, set trials=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find.in.range</code></td>
<td>
<p>search in a range of <code>Lambda</code>, with default (-2,2)
in step of 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>number of points in the grid search of <code>Lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>Set <code>plot.opt=1</code>, to plot the profile log-likelihood against <code>Lambda</code>.
if <code>plot.opt=0</code>, no plot is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.distribution</code></td>
<td>
<p>the mixing distribution, Gaussian Quadrature (gq) or NPML (np) can be set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>the power of the transformation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>the link function to be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Box-Cox transformation (Box &amp; Cox, 1964) is applied to the
logistic mixed-effects models with an unspecified
mixing distribution. The NPML estimate of the mixing distribution is known
to be a discrete distribution involving a finite number of mass-points and corresponding
masses (Aitkin et al., 2009). An Expectation-Maximization (EM) algorithm is
used for fitting the finite mixture distribution, one needs to specify the
number of components <code>k</code> of the finite mixture in advance.
This algorithm can be implemented using the npmlreg function <code>alldist</code>
for the logistic-type overdispersion model and the npmlreg function <code>allvc</code> for the 
two-level logistic-type model, setting <code>family = binomial(link = boxcoxpower(Lambda))</code> where 
<code>Lambda</code> is the value of the power transformation. When <code>k</code>=1, the npmlreg function <code>alldist()</code> 
fits the logistic regression model without random effects. 
</p>
<p><code>boxcoxtype()</code> performs a grid search over the parameter <code>Lambda</code> and then
optimizes over this grid, to calculate the maximum likelihood estimator of the transformation.
It produces a plot of the profile likelihood function that summarises information
concerning <code>Lambda</code>, including a vertical line indicating the best value of <code>Lambda</code>
that maximizes the profile log-likelihood.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Maximum</code></td>
<td>
<p>the best estimate of <code>Lambda</code> found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>the value of the profile
log-likelihood corresponding to Maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>the vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile.loglik</code></td>
<td>
<p>the profile log-likelihood of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>the fitted alldist object from the last EM iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the Bayesian information criterion of the fitted regression model.</p>
</td>
</tr>
</table>
<p>The other outcomes are not relevant to users and they are intended for internal use only.
</p>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>


<h3>See Also</h3>

<p><code>np.boxcoxmix</code>, <code>optim.boxcox</code>,
<code>tolfind.boxcox</code>, <code>Kfind.boxcox</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Beta blockers data
data("betablocker", package = "flexmix")
library(npmlreg)
betavc &lt;-allvc(cbind(Deaths, Total - Deaths) ~ Treatment, data = betablocker,random=~1|Center,
 k=3,random.distribution='np',family = binomial(link = boxcoxpower(0)))
betavc$disparity
#[1] 318.7211
betavc3 &lt;-boxcoxtype(cbind(Deaths, Total - Deaths) ~ Treatment,random=~1|Center, 
data = betablocker, find.in.range = c(-2,0.4),s=40,k=3,random.distribution='np')
#Maximum Profile Log-likelihood: -158.6025 at lambda= -0.56
betavc3$fit$disparity
#[1] 317.2049
betavc3$aic
#[1] 331.2049
betavc3$bic
#[1] 343.6942

</code></pre>


</div>