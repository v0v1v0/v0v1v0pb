<div class="container">

<table style="width: 100%;"><tr>
<td>bpbounds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric Bounds for the Average Causal Effect due to Balke and Pearl.</h2>

<h3>Description</h3>

<p>Nonparametric Bounds for the Average Causal Effect due to Balke and Pearl.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bpbounds(p, t = NULL, fmt = "trivariate")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Object of class "table" containing either cell counts or conditional
probabilities. For trivariate data these are for the
phenotype/treatment-outcome association given Z, i.e. P(X, Y | Z).
</p>
<p>Cell counts could be generated from <code>xtabs(~ x + y + z, data = data)</code>.
And then conditional probabilities obatained by calling
<code>prop.table(..., margins = 3)</code> on your object from <code>xtabs()</code>.
</p>
<p>If you only know the conditional probabilities you can enter these, e.g.
for the Balke and Pearl Vitamin A example:
</p>
<div class="sourceCode r"><pre>cp   &lt;- c(.0064, 0, .9936, 0, .0028, .001, .1972, .799)
tabp &lt;- as.table(array(
  cp,
  dim = c(2, 2, 2),
  dimnames = list(
    x = c(0, 1),
    y = c(0, 1),
    z = c(0, 1)
  )
))
</pre></div>
<p>And then call <code>bpbounds()</code> using this object.
</p>
<p>For bivariate data this object contains cell conditional probabilities for
the outcome-instrument (Y|Z) association.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Specified for bivariate data. Object with
treatment/phenotype-instrument cell counts or conditional probabilities,
i.e. (X|Z).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmt</code></td>
<td>
<p>A character string which sould be either "bivariate"
(i.e. X, Z in one dataset and Y, Z in another dataset) or
"trivariate" (X, Y, Z in the same dataset).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with the following elements:
</p>

<dl>
<dt>fmt</dt>
<dd>
<p>whether the data is bivariate or trivariate</p>
</dd>
<dt>nzcats</dt>
<dd>
<p>2 or 3, the no. instrument categories</p>
</dd>
<dt>inequality</dt>
<dd>
<p>Logical, indicating whether the IV inquality is satisfied</p>
</dd>
<dt>bplb</dt>
<dd>
<p>Lower bound of ACE</p>
</dd>
<dt>bpub</dt>
<dd>
<p>Upper bound of ACE</p>
</dd>
<dt>bplower</dt>
<dd>
<p>Vector of lower bound probabilities</p>
</dd>
<dt>bpupper</dt>
<dd>
<p>Vector of upper bound probabilities</p>
</dd>
<dt>p11low</dt>
<dd>
<p>Lower bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p11upp</dt>
<dd>
<p>Upper bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p10low</dt>
<dd>
<p>Lower bound of P(Y=1|do(X=0))</p>
</dd>
<dt>p10upp</dt>
<dd>
<p>Upper bound of P(Y=1|do(X=0))</p>
</dd>
<dt>p11lower</dt>
<dd>
<p>Vector of probabilities for lower bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p11upper</dt>
<dd>
<p>Vector of probabilities for upper bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p10lower</dt>
<dd>
<p>Vector of probabilities for lower bound of P(Y=1|do(X=0))</p>
</dd>
<dt>p10upper</dt>
<dd>
<p>Vector of probabilities for upper bound of P(Y=1|do(X=0))</p>
</dd>
<dt>crrlb</dt>
<dd>
<p>Lower bound of CRR</p>
</dd>
<dt>crrub</dt>
<dd>
<p>Upper bound of CRR</p>
</dd>
<dt>monoinequality</dt>
<dd>
<p>Logical, indicating whether the monoticity inequality
is satisfied</p>
</dd>
<dt>monobplb</dt>
<dd>
<p>Lower bound of ACE assuming monotonicity</p>
</dd>
<dt>monobpub</dt>
<dd>
<p>Upper bound of ACE assuming monotonicity</p>
</dd>
<dt>monobplower</dt>
<dd>
<p>Vector of probabilities for lower bound of ACE assuming
monotonicity</p>
</dd>
<dt>monobpupper</dt>
<dd>
<p>Vector of probabilities for upper bound of ACE assuming
monotonicity</p>
</dd>
<dt>monop11low</dt>
<dd>
<p>Lower bound of P(Y=1|do(X=1)) assuming monotonicity</p>
</dd>
<dt>monop11upp</dt>
<dd>
<p>Upper bound of P(Y=1|do(X=1)) assuming monotonicity</p>
</dd>
<dt>monop10low</dt>
<dd>
<p>Lower bound of P(Y=1|do(X=0)) assuming monotonicity</p>
</dd>
<dt>monop10upp</dt>
<dd>
<p>Upper bound of P(Y=1|do(X=0)) assuming monotonicity</p>
</dd>
<dt>monop11lower</dt>
<dd>
<p>Vector for corresponding bound above</p>
</dd>
<dt>monop11upper</dt>
<dd>
<p>Vector for corresponding bound above</p>
</dd>
<dt>monop10lower</dt>
<dd>
<p>Vector for corresponding bound above</p>
</dd>
<dt>monop10upper</dt>
<dd>
<p>Vector for corresponding bound above</p>
</dd>
<dt>monocrrlb</dt>
<dd>
<p>Lower bound of CRR assuming monotonicity</p>
</dd>
<dt>monocrrub</dt>
<dd>
<p>Upper bound of CRR assuming monotonicity</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
# Vitamin A example, using cell counts

require(tidyr)
require(bpbounds)

tab1dat &lt;- data.frame(
  z = c(0, 0, 1, 1, 1, 1, 0, 0),
  x = c(0, 0, 0, 0, 1, 1, 1, 1),
  y = c(0, 1, 0, 1, 0, 1, 0, 1),
  freq = c(74, 11514, 34, 2385, 12, 9663, 0, 0)
)
tab1inddat &lt;- uncount(tab1dat, freq)
xt         &lt;- xtabs(~ x + y + z, data = tab1inddat)
p          &lt;- prop.table(xt, margin = 3)
bpres      &lt;- bpbounds(p)
sbpres     &lt;- summary(bpres)
print(sbpres)



# Vitamin A example, using conditional probabilities

require(bpbounds)
cp = c(.0064, 0, .9936, 0, .0028, .001, .1972, .799)
tabp = as.table(array(
  cp,
  dim = c(2, 2, 2),
  dimnames = list(
    x = c(0, 1),
    y = c(0, 1),
    z = c(0, 1)
  )
))
bpbounds(tabp)


</code></pre>


</div>