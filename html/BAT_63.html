<div class="container">

<table style="width: 100%;"><tr>
<td>raster.dispersion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maps of phylogenetic/functional dispersion of species or individuals.</h2>

<h3>Description</h3>

<p>Average dissimilarity between any two species or individuals randomly chosen in a community using rasters of species distributions (presence/absence or abundance).
</p>


<h3>Usage</h3>

<pre><code class="language-R">raster.dispersion(
  layers,
  tree,
  distance,
  func = "originality",
  abund = FALSE,
  relative = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>A SpatRaster object of species distributions from package terra.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylo or hclust object or alternatively a species x traits matrix or data.frame to build a functional tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>A dist object representing the phylogenetic or functional distance between species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>Calculate dispersion using originality (default), uniqueness or contribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abund</code></td>
<td>
<p>A boolean (T/F) indicating whether dispersion should be calculated using individuals (T) or species (F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p>A boolean (T/F) indicating whether dispersion should be relative to the maximum distance between any two species in the tree or distance matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If abundance data is used and a tree is given, dispersion is the quadratic entropy of Rao (1982).
If abundance data is not used but a tree is given, dispersion is the phylogenetic dispersion measure of Webb et al. (2002).
Note that cells with less than two species cannot have dispersion values.
</p>


<h3>Value</h3>

<p>A SpatRaster object representing dispersion in space.
</p>


<h3>References</h3>

<p>Rao, C.R. (1982) Diversity and dissimilarity coefficients: a unified approach. Theoretical Population Biology, 21: 24-43.
</p>
<p>Webb, C.O., Ackerly, D.D., McPeek, M.A. &amp; Donoghue, M.J. (2002) Phylogenies and community ecology. Annual Review of Ecology and Systematics, 33: 475-505.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sp1 &lt;- terra::rast(matrix(c(NA,1,1,1,1,0,0,0,0), nrow = 3, ncol = 3, byrow = TRUE))
sp2 &lt;- terra::rast(matrix(c(0,0,0,0,1,1,1,1,1), nrow = 3, ncol = 3, byrow = TRUE))
sp3 &lt;- terra::rast(matrix(c(0,0,0,1,1,1,0,0,0), nrow = 3, ncol = 3, byrow = TRUE))
spp &lt;- c(sp1, sp2, sp3)
tree &lt;- hclust(dist(c(1:3), method="euclidean"), method="average")
tree$labels = c("Sp1", "Sp2", "Sp3")
names(spp) = tree$labels
raster.dispersion(spp, tree)
</code></pre>


</div>