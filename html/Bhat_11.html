<div class="container">

<table style="width: 100%;"><tr>
<td>plkhci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Profile-likelihood based confidence intervals</h2>

<h3>Description</h3>

<p>function to find <code>prob</code>*100% confidence intervals using
profile-likelihood. Numerical solutions are obtained via a modified
Newton-Raphson algorithm. The method is described in Venzon and Moolgavkar,
Journal of the Royal Statistical Society, Series C vol 37, no.1, 1988, pp.
87-94.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plkhci(x, nlogf, label, prob = 0.95, eps = 0.001, nmax = 10, nfcn = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list with components 'label' (of mode character), 'est' (the
parameter vector with the initial guess), 'low' (vector with lower bounds),
and 'upp' (vector with upper bounds)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlogf</code></td>
<td>
<p>the negative log of the density function (not necessarily
normalized) for which samples are to be obtained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>parameter for which confidence bounds are computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability associated with the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a numerical value. Convergence results when all
(logit-transformed) derivatives are smaller <code>eps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>maximum number of Newton-Raphson iterations in each direction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfcn</code></td>
<td>
<p>number of function calls</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>2 component vector giving lower and upper p% confidence bounds
</p>


<h3>Note</h3>

<p>At this point, only a single parameter label can be passed to plkhci.
This function is part of the Bhat exploration tool
</p>


<h3>Author(s)</h3>

<p>E. Georg Luebeck (FHCRC)
</p>


<h3>See Also</h3>

<p><code>dfp</code>, <code>newton</code>,
<code>logit.hessian</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
        # generate some Poisson counts on the fly
          dose &lt;- c(rep(0,50),rep(1,50),rep(5,50),rep(10,50))
          data &lt;- cbind(dose,rpois(200,20*(1+dose*.5*(1-dose*0.05))))

        # neg. log-likelihood of Poisson model with 'linear-quadratic' mean: 
          nlogf &lt;- function (x) { 
          ds &lt;- data[, 1]
          y  &lt;- data[, 2]
          g &lt;- x[1] * (1 + ds * x[2] * (1 - x[3] * ds)) 
          return(sum(g - y * log(g)))
          }

	# for example define
          x &lt;- list(label=c("a","b","c"),est=c(10.,10.,.01),low=c(0,0,0),upp=c(100,20,.1))

	# get MLEs using dfp:
	  r &lt;- dfp(x,f=nlogf)
          x$est &lt;- r$est
          plkhci(x,nlogf,"a")
          plkhci(x,nlogf,"b")
          plkhci(x,nlogf,"c")
	# e.g. 90% confidence bounds for "c" 
          plkhci(x,nlogf,"c",prob=0.9)
        

</code></pre>


</div>