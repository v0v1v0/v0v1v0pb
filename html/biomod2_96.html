<div class="container">

<table style="width: 100%;"><tr>
<td>bm_PlotResponseCurves</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot response curves</h2>

<h3>Description</h3>

<p>This function represents response curves of species distribution models, from 
<code>BIOMOD.models.out</code> or <code>BIOMOD.ensemble.models.out</code> objects that can 
be obtained from <code>BIOMOD_Modeling</code> or <code>BIOMOD_EnsembleModeling</code> 
functions. Response curves can be represented in either 2 or 3 dimensions (meaning 1 or 2 
explanatory variables at a time, see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bm_PlotResponseCurves(
  bm.out,
  models.chosen = "all",
  new.env = get_formal_data(bm.out, "expl.var"),
  show.variables = get_formal_data(bm.out, "expl.var.names"),
  fixed.var = "mean",
  do.bivariate = FALSE,
  do.plot = TRUE,
  do.progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bm.out</code></td>
<td>
<p>a <code>BIOMOD.models.out</code> or <code>BIOMOD.ensemble.models.out</code> 
object that can be obtained with the <code>BIOMOD_Modeling</code> or 
<code>BIOMOD_EnsembleModeling</code> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models.chosen</code></td>
<td>
<p>a <code>vector</code> containing model names to be kept, must be either 
<code>all</code> or a sub-selection of model names that can be obtained with the 
<code>get_built_models</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.env</code></td>
<td>
<p>a <code>matrix</code>, <code>data.frame</code> or 
<code>SpatRaster</code> object containing the new explanatory
variables (in columns or layers, with names matching the variables names
given to the <code>BIOMOD_FormatingData</code> function to build
<code>bm.out</code>) that will be used to project the species distribution model(s)
<br><em>Note that old format from <span class="pkg">raster</span> are still supported such as 
<code>RasterStack</code> objects. </em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.variables</code></td>
<td>
<p>a <code>vector</code> containing the names of the explanatory variables 
present into <code>new.env</code> parameter and to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.var</code></td>
<td>
<p>a <code>character</code> corresponding to the statistic to be used to fix as 
constant the remaining variables other than the one used to predict response, must be either 
<code>mean</code>, <code>median</code>, <code>min</code>, <code>max</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.bivariate</code></td>
<td>
<p>(<em>optional, default</em> <code>FALSE</code>) <br> 
A <code>logical</code> value defining whether the response curves are to be represented in 3 
dimensions (meaning 2 explanatory variables at a time) or not (meaning only 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>
<p>(<em>optional, default</em> <code>TRUE</code>) <br> 
A <code>logical</code> value defining whether the plot is to be rendered or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.progress</code></td>
<td>
<p>(<em>optional, default</em> <code>TRUE</code>) <br> 
A <code>logical</code> value defining whether the progress bar is to be rendered or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some additional arguments (see Details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is an adaptation of the Evaluation Strip method proposed by Elith et al. (2005). 
To build the predicted response curves :
</p>

<ul>
<li> <p><code>n-1</code> variables are set constant to a fixed value determined by the 
<code>fixed.var</code> parameter (in the case of categorical variable, the most represented 
class is taken)
</p>
</li>
<li>
<p> the remaining variable is made to vary throughout its range given by the <code>new.env</code> 
parameter 
</p>
</li>
<li>
<p> predicted values are computed with these <code>n-1</code> fixed variables, and this 
studied variable varying 
</p>
</li>
</ul>
<p>If <code>do.bivariate = TRUE</code>, 2 variables are varying at the same time. <br><br></p>
<p>The response curves obtained show the sensibility of the model to the studied variable. <br> 
Note that this method does not account for interactions between variables. <br><br></p>
<p><code>...</code> can take the following values :
</p>

<ul><li> <p><code>main</code> : a <code>character</code> corresponding to the graphic title
</p>
</li></ul>
<h3>Value</h3>

<p>A <code>list</code> containing a <code>data.frame</code> with variables and predicted values and the 
corresponding <code>ggplot</code> object representing response curves.
</p>


<h3>Author(s)</h3>

<p>Damien Georges, Maya Gueguen
</p>


<h3>References</h3>


<ul><li>
<p> Elith, J., Ferrier, S., Huettmann, FALSE. and Leathwick, J. R. 2005. The evaluation 
strip: A new and robust method for plotting predicted responses from species distribution 
models. <em>Ecological Modelling</em>, <b>186</b>, 280-289.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>BIOMOD.models.out</code>, <code>BIOMOD.ensemble.models.out</code>, 
<code>BIOMOD_Modeling</code>, <code>BIOMOD_EnsembleModeling</code>
</p>
<p>Other Secundary functions: 
<code>bm_BinaryTransformation()</code>,
<code>bm_CrossValidation()</code>,
<code>bm_FindOptimStat()</code>,
<code>bm_MakeFormula()</code>,
<code>bm_ModelingOptions()</code>,
<code>bm_PlotEvalBoxplot()</code>,
<code>bm_PlotEvalMean()</code>,
<code>bm_PlotRangeSize()</code>,
<code>bm_PlotVarImpBoxplot()</code>,
<code>bm_PseudoAbsences()</code>,
<code>bm_RunModelsLoop()</code>,
<code>bm_SRE()</code>,
<code>bm_SampleBinaryVector()</code>,
<code>bm_SampleFactorLevels()</code>,
<code>bm_Tuning()</code>,
<code>bm_VariablesImportance()</code>
</p>
<p>Other Plot functions: 
<code>bm_PlotEvalBoxplot()</code>,
<code>bm_PlotEvalMean()</code>,
<code>bm_PlotRangeSize()</code>,
<code>bm_PlotVarImpBoxplot()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(terra)

# Load species occurrences (6 species available)
data(DataSpecies)
head(DataSpecies)

# Select the name of the studied species
myRespName &lt;- 'GuloGulo'

# Get corresponding presence/absence data
myResp &lt;- as.numeric(DataSpecies[, myRespName])

# Get corresponding XY coordinates
myRespXY &lt;- DataSpecies[, c('X_WGS84', 'Y_WGS84')]

# Load environmental variables extracted from BIOCLIM (bio_3, bio_4, bio_7, bio_11 &amp; bio_12)
data(bioclim_current)
myExpl &lt;- terra::rast(bioclim_current)



# ---------------------------------------------------------------#
file.out &lt;- paste0(myRespName, "/", myRespName, ".AllModels.models.out")
if (file.exists(file.out)) {
  myBiomodModelOut &lt;- get(load(file.out))
} else {

  # Format Data with true absences
  myBiomodData &lt;- BIOMOD_FormatingData(resp.var = myResp,
                                       expl.var = myExpl,
                                       resp.xy = myRespXY,
                                       resp.name = myRespName)

  # Model single models
  myBiomodModelOut &lt;- BIOMOD_Modeling(bm.format = myBiomodData,
                                      modeling.id = 'AllModels',
                                      models = c('RF', 'GLM'),
                                      CV.strategy = 'random',
                                      CV.nb.rep = 2,
                                      CV.perc = 0.8,
                                      OPT.strategy = 'bigboss',
                                      metric.eval = c('TSS','ROC'),
                                      var.import = 3,
                                      seed.val = 42)
}


# ---------------------------------------------------------------#
# Represent response curves
mods &lt;- get_built_models(myBiomodModelOut, run = 'RUN1')
bm_PlotResponseCurves(bm.out = myBiomodModelOut, 
                      models.chosen = mods,
                      fixed.var = 'median')
## fixed.var can also be set to 'min', 'max' or 'mean'
# bm_PlotResponseCurves(bm.out = myBiomodModelOut, 
#                       models.chosen = mods,
#                       fixed.var = 'min')

# Bivariate case (one model)
# variables can be selected with argument 'show.variables'
# models can be selected with argument 'models.chosen'
mods &lt;- get_built_models(myBiomodModelOut, full.name = 'GuloGulo_allData_RUN2_RF')
bm_PlotResponseCurves(bm.out = myBiomodModelOut, 
                      show.variables = c("bio4","bio12","bio11"),
                      models.chosen = mods,
                      fixed.var = 'median',
                      do.bivariate = TRUE)
                                      
                                      
</code></pre>


</div>