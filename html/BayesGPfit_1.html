<div class="container">

<table style="width: 100%;"><tr>
<td>GP.Bayes.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regular Bayesian fitting of Gaussian process regression on regular grid points with the modified exponential sqaured kernel.</h2>

<h3>Description</h3>

<p>Regular Bayesian fitting of Gaussian process regression on regular grid points with the modified exponential sqaured kernel.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GP.Bayes.fit(
  y,
  x,
  poly_degree = 60,
  a = 0.01,
  b = 20,
  num_results = 500L,
  iters_between_results = 2L,
  burn_in = 500L,
  a_sigma = 0.01,
  b_sigma = 0.01,
  a_zeta = 0.01,
  b_zeta = 0.01,
  center = NULL,
  scale = NULL,
  max_range = NULL,
  progress_bar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of real numbers as the observations for the reponse variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of real numbers as grid points where rows are observations and columns are coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly_degree</code></td>
<td>
<p>A integer number to specify the highest degree of Hermite polynomials. The default value is 10L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A positive real number to specify the concentration parameter in the standard modified exponential squared kernel. The larger value the more the GP concentrates around the center. The default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A positive real number to specify the smoothness parameter in the standard modified exponential squared kernel. The smaller value the smoother the GP is. The default value is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_results</code></td>
<td>
<p>An integer number to specify the number of posterior samples to save over MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters_between_results</code></td>
<td>
<p>An integer number to specify the number of iterations to skip between two saved iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_in</code></td>
<td>
<p>An integer number to specify the burn-in number. The default value is 500L.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_sigma</code></td>
<td>
<p>A real number for the shape parameter in the Gamma prior of sigma2. The default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_sigma</code></td>
<td>
<p>A real number for the rate parameter in the Gamma prior of sigma2. The default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_zeta</code></td>
<td>
<p>A real number for the shape parameter in the Gamma prior of zeta. The default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_zeta</code></td>
<td>
<p>A real number for the rate parameter in the Gamma prior of zeta. The default value is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>A vector of real numbers specifying the centroid parameters in the modified exponential squared kernel. The default value is NULL and set to the center of the grid points: apply(x,2,mean).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A vector of positive numbers specifying the scale parameters in the modified exponential squared kernel. The default value is NULL and set to values such that grid points in a range of (-max_range,max_range) in each dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_range</code></td>
<td>
<p>A positive real number indicating the maximum range of the grid points to specify the scale parameter. The default value is NULL and set to 6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>A logical value to indicate whether a progress bar will be shown.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of variables including the model fitting results
</p>

<dl>
<dt>f</dt>
<dd>
<p>A vector of real numbers for the posterior mean of the fitted curve.</p>
</dd>
<dt>x</dt>
<dd>
<p>A matrix of real numbers for the grid points where rows are observations and columns are coordinates.</p>
</dd>
<dt>work_x</dt>
<dd>
<p>A matrix of real numbers for the standardized grid points for the model fitting. It has the same dimension as "x".</p>
</dd>
<dt>sigma2</dt>
<dd>
<p>A real number for the posterior mean of the variance parameter of random errors.</p>
</dd>
<dt>tau2</dt>
<dd>
<p>A real number for the posterior mean of the variance parameter for the Gaussian process prior.</p>
</dd>
<dt>theta</dt>
<dd>
<p>A vector of real numbers for the posterior mean of the basis coefficients for the Gaussian process.</p>
</dd>
<dt>Xmat</dt>
<dd>
<p>A matrix real numbers for the basis functions evaluated at the standardized grid points (work_x), where rows are observations and columns are the basis functions</p>
</dd>
<dt>grid_size</dt>
<dd>
<p>A real scalar for the grid size</p>
</dd>
<dt>center</dt>
<dd>
<p>A vector of real numbers for the centroid parameters in the modified exponential squared kernel.</p>
</dd>
<dt>scale</dt>
<dd>
<p>A vector of positive numbers for the scale parameters in the modified exponential squared kernel.</p>
</dd>
<dt>max_range</dt>
<dd>
<p>A positive real number indicating the maximum range of the grid points to specify the scale parameter.</p>
</dd>
<dt>poly_degree</dt>
<dd>
<p>An integer number to specify the highest degree of Hermite polynomials.</p>
</dd>
<dt>a</dt>
<dd>
<p>A positive real number to specify the concentration parameter in the standard modified exponential squared kernel.</p>
</dd>
<dt>b</dt>
<dd>
<p>A positive real number to specify the smoothness parameter in the standard modified exponential squared kernel.</p>
</dd>
<dt>mcmc_sample</dt>
<dd>
<p>A matrix of real numbers for saved MCMC samples.</p>
</dd>
<dt>elapsed</dt>
<dd>
<p>A real number indicating the computing time in second.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Jian Kang &lt;jiankang@umich.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BayesGPfit)
library(lattice)
set.seed(1227)
dat = list()
dat$x = GP.generate.grids(d=2,num_grids = 100)
curve = GP.simulate.curve.fast(dat$x,a=0.01,b=0.5,poly_degree=20L)
dat$f = curve$f + rnorm(length(curve$f),sd=1)
fast_fit = GP.fast.Bayes.fit(dat$f,dat$x,a=0.01,b=0.5,poly_degree=20L,progress_bar = TRUE)
reg_fit = GP.Bayes.fit(dat$f,dat$x,a=0.01,b=0.5,poly_degree=20L,progress_bar = TRUE)
mse = c(reg = mean((reg_fit$f - curve$f)^2),
       fast = mean((fast_fit$f - curve$f)^2))
print(mse)
plot(GP.plot.curve(curve,main="True curve"),split=c(1,2,2,2),more=TRUE)
plot(GP.plot.curve(fast_fit,main="Posterior mean estimates (fast)"),split=c(2,2,2,2),more=TRUE)
plot(GP.plot.curve(reg_fit,main="Posterior mean estimates (Regular)"),split=c(2,1,2,2))
</code></pre>


</div>