<div class="container">

<table style="width: 100%;"><tr>
<td>betaclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The betaclust wrapper function</h2>

<h3>Description</h3>

<p>A family of model-based clustering techniques to identify methylation states in beta-valued DNA methylation data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">betaclust(
  data,
  M = 3,
  N,
  R,
  model_names = "K..",
  model_selection = "BIC",
  parallel_process = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe of dimension <code class="reqn">C \times NR</code> containing methylation values for <code class="reqn">C</code> CpG sites from <code class="reqn">R</code> sample types collected from <code class="reqn">N</code> patients.
Samples are grouped together in the dataframe such that the columns are ordered as Sample1_Patient1, Sample1_Patient2, Sample2_Patient1, Sample2_Patient2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of methylation states to be identified in a DNA sample type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of patients in the study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Number of sample types collected from each patient for the study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_names</code></td>
<td>
<p>Models to run from the set of models, K.., KN. and K.R, default = K.. . See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_selection</code></td>
<td>
<p>Information criterion used for model selection. Options are AIC, BIC or ICL (default = BIC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel_process</code></td>
<td>
<p>The "TRUE" option results in parallel processing of the models for increased computational efficiency. The default option has been set as "FALSE" due to package testing limitations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed to allow for reproducibility (default = NULL).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper function which can be used to fit all three models (K.., KN., K.R) within a single function.
</p>
<p>The K.. and KN. models are used to analyse a single DNA sample type (<code class="reqn">R = 1</code>) and cluster the <code class="reqn">C</code> CpG sites into the <code class="reqn">K</code> clusters which represent the different methylation states in a DNA sample type. As each CpG site can belong to any of the <code class="reqn">M=3</code> methylation states (hypomethylation, hemimethylation and hypermethylation), the default value for <code class="reqn">K=M=3</code>.
The thresholds between methylation states are objectively inferred from the clustering solution.
</p>
<p>The K.R model is used to analyse <code class="reqn">R</code> independent sample types collected from <code class="reqn">N</code> patients, where each sample contains <code class="reqn">C</code> CpG sites, and cluster
the dataset into <code class="reqn">K=M^R</code> clusters to identify the differentially methylated CpG (DMC) sites between the <code class="reqn">R</code> DNA sample types.
</p>


<h3>Value</h3>

<p>The function returns an object of the <code>betaclust</code> class which contains the following values:
</p>

<ul>
<li>
<p> information_criterion - The information criterion used to select the optimal model.
</p>
</li>
<li>
<p> ic_output - The information criterion value calculated for each model.
</p>
</li>
<li>
<p> optimal_model - The model selected as optimal.
</p>
</li>
<li>
<p> function_call - The parameters passed as arguments to the function <code>betaclust</code>.
</p>
</li>
<li>
<p> K - The number of clusters identified using the beta mixture models.
</p>
</li>
<li>
<p> C - The number of CpG sites analysed using the beta mixture models.
</p>
</li>
<li>
<p> N - The number of patients analysed using the beta mixture models.
</p>
</li>
<li>
<p> R - The number of sample types analysed using the beta mixture models.
</p>
</li>
<li>
<p> optimal_model_results - Information from the optimal model. Specifically,
</p>

<ul>
<li>
<p> cluster_size - The total number of CpG sites in each of the K clusters.
</p>
</li>
<li>
<p> llk - A vector containing the log-likelihood value at each step of the EM algorithm.
</p>
</li>
<li>
<p> alpha - This contains the first shape parameter for the beta mixture model.
</p>
</li>
<li>
<p> delta - This contains the second shape parameter for the beta mixture model.
</p>
</li>
<li>
<p> tau - The proportion of CpG sites in each cluster.
</p>
</li>
<li>
<p> z - A matrix of dimension <code class="reqn">C \times K</code> containing the posterior probability of each CpG site belonging to each of the <code class="reqn">K</code> clusters.
</p>
</li>
<li>
<p> classification - The classification corresponding to z, i.e. map(z).
</p>
</li>
<li>
<p> uncertainty - The uncertainty of each CpG site's clustering.
</p>
</li>
<li>
<p> thresholds - Threshold points calculated under the K.. or the KN. model.
</p>
</li>
<li>
<p> DM - The AUC and WD metric for distribution similarity in each cluster.
</p>
</li>
</ul>
</li>
</ul>
<h3>References</h3>

<p>Silva, R., Moran, B., Russell, N.M., Fahey, C., Vlajnic, T., Manecksha, R.P., Finn, S.P., Brennan, D.J., Gallagher, W.M., Perry, A.S.: Evaluating liquid biopsies for methylomic profiling of prostate cancer. Epigenetics 15(6-7), 715-727 (2020). doi: <a href="https://doi.org/10.1080/15592294.2020.1712876">10.1080/15592294.2020.1712876</a>.
</p>
<p>Majumdar, K., Silva, R., Perry, A.S., Watson, R.W., Murphy, T.B., Gormley, I.C.: betaclust: a family of mixture models for beta valued DNA methylation data. arXiv [stat.ME] (2022). doi: <a href="https://doi.org/10.48550/ARXIV.2211.01938">10.48550/ARXIV.2211.01938</a>.
</p>


<h3>See Also</h3>

<p><code>beta_k</code>
</p>
<p><code>beta_kn</code>
</p>
<p><code>beta_kr</code>
</p>
<p><code>pca.methylation.data</code>
</p>
<p><code>plot.betaclust</code>
</p>
<p><code>summary.betaclust</code>
</p>
<p><code>threshold</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
my.seed &lt;- 190
M &lt;- 3
N &lt;- 4
R &lt;- 2
data_output &lt;- betaclust(pca.methylation.data[1:30,2:9], M, N, R,
            model_names = c("K..","KN.","K.R"), model_selection = "BIC",
            parallel_process = FALSE, seed = my.seed)


</code></pre>


</div>