<div class="container">

<table style="width: 100%;"><tr>
<td>cluster_obs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster observations into behavioral states</h2>

<h3>Description</h3>

<p>This function uses a Gibbs sampler within a mixture model to estimate the
optimal number of behavioral states, the state-dependent distributions, and
to assign behavioral states to each observation. This model does not assume
an underlying mechanistic process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cluster_obs(dat, alpha, ngibbs, nmaxclust, nburn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data frame that **only** contains columns for the discretized
movement variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric. A single value used to specify the hyperparameter for
the prior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngibbs</code></td>
<td>
<p>numeric. The total number of iterations of the MCMC chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmaxclust</code></td>
<td>
<p>numeric. A single number indicating the maximum number of
clusters to test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>numeric. The length of the burn-in phase.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mixture model analyzes all animal IDs pooled together, thus providing a
population-level estimate of behavioral states.
</p>


<h3>Value</h3>

<p>A list of model results is returned where elements include the
<code>phi</code> matrix for each data stream, <code>theta</code> matrix, log likelihood
estimates for each iteration of the MCMC chain <code>loglikel</code>, a list of
the MAP estimates of the latent states for each observation <code>z.MAP</code>, a
matrix of the whole posterior of state assignments per observation
<code>z.posterior</code>, and a vector <code>gamma1</code> of estimates for the gamma
hyperparameter.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(tracks.list)

#convert from list to data frame
tracks.list&lt;- dplyr::bind_rows(tracks.list)

#only retain id and discretized step length (SL) and turning angle (TA) columns
tracks&lt;- subset(tracks.list, select = c(SL, TA))


set.seed(1)

# Define model params
alpha=0.1
ngibbs=1000
nburn=ngibbs/2
nmaxclust=7

dat.res&lt;- cluster_obs(dat = tracks, alpha = alpha, ngibbs = ngibbs,
                           nmaxclust = nmaxclust, nburn = nburn)


</code></pre>


</div>