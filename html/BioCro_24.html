<div class="container">

<table style="width: 100%;"><tr>
<td>modules</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BioCro module functions</h2>

<h3>Description</h3>

<p>BioCro modules are named sets of equations, and each module is available from
a BioCro module library. Each module is identified by a
<a href="https://en.wikipedia.org/wiki/Fully_qualified_name">fully-qualified name</a>
that includes the name of its library and its local name within that library.
The functions here provide ways to access information about modules and to
calculate their output values from sets of input values.
</p>
<p><code>module_info</code> returns essential information about a BioCro module.
</p>
<p><code>quantity_list_from_names</code> initializes a list of named numeric elements
from a set of names.
</p>
<p><code>evaluate_module</code> runs a BioCro module using a list of input quantity
values.
</p>
<p><code>module_response_curve</code> runs a BioCro module repeatedly with different
input quantity values to produce a response curve.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  module_info(module_name, verbose = TRUE)

  quantity_list_from_names(quantity_names)

  evaluate_module(module_name, input_quantities)

  module_response_curve(module_name, fixed_quantities, varying_quantities)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>module_name</code></td>
<td>

<p>A string specifying one BioCro module, formatted like
<code>library_name:local_module_name</code>, where <code>library_name</code> is the name
of a library that contains a module with local name
<code>local_module_name</code>; such fully-qualified module names can be formed
manually or with <code>module_paste</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>A boolean indicating whether or not to print information to the R console.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_quantities</code></td>
<td>

<p>A list of named numeric elements representing the input quantities required
by the module; any extraneous quantities will be ignored by the module.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantity_names</code></td>
<td>

<p>A vector of strings.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_quantities</code></td>
<td>

<p>A list of named numeric elements representing input quantities required
by the module whose values should be considered to be constant; any
extraneous quantities will be ignored by the module.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varying_quantities</code></td>
<td>

<p>A data frame where each column represents an input quantity required by the
module whose value varies across the response curve.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By providing avenues for retrieving information about a module and evaluating
a module's equations, the <code>module_info</code> and <code>evaluate_module</code>
functions form the main interface to individual BioCro modules from within R.
The <code>quantity_list_from_names</code> function is a convenience function for
preparing suitable quantity lists to pass to <code>evaluate_module</code>.
</p>
<p>The <code>module_response_curve</code> function provides a convenient way to
calculate a module response curve. To do this, a user must specify a module to
use, the values of any fixed input quantities (<code>input_quantities</code>), and
a sequence of values for other quantities that vary across the response curve
(<code>varying_quantities</code>). The returned data frame includes all the
information that would be required to reproduce the curve: the full-qualified
module name, all inputs (including ones with constant values), and the
outputs. Note: if one quantity <code>q</code> is both an input and output of the
module, its input value will be stored in the <code>q</code> column of the returned
data frame and its output value will be stored in the <code>q.1</code> column; this
renaming is performed automatically by the <code>make.unique</code> function.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>module_info</code></td>
<td>

<p>An <code>invisible</code> list of several named elements containing
essential information about the module:
</p>

<ul>
<li> <p><code>module_name</code>: The module's (not-fully-qualified) name
</p>
</li>
<li> <p><code>inputs</code>: A character vector of the module's inputs
</p>
</li>
<li> <p><code>outputs</code>: A character vector of the module's outputs
</p>
</li>
<li> <p><code>type</code>: The module's type represented as a string (either
'differential' or 'direct')
</p>
</li>
<li> <p><code>euler_requirement</code>: Indicates whether the module requires a
fixed-step Euler ODE solver when used in a BioCro simulation
</p>
</li>
<li> <p><code>creation_error_message</code>: Describes any errors that occurred
while creating an instance of the module
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantity_list_from_names</code></td>
<td>

<p>A list of named numeric elements, where the names are set by
<code>quantity_names</code> and each value is set to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evaluate_module</code></td>
<td>

<p>A list of named numeric elements representing the values of the module's
outputs as calculated from the <code>input_quantities</code> according to the
module's equations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>module_response_curve</code></td>
<td>

<p>A data frame where the first column is the fully-qualified name of the
module that produced the response curve and the remaining columns are the
module's input and output quantities. Each row corresponds to a row in the
<code>varying_quantities</code>.
</p>
</td>
</tr>
</table>
<h3>See Also</h3>


<ul>
<li> <p><code>get_all_modules</code>
</p>
</li>
<li> <p><code>module_paste</code>
</p>
</li>
<li> <p><code>module_testing</code>
</p>
</li>
<li> <p><code>partial_evaluate_module</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example 1: printing information about the 'BioCro' module library's
# 'c3_assimilation' module to the R console
module_info('BioCro:c3_assimilation')

# Example 2: getting the inputs to the 'BioCro' module library's
# 'thermal_time_linear' module, generating a default input list, and using it to
# run the module
info &lt;- module_info('BioCro:thermal_time_linear', verbose = FALSE)
inputs &lt;- quantity_list_from_names(info$inputs) # All inputs will be set to 1
outputs &lt;- evaluate_module('BioCro:thermal_time_linear', inputs)

# Example 3: calculating the temperature response of light saturated net
# assimilation at several values of relative humidity in the absence of water
# stress using the 'BioCro' module library's 'c3_assimilation' module and
# the default soybean parameters. Here, the leaf temperature and humidity values
# are independent of each other, so we use the `expand.grid` function to form a
# data frame of all possible combinations of their values. Then we set the
# ambient temperature equal to the leaf temperature.
rc &lt;- module_response_curve(
  'BioCro:c3_assimilation',
  within(soybean$parameters, {Qabs = 2000; StomataWS = 1; gbw = 1.2}),
  within(
    expand.grid(
      Tleaf = seq(from = 0, to = 40, length.out = 201),
      rh = c(0.2, 0.5, 0.8)
    ),
    {temp = Tleaf}
  )
)

caption &lt;- paste(
  "Response curves calculated with several RH\nvalues and Q =",
  unique(rc$Qp),
  "micromol / m^2 / s\nusing the",
  unique(rc$module_name),
  "module"
)

lattice::xyplot(
  Assim ~ Tleaf,
  group = rh,
  data = rc,
  auto = TRUE,
  type = 'l',
  main = caption
)
</code></pre>


</div>