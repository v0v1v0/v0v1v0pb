<div class="container">

<table style="width: 100%;"><tr>
<td>cv.thresPPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CV for Bayesian Estimation of a Sparse Covariance Matrix</h2>

<h3>Description</h3>

<p>Performs cross-validation to estimate spectral norm error for a post-processed posterior of a sparse covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.thresPPP(
  X,
  thresvec,
  epsvec,
  prior = NULL,
  thresfun = "hard",
  nsample = 2000,
  ncores = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a n <code class="reqn">\times</code> p data matrix with column mean zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresvec</code></td>
<td>
<p>a vector of real numbers specifying the parameter of the threshold function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsvec</code></td>
<td>
<p>a vector of small positive numbers decreasing to <code class="reqn">0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list giving the prior information.
The list includes the following parameters (with default values in parentheses):
<code>A (I)</code> giving the positive definite scale matrix for the inverse-Wishart prior,
<code>nu (p + k)</code> giving the degree of freedom of the inverse-Wishar prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresfun</code></td>
<td>
<p>a string to specify the type of threshold function. <code>fun ('hard')</code> giving the thresholding function ('hard' or 'soft') for the thresholding PPP procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>a scalar value giving the number of the post-processed posterior samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>a scalar value giving the number of CPU cores.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a set of train data and validation data, the spectral norm error for each <code class="reqn">\gamma</code> and <code class="reqn">\epsilon_n</code> is estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
 ||\hat{\Sigma}(\gamma,\epsilon_n)^{(train)} - S^{(val)}||_2
 </code>
</p>

<p>where <code class="reqn">\hat{\Sigma}(\gamma,\epsilon_n)^{(train)}</code> is the estimate for the covariance based on the train data and <code class="reqn">S^{(val)}</code> is the sample covariance matrix based on the validation data.
The spectral norm error is estimated by the <code class="reqn">10</code>-fold cross-validation.
For more details, see the first paragraph on page 9 in Lee and Lee (2023).
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>CVdf</code></td>
<td>
<p>a M <code class="reqn">\times</code> 3 dataframe having the estimated spectral norm error for each thres and eps, where M = length(thresvec) * length(epsvec)</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Kwangmin Lee
</p>


<h3>References</h3>

<p>Lee, K. and Lee, J. (2023), "Post-processes posteriors for sparse covariances", <em>Journal of Econometrics</em>, 236(3), 105475.
</p>


<h3>See Also</h3>

<p>thresPPP
</p>


<h3>Examples</h3>

<pre><code class="language-R">

Sigma0 &lt;- diag(1,50)
X &lt;- mvtnorm::rmvnorm(25,sigma = Sigma0)
thresvec &lt;- c(0.01,0.1)
epsvec &lt;- c(0.01,0.1)
res &lt;- bspcov::cv.thresPPP(X,thresvec,epsvec,nsample=100)
plot(res)


</code></pre>


</div>