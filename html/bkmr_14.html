<div class="container">

<table style="width: 100%;"><tr>
<td>SamplePred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain posterior samples of predictions at new points</h2>

<h3>Description</h3>

<p>Obtains posterior samples of <code>E(Y) = h(Znew) + beta*Xnew</code> or of <code>g^{-1}[E(y)]</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">SamplePred(
  fit,
  Znew = NULL,
  Xnew = NULL,
  Z = NULL,
  X = NULL,
  y = NULL,
  sel = NULL,
  type = c("link", "response"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>An object containing the results returned by a the <code>kmbayes</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Znew</code></td>
<td>
<p>optional matrix of new predictor values at which to predict new <code>h</code>, where each row represents a new observation. If not specified, defaults to using observed Z values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xnew</code></td>
<td>
<p>optional matrix of new covariate values at which to obtain predictions. If not specified, defaults to using observed X values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>an <code>n</code>-by-<code>M</code> matrix of predictor variables to be included in the <code>h</code> function. Each row represents an observation and each column represents an predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <code>n</code>-by-<code>K</code> matrix of covariate data where each row represents an observation and each column represents a covariate. Should not contain an intercept column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of outcome data of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel</code></td>
<td>
<p>A vector selecting which iterations of the BKMR fit should be retained for inference. If not specified, will default to keeping every 10 iterations after dropping the first 50% of samples, or if this results in fewer than 100 iterations, than 100 iterations are kept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>whether to make predictions on the scale of the link or of the response; only relevant for the binomial outcome family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments; not currently used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For guided examples, go to <a href="https://jenfb.github.io/bkmr/overview.html">https://jenfb.github.io/bkmr/overview.html</a>
</p>


<h3>Value</h3>

<p>a matrix with the posterior samples at the new points
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(111)
dat &lt;- SimData(n = 50, M = 4)
y &lt;- dat$y
Z &lt;- dat$Z
X &lt;- dat$X

## Fit model with component-wise variable selection
## Using only 100 iterations to make example run quickly
## Typically should use a large number of iterations for inference
set.seed(111)
fitkm &lt;- kmbayes(y = y, Z = Z, X = X, iter = 100, verbose = FALSE, varsel = TRUE)

med_vals &lt;- apply(Z, 2, median)
Znew &lt;- matrix(med_vals, nrow = 1)
h_true &lt;- dat$HFun(Znew)
set.seed(111)
samps3 &lt;- SamplePred(fitkm, Znew = Znew, Xnew = cbind(0))
head(samps3)
</code></pre>


</div>