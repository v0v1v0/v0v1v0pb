<div class="container">

<table style="width: 100%;"><tr>
<td>BayesCumulativeProbitHSD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform MCMC algorithm to generate the posterior samples for longitudinal ordinal data</h2>

<h3>Description</h3>

<p>This function is used to generate the posterior samples using MCMC algorithm from the
cumulative probit model with the hypersphere decomposition applied to model the correlation structure
in the serial dependence of repeated responses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BayesCumulativeProbitHSD(
  fixed,
  data,
  random,
  Robustness,
  subset,
  na.action,
  HS.model,
  hyper.params,
  num.of.iter,
  Interactive
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a two-sided linear formula object to describe fixed-effects with the response on the left of
a ‘<span class="samp">⁠~⁠</span>’ operator and the terms separated by ‘<span class="samp">⁠+⁠</span>’ or ‘<span class="samp">⁠*⁠</span>’ operators, on the right.
The specification <code>first*second</code> indicates the cross of <code>first</code> and <code>second</code>.
This is the same as <code>first + second + first:second</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables named in ‘<span class="samp">⁠fixed⁠</span>’ and ‘<span class="samp">⁠random⁠</span>’.
It requires an “integer” variable named by ‘<span class="samp">⁠id⁠</span>’ to denote the identifications of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>a one-sided linear formula object to describe random-effects with the terms separated by
‘<span class="samp">⁠+⁠</span>’ or ‘<span class="samp">⁠*⁠</span>’ operators on the right of a ‘<span class="samp">⁠~⁠</span>’ operator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Robustness</code></td>
<td>
<p>logical. If 'TRUE' the distribution of random effects is assumed to be <br>
t-distribution; otherwise normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional expression indicating the subset of the rows of ‘<span class="samp">⁠data⁠</span>’ that should be used in the fit.
This can be a logical vector, or a numeric vector indicating which observation numbers are to be included,
or a character vector of the row names to be included.  All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function that indicates what should happen when the data contain NA’s.
The default action (‘<span class="samp">⁠na.omit⁠</span>’, inherited from the ‘<span class="samp">⁠factory fresh⁠</span>’ value of <br>
‘<span class="samp">⁠getOption("na.action")⁠</span>’) strips any observations with any missing values in any variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HS.model</code></td>
<td>
<p>a specification of the correlation structure in HSD model:
</p>

<ul>
<li> <p><code>HS.model = ~0</code> denotes independence, that is, <code class="reqn">R_i</code> is an identity matrix,
</p>
</li>
<li> <p><code>HS.model = ~IndTime+</code><code class="reqn">\cdots</code><code>+IndTimer</code> denotes AR(r) correlation structure,
</p>
</li>
<li> <p><code>HS.model = ~DiffTime1+</code><code class="reqn">\cdots</code><code>+DiffTimer</code> denotes correlation structure related to <code class="reqn">r</code>th order
of time difference.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper.params</code></td>
<td>
<p>specify the values in hyperparameters in priors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.of.iter</code></td>
<td>
<p>an integer to specify the total number of iterations; default is 20000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Interactive</code></td>
<td>
<p>logical. If 'TRUE' when the program is being run interactively for progress bar and 'FALSE' otherwise.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of posterior samples, parameters estimates, AIC, BIC, CIC, DIC, MPL, RJR, predicted values,
and the acceptance rates in MH are returned.
</p>


<h3>Note</h3>

<p>Only a model either HSD (‘<span class="samp">⁠HS.model⁠</span>’) or ARMA (‘<span class="samp">⁠arma.order⁠</span>’) model should be specified in the function.
We'll provide the reference for details of the model and the algorithm for performing
model estimation whenever the manuscript is accepted.
</p>


<h3>Author(s)</h3>

<p>Kuo-Jung Lee <a href="mailto:kuojunglee@ncku.edu.tw">kuojunglee@ncku.edu.tw</a>
</p>


<h3>References</h3>


<p>Lee K, Chen R, Kwak M, Lee K (2021).
“Determination of correlations in multivariate longitudinal data with modified Cholesky and hypersphere decomposition using Bayesian variable selection approach.”
<em>Statistics in Medicine</em>, <b>40</b>(4), 978–997.
</p>
<p>Lee K, Cho H, Kwak M, Jang EJ (2020).
“Estimation of covariance matrix of multivariate longitudinal data using modified Choleksky and hypersphere decompositions.”
<em>Biometrics</em>, <b>76</b>(1), 75–86.
</p>



<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(BayesRGMM)
rm(list=ls(all=TRUE))

Fixed.Effs = c(-0.1, 0.1, -0.1) #c(-0.8, -0.3, 1.8, -0.4) 
P = length(Fixed.Effs) 
q = 1 #number of random effects
T = 7 #time points
N = 100 #number of subjects
Num.of.Cats = 3 #in KBLEE simulation studies, please fix it. 
num.of.iter = 1000 #number of iterations

HSD.para = c(-0.9, -0.6) #the parameters in HSD model
a = length(HSD.para)
w = array(runif(T*T*a), c(T, T, a)) #design matrix in HSD model
 
for(time.diff in 1:a)
w[, , time.diff] = 1*(as.matrix(dist(1:T, 1:T, method="manhattan")) ==time.diff)

x = array(0, c(T, P, N))
for(i in 1:N){
    #x[,, i] = t(rmvnorm(P, rep(0, T), AR1.cor(T, Cor.in.DesignMat)))
    x[, 1, i] = 1:T
    x[, 2, i] = rbinom(1, 1, 0.5)
    x[, 3, i] = x[, 1, i]*x[, 2, i]
}

DesignMat = x

#Generate a data with HSD model


#MAR
CPREM.sim.data = SimulatedDataGenerator.CumulativeProbit(
 Num.of.Obs = N, Num.of.TimePoints = T, Num.of.Cats = Num.of.Cats, 
 Fixed.Effs = Fixed.Effs, Random.Effs = list(Sigma = 0.5*diag(1), df=3), 
 DesignMat = DesignMat, Missing = list(Missing.Mechanism = 2, 
 MissingRegCoefs=c(-0.7, -0.2, -0.1)), 
 HSD.DesignMat.para = list(HSD.para = HSD.para, DesignMat = w))

print(table(CPREM.sim.data$sim.data$y))
print(CPREM.sim.data$classes)

BCP.output = BayesCumulativeProbitHSD(
    fixed = as.formula(paste("y~", paste0("x", 1:P, collapse="+"))), 
    data=CPREM.sim.data$sim.data, random = ~ 1, Robustness = TRUE, 
    subset = NULL, na.action='na.exclude', HS.model = ~IndTime1+IndTime2, 
    hyper.params=NULL, num.of.iter=num.of.iter, Interactive=0)

BCP.Est.output = BayesRobustProbitSummary(BCP.output)

## End(Not run)
</code></pre>


</div>