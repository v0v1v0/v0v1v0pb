<div class="container">

<table style="width: 100%;"><tr>
<td>eaemg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Ensemble-averaged EMG
</h2>

<h3>Description</h3>

<p>Creates an ensemble-averaged <abbr><span class="acronym">EMG</span></abbr> associated with a cyclical activity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eaemg(data, channel, runs, what, timenormalization = c("min", "mean", "median", "max"),
   scalem = 1, empirical = TRUE, level = 0.9)

## S3 method for class 'eaemg'
plot(x, ci.lty ="dashed", ...)
## S3 method for class 'eaemg'
print(x, ...)
## S3 method for class 'eaemg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an ‘emg’ object, usually rectified, moving-average of a rectified <abbr><span class="acronym">EMG</span></abbr> or the computed envelope of an <abbr><span class="acronym">EMG</span></abbr>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>

<p>an ‘rle’ object indicating the lengths of succesive phases (active and inactive) or an atomic vector indicating in each position if the signal corresponds to a silence phase (0) or an active phase (1 or a greater integer).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>

<p>which phases are going to be ensemble-averaged, active phases (1) or silence phases (0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timenormalization</code></td>
<td>

<p>a string that indicates with respect to which value all phase durations should be normalized. It can be the “min” (default), “mean”, “median” or “max” duration of the phases.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalem</code></td>
<td>

<p>a value (&gt;=1) that controls the local detail of the ensemble.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>

<p>logical; if <code>TRUE</code> (default), the confidence intervals are computed based on the empirical quantiles; if <code>FALSE</code>, confidence intervals are computed asumming a Gaussian distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>a value in <code class="reqn">[0,1]</code> indicating the confidence level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>

<p>an ‘eaemg’ object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.lty</code></td>
<td>

<p>line type to plot the confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Ensemble-Averaged <abbr><span class="acronym">EMG</span></abbr> is usually applied to <abbr><span class="acronym">EMG</span></abbr> signals associated with cyclical activities.  In Ensemble-Averaged <abbr><span class="acronym">EMG</span></abbr> the time base for each cycle is normalized and all the profiles are averaged.  To successfully obtain the average profile, the data should be a rectified <abbr><span class="acronym">EMG</span></abbr>, the moving average of a rectified <abbr><span class="acronym">EMG</span></abbr> or the envelope of an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>
<p>The <code>runs</code> argument can be computed througth the <code>rle</code> function of a thresholded envelope (see <b>Examples</b>) or computed with an onset/offset detection algorithm (see <code>onoff_singlethres</code> and <code>onoff_bonato</code>).
</p>


<h3>Value</h3>

<p>returns an object of class ‘eaemg’ which is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>a matrix with three columns, each corresponding to the lower limit of the interval, the ensemble average and the upper limit of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>the <code>empirical</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the <code>level</code> argument</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Kumar S., Mital A. (1996) <em>Electromyography In Ergonomics</em>
Taylor &amp; Francis.
</p>
<p>Esquivel M.E., Guerrero J.A., Macias-Diaz J.E. (2010) Activity pattern detection in electroneurographic and electromyogram signals through a heteroscedastic change-point method. <em>Mathematical Biosciences</em> <b>224(2)</b> 109–117
</p>


<h3>See Also</h3>

<p><code>rectification</code>, <code>movingaverage</code>, <code>envelope</code>, <code>onoff_singlethres</code>, <code>onoff_bonato</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Simulate 10 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
# MA-envelope
emgma &lt;- envelope(emgx, method = "MA", wsize = 60)
# Ensemble-averaged EMG
ea1 &lt;- eaemg(emgma, runs = rle(emgx$on.off), what = 1, timenormalization = "max", 
    scalem = 1, empirical = TRUE, level = 0.9)
plot(ea1, lwd = 2, main = "Ensemble-averaged EMG using apriori onset/offset")

# Determine the onset/offset runs using a thresholded envelope
empiricalonoff &lt;- onoff_singlethres(emgx, t = 0.05)
ea2 &lt;- eaemg(emgma, runs = empiricalonoff, what = 1, timenormalization = "max", 
    scalem = 1, empirical = TRUE, level = 0.9)
plot(ea2, lwd = 2, main = "Ensemble-averaged EMG using empirical onset/offset")

# reset graphical parameters
par(op)
</code></pre>


</div>