<div class="container">

<table style="width: 100%;"><tr>
<td>getis.cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Getis and Ord's Gi* Cluster and Significance Map</h2>

<h3>Description</h3>

<p>Create the Getis Gi* Cluster Map and the corresponding Significance Map.
Maps are done calculating the Local Gi* (localG - spdep) for each
spatial unit and testing its significance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getis.cluster(x, listw, zero.policy = NULL, polygons, significant = TRUE, pleg, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>variable to create cluster and significance map</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a neighbours list with spatial weights. From package spdep:
a listw object. Use poly2nb (class nb)
and nb2listw (class listw, nb) from package spdep. Can be any type of listw
object, for instance, rook contiguity (common edge) or queen contiguity (common
edge or common vertex)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>by default = NULL, if FALSE stop with error for any empty
neighbour sets, if TRUE permit the weights list to be formed with zero-length
weights vectors. Parameter inherited from the spdep package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polygons</code></td>
<td>
<p>SpatialPolygons, SpatialPolygonsDataFrame or sfc_POLYGON object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>significant</code></td>
<td>
<p>by default is TRUE, if FALSE the significant map is not created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pleg</code></td>
<td>
<p>the x and y co-ordinates to be used to position the legend. They can be specified by keyword or in any way which is accepted by <code>xy.coords</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters as in <code>par(..)</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the function localG (spdep) create the Getis Gi* Cluster Map and the
corresponding Significance Map.
The significance map is done testing the null hypothesis (Ho) of zero spatial
autocorrelation for each spatial unit, then plotting a choropleth map with this
legend values: (Not Significant, p-value=0.05, p-value= 0.01, p-value=0.001,
p-value=0.0001, and Neighborless). Most significant clustered spatial units are
those with p-values smaller than 0.0001. Not significant
clustered spatial units are those with p-values grather than 0.05. Gi* Cluster Map
is done based on the significance map, but the choropleth legend is different (Not
- Significant, High-High, Low-Low, Low-High, High-Low, and Neighborless).
</p>


<h3>Value</h3>

<p>one or two maps
</p>


<h3>Links</h3>


<ol><li> <p><a href="https://pysal.org/esda/notebooks/spatialautocorrelation.html">Spatial Autocorrelation</a>
</p>
</li></ol>
<h3>See Also</h3>


<ul>
<li>
<p> Bivariate Moran's Ixy: <code>moran.bi</code>
</p>
</li>
<li>
<p> Plot Bivariate Moran's Ixy: <code>moranbi.plot</code>
</p>
</li>
<li>
<p> Bivariate Moran's Ixy Test: <code>moranbi.test</code>
</p>
</li>
<li>
<p> Bivariate Local Moran's Ixy and Test: <code>localmoran.bi</code>
</p>
</li>
<li>
<p> Create object "nb": <code>poly2nb</code>
</p>
</li>
<li>
<p> Create object "listw"/"nb": <code>nb2listw</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(spdep)
columbus &lt;- st_read(system.file("shapes/columbus.gpkg", package="spData")[1])
col_nbq &lt;- poly2nb(columbus)
a.lw &lt;- nb2listw(col_nbq, style="W")
getis.cluster(columbus$CRIME, a.lw, zero.policy = FALSE, st_geometry(columbus),
              significant=TRUE, pleg = "topleft")

</code></pre>


</div>