<div class="container">

<table style="width: 100%;"><tr>
<td>lm2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Bidimensional Regression Models</h2>

<h3>Description</h3>

<p>lm2 is used to fit bidimensional linear regression models using
Euclidean and Affine transformations following the approach by Tobler (1965).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lm2(formula, data, transformation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted in the format <code>A + B ~ C + D</code>, where
<code>A</code> and <code>B</code> are dependent and <code>C</code> and <code>D</code> are independent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>the transformation to be used, either <code>'euclidean'</code>, <code>'affine'</code>, or <code>'projective'</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>lm2 returns an object of class "lm2".
An object of class "lm" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>string with the transformation type (<code>euclidean</code>, <code>affine</code>, or <code>projective</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npredictors</code></td>
<td>
<p>number of predictors used in the model: 4 for euclidean, 6 for affine, 8 for projective.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_model, df_residual</code></td>
<td>
<p>degrees of freedom for the model and for the residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation_matrix</code></td>
<td>
<p><code>3x3</code> transformation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>transformation coefficients, with <code>a</code> denoting the intercept terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformed_coeff</code></td>
<td>
<p><code>scale</code>, <code>angle</code>, and <code>sheer</code> coefficients, depends on transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_values</code></td>
<td>
<p>data frame containing fitted values for the original data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>data frame containing residuals  for the original fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.squared, adj.r.squared</code></td>
<td>
<p>R-squared and adjusted R-squared.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F, p.value</code></td>
<td>
<p>F-statistics and the corresponding p-value, given the <code>df_model</code> and <code>df_residual</code> degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dAIC</code></td>
<td>
<p>Akaike Information Criterion (AIC) difference between the regression model and the null model. A negative values indicates that the regression model is better. See <cite>Nakaya (1997)</cite>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distortion_index</code></td>
<td>
<p>Distortion index following <cite>Waterman and Gordon (1984)</cite>, as adjusted by <cite>Friedman and Kohler (2003)</cite></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm</code></td>
<td>
<p>an underlying linear model for <code>Euclidean</code> and <code>affine</code> transformations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula, describing input and output columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data used to fit the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p>function call information, incorporates the <code>formula</code>, <code>transformation</code>, and <code>data</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>anova.lm2</code> <code>BiDimRegression</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">lm2euc &lt;- lm2(depV1 + depV2 ~ indepV1 + indepV2, NakayaData, 'euclidean')
lm2aff &lt;- lm2(depV1 + depV2 ~ indepV1 + indepV2, NakayaData, 'affine')
lm2prj &lt;- lm2(depV1 + depV2 ~ indepV1 + indepV2, NakayaData, 'projective')
anova(lm2euc, lm2aff, lm2prj)
predict(lm2euc)
summary(lm2euc)
</code></pre>


</div>