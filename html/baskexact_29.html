<div class="container">

<table style="width: 100%;"><tr>
<td>opt_design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimize a Basket Design</h2>

<h3>Description</h3>

<p>Finds the optimal tuning parameters using grid search.
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt_design(design, ...)

## S4 method for signature 'OneStageBasket'
opt_design(
  design,
  n,
  alpha,
  weight_fun,
  weight_params = list(),
  globalweight_fun = NULL,
  globalweight_params = list(),
  scenarios,
  prec_digits,
  ...
)

## S4 method for signature 'TwoStageBasket'
opt_design(
  design,
  n,
  n1,
  alpha,
  interim_fun,
  interim_params = list(),
  weight_fun,
  weight_params = list(),
  globalweight_fun = NULL,
  globalweight_params = list(),
  scenarios,
  prec_digits,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>An object of class <code>Basket</code> created by
<code>setupOneStageBasket</code> or <code>setupTwoStageBasket</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size per basket.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The one-sided signifance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_fun</code></td>
<td>
<p>Which function should be used to calculate the pairwise
weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>weight_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalweight_fun</code></td>
<td>
<p>Which function should be used to calculate the
global weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalweight_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>globalweight_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scenarios</code></td>
<td>
<p>A matrix of response rate scenarios. Each column corresponds
to a scenario and each row corresponds to a basket. A default scenario
matrix can be created with <code>get_scenarios</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec_digits</code></td>
<td>
<p>Number of decimal places that are considered when
adjusting lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>The sample size per basket for the interim analysis in case of a
two-stage design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interim_fun</code></td>
<td>
<p>Which type of interim analysis should be conducted
in case of a two-stage design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interim_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>interim_fun</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>opt_design</code> finds the optimal combination of tuning parameter
values from a the set of tuning paramters that is passed to the function.
The objective function for the optimization is the mean of the expected
number of correct decisions (ECD) under the passed scenarios, with the
constraint that the type 1 error under the global null hypothesis must be
below <code>alpha</code>.
</p>


<h3>Value</h3>

<p>A matrix with the ECDs under all scenarios and the mean ECD for
all combinations of tuning parameter values. The matrix is sorted
decreasingly by the mean ECD.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>opt_design(OneStageBasket)</code>: Optimize a single-stage basket design.
</p>
</li>
<li> <p><code>opt_design(TwoStageBasket)</code>: Optimize a two-stage basket design.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
design &lt;- setupOneStageBasket(k = 3, p0 = 0.2)
opt_design(design = design, n = 10, alpha = 0.05,
  weight_fun = weights_fujikawa, weight_params = list(epsilon = c(1, 2),
  tau = c(0, 0.5)), scenarios = get_scenarios(design, 0.5), prec_digits = 3)

</code></pre>


</div>