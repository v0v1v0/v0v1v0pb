<div class="container">

<table style="width: 100%;"><tr>
<td>waveletcoef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply discrete wavelet transform (DWT) to a 2D GLM coefficient map of a regressor
</h2>

<h3>Description</h3>

<p><code>waveletcoef</code> applies DWT to a 2D GLM coefficient map (e.g., corresponding to a single brain slice) of a regressor for each subject, and returns the wavelet coefficients at all resolution levels. This function wraps around the wavelet transformation function <code>imwd</code> of the <span class="pkg">wavethresh</span> package. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">waveletcoef(n, grid, glmcoefstd, wave.family="DaubLeAsymm", 
  filter.number=6, bc="periodic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of subjects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>The number of voxels in one row (or, one column) of the brain slice of interest. Must be a power of 2. The total number of voxels is <code>grid^2</code>. The maximum value of <code>grid</code> for this package is 512.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glmcoefstd </code></td>
<td>
<p>An array of dimension <code>(n,grid,grid)</code>, containing for each subject the standardized GLM coefficients of a regressor obtained by fitting GLM to the time-series corresponding to the voxels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave.family</code></td>
<td>
<p>The family of wavelets to use - "DaubExPhase" or "DaubLeAsymm". Default is "DaubLeAsymm".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number</code></td>
<td>
<p>The number of vanishing moments of the wavelet. Default is 6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bc</code></td>
<td>
<p>The boundary condition to use - "periodic" or "symmetric". Default is "periodic".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The wavelet decomposition is performed by using the function <code>imwd</code>.</p>


<h3>Value</h3>

<p>A list containing the following.
</p>
<table><tr style="vertical-align: top;">
<td><code>WaveletCoefficientMatrix </code></td>
<td>
<p>A matrix of dimension <code>(n,grid^2-1)</code>, containing for each subject the wavelet coefficients of all levels stacked together (by the increasing order of resolution level). </p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Nilotpal Sanyal, Marco Ferreira
</p>
<p>Maintainer: Nilotpal Sanyal &lt;nilotpal.sanyal@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>imwd</code>, <code>hyperparamest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 3
grid &lt;- 8
ntime &lt;- 10
designmat &lt;- cbind( rep(1,10), c(rep(c(1,0),5)) )
data &lt;- array(dim=c(n,grid,grid,ntime),
  rnorm(n*grid*grid*ntime))
glm.fit &lt;- glmcoef(n,grid,data,designmat)
glmcoefstd &lt;- glm.fit$GLMCoefStandardized[,,,1]
wavecoef &lt;- waveletcoef(n,grid,glmcoefstd)
dim(wavecoef$WaveletCoefficientMatrix)
#[1]  3 63
</code></pre>


</div>