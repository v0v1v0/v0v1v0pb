<div class="container">

<table style="width: 100%;"><tr>
<td>combatbaaddon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Addon batch effect adjustment using ComBat
</h2>

<h3>Description</h3>

<p>Performs addon batch effect adjustment using ComBat. Takes the output of performing <code>combatba</code> on a training data set and new batch data and correspondingly adjusts the test data to better match the adjusted training data according to the ComBat model
</p>


<h3>Usage</h3>

<pre><code class="language-R">combatbaaddon(params, x, batch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>

<p>object of class <code>combat</code>. Contains parameters necessary for addon batch effect adjustment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>matrix. The covariate matrix of the new data. Observations in rows, variables in columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>

<p>factor. Batch variable of the new data. Currently has to have levels: '1', '2', '3' and so on.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The adjusted covariate matrix of the test data.
</p>


<h3>Note</h3>

<p>The original ComBat-code is used in <code>combatbaaddon</code>: 
<a href="http://www.bu.edu/jlab/wp-assets/ComBat/Download.html">http://www.bu.edu/jlab/wp-assets/ComBat/Download.html</a> (Access date: 2015/06/19)
</p>


<h3>Author(s)</h3>

<p>Roman Hornung
</p>


<h3>References</h3>

<p>Johnson, W. E., Rabinovic, A., Li, C. (2007). Adjusting batch effects in microarray expression data using empirical bayes methods. Biostatistics 8:118-127, &lt;doi: <a href="https://doi.org/10.1093/biostatistics/kxj037">10.1093/biostatistics/kxj037</a>&gt;.
</p>
<p>Luo, J., Schumacher, M., Scherer, A., Sanoudou, D., Megherbi, D., Davison, T., Shi, T., Tong, W., Shi, L., Hong, H., Zhao, C., Elloumi, F., Shi, W., Thomas, R., Lin, S., Tillinghast, G., Liu, G., Zhou, Y., Herman, D., Li, Y., Deng, Y., Fang, H., Bushel, P., Woods, M., Zhang, J. (2010). A comparison of batch effect removal methods for enhancement of prediction performance using maqc-ii microarray gene expression data. The Pharmacogenomics Journal 10:278-291, &lt;doi: <a href="https://doi.org/10.1038/tpj.2010.57">10.1038/tpj.2010.57</a>&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(autism)

trainind &lt;- which(batch %in% c(1,2))

Xtrain &lt;- X[trainind,]
ytrain &lt;- y[trainind]
batchtrain &lt;- factor(as.numeric(batch[trainind]), levels=c(1,2))


testind &lt;- which(batch %in% c(3,4))

Xtest &lt;- X[testind,]
ytest &lt;- y[testind]

batchtest &lt;- as.numeric(batch[testind])
batchtest[batchtest==3] &lt;- 1
batchtest[batchtest==4] &lt;- 2
batchtest &lt;- factor(batchtest, levels=c(1,2))


params &lt;- combatba(x=Xtrain, batch=batchtrain)

Xtestaddon &lt;- combatbaaddon(params, x=Xtest, batch=batchtest)
</code></pre>


</div>