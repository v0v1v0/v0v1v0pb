<div class="container">

<table style="width: 100%;"><tr>
<td>osdsm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract backbone using the Ordinal Stochastic Degree Sequence Model</h2>

<h3>Description</h3>

<p><code>osdsm</code> extracts the backbone of a bipartite projection using the Ordinal Stochastic Degree Sequence Model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">osdsm(
  B,
  alpha = 0.05,
  trials = NULL,
  missing.as.zero = FALSE,
  signed = FALSE,
  mtc = "none",
  class = "original",
  narrative = FALSE,
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An ordinally weighted bipartite graph, as: (1) an incidence matrix in the form of a matrix or sparse <code>Matrix</code>; (2) an edgelist in the form of a three-column dataframe; (3) an <code>igraph</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>real: significance level of hypothesis test(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>integer: the number of bipartite graphs generated to approximate the edge weight distribution. If NULL, the number of trials is selected based on <code>alpha</code> (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.as.zero</code></td>
<td>
<p>boolean: should missing edges be treated as edges with zero weight and tested for significance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signed</code></td>
<td>
<p>boolean: TRUE for a signed backbone, FALSE for a binary backbone (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtc</code></td>
<td>
<p>string: type of Multiple Test Correction to be applied; can be any method allowed by <code>p.adjust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>string: the class of the returned backbone graph, one of c("original", "matrix", "Matrix", "igraph", "edgelist").
If "original", the backbone graph returned is of the same class as <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>narrative</code></td>
<td>
<p>boolean: TRUE if suggested text &amp; citations should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>boolean: TRUE if the progress of Monte Carlo trials should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>osdsm</code> function compares an edge's observed weight in the projection <code>B*t(B)</code> to the distribution of weights
expected in a projection obtained from a random bipartite network where both the rows and the columns contain
approximately the same number of each value. The edges in <code>B</code> must be integers, and are assumed to represent an
ordinal-level measure such as a Likert scale that starts at 0.
</p>
<p>When <code>signed = FALSE</code>, a one-tailed test (is the weight stronger?) is performed for each edge. The resulting backbone
contains edges whose weights are significantly <em>stronger</em> than expected in the null model. When <code>signed = TRUE</code>, a
two-tailed test (is the weight stronger or weaker?) is performed for each edge. The resulting backbone contains
positive edges for those whose weights are significantly <em>stronger</em>, and negative edges for those whose weights are
significantly <em>weaker</em>, than expected in the null model.
</p>
<p>The p-values used to evaluate the statistical significance of each edge are computed using Monte Carlo methods. The number of
<code>trials</code> performed affects the precision of these p-values. This precision impacts the confidence that a given edge's p-value
is less than the desired <code>alpha</code> level, and therefore represents a statistically significant edge that should be retained in
the backbone. When <code>trials = NULL</code>, <code>trials.needed()</code> is used to estimate the required number of trials to evaluate the
statistical significance of an edges' p-values.
</p>


<h3>Value</h3>

<p>If <code>alpha</code> != NULL: Binary or signed backbone graph of class <code>class</code>.
</p>
<p>If <code>alpha</code> == NULL: An S3 backbone object containing (1) the weighted graph as a matrix, (2) upper-tail p-values as a
matrix, (3, if <code>signed = TRUE</code>) lower-tail p-values as a matrix, (4, if present) node attributes as a dataframe, and
(5) several properties of the original graph and backbone model, from which a backbone can subsequently be extracted
using <code>backbone.extract()</code>.
</p>


<h3>References</h3>

<p>package: Neal, Z. P. (2022). backbone: An R Package to Extract Network Backbones. <em>PLOS ONE, 17</em>, e0269137. <a href="https://doi.org/10.1371/journal.pone.0269137">doi:10.1371/journal.pone.0269137</a>
</p>
<p>osdsm: Neal, Z. P. (2017). Well connected compared to what? Rethinking frames of reference in world city network research. <em>Environment and Planning A, 49</em>, 2859-2877. <a href="https://doi.org/10.1177/0308518X16631339">doi:10.1177/0308518X16631339</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#A weighted binary bipartite network of 20 agents &amp; 50 artifacts; agents form two communities
B &lt;- rbind(cbind(matrix(sample(0:3, 250, replace = TRUE, prob = ((1:4)^2)),10),
                 matrix(sample(0:3, 250, replace = TRUE, prob = ((4:1)^2)),10)),
           cbind(matrix(sample(0:3, 250, replace = TRUE, prob = ((4:1)^2)),10),
                 matrix(sample(0:3, 250, replace = TRUE, prob = ((1:4)^2)),10)))

P &lt;- B%*%t(B) #An ordinary weighted projection...
plot(igraph::graph_from_adjacency_matrix(P, mode = "undirected",
                                         weighted = TRUE, diag = FALSE)) #...is a dense hairball

bb &lt;- osdsm(B, alpha = 0.05, narrative = TRUE,  #An oSDSM backbone...
            class = "igraph", trials = 100)
plot(bb) #...is sparse with clear communities
</code></pre>


</div>