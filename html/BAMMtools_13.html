<div class="container">

<table style="width: 100%;"><tr>
<td>dtRates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate macroevolutionary rate changes on a phylogeny from
<code>BAMM</code> output</h2>

<h3>Description</h3>

<p><code>dtRates</code> calculates the mean of the marginal posterior
density of the rate of speciation/extinction or trait evolution for
small segments along each branch in a phylogeny.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dtRates(ephy, tau, ism = NULL, tmat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A numeric that specifies the size (as a fraction of tree
height) of the segments that each branch will be discretized into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ism</code></td>
<td>
<p>An integer vector indexing which posterior samples to include
in the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmat</code></td>
<td>
<p>A logical. If <code>TRUE</code> the matrix of branch segments is
returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dtRates</code> bins the phylogeny into windows of time and
calculates average rates of speciation/extinction or phenotypic
evolution along each segment of a branch within a window. The width of
each window is determined by <code>tau</code>. <code>tau</code> is a fraction of
the root to tip distance so a value of <code>tau = 0.01</code> bins the
phylogeny into 100 time windows of equal width.
</p>


<h3>Value</h3>

<p>A <code>bammdata</code> object with a new component named "dtrates", which
is a list with two or three components:
</p>

<ul>
<li>
<p> tau: The parameter value of <code>tau</code> used in the
calculation.
</p>
</li>
<li>
<p> rates: If <code>ephy$type = "trait"</code>: a numeric vector with
the phenotypic rates of each segment on each branch. If
<code>ephy$type = "diversification"</code>: a list with two
components. The first component is a numeric vector of
speciation rates. The second component is a numeric vector of
extinction rates.
</p>
</li>
<li>
<p> tmat: A matrix of the starting and ending times of the
segments on each branch. Only if <code>tmat = TRUE</code>.
</p>
</li>
</ul>
<h3>Note</h3>

<p>If there are zero length branches in the input tree <code>NA</code>s will
result.
</p>


<h3>Author(s)</h3>

<p>Mike Grundler
</p>


<h3>References</h3>

<p><a href="http://bamm-project.org/">http://bamm-project.org/</a>
</p>


<h3>See Also</h3>

<p><code>plot.bammdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.25, nsamples=500)

# use all posterior samples
ed &lt;- dtRates(ed, tau=0.01)

# use specified range of posterior samples
ed &lt;- dtRates(ed, tau=0.01, ism=50:150)
</code></pre>


</div>