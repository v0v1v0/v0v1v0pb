<div class="container">

<table style="width: 100%;"><tr>
<td>BRISC_neighbor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for finding set of nearest neighbors for BRISC</h2>

<h3>Description</h3>

<p>The function <code>BRISC_neighbor</code> creates the set of nearest neighbors for a given set of coordinates, which can be used as an input
for <code>"neighbor"</code> argument in <code>BRISC_estimation</code>. This is especially useful for avoiding often computationally
intensive nearest neighbor finding scheme in case of multiple application of <code>BRISC_estimation</code> on a fixed set of
coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BRISC_neighbor(coords, n.neighbors = 15, n_omp = 1,
               order = "Sum_coords", search.type = "tree",
               verbose = TRUE, ordering = NULL, tol = 12
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an <code class="reqn">n \times 2</code> matrix of the observation
coordinates in <code class="reqn">R^2</code> (e.g., easting and northing). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.neighbors</code></td>
<td>
<p>number of neighbors used in the NNGP. Default value is 15. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_omp</code></td>
<td>
<p>number of threads to be used, value can be more than 1 if source code is compiled with OpenMP support.
Default is 1. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>keyword that specifies the ordering scheme to be used in ordering the observations. Supported keywords are:
<code>"AMMD"</code> and <code>"Sum_coords"</code> for approximate Maximum Minimum Distance and sum of coordinate based ordering,
respectively. Default value is <code>"Sum_coords"</code>. <code class="reqn">n &gt; 65</code> is required for <code>"AMMD"</code>. Ignored, if <code>ordering</code> in not <code>NULL</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search.type</code></td>
<td>
<p>keyword that specifies type of nearest neighbor search algorithm to be used. Supported keywords are:
<code>"brute"</code>, <code>"tree"</code> and <code>"cb"</code>. <br><code>"brute"</code> and <code>"tree"</code> provide the same result, though
<code>"tree"</code> should be faster. <code>"cb"</code> implements fast code book search described in Ra and Kim (1993)
modified for NNGP. If locations do not have identical coordinate values on the axis used for the nearest neighbor
ordering (see <code>order</code> argument) then <code>"cb"</code> and <code>"brute"</code> should produce identical neighbor sets.
However, if there are identical coordinate values on the axis used for nearest neighbor ordering, then <code>"cb"</code>
and <code>"brute"</code> might produce different, but equally valid, neighbor sets, e.g., if data are on a grid.
Default value is <code>"tree"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, information regarding OpenMP support and progress of the algorithm
is printed to the screen. Otherwise, nothing is printed to the screen. Default value is <code>TRUE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordering</code></td>
<td>
<p>if not <code>NULL</code>, denotes the <code class="reqn">n</code> length integer vector of ordering of the input coordinates and is used as the ordering of the coordinates for determination of the set of nearest neighbors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the input observation coordinates, response and the covariates are rounded to this many places after the decimal. The default value is 12. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing information regarding nearest neighbors which can be used as an input
for <code>"neighbor"</code> argument in <code>BRISC_estimation</code>.
</p>


<h3>Author(s)</h3>

<p>Arkajyoti Saha <a href="mailto:arkajyotisaha93@gmail.com">arkajyotisaha93@gmail.com</a>, <br>
Abhirup Datta <a href="mailto:abhidatta@jhu.edu">abhidatta@jhu.edu</a>
</p>


<h3>References</h3>

<p>Saha, A., &amp; Datta, A. (2018). BRISC: bootstrap for rapid inference on spatial
covariances. Stat, e184, DOI: 10.1002/sta4.184.
</p>
<p>Datta, A., S. Banerjee, A.O. Finley, and A.E. Gelfand. (2016)
Hierarchical Nearest-Neighbor Gaussian process models for large
geostatistical datasets. Journal of the American Statistical
Association, 111:800-812.
</p>
<p>Guinness, J. (2018) Permutation and Grouping Methods for
Sharpening Gaussian Process Approximations, Technometrics,
DOI: 10.1080/00401706.2018.1437476, <br>
https://github.com/joeguinness/gp_reorder/tree/master/R .
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1)
n &lt;- 1000
coords &lt;- cbind(runif(n,0,1), runif(n,0,1))


neighbor_result &lt;- BRISC_neighbor(coords)
</code></pre>


</div>