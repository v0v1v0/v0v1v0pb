<div class="container">

<table style="width: 100%;"><tr>
<td>aerodynamic.conductance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Aerodynamic Conductance</h2>

<h3>Description</h3>

<p>Bulk aerodynamic conductance, including options for the boundary layer conductance
formulation and stability correction functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aerodynamic.conductance(
  data,
  Tair = "Tair",
  pressure = "pressure",
  wind = "wind",
  ustar = "ustar",
  H = "H",
  zr,
  zh,
  d,
  z0m = NULL,
  Dl,
  N = 2,
  fc = NULL,
  LAI,
  Cd = 0.2,
  hs = 0.01,
  wind_profile = FALSE,
  stab_correction = TRUE,
  stab_formulation = c("Dyer_1970", "Businger_1971"),
  Rb_model = c("Thom_1972", "Choudhury_1988", "Su_2001", "constant_kB-1"),
  kB_h = NULL,
  Sc = NULL,
  Sc_name = NULL,
  constants = bigleaf.constants()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame or matrix containing all required variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tair</code></td>
<td>
<p>Air temperature (deg C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pressure</code></td>
<td>
<p>Atmospheric pressure (kPa)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind</code></td>
<td>
<p>Wind speed (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ustar</code></td>
<td>
<p>Friction velocity (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Sensible heat flux (W m-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zr</code></td>
<td>
<p>Instrument (reference) height (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zh</code></td>
<td>
<p>Canopy height (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Zero-plane displacement height (m)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0m</code></td>
<td>
<p>Roughness length for momentum (m), optional; if not provided, it is estimated from <code>roughness.parameters</code>
(method="wind_profile"). Only used if <code>wind_profile = TRUE</code> and/or <code>Rb_model</code> = <code>"Su_2001"</code> or
<code>"Choudhury_1988"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dl</code></td>
<td>
<p>Characteristic leaf dimension (m) (if <code>Rb_model</code> = <code>"Su_2001"</code>) 
or leaf width (if <code>Rb_model</code> = <code>"Choudhury_1988"</code>); ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of leaf sides participating in heat exchange (1 or 2); only used if <code>Rb_model = "Su_2001"</code>.
Defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fc</code></td>
<td>
<p>Fractional vegetation cover (-); only used if <code>Rb_model = "Su_2001"</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAI</code></td>
<td>
<p>One-sided leaf area index (m2 m-2); only used if <code>Rb_model</code> = <code>"Choudhury_1988"</code> or <code>"Su_2001"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cd</code></td>
<td>
<p>Foliage drag coefficient (-); only used if <code>Rb_model = "Su_2001"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>Roughness length of bare soil (m); only used if <code>Rb_model = "Su_2001"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind_profile</code></td>
<td>
<p>Should Ga for momentum be calculated based on the logarithmic wind profile equation? 
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stab_correction</code></td>
<td>
<p>Should stability correction be applied? Defaults to <code>TRUE</code>. Ignored if <code>wind_profile = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stab_formulation</code></td>
<td>
<p>Stability correction function. Either <code>"Dyer_1970"</code> (default) or
<code>"Businger_1971"</code>. Ignored if <code>wind_profile = FALSE</code> or if <code>stab_correction = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb_model</code></td>
<td>
<p>Boundary layer resistance formulation. One of <code>"Thom_1972","Choudhury_1988","Su_2001","constant_kB-1"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kB_h</code></td>
<td>
<p>kB-1 value for heat transfer; only used if <code>Rb_model = "constant_kB-1"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sc</code></td>
<td>
<p>Optional: Schmidt number of additional quantities to be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sc_name</code></td>
<td>
<p>Optional: Name of the additional quantities, has to be of same length than 
<code>Sc_name</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constants</code></td>
<td>
<p>k - von Karman constant <br>
cp - specific heat of air for constant pressure (J K-1 kg-1) <br>
Kelvin - conversion degree Celsius to Kelvin <br>
g - gravitational acceleration (m s-2) <br>
pressure0 - reference atmospheric pressure at sea level (Pa) <br>
Tair0 - reference air temperature (K) <br>
Sc_CO2 - Schmidt number for CO2 <br> 
Pr - Prandtl number (if <code>Sc</code> is provided)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Aerodynamic conductance for heat (Ga_h) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">Ga_h = 1 / (Ra_m + Rb_h)</code>
</p>

<p>where Ra_m is the aerodynamic resistance for momentum and Rb the (quasi-laminar) canopy boundary
layer resistance ('excess resistance').
</p>
<p>The aerodynamic resistance for momentum Ra_m is given by:
</p>
<p style="text-align: center;"><code class="reqn">Ra_m = u/ustar^2</code>
</p>

<p>Note that this formulation accounts for changes in atmospheric stability, and does not require an
additional stability correction function. 
</p>
<p>An alternative method to calculate Ra_m is provided
(calculated if <code>wind_profile = TRUE</code>):
</p>
<p style="text-align: center;"><code class="reqn">Ra_m = (ln((zr - d)/z0m) - psi_h) / (k ustar)</code>
</p>

<p>If the roughness parameters z0m and d are unknown, they can be estimated using
<code>roughness.parameters</code>. The argument <code>stab_formulation</code> determines the stability correction function used 
to account for the effect of atmospheric stability on Ra_m (Ra_m is lower for unstable
and higher for stable stratification). Stratification is based on a stability parameter zeta (z-d/L),
where z = reference height, d the zero-plane displacement height, and L the Monin-Obukhov length, 
calculated with <code>Monin.Obukhov.length</code>
The stability correction function is chosen by the argument <code>stab_formulation</code>. Options are 
<code>"Dyer_1970"</code> and <code>"Businger_1971"</code>.
</p>
<p>The model used to determine the canopy boundary layer resistance for heat (Rb_h) is specified by 
the argument <code>Rb_model</code>. The following options are implemented:
<code>"Thom_1972"</code> is an empirical formulation based on the friction velocity (ustar) (Thom 1972):
</p>
<p style="text-align: center;"><code class="reqn">Rb_h = 6.2ustar^-0.667</code>
</p>

<p>The model by Choudhury &amp; Monteith 1988 (<code>Rb_model = "Choudhury_1988"</code>),
calculates Rb_h based on leaf width, LAI and ustar (Note that function argument <code>Dl</code>
represents leaf width (w) and not characteristic leaf dimension (Dl)
if <code>Rb_model</code> = <code>"Choudhury_1988"</code>):
</p>
<p style="text-align: center;"><code class="reqn">Gb_h = LAI((0.02/\alpha)*sqrt(u(zh)/w)*(1-exp(-\alpha/2)))</code>
</p>

<p>where <code class="reqn">\alpha</code> is a canopy attenuation coefficient modeled in dependence on LAI,
u(zh) is wind speed at canopy height (calculated from <code>wind.profile</code>),
and w is leaf width (m). See <code>Gb.Choudhury</code> for further details.
</p>
<p>The option <code>Rb_model = "Su_2001"</code> calculates Rb_h based on the physically-based Rb model by Su et al. 2001,
a simplification of the model developed by Massman 1999:
</p>
<p style="text-align: center;"><code class="reqn">kB_h = (k Cd fc^2) / (4Ct ustar/u(zh)) + kBs-1(1 - fc)^2</code>
</p>

<p>where Cd is a foliage drag coefficient (defaults to 0.2), fc is fractional
vegetation cover, Bs-1 is the inverse Stanton number for bare soil surface,
and Ct is a heat transfer coefficient. See <code>Gb.Su</code> for 
details on the model.
</p>
<p>The models calculate the parameter kB^(-1) (in the code referred to as <code>kB_h</code>), 
which is related to Rb_h:
</p>
<p style="text-align: center;"><code class="reqn">kB_h = Rb_h * (k * ustar)</code>
</p>

<p>From version 0.7.6 onwards, the roughness length for heat (z0h) is added to the output
if z0m is available (i.e. provided as input or calculated within this function).
z0h is calculated from <code>roughness.length.heat</code>:
</p>
<p style="text-align: center;"><code class="reqn">z0h = z0m / exp(kB_h)</code>
</p>

<p>Rb (and Gb) for water vapor and heat are assumed to be equal in this package.
Gb for other quantities x is calculated as (Hicks et al. 1987):
</p>
<p style="text-align: center;"><code class="reqn">Gb_x = Gb / (Sc_x / Pr)^0.67</code>
</p>

<p>where Sc_x is the Schmidt number of quantity x, and Pr is the Prandtl number (0.71).
</p>


<h3>Value</h3>

<p>a data.frame with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Ga_m</code></td>
<td>
<p>Aerodynamic conductance for momentum transfer (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ra_m</code></td>
<td>
<p>Aerodynamic resistance for momentum transfer (s m-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ga_h</code></td>
<td>
<p>Aerodynamic conductance for heat transfer (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ra_h</code></td>
<td>
<p>Aerodynamic resistance for heat transfer (s m-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gb_h</code></td>
<td>
<p>Canopy boundary layer conductance for heat transfer (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb_h</code></td>
<td>
<p>Canopy boundary layer resistance for heat transfer (s m-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kB_h</code></td>
<td>
<p>kB^(-1) parameter for heat transfer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0h</code></td>
<td>
<p>Roughness length for heat (m) (NA if not input <code>z0m</code> not provided as input
or not estimated in this function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>Stability parameter 'zeta' (NA if <code>wind_profile = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi_h</code></td>
<td>
<p>Integrated stability correction function (NA if <code>wind_profile = FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ra_CO2</code></td>
<td>
<p>Aerodynamic resistance for CO2 transfer (s m-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ga_CO2</code></td>
<td>
<p>Aerodynamic conductance for CO2 transfer (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gb_CO2</code></td>
<td>
<p>Canopy boundary layer conductance for CO2 transfer (m s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ga_Sc_name</code></td>
<td>
<p>Aerodynamic conductance for <code>Sc_name</code> (m s-1). Only added if <code>Sc_name</code> and 
the respective <code>Sc</code> are provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gb_Sc_name</code></td>
<td>
<p>Boundary layer conductance for <code>Sc_name</code> (m s-1). Only added if <code>Sc_name</code> and 
the respective <code>Sc</code> are provided</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Input variables such as LAI, Dl, or zh can be either constants, or
vary with time (i.e. vectors of the same length as <code>data</code>).
</p>
<p>Note that boundary layer conductance to water vapor transfer (Gb_w) is often 
assumed to equal Gb_h. This assumption is also made in this R package, for 
example in the function <code>surface.conductance</code>.
</p>
<p>If the roughness length for momentum (<code>z0m</code>) is not provided as input, it is estimated 
from the function <code>roughness.parameters</code> within <code>wind.profile</code> if <code>wind_profile = TRUE</code> 
and/or <code>Rb_model</code> = <code>"Su_2001"</code> or <code>"Choudhury_1988"</code> The <code>roughness.parameters</code>
function estimates a single <code>z0m</code> value for the entire time period! If a varying <code>z0m</code> value 
(e.g. across seasons or years) is required, <code>z0m</code> should be provided as input argument.
</p>


<h3>References</h3>

<p>Verma, S., 1989: Aerodynamic resistances to transfers of heat, mass and momentum.
In: Estimation of areal evapotranspiration, IAHS Pub, 177, 13-20.
</p>
<p>Verhoef, A., De Bruin, H., Van Den Hurk, B., 1997: Some practical notes on the parameter kB-1
for sparse vegetation. Journal of Applied Meteorology, 36, 560-572.
</p>
<p>Hicks, B.B., Baldocchi, D.D., Meyers, T.P., Hosker, J.R., Matt, D.R., 1987:
A preliminary multiple resistance routine for deriving dry deposition velocities
from measured quantities. Water, Air, and Soil Pollution 36, 311-330.
</p>
<p>Monteith, J.L., Unsworth, M.H., 2008: Principles of environmental physics.
Third Edition. Elsevier Academic Press, Burlington, USA.
</p>


<h3>See Also</h3>

<p><code>Gb.Thom</code>, <code>Gb.Choudhury</code>, <code>Gb.Su</code> for calculations of Rb / Gb only
</p>


<h3>Examples</h3>

<pre><code class="language-R">df &lt;- data.frame(Tair=25,pressure=100,wind=c(3,4,5),ustar=c(0.5,0.6,0.65),H=c(200,230,250))   
 
# simple calculation of Ga  
aerodynamic.conductance(df,Rb_model="Thom_1972") 

# calculation of Ga using a model derived from the logarithmic wind profile
aerodynamic.conductance(df,Rb_model="Thom_1972",zr=40,zh=25,d=17.5,z0m=2,wind_profile=TRUE) 

# simple calculation of Ga_m, but a physically based canopy boundary layer model
aerodynamic.conductance(df,Rb_model="Su_2001",zr=40,zh=25,d=17.5,Dl=0.05,N=2,fc=0.8)

</code></pre>


</div>