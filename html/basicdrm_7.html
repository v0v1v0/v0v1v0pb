<div class="container">

<table style="width: 100%;"><tr>
<td>findBestHillModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Selects a best-fitting Hill model given defaults</h2>

<h3>Description</h3>

<p>Using the function <code>fitHillModel()</code>, this function fits four Hill models
with minimal and maximal effects either varying or fixed at the given
default values; it then selects the best fitting model based on the Bayesian
information criterio or Akaike information criterion, and returns a Hill fit
object with information from all fits included.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findBestHillModel(
  formula,
  data,
  defaults,
  weights = NULL,
  start = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL,
  useBIC = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Either an object of class <code>formula</code> such as would be provided
to a modeling function like <code>lm()</code>, or a numeric vector of concentration
values (including 0 or Inf)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If <code>forumula</code> is a symbolic formula, a data frame containing the
specified values. If <code>formula</code> is a numeric vector of concentrations, a
numeric vector of response values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defaults</code></td>
<td>
<p>A two value numeric vector containing the default minimal
effect and the default maximal effect, in that order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of weights (between 0 and 1) the same length as
<code>conc</code> and <code>act</code> which determines the weight with which each measurement
will impact the the sum of squared errors.  Weights will be multiplied by
errors <em>before</em> squaring.  If <code>NULL</code> (the default) all weights will be set
to 1. Can be a numeric vector, or the name of a column in <code>data</code> if <code>formula</code>
is a symbolic formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A vector of four starting values for the Hill model to be fit.
Any values not being fit will be fixed at these starting values.  If left as
<code>NULL</code>, a starting vector will be estimated from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>Determines the possible directionality of the dose response
model.  If 0 (the default) no additional constraints are placed on the
parameters.  If greater than 0, the fitting will require that the maximal
effect is <em>greater</em> than the minimal effect.  If less than 0, the fitting
wll require tha the maximal effect is <em>less</em> than the minimal effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A length-four vector of lower bounds on the Hill parameter
values.  Any parameters for which you do not wish to specify a bound can be
set to <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A vector of upper bounds on the Hill parameter values.  Works
the same as parameter <code>lower</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useBIC</code></td>
<td>
<p>Determines the information criterion to be used.  If <code>TRUE</code>
(the default), uses the Bayesian information criterion.  If <code>FALSE</code>, uses
the Akaike information criterion</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>hillrm</code>.  Contains all of the values found in
any <code>hillrm</code> object (see <code>fitHillModel()</code>), as well as <code>allfits</code>, a named
list of lists containing the <code>coefficients</code> and <code>par</code>vectors for each of the
individual fits, as well as the Bayesian information criterion (<code>bic</code>) and
Akaike informtion criterion (<code>aic</code>) values for each fit.
</p>


<h3>Examples</h3>

<pre><code class="language-R">conc &lt;- c(0,2^(-6:3),Inf)
hpar &lt;- c(1,3,0,75)
response &lt;- evalHillModel(conc, hpar) + rnorm(length(conc),sd=7.5)

hfit &lt;- findBestHillModel(conc,response,defaults=c(0,100))
</code></pre>


</div>