<div class="container">

<table style="width: 100%;"><tr>
<td>lnorm3_PCC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PCC for LogNormal data with both parameters unknown</h2>

<h3>Description</h3>

<p>lnorm3_PCC is used to derive the Predictive Control Chart (PCC) for LogNormal data, when both the scale and the shape parameters are unknown.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lnorm3_PCC(data = NULL, historical_data = NULL,
           mu0 = 0, l0 = 0, a0 = -1/2, b0 = 0, alpha_0 = NULL,
           ARL_0 = 370.4, FAP = NULL, FIR = FALSE, fFIR = .99, aFIR = 1/8,
           summary_list = TRUE, PCC_PLOT = TRUE, PriorPosterior_PLOT = FALSE,
           historical_data_PLOT = FALSE, pdf_report = FALSE, path_pdf_report = tempdir(),
           xlab = "Observation Order", ylab = "Quality characteristic Values",
           main = "PCC LogNormal with unknown parameters")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> vector; a univariate dataset for PCC implementation. Data needs to be in a vector form.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>historical_data</code></td>
<td>
<p>vector; an optional univariate dataset of historical data. Historical data needs to be in a vector form.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p> scalar; hyperparameter of the prior NIG(mu0, l0, a0, b0). It needs to be a number. The default is 0 and it refers to the initial reference prior NIG(0, 0, -1/2, 0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l0</code></td>
<td>
<p> scalar (positive); hyperparameter of the prior NIG(mu0, l0, a0, b0). It needs to be a number. The default is 0 and it refers to the initial reference prior NIG(0, 0, -1/2, 0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p> scalar (positive); hyperparameter of the prior NIG(mu0, l0, a0, b0). It needs to be a number. The default is -1/2 and it refers to the initial reference prior NIG(0, 0, -1/2, 0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p> scalar (positive); hyperparameter of the prior NIG(mu0, l0, a0, b0). It needs to be a number. The default is 0 and it refers to the initial reference prior NIG(0, 0, -1/2, 0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_0</code></td>
<td>
<p> scalar (non negative); It is a power prior parameter controlling the influence of the historical data on the posterior distribution. The default is 1/n_0, where n_0 is the size of the historical data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARL_0</code></td>
<td>
<p>scalar (positive); In Control (IC) Average Run Length (ARL). It is average number of IC data points that we will plot in the PCC before a false alarm occurs. The default value is 370.4
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FAP</code></td>
<td>
<p>scalar (between 0 and 1); False Alarm Probability (FAP). It is the probability of raising at least one false alarm out of a pre-determined number of N hypothesis tests and it can be used instead of ARL_0. It is based on the Sidak's correction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FIR</code></td>
<td>
<p>logical; If TRUE, then the Fast Initial Response (FIR) PCC is applied, which is an adjustment (narrows the PCC limits) for the initial fisrt tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fFIR</code></td>
<td>
<p>a number between 0 and 1; It is used if FIR=TRUE. The default value is 0.99 and represents the proportion of the adjusted PCC region over the initial one for the first test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aFIR</code></td>
<td>
<p>non-negative number; It is used if FIR=TRUE. The default value is 0.125 and it is a smoothing parameter for the FIR adjustment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary_list</code></td>
<td>
<p>logical; If it is TRUE, then a data frame is provided, containing the data sequence, the PCC limits along with the possible occurence of an alarm. It is TRUE by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCC_PLOT</code></td>
<td>
<p>logical; if TRUE, the PCC plot is displayed. It is TRUE by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PriorPosterior_PLOT</code></td>
<td>
<p> logical; if TRUE, the Prior and Posterior distribution(s) of the parameter(s) are displayed. It is TRUE by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>historical_data_PLOT</code></td>
<td>
<p>logical; if TRUE, the historical data are plotted precending the PCC plot. It is FALSE by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf_report</code></td>
<td>
<p>logical; if TRUE then the summary list, PCC plot and Prior/Posterior distribution(s) of the parameter(s) are reported in a pdf file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path_pdf_report</code></td>
<td>
<p>specified path to save pdf report if pdf_report=TRUE. The default path is the temporary direction tempdir().
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, main</code></td>
<td>
<p>The titles of the x-axis, y-axis and the overall title for the PCC plot. The default values are "Observation Order", "Quality characteristic Values" and "PCC LogNormal with unknown parameters" respectively.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>lnorm3_PCC provides the Predictive Control Chart (PCC) process for LogNormal data, when both the scale and the shape parameters are unknown. The PCC process is based on the sequential testing of the future observable against the Highest Predictive Density (HPrD), which is obtained by the posterior predictive distribution. The PCC testing starts as early as the second observation.
</p>
<p>The joint initial prior for the unknown parameters is a Normal Inverse Gamma: NIG(mu0, l0, a0, b0). Furthermore, the direct use of available historical data is possible via the power prior, if they are available. In this case, the default value for the power prior parameter alpha_0 is the reciprocal of the length of the historical data, which conveys the weight of a single observation to the prior information. The default prior is the non-informative reference prior NIG(0, 0, -1/2, 0), without the use of historical data. In this special case, the PCC testing starts at the third observation.
</p>
<p>A FIR option is available by narrowing the first few control limits. The metrics that can be used to control the false alarms tolerance are either ARL_0 or FAP.
</p>


<h3>Value</h3>

<p>Runs the PCC process, while if FIR=T, then the FIR-PCC is implemented. If plot=T, then a data frame is provided with the data, the upper and the lower limits of the Highest Predictive Density or Mass (HPrD/M) region, and an indication in case of alarms. If PCC_PLOT=T, then the PCC process is visualized, while if historical_data_PLOT=T, the historical data are added to the plot. If PriorPosterior_PLOT = T, a plot with the prior and the posterior is provided. Finally, if pdf_report=T, all the output is reported and saved into a pdf file.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 30 LogNormal observations introducing an outlier at the 15th observation
ssddll &lt;- 1/2
set.seed(9)
SimData &lt;- rlnorm( n = 30, meanlog = 0, sdlog = ssddll)
SimData[15] &lt;- SimData[15] + 3*sqrt( exp(ssddll^2)*( exp(ssddll^2)-1 ) )
plot(SimData)
lnorm3_PCC(SimData)
</code></pre>


</div>