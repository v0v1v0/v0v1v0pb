<div class="container">

<table style="width: 100%;"><tr>
<td>boxclip</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Boxfilter Main Function
</h2>

<h3>Description</h3>

<p>Filters noise from data (e.g. heartrates) using x for x-axis data and y for y-axis, based on the proportion of neighbors of each point in a surrounding box of width and height (these may be determined automatically). It discards all data points that have less than a proportion of clipit neighbors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boxclip (x=NULL,y,clipit=NULL,QI=NULL,width=NULL, height=NULL,
miny=min(y,na.rm=TRUE), maxy=max(y,na.rm=TRUE), plotit=TRUE, histo=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The x-axis of data, a datetime for example. Optional. If x=NULL x&lt;-1:length(y) will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>The y-axis of data, probably noisy. Required.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clipit</code></td>
<td>

<p>Optional. Y-values with less than a proportion of clipit neighbors will be discarded.
If clipit is omitted it is set equal to the first trough in the neighbor proportion histogram.
</p>
</td>
</tr>
</table>
<p>ci
</p>
<table>
<tr style="vertical-align: top;">
<td><code>QI</code></td>
<td>

<p>Optional. An integer quality index for each data point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>

<p>Optional. The width of the box. If width is omitted it will be generated from floor(length(x)*0.01).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>

<p>Optional. The height of the box. If height is omitted it will be generated from floor(mean(y,na.rm=T)/4).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miny</code></td>
<td>

<p>The minimum y-value expected. Anything below miny is discarded.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxy</code></td>
<td>

<p>The maximum y-value expected. Anything above maxy is discarded.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>

<p>Optional.If TRUE show a graph of the original and filtered data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histo</code></td>
<td>

<p>Optional. If TRUE also show a histogram of the neighboring points.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Boxfilter mimics the human criterion of self-similarity.
Data points with many neighbors are more trustworthy.
</p>


<h3>Value</h3>


<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Original x-axis data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Original y-axis data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filtered</code></td>
<td>
<p>Filtered data. Discarded data points are set to NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighbors</code></td>
<td>
<p>Proportion of neighbors of each point.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>To store only filtered data, use e.g.:
</p>
<p>bc=boxclip (x,y)
data=data.frame(x=bc$x, hrf=bc$filtered)
data=na.omit(data)
write.csv(data,file="myheartrates.csv")
</p>


<h3>Author(s)</h3>

<p>Thomas Ruf (thomas.p.ruf@me.com)
</p>


<h3>See Also</h3>

<p>clipview
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("wb_month")
data("ibex_hr")

x=wb_month$x
y=wb_month$hr


myclip=boxclip(x,y, histo=TRUE)
summary(myclip)

r=seq(1,28400,by=4) 
myclip=boxclip(ibex_hr$Time[r],ibex_hr$Heartrate[r],0.65)
summary(myclip)
#store(myclip)


data("sleepduration")
Date=as.POSIXct(sleepduration$Date)
Duration=as.numeric(sleepduration$Bedtime)
boxclip(Date,Duration,miny=0)
</code></pre>


</div>