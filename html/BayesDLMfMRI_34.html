<div class="container">

<table style="width: 100%;"><tr>
<td>SingleVoxelFSTS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SingleVoxelFSTS</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>This function is used to perform an activation analysis for single voxels based on the FSTS algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SingleVoxelFSTS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the voxel observed at time <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m0=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p \times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q \times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*Min.vol</code> can be considered irrelevant and discarded from the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows the development of an activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location <code>(i,j,k)</code>, in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (Evidence) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses,
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t |/ \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
“Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.”
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
“BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.”
<em>arXiv e-prints</em>, arXiv–2111.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# This example can take a long time to run.
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res.indi &lt;- SingleVoxelFSTS(posi.ffd = c(14, 56, 40), 
                            covariates = Covariates,
                            ffdc =  fMRI.data, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, Nsimu1 = 100, N1 = FALSE, Cutpos1 = 30, 
                            Min.vol = 0.10, r1 = 1)


## End(Not run)
</code></pre>


</div>