<div class="container">

<table style="width: 100%;"><tr>
<td>check_night</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check if it is night at a given time and place</h2>

<h3>Description</h3>

<p>Checks if it is night (<code>TRUE</code>/<code>FALSE</code>) for a combination of
latitude, longitude, date and sun elevation. When used on a bioRad object
(<code>pvol</code>, <code>vp</code>, <code>vpts</code>, <code>vpi</code>) this information is extracted from the
bioRad object directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check_night(x, ..., elev = -0.268, offset = 0)

## Default S3 method:
check_night(x, lon, lat, ..., tz = "UTC", elev = -0.268, offset = 0)

## S3 method for class 'vp'
check_night(x, ..., elev = -0.268, offset = 0)

## S3 method for class 'list'
check_night(x, ..., elev = -0.268, offset = 0)

## S3 method for class 'vpts'
check_night(x, ..., elev = -0.268, offset = 0)

## S3 method for class 'vpi'
check_night(x, ..., elev = -0.268, offset = 0)

## S3 method for class 'pvol'
check_night(x, ..., elev = -0.268, offset = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>pvol</code>, <code>vp</code>, <code>vpts</code>, <code>vpi</code> object, a POSIXct date or a string
interpretable by <code>base::as.POSIXct()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional lat, lon arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elev</code></td>
<td>
<p>Numeric (vector). Sun elevation in degrees defining nighttime.
May also be a numeric vector of length two, with first element giving
sunset elevation, and second element sunrise elevation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Numeric (vector). Time duration in seconds by which to shift
the start and end of nighttime. May also be a numeric vector of length two,
with first element added to moment of sunset and second element added to
moment of sunrise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Numeric. Longitude, in decimal degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Numeric. Latitude, in decimal degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tz</code></td>
<td>
<p>Character. Time zone. Ignored when <code>date</code> already has an associated
time zone.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>check_night()</code> evaluates to <code>FALSE</code> when the sun has a higher
elevation than parameter <code>elev</code>, otherwise <code>TRUE</code>.
</p>
<p>Approximate astronomical formula are used, therefore the day/night
transition may be off by a few minutes.
</p>
<p>The angular diameter of the sun is about 0.536 degrees, therefore the moment
of sunrise/sunset corresponds to half that elevation at -0.268 degrees.
Approximate astronomical formula are used, therefore the day/night transition
may be off by a few minutes.
</p>
<p><code>offset</code> can be used to shift the moment of sunset and sunrise by a temporal
offset, for example, <code>offset = c(600,-900)</code> will assume nighttime starts 600
seconds after sunset (as defined by <code>elev</code>) and stops 900 seconds before
sunrise.
</p>


<h3>Value</h3>

<p><code>TRUE</code> when night, <code>FALSE</code> when day, <code>NA</code> if unknown
(either datetime or geographic location missing). For <code>vpts</code> a
vector of <code>TRUE</code>/<code>FALSE</code> values is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Check if it is night at UTC midnight in the Netherlands on January 1st:
check_night("2016-01-01 00:00", 5, 53)

# Check on bioRad objects directly:
check_night(example_vp)

check_night(example_vpts)

# Select nighttime profiles that are between 3 hours after sunset
# and 2 hours before sunrise:
index &lt;- check_night(example_vpts, offset = c(3,-2)*3600)
example_vpts[index]
</code></pre>


</div>