<div class="container">

<table style="width: 100%;"><tr>
<td>pp_mixture.brmsfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Probabilities of Mixture Component Memberships</h2>

<h3>Description</h3>

<p>Compute the posterior probabilities of mixture component
memberships for each observation including uncertainty
estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'brmsfit'
pp_mixture(
  x,
  newdata = NULL,
  re_formula = NULL,
  resp = NULL,
  ndraws = NULL,
  draw_ids = NULL,
  log = FALSE,
  summary = TRUE,
  robust = FALSE,
  probs = c(0.025, 0.975),
  ...
)

pp_mixture(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object usually of class <code>brmsfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data.frame for which to evaluate predictions. If
<code>NULL</code> (default), the original data of the model is used. <code>NA</code>
values within factors (excluding grouping variables) are interpreted as if
all dummy variables of this factor are zero. This allows, for instance, to
make predictions of the grand mean when using sum coding. <code>NA</code> values
within grouping variables are treated as a new level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re_formula</code></td>
<td>
<p>formula containing group-level effects to be considered in
the prediction. If <code>NULL</code> (default), include all group-level effects;
if <code>NA</code> or <code>~0</code>, include no group-level effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Optional names of response variables. If specified, predictions
are performed only for the specified response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>Positive integer indicating how many posterior draws should
be used. If <code>NULL</code> (the default) all draws are used. Ignored if
<code>draw_ids</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_ids</code></td>
<td>
<p>An integer vector specifying the posterior draws to be used.
If <code>NULL</code> (the default), all draws are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical; Indicates whether to return
probabilities on the log-scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Should summary statistics be returned
instead of the raw values? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>If <code>FALSE</code> (the default) the mean is used as
the measure of central tendency and the standard deviation as
the measure of variability. If <code>TRUE</code>, the median and the
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>The percentiles to be computed by the <code>quantile</code>
function. Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>prepare_predictions</code>
that control several aspects of data validation and prediction.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The returned probabilities can be written as
<code class="reqn">P(K_n = k | Y_n)</code>, that is the posterior probability
that observation n originates from component k.
They are computed using Bayes' Theorem
</p>
<p style="text-align: center;"><code class="reqn">P(K_n = k | Y_n) = P(Y_n | K_n = k) P(K_n = k) / P(Y_n),</code>
</p>

<p>where <code class="reqn">P(Y_n | K_n = k)</code> is the (posterior) likelihood
of observation n for component k, <code class="reqn">P(K_n = k)</code> is
the (posterior) mixing probability of component k
(i.e. parameter <code>theta&lt;k&gt;</code>), and
</p>
<p style="text-align: center;"><code class="reqn">P(Y_n) = \sum_{k=1,...,K} P(Y_n | K_n = k) P(K_n = k)</code>
</p>

<p>is a normalizing constant.
</p>


<h3>Value</h3>

<p>If <code>summary = TRUE</code>, an N x E x K array,
where N is the number of observations, K is the number
of mixture components, and E is equal to <code>length(probs) + 2</code>.
If <code>summary = FALSE</code>, an S x N x K array, where
S is the number of posterior draws.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## simulate some data
set.seed(1234)
dat &lt;- data.frame(
  y = c(rnorm(100), rnorm(50, 2)),
  x = rnorm(150)
)
## fit a simple normal mixture model
mix &lt;- mixture(gaussian, nmix = 2)
prior &lt;- c(
  prior(normal(0, 5), Intercept, nlpar = mu1),
  prior(normal(0, 5), Intercept, nlpar = mu2),
  prior(dirichlet(2, 2), theta)
)
fit1 &lt;- brm(bf(y ~ x), dat, family = mix,
            prior = prior, chains = 2, init = 0)
summary(fit1)

## compute the membership probabilities
ppm &lt;- pp_mixture(fit1)
str(ppm)

## extract point estimates for each observation
head(ppm[, 1, ])

## classify every observation according to
## the most likely component
apply(ppm[, 1, ], 1, which.max)

## End(Not run)

</code></pre>


</div>