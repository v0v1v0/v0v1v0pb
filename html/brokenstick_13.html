<div class="container">

<table style="width: 100%;"><tr>
<td>kr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kasim-Raudenbush sampler for two-level normal model</h2>

<h3>Description</h3>

<p>Simulates posterior distributions of parameters from a two-level
normal model with heterogeneous within-cluster variances
(Kasim and Raudenbush, 1998). Imputations can be drawn as an
extra step to the algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kr(y, x, g, control = control_kr())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector with outcome value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix with predictor value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector with group values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list created by <code>control_kr()</code> that sets algorithmic options
of the sampler and correlation model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The speed of the Kasim-Raudenbush sampler is almost
independent of the number of random effect, and foremost depends
on the total number of iterations.
</p>
<p>The defaults <code>start = 100</code>, <code>n = 200</code> and <code>thin = 1</code> provide 200 parameter
draws with a <em>reasonable</em> approximation to the variance-covariance
matrix of the random effects.
</p>
<p>For a closer approximations with 200 draws set <code>control = control_kr(thin = 10)</code>
(<em>better</em>) or <code>thin = 20</code> (<em>best</em>), at the expense of a linear increase in calculation
time. Drawing fewer than 50 observations is not recommended, and such
results are best treated as <em>indicative</em>.
</p>
<p>It is possible to draw multiple imputations by setting the <code>nimp</code> parameter.
For example, to draw five imputations for each missing outcome specify
<code>control = control_kr(nimp = 5)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>kr</code>, basically a list with components:
</p>
<div class="sourceCode"><pre>* `beta`  Fixed effects
* `omega` Variance-covariance of random effects
* `sigma2_j` Residual variance per group
* `sigma2` Average residual variance
* `sample` Descriptive statistics about the data
* `imp`   Numeric matrix with `nimp` multiple imputations.
* `mod`   A list of objects of class [coda::mcmc()]
</pre></div>
<p>The number of rows in <code>imp</code> is equal to the number of missing values in the
outcome vector <code>y</code>. The number of columns equals <code>nimp</code>.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, based on <code>mice::mice.impute.2l.norm()</code>
</p>


<h3>References</h3>

<p>Kasim RM, Raudenbush SW. (1998). Application of Gibbs sampling to nested
variance components models with heterogeneous within-group variance. Journal
of Educational and Behavioral Statistics, 23(2), 93â€“116.
</p>


</div>