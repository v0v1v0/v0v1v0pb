<div class="container">

<table style="width: 100%;"><tr>
<td>check_mon_between</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check Between-Trial Monotonicity</h2>

<h3>Description</h3>

<p>Checks whether the between-trial monotonicity condition holds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check_mon_between(design, ...)

## S4 method for signature 'OneStageBasket'
check_mon_between(
  design,
  n,
  lambda,
  weight_fun,
  weight_params = list(),
  details = TRUE,
  globalweight_fun = NULL,
  globalweight_params = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>An object of class <code>Basket</code> created by
<code>setupOneStageBasket</code> or <code>setupTwoStageBasket</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size per basket.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The posterior probability threshold. See details for more
information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_fun</code></td>
<td>
<p>Which function should be used to calculate the pairwise
weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>weight_fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>Whether the cases where the monotonicity condition is
violated should be returned, in case there are any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalweight_fun</code></td>
<td>
<p>Which function should be used to calculate the
global weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalweight_params</code></td>
<td>
<p>A list of tuning parameters specific to
<code>globalweight_fun</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>check_mon_between</code> checks whether the between-trial
monotonicity condition holds. For a single-stage design with equal prior
distributions and equal sample sizes for each basket this condition states
that there are no cases where at least one null hypothesis is rejected when
when there is a case with an equal or higher number of responses in each
basket for which no null hypothesis is rejected.
</p>
<p>If <code>prune = TRUE</code> then the baskets with an observed number of baskets
smaller than the pooled critical value are not borrowed from. The
pooled critical value is the smallest integer c for which all null
hypotheses can be rejected if the number of responses is exactly c for
all baskets.
</p>
<p>The function is vectorized, such that vectors can be specified in
<code>weight_params</code> and <code>globalweight_params</code>.
</p>


<h3>Value</h3>

<p>If <code>details = FALSE</code> then only a logical value is returned.
If <code>details = TRUE</code> then if there are any cases where the
between-trial monotonicity condition is violated, a list of theses cases
and their results are returned.
</p>


<h3>Methods (by class)</h3>


<ul><li> <p><code>check_mon_between(OneStageBasket)</code>: Between-trial monotonicity condition for a
single-stage design.
</p>
</li></ul>
<h3>References</h3>

<p>Baumann, L., Krisam, J., &amp; Kieser, M. (2022). Monotonicity conditions for
avoiding counterintuitive decisions in basket trials. Biometrical Journal,
64(5), 934-947.
</p>


<h3>Examples</h3>

<pre><code class="language-R">design &lt;- setupOneStageBasket(k = 4, shape1 = 1, shape2 = 1, p0 = 0.2)

# Without vectorization, with details
check_mon_between(design = design, n = 24, lambda = 0.99,
  weight_fun = weights_fujikawa, weight_params = list(epsilon = 3,
    tau = 0), details = TRUE)

# Vectorized
check_mon_between(design = design, n = 24, lambda = 0.99,
  weight_fun = weights_fujikawa,
  weight_params = list(epsilon = c(0.5, 1),  tau = c(0, 0.2, 0.3)),
  globalweight_fun = globalweights_fix,
  globalweight_params = list(w = c(0.5, 0.7)))
</code></pre>


</div>