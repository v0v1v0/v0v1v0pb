<div class="container">

<table style="width: 100%;"><tr>
<td>SDF_gmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GMM Estimates of Factors' Risk Prices under the Linear SDF Framework</h2>

<h3>Description</h3>

<p>This function provides the GMM estimates of factors' risk prices under the linear SDF framework (including the common intercept).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SDF_gmm(R, f, W)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A matrix of test assets with dimension <code class="reqn">t \times N</code>, where <code class="reqn">t</code> is the number of periods
and <code class="reqn">N</code> is the number of test assets;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A matrix of factors with dimension <code class="reqn">t \times k</code>, where <code class="reqn">k</code> is the number of factors
and <code class="reqn">t</code> is the number of periods;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Weighting matrix in GMM estimation (see <b>Details</b>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We follow the notations in Section I of Bryzgalova et al. (2023).
Suppose that there are <code class="reqn">K</code> factors, <code class="reqn">f_t = (f_{1t},...,f_{Kt})^\top, t=1,...,T</code>.
The returns of <code class="reqn">N</code> test assets are denoted by <code class="reqn">R_t = (R_{1t},...,R_{Nt})^\top</code>.
</p>
<p>Consider linear SDFs (<code class="reqn">M</code>), that is, models of the form <code class="reqn">M_t = 1- (f_t -E[f_t])^\top \lambda_f</code>.
</p>
<p>The model is estimated via GMM with moment conditions
</p>
<p style="text-align: center;"><code class="reqn">E[g_t (\lambda_c, \lambda_f, \mu_f)] =E\left(\begin{array}{c} R_t - \lambda_c 1_N - R_t (f_t - \mu_f)^\top \lambda_f \\ f_t - \mu_f \end{array} \right) =\left(\begin{array}{c}  0_N \\ 0_K \end{array} \right)</code>
</p>

<p>and the corresponding sample analog function <code class="reqn"> g_T (\lambda_c, \lambda_f, \mu_f) = \frac{1}{T} \Sigma_{t=1}^T  g_t (\lambda_c, \lambda_f, \mu_f)</code>. Different weighting matrices deliver different point estimates. Two popular choices are
</p>
<p style="text-align: center;"><code class="reqn">	W_{ols}=\left(\begin{array}{cc}I_N &amp; 0_{N \times K}  \\ 0_{K \times N} &amp; \kappa I_K\end{array}\right), \ \ W_{gls}=\left(\begin{array}{cc} \Sigma_R^{-1} &amp; 0_{N \times K}  \\ 0_{K \times N} &amp; \kappa I_K\end{array}\right), </code>
</p>

<p>where <code class="reqn">\Sigma_R</code> is the covariance matrix of returns and <code class="reqn">\kappa &gt;0</code> is a large constant so that <code class="reqn">\hat{\mu}_f = \frac{1}{T} \Sigma_{t=1}^{T} f_t </code>.
</p>
<p>The asymptotic covariance matrix of risk premia estimates, <code>Avar_hat</code>, is based on the assumption that
<code class="reqn">g_t (\lambda_c, \lambda_f, \mu_f)</code> is independent over time.
</p>


<h3>Value</h3>

<p>The return of <code>SDF_gmm</code> is a list of the following elements:
</p>

<ul>
<li> <p><code>lambda_gmm</code>: Risk price estimates;
</p>
</li>
<li> <p><code>mu_f</code>: Sample means of factors;
</p>
</li>
<li> <p><code>Avar_hat</code>: Asymptotic covariance matrix of GMM estimates (see <b>Details</b>);
</p>
</li>
<li> <p><code>R2_adj</code>: Adjusted cross-sectional <code class="reqn">R^2</code>;
</p>
</li>
<li> <p><code>S_hat</code>: Spectral matrix.
</p>
</li>
</ul>
<h3>References</h3>

<p>Bryzgalova S, Huang J, Julliard C (2023).
“Bayesian solutions for the factor zoo: We just ran two quadrillion models &lt;https://doi.org/10.1111/jofi.13197&gt;.”
<em>Journal of Finance</em>, <b>78</b>(1), 487–557.
</p>


</div>