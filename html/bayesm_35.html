<div class="container">

<table style="width: 100%;"><tr>
<td>rbprobitGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler (Albert and Chib) for Binary Probit</h2>

<h3>Description</h3>

<p><code>rbprobitGibbs</code> implements the Albert and Chib Gibbs Sampler for the binary probit model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbprobitGibbs(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(y, X)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(betabar, A)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">z = X\beta + e</code> with <code class="reqn">e</code> <code class="reqn">\sim</code> <code class="reqn">N(0, I)</code> <br><code class="reqn">y = 1</code> if <code class="reqn">z &gt; 0</code> 
</p>
<p><code class="reqn">\beta</code> <code class="reqn">\sim</code> <code class="reqn">N(betabar, A^{-1})</code>
</p>



<h4>Argument Details</h4>

<p><em><code>Data  = list(y, X)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>y:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n x 1</code> vector of 0/1 outcomes </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>X:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n x k</code> design matrix
    </td>
</tr>
</table>
<p><em><code>Prior = list(betabar, A)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>betabar: </code> </td>
<td style="text-align: left;"> <code class="reqn">k x 1</code> prior mean (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>A:       </code> </td>
<td style="text-align: left;"> <code class="reqn">k x k</code> prior precision matrix (def: 0.01*I)
    </td>
</tr>
</table>
<p><em><code>Mcmc  = list(R, keep, nprint)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:       </code> </td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:    </code> </td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint:  </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print)
    </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table><tr style="vertical-align: top;">
<td><code>betadraw </code></td>
<td>
 <p><code class="reqn">R/keep x k</code> matrix of betadraws</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p>For further discussion, see Chapter 3, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>See Also</h3>

 <p><code>rmnpGibbs</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=2000} else {R=10}
set.seed(66)

## function to simulate from binary probit including x variable
simbprobit = function(X, beta) {
  y = ifelse((X%*%beta + rnorm(nrow(X)))&lt;0, 0, 1)
  list(X=X, y=y, beta=beta)
}

nobs = 200
X = cbind(rep(1,nobs), runif(nobs), runif(nobs))
beta = c(0,1,-1)
nvar = ncol(X)
simout = simbprobit(X, beta)

Data1 = list(X=simout$X, y=simout$y)
Mcmc1 = list(R=R, keep=1)

out = rbprobitGibbs(Data=Data1, Mcmc=Mcmc1)
summary(out$betadraw, tvalues=beta)

## plotting example
if(0){plot(out$betadraw, tvalues=beta)}
</code></pre>


</div>