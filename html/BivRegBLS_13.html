<div class="container">

<table style="width: 100%;"><tr>
<td>FullCIs.MD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Confidence Intervals by CBLS with all potential solutions</h2>

<h3>Description</h3>

<p>Estimate the Correlated-Bivariate-Least Square regression (CBLS) for all potential solutions from ρMD=-1 to ρMD=1, in a (M,D) plot. This function is analogous to <code>FullCIs.XY</code> estimating all the BLS regressions from OLSv to OLSh in a (X,Y) plot.</p>


<h3>Usage</h3>

<pre><code class="language-R">FullCIs.MD(data = NULL, xcol = 1, ycol = 2,
           conf.level = 0.95, npoints = 1000, nlambdas = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambdas</code></td>
<td>
<p>an integer for the number of intermediate CBLS regressions (the two extreme CBLS are calculated by default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data argument is mandatory. This function is especially useful for unreplicated data with unknown ρMD (related to λXY, the ratio of the measurement error variances), as it calculates all the potential solutions. The different estimated regression lines are provided with the different confidence intervals.</p>


<h3>Value</h3>

<p>A CIs.MD class object, a list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Data.means</code></td>
<td>
<p> a table with the X and Y data (means of the replicated data if replicated), their means and differences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ellipses.CB</code></td>
<td>
<p> an array of dimension [<code>npoints</code>, 2 (intercept and slope), <code>nlambdas</code> + 2] with the coordinates of all the joint confidence intervals (confidence region, ellipses) from ρMD = -1 to ρMD = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Slopes</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the slopes estimates and their approximate confidence intervals and pvalue (slope = 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Intercepts</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the intercepts estimates and their approximate confidence intervals and pvalue (intercept = 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Joints</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the pvalues of the joint hypothesis (slope = 0 and intercept = 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hyperbolic.intervals</code></td>
<td>
<p> an array of dimension [<code>npoints</code>, 6 (X values, Y predictions, confidence interval and confidence bands), <code>nlambdas</code> + 2] with the hyperbolic confidence interval and confidence bands.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
</p>


<h3>See Also</h3>

<p><code>FullCIs.XY</code>, <code>CBLS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BivRegBLS)
data(Aromatics)
res.full=FullCIs.MD(data=Aromatics,xcol=3,ycol=4)
</code></pre>


</div>