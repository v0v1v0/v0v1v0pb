<div class="container">

<table style="width: 100%;"><tr>
<td>LN_MeanReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Estimate of the conditional Log-normal Mean</h2>

<h3>Description</h3>

<p>This function produces a bayesian estimate of the conditional log-normal mean assuming a GIG prior for the variance and an
improper prior for the regression coefficients of the linear regression in the log scale.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LN_MeanReg(
  y,
  X,
  Xtilde,
  method = "weak_inf",
  y_transf = TRUE,
  h = NULL,
  CI = TRUE,
  alpha_CI = 0.05,
  type_CI = "two-sided",
  nrep = 1e+05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of observations of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtilde</code></td>
<td>
<p>Matrix of covariate patterns for which an estimate is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String that indicates the prior setting to adopt. Choosing <code>"weak_inf"</code> a weakly
informative prior setting is adopted, whereas selecting
<code>"optimal"</code> the hyperparameters are aimed at minimizing the frequentist MSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_transf</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the <code>y</code> vector is already assumed as log-transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Leverage. With the default option <code>NULL</code>, the average leverage is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Logical. With the default choice <code>TRUE</code>, the posterior credibility interval is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_CI</code></td>
<td>
<p>Level of alpha that determines the credibility (1-<code>alpha_CI</code>) of the posterior interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_CI</code></td>
<td>
<p>String that indicates the type of interval to compute: <code>"two-sided"</code> (default),
<code>"UCL"</code> (i.e. Upper Credible Limit) for upper one-sided intervals  or <code>"LCL"</code> (i.e. Lower
Credible Limit) for lower one-sided intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of simulations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In this function the same procedure as LN_Mean is implemented allowing for the inclusion of covariates.
Bayesian point and interval estimates for the response variabile in the original scale are provided considering the model:
<code class="reqn">log(y_i)=X\beta</code>.
</p>


<h3>Value</h3>

<p>The function returns a list including the prior and posterior parameters, the point estimate of the log-normal mean conditioned with respect to the covariate
points included in <code>Xtilde</code>. It consists of the mean of the posterior
distribution for the functional <code class="reqn">\exp\{\tilde{x}_i^T\beta+\sigma^2/2\}</code> and the posterior variance.
</p>


<h3>Source</h3>

<p>Fabrizi, E., &amp; Trivisano, C. <em>Bayesian Conditional Mean Estimation in Log-Normal Linear Regression Models with Finite
Quadratic Expected Loss.</em> Scandinavian Journal of Statistics, 43(4), 1064-1077. (2016).
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BayesLN)
data("fatigue")

# Design matrices
Xtot &lt;- cbind(1, log(fatigue$stress), log(fatigue$stress)^2)
X &lt;- Xtot[-c(1,13,22),]
y &lt;- fatigue$cycle[-c(1,13,22)]
Xtilde &lt;- Xtot[c(1,13,22),]
#Estimation
LN_MeanReg(y = y,
           X = X, Xtilde = Xtilde,
           method = "weak_inf", y_transf = FALSE)


</code></pre>


</div>