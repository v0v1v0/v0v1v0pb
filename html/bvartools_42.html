<div class="container">

<table style="width: 100%;"><tr>
<td>post_normal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Draw from a Normal Distribution</h2>

<h3>Description</h3>

<p>Produces a draw of coefficients from a normal posterior density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">post_normal(y, x, sigma_i, a_prior, v_i_prior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code class="reqn">K \times T</code> matrix of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code class="reqn">M \times T</code> matrix of explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_i</code></td>
<td>
<p>the inverse of the <code class="reqn">K \times K</code> variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_prior</code></td>
<td>
<p>a <code class="reqn">KM \times 1</code> numeric vector of prior means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_i_prior</code></td>
<td>
<p>the inverse of the <code class="reqn">KM \times KM</code> prior covariance matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function produces a vectorised posterior draw <code class="reqn">a</code> of the
<code class="reqn">K \times M</code> coefficient matrix <code class="reqn">A</code> for the model
</p>
<p style="text-align: center;"><code class="reqn">y_{t} = A x_{t} + u_{t},</code>
</p>

<p>where <code class="reqn">y_{t}</code> is a K-dimensional vector of endogenous variables,
<code class="reqn">x_{t}</code> is an M-dimensional vector of explanatory variabes
and the error term is <code class="reqn">u_t \sim \Sigma</code>.
</p>
<p>For a given prior mean vector <code class="reqn">\underline{a}</code> and prior covariance matrix <code class="reqn">\underline{V}</code>
the posterior covariance matrix is obtained by
</p>
<p style="text-align: center;"><code class="reqn">\overline{V} = \left[ \underline{V}^{-1} + \left(X X^{\prime} \otimes \Sigma^{-1} \right) \right]^{-1}</code>
</p>

<p>and the posterior mean by
</p>
<p style="text-align: center;"><code class="reqn">\overline{a} = \overline{V} \left[ \underline{V}^{-1} \underline{a} + vec(\Sigma^{-1} Y X^{\prime}) \right],</code>
</p>

<p>where <code class="reqn">Y</code> is a <code class="reqn">K \times T</code> matrix of the endogenous variables and <code class="reqn">X</code> is an <code class="reqn">M \times T</code> matrix of
the explanatory variables.
</p>


<h3>Value</h3>

<p>A vector.
</p>


<h3>References</h3>

<p>LÃ¼tkepohl, H. (2006). <em>New introduction to multiple time series analysis</em> (2nd ed.). Berlin: Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load data
data("e1")
data &lt;- diff(log(e1))

# Generate model data
temp &lt;- gen_var(data, p = 2, deterministic = "const")
y &lt;- t(temp$data$Y)
x &lt;- t(temp$data$Z)
k &lt;- nrow(y)
tt &lt;- ncol(y)
m &lt;- k * nrow(x)

# Priors
a_mu_prior &lt;- matrix(0, m)
a_v_i_prior &lt;- diag(0.1, m)

# Initial value of inverse Sigma
sigma_i &lt;- solve(tcrossprod(y) / tt)

# Draw parameters
a &lt;- post_normal(y = y, x = x, sigma_i = sigma_i,
                 a_prior = a_mu_prior, v_i_prior = a_v_i_prior)

</code></pre>


</div>