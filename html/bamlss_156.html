<div class="container">

<table style="width: 100%;"><tr>
<td>neighbormatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute a Neighborhood Matrix from Spatial Polygons
</h2>

<h3>Description</h3>

<p>The function takes a <code>SpatialPolygonsDataFrame</code> and computes
the neighbor penalty matrix that can be used to fit a Markov
random field, e.g., using the smooth constructor
<code>smooth.construct.mrf.smooth.spec</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Compute the neighborhood matrix.
neighbormatrix(x, type = c("boundary", "dist", "delaunay", "knear"),
  k = 1, id = NULL, nb = FALSE, names = NULL, ...)

## Plot neighborhood structure.
plotneighbors(x, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"SpatialPolygons"</code> or <code>"SpatialPolygonsDataFrame"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Which type of neighborhood structure should be used,
<code>"boundary"</code> uses <code>poly2nb</code>, <code>"dist"</code>
uses function <code>dnearneigh</code>, <code>"delaunay"</code>
uses function <code>tri2nb</code> and option
<code>"knear"</code> applies function <code>knn2nb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>For <code>type = "knear"</code>, specifies number of nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>An identifier variable for which the penalty matrix should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>Should only the neighborhood object be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>Specifies the column where the regions names are provided in the data
slot in the <code>"SpatialPolygonsDataFrame"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Should the neighborhood structure be added to an existing plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to function <code>poly2nb</code>,
<code>dnearneigh</code>, <code>tri2nb</code> or
<code>knn2nb</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>smooth.construct.mrf.smooth.spec</code>, <code>dnearneigh</code>,
<code>tri2nb</code>, <code>knn2nb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: data("LondonFire")

## Compute polygon boundary based
## neighborhood matrix.
nm &lt;- neighbormatrix(LondonBoroughs)
print(nm)

## Plot neighborhood structures.
plotneighbors(LondonBoroughs)
plotneighbors(LondonBoroughs, type = "delaunay")
plotneighbors(LondonBoroughs, type = "dist", d1 = 0, d2 = 0.15)

## End(Not run)</code></pre>


</div>