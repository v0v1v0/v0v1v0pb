<div class="container">

<table style="width: 100%;"><tr>
<td>hazards.fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the estimated (baseline/cumulative) hazard and (baseline) survival functions</h2>

<h3>Description</h3>

<p>For a given vector of times, <code>hazards.fun</code> computes the estimated baseline hazard, cumulative baseline hazard, hazard, baseline survival, and survival functions. It can be used for prediction on a new sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hazards.fun(time,
            z = NULL,
            p,
            theta_hat,
            basehaz = c("weibul", "exp", "gomp", "poly", "pwexp"),
            q_max,
            timax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>the vector containing the time values for which the hazard rate is computed. If the argument <code>z</code> is not <code>NULL</code>, then the length of the argument <code>time</code> should be the number of columns of <code>z</code>, which is <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a new observation vector of length <code class="reqn">p</code>. If <code>z = NULL</code> (the default), then the relative risk (<code class="reqn">\boldsymbol{z}^{\top} \boldsymbol{\beta}</code>) is considered a vector of 1 with length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of coefficients. It is taken equal to the number of elements of the argument <code>z</code>, if <code>z</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_hat</code></td>
<td>
<p>a vector contains the values of the estimated parameters. The first <code class="reqn">p</code> values represent the coefficient parameters (<code class="reqn">\boldsymbol{\beta}</code>), while the remaining values pertain to the parameters of the baseline hazard function  (<code class="reqn">\boldsymbol{\omega}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basehaz</code></td>
<td>
<p>a character string representing one of the available baseline hazard functions; <code>exponential</code> (<code>"exp"</code>), <code>Weibull</code> (<code>"weibul"</code>, the default), <code>Gompertz</code> (<code>"gomp"</code>), <code>exponentiated polynomial</code> (<code>"poly"</code>), and <code>piecewise exponential</code> (<code>"pwexp"</code>). Can be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_max</code></td>
<td>
<p>a value represents the order of the exponentiated polynomial baseline hazard function. This argument should only be used when <code>basehaz = "poly"</code>. In the case of multiple centers, the maximum value of the orders should be used. <code>ql.LRT()</code> can be used for obtaining of the order of each center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timax</code></td>
<td>
<p>a value represents the minimum (or maximum) value of the maximum times observed in the different centers. This argument should only be used when <code>basehaz = "pwexp"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>hazards.fun</code> computes the estimated baseline hazard, cumulative baseline hazard, hazard, baseline survival, and survival functions at different time points specified in the argument <code>time</code>.
</p>
<p>The function <code>hazards.fun()</code> can be used for prediction purposes with new sample. The arguments <code>time</code> and <code>z</code> should be provided for the new data.
</p>


<h3>Value</h3>

<p><code>hazards.fun</code> returns a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bhazard</code></td>
<td>
<p>the vector of estimates of the baseline hazard function at the time points given by the argument <code>time</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cbhazard</code></td>
<td>
<p>the vector of estimates of the cumulative baseline hazard function at the time points specified in the argument <code>time</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsurvival</code></td>
<td>
<p>the vector of estimates of the baseline survival function at the time points given by the argument <code>time</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hazard</code></td>
<td>
<p>the vector of estimates of the hazard function at the time points given by the argument <code>time</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chazard</code></td>
<td>
<p>the vector of estimates of the cumulative hazard function at the time points specified in the argument <code>time</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survival</code></td>
<td>
<p>the vector of estimates of the survival function at the time points given by the argument <code>time</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hassan Pazira<br>
Maintainer: Hassan Pazira <a href="mailto:hassan.pazira@radboudumc.nl">hassan.pazira@radboudumc.nl</a>
</p>


<h3>References</h3>

<p>Pazira H., Massa E., Weijers J.A.M., Coolen A.C.C. and Jonker M.A. (2024). <em>Bayesian Federated Inference for Survival Models</em>, <em>arXiv</em>. &lt;https://arxiv.org/abs/2404.17464&gt;
</p>


<h3>See Also</h3>

<p><code>MAP.estimation</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Setting a seed for reproducibility
set.seed(1123)

##-------------------------
## Simulating Survival data
##-------------------------

n &lt;- 40
p &lt;- 7
Original_data &lt;- data.frame(matrix(rnorm((n+1) * p), (n+1), p))
X &lt;- Original_data[1:n,]
X_new &lt;- Original_data[(n+1),]
# Simulating survival data from Exponential distribution
# with a predefined censoring rate of 0.2:
Orig_y &lt;- surv.simulate(Z = Original_data, beta = rep(1,p), a = exp(1),
                        cen_rate = 0.2, gen_data_from = "exp")$D[[1]][,1:2]
y &lt;- Orig_y[1:n,]
y_new &lt;- Orig_y[(n+1),]
time_points &lt;- seq(0, max(y$time), length.out=20)

#------------------------
# Weibull baseline hazard
#------------------------

Lambda &lt;- inv.prior.cov(X, lambda = c(0.5, 1), family = 'survival', basehaz = 'weibul')
fit_weib &lt;- MAP.estimation(y, X, family = 'survival', Lambda = Lambda,
                           basehaz = "weibul")
# reltive risk is 1:
hazards.fun(time = time_points, p = p, theta_hat = fit_weib$theta_hat,
            basehaz = "weibul")

#-------------------------
# Gompertz baseline hazard
#-------------------------
fit_gomp &lt;- MAP.estimation(y, X, family = 'survival', Lambda = Lambda,
                           basehaz = "gomp")
# different time points
hazards.fun(time=1:max(y*2), p = p, theta_hat = fit_gomp$theta_hat,
            basehaz = "gomp")


##----------------------------
## Prediction for a new sample
##----------------------------

## Exponentiated polynomial (poly) baseline hazard:
Lambda &lt;- inv.prior.cov(X, lambda = c(0.5, 1), family = 'survival', basehaz = "poly")
fit_poly &lt;- MAP.estimation(y, X, family = 'survival', Lambda = Lambda,
                           basehaz = "poly")
hazards.fun(time = y_new$time, z = X_new, theta_hat = fit_poly$theta_hat,
            basehaz = "poly", q_max = fit_poly$q_l)

## Piecewise Exponential (pwexp) baseline hazard:
Lambda &lt;- inv.prior.cov(X, lambda = c(0.5, 1), family = 'survival', basehaz = "pwexp")
fit_pw &lt;- MAP.estimation(y, X, family='survival', Lambda=Lambda, basehaz="pwexp",
                         min_max_times = max(y))
hazards.fun(time = y_new$time, z = X_new, theta_hat = fit_pw$theta_hat,
            basehaz = "pwexp", timax = max(y))

</code></pre>


</div>