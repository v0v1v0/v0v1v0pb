<div class="container">

<table style="width: 100%;"><tr>
<td>as.pdb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Convert to PDB format </h2>

<h3>Description</h3>

<p>Convert Tripos Mol2 format, or Amber parameter/topology and coordinate data to PDB format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">as.pdb(...)

## S3 method for class 'mol2'
as.pdb(mol, ...)

## S3 method for class 'prmtop'
as.pdb(prmtop, crd=NULL, inds=NULL, inds.crd=inds, ncore=NULL, ...)

## Default S3 method:
as.pdb(pdb=NULL, xyz=NULL, type=NULL, resno=NULL,
                   resid=NULL, eleno=NULL, elety=NULL, chain=NULL, 
                   insert=NULL, alt=NULL, o=NULL, b=NULL, segid=NULL, 
                   elesy=NULL, charge=NULL, verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> arguments passed to and from functions. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mol</code></td>
<td>
<p> a list object of type <code>"mol2"</code> (obtained with
<code>read.mol2</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prmtop</code></td>
<td>
<p> a list object of type <code>"prmtop"</code> (obtained with
<code>read.prmtop</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crd</code></td>
<td>
<p> a list object of type <code>"crd"</code> (obtained with
<code>read.crd.amber</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds</code></td>
<td>
<p> a list object of type <code>"select"</code> as obtained from
<code>atom.select</code>. The indices points to which atoms in the
PRMTOP object to convert. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds.crd</code></td>
<td>
<p> same as the ‘inds’ argument, but pointing to
the atoms in CRD object to convert. By default, this argument equals
to ‘inds’, assuming the same number and sequence of atoms in the
PRMTOP and CRD objects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore </code></td>
<td>
<p> number of CPU cores used to do the calculation.
<code>ncore&gt;1</code> requires package ‘parallel’ installed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> an object of class ‘pdb’ as obtained from
<code>read.pdb</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyz</code></td>
<td>
<p> a numeric vector/matrix of Cartesian coordinates. If
provided, the number of atoms in the new PDB object will be set to
<code>ncol(as.xyz(xyz))/3</code> (see <code>as.xyz</code>).
</p>
<p>If <code>xyz</code> is not provided the number of atoms will be based on
the length of <code>eleno</code>, <code>resno</code>, or <code>resid</code> (in that
order). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> a character vector of record types, i.e. "ATOM" or "HETATM",
with length equal to <code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element
character vector can be provided which will be repeated to match
the number of atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resno</code></td>
<td>
<p> a numeric vector of residue numbers of length equal to
<code>ncol(as.xyz(xyz))/3</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p> a character vector of residue types/ids of length equal to
<code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element
character vector can be provided which will be repeated to match
the number of atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eleno</code></td>
<td>
<p> a numeric vector of element/atom numbers of length equal to
<code>ncol(as.xyz(xyz))/3</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elety</code></td>
<td>
<p> a character vector of element/atom types of length equal to
<code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element
character vector can be provided which will be repeated to match
the number of atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p> a character vector of chain identifiers with length equal to
<code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element
character vector can be provided which will be repeated to match
the number of atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insert</code></td>
<td>
<p> a character vector of insertion code with length equal to
<code>ncol(as.xyz(xyz))/3</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt</code></td>
<td>
<p> a character vector of alternate record with length equal to
<code>ncol(as.xyz(xyz))/3</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>o</code></td>
<td>
<p> a numeric vector of occupancy values of length equal to
<code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element
numeric vector can be provided which will be repeated for to match
the number of atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p> a numeric vector of B-factors of length equal to <code>ncol(as.xyz(xyz))/3</code>.
Alternatively, a single element numeric vector can be provided
which will be repeated to match the number of atoms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segid</code></td>
<td>
<p> a character vector of segment id of length equal to
<code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element character vector can
be provided which will be repeated to match the number of
atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elesy</code></td>
<td>
<p> a character vector of element symbol of length equal to
<code>ncol(as.xyz(xyz))/3</code>. Alternatively, a single element character vector can
be provided which will be repeated to match the number of
atoms. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>charge</code></td>
<td>
<p> a numeric vector of atomic charge of length equal to
<code>ncol(as.xyz(xyz))/3</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> logical, if TRUE details of the PDB generation process
is printed to screen. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function converts Tripos Mol2 format, Amber formatted parameter/topology
(PRMTOP) and coordinate objects, and vector data to a PDB object.
</p>
<p>While <code>as.pdb.mol2</code> and <code>as.pdb.prmtop</code> converts specific
objects to a PDB object, <code>as.pdb.default</code> provides basic
functionality to convert raw data such as vectors of e.g. residue numbers,
residue identifiers, Cartesian coordinates, etc to a PDB object. When
<code>pdb</code> is provided the returned PDB object is built from the input
object with fields replaced by any input vector arguments.
e.g. <code>as.pdb(pdb, xyz=crd)</code> will return the same PDB object, with
only the Cartesian coordinates changed to <code>crd</code>.
</p>


<h3>Value</h3>

<p>Returns a list of class <code>"pdb"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>atom</code></td>
<td>
<p> a data.frame containing all atomic coordinate ATOM data,
with a row per ATOM and a column per record type.  See below for details
of the record type naming convention (useful for accessing columns). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyz </code></td>
<td>
<p> a numeric matrix of ATOM coordinate data of class <code>xyz</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calpha </code></td>
<td>
<p> logical vector with length equal to <code>nrow(atom)</code>
with TRUE values indicating a C-alpha “elety”. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p> the matched call. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Lars Skjaerven </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
<a href="http://ambermd.org/FileFormats.php">http://ambermd.org/FileFormats.php</a>
</p>


<h3>See Also</h3>

<p><code>read.crd</code>, <code>read.ncdf</code>,
<code>atom.select</code>, <code>read.pdb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Vector(s) to PDB object
pdb &lt;- as.pdb(resno=1:6, elety="CA", resid="ALA", chain="A")
pdb

## Not run: 
## Read a PRMTOP file
prmtop &lt;- read.prmtop(system.file("examples/crambin.prmtop", package="bio3d"))

## Read Amber coordinates
crds &lt;- read.crd(system.file("examples/crambin.inpcrd", package="bio3d"))

## Atom selection
ca.inds &lt;- atom.select(prmtop, "calpha")

## Convert to PDB format
pdb &lt;- as.pdb(prmtop, crds, inds=ca.inds)


## Read a single entry MOL2 file
## (returns a single object)
mol &lt;- read.mol2( system.file("examples/aspirin.mol2", package="bio3d") )

## Convert to PDB
pdb &lt;- as.pdb(mol)

## End(Not run)
</code></pre>


</div>