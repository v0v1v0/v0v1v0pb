<div class="container">

<table style="width: 100%;"><tr>
<td>brm_formula_sigma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Formula for standard deviation parameters</h2>

<h3>Description</h3>

<p>Parameterize standard deviations using
a formula for the <code>sigma</code> argument of <code>brm_formula()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brm_formula_sigma(
  data,
  check_rank = TRUE,
  intercept = FALSE,
  baseline = FALSE,
  baseline_subgroup = FALSE,
  baseline_subgroup_time = FALSE,
  baseline_time = FALSE,
  covariates = FALSE,
  group = FALSE,
  group_subgroup = FALSE,
  group_subgroup_time = FALSE,
  group_time = FALSE,
  subgroup = FALSE,
  subgroup_time = FALSE,
  time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A classed data frame from <code>brm_data()</code>, or an informative
prior archetype from a function like <code>brm_archetype_successive_cells()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_rank</code></td>
<td>
<p><code>TRUE</code> to check the rank of the model matrix
for <code>sigma</code> and throw an error if rank deficiency is detected.
<code>FALSE</code> to skip this check.
Rank-deficiency may cause <code>sigma</code> to be non-identifiable,
may prevent the MCMC from converging.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include an intercept, <code>FALSE</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include an additive effect for baseline
response, <code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code>brm_marginal_draws()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline_subgroup</code></td>
<td>
<p>Logical of length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline_subgroup_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include baseline-by-subgroup-by-time interaction,
<code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code>brm_marginal_draws()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include baseline-by-time interaction, <code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code>brm_marginal_draws()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include any additive covariates declared with
the <code>covariates</code> argument of <code>brm_data()</code>,
<code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code>brm_marginal_draws()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> (default) to include additive effects for
treatment groups, <code>FALSE</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_subgroup</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup interaction, <code>FALSE</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_subgroup_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup-by-time interaction, <code>FALSE</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_time</code></td>
<td>
<p>Logical of length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include additive fixed effects for subgroup levels,
<code>FALSE</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup_time</code></td>
<td>
<p>Logical of length 1.
<code>TRUE</code> to include subgroup-by-time interaction, <code>FALSE</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Logical of length 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In <code>brms</code>, the standard deviations of the residuals are
modeled through a parameter vector called <code>sigma</code>. <code>brms.mmrm</code>
always treats <code>sigma</code> as a distributional parameter
(<a href="https://paulbuerkner.com/brms/articles/brms_distreg.html">https://paulbuerkner.com/brms/articles/brms_distreg.html</a>).
<code>brm_formula_sigma()</code> lets you control the parameterization of <code>sigma</code>.
The output of <code>brm_formula_sigma()</code> serves as input to the <code>sigma</code>
argument of <code>brm_formula()</code>.
</p>
<p>The default <code>sigma</code> formula is <code>sigma ~ 0 + time</code>, where <code>time</code>
is the discrete time variable in the data. This is the usual
heterogeneous variance structure which declares
one standard deviation parameter for each time point in the data.
Alternatively, you could write
<code>brm_formula_sigma(data, intercept = TRUE, time = FALSE)</code>.
This will produce <code>sigma ~ 1</code>, which yields a single scalar variance
(a structure termed "homogeneous variance").
</p>
<p>With arguments like <code>baseline</code> and <code>covariates</code>, you can
specify extremely complicated variance structures. However,
if baseline or covariates are used, then the output of
<code>brm_marginal_draws()</code> omit effect size due to the statistical
challenges of calculating marginal means of draws of <code>sigma</code>
for this uncommon scenario.
</p>


<h3>Value</h3>

<p>A base R formula with S3 class <code>"brms_mmrm_formula_sigma"</code>.
This formula controls the parameterization of <code>sigma</code>, the linear-scale
<code>brms</code> distributional parameters which represent standard deviations.
</p>


<h3>See Also</h3>

<p>Other models: 
<code>brm_formula()</code>,
<code>brm_model()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(0)
data &lt;- brm_data(
  data = brm_simulate_simple()$data,
  outcome = "response",
  group = "group",
  time = "time",
  patient = "patient",
  reference_group = "group_1",
  reference_time = "time_1"
)
homogeneous &lt;- brm_formula_sigma(data, time = FALSE, intercept = TRUE)
by_group &lt;- brm_formula_sigma(data, group = TRUE, intercept = TRUE)
homogeneous
by_group
brm_formula(data, sigma = homogeneous)
brm_formula(data, sigma = by_group)
</code></pre>


</div>