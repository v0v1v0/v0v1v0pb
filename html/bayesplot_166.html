<div class="container">

<table style="width: 100%;"><tr>
<td>PPC-test-statistics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PPC test statistics</h2>

<h3>Description</h3>

<p>The distribution of a (test) statistic <code>T(yrep)</code>, or a pair of (test)
statistics, over the simulated datasets in <code>yrep</code>, compared to the
observed value <code>T(y)</code> computed from the data <code>y</code>. See the
<strong>Plot Descriptions</strong> and <strong>Details</strong> sections, below, as
well as <a href="https://github.com/jgabry/bayes-vis-paper#readme">Gabry et al. (2019)</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppc_stat(
  y,
  yrep,
  stat = "mean",
  ...,
  binwidth = NULL,
  bins = NULL,
  breaks = NULL,
  freq = TRUE
)

ppc_stat_grouped(
  y,
  yrep,
  group,
  stat = "mean",
  ...,
  facet_args = list(),
  binwidth = NULL,
  bins = NULL,
  breaks = NULL,
  freq = TRUE
)

ppc_stat_freqpoly(
  y,
  yrep,
  stat = "mean",
  ...,
  facet_args = list(),
  binwidth = NULL,
  bins = NULL,
  freq = TRUE
)

ppc_stat_freqpoly_grouped(
  y,
  yrep,
  group,
  stat = "mean",
  ...,
  facet_args = list(),
  binwidth = NULL,
  bins = NULL,
  freq = TRUE
)

ppc_stat_2d(y, yrep, stat = c("mean", "sd"), ..., size = 2.5, alpha = 0.7)

ppc_stat_data(y, yrep, group = NULL, stat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of observations. See <strong>Details</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrep</code></td>
<td>
<p>An <code>S</code> by <code>N</code> matrix of draws from the posterior (or prior)
predictive distribution. The number of rows, <code>S</code>, is the size of the
posterior (or prior) sample used to generate <code>yrep</code>. The number of columns,
<code>N</code> is the number of predicted observations (<code>length(y)</code>). The columns of
<code>yrep</code> should be in the same order as the data points in <code>y</code> for the plots
to make sense. See the <strong>Details</strong> and <strong>Plot Descriptions</strong> sections for
additional advice specific to particular plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A single function or a string naming a function, except for the
2D plot which requires a vector of exactly two names or functions. In all
cases the function(s) should take a vector input and return a scalar
statistic. If specified as a string (or strings) then the legend will
display the function name(s). If specified as a function (or functions)
then generic naming is used in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently unused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>Passed to <code>ggplot2::geom_histogram()</code> to override
the default binwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Passed to <code>ggplot2::geom_histogram()</code> to override
the default binwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Passed to <code>ggplot2::geom_histogram()</code> as an
alternative to <code>binwidth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>For histograms, <code>freq=TRUE</code> (the default) puts count on the
y-axis. Setting <code>freq=FALSE</code> puts density on the y-axis. (For many
plots the y-axis text is off by default. To view the count or density
labels on the y-axis see the <code>yaxis_text()</code> convenience
function.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A grouping variable of the same length as <code>y</code>.
Will be coerced to factor if not already a factor.
Each value in <code>group</code> is interpreted as the group level pertaining
to the corresponding observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_args</code></td>
<td>
<p>A named list of arguments (other than <code>facets</code>) passed
to <code>ggplot2::facet_wrap()</code> or <code>ggplot2::facet_grid()</code>
to control faceting. Note: if <code>scales</code> is not included in <code>facet_args</code>
then <strong>bayesplot</strong> may use <code>scales="free"</code> as the default (depending
on the plot) instead of the <strong>ggplot2</strong> default of <code>scales="fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size, alpha</code></td>
<td>
<p>For the 2D plot only, arguments passed to
<code>ggplot2::geom_point()</code> to control the appearance of scatterplot points.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For Binomial data, the plots may be more useful if
the input contains the "success" <em>proportions</em> (not discrete
"success" or "failure" counts).
</p>


<h3>Value</h3>

<p>The plotting functions return a ggplot object that can be further
customized using the <strong>ggplot2</strong> package. The functions with suffix
<code style="white-space: pre;">⁠_data()⁠</code> return the data that would have been drawn by the plotting
function.
</p>


<h3>Plot Descriptions</h3>


<dl>
<dt>
<code>ppc_stat()</code>, <code>ppc_stat_freqpoly()</code>
</dt>
<dd>
<p>A histogram or frequency polygon of the distribution of a statistic
computed by applying <code>stat</code> to each dataset (row) in <code>yrep</code>. The value of
the statistic in the observed data, <code>stat(y)</code>, is overlaid as a vertical
line. More details and example usage of <code>ppc_stat()</code> can be found in Gabry
et al. (2019).
</p>
</dd>
<dt>
<code>ppc_stat_grouped()</code>,<code>ppc_stat_freqpoly_grouped()</code>
</dt>
<dd>
<p>The same as <code>ppc_stat()</code> and <code>ppc_stat_freqpoly()</code>, but a separate plot is
generated for each level of a grouping variable. More details and example
usage of <code>ppc_stat_grouped()</code> can be found in Gabry et al. (2019).
</p>
</dd>
<dt><code>ppc_stat_2d()</code></dt>
<dd>
<p>A scatterplot showing the joint distribution of two statistics
computed over the datasets (rows) in <code>yrep</code>. The value of the
statistics in the observed data is overlaid as large point.
</p>
</dd>
</dl>
<h3>References</h3>

<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
Gelman, A. (2019), Visualization in Bayesian workflow.
<em>J. R. Stat. Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378.
(<a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378">journal version</a>,
<a href="https://arxiv.org/abs/1709.01449">arXiv preprint</a>,
<a href="https://github.com/jgabry/bayes-vis-paper">code on GitHub</a>)
</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari,
A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis.</em> Chapman &amp; Hall/CRC
Press, London, third edition. (Ch. 6)
</p>


<h3>See Also</h3>

<p>Other PPCs: 
<code>PPC-censoring</code>,
<code>PPC-discrete</code>,
<code>PPC-distributions</code>,
<code>PPC-errors</code>,
<code>PPC-intervals</code>,
<code>PPC-loo</code>,
<code>PPC-overview</code>,
<code>PPC-scatterplots</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- example_y_data()
yrep &lt;- example_yrep_draws()
ppc_stat(y, yrep)
ppc_stat(y, yrep, stat = "sd") + legend_none()

# use your own function for the 'stat' argument
color_scheme_set("brightblue")
q25 &lt;- function(y) quantile(y, 0.25)
ppc_stat(y, yrep, stat = "q25") # legend includes function name

# can define the function in the 'stat' argument instead of
# using its name but then the legend doesn't include the function name
ppc_stat(y, yrep, stat = function(y) quantile(y, 0.25))

# plots by group
color_scheme_set("teal")
group &lt;- example_group_data()
ppc_stat_grouped(y, yrep, group)
ppc_stat_grouped(y, yrep, group) + yaxis_text()

# force y-axes to have same scales, allow x axis to vary
ppc_stat_grouped(y, yrep, group, facet_args = list(scales = "free_x")) + yaxis_text()

# the freqpoly plots use frequency polygons instead of histograms
ppc_stat_freqpoly(y, yrep, stat = "median")
ppc_stat_freqpoly_grouped(y, yrep, group, stat = "median", facet_args = list(nrow = 2))

# ppc_stat_2d allows 2 statistics and makes a scatterplot
bayesplot_theme_set(ggplot2::theme_linedraw())
color_scheme_set("viridisE")
ppc_stat_2d(y, yrep, stat = c("mean", "sd"))

bayesplot_theme_set(ggplot2::theme_grey())
color_scheme_set("brewer-Paired")
ppc_stat_2d(y, yrep, stat = c("median", "mad"))

# reset aesthetics
color_scheme_set()
bayesplot_theme_set()

</code></pre>


</div>