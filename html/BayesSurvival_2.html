<div class="container">

<table style="width: 100%;"><tr>
<td>CumhazEval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate whether a true cumulative hazard function is contained
in the credible set.</h2>

<h3>Description</h3>

<p>This function is intended to evaluate the Bayesian procedure in a
simulation study. To that end, this function can be used to check
whether the true (user-defined) cumulative hazard function is
contained in the credible set generated by the function
BayesSurv.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CumhazEval(time.grid, true.cumhaz, post.mean, radius)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time.grid</code></td>
<td>
<p>The time grid on which to evaluate the cumulative
hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.cumhaz</code></td>
<td>
<p>The true cumulative hazard function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.mean</code></td>
<td>
<p>The posterior mean of the cumulative hazard, given
as a function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>The radius of the credible set for the cumulative hazard.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>covered</code></td>
<td>
<p>Indicator whether the true cumulative hazard function is
completely covered by the credible set on the times contained in
<code>time.grid</code>. 0 = not completely covered, 1 = completely covered.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Castillo and Van der Pas (2020). Multiscale Bayesian survival
analysis. &lt;arXiv:2005.02889&gt;.
</p>


<h3>See Also</h3>

<p>BayesSurv, which computes the posterior mean of the
cumulative hazard as well as the radius for its credible set.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Demonstration on a simulated data set
library(simsurv)
library(ggplot2)
hazard.true &lt;- function(t,x, betas, ...){1.2*(5*(t+0.05)^3 - 10*(t+0.05)^2 + 5*(t+0.05) ) + 0.7}
cumhaz.true &lt;- Vectorize( function(t){integrate(hazard.true, 0, t)$value} )
sim.df &lt;- data.frame(id = 1:1000)
df &lt;- simsurv(x = sim.df, maxt = 1, hazard = hazard.true)

bs &lt;- BayesSurv(df, "eventtime", "status")
K &lt;- length(bs$haz.post.mean)
cumhaz.pm &lt;- approxfun(c(0, (bs$time.max/K)*(1:K) ), c(0, cumsum(bs$haz.post.mean*bs$time.max/K)))
CumhazEval(bs$surv.eval.grid, cumhaz.true, cumhaz.pm, bs$cumhaz.radius)


</code></pre>


</div>