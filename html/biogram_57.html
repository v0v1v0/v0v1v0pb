<div class="container">

<table style="width: 100%;"><tr>
<td>test_features</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation test for feature selection</h2>

<h3>Description</h3>

<p>Performs a feature selection on positioned n-gram data using a Fisher's 
permutation test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_features(
  target,
  features,
  criterion = "ig",
  adjust = "BH",
  threshold = 1,
  quick = TRUE,
  times = 1e+05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p><code>integer</code> vector with target information (e.g. class labels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p><code>integer</code> matrix of features with number of rows equal 
to the length of the target vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>criterion used in permutation test. See Details 
for the list of possible criterions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>name of p-value adjustment method. See <code>p.adjust</code>
for the list of possible values. If <code>NULL</code>, p-values are not adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p><code>integer</code>. Features that occur less than <code>threshold</code>
and more often than <code>nrow(features)-threshold</code> are discarded from the permutation 
test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quick</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> Quick Permutation Test (QuiPT) is used. If 
<code>FALSE</code>, normal permutation test is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>number of times procedure should be repeated. Ignored if <code>quick</code> is 
<code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since the procedure involves multiple testing, it is advisable to use one
of the avaible p-value adjustment methods. Such methods can be used directly by 
specifying the <code>adjust</code> parameter.
</p>
<p>Available criterions:
</p>

<dl>
<dt>ig</dt>
<dd>
<p>Information Gain: <code>calc_ig</code>.</p>
</dd>
<dt>kl</dt>
<dd>
<p>Kullback-Leibler divergence: <code>calc_kl</code>.</p>
</dd>
<dt>cs</dt>
<dd>
<p>Chi-squared-based measure: <code>calc_cs</code>.</p>
</dd>
</dl>
<h3>Value</h3>

<p>an object of class <code>feature_test</code>.
</p>


<h3>Note</h3>

<p>Both <code>target</code> and <code>features</code> must be binary, i.e. contain only 0 
and 1 values.
</p>
<p>Features occuring too often and too rarely are considered not informative and may be 
removed using the threshold parameter.
</p>


<h3>References</h3>

<p>Radivojac P, Obradovic Z, Dunker AK, Vucetic S, 
<em>Feature selection filters based on the permutation test</em> in 
Machine Learning: ECML 2004, 15th European 
Conference on Machine Learning, Springer, 2004.
</p>


<h3>See Also</h3>

<p><code>binarize</code> - binarizes input data.
</p>
<p><code>calc_criterion</code> - computes selected criterion.
</p>
<p><code>distr_crit</code> - distribution of criterion used in QuiPT.
</p>
<p><code>summary.feature_test</code> - summary of results.
</p>
<p><code>cut.feature_test</code> - aggregates test results in groups based on feature's
p-value.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># significant feature
tar_feat1 &lt;- create_feature_target(10, 390, 0, 600) 
# significant feature
tar_feat2 &lt;- create_feature_target(9, 391, 1, 599)
# insignificant feature
tar_feat3 &lt;- create_feature_target(198, 202, 300, 300)
test_res &lt;- test_features(tar_feat1[, 1], cbind(tar_feat1[, 2], tar_feat2[, 2], 
                          tar_feat3[, 2]))
summary(test_res)
cut(test_res)

# real data example
# we will analyze only a subsample of a dataset to make analysis quicker
ids &lt;- c(1L:100, 701L:800)
deg_seqs &lt;- degenerate(human_cleave[ids, 1L:9], 
                       list(`a` = c(1, 6, 8, 10, 11, 18), 
                            `b` = c(2, 5, 13, 14, 16, 17, 19, 20), 
                            `c` = c(3, 4, 7, 9, 12, 15)))

# positioned n-grams example
bigrams_pos &lt;- count_ngrams(deg_seqs, 2, letters[1L:3], pos = TRUE)
test_features(human_cleave[ids, 10], bigrams_pos)

# unpositioned n-grams example, binarization required
bigrams_notpos &lt;- count_ngrams(deg_seqs, 2, letters[1L:3], pos = TRUE)
test_features(human_cleave[ids, 10], binarize(bigrams_notpos))
</code></pre>


</div>