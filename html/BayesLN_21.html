<div class="container">

<table style="width: 100%;"><tr>
<td>LN_Quant</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian estimate of the log-normal quantiles</h2>

<h3>Description</h3>

<p>This function produces an estimate for the log-normal distribution quantile of fixed level <code>quant</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LN_Quant(
  x,
  quant,
  method = "weak_inf",
  x_transf = TRUE,
  guess_s2 = NULL,
  CI = TRUE,
  alpha_CI = 0.05,
  type_CI = "two-sided",
  method_CI = "exact",
  rel_tol_CI = 1e-05,
  nrep_CI = 1e+06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of data used to estimate the quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Number between 0 and 1 that indicates the quantile of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String that indicates the prior setting to adopt. Choosing <code>"weak_inf"</code>
a weakly informative prior setting is adopted, whereas selecting
<code>"optimal"</code> the hyperparameters are fixed trough a numerical optimization algorithm
aimed at minimizing the frequentist MSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_transf</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the <code>x</code> vector is assumed already log-transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess_s2</code></td>
<td>
<p>Specification of a guess for the variance if available. If not, the sample estimate is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Logical. With the default choice <code>TRUE</code>, the posterior credibility interval is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_CI</code></td>
<td>
<p>Level of alpha that determines the credibility (1-<code>alpha_CI</code>) of the posterior interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_CI</code></td>
<td>
<p>String that indicates the type of interval to compute: <code>"two-sided"</code> (default),
<code>"UCL"</code> (i.e. Upper Credible Limit) for upper one-sided intervals  or <code>"LCL"</code> (i.e. Lower
Credible Limit) for lower one-sided intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_CI</code></td>
<td>
<p>String that indicates if the limits should be computed through the logSMNG
quantile function <code>qlSMNG</code> (option <code>"exact"</code>, default), or by randomly generating a sample
(<code>"simulation"</code>) using the function <code>rlSMNG</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_tol_CI</code></td>
<td>
<p>Level of relative tolerance required for the <code>integrate</code> procedure or for the infinite sum.
Default set to <code>1e-5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep_CI</code></td>
<td>
<p>Number of simulations in case of <code>method="simulation"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function allows to carry out Bayesian inference for the unconditional quantiles of a sample that is assumed log-normally distributed.
</p>
<p>A generalized inverse Gaussian prior is assumed for the variance in the log scale <code class="reqn">\sigma^2</code>, whereas a
flat improper prior is assumed for the mean in the log scale <code class="reqn">\xi</code>.
</p>
<p>Two alternative hyperparamters setting are implemented (choice controlled by the argument <code>method</code>): a weakly
informative proposal and an optimal one.
</p>


<h3>Value</h3>

<p>The function returns the prior parameters and their posterior values, summary statistics of the log-scale parameters and the estimate of the specified quantile:
the posterior mean and variance are provided by default. Moreover, the user can control the computation of posterior intervals.
</p>


<h3>Source</h3>

<p>Gardini, A., C. Trivisano, and E. Fabrizi. <em>Bayesian inference for quantiles of the log-normal distribution.</em> Biometrical Journal (2020).
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BayesLN)
data("EPA09")
# The optimization algorithm might require time:
# LN_Quant(x = EPA09, x_transf = FALSE, quant = 0.95, method = "optimal", CI = FALSE)
LN_Quant(x = EPA09, x_transf = FALSE, quant = 0.95, method = "weak_inf",
        alpha_CI = 0.05, type_CI = "UCL", nrep_CI = 1e3) # increase nrep_CI

</code></pre>


</div>