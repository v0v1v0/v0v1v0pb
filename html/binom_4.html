<div class="container">

<table style="width: 100%;"><tr>
<td>binom.bayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial confidence intervals using Bayesian inference</h2>

<h3>Description</h3>

<p>Uses a beta prior on the probability of success for a binomial
distribution, determines a two-sided confidence interval from a beta
posterior. A plotting function is also provided to show the
probability regions defined by each confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.bayes(x, n,
            conf.level = 0.95,
            type = c("highest", "central"),
            prior.shape1 = 0.5,
            prior.shape2 = 0.5,
            tol = .Machine$double.eps^0.5,
            maxit = 1000, ...)

binom.bayes.densityplot(bayes,
                        npoints = 500,
                        fill.central = "lightgray",
                        fill.lower = "steelblue",
                        fill.upper = fill.lower,
                        alpha = 0.8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of confidence interval (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.shape1</code></td>
<td>
<p>The value of the first shape parameter to be used in the prior beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.shape2</code></td>
<td>
<p>The value of the second shape parameter to be used in the prior beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A tolerance to be used in determining the highest probability density interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations to be used in determining
the highest probability interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bayes</code></td>
<td>
<p>The output <code>data.frame</code> from <code>binom.bayes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>The number of points to use to draw the density
curves. Higher numbers give smoother densities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.central</code></td>
<td>
<p>The color for the central density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.lower,fill.upper</code></td>
<td>
<p>The color(s) for the upper and lower
density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The alpha value for controlling transparency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the conjugate beta prior on the distribution of p (the
probability of success) in a binomial experiment, constructs a
confidence interval from the beta posterior. From Bayes theorem the
posterior distribution of p given the data x is:
</p>
<p><code>p|x ~ Beta(x + prior.shape1, n - x + prior.shape2)</code>
</p>
<p>The default prior is Jeffrey's prior which is a Beta(0.5, 0.5)
distribution. Thus the posterior mean is <code>(x + 0.5)/(n + 1)</code>.
</p>
<p>The default type of interval constructed is "highest" which computes
the highest probability density (hpd) interval which assures the
shortest interval possible. The hpd intervals will achieve a
probability that is within tol of the specified conf.level. Setting
type to "central" constructs intervals that have equal tail
probabilities.
</p>
<p>If 0 or n successes are observed, a one-sided confidence interval is
returned.
</p>


<h3>Value</h3>

<p>For <code>binom.bayes</code>, a <code>data.frame</code> containing the observed
proportions and the lower and upper bounds of the confidence interval.
</p>
<p>For <code>binom.bayes.densityplot</code>, a <code>ggplot</code> object that can
printed to a graphics device, or have additional layers added.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., and Rubin, D. B. (1997)
<em>Bayesian Data Analysis</em>, London, U.K.: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>binom.confint</code>, <code>binom.cloglog</code>,
<code>binom.logit</code>, <code>binom.probit</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Example using highest probability density.
hpd &lt;- binom.bayes(
  x = 0:10, n = 10, type = "highest", conf.level = 0.8, tol = 1e-9)
print(hpd)
binom.bayes.densityplot(hpd)
# Remove the extremes from the plot since they make things hard
# to see.
binom.bayes.densityplot(hpd[hpd$x != 0 &amp; hpd$x != 10, ])

# Example using central probability.
central &lt;- binom.bayes(
  x = 0:10, n = 10, type = "central", conf.level = 0.8, tol = 1e-9)
print(central)
binom.bayes.densityplot(central)
# Remove the extremes from the plot since they make things hard
# to see.
binom.bayes.densityplot(central[central$x != 0 &amp; central$x != 10, ])

</code></pre>


</div>