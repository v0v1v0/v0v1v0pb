<div class="container">

<table style="width: 100%;"><tr>
<td>bm_SRE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Surface Range Envelope</h2>

<h3>Description</h3>

<p>This internal <span class="pkg">biomod2</span> function allows the user to run a rectilinear surface 
range envelop (SRE) (equivalent to 
<a href="https://caws.org.nz/PPQ567/PPQ%2006-1%20pp008-9%20Busby.pdf">BIOCLIM</a>) 
using the extreme percentiles (as recommended by Nix or Busby, see References and Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bm_SRE(
  resp.var = NULL,
  expl.var = NULL,
  new.env = NULL,
  quant = 0.025,
  do.extrem = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resp.var</code></td>
<td>
<p>a <code>vector</code>, a <code>SpatVector</code>
without associated data (<em>if presence-only</em>), 
or a <code>SpatVector</code> object containing binary data  
(<code>0</code> : absence, <code>1</code> : presence, <code>NA</code> : indeterminate) 
for a single species that will be used to build the species distribution model(s)
<br><em>Note that old format from <span class="pkg">sp</span> are still supported such as
<code>SpatialPoints</code>  (if presence-only) or <code>SpatialPointsDataFrame</code>
object containing binary data.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expl.var</code></td>
<td>
<p>a <code>matrix</code>, <code>data.frame</code>, <code>SpatVector</code>
or <code>SpatRaster</code> object containing the explanatory variables (in 
columns or layers) that will be used to build the SRE model
<br><em>Note that old format from <span class="pkg">raster</span> and <span class="pkg">sp</span> are still supported such as 
<code>RasterStack</code> and <code>SpatialPointsDataFrame</code> objects. </em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.env</code></td>
<td>
<p>a <code>matrix</code>, <code>data.frame</code>, <code>SpatVector</code>
or <code>SpatRaster</code> object containing the explanatory variables (in 
columns or layers) that will be used to predict the SRE model
<br><em>Note that old format from <span class="pkg">raster</span> and <span class="pkg">sp</span> are still supported such as 
<code>RasterStack</code> and <code>SpatialPointsDataFrame</code> objects. </em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>a <code>numeric</code> between <code>0</code> and <code>0.5</code> defining the half-quantile 
corresponding to the most extreme value for each variable not to be taken into account for 
determining the tolerance boundaries of the considered species (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.extrem</code></td>
<td>
<p>(<em>optional, default</em> <code>FALSE</code>) <br> 
A <code>logical</code> value defining whether a <code>matrix</code> containing extreme conditions 
supported should be returned or not</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>Please refer to References to get more information about surface range envelop models.</em>
</p>
<p>This method is highly influenced by the extremes of the data input. Whereas a linear model 
can discriminate the extreme values from the main tendency, the SRE considers them as 
important as any other data point leading to changes in predictions. <br><br></p>
<p><em>The more (non-colinear) variables, the more restrictive the model will be.</em> <br><br></p>
<p>Predictions are returned as binary (<code>0</code> or <code>1</code>) values, a site being either 
potentially suitable for all the variables, or out of bounds for at least one variable and 
therefore considered unsuitable. <br><br></p>
<p><code>quant</code> determines the threshold from which the data will be taken into account for 
calibration. The default value of <code>0.05</code> induces that the <code>5%</code> most extreme values 
will be avoided for each variable on each side of its distribution along the gradient, meaning 
that a total of <code>10%</code> of the data will not be considered.
</p>


<h3>Value</h3>

<p>A <code>vector</code> or a <code>SpatRaster</code> object, containing binary 
(<code>0</code> or <code>1</code>) values.
</p>


<h3>Author(s)</h3>

<p>Wilfried Thuiller, Bruno Lafourcade, Damien Georges
</p>


<h3>References</h3>


<ul>
<li>
<p> Nix, H.A., 1986. A biogeographic analysis of Australian elapid snakes. In: 
<em>Atlas of Elapid Snakes of Australia.</em> (Ed.) R. Longmore, pp. 4-15. 
<b>Australian Flora and Fauna Series Number 7.</b> 
Australian Government Publishing Service: Canberra.
</p>
</li>
<li>
<p> Busby, Jeremy. BIOCLIM - a bioclimate analysis and prediction system. 
<em>Plant protection quarterly</em> <b>6</b> (1991): 8-9.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>bm_PseudoAbsences</code>, <code>BIOMOD_FormatingData</code>, 
<code>bm_ModelingOptions</code>, <code>bm_Tuning</code>, 
<code>bm_RunModelsLoop</code>, <code>BIOMOD_Modeling</code>,
</p>
<p>Other Secundary functions: 
<code>bm_BinaryTransformation()</code>,
<code>bm_CrossValidation()</code>,
<code>bm_FindOptimStat()</code>,
<code>bm_MakeFormula()</code>,
<code>bm_ModelingOptions()</code>,
<code>bm_PlotEvalBoxplot()</code>,
<code>bm_PlotEvalMean()</code>,
<code>bm_PlotRangeSize()</code>,
<code>bm_PlotResponseCurves()</code>,
<code>bm_PlotVarImpBoxplot()</code>,
<code>bm_PseudoAbsences()</code>,
<code>bm_RunModelsLoop()</code>,
<code>bm_SampleBinaryVector()</code>,
<code>bm_SampleFactorLevels()</code>,
<code>bm_Tuning()</code>,
<code>bm_VariablesImportance()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(terra)
## Load real data
data(DataSpecies)
myResp.r &lt;- as.numeric(DataSpecies[, 'GuloGulo'])

data(bioclim_current)
myExpl.r &lt;- rast(bioclim_current)

myRespXY &lt;- DataSpecies[which(myResp.r == 1), c('X_WGS84', 'Y_WGS84')]
myResp.v &lt;- classify(subset(myExpl.r, 1), 
                     matrix(c(-Inf, Inf, 0), ncol = 3, byrow = TRUE))
myResp.v[cellFromXY(myResp.v, myRespXY)] &lt;- 1

## Compute SRE for several quantile values
sre.100 &lt;- bm_SRE(resp.var = myResp.v,
                  expl.var = myExpl.r,
                  new.env = myExpl.r,
                  quant = 0)
sre.095 &lt;- bm_SRE(resp.var = myResp.v,
                  expl.var = myExpl.r,
                  new.env = myExpl.r,
                  quant = 0.025)
sre.090 &lt;- bm_SRE(resp.var = myResp.v,
                  expl.var = myExpl.r,
                  new.env = myExpl.r,
                  quant = 0.05)

## Visualize results
res &lt;- c(myResp.v, sre.100, sre.095, sre.090)
names(res) &lt;- c("Original distribution", "Full data calibration"
                , "Over 95 percent", "Over 90 percent")
plot(res)


</code></pre>


</div>