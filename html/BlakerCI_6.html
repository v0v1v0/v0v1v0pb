<div class="container">

<table style="width: 100%;"><tr>
<td>binom.blaker.VHadj.acc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Blaker's binomial acceptability function with Vos-Hudson adjustment.

</h2>

<h3>Description</h3>

<p>Calculates  values of the Vos-Hudson adjusted acceptability function
in a sequence of points (for, e.g., plotting purposes).
The adjusted acceptability function may optionally be 
“unimodalized”, i.e. replaced with the smallest
greater or equal unimodal function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.blaker.VHadj.acc(x, n, p, type = c("orig", "unimod"),
      acc.tol = 1e-10, nmax=n+1000,int.eps=1e-12, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>number of successes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of trials.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector (length 1 allowed) of hypothesized binomial parameters
(between 0 and 1).
In case of more than one point, an increasing sequence required. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>for <code>type = "orig"</code>, Vos-Hudson adjustment applied to 
original acceptability function.
For <code>type = "unimod"</code>, smallest unimodal function
greater or equal to the adjusted acceptability function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc.tol</code></td>
<td>

<p>numerical tolerance (relevant only for <code>type = "unimod"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>

<p>Pairs <code>(y, m)</code> of number of trials and number of successes 
are allowed to contribute to the Vos-Hudson adjustment for only
<code>m</code> up to <code>nmax</code>. Warning is returned when greater
numbers of trials are suspected to have influence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.eps</code></td>
<td>

<p>Maximum expected error of machine representation of integers
calculated from reals via multiplication and division.
(Used in order to round numbers correctly if they happen
to be integer, e. g.
<code>ceiling(xx - int.eps)</code> is calculated instead of 
<code>ceiling(xx)</code>.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>binom.blaker.acc.single.p</code>;
in fact, just <code>maxiter</code> (see <code>BlakerCI-internal</code>). 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The relationship between the adjusted acceptability function 
and the adjusted confidence intervals 
(see <code>binom.blaker.VHadj.limits</code>)
is the same as between the unadjusted acceptability function
and confidence interval (see <code>binom.blaker.acc</code>,
<code>binom.blaker.limits</code>): The confidence interval is the
convex hull of the set of those points where the function
exceeds 1 - confidence level. 
</p>


<h3>Value</h3>

<p>Vector of Vos-Hudson adjusted acceptability values (with or without unimodalization) in points of <code>p</code>.
</p>


<h3>Warning</h3>

<p>(1) Comparing output of the function with that of 
<code>binom.blaker.acc</code> cannot answer positively the question 
whether the unadjusted and adjusted functions are identical 
on an interval (but, up to the numerical accuracy, in the points 
of <code>p</code> only).
</p>
<p>(2) The Warning section of the <code>binom.blaker.VHadj.limits</code>
documentation is relevant here, as well.
</p>


<h3>Author(s)</h3>

<p>Jan Klaschka <a href="mailto:klaschka@cs.cas.cz">klaschka@cs.cas.cz</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;- seq(0,1,length=10001)
acc.adj &lt;- binom.blaker.VHadj.acc(6,13,p)
acc &lt;- binom.blaker.acc(6,13,p)

plot(p,acc.adj,type="l",col="red",ylab="acceptability"
  ,main=paste("Vos-Hudson adjustment of acceptability function"
  ,"for 6 successes in 13 trials"
  , sep="\n")
)
lines(p,acc,type="l")
legend(x=.7,y=.8,c("unadjusted","adjustment"),col=c("black","red"),lwd=1)

## Plot of differences between the unadjusted and adjusted
## acceptability functions reveals some adjustment details
## hardly visible in the previous graph. 

plot(p,acc.adj-acc,type="l",ylab="acceptability difference")

## The narrow peak near 0.215 is close to the 
## Blaker's lower 0.95 confidence limit.
## 
## Focussing on the neighbourhood of 0.215:

p &lt;- seq(0.21,0.22,length=1001)
acc.adj &lt;- binom.blaker.VHadj.acc(6,13,p)
acc &lt;- binom.blaker.acc(6,13,p)

plot(p,acc.adj,type="l",col="red",ylab="acceptability"
  ,main=paste("A detail of Vos-Hudson adjustment of acceptability function"
  ,"for 6 successes in 13 trials"
  ,sep="\n")
  ,ylim=c(0.02,0.09)
)
lines(p,acc,type="l")
legend(x=.210,y=.08,c("unadjusted","adjustment"),col=c("black","red"),lwd=1)

## The above adjustment results from the fact that, though
## 15 &gt; 13 and 7/15 &gt; 6/13, the acceptability function
## for 7 successes in 15 trials is greater that that for 6 successes
## in 13 trials on a short interval:

acc.7.15 &lt;- binom.blaker.acc(7,15,p)
plot(p,acc,type="l",ylab="acceptability"
  ,main=paste("A detail of acceptability functions"
  ,sep="\n")
  ,ylim=c(0.02,0.09)
)
lines(p,acc.7.15,type="l",col="green")
legend(x=.210,y=.08,c("6 / 13","7 / 15"),col=c("black","green")
  ,title="succ / trials",lwd=1)

## The adjustment shifts the point where the 0.05 level is exceeded,
## i. e. the Blaker's lower 0.95 confidence limit, from 0.2158 to 0.2150. 
## (Compare with Examples in binom.blaker.VHadj.limits section.)
</code></pre>


</div>