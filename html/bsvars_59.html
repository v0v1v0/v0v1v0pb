<div class="container">

<table style="width: 100%;"><tr>
<td>normalise_posterior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Waggoner &amp; Zha (2003) row signs normalisation of the posterior draws for matrix <code class="reqn">B</code>
</h2>

<h3>Description</h3>

<p>Normalises the sign of rows of matrix <code class="reqn">B</code> MCMC draws, 
provided as the first argument <code>posterior_B</code>, relative to matrix
<code>B_hat</code>, provided as the second argument of the function. The implemented
procedure proposed by Waggoner, Zha (2003) normalises the MCMC output in an
optimal way leading to the unimodal posterior. Only normalised MCMC output is 
suitable for the computations of the posterior characteristics of the <code class="reqn">B</code>
matrix elements and their functions such as the impulse response functions and other 
economically interpretable values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normalise_posterior(posterior, B_hat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>posterior estimation outcome - an object of either of classes: 
PosteriorBSVAR, PosteriorBSVARMSH, PosteriorBSVARMIX, or PosteriorBSVARSV
containing, amongst other draws, the <code>S</code> draws from the posterior 
distribution of the <code>NxN</code> matrix of contemporaneous relationships <code class="reqn">B</code>. 
These draws are to be normalised with respect to:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_hat</code></td>
<td>
<p>an <code>NxN</code> matrix specified by the user to have the desired row signs</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Nothing. The normalised elements overwrite the corresponding elements of 
the first argument <code>posterior_B</code> by reference.
</p>


<h3>Author(s)</h3>

<p>Tomasz Woźniak <a href="mailto:wozniak.tom@pm.me">wozniak.tom@pm.me</a>
</p>


<h3>References</h3>

<p>Waggoner, D.F., and Zha, T., (2003) Likelihood Preserving Normalization in Multiple Equation Models. 
<em>Journal of Econometrics</em>, <b>114</b>(2), 329–47, <a href="https://doi.org/10.1016/S0304-4076%2803%2900087-3">doi:10.1016/S0304-4076(03)00087-3</a>.
</p>


<h3>See Also</h3>

<p><code>estimate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># upload data
data(us_fiscal_lsuw)

# specify the model and set seed
specification  = specify_bsvar_sv$new(us_fiscal_lsuw, p = 4)
set.seed(123)

# run the burn-in
burn_in        = estimate(specification, 10)

# estimate the model
posterior      = estimate(burn_in, 10, thin = 1)

# normalise the posterior
BB            = posterior$last_draw$starting_values$B      # get the last draw of B
B_hat         = diag((-1) * sign(diag(BB))) %*% BB         # set negative diagonal elements
normalise_posterior(posterior, B_hat)                      # draws in posterior are normalised

</code></pre>


</div>