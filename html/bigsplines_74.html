<div class="container">

<table style="width: 100%;"><tr>
<td>ssBasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Smoothing Spline Basis for Polynomial Splines
</h2>

<h3>Description</h3>

<p>Generate the smoothing spline basis matrix for a polynomial spline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssBasis(x, knots, m=2, d=0, xmin=min(x), xmax=max(x), periodic=FALSE, intercept=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Predictor variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>

<p>Spline knots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>Penalty order. 'm=1' for linear smoothing spline, 'm=2' for cubic, and 'm=3' for quintic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>Derivative order. 'd=0' for smoothing spline basis, 'd=1' for 1st derivative of basis, and 'd=2' for 2nd derivative of basis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>

<p>Minimum value of 'x'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>

<p>Maximum value of 'x'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>

<p>If <code>TRUE</code>, the smoothing spline basis is periodic w.r.t. the interval [<code>xmin</code>, <code>xmax</code>].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>If <code>TRUE</code>, the first column of the basis will be a column of ones.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Spline Basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Spline knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Penalty order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Derivative order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Inputs <code>xmin</code> and <code>xmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>
<p>Same as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Same as input.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Inputs <code>x</code> and <code>knots</code> should be within the interval [<code>xmin</code>, <code>xmax</code>].
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Gu, C. (2013). <em>Smoothing spline ANOVA models, 2nd edition</em>. New York: Springer.
</p>
<p>Helwig, N. E. (2013). <em>Fast and stable smoothing spline analysis of variance models for large samples with applications to electroencephalography data analysis</em>. Unpublished doctoral dissertation. University of Illinois at Urbana-Champaign.
</p>
<p>Helwig, N. E. (2017). <a href="http://dx.doi.org/10.3389/fams.2017.00015">Regression with ordered predictors via ordinal smoothing splines</a>. Frontiers in Applied Mathematics and Statistics, 3(15), 1-13.
</p>
<p>Helwig, N. E. and Ma, P. (2015). Fast and stable multiple smoothing parameter selection in smoothing spline analysis of variance models with large samples. <em>Journal of Computational and Graphical Statistics, 24</em>, 715-732.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##########   EXAMPLE   ##########

# define function and its derivatives
n &lt;- 500
x &lt;- seq(0, 1, length.out=n)
knots &lt;- seq(0, 1, length=20)
y &lt;- sin(4 * pi * x)
d1y &lt;- 4 * pi * cos(4 * pi * x)
d2y &lt;- - (4 * pi)^2 * sin(4 * pi * x)

# linear smoothing spline
linmat0 &lt;- ssBasis(x, knots, m=1)
lincoef &lt;- pinvsm(crossprod(linmat0$X)) %*% crossprod(linmat0$X, y)
linyhat &lt;- linmat0$X %*% lincoef
linmat1 &lt;- ssBasis(x, knots, m=1, d=1)
linyd1 &lt;- linmat1$X %*% lincoef

# plot linear smoothing spline results
par(mfrow=c(1,2))
plot(x, y, type="l", main="Function")
lines(x, linyhat, lty=2, col="red")
plot(x, d1y, type="l", main="First Derivative")
lines(x, linyd1, lty=2, col="red")

# cubic smoothing spline
cubmat0 &lt;- ssBasis(x, knots)
cubcoef &lt;- pinvsm(crossprod(cubmat0$X)) %*% crossprod(cubmat0$X, y)
cubyhat &lt;- cubmat0$X %*% cubcoef
cubmat1 &lt;- ssBasis(x, knots, d=1)
cubyd1 &lt;- cubmat1$X %*% cubcoef
cubmat2 &lt;- ssBasis(x, knots, d=2)
cubyd2 &lt;- cubmat2$X %*% cubcoef

# plot cubic smoothing spline results
par(mfrow=c(1,3))
plot(x, y, type="l", main="Function")
lines(x, cubyhat, lty=2, col="red")
plot(x, d1y, type="l", main="First Derivative")
lines(x, cubyd1, lty=2, col="red")
plot(x, d2y, type="l", main="Second Derivative")
lines(x, cubyd2, lty=2, col="red")

# quintic smoothing spline
quimat0 &lt;- ssBasis(x, knots, m=3)
quicoef &lt;- pinvsm(crossprod(quimat0$X)) %*% crossprod(quimat0$X, y)
quiyhat &lt;- quimat0$X %*% quicoef
quimat1 &lt;- ssBasis(x, knots, m=3, d=1)
quiyd1 &lt;- quimat1$X %*% quicoef
quimat2 &lt;- ssBasis(x, knots, m=3, d=2)
quiyd2 &lt;- quimat2$X %*% quicoef

# plot quintic smoothing spline results
par(mfrow=c(1,3))
plot(x, y, type="l", main="Function")
lines(x, quiyhat, lty=2, col="red")
plot(x, d1y, type="l", main="First Derivative")
lines(x, quiyd1, lty=2, col="red")
plot(x, d2y, type="l", main="Second Derivative")
lines(x, quiyd2, lty=2, col="red")

</code></pre>


</div>