<div class="container">

<table style="width: 100%;"><tr>
<td>tfr.map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
TFR World Map 
</h2>

<h3>Description</h3>

<p>Generate world maps of the total fertility rate for given projection period and quantile, using different techniques: <code>tfr.map</code> and <code>tfr.map.all</code> use <span class="pkg">rworldmap</span>, <code>tfr.ggmap</code> uses <span class="pkg">ggplot2</span>, and <code>tfr.map.gvis</code> creates an interactive map via <span class="pkg">GoogleVis</span>. In addition to TFR, all these functions allow to project country specific Phase II MCMC parameters into the world maps. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">tfr.map(pred, quantile = 0.5, 
    year = NULL, par.name = NULL, adjusted = FALSE,
    projection.index = 1, device = "dev.new", main = NULL, 
    resolution=c("coarse","low","less islands","li","high"),
    device.args = NULL, data.args = NULL, ...)

tfr.ggmap(pred, quantile = 0.5, 
    year = NULL, par.name = NULL, adjusted = FALSE,
    projection.index = 1, main = NULL, data.args = NULL, 
    viridis.option = "B", nr.cats = 10, same.scale = FALSE, 
    plot = TRUE, file.name = NULL, plot.size = 4, ...)
    
tfr.map.gvis(pred, year = NULL, quantile = 0.5, pi = 80, 
    par.name = NULL, adjusted = FALSE, ...)
    
tfr.map.all(pred, output.dir, output.type = "png", 
    tfr.range = NULL, nr.cats = 50, same.scale = TRUE, 
    quantile = 0.5, file.prefix='TFRwrldmap_', ...)
			
get.tfr.map.parameters(pred, tfr.range = NULL, 
    nr.cats = 50, same.scale = TRUE, quantile = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Object of class <code>bayesTFR.prediction</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>Quantile for which the map should be generated. It must be equal to one of the values in <code>dimnames(pred$quantiles[[2]])</code>, i.e. 0, 0.025, 0.05, 0.1, 0.2, 0.25, 0.3, 0.4, 0.5, 0.6, 0.7, 0.75, 0.8, 0.9, 0.95, 0.975, 1. Value 0.5 corresponds to the median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Year to be plotted. It can be a year within a projection period or a year within an estimation period. In the latter case, the observed data are plotted. If not given, <code>projection.index</code> determines the projection year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.name</code></td>
<td>
<p>Name of a country-specific parameter to be plotted. If <code>NULL</code>, the TFR is plotted. Allowed values are any of those returned by <code>tfr.parameter.names.cs.extended()</code> and ‘lambda’ (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjusted</code></td>
<td>
<p>Logical indicating if the measure to be plotted is based on adjusted TFRs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projection.index</code></td>
<td>
<p>Index of the projection to be displayed. It is only relevant if <code>year</code> is <code>NULL</code>. <code>projection.index=1</code> means the present year, <code>projection.index=2</code> means the first projection period after present year, etc..
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>
<p>Device for displaying the map. It is passed to the <code>mapDevice</code> function of the <span class="pkg">rworldmap</span> package. If it is equal to ‘dev.cur’, the current device is used. Otherwise, it can be ‘dev.new’, ‘png’, ‘pdf’ etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Title for the map. If it is <code>NULL</code>, a default title is constructed from the projection year and quantile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>Map resolution as implemented in <code>getMap</code>. High resolution requires the <span class="pkg">rworldxtra</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device.args</code></td>
<td>
<p>List of 
additional arguments to be passed to the <code>mapDevice</code> function of the <span class="pkg">rworldmap</span> package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.args</code></td>
<td>
<p>List of additional arguments to be passed to the underlying data retrieving function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis.option</code></td>
<td>
<p>Argument <code>option</code> passed to the <code>ggplot2::scale_fill_viridis_c</code> function indicating the colormap. Available are ‘magma’ (or ‘A’), ‘inferno’ (or ‘B’, default), ‘plasma’ (or ‘C’), ‘viridis’ (or ‘D’) and ‘cividis’ (or ‘E’).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr.cats</code></td>
<td>
<p>Number of color categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.scale</code></td>
<td>
<p>Logical controlling if maps for all projection years of this prediction object should be on the same color scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical indicating if a plot should be shown. If <code>FALSE</code>, the function only returns the ggplot object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>
<p>Name of a file to save the plot. If <code>NULL</code> nothing is saved. The type of the file is determined by its extension. Only used if <code>plot</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.size</code></td>
<td>
<p>Height of the plotting device in inches. The width is automatically set using the aspect ratio of 2.36. Only used if <code>plot</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.dir</code></td>
<td>
<p>Directory into which resulting maps are stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.type</code></td>
<td>
<p>Type of the resulting files. It can be “png”, “pdf”, “jpeg”, “bmp”, “tiff”, or “postscript”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tfr.range</code></td>
<td>
<p>Range of the total fertility rate to be displayed. It is of the form <code>c(</code><var>tfr.min</var>, <var>tfr.max</var><code>)</code>.
By default, the whole range is considered. Note that countries with values outside of the given range will appear white.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.prefix</code></td>
<td>
<p>Prefix for file names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed to the <code>mapCountryData</code> function of the <span class="pkg">rworldmap</span> package. In case of <code>tfr.map.gvis</code> these are passed to the underlying data retrieving function (the same as <code>data.args</code>). In case of <code>tfr.ggmap</code> which uses <span class="pkg">ggplot2</span> they are passed to the <code>geom_sf</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>Probability interval to be shown when a country is selected in an interactive map. The corresponding quantiles must be available (see argument <code>quantile</code> above).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>tfr.map</code> creates a single map for a given projection period and quantile using the <span class="pkg">rworldmap</span> package. <code>tfr.map.all</code> generates a sequence of such maps, namely one for each projection period. If the package <span class="pkg">fields</span> is installed, a color bar legend at the botom of the map is created.
</p>
<p>Function <code>get.tfr.map.parameters</code> can be used in combination with <code>tfr.map</code>. (Note that <code>get.tfr.map.parameters</code> is called from inside of <code>tfr.map.all</code>.) It sets breakpoints for the color scheme using quantiles of a fitted gamma distribution.
</p>
<p>Function <code>tfr.ggmap</code> is similar to <code>tfr.map</code>, but used the <span class="pkg">ggplot2</span> package in combination with the <code>geom_sf</code> function.
</p>
<p>Function <code>tfr.map.gvis</code> creates an interactive map using the <span class="pkg">googleVis</span> package and opens it in an internet browser. It also generates a table of TFRs that can be sorted by columns interactively in the browser. 
</p>
<p>By default, <code>tfr.map</code>, <code>tfr.ggmap</code> and <code>tfr.map.gvis</code> produce maps of TFRs. Alternatively, the functions can be used to plot country-specific Phase II MCMC parameters into a world map. They are given by the argument <code>par.name</code>. In addition to the MCMC parameters, if <code>par.name='lambda'</code>, the period of the end of TFR decline (i.e. start of Phase III) is computed for each country and projected into the map. In such a case, for <code>tfr.map</code> we recommend to adjust the color scale in <code>tfr.map</code> e.g. using the arguments <code>catMethod='pretty'</code> and <code>numCats=20</code> (see <code>mapCountryData</code>). 
</p>


<h3>Value</h3>

<p><code>get.tfr.map.parameters</code> returns a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>The object of class <code>bayesTFR.prediction</code> used in the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>Value of the argument <code>quantile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catMethod</code></td>
<td>
<p>If the argument <code>same.scale</code> is <code>TRUE</code>, this element contains breakpoints for categorization. It is generated from a fitted gamma distribution. Otherwise, it is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCats</code></td>
<td>
<p>Number of categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coulourPalette</code></td>
<td>
<p>Subset of the rainbow palette, starting from dark blue and ending at red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hana Sevcikova, Patrick Gerland, Adrian Raftery
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
sim.dir &lt;- file.path(find.package("bayesTFR"), "ex-data", "bayesTFR.output")
pred &lt;- get.tfr.prediction(sim.dir=sim.dir)

# Using ggplot2
tfr.ggmap(pred)
tfr.ggmap(pred, year = 2100)

# Using rworldmap
# Uses heat colors and seven categories by default
tfr.map(pred)
# Uses more colors with more suitable categorization
params &lt;- get.tfr.map.parameters(pred)
do.call("tfr.map", params)
# Another projection year on the same scale
do.call("tfr.map", c(list(year=2043), params))

# Using Google Vizualization tool
tfr.map.gvis(pred)

## End(Not run)
</code></pre>


</div>