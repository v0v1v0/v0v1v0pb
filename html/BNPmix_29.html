<div class="container">

<table style="width: 100%;"><tr>
<td>DDPdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC for GM-dependent Dirichlet process mixtures of Gaussians</h2>

<h3>Description</h3>

<p>The <code>DDPdensity</code> function generates posterior density samples for a univariate Griffiths-Milne dependent Dirichlet process mixture model with Gaussian
kernel, for partially exchangeable data. The function implements the importance conditional sampler method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DDPdensity(y, group, mcmc = list(), prior = list(), output = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector or matrix giving the data based on which densities are to be estimated;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>vector of length <code>length(y)</code> containing the group labels (integers)
for the elements of <code>y</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>list of MCMC arguments:
</p>

<ul>
<li> <p><code>niter</code>  (mandatory), number of iterations.
</p>
</li>
<li> <p><code>nburn</code>  (mandatory),  number of iterations to discard as burn-in.
</p>
</li>
<li> <p><code>nupd</code>, argument controlling the number of iterations to be displayed on screen: the function reports
on standard output every time <code>nupd</code> new iterations have been carried out (default is <code>niter/10</code>).
</p>
</li>
<li> <p><code>print_message</code>, control option. If equal to <code>TRUE</code>, the status is printed
to standard output every <code>nupd</code> iterations (default is <code>TRUE</code>).
</p>
</li>
<li> <p><code>m_imp</code>, number of generated values for the importance sampling step of the
importance conditional sampler (default is 10). See <code>details</code>.
</p>
</li>
<li> <p><code>var_MH_step</code>, variance of the Gaussian proposal for the Metropolis-Hastings of the weights update (default is 0.25).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list giving the prior information, which contains:
</p>

<ul>
<li> <p><code>strength</code>, the strength parameter, or total mass, of the marginal Dirichlet processes (default 1);
</p>
</li>
<li> <p><code>m0</code>, mean of the normal base measure on the location parameter (default is the sample mean of the data);
</p>
</li>
<li> <p><code>k0</code>, scale factor appearing in the normal base measure on the location parameter (default 1);
</p>
</li>
<li> <p><code>a0</code>, shape parameter of the inverse gamma base measure on the scale parameter (default 2);
</p>
</li>
<li> <p><code>b0</code>, scale parameter of the inverse gamma base measure on the scale parameter (default is the sample variance of the data);
</p>
</li>
<li> <p><code>wei</code>, parameter controlling the strength of dependence across Dirichlet processes (default 1/2).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>a list of arguments for generating posterior output. It contains:
</p>

<ul>
<li> <p><code>grid</code>, a grid of points at which to evaluate the estimated posterior mean densities (common for all the groups).
</p>
</li>
<li> <p><code>out_type</code>, if <code>out_type = "FULL"</code>, return the estimated partitions and the realizations of the posterior density for each iterations. If <code>out_type = "MEAN"</code>, return
the estimated partitions and the mean of the densities sampled at each iterations. If <code>out_type = "CLUST"</code>, return the estimated partitions. Default <code>out_type = "FULL"</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a Griffiths-Milne dependent Dirichlet process (GM-DDP) mixture
for density estimation for partially exchangeable data (Lijoi et al., 2014).
For each observation the <code>group</code> variable allows the observations to be gathered
into <code class="reqn">L</code>=<code>length(unique(group))</code> distinct groups.
The model assumes exchangeability within each group, with observations in the <code class="reqn">l</code>th group marginally
modelled by a location-scale Dirichlet process mixtures, i.e.
</p>
<p style="text-align: center;"><code class="reqn">\tilde f_l(y) = \int \phi(y; \mu, \sigma^2) \tilde p_l (d \mu, d \sigma^2)</code>
</p>

<p>where each <code class="reqn">\tilde p_l</code> is a Dirichlet process with total mass <code>strength</code> and base measure <code class="reqn">P_0</code>.
The vector <code class="reqn">\tilde p = (\tilde p_1,\ldots,\tilde p_L)</code> is assumed to be jointly distributed as a vector of
GM-DDP(<code>strength</code>, <code>wei</code>;  <code class="reqn">P_0</code>), where <code>strength</code> and
<code class="reqn">P_0</code> are the total mass parameter and the base measure of each <code class="reqn">\tilde p_l</code>, and <code>wei</code>
controls the dependence across the components of
<code class="reqn">\tilde p</code>. Admissible values for <code>wei</code> are in <code class="reqn">(0,1)</code>, with the two extremes of the range
corresponding to full exchangeability (<code>wei</code><code class="reqn">\rightarrow 0</code>)
and  independence across groups (<code>wei</code><code class="reqn">\rightarrow 1</code>).
</p>
<p><code class="reqn">P_0</code> is a normal-inverse gamma base measure, i.e.
</p>
<p style="text-align: center;"><code class="reqn">P_0(d\mu,d\sigma^2) = N(d \mu; m_0, \sigma^2 / k_0) \times IGa(d \sigma^2; a_0, b_0).</code>
</p>

<p>Posterior sampling is obtained by implementing the importance conditional sampler (Canale et al., 2019).
See Corradin et al. (to appear) for more details.
</p>


<h3>Value</h3>

<p>A <code>BNPdensity</code> class object containing the estimated densities for each iteration,
the allocations for each iteration; the grid used to evaluate the densities (for each group); the
densities sampled from the posterior distribution (for each group); the groups; the weights of the processes.
The function returns also informations regarding the estimation: the number of iterations, the number
of burn-in iterations and the execution time.
</p>


<h3>References</h3>

<p>Lijoi, A., Nipoti, B., and Pruenster, I. (2014). Bayesian inference with
dependent normalized completely random measures. Bernoulli 20, 1260â€“1291, doi:10.3150/13-BEJ521
</p>
<p>Canale, A., Corradin, R., &amp; Nipoti, B. (2019). Importance conditional sampling for
Bayesian nonparametric mixtures. arXiv preprint arXiv:1906.08147
</p>
<p>Corradin, R., Canale, A., Nipoti, B. (2021), BNPmix: An R Package for Bayesian Nonparametric Modeling via Pitman-Yor Mixtures,
Journal of Statistical Software, doi:10.18637/jss.v100.i15
</p>


<h3>Examples</h3>

<pre><code class="language-R">data_toy &lt;- c(rnorm(50, -4, 1), rnorm(100, 0, 1), rnorm(50, 4, 1))
group_toy &lt;- c(rep(1,100), rep(2,100))
grid &lt;- seq(-7, 7, length.out = 50)
est_model &lt;- DDPdensity(y = data_toy, group = group_toy,
mcmc = list(niter = 200, nburn = 100, var_MH_step = 0.25),
output = list(grid = grid))
summary(est_model)
plot(est_model)

</code></pre>


</div>