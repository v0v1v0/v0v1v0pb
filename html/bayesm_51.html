<div class="container">

<table style="width: 100%;"><tr>
<td>rmvpGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler for Multivariate Probit</h2>

<h3>Description</h3>

<p><code>rmvpGibbs</code> implements the Edwards/Allenby Gibbs Sampler for the multivariate probit model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmvpGibbs(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(y, X, p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(betabar, A, nu, V)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint, beta0 ,sigma0)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">w_i = X_i\beta + e</code> with <code class="reqn">e</code> <code class="reqn">\sim</code> N(0,<code class="reqn">\Sigma</code>). Note: <code class="reqn">w_i</code> is <code class="reqn">p x 1</code>. <br><code class="reqn">y_{ij} = 1</code> if <code class="reqn">w_{ij} &gt; 0</code>, else <code class="reqn">y_i = 0</code>.  <code class="reqn">j = 1, \ldots, p</code> <br></p>
<p>beta and Sigma are not identifed. Correlation matrix and the betas divided by the appropriate standard deviation are. 
See reference or example below for details.
</p>
<p><code class="reqn">\beta</code>  <code class="reqn">\sim</code> <code class="reqn">N(betabar, A^{-1})</code> <br><code class="reqn">\Sigma</code> <code class="reqn">\sim</code> <code class="reqn">IW(nu, V)</code> <br></p>
<p>To make <code class="reqn">X</code> matrix use <code>createX</code>
</p>



<h4>Argument Details</h4>

<p><em><code>Data  = list(y, X, p)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>X:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n*p x k</code> Design Matrix </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>y:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n*p x 1</code> vector of 0/1 outcomes </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>p:       </code> </td>
<td style="text-align: left;"> dimension of multivariate probit
    </td>
</tr>
</table>
<p><em><code>Prior = list(betabar, A, nu, V)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>betabar: </code> </td>
<td style="text-align: left;"> <code class="reqn">k x 1</code> prior mean (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>A:       </code> </td>
<td style="text-align: left;"> <code class="reqn">k x k</code> prior precision matrix (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nu:      </code> </td>
<td style="text-align: left;"> d.f. parameter for Inverted Wishart prior (def: (p-1)+3) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>V:       </code> </td>
<td style="text-align: left;"> PDS location parameter for Inverted Wishart prior (def: nu*I) 
    </td>
</tr>
</table>
<p><em><code>Mcmc  = list(R, keep, nprint, beta0 ,sigma0)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:       </code> </td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:    </code> </td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint:  </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>beta0:   </code> </td>
<td style="text-align: left;"> initial value for beta </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sigma0:  </code> </td>
<td style="text-align: left;"> initial value for sigma
    </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betadraw  </code></td>
<td>
<p><code class="reqn">R/keep x k</code> matrix of betadraws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmadraw </code></td>
<td>
<p><code class="reqn">R/keep x p*p</code> matrix of sigma draws â€“ each row is the vector form of sigma</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p>For further discussion, see Chapter 4, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>See Also</h3>

 <p><code>rmnpGibbs</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=2000} else {R=10}
set.seed(66)

simmvp = function(X, p, n, beta, sigma) {
  w = as.vector(crossprod(chol(sigma),matrix(rnorm(p*n),ncol=n))) + X%*%beta
  y = ifelse(w&lt;0, 0, 1)
  return(list(y=y, X=X, beta=beta, sigma=sigma))
}

p = 3
n = 500
beta = c(-2,0,2)
Sigma = matrix(c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), ncol=3)
k = length(beta)
I2 = diag(rep(1,p))
xadd = rbind(I2)
for(i in 2:n) { xadd=rbind(xadd,I2) }
X = xadd

simout = simmvp(X,p,500,beta,Sigma)

Data1 = list(p=p, y=simout$y, X=simout$X)
Mcmc1 = list(R=R, keep=1)

out = rmvpGibbs(Data=Data1, Mcmc=Mcmc1)

ind = seq(from=0, by=p, length=k)
inda = 1:3
ind = ind + inda
cat(" Betadraws ", fill=TRUE)
betatilde = out$betadraw / sqrt(out$sigmadraw[,ind])
attributes(betatilde)$class = "bayesm.mat"
summary(betatilde, tvalues=beta/sqrt(diag(Sigma)))

rdraw = matrix(double((R)*p*p), ncol=p*p)
rdraw = t(apply(out$sigmadraw, 1, nmat))
attributes(rdraw)$class = "bayesm.var"
tvalue = nmat(as.vector(Sigma))
dim(tvalue) = c(p,p)
tvalue = as.vector(tvalue[upper.tri(tvalue,diag=TRUE)])
cat(" Draws of Correlation Matrix ", fill=TRUE)
summary(rdraw, tvalues=tvalue)

## plotting examples
if(0){plot(betatilde, tvalues=beta/sqrt(diag(Sigma)))}
</code></pre>


</div>