<div class="container">

<table style="width: 100%;"><tr>
<td>dccm.enma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Cross-Correlation for Ensemble NMA (eNMA) </h2>

<h3>Description</h3>

<p>Calculate the cross-correlation matrices from an ensemble of NMA
objects. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'enma'
dccm(x, ncore = NULL, na.rm=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an object of class <code>enma</code> as obtained from
function <code>nma.pdbs</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore </code></td>
<td>
<p> number of CPU cores used to do the calculation.
<code>ncore&gt;1</code> requires package ‘parallel’ installed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm </code></td>
<td>
<p> logical, if FALSE the DCCM might containt NA values
(applies only when the <code>enma</code> object is calculated with
argument ‘rm.gaps=FALSE’). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments passed to <code>dccm.nma</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper function for calling <code>dccm.nma</code> on a collection
of ‘nma’ objects as obtained from function <code>nma.pdbs</code>.
</p>
<p>See examples for more details.
</p>


<h3>Value</h3>

<p>Returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>all.dccm </code></td>
<td>
<p> an array or list containing the correlation matrices
for each ‘nma’ object. An array is returned when the
‘enma’ object is calculated with ‘rm.gaps=TRUE’, and a
list is used when ‘rm.gaps=FALSE’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avg.dccm </code></td>
<td>
<p> a numeric matrix containing the average correlation
matrix. The average is only calculated when the ‘enma’ object
is calculated with ‘rm.gaps=TRUE’. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Lars Skjaerven </p>


<h3>References</h3>

<p>Wynsberghe. A.W.V, Cui, Q. <em>Structure</em> <b>14</b>, 1647–1653.
Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>


<h3>See Also</h3>

 <p><code>nma</code>, <code>dccm.nma</code>, <code>plot.dccm</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
## Needs MUSCLE installed - testing excluded

if(check.utility("muscle")) {

## Fetch PDB files and split to chain A only PDB files
ids &lt;- c("1a70_A", "1czp_A", "1frd_A", "1fxi_A", "1iue_A", "1pfd_A")
files &lt;- get.pdb(ids, split = TRUE, path = tempdir())

## Sequence/Structure Alignement
pdbs &lt;- pdbaln(files, outfile = tempfile())

## Normal mode analysis on aligned data
modes &lt;- nma(pdbs)

## Calculate all 6 correlation matrices
cij &lt;- dccm(modes)

## Plot correlations for first structure
plot.dccm(cij$all.dccm[,,1])

}


</code></pre>


</div>