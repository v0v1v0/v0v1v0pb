<div class="container">

<table style="width: 100%;"><tr>
<td>bzinb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The bivariate zero-inflated negative binomial distribution</h2>

<h3>Description</h3>

<p>random generation (<code>rbzinb</code>), maximum likelihood estimation (<code>bzinb</code>), 
and log-likelihood. (<code>lik.bzinb</code>)  for the bivariate zero-inflated negative binomial 
distribution with parameters equal to <code>(a0, a1, a2, b1, b2, p1, p2, p3, p4)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lik.bzinb(xvec, yvec, a0, a1, a2, b1, b2, p1, p2, p3, p4, param = NULL)

rbzinb(n, a0, a1, a2, b1, b2, p1, p2, p3, p4, param = NULL)

bzinb(
  xvec,
  yvec,
  initial = NULL,
  tol = 1e-08,
  maxiter = 50000,
  showFlag = FALSE,
  vcov = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xvec, yvec</code></td>
<td>
<p>a pair of bzinb random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0, a1, a2</code></td>
<td>
<p>shape parameters of the latent gamma variables. They must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1, b2</code></td>
<td>
<p>scale parameters for the latent gamma variables. They must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1, p2, p3, p4</code></td>
<td>
<p>proportions summing up to 1 (<code>p1 + p2 + p3 + p4 = 1</code>). 
<code>p1</code> is the probability of both latent Poisson variables being observed. 
<code>p2</code> is the probability of only the first Poisson variables being observed.
<code>p3</code> is the probability of only the second Poisson variables being observed, and
<code>p4</code> is the probability of both Poisson variables being dropped out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a vector of parameters (<code>(a0, a1, a2, b1, b2, p1, p2, p3, p4)</code>). 
Either <code>param</code> or individual parameters (<code>a0, a1, a2, b1, b2, p1, p2, p3, p4</code>) 
need to be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>starting value of param for EM algorithm, a vector of nine values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for judging convergence. <code>tol = 1e-8</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations allowed. <code>tol = 50000</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showFlag</code></td>
<td>
<p>if <code>TRUE</code>, the updated parameter estimates for each iteration 
are printed out. If a positive integer, the updated parameter estimates for 
iterations greater than <code>showFlag</code> are printed out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>if <code>TRUE</code>, the variance-covariance matrix and information matrix 
are returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>EM theoretically guarantees higher likelihood at each iteration than that of previous iterations. 
See Dempster, Laird, and Rubin (1977). This guarantee comes with an assumption that there is no numerical
error in conditional likelihood maximization at each iteration. Small errors can cause decreasing likelihood 
especially when the iterations reach the point of convergence. Due to this technical error, the EM continues after it reaches
the maximum likelihood point (up to 100 iterations). However, the final estimate being returned is the parameter values at
the maximum likelihood.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>rbzinb</code> gives a pair of random vectors following BZINB distribution.
</p>
</li>
<li> <p><code>bzinb</code> gives the maximum likelihood estimates of a BZINB pair.
</p>

<ul>
<li> <p><code>rho</code> estimate and standard error of the underlying correlation (<code class="reqn">\rho</code>) and (<code class="reqn">logit(\rho)</code>)
</p>
</li>
<li> <p><code>coefficients</code> estimate and standard error of the BZINB parameters
</p>
</li>
<li> <p><code>lik</code> log-likelihood of the maximum likelihood estimate
</p>
</li>
<li> <p><code>iter</code> total number of iterations
</p>
</li>
<li> <p><code>info</code> information matrix. Provided when <code>vcov</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>vcov</code> variance-covariance matrix. Provided when <code>vcov</code> is <code>TRUE</code>.
</p>
</li>
</ul>
</li>
<li> <p><code>lik.bzinb</code> gives the log-likelihood of a set of parameters for a BZINB pair.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Preisser, J., Liu, C., and Wu, D. (In preparation), "A bivariate 
zero-inflated negative binomial model for identifying underlying dependence"
</p>
<p>Dempster, A. P., Laird, N. M., &amp; Rubin, D. B. (1977). Maximum likelihood from 
incomplete data via the EM algorithm. Journal of the Royal Statistical Society: 
Series B (Methodological), 39(1), 1-22.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generating a pair of random vectors
set.seed(2)
data1 &lt;- rbzinb(n = 100, a0 = 2, a1 = 1, a2 = 1, 
                b1 = 1, b2 = 1, p1 = 0.5, p2 = 0.2, 
                p3 = 0.2, p4 = 0.1)

lik.bzinb(xvec = data1[, 1], yvec = data1[ ,2], 
          a0 = 1, a1 = 1, a2 = 1, b1 = 1, b2 = 1, 
          p1 = 0.5, p2 = 0.2, p3 = 0.2, p4 = 0.1)

bzinb(xvec = data1[,1], yvec = data1[,2], showFlag = FALSE)

</code></pre>


</div>