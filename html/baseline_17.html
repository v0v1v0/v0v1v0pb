<div class="container">

<table style="width: 100%;"><tr>
<td>baseline.shirley</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shirley Background Estimation</h2>

<h3>Description</h3>

<p>Shirley Background correction for X-ray Photoelectron Spectroscopy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">baseline.shirley(spectra, t = NULL, limits = NULL, maxit = 50, err = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>matrix with only 1 y-coordinates by rows (i.e.: y = spectra[1,])</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p> Optional vector of spectrum abscissa </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>list with the y coordinates between calculation of background. Ususally these are the extreme point of the data range. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>max number of iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p> Tolerance of difference between iterations </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The shape of the spectrum background or baseline is affected by inelastic energy loss processes, secondary electrons and nearby peaks. A reasonable approximation is essential for a qualitative and quantitative analysis of XPS data especially if several components interfere in one spectrum. The choice of an adequate background model is determined by the physical and chemical conditions of the measurements and the significance of the background to the information to be obtained. The subtraction of the baseline before entering the fit iterations or the calculation of the peak area can be an acceptable approximation for simple analytical problems. In order to obtain chemical and physical parameters in detail, however, it is absolutely necessary to include the background function in the iterative peak fit procedure. 
The primary function F(E) results from the experimentally obtained function M(E) and the background function U(E) as 
</p>
<p style="text-align: center;"><code class="reqn">F(E) = M(E)-U(E)</code>
</p>

<p>The kinetic energy E of the spectra can be described as 
</p>
<p style="text-align: center;"><code class="reqn">E = SE + SW * (i-1)</code>
</p>

<p>SE means the start energy in eV, SW is the step width in eV and i the channel number. i can assume values between 1 and N with N as the number of data points. 
</p>
<p>In case of baseline calculation before initiating the fit procedure, the background is set to the averaged experimental function M(E) in a sector around the chosen start and end channels. With <code class="reqn">i{_1}</code> as left channel (<code class="reqn">E{_1}</code>: low energy side) and <code class="reqn">i{_2}</code> as right channel (<code class="reqn">E{_2}</code>: high energy side) the simulation of the baseline is obtained as 
</p>
<p style="text-align: center;"><code class="reqn">U(E_{1})=M(E_{1})</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">U(E_{2})=M(E_{2})</code>
</p>

<p>If ZAP is the number of points used for averaging (can be set in the preferences), the intensity of the averaged measuring function at the low energy side is calculated by 
</p>
<p style="text-align: center;"><code class="reqn">M(i_{1})=\frac{\sum_{i=0}^{ZAP-1}M(i_{1}+i)}{ZAP}</code>
</p>

<p>and at the high energy side by
</p>
<p style="text-align: center;"><code class="reqn">M(i_{2})=\frac{\sum_{i=0}^{ZAP-1}M(i_{2}+i)}{ZAP}</code>
</p>

<p>In many cases the Shirley model turned out to be a successful approximation for the inelastic background of core level peaks of buried species, which suffered significantly from inelastic losses of the emitted photoelectrons. The calculation of the baseline is an iterative procedure. The number of iteration cycles should be chosen high enough so that the shape of the obtained background function does not change anymore. The analytical expression for the Shirley background is 
</p>
<p style="text-align: center;"><code class="reqn">U(E)= \int_{E}^{\infty}F(E')dE'+c</code>
</p>

<p>The algorithm of Proctor and Sherwood ([1] A. Proctor, P.M.A. Sherwood, Anal. Chem. 54 (1982) 13) 
is 
based on the assumption that for every point of the spectrum the background intensity generated by a photoelectron line is proportional to the number of all photoelectrons with higher kinetic energy. The intensity of the background U(i) in channel i is given by 
</p>
<p style="text-align: center;"><code class="reqn">U(i)=\frac{(a-b)Q(i)}{P(i)+Q(i)}+b</code>
</p>

<p>where a and b are the measured intensities in channel <code class="reqn">i{_1}</code> and <code class="reqn">i{_2}</code>, respectively, and P(i) and Q(i) represent the effective peak areas to lower and higher kinetic energies relative to the channel under consideration. An iterative procedure is necessary because P, Q, and U(i) are unknown. In first approximation U(i) = b is used. 
</p>
<p>The function <code>baseline.shirley</code> implements the <code>shirley baseline</code>.  It is an iterative algorithm.
The iteration stops when the deviation between two consequent iteration is
lower than <code>err</code> or when the max number of iterations <code>maxit</code> is
reached. 
</p>


<h3>Value</h3>

<p>The baseline function return an object of class <code>baseline</code>.
</p>


<h3>References</h3>

<p>A. Proctor, P.M.A. Sherwood, Anal. Chem. 54 (1982) 13.
</p>


<h3>See Also</h3>

<p>baseline
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("O1s")
Data &lt;- O1s

## The same example with C1s data 
# data("C1s")
# Data &lt;- C1s

Y &lt;- Data[2,, drop = FALSE]
X &lt;- Data[1,]

corrected &lt;- baseline(Y, method = "shirley", t = X)
plot(corrected, rev.x = TRUE, labels = X)

## Not run: 
# Dependent on external software
baselineGUI(Y, labels=X, method="shirley")

## End(Not run)
</code></pre>


</div>