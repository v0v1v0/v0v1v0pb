<div class="container">

<table style="width: 100%;"><tr>
<td>DS.prior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prior Diagnostics and Estimation
</h2>

<h3>Description</h3>

<p>A function that generates the uncertainty diagnostic function (<code>U-function</code>) and estimates DS<code class="reqn">(G,m)</code> prior model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DS.prior(input, max.m = 8, g.par, 
         family = c("Normal","Binomial", "Poisson"), 
         LP.type = c("L2", "MaxEnt"), 
         smooth.crit = "BIC", iters = 200, B = 1000,
		 max.theta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>For <code>"Binomial"</code>, a dataframe that contains the <code class="reqn">k</code> pairs of successes <code class="reqn">y</code> and the corresponding total number of trials <code class="reqn">n</code>.  For <code>"Normal"</code>, a dataframe that has the <code class="reqn">k</code> means <code class="reqn">y_i</code> in the first column and their respective standard errors <code class="reqn">s_i</code> in the second.  For the <code>"Poisson"</code>, a vector of that includes the untabled count data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.m</code></td>
<td>
<p>The truncation point <code class="reqn">m</code> reflects the concentration of true unknown <code class="reqn">\pi</code> around known <code class="reqn">g</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.par</code></td>
<td>
<p>Vector with estimated parameters for specified conjugate prior distribution <code class="reqn">g</code> (i.e beta prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>; normal prior: <code class="reqn">\mu</code> and <code class="reqn">\tau^2</code>; gamma prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The distribution of <code class="reqn">y_i</code>. Currently accommodates three families: <code>Normal</code>, <code>Binomial</code>, and <code>Poisson</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LP.type</code></td>
<td>
<p>User selects either <code>"L2"</code> for LP-orthogonal series representation of <code>U-function</code> or <code>"MaxEnt"</code> for the maximum entropy representation.  Default is <code>L2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.crit</code></td>
<td>
<p>User selects either <code>"BIC"</code> or <code>"AIC"</code> as criteria to both determine optimal <code class="reqn">m</code> and smooth final LP parameters; default is <code>"BIC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>Integer value that gives the maximum number of iterations allowed for convergence; default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Integer value for number of grid points used for distribution output; default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.theta</code></td>
<td>
<p>For <code>"Poisson"</code>, user can provide a maximum theta value for prior; default is the maximum count value in <code>input</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> Function can take <code class="reqn">m=0</code> and will return the Bayes estimate with given starting parameters.  Returns an object of class <code>DS.GF.obj</code>; this object can be used with plot command to plot the U-function (<code>Ufunc</code>), Deviance Plots (<code>mDev</code>), and DS-G comparison (<code>DS_G</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LP.par</code></td>
<td>
<p><code class="reqn">m</code> smoothed LP-Fourier coefficients, where <code class="reqn">m</code> is determined by maximum deviance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.par</code></td>
<td>
<p>Parameters for <code class="reqn">g</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LP.max.uns</code></td>
<td>
<p>Vector of all LP-Fourier coefficients prior to smoothing, where the length is the same as <code>max.m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LP.max.smt</code></td>
<td>
<p>Vector of all smoothed LP-Fourier coefficients, where the length is the same as <code>max.m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.fit</code></td>
<td>
<p>Fitted values for the estimated prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UF.data</code></td>
<td>
<p>Dataframe that contains values required for plotting the U-function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev.df</code></td>
<td>
<p>Dataframe that contains deviance values for values of <code class="reqn">m</code> up to <code>max.m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.val</code></td>
<td>
<p>The value of <code class="reqn">m</code> (less than or equal to the maximum <code class="reqn">m</code> from user) that has the maximum deviance and represents the appropriate number of LP-Fourier coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sm.crit</code></td>
<td>
<p>Smoothing criteria; either <code>"BIC"</code> or <code>"AIC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>The user-selected family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LP.type</code></td>
<td>
<p>User-selected representation of <code>U-function</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.data</code></td>
<td>
<p>Observed data provided by user for <code>input</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Doug Fletcher, Subhadeep Mukhopadhyay</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. "Generalized Empirical Bayes via Frequentist Goodness of Fit," <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.
</p>
<p>Mukhopadhyay, S., 2017. "Large-Scale Mode Identification and Data-Driven Sciences," <em>Electronic Journal of Statistics, 11</em>(1), pp.215-240.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rat)
rat.start &lt;- gMLE.bb(rat$y, rat$n)$estimate
rat.ds &lt;- DS.prior(rat, max.m = 4, rat.start, family = "Binomial")
rat.ds
plot(rat.ds, plot.type = "Ufunc")
plot(rat.ds, plot.type = "DSg")
plot(rat.ds, plot.type = "mDev")
</code></pre>


</div>