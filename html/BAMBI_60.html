<div class="container">

<table style="width: 100%;"><tr>
<td>waic.angmcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Watanabe-Akaike Information Criterion (WAIC) for angmcmc objects</h2>

<h3>Description</h3>

<p>Watanabe-Akaike Information Criterion (WAIC) for angmcmc objects
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'angmcmc'
waic(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>angmcmc object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional model specific arguments to be passed to waic from loo. For example, <code>int.displ</code>
specifies integer displacement in wnorm and wnorm2 models. See fit_wnormmix and
fit_wnorm2mix for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a deviance function <code class="reqn">D(\eta) = -2 \log(p(y|\eta))</code>, and an estimate
<code class="reqn">\eta* = (\sum \eta_i) / n</code> of the posterior mean
<code class="reqn">E(\eta|y)</code>, where <code class="reqn">y = (y_1, ..., y_n)</code> denote the data, <code class="reqn">\eta</code> is the unknown
parameter vector of the model, <code class="reqn">\eta_1, ..., \eta_N</code> are MCMC samples from the posterior
distribution of <code class="reqn">\eta</code> given <code class="reqn">y</code> and <code class="reqn">p(y|\eta)</code> is the likelihood function,
the Watanabe-Akaike Information Criterion (WAIC) is defined as
</p>
<p style="text-align: center;"><code class="reqn">WAIC = LPPD - p_W</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">LPPD  = \sum_{i=1}^n \log (N^{-1} \sum_{s=1}^N p(y_i|\eta_s) )</code>
</p>

<p>and (form 1 of)
</p>
<p style="text-align: center;"><code class="reqn">p_W =  2 \sum_{i=1}^n [ \log (N^{-1} \sum_{s=1}^N p(y_i|\eta_s) ) - N^{-1} \sum_{s=1}^N \log \:p(y_i|\eta_s) ].</code>
</p>

<p>An alternative form (form 2) for <code class="reqn">p_W</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">p_W = \sum_{i=1}^n \hat{var} \log p(y_i|\eta)</code>
</p>

<p>where for <code class="reqn">i = 1, ..., n</code>, <code class="reqn">\hat{var} \log p(y_i|\eta)</code> denotes the estimated variance
of <code class="reqn">\log p(y_i|\eta)</code> based on the realizations <code class="reqn">\eta_1, ..., \eta_N</code>.
</p>
<p>Note that waic.angmcmc calls waic for computation. If the likelihood contribution of each data
point for each MCMC iteration is available in <code>object</code> (can be returned by setting <code>return_llik_contri = TRUE</code>)
during fit_angmix call), <code>waic.array</code> is used; otherwise <code>waic.function</code> is
called. Computation is much faster if the likelihood contributions are available - however, they are very
memory intensive, and by default not returned in fit_angmix.
</p>


<h3>Value</h3>

<p>Computes the WAIC for a given angmcmc object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># illustration only - more iterations needed for convergence
fit.vmsin.20 &lt;- fit_vmsinmix(tim8, ncomp = 3, n.iter =  20,
                             n.chains = 1, return_llik_contri = TRUE)
library(loo)
waic(fit.vmsin.20)

</code></pre>


</div>