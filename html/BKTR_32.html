<div class="container">

<table style="width: 100%;"><tr>
<td>TensorOperator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 singleton that contains the configuration for the tensor backend</h2>

<h3>Description</h3>

<p>Tensor backend configuration and methods for all the tensor operations
in BKTR
</p>


<h3>Super class</h3>

<p><code>R6P::Singleton</code> -&gt; <code>TensorOperator</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>fp_type</code></dt>
<dd>
<p>The floating point type to use for the tensor operations</p>
</dd>
<dt><code>fp_device</code></dt>
<dd>
<p>The device to use for the tensor operations</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-TensorOperator-new"><code>TensorOperator$new()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-set_params"><code>TensorOperator$set_params()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-get_default_jitter"><code>TensorOperator$get_default_jitter()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-tensor"><code>TensorOperator$tensor()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-is_tensor"><code>TensorOperator$is_tensor()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-eye"><code>TensorOperator$eye()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-ones"><code>TensorOperator$ones()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-zeros"><code>TensorOperator$zeros()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-rand"><code>TensorOperator$rand()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-randn"><code>TensorOperator$randn()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-randn_like"><code>TensorOperator$randn_like()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-arange"><code>TensorOperator$arange()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-rand_choice"><code>TensorOperator$rand_choice()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-kronecker_prod"><code>TensorOperator$kronecker_prod()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-khatri_rao_prod"><code>TensorOperator$khatri_rao_prod()</code></a>
</p>
</li>
<li> <p><a href="#method-TensorOperator-clone"><code>TensorOperator$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-TensorOperator-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialize the tensor operator with the given floating point type
and device
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$new(fp_type = "float64", fp_device = "cpu")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>fp_type</code></dt>
<dd>
<p>The floating point type to use for the tensor operations (either
"float64" or "float32")</p>
</dd>
<dt><code>fp_device</code></dt>
<dd>
<p>The device to use for the tensor operations (either "cpu" or
"cuda")</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor operator instance
</p>


<hr>
<a id="method-TensorOperator-set_params"></a>



<h4>Method <code>set_params()</code>
</h4>

<p>Set the tensor operator parameters
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$set_params(fp_type = NULL, fp_device = NULL, seed = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>fp_type</code></dt>
<dd>
<p>The floating point type to use for the tensor operations (either
"float64" or "float32")</p>
</dd>
<dt><code>fp_device</code></dt>
<dd>
<p>The device to use for the tensor operations (either "cpu" or
"cuda")</p>
</dd>
<dt><code>seed</code></dt>
<dd>
<p>The seed to use for the random number generator</p>
</dd>
</dl>
</div>


<hr>
<a id="method-TensorOperator-get_default_jitter"></a>



<h4>Method <code>get_default_jitter()</code>
</h4>

<p>Get the default jitter value for the floating point type used by the tensor operator
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$get_default_jitter()</pre></div>



<h5>Returns</h5>

<p>The default jitter value for the floating point type used by the tensor operator
</p>


<hr>
<a id="method-TensorOperator-tensor"></a>



<h4>Method <code>tensor()</code>
</h4>

<p>Create a tensor from a vector or matrix of data with the tensor operator dtype and device
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$tensor(tensor_data)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tensor_data</code></dt>
<dd>
<p>The vector or matrix of data to create the tensor from</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-is_tensor"></a>



<h4>Method <code>is_tensor()</code>
</h4>

<p>Check if a provided object is a tensor
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$is_tensor(tensor)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tensor</code></dt>
<dd>
<p>The object to check</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A boolean indicating if the object is a tensor
</p>


<hr>
<a id="method-TensorOperator-eye"></a>



<h4>Method <code>eye()</code>
</h4>

<p>Create a tensor with a diagonal of ones and zeros with the tensor operator dtype and device
for a given dimension
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$eye(eye_dim)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>eye_dim</code></dt>
<dd>
<p>The dimension of the tensor to create</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor with a diagonal of ones and zeros with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-ones"></a>



<h4>Method <code>ones()</code>
</h4>

<p>Create a tensor of ones with the tensor operator dtype and device for a given dimension
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$ones(tsr_dim)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tsr_dim</code></dt>
<dd>
<p>The dimension of the tensor to create</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of ones with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-zeros"></a>



<h4>Method <code>zeros()</code>
</h4>

<p>Create a tensor of zeros with the tensor operator dtype and device for a given dimension
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$zeros(tsr_dim)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tsr_dim</code></dt>
<dd>
<p>The dimension of the tensor to create</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of zeros with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-rand"></a>



<h4>Method <code>rand()</code>
</h4>

<p>Create a tensor of random uniform values with the tensor operator dtype and
device for a given dimension
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$rand(tsr_dim)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tsr_dim</code></dt>
<dd>
<p>The dimension of the tensor to create</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of random values with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-randn"></a>



<h4>Method <code>randn()</code>
</h4>

<p>Create a tensor of random normal values with the tensor operator dtype and device
for a given dimension
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$randn(tsr_dim)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tsr_dim</code></dt>
<dd>
<p>The dimension of the tensor to create</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of random normal values with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-randn_like"></a>



<h4>Method <code>randn_like()</code>
</h4>

<p>Create a tensor of random uniform values with the same shape as a given tensor
with the tensor operator dtype and device
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$randn_like(input_tensor)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>input_tensor</code></dt>
<dd>
<p>The tensor to use as a shape reference</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of random uniform values with the same shape as a given tensor
</p>


<hr>
<a id="method-TensorOperator-arange"></a>



<h4>Method <code>arange()</code>
</h4>

<p>Create a tensor of a range of values with the tensor operator dtype and device
for a given start and end
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$arange(start, end)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>start</code></dt>
<dd>
<p>The start of the range</p>
</dd>
<dt><code>end</code></dt>
<dd>
<p>The end of the range</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of a range of values with the tensor operator dtype and device
</p>


<hr>
<a id="method-TensorOperator-rand_choice"></a>



<h4>Method <code>rand_choice()</code>
</h4>

<p>Choose random values from a tensor for a given number of samples
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$rand_choice(
  choices_tsr,
  nb_sample,
  use_replace = FALSE,
  weights_tsr = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>choices_tsr</code></dt>
<dd>
<p>The tensor to choose values from</p>
</dd>
<dt><code>nb_sample</code></dt>
<dd>
<p>The number of samples to choose</p>
</dd>
<dt><code>use_replace</code></dt>
<dd>
<p>A boolean indicating if the sampling should be done with replacement.
Defaults to FALSE</p>
</dd>
<dt><code>weights_tsr</code></dt>
<dd>
<p>The weights to use for the sampling. If NULL, the sampling is uniform.
Defaults to NULL</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new tensor of randomly chosen values from a tensor
</p>


<hr>
<a id="method-TensorOperator-kronecker_prod"></a>



<h4>Method <code>kronecker_prod()</code>
</h4>

<p>Efficiently compute the kronecker product of two matrices in tensor format
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$kronecker_prod(a, b)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>a</code></dt>
<dd>
<p>The first tensor</p>
</dd>
<dt><code>b</code></dt>
<dd>
<p>The second tensor</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The kronecker product of the two matrices
</p>


<hr>
<a id="method-TensorOperator-khatri_rao_prod"></a>



<h4>Method <code>khatri_rao_prod()</code>
</h4>

<p>Efficiently compute the khatri rao product of two matrices in tensor format
having the same number of columns
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$khatri_rao_prod(a, b)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>a</code></dt>
<dd>
<p>The first tensor</p>
</dd>
<dt><code>b</code></dt>
<dd>
<p>The second tensor</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The khatri rao product of the two matrices
</p>


<hr>
<a id="method-TensorOperator-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>TensorOperator$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
# Set the seed, setup the tensor floating point type and device
TSR$set_params(fp_type='float64', fp_device='cpu', seed=42)
# Create a tensor from a vector
TSR$tensor(c(1, 2, 3))
# Create a tensor from a matrix
TSR$tensor(matrix(c(1, 2, 3, 4), nrow=2))
# Create a 3x3 tensor with a diagonal of ones and zeros elsewhere
TSR$eye(3)
# Create a tensor of ones (with 6 elements, 2 rows and 3 columns)
TSR$ones(c(2, 3))
# Create a tensor of zeros (with 12 elements, 3 rows and 4 columns)
TSR$zeros(c(3, 4))
# Create a tensor of random uniform values (with 6 elements)
TSR$rand(c(2, 3))
# Create a tensor of random normal values (with 6 elements)
TSR$randn(c(2, 3))
# Create a tensor of random normal values with the same shape as a given tensor
tsr_a &lt;- TSR$randn(c(2, 3))
TSR$randn_like(tsr_a)
# Create a tensor of a range of values (1, 2, 3, 4)
TSR$arange(1, 4)
# Choose two random values from a given tensor without replacement
tsr_b &lt;- TSR$rand(6)
TSR$rand_choice(tsr_b, 2)
# Use the tensor operator to compute the kronecker product of two 2x2 matrices
tsr_c &lt;- TSR$tensor(matrix(c(1, 2, 3, 4), nrow=2))
tsr_d &lt;- TSR$tensor(matrix(c(5, 6, 7, 8), nrow=2))
TSR$kronecker_prod(tsr_c, tsr_d) # Returns a 4x4 tensor
# Use the tensor operator to compute the khatri rao product of two 2x2 matrices
TSR$khatri_rao_prod(tsr_c, tsr_d) # Returns a 4x2 tensor
# Check if a given object is a tensor
TSR$is_tensor(tsr_d) # Returns TRUE
TSR$is_tensor(TSR$eye(2)) # Returns TRUE
TSR$is_tensor(1) # Returns FALSE

</code></pre>


</div>