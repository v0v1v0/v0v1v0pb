<div class="container">

<table style="width: 100%;"><tr>
<td>adjustPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test positive definiteness and adjust positive definite matrix.</h2>

<h3>Description</h3>

<p>The routine checks if a real symmetric matrix is positive definite and
if required adjusts for positive definiteness.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adjustPD(x, eigentol = 1e-06, correct = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A real symmetric matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigentol</code></td>
<td>
<p>A tolerance level for the eigenvalues below which
the input matrix is not considered to be positive definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>logical; if TRUE a corrected positive definite matrix
is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In statistical models, Newton's method is often used to solve a
(multivariate) maximization problem. For this iterative technique to
converge, the search direction must be controlled to guarantee an ascent
in the objective function at each step. For maximization with Newton-like
methods, an iteration yields an ascent provided that the negative of the
Hessian matrix is positive definite. When an iteration or initial value
choice does note lie in a “small” neighborhood of the maximum, positive
definiteness of the negative Hessian may not be guaranteed and a correction
should be implemented to ensure that the trajectory points in the ascent
direction.
This routine checks if a symmetric input matrix is positive definite and
if required computes a positive definite adjusted matrix following the work
of Levenberg (1944), Marquardt (1963) and Goldfeld (1966). The correction
consists in perturbing the main diagonal of the original input matrix
<code>x</code> by adding to each diagonal entry the absolute value of the most
negative eigenvalue of <code>x</code> incremented by <em>10^(-4)</em>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<p><code>isPD</code> <code style="white-space: pre;">⁠   ⁠</code> logical; if TRUE the input matrix <code>x</code> is
positive definite.
</p>
<p><code>PD</code>  <code style="white-space: pre;">⁠     ⁠</code> The corrected positive definite matrix.
</p>


<h3>References</h3>

<p>Levenberg, K. (1944). A method for the solution of certain
non-linear problems in least squares,
<em>Quarterly of Applied Mathematics</em> <strong>2</strong>(2): 164-168.
</p>
<p>Marquardt, D. W. (1963). An algorithm for least-squares
estimation of nonlinear parameters. <em>Journal of the society for
Industrial and Applied Mathematics</em> <strong>11</strong>(2): 431-441.
</p>
<p>Goldfeld, S. M., Quandt, R. E., and Trotter, H. F. (1966).
Maximization by Quadratic Hill-Climbing
<em>Econometrica</em> <strong>34</strong>(3): 541-551.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a 3 x 3 matrix that fails to be positive definite
A &lt;- matrix(c( - 0.478, - 0.013, 0.001, - 0.013, 1.256, 0.001,
            0.001, 0.001, 0.024), ncol = 3, byrow = TRUE)
adjustPD(A)
</code></pre>


</div>