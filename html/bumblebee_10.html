<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_prob_group_pairing_and_linked</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>estimate_prob_group_pairing_and_linked</code> Estimates joint probability of linkage</h2>

<h3>Description</h3>

<p>This function computes the joint probability that a pair
of pathogen sequences is from a specific population group
pairing and linked.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_prob_group_pairing_and_linked(
  df_counts_and_p_hat,
  individuals_population_in,
  ...
)

## Default S3 method:
estimate_prob_group_pairing_and_linked(
  df_counts_and_p_hat,
  individuals_population_in,
  verbose_output = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df_counts_and_p_hat</code></td>
<td>
<p>A data.frame returned by function: <code>estimate_p_hat()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individuals_population_in</code></td>
<td>
<p>A numeric vector of the estimated number of individuals per population group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose_output</code></td>
<td>
<p>A boolean value to display intermediate output.
(Default is <code>FALSE</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a population group pairing <code class="reqn">(u,v)</code>, the joint probability that a pair
is from groups <code class="reqn">(u,v)</code> and is linked is computed as
</p>
<p style="text-align: center;"><code class="reqn">(N_uv / N_choose_2) * p_hat_uv ,</code>
</p>

<p>where,
</p>

<ul>
<li>
<p> N_uv = N_u * N_v: maximum distinct possible <code class="reqn">(u,v)</code> pairs in population
</p>
</li>
<li>
<p> p_hat_uv: probability of linkage between two individuals randomly sampled
from groups <code class="reqn">u</code> and <code class="reqn">v</code>
</p>
</li>
<li>
<p> N choose 2 or (N * (N - 1))/2 : all distinct possible pairs in population.
</p>
</li>
</ul>
<p>See bumblebee website for more details <a href="https://magosil86.github.io/bumblebee/">https://magosil86.github.io/bumblebee/</a>.
</p>


<h3>Value</h3>

<p>Returns a data.frame containing:
</p>

<ul>
<li>
<p> H1_group, Name of population group 1
</p>
</li>
<li>
<p> H2_group, Name of population group 2
</p>
</li>
<li>
<p> number_hosts_sampled_group_1, Number of individuals sampled from population group 1
</p>
</li>
<li>
<p> number_hosts_sampled_group_2, Number of individuals sampled from population group 2
</p>
</li>
<li>
<p> number_hosts_population_group_1, Estimated number of individuals in population group 1
</p>
</li>
<li>
<p> number_hosts_population_group_2, Estimated number of individuals in population group 2
</p>
</li>
<li>
<p> max_possible_pairs_in_sample, Number of distinct possible transmission pairs between individuals sampled from population groups 1 and 2
</p>
</li>
<li>
<p> max_possible_pairs_in_population, Number of distinct possible transmission pairs between individuals in population groups 1 and 2
</p>
</li>
<li>
<p> num_linked_pairs_observed, Number of observed directed transmission pairs between samples from population groups 1 and 2
</p>
</li>
<li>
<p> p_hat, Probability that pathogen sequences from two individuals randomly sampled from their respective population groups are linked
</p>
</li>
<li>
<p> prob_group_pairing_and_linked, Probability that a pair of pathogen sequences is from a specific population group pairing and is linked
</p>
</li>
</ul>
<h3>Methods (by class)</h3>


<ul><li> <p><code>default</code>: Estimates joint probability of linkage
</p>
</li></ul>
<h3>References</h3>


<ol>
<li>
<p> Magosi LE, et al., Deep-sequence phylogenetics to quantify patterns of
HIV transmission in the context of a universal testing and treatment
trial â€“ BCPP/ Ya Tsie trial. To submit for publication, 2021.
</p>
</li>
<li>
<p> Carnegie, N.B., et al., Linkage of viral sequences among HIV-infected
village residents in Botswana: estimation of linkage rates in the
presence of missing data. PLoS Computational Biology, 2014. 10(1):
p. e1003430.
</p>
</li>
</ol>
<h3>See Also</h3>

<p>See <code>estimate_p_hat</code> to prepare input data to estimate <code>prob_group_pairing_and_linked</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(bumblebee)
library(dplyr)

# Estimate joint probability that a pair is from a specific group pairing and linked

# We shall use the data of HIV transmissions within and between intervention and control
# communities in the BCPP/Ya Tsie HIV prevention trial. To learn more about the data 
# ?counts_hiv_transmission_pairs and ?sampling_frequency


# Load and view data
#
# The input data comprises counts of observed directed HIV transmission pairs 
# within and between intervention and control communities in the BCPP/Ya Tsie 
# trial, sampling information and the probability of linkage between individuals
# sampled from intervention and control communities (i.e. \code{p_hat})
#
# See ?estimate_p_hat() for details on estimating p_hat
results_estimate_p_hat &lt;- estimated_hiv_transmission_flows[, c(1:10)]

results_estimate_p_hat

# Estimate prob_group_pairing_and_linked
results_prob_group_pairing_and_linked &lt;- estimate_prob_group_pairing_and_linked(
    df_counts_and_p_hat = results_estimate_p_hat, 
    individuals_population_in = sampling_frequency$number_population)

# View results
results_prob_group_pairing_and_linked

</code></pre>


</div>