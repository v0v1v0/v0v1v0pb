<div class="container">

<table style="width: 100%;"><tr>
<td>maxLikelihoodETAS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the parameters of the ETAS model using maximum likelihood.</h2>

<h3>Description</h3>

<p>The Epidemic Type Aftershock Sequence (ETAS) model is widely used to quantify the degree of seismic activity in a geographical region, and to forecast the occurrence of future mainshocks and aftershocks (Ross 2016). The temporal ETAS model is a point process where the probability of an earthquake occurring at time <code class="reqn">t</code> depends on the previous seismicity <code class="reqn">H_t</code>, and is defined by the conditional intensity function:
</p>
<p style="text-align: center;"><code class="reqn"> \lambda(t|H_t) = \mu + \sum_{t[i] &lt; t}  \kappa(m[i]|K,\alpha) h(t[i]|c,p)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\kappa(m_i|K,\alpha) = Ke^{\alpha \left( m_i-M_0 \right)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn"> h(t_i|c,p) = \frac{(p-1)c^{p-1}}{(t-t_i+c)^p}</code>
</p>

<p>where the summation is over all previous earthquakes that occurred in the region, with the i'th such earthquake occurring at time <code class="reqn"> t_i</code> and having magnitude <code class="reqn"> m_i</code>. The quantity <code class="reqn">M_0</code> denotes the magnitude of completeness of the catalog, so that <code class="reqn">m_i \geq  M_0</code> for all i. The temporal ETAS model has 5 parameters: <code class="reqn">\mu</code> controls the background rate of seismicity, <code class="reqn"> K</code> and <code class="reqn"> \alpha</code> determine the productivity (average number of aftershocks) of an earthquake with magnitude <code class="reqn">m</code>, and <code class="reqn">c</code> and <code class="reqn"> p</code>  are the parameters of the Modified Omori Law (which has here been normalized to integrate to 1) and represent the speed at which the aftershock rate decays over time. Each earthquake is assumed to have a magnitude which is an independent draw from the Gutenberg-Richter law <code class="reqn"> p(m_i) = \beta e^{\beta(m_i-M_0)}</code>.

This function estimates the parameters of the ETAS model using maximum likelihood
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxLikelihoodETAS(ts, magnitudes, M0, T, initval = NA, displayOutput = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>Vector containing the earthquake times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magnitudes</code></td>
<td>
<p>Vector containing the earthquake magnitudes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M0</code></td>
<td>
<p>Magnitude of completeness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>Length of the time window [0,T] the catalog was observed over. If not specified, will be taken as the time of the last earthquake.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initval</code></td>
<td>
<p>Initial value at which to start the estimation. A vector, with elements (mu, K, alpha, c, p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displayOutput</code></td>
<td>
<p>If TRUE then prints the out the likelihood during model fitting.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A vector containing the estimated parameters, in the order (mu,K,alpha,c,p,beta)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>The corresponding loglikelihood</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gordon J Ross
</p>


<h3>References</h3>

<p>Gordon J. Ross - Bayesian Estimation of the ETAS Model for Earthquake Occurrences (2016), available from http://www.gordonjross.co.uk/bayesianetas.pdf
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
beta &lt;- 2.4; M0 &lt;- 3; T &lt;- 500
catalog &lt;- simulateETAS(0.2, 0.2, 1.5, 0.5, 2, beta, M0, T)
maxLikelihoodETAS(catalog$ts, catalog$magnitudes, M0, 500)

## End(Not run)
</code></pre>


</div>