<div class="container">

<table style="width: 100%;"><tr>
<td>read.ncdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Read AMBER Binary netCDF files </h2>

<h3>Description</h3>

<p>Read coordinate data from a binary netCDF trajectory file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read.ncdf(trjfile, headonly = FALSE, verbose = TRUE, time = FALSE,
          first = NULL, last = NULL, stride = 1, cell = FALSE,
          at.sel = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trjfile</code></td>
<td>
<p> name of trajectory file to read. A vector if treat
a batch of files </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>headonly</code></td>
<td>
<p> logical, if TRUE only trajectory header information
is returned. If FALSE only trajectory coordinate data is returned. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> logical, if TRUE print details of the reading process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> logical, if TRUE the <code>first</code> and <code>last</code> have the
time unit ps; Otherwise the unit is the frame number. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first</code></td>
<td>
<p> starting time or frame number to read; If NULL, start
from the begining of the file(s). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last</code></td>
<td>
<p> read data until <code>last</code> time or frame number; If NULL or
equal to -1, read until the end of the file(s). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stride</code></td>
<td>
<p> take at every <code>stride</code> frame(s) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell</code></td>
<td>
<p> logical, if TRUE and <code>headonly</code> is FALSE return cell 
information only. Otherwise, return header or coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.sel</code></td>
<td>
<p>an object of class ‘select’ indicating a subset
of atomic coordinates to be read.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Reads a AMBER netCDF format trajectory file with the help of David
W. Pierce's (UCSD) ncdf4 package available from CRAN.
</p>


<h3>Value</h3>

<p>A list of trajectory header data,  a numeric matrix of xyz
coordinates with a frame/structure per row and a Cartesian 
coordinate per column, or a numeric matrix of cell information 
with a frame/structure per row and lengths and angles per column.
If time=TRUE, row names of returned coordinates or cell are
set to be the physical time of corresponding frames.
</p>


<h3>Note</h3>

<p>See AMBER documentation for netCDF format description.
</p>
<p>NetCDF binary trajectory files are supported by the AMBER modules
sander, pmemd and ptraj. Compared to formatted trajectory files, the
binary trajectory files are smaller, higher precision and
significantly faster to read and write.
</p>
<p>NetCDF provides for file portability across architectures, allows for
backwards compatible extensibility of the format and enables the files
to be self-describing. Support for this format is available in VMD.
</p>
<p>If you experience problems reading your trajectory file with read.ncdf()
consider first reading your file into VMD and from there exporting a
new DCD trajectory file with the 'save coordinates' option. This new
file should be easily read with read.dcd().
</p>


<h3>Author(s)</h3>

<p> Barry Grant </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
<a href="https://www.unidata.ucar.edu/software/netcdf/">https://www.unidata.ucar.edu/software/netcdf/</a>
<a href="https://cirrus.ucsd.edu/~pierce/ncdf/">https://cirrus.ucsd.edu/~pierce/ncdf/</a>
<a href="https://ambermd.org/FileFormats.php#netcdf">https://ambermd.org/FileFormats.php#netcdf</a>
</p>


<h3>See Also</h3>

 <p><code>read.dcd</code>, <code>write.ncdf</code>,
<code>read.pdb</code>, <code>write.pdb</code>,
<code>atom.select</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
##-- Read example trajectory file
trtfile &lt;- system.file("examples/hivp.dcd", package="bio3d")
trj &lt;- read.dcd(trtfile)

## Write to netCDF format
write.ncdf(trj, "newtrj.nc")

## Read trj
trj &lt;- read.ncdf("newtrj.nc")

## End(Not run)
</code></pre>


</div>