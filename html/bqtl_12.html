<div class="container">

<table style="width: 100%;"><tr>
<td>locus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lookup loci or effects for genetic model formulas </h2>

<h3>Description</h3>

<p>Convert numeric indexes to names of regressors for a genetic model.
One or many genetic models can be specified through the use of this
function.  It is used on the right hand side of a formula in the
<code>bqtl</code> function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">locus(x, ..., scope, method, chromo, cM, ana.obj)
add(x, ..., scope, method)
dom(x, ..., scope, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
 
<p>Typically an integer, an integer vector, or an array whose elements
are integers. These index loci described in a <code>map.frame</code>
object. 
</p>
<p>However, <code>x</code> can also be a character string, vector, et cetera,
in which case the elements must belong to <code>names(scope)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
 
<p>Optional arguments (usually integers) to be used when
<code>is.atomic(x)</code> is TRUE. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chromo </code></td>
<td>
<p>A chromosome number or 2 ordered numbers. The loci on the
chromosome or in the range of chromosome numbers are used. If
<code>chromo</code> is used, <code>x</code> must not be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cM </code></td>
<td>
<p>(Optional) map distance or two giving a location near a locus
or range of locations from which loci will be included. If the one
chromosome number is specified in <code>chromo</code>, <code>cM</code> must be 
ordered. If <code>cM</code> is omitted, all loci on the chromosome(s) will
be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p> (Optional and)
Usually not supplied by the user.  Rather <code>bqtl</code> fills this in
automatically.  A vector of regressor names, like the <code>reg.names</code>
component returned by <code>make.analysis.obj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> (Optional and) 
Usually not supplied by the user. Like <code>scope</code>, <code>bqtl</code> takes
care of filling this in with "BC1", "F2", et cetera as appropriate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ana.obj</code></td>
<td>
<p>Usually not specified by the user. This is the
<code>analysis.object</code> to be used to lookup loci if a <code>chromo</code>
argument is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 <p><code>locus</code> is used in the model
formula notation of <code>bqtl</code>, possibly more than once, and possibly
with regressors named in the usual manner.  <code>locus</code> is intended to
speed up the specification and examination of genetic models by allowing
many models to be specified in a shorthand notation in a single model
formula.  The names of genetic loci can consist of marker names, names
that encode chromosome number and location, or other shorthand
notations.  The names of terms in genetic models will typically include
the names of the locus and may prepend "add." or "dom." or similar
abbreviations for the 'additive' and 'dominance' terms associated with
the locus.
</p>
<p>When used as in <code>bqtl( y ~ locus(34), my.analysis.obj )</code>, it will
look up the term or terms corresponding to the 34th locus. When
this is passed back to <code>bqtl</code>, it is pasted into a text string that
will become a formula and is subsequently processed to yield the fit for
a one gene model.
</p>
<p>When used as in <code>bqtl( y ~ locus(34,75,172), my.analysis.obj)</code> it
looks up each term and returns a result to <code>bqtl</code> that results in
fitting a 3 gene model (without interaction terms). 
</p>
<p>When <code>x</code> is a vector or array, the processing typically returns
pieces character strings for many model formulas.  <code>bqtl(y ~
locus(26:75), ...)</code> results in a list of 50 different one gene model
fits from <code>bqtl</code> for the terms corresponding to the 26th through
the 75th variables.  <code> bqtl(y ~
locus(cbind(c(15,45,192),c(16,46,193))),...)</code> returns two three gene
models.  And more generally, whenever <code>is.array(x)</code> is TRUE, the
columns (or slices) specify <code> dim(x)[1]/length(x)</code> different
models. 
</p>
<p>The <code>chromo</code> argument performs a lookup of loci on the chromosome
via the function <code>map.index</code>. If <code>cM</code> is also given,
the locus nearest that location is used. If two values are given for
<code>cM</code> all loci in the range are used.
</p>
<p><code>add(x)</code> and <code>dom(x)</code> are alternatives that specify that only
the <em>additive</em> or <em>dominance</em> terms in an F2 intercross. 
</p>


<h3>Value</h3>

<p>A character vector whose element(s) can be parsed as the right hand side
of a model formula(s). 
</p>


<h3>Author(s)</h3>

<p>Charles C. Berry <a href="mailto:cberry@ucsd.edu">cberry@ucsd.edu</a> </p>


<h3>See Also</h3>

 
<p><code>configs</code>,
<code>bqtl</code>, and the examples there for a sense of how to use
<code>locus</code>, 
<code>make.analysis.obj</code> for the setup that encodes the marker
map and the marker information.
</p>


</div>