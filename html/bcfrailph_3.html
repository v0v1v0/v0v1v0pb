<div class="container">

<table style="width: 100%;"><tr>
<td>fitbccv.gammasp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bivariate correlated gamma frailty model fitting function.</h2>

<h3>Description</h3>

<p>Semi-parametric Bivariate correlated gamma frailty model fitting function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitbccv.gammasp(
  X,
  Y,
  initfrailp,
  weights = NULL,
  control = bcfrailph.control(),
  SE = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matix of predictors. This should not include an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a Surv object containing 2 columns (coxph.fit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initfrailp</code></td>
<td>
<p>Initial estimates for the frailty parameters. If not specified, initial frailty variance will be obtained from coxph with univariate gamma frailty model and for correlation c(0.5) will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of case weights. the default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Arguments to control the fit. The default is <code>bcfrailph.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>a logical statement whether standard errors are obtained from the mariginal log likelihood.The default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of  that contains  the following components.
</p>

<ul>
<li> <p><code>coefficients</code> - A vector of estimated Covariate coefficients.
</p>
</li>
<li> <p><code>frailparest</code> - A vector of estimated Frailty parameters i.e. frailty variance and correlation.
</p>
</li>
<li> <p><code>stderr</code>-A vector containing the Standard error of the Estimated parameters both covariate coefficients and  frailty parameters.
</p>
</li>
<li> <p><code>loglilk0</code>- Log likelihood of without frailty model or loglik of coxph fit.
</p>
</li>
<li> <p><code>loglilk</code>-Log likelihood of Cox PH model with frailty.
</p>
</li>
<li> <p><code>Iloglilk</code>- Log likelihood of with frailty. For gamma fit it is I-likelihood or the likelihood after integrating out the frailty term.For lognormal fit it is the approximate likelihood.
</p>
</li>
<li> <p><code>bhaz</code>- an array containing unique event times and estimated baseline hazard.
</p>
</li>
<li> <p><code>X</code>-Matrix of observed covariates.
</p>
</li>
<li> <p><code>time</code>-the observed survival time.
</p>
</li>
<li> <p><code>censor</code>-censoring indicator.
</p>
</li>
<li> <p><code>resid</code>-the martingale residuals.
</p>
</li>
<li> <p><code>lin.prid</code>-the vector of linear predictors.
</p>
</li>
<li> <p><code>frail</code>-estimated Frailty values.
</p>
</li>
<li> <p><code>iteration</code>-Number of outer iterations.
</p>
</li>
<li> <p><code>e.time</code>-the vector of unique event times.
</p>
</li>
<li> <p><code>n.event</code>- the number of events at each of the unique event times.
</p>
</li>
<li> <p><code>convergence</code>-an indicator, 1 if converge and 0 otherwise.
</p>
</li>
<li> <p><code>history</code>-an array containing records of estimates and other information on each iterations.
</p>
</li>
</ul>
<h3>Note</h3>

<p>This function is important especially for simulation studies as it reduced checking time.
Parameters of Bivariate correlated gamma frailty model was estimated using a modified EM approach given in Kifle et al (2022).
</p>


<h3>References</h3>

<p>Kifle YG, Chen DG, Haileyesus MT (2022). Multivariate Frailty Models using Survey Weights with Applications to Twins Infant Mortality in Ethiopia. Statistics and Its Interface,106(4), 1\-10.
</p>


<h3>See Also</h3>

<p><code>bcfrailph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4)
simdata&lt;-simbcfrailph(psize=300, cenr= c(0.3),beta=c(2),frailty=c("gamma"),
frailpar=c(0.5,0.5),bhaz=c("weibull"),
bhazpar=list(shape =c(5), scale = c(0.1)),
covartype= c("B"),covarpar=list(fargs=c(1),sargs=c(0.5)))
Y&lt;-simdata$Y;X&lt;-simdata$X

bcspfit&lt;-fitbccv.gammasp(X=X,Y=Y,initfrailp=NULL)
bcspfit$coef
bcspfit$frailpar


</code></pre>


</div>