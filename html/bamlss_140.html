<div class="container">

<table style="width: 100%;"><tr>
<td>opt_Cox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cox Model Posterior Mode Estimation
</h2>

<h3>Description</h3>

<p>This function computes posterior mode estimates of the parameters of a flexible Cox model
with structured additive predictors using a Newton-Raphson algorithm. Integrals are solved
numerically. Moreover, optimum smoothing variances are computed using a stepwise optimization,
see also the details section of function <code>bfit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt_Cox(x, y, start, weights, offset,
  criterion = c("AICc", "BIC", "AIC"),
  nu = 0.1, update.nu = TRUE,
  eps = .Machine$double.eps^0.25, maxit = 400,
  verbose = TRUE, digits = 4, ...)

cox_mode(x, y, start, weights, offset,
  criterion = c("AICc", "BIC", "AIC"),
  nu = 0.1, update.nu = TRUE,
  eps = .Machine$double.eps^0.25, maxit = 400,
  verbose = TRUE, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The <code>x</code> list, as returned from function
<code>bamlss.frame</code> and transformed by function <code>surv_transform</code>,
holding all model matrices and other information that is used for
fitting the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The model response, as returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named numeric vector containing possible starting values, the names are based on
function <code>parameters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Prior weights on the data, as returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Can be used to supply model offsets for use in fitting,
returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>Set the information criterion that should be used, e.g., for smoothing
variance selection. Options are the corrected AIC <code>"AICc"</code>, the <code>"BIC"</code> and
<code>"AIC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Calibrates the step length of parameter updates of one Newton-Raphson update.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update.nu</code></td>
<td>
<p>Should the updating step length be optimized in each iteration
of the backfitting algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The relative convergence tolerance of the backfitting algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>The maximum number of iterations for the backfitting algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print information during runtime of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Set the digits for printing when <code>verbose = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>A named list of the fitted values of the modeled parameters
of the selected distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>The estimated set regression coefficients and smoothing variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edf</code></td>
<td>
<p>The equivalent degrees of freedom used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>The value of the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logPost</code></td>
<td>
<p>The value of the log-posterior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>The Hessian matrix evaluated at the posterior mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Logical, indicating convergence of the backfitting algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The runtime of the algorithm.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Umlauf N, Klein N, Zeileis A (2016). Bayesian Additive Models for Location
Scale and Shape (and Beyond). <em>(to appear)</em>
</p>


<h3>See Also</h3>

<p><code>sam_Cox</code>, <code>cox_bamlss</code>, <code>surv_transform</code>,
<code>simSurv</code>, <code>bamlss</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Please see the examples of function sam_Cox()!
</code></pre>


</div>