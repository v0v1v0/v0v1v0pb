<div class="container">

<table style="width: 100%;"><tr>
<td>evidenceCJ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evidence estimation via Chib and Jeliazkov's method</h2>

<h3>Description</h3>

<p>Function to estimate the evidence (marginal likelihood) with Chib and Jeliazkov's method, 
based on the adjusted pseudolikelihood function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evidenceCJ(
  formula,
  prior.mean = NULL,
  prior.sigma = NULL,
  aux.iters = 1000,
  n.aux.draws = 5,
  aux.thin = 50,
  ladder = 30,
  main.iters = 30000,
  burn.in = 5000,
  thin = 1,
  V.proposal = 1.5,
  num.samples = 25000,
  seed = 1,
  estimate = c("MLE", "CD"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula; an <code>ergm</code> formula object,
of the form  &lt;network&gt; ~ &lt;model terms&gt;
where &lt;network&gt; is a <code>network</code> object
and &lt;model terms&gt; are <code>ergm-terms</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.mean</code></td>
<td>
<p>vector; 
mean vector of the multivariate Normal prior.
By default set to a vector of 0's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.sigma</code></td>
<td>
<p>square matrix; 
variance/covariance matrix for the multivariate Normal prior.
By default set to a diagonal matrix with every diagonal entry equal to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux.iters</code></td>
<td>
<p>count; 
number of auxiliary iterations used for drawing the first network from the ERGM likelihood. 
See <code>control.simulate.formula</code> and <code>ergmAPL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.aux.draws</code></td>
<td>
<p>count; 
number of auxiliary networks drawn from the ERGM likelihood. 
See <code>control.simulate.formula</code> and <code>ergmAPL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux.thin</code></td>
<td>
<p>count; 
number of auxiliary iterations between network draws after the first network is drawn. 
See <code>control.simulate.formula</code> and <code>ergmAPL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ladder</code></td>
<td>
<p>count; length of temperature ladder (&gt;=3). 
See <code>ergmAPL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.iters</code></td>
<td>
<p>count; 
number of MCMC iterations after burn-in for the adjusted pseudo-posterior estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>count; 
number of burn-in iterations at the beginning of an MCMC run 
for the adjusted pseudo-posterior estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>count; 
thinning interval used in the simulation for the adjusted pseudo-posterior estimation. 
The number of MCMC iterations must be divisible by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.proposal</code></td>
<td>
<p>count; 
diagonal entry for the multivariate Normal proposal.
By default set to 1.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.samples</code></td>
<td>
<p>integer; 
number of samples used in the marginal likelihood estimate. 
Must be lower than <code>main.iters</code> - <code>burnin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer; seed for the random number generator. 
See <code>set.seed</code> and <code>MCMCmetrop1R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>If "MLE" (the default), then an approximate maximum likelihood estimator is returned. If "CD" , the Monte-Carlo contrastive divergence estimate is returned. See <code>ergm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, to be passed to the ergm function. 
See <code>ergm</code> and <code>ergmAPL</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Caimo, A., &amp; Friel, N. (2013). Bayesian model selection for exponential random graph models. 
Social Networks, 35(1), 11-24. <a href="https://arxiv.org/abs/1201.2337">https://arxiv.org/abs/1201.2337</a>
</p>
<p>Bouranis, L., Friel, N., &amp; Maire, F. (2018). Bayesian model selection for exponential 
random graph models via adjusted pseudolikelihoods. 
Journal of Computational and Graphical Statistics, 27(3), 516-528. 
<a href="https://arxiv.org/abs/1706.06344">https://arxiv.org/abs/1706.06344</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Load the florentine marriage network:
data(florentine)
                                                
# MCMC sampling and evidence estimation:
CJE &lt;- evidenceCJ(flomarriage ~ edges + kstar(2),
                  main.iters  = 2000,
                  burn.in     = 200,
                  aux.iters   = 500,
                  num.samples = 25000,
                  V.proposal  = 2.5)
                                   
# Posterior summaries:
summary(CJE)

# MCMC diagnostics plots:
plot(CJE)
    
# Log-evidence (marginal likelihood) estimate:
CJE$log.evidence

## End(Not run)

</code></pre>


</div>