<div class="container">

<table style="width: 100%;"><tr>
<td>rivGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler for Linear "IV" Model</h2>

<h3>Description</h3>

<p><code>rivGibbs</code> is a Gibbs Sampler for a linear structural equation with an arbitrary number of instruments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rivGibbs(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(y, x, w, z)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(md, Ad, mbg, Abg, nu, V)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">x = z'\delta + e1</code> <br><code class="reqn">y = \beta*x + w'\gamma + e2</code> <br><code class="reqn">e1,e2</code> <code class="reqn">\sim</code> <code class="reqn">N(0, \Sigma)</code> 
</p>
<p>Note: if intercepts are desired in either equation, include vector of ones in <code class="reqn">z</code> or <code class="reqn">w</code>
</p>
<p><code class="reqn">\delta</code>            <code class="reqn">\sim</code> <code class="reqn">N(md, Ad^{-1})</code> <br><code class="reqn">vec(\beta,\gamma)</code> <code class="reqn">\sim</code> <code class="reqn">N(mbg, Abg^{-1})</code> <br><code class="reqn">\Sigma</code>            <code class="reqn">\sim</code> <code class="reqn">IW(nu, V)</code>
</p>



<h4>Argument Details</h4>

<p><em><code>Data = list(y, x, w, z)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>y:      </code> </td>
<td style="text-align: left;"> <code class="reqn">n x 1</code> vector of obs on LHS variable in structural equation </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>x:      </code> </td>
<td style="text-align: left;"> <code class="reqn">n x 1</code> vector of obs on "endogenous" variable in structural equation </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>w:      </code> </td>
<td style="text-align: left;"> <code class="reqn">n x j</code> matrix of obs on "exogenous" variables in the structural equation </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>z:      </code> </td>
<td style="text-align: left;"> <code class="reqn">n x p</code> matrix of obs on instruments
  </td>
</tr>
</table>
<p><em><code>Prior = list(md, Ad, mbg, Abg, nu, V)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>md:     </code> </td>
<td style="text-align: left;"> <code class="reqn">p</code>-length prior mean of delta (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Ad:     </code> </td>
<td style="text-align: left;"> <code class="reqn">p x p</code> PDS prior precision matrix for prior on delta (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mbg:    </code> </td>
<td style="text-align: left;"> <code class="reqn">(j+1)</code>-length prior mean vector for prior on beta,gamma (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Abg:    </code> </td>
<td style="text-align: left;"> <code class="reqn">(j+1)x(j+1)</code> PDS prior precision matrix for prior on beta,gamma (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nu:     </code> </td>
<td style="text-align: left;"> d.f. parameter for Inverted Wishart prior on Sigma (def: 5) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>V:      </code> </td>
<td style="text-align: left;"> <code class="reqn">2 x 2</code> location matrix for Inverted Wishart prior on Sigma (def: nu*I)
  </td>
</tr>
</table>
<p><em><code>Mcmc = list(R, keep, nprint)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:      </code> </td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:   </code> </td>
<td style="text-align: left;"> MCMC thinning parameter: keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint: </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print)
  </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>deltadraw </code></td>
<td>
 <p><code class="reqn">R/keep x p</code> matrix of delta draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betadraw  </code></td>
<td>
 <p><code class="reqn">R/keep x 1</code> vector of beta draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammadraw </code></td>
<td>
 <p><code class="reqn">R/keep x j</code> matrix of gamma draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigmadraw </code></td>
<td>
 <p><code class="reqn">R/keep x 4</code> matrix of Sigma draws â€“ each row is the vector form of Sigma</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rob McCulloch and Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p> For further discussion, see Chapter 5, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=2000} else {R=10}
set.seed(66)

simIV = function(delta, beta, Sigma, n, z, w, gamma) {
  eps = matrix(rnorm(2*n),ncol=2) %*% chol(Sigma)
  x = z%*%delta + eps[,1]
  y = beta*x + eps[,2] + w%*%gamma
  list(x=as.vector(x), y=as.vector(y)) 
  }
  
n = 200
p=1 # number of instruments
z = cbind(rep(1,n), matrix(runif(n*p),ncol=p))
w = matrix(1,n,1)
rho = 0.8
Sigma = matrix(c(1,rho,rho,1), ncol=2)
delta = c(1,4)
beta = 0.5
gamma = c(1)
simiv = simIV(delta, beta, Sigma, n, z, w, gamma)

Data1 = list(); Data1$z = z; Data1$w=w; Data1$x=simiv$x; Data1$y=simiv$y
Mcmc1=list(); Mcmc1$R = R; Mcmc1$keep=1

out = rivGibbs(Data=Data1, Mcmc=Mcmc1)

cat("Summary of Beta draws", fill=TRUE)
summary(out$betadraw, tvalues=beta)

cat("Summary of Sigma draws", fill=TRUE)
summary(out$Sigmadraw, tvalues=as.vector(Sigma[upper.tri(Sigma,diag=TRUE)]))

## plotting examples
if(0){plot(out$betadraw)}
</code></pre>


</div>