<div class="container">

<table style="width: 100%;"><tr>
<td>BAMMlikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate <code>BAMM</code> likelihood</h2>

<h3>Description</h3>

<p>Calculates the likelihood of a phylogeny exactly as is done
by <code>BAMM</code>, given a set of events.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BAMMlikelihood(
  phy,
  eventdata,
  gen = "last",
  segLength = 0.02,
  sf = 1,
  return.intermediates = FALSE,
  e_prob_condition = "if_different",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>Either an object of class <code>phylo</code> or the path to a tree
file in newick format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eventdata</code></td>
<td>
<p>A table of event data, as returned by <code>BAMM</code>, either
as an object of class <code>dataframe</code> or as the path to an event_data
file. Alternatively, a named numeric vector of length two holding
speciation ("lambda") and extinction ("mu") rates for the
constant-rate birth-death process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>The <code>BAMM</code> generation for which the likelihood should be
calculated. Can be an integer specifying a specific generation, or
<code>last</code>, specifying the last generation, or <code>all</code>, in which
case the likelihood will be calculated for all generations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segLength</code></td>
<td>
<p>The relative segment length, exactly as defined for
<code>BAMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>The sampling fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.intermediates</code></td>
<td>
<p>Debugging option, returns augmented
<code>phylo</code> objects for each generation, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e_prob_condition</code></td>
<td>
<p>Approach for how extinction probabilities are
handled at nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments that will be passed to an internal
function <code>computeBAMMlikelihood</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows the user to check the likelihoods computed
by <code>BAMM</code> using an independent R-based implementation. This is
designed to provide a check on potential software bugs that might be
introduced during future <code>BAMM</code> development and which might
compromise the likelihood calculation. If you observe measurable
discrepancies between the likelihood computed by this function and the
corresponding likelihood returned by <code>BAMM</code>, please inform the
<code>BAMM</code> development team.
</p>


<h3>Value</h3>

<p>If <code>return.intermediates == TRUE</code>, then <code>phylo</code> objects
are returned with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>event_times</code></td>
<td>
<p>A list of length (number of nodes), where
event_times[[k]] is the vector of absolute times, in order, of
events that happened on a focal branch. If no event, it is
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_id</code></td>
<td>
<p>A list of length equal to number of nodes, as
event_times, but holding the corresponding event id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>A dataframe giving parameters and associated nodes (and
unique index values) of the event data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_event</code></td>
<td>
<p>The event governing the process realized at the
node. This will be the first event encountered as one moves
rootwards towards the tips from the focal node.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dan Rabosky, Pascal Title
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a global sampling fraction of 0.98 was used in generating the whales
# dataset.
data(whales, events.whales, mcmc.whales)

x &lt;- BAMMlikelihood(whales, events.whales, gen = 'last', sf = 0.98)

# Does the likelihood generated by BAMM match the R implementation?
identical(round(x, 3), mcmc.whales[nrow(mcmc.whales), 'logLik'])

# an example with a constant-rate birth-death process:
pars &lt;- c(0.5, 0.45)
names(pars) &lt;- c("lambda", "mu")
BAMMlikelihood(whales, pars, sf = 0.98)
</code></pre>


</div>