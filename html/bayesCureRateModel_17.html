<div class="container">

<table style="width: 100%;"><tr>
<td>plot.bayesCureModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot method
</h2>

<h3>Description</h3>

<p>Plots and computes HDIs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'bayesCureModel'
plot(x, burn = NULL, alpha = 0.05, gamma_mix = TRUE, 
	K_gamma = 5, plot_graphs = TRUE, bw = "nrd0", what = NULL, predict_output = NULL,  
	index_of_main_mode = NULL, draw_legend = TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of class <code>bayesCureModel</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>Number of iterations to discard as burn-in period.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>A value between 0 and 1 in order to compute the 1-<code class="reqn">\alpha</code> Highest Posterior Density regions. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_mix</code></td>
<td>

<p>Boolean. If TRUE, the density of the marginal posterior distribution of the <code class="reqn">\gamma</code> parameter is estimated from the sampled MCMC values by fitting a normal mixture  model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_gamma</code></td>
<td>

<p>Used only when <code>gamma_mix = TRUE</code> and corresponds to the number of normal mixture components used to estimate the marginal posterior density of the <code class="reqn">\gamma</code> parameter. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_graphs</code></td>
<td>

<p>Boolean, if FALSE only HDIs are computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>

<p>bandwidth
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>

<p>Integer or a character string with possible values equal to <code>'cured_prob'</code>, <code>'survival'</code> or <code>'residuals'</code>.
An integer entry indicates which parameter should be plotted. If set to <code>NULL</code> (default), all parameters are plotted one by one. If set to <code>'cured_prob'</code> or <code>'survival'</code> the estimated cured probability or survival function is plotted, conditional on a set of covariates defined in the <code>p_cured_output</code> argument. In case where <code>what = 'residuals'</code> the residuals of the fitted model are plotted versus the quantity <code class="reqn">-log(S)</code> where <code class="reqn">S</code> denotes the estimated survival function arising from the Kaplan-Meier estimate based on the residuals and the censoring times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict_output</code></td>
<td>

<p>Optional argument which is required only when <code>what = 'cured_prob'</code> or <code>what = 'survival'</code>. It is returned by a call to the <code>predict.bayesCureModel</code> function.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_of_main_mode</code></td>
<td>

<p>If NULL (default), the whole MCMC output is used for plotting. Otherwise, it is a subset of the retained MCMC iterations in order to identify the main mode of the posterior distribution, as returned by the <code>index_of_main_mode</code> value of the <code>summary.bayesCureRateModel</code> function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw_legend</code></td>
<td>

<p>Boolean. If TRUE (default), a legend is plotted in the case where <code>what = 'survival'</code> or <code>what = 'cured_prob'</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments passed by other methods.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function plots graphic output on the plot device if <code>plot_graphs = TRUE</code>. Furthermore, a list of <code class="reqn">100(1-\alpha)\%</code> Highest Density Intervals per parameter is returned. 
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate toy data just for cran-check purposes        
	set.seed(10)
        n = 4
        # censoring indicators
        stat = rbinom(n, size = 1, prob = 0.5)
        # covariates
        x &lt;- matrix(rnorm(2*n), n, 2)
        # observed response variable 
        y &lt;- rexp(n)
#	define a data frame with the response and the covariates        
        my_data_frame &lt;- data.frame(y, stat, x1 = x[,1], x2 = x[,2])
# run a weibull model with default prior setup
# considering 2 heated chains 
	fit1 &lt;- cure_rate_MC3(survival::Surv(y, stat) ~ x1 + x2, data = my_data_frame, 
		promotion_time = list(distribution = 'exponential'),
		nChains = 2, 
		nCores = 1, 
		mcmc_cycles = 3, sweep=2)
	mySummary &lt;- summary(fit1, burn = 0)
	# plot the marginal posterior distribution of the first parameter in returned mcmc output
	plot(fit1, what = 1, burn = 0)


</code></pre>


</div>