<div class="container">

<table style="width: 100%;"><tr>
<td>fitUrsaModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>URSA Response Surface Fitting</h2>

<h3>Description</h3>

<p>Fits the universal response surface approach (URSA) model to the given
data (Greco, Park, and Rustum 1990)
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitUrsaModel(
  formula,
  data,
  weights = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL
)

## S3 method for class 'formula'
fitUrsaModel(
  formula,
  data,
  weights = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL
)

## Default S3 method:
fitUrsaModel(
  formula,
  data,
  weights = NULL,
  direction = 0,
  lower = NULL,
  upper = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Either an object of class <code>formula</code> such as would be provided
to a modeling function like <code>stats::lm()</code>, or a width-2 numeric array vector
of concentration pairs (including 0 or Inf).  A formula should specify a
single output as a function of two inputs, eg. <code>activity ~ conc1 + conc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>If <code>forumula</code> is a symbolic formula, a data frame containing the
specified values. If <code>formula</code> is a numeric array of concentrations, a
numeric vector of response values, the same length as the number of rows of
<code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>A vector of weights (between 0 and 1) the same length as
the data which determines the weight with which each measurement
will impact the the sum of squared errors.  Weights will be multiplied by
errors <em>before</em> squaring.  If <code>NULL</code> (the default) all weights will be set
to 1. Can be a numeric vector, or the name of a column in <code>data</code> if <code>formula</code>
is a symbolic formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>Determines the possible directionality of the BRAID
model.  If 0 (the default) no additional constraints are placed on the
parameters.  If greater than 0, the fitting will require that the maximal
effects are all <em>greater</em> than or equal to the minimal effect.  If less
than 0, the fitting will require that all maximal effect is <em>less</em> than or
equal to the minimal effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>An optional set of lower bounds on the seven URSA response
parameters.  Any values set to NA will be filled with default calculated
bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>An optional set of upper bounds on the seven URSA response
parameters.  Any values set to NA will be filled with default calculated
bounds.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>braidAltFit</code> with the following values:
</p>

<ul>
<li> <p><code>concs</code>: The array of concentrations passed to the functions
</p>
</li>
<li> <p><code>act</code>: The vector of measurements associated with the given dose pairs
</p>
</li>
<li> <p><code>weights</code>: The vector of weights for the given measurements, set to 1 for
all measurements by default
</p>
</li>
<li> <p><code>method</code>: Specifying the alternate surface model being used (in this case
"URSA")
</p>
</li>
<li> <p><code>coefficients</code>: A length-seven parameter vector specifying the URSA
response surface
</p>
</li>
<li> <p><code>fitted.values</code>: The predicted response surface value for the given dose
pairs and best-fit response surface
</p>
</li>
<li> <p><code>residuals</code>: The difference between the predicted and measured values for
the given dose pairs, always equal to "measured minus predicted"
</p>
</li>
<li> <p><code>direction</code>: The direction value passed to the function
</p>
</li>
<li> <p><code>pbounds</code>': A 2-by-7 array of bounds on the URSA parameters used in the
parameter optimization
</p>
</li>
</ul>
<h3>References</h3>

<p>Greco, William R, Hyoung Sook Park, and Youcef M Rustum. 1990.
“Application of a New Approach for the Quantitation of Drug Synergism to
the Combination of Cis-Diamminedichloroplatinum and
1-b-d-Arabinofuranosylcytosine.” <em>Cancer Research</em> <strong>50</strong> (17): 5318–27.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ufit1 &lt;- fitUrsaModel(measure ~ concA + concB, additiveExample)
coef(ufit1)

ufit2 &lt;- fitUrsaModel(measure ~ concA + concB, synergisticExample,
                      direction = 1, lower=c(NA, NA, NA, NA, NA, 0, 0))
coef(ufit2)
</code></pre>


</div>