<div class="container">

<table style="width: 100%;"><tr>
<td>BCfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a BayesComm model
</h2>

<h3>Description</h3>

<p><code>BCfit</code> is the workhorse function for the BayesComm model.
It is highly recommended to use the wrapper function <code>BC</code> which checks inputs and sets up different model types and initial values.
<code>BCfit</code> arguments can be accessed through <code>BC</code> using the <code>...</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BCfit(y, X, covlist, R, z, mu, updateR, iters, thin = 1, burn = 0,
	priW = c(nrow(z) + 2 * ncol(z), 2 * ncol(z)), verbose = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>matrix of species presence/absence data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>matrix of environmental covariates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covlist</code></td>
<td>

<p>optional list of which covariates to assign to each species
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>initial values for correlation matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>initial values for z
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>initial values for mu
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateR</code></td>
<td>

<p>logical; if true the correlation matrix is updated, if false it is fixed at <code>R</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>

<p>total number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>amount to thin the posterior chains. Defaults to 1 (no thinning)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>number of iterations to discard at the beginning of the chain
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priW</code></td>
<td>

<p>prior specification for correlation matrix W
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>how often to print updates to the console.  <code>0</code> for no updates. <code>1</code> for
updates every <code>thin</code> iterations after burnin.  <code>2</code> for updates every iteration.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>priW</code> specifies the inverse Wishart prior on the unknown and unidentifiable covariance matrix W from which the correlation matrix R is derived.
<code>priW</code> is a vector of length two, the first element specifies the degrees of freedom, the second element is multiplied by an identity matrix to form the scale matrix.
The default for <code>priW</code> is c(n + 2p, 2p), where n is the number of records and p is the number of species in the community; this therefore forms the prior: iW(n + 2p, 2pI).
This prior was determined to exert minimal influence on the posterior of R whilst limiting dependence of R on the unidentifiable variance parameters of W.<br><br>
For further details on how to specify <code>Y</code>, <code>X</code> and <code>covlist</code> see <code>BC</code>.
</p>


<h3>Value</h3>

<p>A list containing elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>samples from posteriors of the correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>samples from posteriors of regression coefficients (a list of matrices)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>samples from posteriors of latent variables z</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>BC</code>
</p>


</div>