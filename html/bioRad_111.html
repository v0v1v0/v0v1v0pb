<div class="container">

<table style="width: 100%;"><tr>
<td>plot.vpts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a time series of vertical profiles (<code>vpts</code>)</h2>

<h3>Description</h3>

<p>Plot a time series of vertical profiles  of class <code>vpts</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'vpts'
plot(
  x,
  xlab = "time",
  ylab = "height [m]",
  quantity = "dens",
  log = NA,
  barbs = TRUE,
  barbs_height = 10,
  barbs_time = 20,
  barbs_dens_min = 5,
  zlim,
  legend_ticks,
  legend.ticks,
  main,
  barbs.h = 10,
  barbs.t = 20,
  barbs.dens = 5,
  na_color = "#C8C8C8",
  nan_color = "white",
  n_color = 1000,
  palette = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vp class object inheriting from class <code>vpts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A title for the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A title for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantity</code></td>
<td>
<p>Character string with the quantity to plot,
one of '<code>dens</code>','<code>eta</code>','<code>dbz</code>','<code>DBZH</code>' for density,
reflectivity, reflectivity factor and total reflectivity factor,
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical, whether to display <code>quantity</code> data on a
logarithmic scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs</code></td>
<td>
<p>Logical, whether to overlay speed barbs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs_height</code></td>
<td>
<p>Integer, number of barbs to plot in altitudinal dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs_time</code></td>
<td>
<p>Integer, number of barbs to plot in temporal dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs_dens_min</code></td>
<td>
<p>Numeric, lower threshold in aerial density of individuals
for plotting speed barbs in individuals/km^3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>Optional numerical atomic vector of length 2, specifying the
range of <code>quantity</code> values to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_ticks</code></td>
<td>
<p>Numeric atomic vector specifying the ticks on the
color bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.ticks</code></td>
<td>
<p>Deprecated argument, use legend_ticks instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs.h</code></td>
<td>
<p>Deprecated argument, use barbs_height instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs.t</code></td>
<td>
<p>Deprecated argument, use barbs_time instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barbs.dens</code></td>
<td>
<p>Deprecated argument, use barbs_dens_min instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_color</code></td>
<td>
<p>Color to use for NA values, see class <code>vpts()</code> conventions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nan_color</code></td>
<td>
<p>Color to use for NaN values, see class <code>vpts()</code> conventions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_color</code></td>
<td>
<p>The number of colors (&gt;=1) to be in the palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>(Optional) character vector of hexadecimal color values defining
the plot color scale, e.g. output from viridis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to the low level
image plotting function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Aerial abundances can be visualized in four related quantities, as specified
by argument <code>quantity</code>:
</p>

<ul>
<li> <p><code>dens</code>: the aerial density of individuals. This quantity is dependent on
the assumed radar cross section (RCS) in the <code>x$attributes$how$rcs_bird</code>
attribute
</p>
</li>
<li> <p><code>eta</code>: reflectivity. This quantity is independent of the value of the
<code>rcs_bird</code> attribute
</p>
</li>
<li> <p><code>dbz</code>: reflectivity factor. This quantity is independent of the value of
the <code>rcs_bird</code> attribute, and corresponds to the dBZ scale commonly used in
weather radar meteorology. Bioscatter by birds tends to occur at much
higher reflectivity factors at S-band than at C-band
</p>
</li>
<li> <p><code>DBZH</code>: total reflectivity factor. This quantity equals the reflectivity
factor of all scatterers (biological and meteorological scattering
combined)
</p>
</li>
</ul>
<p>Aerial velocities can be visualized in three related quantities, as specified
by argument <code>quantity</code>:
</p>

<ul>
<li> <p><code>ff</code>: ground speed. The aerial velocity relative to the ground surface in
m/s.
</p>
</li>
<li> <p><code>u</code>: eastward ground speed component in m/s.
</p>
</li>
<li> <p><code>v</code>: northward ground speed component in m/s.
</p>
</li>
</ul>
<h4>barbs</h4>

<p>In the speed barbs, each half flag represents 2.5 m/s, each full flag 5 m/s,
each pennant (triangle) 25 m/s
</p>



<h4>legend_ticks / zlim</h4>

<p>Default legend ticks and plotting range are specified based on <code>quantity</code>,
radar wavelength (S- vs C-band), and value of <code>log</code>
</p>



<h4>log</h4>

<p>Quantities <code>u</code> and <code>v</code> cannot be plotted on a logarithmic scale, because
these quantities assume negative values.  For quantities <code>DBZH</code> and <code>dbz</code>
<code>log=TRUE</code> is ignored, because these quantities are already logarithmic.
</p>



<h3>Value</h3>

<p>No return value, side effect is a plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># locate example file:
ts &lt;- example_vpts
# plot density of individuals for the first 500 time steps, in the altitude
# layer 0-3000 m.
plot(ts[1:500], ylim = c(0, 3000))
# plot total reflectivity factor (rain, birds, insects together):
plot(ts[1:500], ylim = c(0, 3000), quantity = "DBZH")
# regularize the time grid, which includes empty (NA) profiles at
# time steps without data:
ts_regular &lt;- regularize_vpts(ts)
plot(ts_regular)
# change the color of missing NA data to red
plot(ts_regular, na_color="red")
# change the color palette:
plot(ts_regular[1:1000], ylim = c(0, 3000), palette=viridis::viridis(1000))
# change and inverse the color palette:
plot(ts_regular[1:1000], ylim = c(0, 3000), palette=rev(viridis::viridis(1000, option="A")))
# plot the speed profile:
plot(ts_regular[1:1000], quantity="ff")
# plot the northward speed component:
plot(ts_regular[1:1000], quantity="v")
# plot speed profile with more legend ticks,
plot(ts_regular[1:1000], quantity="ff", legend_ticks=seq(0,20,2), zlim=c(0,20))
</code></pre>


</div>