<div class="container">

<table style="width: 100%;"><tr>
<td>ghkvec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute GHK approximation to Multivariate Normal Integrals</h2>

<h3>Description</h3>

<p><code>ghkvec</code> computes the GHK approximation to the integral of a multivariate normal density over a half plane defined by a set of truncation points.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">ghkvec(L, trunpt, above, r, HALTON=TRUE, pn)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L     </code></td>
<td>
<p> lower triangular Cholesky root of covariance matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunpt</code></td>
<td>
<p> vector of truncation points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>above </code></td>
<td>
<p> vector of indicators for truncation above(1) or below(0) on an element by element basis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r     </code></td>
<td>
<p> number of draws to use in GHK </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HALTON</code></td>
<td>
<p> if <code>TRUE</code>, uses Halton sequence. If <code>FALSE</code>, uses <code>R::runif</code> random number generator (def: <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pn    </code></td>
<td>
<p> prime number used for Halton sequence (def: the smallest prime numbers, i.e. 2, 3, 5, ...)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Approximation to integral</p>


<h3>Note</h3>

<p><code>ghkvec</code> can accept a vector of truncations and compute more than one integral. That is, <code>length(trunpt)/length(above)</code> number of different integrals, each with the same variance and mean 0 but different truncation points. See 'examples' below for an example with two integrals at different truncation points. The <code>above</code>
argument specifies truncation from above (1) or below (0) on an element by element basis. Only one vector of above is allowed but multiple truncation points are allowed. 
</p>
<p>The user can choose between two random number generators for the numerical integration: psuedo-random numbers by <code>R::runif</code> or quasi-random numbers by a Halton sequence. Generally, the quasi-random (Halton) sequence is more uniformly distributed within domain, so it shows lower error and improved convergence than the psuedo-random (<code>runif</code>) sequence (Morokoff and Caflisch, 1995). 
</p>
<p>For the prime numbers generating Halton sequence, we suggest to use the first smallest prime numbers. Halton (1960) and Kocis and Whiten (1997) prove that their discrepancy measures (how uniformly the sample points are distributed) have the upper bounds, which decrease as the generating prime number decreases. 
</p>
<p>Note: For a high dimensional integration (10 or more dimension), we suggest use of the psuedo-random number generator (<code>R::runif</code>) because, according to Kocis and Whiten (1997), Halton sequences may be highly correlated when the dimension is 10 or more.
</p>


<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.<br>
Keunwoo Kim, Anderson School, UCLA, <a href="mailto:keunwoo.kim@gmail.com">keunwoo.kim@gmail.com</a>.
</p>


<h3>References</h3>

 
<p>For further discussion, see <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch,  Chapter 2.
</p>
<p>For Halton sequence, see Halton (1960, Numerische Mathematik), Morokoff and Caflisch (1995, Journal of Computational Physics), and Kocis and Whiten (1997, ACM Transactions on Mathematical Software).
</p>


<h3>Examples</h3>

<pre><code class="language-R">Sigma = matrix(c(1, 0.5, 0.5, 1), ncol=2)
L = t(chol(Sigma))
trunpt = c(0,0,1,1)
above = c(1,1) 
# here we have a two dimensional integral with two different truncation points
#    (0,0) and (1,1)
# however, there is only one vector of "above" indicators for each integral
#     above=c(1,1) is applied to both integrals.  

# drawn by Halton sequence
ghkvec(L, trunpt, above, r=100)

# use prime number 11 and 13
ghkvec(L, trunpt, above, r=100, HALTON=TRUE, pn=c(11,13))

# drawn by R::runif
ghkvec(L, trunpt, above, r=100, HALTON=FALSE)
</code></pre>


</div>