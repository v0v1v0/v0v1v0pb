<div class="container">

<table style="width: 100%;"><tr>
<td>model_pres_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model-Preserving co-variation</h2>

<h3>Description</h3>

<p>Model-preserving co-variation for objects of class <code>CI</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_pres_cov(ci, type, entry, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>object of class <code>CI</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string. Type of model-preserving co-variation: either <code>"total"</code>, <code>"partial"</code>, <code>row</code> or <code>column</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entry</code></td>
<td>
<p>a vector of length two specifying the entry of the covariance matrix to vary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>multiplicative variation coefficient for the entry of the covariance matrix given in <code>entry</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let the original Bayesian network have a Normal distribution <code class="reqn">\mathcal{N}(\mu,\Sigma)</code> and let <code>entry</code> be equal to <code class="reqn">(i,j)</code>. For a multiplicative variation of the covariance matrix by an amount <code class="reqn">\delta</code>, a variation matrix <code class="reqn">\Delta</code> is constructed as
</p>
<p style="text-align: center;"><code class="reqn">\Delta_{k,l}=\left\{
\begin{array}{ll}
\delta &amp; \mbox{if } k=i, l=j\\
\delta &amp; \mbox{if } l=i, k=j \\
0 &amp; \mbox{otherwise}
\end{array}
\right.</code>
</p>

<p>A co-variation matrix <code class="reqn">\tilde\Delta</code> is then constructed and the resulting distribution after the variation is <code class="reqn">\mathcal{N}(\mu,\tilde\Delta\circ\Delta\circ\Sigma)</code>, assuming <code class="reqn">\tilde\Delta\circ\Delta\circ\Sigma</code> is positive semi-definite and where <code class="reqn">\circ</code> denotes the Schur (or element-wise) product. The matrix <code class="reqn">\tilde\Delta</code> is so constructed to ensure that all conditional independence in the original Bayesian networks are retained after the parameter variation.
</p>


<h3>Value</h3>

<p>If the resulting covariance is positive semi-definite, <code>model_pres_cov</code> returns an object of class <code>CI</code> with an updated covariance matrix. Otherwise it returns an object of class <code>npsd.ci</code>, which has the same components of <code>CI</code> but also has a warning entry specifying that the covariance matrix is not positive semi-definite.
</p>


<h3>References</h3>

<p>C. GÃ¶rgen &amp; M. Leonelli (2020), Model-preserving sensitivity analysis for families of Gaussian distributions.  Journal of Machine Learning Research, 21: 1-32.
</p>


<h3>See Also</h3>

<p><code>covariance_var</code>, <code>covariation_matrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">model_pres_cov(synthetic_ci,"partial",c(1,3),1.1)
model_pres_cov(synthetic_ci,"partial",c(1,3),0.9)
model_pres_cov(synthetic_ci,"total",c(1,2),0.5)
model_pres_cov(synthetic_ci,"row",c(1,3),0.98)
model_pres_cov(synthetic_ci,"column",c(1,3),0.98)


</code></pre>


</div>