<div class="container">

<table style="width: 100%;"><tr>
<td>sparseVARMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sparse Estimation of the Vector AutoRegressive Moving Average (VARMA) Model</h2>

<h3>Description</h3>

<p>Sparse Estimation of the Vector AutoRegressive Moving Average (VARMA) Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">sparseVARMA(
  Y,
  U = NULL,
  VARp = NULL,
  VARpen = "HLag",
  VARlseq = NULL,
  VARgran = NULL,
  VARselection = c("cv", "bic", "aic", "hq"),
  VARMAp = NULL,
  VARMAq = NULL,
  VARMApen = "HLag",
  VARMAlPhiseq = NULL,
  VARMAPhigran = NULL,
  VARMAlThetaseq = NULL,
  VARMAThetagran = NULL,
  VARMAalpha = 0,
  VARMAselection = c("none", "cv", "bic", "aic", "hq"),
  h = 1,
  cvcut = 0.9,
  eps = 10^-3,
  check_std = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A <code class="reqn">T</code> by <code class="reqn">k</code> matrix of time series. If k=1, a univariate autoregressive moving average model is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>A <code class="reqn">T</code> by <code class="reqn">k</code> matrix of (approximated) error terms. Typical usage is to have the program estimate a high-order VAR model (Phase I) to get approximated error terms U.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARp</code></td>
<td>
<p>User-specified maximum  autoregressive lag order of the PhaseI VAR. Typical usage is to have the program compute its own maximum lag order based on the time series length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARpen</code></td>
<td>
<p>"HLag" (hierarchical sparse penalty) or "L1" (standard lasso penalty) penalization in PhaseI VAR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARlseq</code></td>
<td>
<p>User-specified grid of values for regularization parameter in the PhaseI VAR. Typical usage is to have the program compute
its own grid. Supplying a grid of values overrides this. WARNING: use with care.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARgran</code></td>
<td>
<p>User-specified vector of granularity specifications for the penalty parameter grid of the PhaseI VAR:  First element specifies
how deep the grid should be constructed. Second element specifies how many values the grid should contain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARselection</code></td>
<td>
<p>Selection procedure for the first stage. Default is time series Cross-Validation. Alternatives are BIC, AIC, HQ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAp</code></td>
<td>
<p>User-specified maximum autoregressive lag order of the VARMA. Typical usage is to have the program compute its own maximum lag order based on the time series length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAq</code></td>
<td>
<p>User-specified maximum moving average lag order of the VARMA. Typical usage is to have the program compute its own maximum lag order based on the time series length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMApen</code></td>
<td>
<p>"HLag" (hierarchical sparse penalty) or "L1" (standard lasso penalty) penalization in the VARMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAlPhiseq</code></td>
<td>
<p>User-specified grid of values for regularization parameter corresponding to the autoregressive coefficients in the VARMA. Typical usage is to have the program compute
its own grid. Supplying a grid of values overrides this. WARNING: use with care.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAPhigran</code></td>
<td>
<p>User-specified vector of granularity specifications for the penalty parameter grid corresponding to the autoregressive coefficients in the VARMA:  First element specifies
how deep the grid should be constructed. Second element specifies how many values the grid should contain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAlThetaseq</code></td>
<td>
<p>User-specified grid of values for regularization parameter corresponding to the moving average coefficients in the VARMA. Typical usage is to have the program compute
its own grid. Supplying a grid of values overrides this. WARNING: use with care.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAThetagran</code></td>
<td>
<p>User-specified vector of granularity specifications for the penalty parameter grid corresponding to the moving average coefficients in the VARMA:  First element specifies
how deep the grid should be constructed. Second element specifies how many values the grid should contain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAalpha</code></td>
<td>
<p>a small positive regularization parameter value corresponding to squared Frobenius penalty in  VARMA. The default is zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAselection</code></td>
<td>
<p>selection procedure in the second stage. Default is "none"; Alternatives are cv, bic, aic, hq</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Desired forecast horizon in time-series cross-validation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvcut</code></td>
<td>
<p>Proportion of observations used for model estimation in the time series cross-validation procedure. The remainder is used for forecast evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a small positive numeric value giving the tolerance for convergence in the proximal gradient algorithms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_std</code></td>
<td>
<p>Check whether data is standardised. Default is TRUE and is not recommended to be changed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p><code class="reqn">T</code> by <code class="reqn">k</code> matrix of time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>Matrix of (approximated) error terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARp</code></td>
<td>
<p>Maximum autoregressive lag order of the PhaseI VAR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARPhihat</code></td>
<td>
<p>Matrix of estimated autoregressive coefficients of the Phase I VAR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARphi0hat</code></td>
<td>
<p>Vector of Phase I VAR intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAp</code></td>
<td>
<p>Maximum autoregressive lag order of the VARMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VARMAq</code></td>
<td>
<p>Maximum moving average lag order of the VARMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phihat</code></td>
<td>
<p>Matrix of estimated autoregressive coefficients of the VARMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Thetahat</code></td>
<td>
<p>Matrix of estimated moving average coefficients of the VARMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi0hat</code></td>
<td>
<p>Vector of VARMA intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series_names</code></td>
<td>
<p>names of time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseI_lambas</code></td>
<td>
<p>Phase I sparsity parameter grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseI_MSFEcv</code></td>
<td>
<p>MSFE cross-validation scores for each value of the sparsity parameter in the considered grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseI_lambda_opt</code></td>
<td>
<p>Phase I Optimal value of the sparsity parameter as selected by the time-series cross-validation procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseI_lambda_SEopt</code></td>
<td>
<p>Phase I Optimal value of the sparsity parameter as selected by the time-series cross-validation procedure and after applying the one-standard-error rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_lambdaPhi</code></td>
<td>
<p>Phase II sparsity parameter grid corresponding to Phi parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_lambdaTheta</code></td>
<td>
<p>Phase II sparsity parameter grid corresponding to Theta parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_lambdaPhi_opt</code></td>
<td>
<p>Phase II Optimal value of the sparsity parameter (corresponding to Phi parameters) as selected by the time-series cross-validation procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_lambdaPhi_SEopt</code></td>
<td>
<p>Phase II Optimal value of the sparsity parameter (corresponding to Theta parameters) as selected by the time-series cross-validation procedure and after applying the one-standard-error rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_lambdaTheta_opt</code></td>
<td>
<p>Phase II Optimal value of the sparsity parameter (corresponding to Phi parameters) as selected by the time-series cross-validation procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_lambdaTheta_SEopt</code></td>
<td>
<p>Phase II Optimal value of the sparsity parameter (corresponding to Theta parameters) as selected by the time-series cross-validation procedure and after applying the one-standard-error rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhaseII_MSFEcv</code></td>
<td>
<p>Phase II MSFE cross-validation scores for each value in the two-dimensional sparsity grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Forecast horizon h</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wilms Ines, Sumanta Basu, Bien Jacob and Matteson David S. (2021), “Sparse Identification and
Estimation of Large-Scale Vector AutoRegressive Moving Averages”, Journal of the American Statistical Association, doi: 10.1080/01621459.2021.1942013.
</p>


<h3>See Also</h3>

<p>lagmatrix and directforecast
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(varma.example)
VARMAfit &lt;- sparseVARMA(Y = scale(Y.varma)) # sparse VARMA
y &lt;- matrix(Y.varma[,1], ncol=1)
ARMAfit &lt;- sparseVARMA(Y=scale(y)) # sparse ARMA
</code></pre>


</div>