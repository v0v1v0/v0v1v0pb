<div class="container">

<table style="width: 100%;"><tr>
<td>energy.closure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Energy Balance Closure</h2>

<h3>Description</h3>

<p>Calculates the degree of the energy balance non-closure for the entire time span
based on the ratio of two sums (energy balance ratio), and ordinary least squares (OLS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">energy.closure(
  data,
  Rn = "Rn",
  G = NULL,
  S = NULL,
  LE = "LE",
  H = "H",
  instantaneous = FALSE,
  missing.G.as.NA = FALSE,
  missing.S.as.NA = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame or matrix containing all required variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rn</code></td>
<td>
<p>Net radiation (W m-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Ground heat flux (W m-2); optional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Sum of all storage fluxes (W m-2); optional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LE</code></td>
<td>
<p>Latent heat flux (W m-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Sensible heat flux (W m-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instantaneous</code></td>
<td>
<p>should the energy balance be calculated at the time step 
of the observations (<code>TRUE</code>), or over the entire time period
provided as input (<code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.G.as.NA</code></td>
<td>
<p>if <code>TRUE</code>, missing G are treated as <code>NA</code>s ,otherwise set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.S.as.NA</code></td>
<td>
<p>if <code>TRUE</code>, missing S are treated as <code>NA</code>s, otherwise set to 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The energy balance ratio (EBR) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">EBR = sum(LE + H)/sum(Rn - G - S)</code>
</p>

<p>the sum is taken for all time steps with complete observations (i.e. where
all energy balance terms are available).
</p>


<h3>Value</h3>

<p>a named vector containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of complete (all energy balance terms available) observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>intercept of the OLS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>slope of the OLS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_squared</code></td>
<td>
<p>r^2 of the OLS regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EBR</code></td>
<td>
<p>energy balance ratio</p>
</td>
</tr>
</table>
<p>if <code>instantaneous = TRUE</code>, only <code>EBR</code> is returned.
</p>


<h3>References</h3>

<p>Wilson K., et al. 2002: Energy balance closure at FLUXNET sites.
Agricultural and Forest Meteorology 113, 223-243.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## characterize energy balance closure for DE-Tha in June 2014
energy.closure(DE_Tha_Jun_2014,instantaneous=FALSE)

## look at half-hourly closure 
EBR_inst &lt;- energy.closure(DE_Tha_Jun_2014,instantaneous=TRUE)
summary(EBR_inst)

</code></pre>


</div>