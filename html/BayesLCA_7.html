<div class="container">

<table style="width: 100%;"><tr>
<td>blca.em</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bayesian Latent Class Analysis  via an EM Algorithm
</h2>

<h3>Description</h3>

<p>Latent class analysis (LCA) attempts to find G hidden classes in binary data X. blca.em utilises an expectation-maximisation algorithm to find maximum <em>a posteriori</em> (map) estimates of the parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blca.em(X, G, alpha = 1, beta = 1, delta = 1, 
	start.vals = c("single", "across"), counts.n = NULL,
	iter = 500, restarts = 5, verbose = TRUE, 
	sd = FALSE, se=sd, conv = 1e-06, small = 1e-100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>The data matrix. This may take one of several forms, see <code>data.blca</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>

<p>The number of classes to run lca for.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, beta</code></td>
<td>

<p>The prior values for the data conditional on group membership. These may take several forms: a single value, recycled across all groups and columns, a vector of length G or M (the number of columns in the data), or finally, a <code class="reqn">G \times M</code> matrix specifying each prior value separately. Defaults to 1, i.e, a uniform prior, for each value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>Prior values for the mixture components in model.  Defaults to 1, i.e., a uniform prior.  May be single or vector valued (of length G).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.vals</code></td>
<td>

<p>Denotes how class membership is to be assigned during the initial step of the algorithm. Two character values may be chosen, "single", which randomly assigns data points exclusively to one class, or "across", which assigns class membership via  <code>runif</code>. Alternatively, class membership may be pre-specified, either as a vector of class membership, or as a matrix of probabilities. Defaults to "single".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts.n</code></td>
<td>

<p>If data patterns have already been counted, a data matrix consisting of each unique data pattern can be supplied to the function, in addition to a vector counts.n, which supplies the corresponding number of times each pattern occurs in the data. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>The maximum number of iterations that the algorithm runs over.  Will stop early if the algorithm is deemed to converge.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restarts</code></td>
<td>

<p><code>restarts</code> determines how many times the algorithm is run with different starting values. Parameter estimates from the run which achieved the highest log-posterior are returned. If starting values are supplied, these are used for the first run, after which random starting points are used. Defaults to 5. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical valued. If <code>TRUE</code>, the log-posterior from each run is printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>

<p>Specifies whether posterior standard deviation estimates should also be returned. If TRUE, calls to blca.em.sd.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>Similarly to <code>sd</code>, specifies whether posterior standard deviation estimates should also be returned, however, its use is discouraged. Should always agree with <code>sd</code>. Retained for backwards compatability reasons. See ‘Note’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>Convergence criteria, i.e., how small should the log-posterior increase become before the algorithm is deemed to have converged?  Set relative to the size of the data matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>small</code></td>
<td>

<p>To ensure numerical stability a small constant is added to certain parameter estimates. Defaults to 1e-100.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Regardless of the form of the data supplied to <code>blca.em</code>, it is internally converted to be of the form <code>data.blca</code>.  In particular, this should be noted when supplying starting values: the object must be of either the same length or have the same number of rows as the number of <b>unique</b> observations in the dataset, as opposed to the total number.
</p>
<p>Posterior standard deviations and convergence checks are calculated using <code>blca.em.sd</code>. 
</p>


<h3>Value</h3>






<p>A list of class "blca.em" is returned, containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The initial call passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itemprob</code></td>
<td>
<p>The item probabilities, conditional on class membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classprob</code></td>
<td>
<p>The class probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Estimate of class membership for each unique datapoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itemprob.sd</code></td>
<td>
<p>If returned, standard error estimates of the item probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classprob.sd</code></td>
<td>
<p>If returned, standard error estimates of the class probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logpost</code></td>
<td>
<p>The log-posterior of the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>The Bayesian Information Criterion for the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Akaike's Information Criterion for the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations required before convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poststore </code></td>
<td>
<p>The value of the log-posterior for each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The value for which the algorithm was deemed to have converged at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p> The number of times each unique datapoint point occured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpstarts</code></td>
<td>
<p> The log-posterior achieved after each of the multiple starts of the algorithm. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>If posterior standard deviations are calculated, then the Hessian of the model is also checked to determine whether the algorithm has converged to at least a local maximum. The convergence status is calculated by an integer value: 1 denotes acceptable convergence, 2 denotes that it converged at a saddle point, 3 that the algorithm ended before it had satisfactorily converged  and 4 denotes that at least one parameter value converged at a boundary value (i.e., a 1 or 0). 0 denotes that the algorithm converged satisfactorily but that the Hessian has not been checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A list containing the prior values specified for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>A logical value indicating whether standard error estimates were returned. </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Earlier versions of this function erroneously referred to posterior standard deviations as standard errors. This also extended to arguments supplied to and returned by the function, some of which are now returned with the corrected corrected suffix <code>blca.em.sd</code> (for standard deviation). For backwards compatability reasons, the earlier suffix <code>.se</code> has been retained as a returned argument.
</p>


<h3>Author(s)</h3>

<p>Arthur White
</p>


<h3>References</h3>


<p>Dempster AP, Laird NM, Rubin DB (1977). “Maximum Likelihood from Incomplete Data via 
the EM Algorithm.” Journal of the Royal Statistical Society. Series B (Methodological), <b>39(1)</b>, 
pp. 1–38. ISSN 00359246. doi:10.2307/2984875. URL http://dx.doi.org/10.2307/2984875.
</p>


<h3>See Also</h3>

<p><code>blca</code>,<code>blca.em.sd</code>, <code>blca.boot</code>, <code>blca.vb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">type1 &lt;- c(0.8, 0.8, 0.2, 0.2)
type2 &lt;- c(0.2, 0.2, 0.8, 0.8)
x &lt;- rlca(1000, rbind(type1,type2), c(0.6,0.4))

fit &lt;- blca.em(x, 2)
print(fit)
fit &lt;- blca.em(x, 2, sd=TRUE) ##Returns posterior standard deviations
summary(fit)
plot(fit)

## Different starting values
fit &lt;- blca.em(x, 2, start.vals="across")
xx &lt;- data.blca(x)
fit &lt;- blca.em(xx, 2, start.vals=sample(1:2, length(xx$counts) , replace=TRUE))
</code></pre>


</div>