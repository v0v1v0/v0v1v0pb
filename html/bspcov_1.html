<div class="container">

<table style="width: 100%;"><tr>
<td>bandPPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Estimation of a Banded Covariance Matrix</h2>

<h3>Description</h3>

<p>Provides a post-processed posterior for Bayesian inference of a banded covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bandPPP(X, k, eps, prior = list(), nsample = 2000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a n <code class="reqn">\times</code> p data matrix with column mean zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a scalar value (natural number) specifying the bandwidth of covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a small positive number decreasing to <code class="reqn">0</code> with default value <code class="reqn">(log(k))^2 * (k + log(p))/n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list giving the prior information.
The list includes the following parameters (with default values in parentheses):
<code>A (I)</code> giving the positive definite scale matrix for the inverse-Wishart prior,
<code>nu (p + k)</code> giving the degree of freedom of the inverse-Wishar prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>a scalar value giving the number of the post-processed posterior samples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Lee, Lee, and Lee (2023+) proposed a two-step procedure generating samples from the post-processed posterior for Bayesian inference of a banded covariance matrix:
</p>

<ul>
<li>
<p> Initial posterior computing step: Generate random samples from the following initial posterior obtained by using the inverse-Wishart prior <code class="reqn">IW_p(B_0, \nu_0)</code>
</p>
<p style="text-align: center;"><code class="reqn">
 \Sigma \mid X_1, \ldots, X_n \sim IW_p(B_0 + nS_n, \nu_0 + n),
 </code>
</p>

<p>where <code class="reqn">S_n = n^{-1}\sum_{i=1}^{n}X_iX_i^\top</code>.
</p>
</li>
<li>
<p> Post-processing step: Post-process the samples generated from the initial samples
</p>
<p style="text-align: center;"><code class="reqn">
 \Sigma_{(i)} := \left\{\begin{array}{ll}B_{k}(\Sigma^{(i)}) + \left[\epsilon_n - \lambda_{\min}\{B_{k}(\Sigma^{(i)})\}\right]I_p, &amp;
 \mbox{ if } \lambda_{\min}\{B_{k}(\Sigma^{(i)})\} &lt; \epsilon_n, \\
 B_{k}(\Sigma^{(i)}), &amp; \mbox{ otherwise },
 \end{array}\right.
 </code>
</p>

</li>
</ul>
<p>where <code class="reqn">\Sigma^{(1)}, \ldots, \Sigma^{(N)}</code> are the initial posterior samples,
<code class="reqn">\epsilon_n</code> is a small positive number decreasing to <code class="reqn">0</code> as <code class="reqn">n \rightarrow \infty</code>,
and <code class="reqn">B_k(B)</code> denotes the <code class="reqn">k</code>-band operation given as
</p>
<p style="text-align: center;"><code class="reqn">
B_{k}(B) = \{b_{ij}I(|i - j| \le k)\} \mbox{ for any } B = (b_{ij}) \in R^{p \times p}.
</code>
</p>

<p>For more details, see Lee, Lee and Lee (2023+).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>a nsample <code class="reqn">\times</code> p(p+1)/2 matrix including lower triangular elements of covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>dimension of covariance matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kwangmin Lee
</p>


<h3>References</h3>

<p>Lee, K., Lee, K., and Lee, J. (2023+), "Post-processes posteriors for banded covariances",
<em>Bayesian Analysis</em>, DOI: 10.1214/22-BA1333.
</p>


<h3>See Also</h3>

<p>cv.bandPPP estimate
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n &lt;- 25
p &lt;- 50
Sigma0 &lt;- diag(1, p)
X &lt;- MASS::mvrnorm(n = n, mu = rep(0, p), Sigma = Sigma0)
res &lt;- bspcov::bandPPP(X,2,0.01,nsample=100)

</code></pre>


</div>