<div class="container">

<table style="width: 100%;"><tr>
<td>halving</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability mass function for halving</h2>

<h3>Description</h3>

<p>Calculate the probability mass function for the number of tests
from using the halving algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">halving(p, Se = 1, Sp = 1, stages = 2, order.p = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector of individual risk probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Se</code></td>
<td>
<p>sensitivity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sp</code></td>
<td>
<p>specificity of the diagnostic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stages</code></td>
<td>
<p>the number of stages for the halving algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.p</code></td>
<td>
<p>logical; if TRUE, the vector of individual risk probabilities
will be sorted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Halving algorithms involve successively splitting a positive
testing group into two equal-sized halves (or as close to equal as possible)
until all individuals have been identified as positive or negative.
<code class="reqn">S</code>-stage halving begins by testing the whole group of <code class="reqn">I</code>
individuals. Positive groups are split in half until the final stage of the
algorithm, which consists of individual testing. For example, consider an
initial group of size <code class="reqn">I=16</code> individuals. Three-stage halving (3H)
begins by testing the whole group of 16 individuals. If this group tests
positive, the second stage involves splitting into two groups of size 8.
If either of these groups test positive, a third stage involves testing each
individual rather than halving again. Four-stage halving (4H) would continue
with halving into groups of size 4 before individual testing. Five-stage
halving (5H) would continue with halving into groups of size 2 before
individual testing. 3H requires more than 2 individuals, 4H requires more
than 4 individuals, and 5H requires more than 8 individuals.
</p>
<p>This function calculates the probability mass function, expected testing
expenditure, and variance of the testing expenditure for halving algorithms
with 3 to 5 stages.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pmf</code></td>
<td>
<p>the probability mass function for the halving algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>et</code></td>
<td>
<p>the expected testing expenditure for the halving algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vt</code></td>
<td>
<p>the variance of the testing expenditure for the halving
algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector containing the probabilities of positivity for each individual.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This function was originally written by Michael Black for Black
et al. (2012). The function was obtained from
<a href="http://chrisbilder.com/grouptesting/">http://chrisbilder.com/grouptesting/</a>. Minor modifications have been
made for inclusion of the function in the <code>binGroup2</code> package.
</p>


<h3>References</h3>

<p>Black, M., Bilder, C., Tebbs, J. (2012).
“Group testing in heterogeneous populations by using halving algorithms.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>61</b>, 277–290.
</p>


<h3>See Also</h3>

<p><code>expectOrderBeta</code> for generating a vector of individual risk
probabilities for informative group testing.
</p>
<p>Other operating characteristic functions: 
<code>GroupMembershipMatrix()</code>,
<code>Sterrett()</code>,
<code>TOD()</code>,
<code>operatingCharacteristics1()</code>,
<code>operatingCharacteristics2()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Equivalent to Dorfman testing (two-stage hierarchical)
halving(p = rep(0.01, 10), Se = 1, Sp = 1, stages = 2,
        order.p = TRUE)

# Halving over three stages; each individual has a
#   different probability of being positive
set.seed(12895)
p.vec &lt;- expectOrderBeta(p = 0.05, alpha = 2, size = 20)
halving(p = p.vec, Se = 0.95, Sp = 0.95, stages = 3,
        order.p = TRUE)
</code></pre>


</div>