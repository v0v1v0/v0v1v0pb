<div class="container">

<table style="width: 100%;"><tr>
<td>HD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Historical Decompositions</h2>

<h3>Description</h3>

<p>Historical Decompositions
</p>


<h3>Usage</h3>

<pre><code class="language-R">HD(results, cri = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>List containing the results from running BH_SBVAR().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cri</code></td>
<td>
<p>credibility intervals for the estimates to be returned (default = 0.95). A value of 0.95 will return 95% credibility intervals. A value of 0.90 will return 90% credibility intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes historical decomposition estimates.
</p>


<h3>Value</h3>

<p>An array containing historical decomposition estimates.
</p>


<h3>Author(s)</h3>

<p>Paul Richardson
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Import data
library(BHSBVAR)
set.seed(123)
data(USLMData)
y0 &lt;- matrix(data = c(USLMData$Wage, USLMData$Employment), ncol = 2)
y &lt;- y0 - (matrix(data = 1, nrow = nrow(y0), ncol = ncol(y0)) %*% 
             diag(x = colMeans(x = y0, na.rm = FALSE, dims = 1)))
colnames(y) &lt;- c("Wage", "Employment")

# Set function arguments
nlags &lt;- 8
itr &lt;- 5000
burn &lt;- 0
thin &lt;- 1
acc &lt;- TRUE
h &lt;- 20
cri &lt;- 0.95

# Priors for A
pA &lt;- array(data = NA, dim = c(2, 2, 8))
pA[, , 1] &lt;- c(0, NA, 0, NA)
pA[, , 2] &lt;- c(1, NA, -1, NA)
pA[, , 3] &lt;- c(0.6, 1, -0.6, 1)
pA[, , 4] &lt;- c(0.6, NA, 0.6, NA)
pA[, , 5] &lt;- c(3, NA, 3, NA)
pA[, , 6] &lt;- c(NA, NA, NA, NA)
pA[, , 7] &lt;- c(NA, NA, 1, NA)
pA[, , 8] &lt;- c(2, NA, 2, NA)

# Position priors for Phi
pP &lt;- matrix(data = 0, nrow = ((nlags * ncol(pA)) + 1), ncol = ncol(pA))
pP[1:nrow(pA), 1:ncol(pA)] &lt;-
  diag(x = 1, nrow = nrow(pA), ncol = ncol(pA))

# Confidence in the priors for Phi
x1 &lt;- 
  matrix(data = NA, nrow = (nrow(y) - nlags), 
         ncol = (ncol(y) * nlags))
for (k in 1:nlags) {
  x1[, (ncol(y) * (k - 1) + 1):(ncol(y) * k)] &lt;-
    y[(nlags - k + 1):(nrow(y) - k),]
}
x1 &lt;- cbind(x1, 1)
colnames(x1) &lt;- 
  c(paste(rep(colnames(y), nlags),
          "_L",
          sort(rep(seq(from = 1, to = nlags, by = 1), times = ncol(y)),
               decreasing = FALSE),
          sep = ""),
    "cons")
y1 &lt;- y[(nlags + 1):nrow(y),]
ee &lt;- matrix(data = NA, nrow = nrow(y1), ncol = ncol(y1))
for (i in 1:ncol(y1)) {
  xx &lt;- cbind(x1[, seq(from = i, to = (ncol(x1) - 1), by = ncol(y1))], 1)
  yy &lt;- matrix(data = y1[, i], ncol = 1)
  phi &lt;- solve(t(xx) %*% xx, t(xx) %*% yy)
  ee[, i] &lt;- yy - (xx %*% phi)
}
somega &lt;- (t(ee) %*% ee) / nrow(ee)
lambda0 &lt;- 0.2
lambda1 &lt;- 1
lambda3 &lt;- 100
v1 &lt;- matrix(data = (1:nlags), nrow = nlags, ncol = 1)
v1 &lt;- v1^((-2) * lambda1)
v2 &lt;- matrix(data = diag(solve(diag(diag(somega)))), ncol = 1)
v3 &lt;- kronecker(v1, v2)
v3 &lt;- (lambda0^2) * rbind(v3, (lambda3^2))
v3 &lt;- 1 / v3
pP_sig &lt;- diag(x = 1, nrow = nrow(v3), ncol = nrow(v3))
diag(pP_sig) &lt;- v3

# Confidence in long-run restriction priors
pR_sig &lt;-
  array(data = 0,
        dim = c(((nlags * ncol(y)) + 1),
                ((nlags * ncol(y)) + 1),
                ncol(y)))
Ri &lt;-
  cbind(kronecker(matrix(data = 1, nrow = 1, ncol = nlags),
                  matrix(data = c(1, 0), nrow = 1)),
        0)
pR_sig[, , 2] &lt;- (t(Ri) %*% Ri) / 0.1

# Confidence in priors for D
kappa1 &lt;- matrix(data = 2, nrow = 1, ncol = ncol(y))

# Set graphical parameters
par(cex.axis = 0.8, cex.main = 1, font.main = 1, family = "serif",
    mfrow = c(2, 2), mar = c(2, 2.2, 2, 1), las = 1)

# Estimate the parameters of the model
results1 &lt;- 
  BH_SBVAR(y = y, nlags = nlags, pA = pA, pP = pP, pP_sig = pP_sig,
           pR_sig = pR_sig, kappa1 = kappa1, itr = itr, burn = burn,
           thin = thin, cri = cri)
           
hd &lt;- HD(results = results1, cri = cri)

# Plot historical decompositions
varnames &lt;- colnames(USLMData)[2:3]
shocknames &lt;- c("Labor Demand","Labor Supply")
freq &lt;- 4
start_date &lt;- 
  c(floor(USLMData[(nlags + 1), 1]),
    round(((USLMData[(nlags + 1), 1] %% 1) * freq), digits = 0))
hd_results &lt;- 
  HD_Plots(results  = hd, varnames = varnames,
           shocknames = shocknames,
           freq = freq, start_date = start_date)
</code></pre>


</div>