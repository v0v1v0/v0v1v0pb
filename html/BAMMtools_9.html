<div class="container">

<table style="width: 100%;"><tr>
<td>computeBayesFactors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Bayes Factors</h2>

<h3>Description</h3>

<p>Computes pairwise Bayes factors for a set of
macroevolutionary models sampled using <code>BAMM</code>, using MCMC
simulation output.
</p>


<h3>Usage</h3>

<pre><code class="language-R">computeBayesFactors(postdata, expectedNumberOfShifts, burnin = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>postdata</code></td>
<td>
<p>Filename for the MCMC output file from a <code>BAMM</code> run.
Alternatively, a dataframe containing this information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedNumberOfShifts</code></td>
<td>
<p>Expected number of shifts under the prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>What fraction of samples to discard from postdata as burnin?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to computeBayesFactors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns a matrix of pairwise Bayes factors, where
the Bayes factor is the ratio of marginal likelihoods between two
models M<sub>i</sub> and M<sub>j</sub>. Numerator models are given as rows, and
denominator models as columns. Row names and column names give the
number of shifts in the corresponding model. Suppose you have an
output matrix with row and column names 0:3 (0, 1, 2, 3). Model 0 is a
model with just a single process (starting at the root), and no
among-lineage rate heterogeneity. 
</p>
<p>If <code>computeBayesFactors</code> gives a matrix <code>mm</code>, and
<code>mm[2,1]</code> is 10.0, this implies Bayes factor evidence of 10 in
favor of the 2nd row model (a model with 1 process; e.g.,
<code>rownames(mm)[2]</code>) over the first column model (a model with a
single process).
</p>
<p>This function will only compute Bayes factors between models which
were actually sampled during simulation of the posterior. Hence, if
a model has such low probability that it is never visited by
<code>BAMM</code> during the simulation of the posterior, it will be
impossible to estimate its posterior probability (and thus, you will
get no Bayes factors involving this particular model). This is likely
to change in the future with more robust methods for estimating
posterior probabilities in the tails of the distribution.
</p>


<h3>Value</h3>

<p>A matrix of pairwise Bayes factors between models.
</p>


<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mcmc.whales)
computeBayesFactors(mcmc.whales, expectedNumberOfShifts = 1, burnin = 0.1)
</code></pre>


</div>