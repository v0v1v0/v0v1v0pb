<div class="container">

<table style="width: 100%;"><tr>
<td>reduceResults</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reduce results from result directory.</h2>

<h3>Description</h3>

<p>The following functions provide ways to reduce result files into either specific R objects (like
vectors, lists, matrices or data.frames) or to arbitrarily aggregate them, which is a more general
operation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reduceResults(
  reg,
  ids,
  part = NA_character_,
  fun,
  init,
  impute.val,
  progressbar = TRUE,
  ...
)

reduceResultsList(
  reg,
  ids,
  part = NA_character_,
  fun,
  ...,
  use.names = "ids",
  impute.val,
  progressbar = TRUE
)

reduceResultsVector(
  reg,
  ids,
  part = NA_character_,
  fun,
  ...,
  use.names = "ids",
  impute.val
)

reduceResultsMatrix(
  reg,
  ids,
  part = NA_character_,
  fun,
  ...,
  rows = TRUE,
  use.names = "ids",
  impute.val
)

reduceResultsDataFrame(
  reg,
  ids,
  part = NA_character_,
  fun,
  ...,
  use.names = "ids",
  impute.val,
  strings.as.factors = FALSE
)

reduceResultsDataTable(
  reg,
  ids,
  part = NA_character_,
  fun,
  ...,
  use.names = "ids",
  impute.val
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>[<code>Registry</code>]<br>
Registry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>[<code>integer</code>]<br>
Ids of selected jobs.
Default is all jobs for which results are available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>[<code>character</code>]
Only useful for multiple result files, then defines which result file part(s) should be loaded.
<code>NA</code> means all parts are loaded, which is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>[<code>function</code>]<br>
For <code>reduceResults</code>, a function <code>function(aggr, job, res, ...)</code> to reduce things,
for all others, a function <code>function(job, res, ...)</code> to select stuff.
Here, <code>job</code> is the current job descriptor (see <code>Job</code>), <code>result</code> is the current result object and
<code>aggr</code> are the so far aggregated results. When using <code>reduceResults</code>,
your function should add the stuff you want to have from <code>job</code> and
<code>result</code> to <code>aggr</code> and return that.
When using the other reductions, you should select the stuff you want to have from <code>job</code> and
<code>result</code> and return something that can be coerced to an element of the selected return data structure
(reasonable conversion is tried internally).
Default behavior for this argument is to return <code>res</code>, except for <code>reduceResults</code> where no
default is available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>[<code>ANY</code>]<br>
Initial element, as used in <code>Reduce</code>.
Default is first result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impute.val</code></td>
<td>
<p>[any]<br>
For <code>reduceResults</code>: If not missing, the value of <code>impute.val</code> is passed to function <code>fun</code>
as argument <code>res</code> for jobs with missing results.<br>
For the specialized reduction functions <code>reduceResults[Type]</code>: If not missing, <code>impute.val</code> is
used as a replacement for the return value of <code>fun</code> on missing results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>[<code>logical(1)</code>]<br>
Set to <code>FALSE</code> to disable the progress bar.
To disable all progress bars, see <code>makeProgressBar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>[any]<br>
Additional arguments to <code>fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.names</code></td>
<td>
<p>[<code>character(1)</code>]<br>
Name the results with job ids (“ids”), stored job names (“names”)
or return a unnamed result (“none”).
Default is <code>ids</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
<p>[<code>logical(1)</code>]<br>
Should the selected vectors be used as rows (or columns) in the result matrix?
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strings.as.factors</code></td>
<td>
<p>[<code>logical(1)</code>]
Should all character columns in result be converted to factors?
Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Aggregated results, return type depends on function. If <code>ids</code> is empty: <code>reduceResults</code>
returns <code>init</code> (if available) or <code>NULL</code>, <code>reduceResultsVector</code> returns <code>c()</code>,
<code>reduceResultsList</code> returns <code>list()</code>, <code>reduceResultsMatrix</code> returns <code>matrix(0,0,0)</code>,
<code>reduceResultsDataFrame</code> returns <code>data.frame()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate results:
reg = makeRegistry(id = "BatchJobsExample", file.dir = tempfile(), seed = 123)
f = function(x) x^2
batchMap(reg, f, 1:5)
submitJobs(reg)
waitForJobs(reg)

# reduce results to a vector
reduceResultsVector(reg)
# reduce results to sum
reduceResults(reg, fun = function(aggr, job, res) aggr+res)

reg = makeRegistry(id = "BatchJobsExample", file.dir = tempfile(), seed = 123)
f = function(x) list(a = x, b = as.character(2*x), c = x^2)
batchMap(reg, f, 1:5)
submitJobs(reg)
waitForJobs(reg)

# reduce results to a vector
reduceResultsVector(reg, fun = function(job, res) res$a)
reduceResultsVector(reg, fun = function(job, res) res$b)
# reduce results to a list
reduceResultsList(reg)
# reduce results to a matrix
reduceResultsMatrix(reg, fun = function(job, res) res[c(1,3)])
reduceResultsMatrix(reg, fun = function(job, res) c(foo = res$a, bar = res$c), rows = TRUE)
reduceResultsMatrix(reg, fun = function(job, res) c(foo = res$a, bar = res$c), rows = FALSE)
# reduce results to a data.frame
print(str(reduceResultsDataFrame(reg)))
# reduce results to a sum
reduceResults(reg, fun = function(aggr, job, res) aggr+res$a, init = 0)
</code></pre>


</div>