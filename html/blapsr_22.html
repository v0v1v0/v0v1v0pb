<div class="container">

<table style="width: 100%;"><tr>
<td>plot.curelps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot estimated survival functions and cure probability for the promotion
time cure model.</h2>

<h3>Description</h3>

<p>The routine takes as input an object of class <code>curelps</code> and plots
the estimated baseline survival curve, the population survival
curve for a specific covariate profile and a a smooth curve for the cure
probability. Approximate pointwise credible intervals are available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'curelps'
plot(x, cred.int = 0.95, curvetype = c("baseline", "population",
     "probacure"), covar.profile, fit.col = "black", shade.col = "gray75",
      plot.cred = FALSE, np = 50, show.legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>curelps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred.int</code></td>
<td>
<p>The level for an approximate pointwise credible interval
to be computed for the smooth curves. Default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curvetype</code></td>
<td>
<p>The curve to be plotted; <code>baseline</code> (the default) will
plot the estimated baseline survival, <code>population</code> the population
survival function for a profile of covariates given in
<code>covar.profile</code>, and <code>probacure</code> the probability to be cured (for
a profile of covariates given in <code>covar.profile</code>) given
that the subject has survived until time t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.profile</code></td>
<td>
<p>A numeric vector of the same length as the number
of covariates in the model. This corresponds to the profile of covariates
for which to compute the population survival function  and cure probability
estimates. The order of the covariates in <code>covar.profile</code> is the same
as the order specified in <code>formula</code> of the <code>curelps</code> routine.
Each component of <code>covar.profile</code> should be in the range of the
observed values for the corresponding covariate. If <code>covar.profile</code>
is left unspecified by the user, the default will be to take the median
covariate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.col</code></td>
<td>
<p>The color used for the estimated survival curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade.col</code></td>
<td>
<p>The color used for the shading of the credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cred</code></td>
<td>
<p>Logical. Should the credible intervals be plotted?
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>The number of points used to plot the smooth curves. Default is 50
and allowed values are between 20 and 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>Show the legend? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>plot.cred</code> is <code>FALSE</code>, the routine omits to compute
the approximate pointwise credible intervals for plotting and hence is
less computationally intensive.
</p>


<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>.
</p>


<h3>See Also</h3>

<p><code>curelps</code>, <code>curelps.object</code>,
<code>curelps.extract</code>, <code>print.curelps</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example on phase III clinical trial e1684 on melanoma data

data(ecog1684)

# Kaplan-Meier curve
plot(survfit(Surv(time, status) ~ 1, data = ecog1684), mark.time = TRUE)
fit &lt;- curelps(Surv(time, status) ~ lt(age + trt + sex) +
             st(age + trt + sex), data = ecog1684, K = 20, penorder = 2)
fit
profile1 &lt;- c(0, 1, 1, 0, 1, 1) # Mean age, trt = IFN, sex = Female.
profile2 &lt;- c(0, 0, 1, 0, 0, 1) # Mean age, trt = control, sex = Female.
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2))
plot(fit, curvetype = "probacure", plot.cred = TRUE, ylim = c(0,1),
     covar.profile = profile1, cred.int = 0.90,
     main = "Mean age, trt = IFN, sex = Female", cex.main = 0.8,
     show.legend = FALSE)
plot(fit, curvetype = "probacure", plot.cred = TRUE, ylim = c(0,1),
     covar.profile = profile2, cred.int = 0.90,
     main = "Mean age, trt = control, sex = Female", cex.main = 0.8,
     show.legend = FALSE)
par(opar)
</code></pre>


</div>