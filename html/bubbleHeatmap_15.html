<div class="container">

<table style="width: 100%;"><tr>
<td>metabFigure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create Nightingale Figure From Template</h2>

<h3>Description</h3>

<p>Produce a single <code>gTree</code> object representing plots arranged
according to the provided Nightingale metabolomics figure template.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metabFigure(
  data,
  colorValue = "estimate",
  sizeValue = "negLog10P",
  legendHeight = 8,
  context = gpar(cex = 0.8),
  unitBase = unit(0.5, "cm"),
  colorLim = c(NA, NA),
  sizeLim = c(NA, NA)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Nightingale results data merged with the ntngale225 or ntngale249
template.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorValue</code></td>
<td>
<p>String naming the variable of <code>data</code> containing the
values to be plotted on the color scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeValue</code></td>
<td>
<p>String naming the variable of <code>data</code> containing the
values to scale bubble sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendHeight</code></td>
<td>
<p>Numeric, preferred height of legends in multiples of
0.5cm. This will be supplied to pretty function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>context</code></td>
<td>
<p><code>gpar</code> object to provide drawing context.
Will be applied to the parent viewport in the childrenvp slot of the gTree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitBase</code></td>
<td>
<p><code>unit</code> object indicating the size of one
plot grid box.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorLim, sizeLim</code></td>
<td>
<p>Numeric vectors indicating limits (min/max) outside
which the values of color/size matrices should be truncated. NOTE! These
data ranges are separate from the scale ranges, which are taken from the
min/max values of <code>colorBreaks</code> and <code>sizeBreaks</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Quick function to produce a final Nightingale figure from results data merged
with one of the supplied template datasets. This function wraps the functions
<code>formatData</code>, <code>multiPlotInput</code>,
<code>bubbleHeatmapList</code> and <code>metabFigurePlot</code> applying
default settings.
</p>


<h3>Value</h3>

<p>Produces a complete metabolomics figure consisting of 14
bubbleHeatmap blocks in a pre-set layout. Output is not drawn but returned as
a <code>gTree</code> object which can be edited or drawn using
the <code>grid.draw</code> function. NOTE: A cairo output device with
gradient support is necessary to correctly render the color legend.
</p>


<h3>Examples</h3>

<pre><code class="language-R">myData &lt;- merge_template(cetp, "ckb_id")
metabTree &lt;- metabFigure(myData)
grid.draw(metabTree)

</code></pre>


</div>