<div class="container">

<table style="width: 100%;"><tr>
<td>frametoLme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>LME modeling</h2>

<h3>Description</h3>

<p>LME models are fitted to detrend multilevel ecological data series.</p>


<h3>Usage</h3>

<pre><code class="language-R">frametoLme(rd, form = "lmeForm", res.data = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rd</code></td>
<td>
<p><code>data.frame</code>. Multilevel ecological data series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p><code>character</code>. Any of two lme formulas:
'lmeForm' and 'tdForm' (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.data</code></td>
<td>
<p><code>logical</code>. Save residuals as a
multilevel ecological data series. If TRUE then
a data frame of name 'fluc' is added to output
list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>lme</code>
function or to the lme formula in <code>form</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements
<code>lme</code> function to fit linear
mixed-effects models on multilevel
ecological data series processed by the
<code>modelFrame</code> function. Two kind
of model formulas can be fitted: 'lmeForm'
and 'tdForm'; these characters implement
functions with same names
(<code>tdForm</code> and
<code>lmeForm</code>). Other lme formulas
can be specified by modifying arguments in
any of these two functions. After the lme
models are fitted, they can be extended by
implementing methods in <code>nlme</code>
package.</p>


<h3>Value</h3>

<p><code>groupedData</code> object.</p>


<h3>Author(s)</h3>

<p>Wilson Lara &lt;wilarhen@gmail.com&gt;, Felipe Bravo &lt;fbravo@pvs.uva.es&gt;</p>


<h3>References</h3>

<p>Pinheiro J. C.,
D. M. Bates. 2000. Mixed-effects models in S
and S-PLUS. Springer, New York.</p>


<h3>Examples</h3>

<pre><code class="language-R">
##TRW chronology (mm) and inside-bark radii
data(Pchron,envir = environment())

## Parameters of allometric model to compute Diameter at Breast
## Height over bark (DBH, cm) from diameter inside bark (dib, cm)
## and Total Tree Biomass (TTB, kg tree -1 ) from DBH (Lara
## et. al. 2013):
biom_param &lt;- c(2.87, 0.85, 0.05, 2.5)

## Modeling tree-biomass fluctuations while accounting for
## within-plot source variability (see defaults in "modelFrame"
## function)
 
 trwf &lt;- modelFrame(Pchron,
                    to = 'cm',
                    MoreArgs = list(mp = c(2,1, biom_param)),
                    log.t = FALSE,
                    on.time = FALSE)
 
## Detrending the fluctuations by fitting a (l)td-form model
## with Maximum-likelihood method (ML):
 
 pdata &lt;- trwf$'model'$'data'
 rlme &lt;- frametoLme(pdata,
                    form = 'tdForm',
                    method = 'ML',
                    log.t = TRUE)
 summary(rlme$model)
 
##a plot of the modeled fluctuations:
 
 d &lt;- groupedData(lmeForm(rlme$fluc,lev.rm = 1),data = rlme$fluc)
 plot(d,groups = ~ sample,auto.key = TRUE)
 
## A model of aridity:
 
 cf &lt;- modelFrame(PTclim05,
                  lv = list('year','year'),
                  fn = list('moveYr','wlai'),
                  form = NULL)
 summary(cf)
 
## An lme model of aridity at 'plot' level:
 
 cdata &lt;- cf$'model'$'data'
 rmod &lt;- frametoLme(cdata,form = 'lmeForm')
 summary(rmod$model)
 rk &lt;- groupedData(lmeForm(rmod$fluc),data=rmod$fluc)
 plot(rk,ylab = 'detrended AI')
 
</code></pre>


</div>