<div class="container">

<table style="width: 100%;"><tr>
<td>bhpm.convergence.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convergence Diagnostics of the Simulation</h2>

<h3>Description</h3>

<p>The function applies either Gelman-Rubin or the Geweke diagnostic to the raw output of model simulation (e.g. bhpm.cluster.BB.hier3).
It returns the convergence diagnostics and, if applicable, the acceptance rates for the sampling distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	bhpm.convergence.diag(raw, debug_diagnostic = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>

<p>The output from a model simulation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug_diagnostic</code></td>
<td>

<p>Unused parameter.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function applies one of two convergence diagnostics to the raw output of a model simulation
in order to allow convergence to be assessed. The two diagnotics are:
</p>
<p>i) Gelman-Rubin diagnostic - used when there is more than one chain. A value close to 1 is consistent with
an MCMC simulation which has converged. The ‘coda’ diagnostic returns a point estimate and upper confidence
limits.
</p>
<p>ii) Geweke diagnostic - used when there is a single chain. A Z-score which is consistent with a standard normal
distribution is expected from an MCMC simulation which has converged.
</p>
<p>The raw sample data is converted to ‘coda’ format (mcmc objects) and the ‘coda’ methods gelman.diag and
geweke.diag are used to perform the checks.
</p>


<h3>Value</h3>

<p>Returns a list of the diagnostics for each sampled variable. Each individual element of the list is a
data.frame containing at least the columns <em>type</em>, which is the type of diagnostic
(‘Gelman-Rubin’ or ‘Geweke’), <em>stat</em>, which is the value of the dignostic, and <em>upper_ci</em> which is
the upper confidence interval for the Gelman-Rubin diagnostic. For the Geweke diagnostic <em>upper_ci</em>
contains the value NA. Depending on the simulation performed the return from <em>bhpm.convergence.diag</em> will contain different
variables.
Columns which may be used to indentify the individual samples are <em>Trt.Grp</em>, <em>Outcome.Grp</em>,
<em>Outcome</em>, and <em>Cluster</em>.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bhpm.cluster.data1)
data &lt;- subset(bhpm.cluster.data1, Cluster == '0.0-180.0' | Cluster == '180.0-360.0')
raw = bhpm.npm(data, burnin = 100, iter = 200)
conv = bhpm.convergence.diag(raw)


data(bhpm.cluster.data1)
raw = bhpm.npm(bhpm.cluster.data1)
conv = bhpm.convergence.diag(raw)

</code></pre>


</div>