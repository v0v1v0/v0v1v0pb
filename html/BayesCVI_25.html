<div class="container">

<table style="width: 100%;"><tr>
<td>B_WP.IDX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
BCVI-Wiroonsri and Preedasawakul (WP) index
</h2>

<h3>Description</h3>

<p>Compute Bayesian cluster validity index (BCVI) from two to <code>kmax</code> groups using Wiroonsri and Preedasawakul (WP) as the underling cluster validity index (CVI) with the user's selected Dirichlet prior parameters. The full detail of BCVI can be found in the paper Wiroonsri and Preedasawakul (2024).</p>


<h3>Usage</h3>

<pre><code class="language-R">B_WP.IDX(x, kmax, corr = "pearson", method = "FCM", fzm = 2,
        gamma = (fzm^2 * 7)/4, sampling = 1, iter = 100, nstart = 20,
        NCstart = TRUE, alpha = "default", mult.alpha = 1/2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric data frame or matrix where each column is a variable to be used for cluster analysis and each row is a data point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>a maximum number of clusters to be considered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>a character string indicating which correlation coefficient is to be computed (<code>"pearson"</code>, <code>"kendall"</code> or <code>"spearman"</code>). The default is <code>"pearson"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which clustering method to be used (<code>"FCM"</code> or <code>"EM"</code>). The default is <code>"FCM"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fzm</code></td>
<td>
<p>a number greater than 1 giving the degree of fuzzification for <code>method = "FCM"</code>. The default is <code>2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>adjusted fuzziness parameter for <code>indexlist</code> = (<code>"WP"</code>, <code>"WPC"</code>, <code>"WPCI1"</code>, <code>"WPCI2"</code>). The default is computed from <code class="reqn">7fzm^2/4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>a number greater than 0 and less than or equal to 1 indicating the undersampling proportion of data to be used. This argument is intended for handling a large dataset. The default is <code>1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>a maximum number of iterations for <code>method = "FCM"</code>. The default is <code>100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>a maximum number of initial random sets for FCM for <code>method = "FCM"</code>. The default is <code>20</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NCstart</code></td>
<td>
<p>logical for <code>indexlist</code> = (<code>"WP"</code>, <code>"WPC"</code>, <code>"WPCI1"</code>,<code>"WPCI2"</code>), if <code>TRUE</code>, the WP correlation at c=1 is defined as an adjusted sd of the distances between all data points and their mean. Otherwise, the WP correlation at c=1 is defined as 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Dirichlet prior parameters <code class="reqn">\alpha_2,...,\alpha_k</code> where <code class="reqn">\alpha_k</code> is the parameter corresponding to "the probability of having k groups" (selecting each <code class="reqn">\alpha_k</code> between 0 to 30 is recommended and using the other parameter <code>mult.alpha</code> to be its multiplier. The default is <code>"default"</code>.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.alpha</code></td>
<td>
<p>the power <code class="reqn">s</code> from <code class="reqn">n^s</code> to be multiplied to the Dirichlet prior parameters <code>alpha</code> (selecting <code>mult.alpha</code> in <code>[0,1)</code> is recommended). The default is <code class="reqn">\frac{1}{2}</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>BCVI-WP is defined as follows.
Let <br></p>
<p style="text-align: center;"><code class="reqn">r_k(\bf x) = \dfrac{WP(k)-\min_j WP(j)}{\sum_{i=2}^K (WP(i)-\min_j WP(j))} </code>
</p>

<p>Assume that <br></p>
<p style="text-align: center;"><code class="reqn">f({\bf x}|{\bf p}) = C({\bf p}) \prod_{k=2}^Kp_k^{nr_k(x)}</code>
</p>

<p>represents the conditional probability density function of the dataset given <code class="reqn">\bf p</code>, where <code class="reqn">C({\bf p})</code> is the normalizing constant. Assume further that  <code class="reqn">{\bf p}</code> follows a Dirichlet prior distribution with parameters <code class="reqn">{\bm \alpha} = (\alpha_2,\ldots,\alpha_K)</code>. The posterior distribution of <code class="reqn">\bf p</code> still remains a Dirichlet distribution with parameters <code class="reqn">(\alpha_2+nr_2({\bf x}),\ldots,\alpha_K+nr_K({\bf x}))</code>.
</p>
<p>The BCVI is then defined as  <br></p>
<p style="text-align: center;"><code class="reqn">BCVI(k) = E[p_k|{\bf x}] = \frac{\alpha_k + nr_k({\bf x})}{\alpha_0+n}</code>
</p>

<p>where <code class="reqn">\alpha_0 = \sum_{k=2}^K \alpha_k.</code> <br></p>
<p>The variance of <code class="reqn">p_k</code> can be computed as
</p>
<p style="text-align: center;"><code class="reqn">Var(p_k|{\bf x}) = \dfrac{(\alpha_k + nr_k(x))(\alpha_0 + n -\alpha_k-nr_k(x))}{(\alpha_0 + n)^2(\alpha_0 + n +1 )}.</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BCVI</code></td>
<td>
<p>the dataframe where the first and the second columns are the number of groups <code>k</code> and BCVI<code class="reqn">(k)</code>, respectively, for <code>k</code> from <code>2</code> to <code>kmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VAR</code></td>
<td>
<p>the data frame where the first and the second columns are the number of groups <code>k</code> and the variance of <code class="reqn">p_k</code>, respectively, for <code>k</code> from <code>2</code> to <code>kmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVI</code></td>
<td>
<p>the data frame where the first and the second columns are the number of groups <code>k</code> and the original WP<code class="reqn">(k)</code>, respectively, for <code>k</code> from <code>2</code> to <code>kmax</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nathakhun Wiroonsri and Onthada Preedasawakul
</p>


<h3>References</h3>

<p>N. Wiroonsri, O. Preedasawakul, "A correlation-based fuzzy cluster validity index with secondary options detector". <a href="https://doi.org/10.48550/arXiv.2308.14785">doi:10.48550/arXiv.2308.14785</a>
</p>
<p>O. Preedasawakul, and N. Wiroonsri, A Bayesian Cluster Validity Index, Computational Statistics &amp; Data Analysis, 202, 108053, 2025. <a href="https://doi.org/10.1016/j.csda.2024.108053">doi:10.1016/j.csda.2024.108053</a>
</p>


<h3>See Also</h3>

<p><code>B7_data, B_TANG.IDX, B_XB.IDX, B_Wvalid, B_DB.IDX</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BayesCVI)

# The data included in this package.
data = B7_data[,1:2]

# alpha
aalpha = c(20,20,20,5,5,5,0.5,0.5,0.5)

B.WP = B_WP.IDX(x = scale(data), kmax =10, corr = "pearson", method = "FCM",
                fzm = 2, sampling = 1, iter = 100, nstart = 20, NCstart = TRUE,
                alpha = aalpha, mult.alpha = 1/2)

# plot the BCVI

pplot = plot_BCVI(B.WP)
pplot$plot_index
pplot$plot_BCVI
pplot$error_bar_plot
</code></pre>


</div>