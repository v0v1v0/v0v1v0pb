<div class="container">

<table style="width: 100%;"><tr>
<td>pca_nspike</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Number of spikes in PCA</h2>

<h3>Description</h3>

<p>Estimate the number of distant spikes based on the histogram of eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pca_nspike(eigval, breaks = "FD", nboot = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eigval</code></td>
<td>
<p>Eigenvalues (squared singular values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Same parameter as for <code>hist()</code>. Default uses a robust version
of Scott's rule. You can also use <code>"FD"</code> or <code>nclass.FD</code> for a bit more bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap replicates to estimate limits more robustly.
Default is <code>100</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The estimated number of distant spikes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- 400; M &lt;- 2000; K &lt;- 8
U &lt;- matrix(0, N, K); U[] &lt;- rnorm(length(U))
V &lt;- matrix(0, M, K); V[] &lt;- rnorm(length(V))
# X = U V^T + E
X &lt;- tcrossprod(U, V) + 15 * rnorm(N * M)
pca &lt;- prcomp(X)
eigval &lt;- pca$sdev^2
plot(head(eigval, -1), log = "xy", pch = 20)
pca_nspike(eigval)

</code></pre>


</div>