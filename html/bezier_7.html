<div class="container">

<table style="width: 100%;"><tr>
<td>pointsOnBezier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates points along a Bezier curve or spline</h2>

<h3>Description</h3>

<p>This function provides three different functionalities for generating points along a Bezier curve or spline. The first generates approximately evenly spaced points along a Bezier, optimizing point position according to specified convergence criteria. The second functionality places points along a Bezier such that the distance between consecutive points does not exceed a specified Euclidean distance. This second functionality does not generate evenly spaced points along the curve, instead providing a more rapid routine for generating a large number of points on a Bezier more evenly spaced than with parametric point generation. The last functionality generates adjoining points along a Bezier as a series of integers and is intended for use with pixel coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pointsOnBezier(p, n = NULL, method = 'evenly_spaced', t1 = 0, t2 = NULL, 
               deg = NULL, max.dist = NULL, max.dist.factor = 0.1, 
               relative.min.slope = 1e-7, absolute.min.slope = 0, 
               sub.relative.min.slope = 1e-4, sub.absolute.min.slope = 0, 
               print.progress = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>control points, input either as vector, matrix or list (see <code>bezier</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of points to generate along the Bezier. Ignored if <code>method</code> is <code>'max_dist'</code> or <code>'adjoining'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used in generating the points. Either <code>'evenly_spaced'</code>, <code>'max_dist'</code> or <code>'adjoining'</code>. Does not need to be specified if <code>max.dist</code> or <code>n</code> are non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>a parametric value for a Bezier curve or spline at which the points will start.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2</code></td>
<td>
<p>a parametric value for a Bezier curve or spline at which the points will end. Default is the end of the Bezier curve or spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deg</code></td>
<td>
<p>a numeric indicating the degree (or order) of a Bezier spline. For Bezier curves, the degree is computed based on the number of control points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>the maximum Euclidean distance (not distance along the curve) between consecutive points for the more rapid routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist.factor</code></td>
<td>
<p>a factor used to approximate point position based on maximum distance criteria (see Details). Ignored if <code>max.dist</code> is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative.min.slope</code></td>
<td>
<p>parameter passed to <code>bezierArcLength</code> for estimating total arc length. Ignored if <code>max.dist</code> is non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absolute.min.slope</code></td>
<td>
<p>parameter passed to <code>bezierArcLength</code> for estimating total arc length. Ignored if <code>max.dist</code> is non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.relative.min.slope</code></td>
<td>
<p>parameter passed to <code>compareBezierArcLength</code> for estimating total arc length (see <code>compareBezierArcLength</code>). Ignored if <code>max.dist</code> is non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.absolute.min.slope</code></td>
<td>
<p>parameter passed to <code>compareBezierArcLength</code> for estimating total arc length (see <code>compareBezierArcLength</code>). Ignored if <code>max.dist</code> is non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.progress</code></td>
<td>
<p>logical indicating whether iterations should be printed for tracking function progress.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Points can easily be generated along a Bezier curve or spline using parametric values (provided by the function <code>bezier</code>), however these points are not evenly spaced along the curve. Points generated by parametric values will be closer together in regions with the highest curvature and furthest apart in regions that approach a straight line. This function provides three different functionalities for generating points along a Bezier curve or spline that are more evenly spaced than those generated using parametric values. The <code>'evenly_spaced'</code> method generates <code>n</code> approximately evenly spaced points along a Bezier, optimizing point position according to specified convergence criteria. The <code>'max_dist'</code> method places points along a Bezier such that the distance between consecutive points does not exceed a specified Euclidean distance (<code>max.dist</code>). And the <code>'adjoining'</code> method generates points along a Bezier as a series of integers and is intended for use with pixel coordinates.
</p>
<p>The input of the control points <code>p</code> is identical to <code>bezier</code> and can be a vector, matrix or list (see Details in <code>bezier</code>). As with <code>bezier</code>, when control points are input as a list and the number of control points differs for different dimensions, the degree will be elevated so that all dimensions are of uniform degree (see <code>elevateBezierDegree</code>). <code>t1</code> and <code>t2</code> are parametric values along the Bezier curve or spline between which points will be generated. The default values for <code>t1</code> and <code>t2</code> are the start and end points of the Bezier curve or spline, respectively. For a Bezier spline, if <code>t2</code> is not specified, it is calculated based on the number of control points and the degree (<code>deg</code>). When using <code>pointsOnBezier</code> for Bezier splines, <code>deg</code> must be specified or else the points will be treated as a single Bezier curve.
</p>
<p>If <code>n</code> is non-<code>NULL</code>, <code>pointsOnBezier</code> generates <code>n</code> evenly spaced points along a Bezier curve or spline. This requires accurate approximation of Bezier arc length. An initial estimation of the total arc length between <code>t1</code> and <code>t2</code> is made (using <code>bezierArcLength</code>) to determine the interval at which points should be placed to equally subdivide the curve. <code>optim</code> is used to find the optimal position of each point, calling <code>bezierArcLength</code> via <code>compareBezierArcLength</code>, such that the arc length between points is nearly equal to this interval. When positioning each point, the arc length is estimated from <code>t1</code> (rather than from the previous point) so that errors are not compounded. As a consequence of repeated calls to <code>optim</code> and <code>bezierArcLength</code>, this functionality can be rather slow.
</p>
<p>The parameters ending in <code>min.slope</code> are convergence criteria passed to <code>bezierArcLength</code>. The parameters <code>relative.min.slope</code> and <code>absolute.min.slope</code> are the criteria used in the initial arc length estimation, while <code>sub.relative.min.slope</code> and <code>sub.absolute.min.slope</code> are the criteria used to estimate arc length in placing each point along the curve. Larger convergence criteria values will cause <code>pointsOnBezier</code> to run faster but at lower accuracy. For a complete description of the convergence criteria, see Details in <code>bezierArcLength</code>.
</p>
<p><code>pointsOnBezier</code> runs an alternative routine when <code>max.dist</code> is non-<code>NULL</code>. In this case, <code>n</code> and the convergence criteria are ignored, <code>bezierArcLength</code> is not called and <code>pointsOnBezier</code> generates points along a Bezier such that the distance between consecutive points does not exceed the specified Euclidean distance <code>max.dist</code>. The parameter <code>max.dist.factor</code> is a factor that is used to iteratively increase the parametric value to reach the next point without exceeding <code>max.dist</code>. The lower <code>max.dist.factor</code> is, the closer the interpoint Euclidean distance will be to <code>max.dist</code> but the longer <code>pointsOnBezier</code> will take to run (see Examples). If <code>max.dist</code> does not evenly divide the total arc length between <code>t1</code> and <code>t2</code>, the interval between the second-to-last point and the end point may not be close to <code>max.dist</code>. If <code>max.dist</code> evenly divides the arc length, if <code>max.dist.factor</code> is low and if <code>max.dist</code> is small, the points will be more evenly spaced than with parametric point generation.
</p>
<p>When <code>method</code> is <code>'adjoining'</code>, <code>pointsOnBezier</code> will generate points as integers at adjoining positions along the Bezier curve or spline. The arc length is first measured (very roughly) to approximate the first parametric interval at which to find adjoining points. The function adds this initial interval to <code>t1</code> and finds the position of the next Bezier point, rounded to the nearest integer. The interval is decreased or increased depending on whether the point is too distant or too near until the next point adjoins the previous point. Adjoining is defined as two points whose positions (as integers) differ by one in either or both coordinates. Thus, 2D points adjoining on the diagonal are considered adjoining. For instance, the points [3,5] would be adjoining with [4,5], [3,4] and [4,6] but not [1,3]. The function continues to iterate through the parametric values up to <code>t2</code>, generating points adjoining to the previous point. This method is intended for use with pixel coordinates, such as when Bezier control points are used to trace Bezier curves and splines on an image. Unlike the previous two methods, most of the generated points will not fall exactly on the Bezier curve since they are rounded to the nearest integer. This method currently only works with curves or splines in two dimensions.
</p>
<p>In the case of Bezier splines, note that borders between spline segments are not respected and arc lengths are calculated across spline segments. In order to generate points within spline segments, <code>pointsOnBezier</code> should be called separately for each segment.
</p>


<h3>Value</h3>

<p>a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>evenly spaced or nearly evenly spaced points along a Bezier curve or spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>an vector of the error for each point along the curve or spline. If the <code>method</code> is <code>'evenly_spaced'</code>, this is the <code>value</code> output from <code>optim</code> for each point estimation. If <code>method</code> is <code>'max_dist'</code>, this is <code>max.dist</code> minus the actual Euclidean distance between consecutive points. If <code>method</code> is <code>'adjoining'</code>, this is the difference between the actual position on the Bezier minus the position to the nearest integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the parametric values corresponding to each point in <code>points</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aaron Olsen</p>


<h3>See Also</h3>

<p><code>bezier</code>, <code>bezierArcLength</code>, <code>compareBezierArcLength</code>, <code>elevateBezierDegree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## EVENLY_SPACED METHOD ##
## BEZIER CURVE CONTROL POINTS
p &lt;- matrix(c(3,2, 3,0, 5,5), nrow=3, ncol=2, byrow=TRUE)

## GET PARAMETRIC BEZIER POINTS
bp &lt;- bezier(t=seq(0, 1, length=100), p=p)

## GET EVENLY SPACED POINTS ALONG CURVE
pob &lt;- pointsOnBezier(p=p, n=10, method="evenly_spaced", print.progress=TRUE)

## FUNCTION WILL RUN FASTER BY INCREASING CONVERGENCE CRITERIA
pob_faster &lt;- pointsOnBezier(p=p, n=10, method="evenly_spaced", sub.relative.min.slope=1e-2, 
	print.progress=TRUE)

## PLOT PARAMETRIC BEZIER POINTS
## NOTE THAT THEY ARE NOT EVENLY SPACED ALONG THE CURVE
plot(bp, cex=0.5, asp=1)

## ADD POINTS TO PLOT
## NOTE THAT THESE POINTS ARE EVENLY SPACED ALONG CURVE
points(pob$points, col="red")

## WITH FASTER RUN, SOME DEVIATION BUT POINTS ARE NEARLY IDENTICAL
points(pob_faster$points, col="blue", cex=1.5)


## MAX_DIST METHOD ##
## BEZIER CURVE CONTROL POINTS
p &lt;- matrix(c(3,2, 3,0, 5,5), nrow=3, ncol=2, byrow=TRUE)

## GET PARAMETRIC BEZIER POINTS
bp &lt;- bezier(t=seq(0, 1, length=100), p=p)

## GET POINTS ALONG CURVE WITH INTERPOINT DISTANCE LESS THAN 0.1
pob &lt;- pointsOnBezier(p=p, max.dist=0.1, method="max_dist", print.progress=TRUE)

## PLOT PARAMETRIC BEZIER POINTS
plot(bp, cex=0.5, asp=1)

## ADD POINTS TO PLOT
points(pob$points, col="red")


## ADJOINING METHOD ##
## BEZIER CURVE CONTROL POINTS
p &lt;- matrix(c(300,200, 300,0, 500,500), nrow=3, ncol=2, byrow=TRUE)

## GET PARAMETRIC BEZIER POINTS
bp &lt;- bezier(t=seq(0, 1, length=100), p=p)

## GET POINTS ALONG CURVE WITH ROUNDED POSITIONS AT "PIXEL" SPACING
pob &lt;- pointsOnBezier(p=p, method="adjoining", print.progress=TRUE)

## PLOT PARAMETRIC BEZIER POINTS
plot(bp, cex=0.5, asp=1)

## ADD POINTS TO PLOT
points(pob$points, col="red", cex=0.2, pch=16)
</code></pre>


</div>