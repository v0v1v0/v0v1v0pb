<div class="container">

<table style="width: 100%;"><tr>
<td>bcdc_query_geodata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Query data from the B.C. Web Feature Service</h2>

<h3>Description</h3>

<p>Queries features from the B.C. Web Feature Service. See
<code>bcdc_tidy_resources()</code> - if a resource has a value of
<code>"wms"</code> in the <code>format</code> column it is available as a Web
Feature Service, and you can query and download it
using <code>bcdc_query_geodata()</code>. The response will be
paginated if the number of features is above the number
set by the <code>bcdata.single_download_limit</code> option.
Please see <code>bcdc_options()</code> for defaults and more
information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcdc_query_geodata(record, crs = 3005)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL) or a BC Geographic
Warehouse (BCGW) name.
</p>
<p>It is advised to use the permanent ID for a record or the BCGW name rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>the epsg code for the coordinate reference system. Defaults to
<code>3005</code> (B.C. Albers). See https://epsg.io.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that this function doesn't actually return the data, but rather an
object of class <code>bcdc_promise</code>, which includes all of the information
required to retrieve the requested data. In order to get the actual data as
an <code>sf</code> object, you need to run <code>collect()</code> on the <code>bcdc_promise</code>. This
allows further refining the call to <code>bcdc_query_geodata()</code> with <code>filter()</code>
and/or <code>select()</code> statements before pulling down the actual data as an <code>sf</code>
object with <code>collect()</code>. See examples.
</p>


<h3>Value</h3>

<p>A <code>bcdc_promise</code> object. This object includes all of the information
required to retrieve the requested data. In order to get the actual data as
an <code>sf</code> object, you need to run <code>collect()</code> on the <code>bcdc_promise</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Returns a bcdc_promise, which can be further refined using filter/select:
try(
  res &lt;- bcdc_query_geodata("bc-airports", crs = 3857)
)

# To obtain the actual data as an sf object, collect() must be called:
try(
  res &lt;- bcdc_query_geodata("bc-airports", crs = 3857) %&gt;%
    filter(PHYSICAL_ADDRESS == 'Victoria, BC') %&gt;%
    collect()
)

try(
  res &lt;- bcdc_query_geodata("groundwater-wells") %&gt;%
    filter(OBSERVATION_WELL_NUMBER == "108") %&gt;%
    select(WELL_TAG_NUMBER, INTENDED_WATER_USE) %&gt;%
    collect()
)

## A moderately large layer
try(
  res &lt;- bcdc_query_geodata("bc-environmental-monitoring-locations")
)

try(
  res &lt;- bcdc_query_geodata("bc-environmental-monitoring-locations") %&gt;%
    filter(PERMIT_RELATIONSHIP == "DISCHARGE")
)


## A very large layer
try(
  res &lt;- bcdc_query_geodata("terrestrial-protected-areas-representation-by-biogeoclimatic-unit")
)

## Using a BCGW name
try(
  res &lt;- bcdc_query_geodata("WHSE_IMAGERY_AND_BASE_MAPS.GSR_AIRPORTS_SVW")
)

</code></pre>


</div>