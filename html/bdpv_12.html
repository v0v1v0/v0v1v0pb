<div class="container">

<table style="width: 100%;"><tr>
<td>CIpvBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Confidence intervals for negative and positive predictive values in a case-control setting by simulation from the posterior distribution.
</h2>

<h3>Description</h3>

<p>Computes confidence intervals for negative and positive predictive values by simulation from the posterior beta-distribution (Stamey and Holt, 2010),
assuming a case-control design to estimate sensitivity and specificity, while prevalence estimates of an external study and/or prior knowledge concerning
prevalence may be introduced additionally.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CIpvBI(x1, x0, pr, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"),
 B=5000, shapes1=c(1,1), shapes0=c(1,1), ...)

CIpvBII(x1, x0, xpr, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"),
 B=5000, shapes1=c(1,1), shapes0=c(1,1), shapespr=c(1,1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>

<p>A vector of two (integer) values, specifying the observed number of positive (<code>x1[1]</code>) and negative (<code>x1[2]</code>) test results in the group of true positives.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>

<p>A vector of two (integer) values, specifying the observed number of positive (<code>x0[1]</code>) and negative (<code>x0[2]</code>) test results in the group of true negatives.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>

<p>A single numeric value between 0 and 1, defining an assumed fixed (known) prevalence (for <code>CIpvBI</code>), where prevalence is the proportion of positives in the population.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpr</code></td>
<td>

<p>An optional vector of two (integer) values, specifying the observed number of positive (<code>xpr[1]</code>) and negative (<code>xpr[2]</code>) outcomes from an external study that allows to estimate the prevalence of positives in the population of interest.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>The confidence level, a single numeric value between 0 and 1, defaults to 0.95
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>A character string specifying whether two-sided (<code>"two.sided"</code>), only lower bounds (<code>"greater"</code>) or only upper bounds (<code>"less"</code>) shall be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>A single integer, the number of samples from the posterior to be drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes1</code></td>
<td>

<p>Two positive numbers, the shape parameters (a,b) of the beta prior for the sensitivity, by default a flat beta prior (a=1, b=1) is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes0</code></td>
<td>

<p>Two positive numbers, the shape parameters (a,b) of the beta prior for (1-specificity), by default a flat beta prior (a=1, b=1) is used. Note, that this definition differs from that in Stamey and Holt(2010), where the prior is defined for the specificity directly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapespr</code></td>
<td>

<p>Two positive numbers, the shape parameters (a,b) of the beta prior for the prevalence, by default a flat beta prior (a=1, b=1) is used. For <code>CIpvBII</code> only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to <code>quantile(), other arguments are ignored without warning. </code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CIpvBI</code> implements the method refered to as Bayes I in Stamey and Holt (2010), <code>CIpvBI</code> implements the method refered to as Bayes II in Stamey and Holt (2010), Equation (2) and following description (p. 103-104).
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>conf.int </code></td>
<td>
<p>the confidence bounds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p>the point estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab </code></td>
<td>
<p>a 2x2 matrix showing how the input data in terms of true positives and true negatives</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Stamey JD and Holt MM (2010).</em> Bayesian interval estimation for predictive values for case-control studies. Communications in Statistics - Simulation and Computation. 39:1, 101-110.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# example data: Stamey and Holt, Table 8 (page 108)
#	Diseased
# Test	D=1	D=0
# T=1	240	87
# T=0	178	288
#n1,n0:	418	375


# reproduce the results for the Bayes I method
# in Stamey and Holt (2010), Table 9, page 108

# assuming known prevalence 0.03 
# ppv 0.0591, 0.0860
# npv 0.9810, 0.9850
CIpvBI( x1=c(240,178), x0=c(87,288), pr=0.03)

# assuming known prevalence 0.04 
# ppv 0.0779, 0.1111
# npv 0.9745, 0.9800
CIpvBI( x1=c(240,178), x0=c(87,288), pr=0.04)

# compare with standard logit intervals
tab &lt;- cbind( x1=c(240,178), x0=c(87,288))
tab
BDtest(tab, pr=0.03)
BDtest(tab, pr=0.04)


# reproduce the results for the Bayes II method 
# in Stamey and Holt (2010), Table 9, page 108

CIpvBII( x1=c(240,178), x0=c(87,288),  shapespr=c(16,486))

CIpvBII( x1=c(240,178), x0=c(87,288), shapespr=c(21,481))

</code></pre>


</div>