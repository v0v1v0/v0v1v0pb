<div class="container">

<table style="width: 100%;"><tr>
<td>bayescopulaglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample from Bayesian copula GLM</h2>

<h3>Description</h3>

<p>Sample from a GLM via Bayesian copula regression model.
Uses random-walk Metropolis to update regression coefficients and dispersion parameters.
Assumes Inverse Wishart prior on augmented data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayescopulaglm(
  formula.list,
  family.list,
  data,
  histdata = NULL,
  b0 = NULL,
  c0 = NULL,
  alpha0 = NULL,
  gamma0 = NULL,
  Gamma0 = NULL,
  S0beta = NULL,
  sigma0logphi = NULL,
  v0 = NULL,
  V0 = NULL,
  beta0 = NULL,
  phi0 = NULL,
  M = 10000,
  burnin = 2000,
  thin = 1,
  adaptive = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula.list</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional list of formulas giving how the endpoints are related to the covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family.list</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional list of families giving how each endpoint is distributed. See <code>help(family)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data frame</code> containing all response variables and covariates. Variables must be named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histdata</code></td>
<td>
<p><em>Optional</em> historical data set for power prior on <code class="reqn">\beta, \phi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p><em>Optional</em> power prior hyperparameter. Ignored if <code>is.null(histdata)</code>. Must be a number between <code class="reqn">(0, 1]</code> if <code>histdata</code> is not <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional vector for <code class="reqn">\beta \mid \phi</code> prior covariance. If <code>NULL</code>, sets <code class="reqn">c_0 = 10000</code> for each endpoint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional vector giving the shape hyperparameter for each dispersion parameter on the prior on <code class="reqn">\phi</code>. If <code>NULL</code> sets <code class="reqn">\alpha_0 = .01</code> for each dispersion parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional vector giving the rate hyperparameter for each dispersion parameter on the prior on <code class="reqn">\phi</code>. If <code>NULL</code> sets <code class="reqn">\alpha_0 = .01</code> for each dispersion parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma0</code></td>
<td>
<p>Initial value for correlation matrix. If <code>NULL</code> defaults to the correlation matrix from the responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0beta</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>list</code> for the covariance matrix for random walk metropolis on beta. Each matrix must have the same dimension as the corresponding regression coefficient. If <code>NULL</code>, uses <code>solve(crossprod(X))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0logphi</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>vector</code> giving the standard deviation on <code class="reqn">\log(\phi)</code> for random walk metropolis. If <code>NULL</code> defaults to <code>0.1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v0</code></td>
<td>
<p>An integer scalar giving degrees of freedom for Inverse Wishart prior. If <code>NULL</code> defaults to J + 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V0</code></td>
<td>
<p>An integer giving inverse scale parameter for Inverse Wishart prior. If <code>NULL</code> defaults to <code>diag(.001, J)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>list</code> giving starting values for random walk Metropolis on the regression coefficients. If <code>NULL</code>, defaults to the GLM MLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>vector</code> giving initial values for dispersion parameters. If <code>NULL</code>. Dispersion parameters will always return 1 for binomial and Poisson models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of desired posterior samples after burn-in and thinning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>burn-in parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>post burn-in thinning parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>logical indicating whether to use adaptive random walk MCMC to estimate parameters. This takes longer, but generally has a better acceptance rate</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list. 
<code>["betasample"]</code> gives a <code class="reqn">J</code>-dimensional list of sampled coefficients as matrices. 
<code>["phisample"]</code> gives a <code class="reqn">M \times J</code> matrix of sampled dispersion parameters. 
<code>["Gammasample"]</code> gives a <code class="reqn">J \times J \times M</code> array of sampled correlation matrices. 
<code>["betaaccept"]</code> gives a <code class="reqn">M \times J</code> matrix where each row indicates whether the proposal for the regression coefficient was accepted.
<code>["phiaccept"]</code> gives a <code class="reqn">M \times J</code> matrix where each row indicates whether the proposal for the dispersion parameter was accepted
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
n &lt;- 100
M &lt;- 100

x &lt;- runif(n, 1, 2)
y1 &lt;- 0.25 * x + rnorm(100)
y2 &lt;- rpois(n, exp(0.25 * x))

formula.list &lt;- list(y1 ~ 0 + x, y2 ~ 0 + x)
family.list &lt;- list(gaussian(), poisson())
data = data.frame(y1, y2, x)

## Perform copula regression sampling with default
## (noninformative) priors
sample &lt;- bayescopulaglm(
  formula.list, family.list, data, M = M, burnin = 0, adaptive = F
)
## Regression coefficients
summary(do.call(cbind, sample$betasample))

## Dispersion parameters
summary(sample$phisample)

## Posterior mean correlation matrix
apply(sample$Gammasample, c(1,2), mean)

## Fraction of accepted betas
colMeans(sample$betaaccept)

## Fraction of accepted dispersion parameters
colMeans(sample$phiaccept)
</code></pre>


</div>