<div class="container">

<table style="width: 100%;"><tr>
<td>AGBmonteCarlo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Propagating above-ground biomass (AGB) or carbon (AGC) errors to the stand level</h2>

<h3>Description</h3>

<p>Propagation of the errors throughout the steps needed to compute AGB or AGC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AGBmonteCarlo(
  D,
  WD = NULL,
  errWD = NULL,
  H = NULL,
  errH = NULL,
  HDmodel = NULL,
  coord = NULL,
  Dpropag = NULL,
  n = 1000,
  Carbon = FALSE,
  Dlim = NULL,
  plot = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Vector of tree diameters (in cm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WD</code></td>
<td>
<p>Vector of wood density estimates (in g/cm3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errWD</code></td>
<td>
<p>Vector of error associated to the wood density estimates (should be of the same size as <code>WD</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>(option 1) Vector of tree heights (in m). If set, <code>errH</code> must be set too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errH</code></td>
<td>
<p>(if <code>H</code>) Residual standard error (RSE) of a model or vector of errors (sd values) associated to tree height
values (in the latter case the vector should be of the same length as <code>H</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HDmodel</code></td>
<td>
<p>(option 2) Model used to estimate tree height from tree diameter (output from <code>modelHD()</code>, see example).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>(option 3) Coordinates of the site(s), either a vector giving a single site (e.g. c(longitude, latitude))
or a matrix/dataframe with two columns (e.g. cbind(longitude, latitude)). The coordinates are used to predict
height-diameter allometry with bioclimatic variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dpropag</code></td>
<td>
<p>This variable can take three kind of values, indicating how to propagate the errors on diameter measurements:
a single numerical value or a vector of the same size as <code>D</code>, both representing the standard deviation associated
with the diameter measurements or <code>"chave2004"</code> (an important error on 5 percent of the measures, a smaller error on
95 percent of the trees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of iterations. Cannot be smaller than 50 or larger than 1000. By default <code>n = 1000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Carbon</code></td>
<td>
<p>(logical) Whether or not the propagation should be done up to the carbon value (FALSE by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dlim</code></td>
<td>
<p>(optional) Minimum diameter (in cm) for which above-ground biomass should be calculated (all diameter below
<code>Dlim</code> will have a 0 value in the output).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>(optional) Plot ID, must be either one value, or a vector of the same length as D. This argument is used to build
stand-specific HD models.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Rejou-Mechain et al. (2017) for all details on the error propagation procedure.
</p>


<h3>Value</h3>

<p>Returns a list  with (if Carbon is FALSE):
</p>

<ul>
<li> <p><code>meanAGB</code>: Mean stand AGB value following the error propagation
</p>
</li>
<li> <p><code>medAGB</code>: Median stand AGB value following the error propagation
</p>
</li>
<li> <p><code>sdAGB</code>: Standard deviation of the stand AGB value following the error propagation
</p>
</li>
<li> <p><code>credibilityAGB</code>: Credibility interval at 95\
</p>
</li>
<li> <p><code>AGB_simu</code>: Matrix with the AGB of the trees (rows) times the n iterations (columns)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Maxime REJOU-MECHAIN, Bruno HERAULT, Camille PIPONIOT, Ariane TANGUY, Arthur PERE
</p>


<h3>References</h3>

<p>Chave, J. et al. (2004). <em>Error propagation and scaling for tropical forest biomass estimates</em>.
Philosophical Transactions of the Royal Society B: Biological Sciences, 359(1443), 409-420.
</p>
<p>Rejou-Mechain et al. (2017).
<em>BIOMASS: An R Package for estimating above-ground biomass and its uncertainty in tropical forests</em>.
Methods in Ecology and Evolution, 8 (9), 1163-1167.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load a database
data(NouraguesHD)
data(KarnatakaForest)

# Modelling height-diameter relationship
HDmodel &lt;- modelHD(D = NouraguesHD$D, H = NouraguesHD$H, method = "log2")

# Retrieving wood density values

KarnatakaWD &lt;- getWoodDensity(KarnatakaForest$genus, KarnatakaForest$species,
  stand = KarnatakaForest$plotId
)


# Propagating errors with a standard error in wood density in one plot
filt &lt;- KarnatakaForest$plotId == "BSP20"
set.seed(10)

resultMC &lt;- AGBmonteCarlo(
  D = KarnatakaForest$D[filt], WD = KarnatakaWD$meanWD[filt],
  errWD = KarnatakaWD$sdWD[filt], HDmodel = HDmodel
)
str(resultMC)


# If only the coordinates are available
lat &lt;- KarnatakaForest$lat[filt]
long &lt;- KarnatakaForest$long[filt]
coord &lt;- cbind(long, lat)

resultMC &lt;- AGBmonteCarlo(
  D = KarnatakaForest$D[filt], WD = KarnatakaWD$meanWD[filt],
  errWD = KarnatakaWD$sdWD[filt], coord = coord
)
str(resultMC)


# Propagating errors with a standard error in wood density in all plots at once

KarnatakaForest$meanWD &lt;- KarnatakaWD$meanWD
KarnatakaForest$sdWD &lt;- KarnatakaWD$sdWD
resultMC &lt;- by(
  KarnatakaForest, KarnatakaForest$plotId,
  function(x) AGBmonteCarlo(
      D = x$D, WD = x$meanWD, errWD = x$sdWD,
      HDmodel = HDmodel, Dpropag = "chave2004"
    )
)
meanAGBperplot &lt;- unlist(sapply(resultMC, "[", 1))
credperplot &lt;- sapply(resultMC, "[", 4)


</code></pre>


</div>