<div class="container">

<table style="width: 100%;"><tr>
<td>nsgpPredict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior prediction for the NSGP</h2>

<h3>Description</h3>

<p><code>nsgpPredict</code> conducts posterior prediction for MCMC samples generated
using nimble and nsgpModel.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nsgpPredict(
  model,
  samples,
  coords.predict,
  predict.process = TRUE,
  constants,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A NSGP nimble object; the output of <code>nsgpModel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>A matrix of <code>J</code> rows, each is an MCMC sample of the 
parameters corresponding to the specification in <code>nsgpModel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.predict</code></td>
<td>
<p>M x d matrix of prediction coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict.process</code></td>
<td>
<p>Logical; determines whether the prediction corresponds to 
the y(·) process (<code>TRUE</code>) or z(·) (<code>FALSE</code>; this would likely 
only be used for, e.g., cross-validation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constants</code></td>
<td>
<p>An optional list of contants to use for prediction; 
alternatively, additional arguments can be passed to the function via the
... argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional random seed argument for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments can be passed to the function; for example,
as an alternative to the <code>constants</code> list, items can be passed directly
via this argument.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output of the function is a list with two elements: <code>obs</code>,
a matrix of <code>J</code> posterior predictive samples for the N observed 
locations (only for <code>likelihood = "SGV"</code>, which produces predictions 
for the observed locations by default; this element is <code>NULL</code> 
otherwise); and <code>pred</code>, a corresponding matrix of posterior predictive 
samples for the prediction locations. Ordering and neighbor selection
for the prediction coordinates in the SGV likelihood are conducted 
internally, as with <code>nsgpModel</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate some data: stationary/isotropic
N &lt;- 100
coords &lt;- matrix(runif(2*N), ncol = 2)
alpha_vec &lt;- rep(log(sqrt(1)), N) # Log process SD
delta_vec &lt;- rep(log(sqrt(0.05)), N) # Log nugget SD
Sigma11_vec &lt;- rep(0.4, N) # Kernel matrix element 1,1
Sigma22_vec &lt;- rep(0.4, N) # Kernel matrix element 2,2
Sigma12_vec &lt;- rep(0, N) # Kernel matrix element 1,2
mu_vec &lt;- rep(0, N) # Mean
nu &lt;- 0.5 # Smoothness
dist_list &lt;- nsDist(coords)
Cor_mat &lt;- nsCorr( dist1_sq = dist_list$dist1_sq, dist2_sq = dist_list$dist2_sq, 
                   dist12 = dist_list$dist12, Sigma11 = Sigma11_vec, 
                   Sigma22 = Sigma22_vec, Sigma12 = Sigma12_vec, nu = nu )
Cov_mat &lt;- diag(exp(alpha_vec)) %*% Cor_mat %*% diag(exp(alpha_vec))
D_mat &lt;- diag(exp(delta_vec)^2) 
set.seed(110)
data &lt;- as.numeric(mu_vec + t(chol(Cov_mat + D_mat)) %*% rnorm(N))
# Set up constants
constants &lt;- list( nu = 0.5, Sigma_HP1 = 2 )
# Defaults: tau_model = "constant", sigma_model = "constant", mu_model = "constant",
# and Sigma_model = "constant"
Rmodel &lt;- nsgpModel(likelihood = "fullGP", constants = constants, coords = coords, data = data )
conf &lt;- configureMCMC(Rmodel)
Rmcmc &lt;- buildMCMC(conf)
Cmodel &lt;- compileNimble(Rmodel)
Cmcmc &lt;- compileNimble(Rmcmc, project = Rmodel)
samples &lt;- runMCMC(Cmcmc, niter = 200, nburnin = 100)
# Prediction
predCoords &lt;- as.matrix(expand.grid(seq(0,1,l=10),seq(0,1,l=10)))
postpred &lt;- nsgpPredict( model = Rmodel, samples = samples, coords.predict = predCoords )


</code></pre>


</div>