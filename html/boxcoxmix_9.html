<div class="container">

<table style="width: 100%;"><tr>
<td>Kfind.boxcox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Grid search over K for NPML estimation of random effect and variance component models</h2>

<h3>Description</h3>

<p>A grid search over the parameter <code>K</code>, to set the best number of
mass-points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Kfind.boxcox(
  formula,
  groups = 1,
  data,
  lambda = 1,
  EMdev.change = 1e-04,
  steps = 500,
  find.k = c(2, 10),
  model.selection = "aic",
  start = "gq",
  find.tol = c(0, 1.5),
  steps.tol = 15,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find.k</code></td>
<td>
<p>search in a range of <code>K</code>, with default (2,10)
in step of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.selection</code></td>
<td>
<p>Set <code>model.selection="aic"</code>, to use Akaike information criterion 
as model selection criterion or <code>model.selection="bic"</code>, to use Bayesian information criterion 
as model selection criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version "quantile" or Gaussian Quadrature "gq" can be
set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find.tol</code></td>
<td>
<p>search in a range of <code>tol</code>, with default (0,1.5)
in step of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps.tol</code></td>
<td>
<p>number of points in the grid search of <code>tol</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Not only the shape of the distribution causes the skewness it may due to the use of an 
insufficient number of classes, <code>K</code>. For this, the <code>Kfind.boxcox()</code> function 
was created to search over a selected range of <code>K</code> and find the best. For each number
of classes, a grid search over <code>tol</code> is performed and the <code>tol</code> with the lowest 
<code>aic</code> or <code>bic</code> value is considered as the optimal. Having the minimal <code>aic</code> or <code>bic</code> values for a whole range of
<code>K</code> that have been specified beforehand, the <code>Kfind.boxcox()</code> function can find 
the best number of the component as the one with the smallest value. It also plots the <code>aic</code> or <code>bic</code> values against
the selected range of <code>K</code>, including a vertical line indicating the best value of <code>K</code>
that minimizes the model selection criteria. The full range of 
classes and their corresponding optimal <code>tol</code> can be printed off from the <code>Kfind.boxcox()</code>'s
output and used with other <span class="pkg">boxcoxmix</span> functions as starting points.
</p>


<h3>Value</h3>

<p>List with class <code>boxcoxmix</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MinDisparity</code></td>
<td>
<p>the minimum disparity found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Best.K</code></td>
<td>
<p>the
value of <code>K</code> corresponding to <code>MinDisparity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AllMinDisparities </code></td>
<td>
<p>a vector containing all minimum disparities calculated on the
grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AllMintol </code></td>
<td>
<p>list of <code>tol</code> values used in the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>All.K </code></td>
<td>
<p>list of <code>K</code> values used in the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>All.aic</code></td>
<td>
<p>the Akaike information criterion of all fitted regression models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>All.bic</code></td>
<td>
<p>the Bayesian information criterion of all fitted regression models.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>See Also</h3>

<p><code>tolfind.boxcox</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fabric data
data(fabric, package = "npmlreg")
teststr&lt;-Kfind.boxcox(y ~ x, data = fabric,  start = "gq", groups=1, 
find.k = c(2, 3), model.selection = "aic", steps.tol=5)
# Minimal AIC: 202.2114 at K= 2 









</code></pre>


</div>