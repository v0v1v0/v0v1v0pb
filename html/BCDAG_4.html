<div class="container">

<table style="width: 100%;"><tr>
<td>get_causaleffect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate total causal effects from the MCMC output</h2>

<h3>Description</h3>

<p>This function provides causal effect estimates from the output of <code>learn_DAG</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_causaleffect(learnDAG_output, targets, response, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>learnDAG_output</code></td>
<td>
<p>object of class <code>bcdag</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>numerical <code class="reqn">(p,1)</code> vector with labels of target nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>numerical label of response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, progress bar of MCMC sampling is displayed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Output of <code>learn_dag</code> function consists of <code class="reqn">S</code> draws from the joint posterior of DAGs and DAG-parameters in a zero-mean Gaussian DAG-model;
see the documentation of <code>learn_DAG</code> for more details.
</p>
<p>The total causal effect on a given variable of interest (<code>response</code>) consequent to a joint intervention on a set of variables (<code>targets</code>)
is defined according to Pearl's do-calculus theory and under the Gaussian assumption can be expressed as a function of parameters <code>(D,L)</code>,
representing a (Cholesky) reparameterization of the covariance matrix.
</p>
<p>Specifically, to each intervened variable a causal effect coefficient is associated and the posterior distribution of the latter can be recovered from posterior draws
of the DAG parameters returned by <code>learn_DAG</code>. For each coefficient a sample of size <code class="reqn">S</code> from its posterior is available. If required, the only
Bayesian Model Average (BMA) estimate (obtained as the sample mean of the <code class="reqn">S</code> draws) can be returned by setting <code>BMA = TRUE</code>.
</p>
<p>Notice that, whenever implemented with <code>collapse = FALSE</code>, <code>learn_DAG</code> returns the marginal posterior distribution of DAGs only.
In this case, <code>get_causaleffect</code> preliminarly performs posterior inference of DAG parameters by drawing samples from the posterior of <code>(D,L)</code>.
</p>
<p>Print, summary and plot methods are available for this function. <code>print</code> returns the values of the prior hyperparameters used in the learnDAG function. <code>summary</code> returns, for each causal effect parameter, the marginal posterior mean and quantiles for different <code class="reqn">\alpha</code> levels, and posterior probabilities of negative, null and positive causal effects. <code>plot</code> provides graphical summaries (boxplot and histogram of the distribution) for the posterior of each causal effect parameter.
</p>


<h3>Value</h3>

<p>An S3 object of class <code>bcdagCE</code> containing <code class="reqn">S</code> draws from the joint posterior distribution of the <code class="reqn">p</code> causal effect coefficients, organized into an <code class="reqn">(S,p)</code> matrix, posterior means and credible intervals (under different <code class="reqn">(1-\alpha)</code> levels) for each causal effect coefficient, and marginal posterior probabilities of positive, null and negative causal effects.
</p>


<h3>Author(s)</h3>

<p>Federico Castelletti and Alessandro Mascaro
</p>


<h3>References</h3>

<p>J. Pearl (2000). <em>Causality: Models, Reasoning, and Inference</em>. Cambridge University Press, Cambridge.
</p>
<p>F. Castelletti and A. Mascaro (2021) Structural learning and estimation of joint causal effects among network-dependent variables. <em>Statistical Methods and Applications</em>, Advance publication.
</p>
<p>P. Nandy, M.H. Maathuis and T. Richardson (2017). Estimating the effect of joint interventions from observational data in sparse high-dimensional settings. <em>Annals of Statistics</em> 45(2), 647-674.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Randomly generate a DAG and the DAG-parameters
q = 8
w = 0.2
set.seed(123)
DAG = rDAG(q = q, w = w)
outDL = rDAGWishart(n = 1, DAG = DAG, a = q, U = diag(1, q))
L = outDL$L; D = outDL$D
Sigma = solve(t(L))%*%D%*%solve(L)
n = 200
# Generate observations from a Gaussian DAG-model
X = mvtnorm::rmvnorm(n = n, sigma = Sigma)
# Run the MCMC (set S = 5000 and burn = 1000 for better results)
out_mcmc = learn_DAG(S = 500, burn = 100, a = q, U = diag(1,q)/n, data = X, w = w,
                     fast = TRUE, save.memory = FALSE)
head(out_mcmc$Graphs)
head(out_mcmc$L)
head(out_mcmc$D)
# Compute the BMA estimate of coefficients representing
# the causal effect on node 1 of an intervention on {3,4}
out_causal = get_causaleffect(learnDAG_output = out_mcmc, targets = c(3,4), response = 1)$post_mean

# Methods
print(out_causal)
summary(out_causal)
plot(out_causal)
</code></pre>


</div>