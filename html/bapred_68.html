<div class="container">

<table style="width: 100%;"><tr>
<td>standardizeaddon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Addon batch effect adjustment for standardization
</h2>

<h3>Description</h3>

<p>Performs addon batch effect adjustment for standardization: 
1) takes the output of <code>standardize</code> applied to a training 
data set together with new batch data; 
2) checks whether the training data was also adjusted using standardization and whether the same number of variables is present in training and new data;
3) performs standardization on the new batch data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">standardizeaddon(params, x, batch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>

<p>object of class <code>standardize</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>matrix. The covariate matrix of the new data. Observations in rows, variables in columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>

<p>factor. Batch variable of the new data. Currently has to have levels: '1', '2', '3' and so on.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The adjusted covariate matrix of the test data.
</p>


<h3>Note</h3>

<p>It is <b>not recommended</b> to perform standardization in cross-study prediction settings, because for some classifiers the prediction performance can be strongly impaired by this method. Given a not too small test set, the following methods are recommended (Hornung et al., 2016a): <code>combatba</code>, <code>meancenter</code>, <code>ratioa</code>, <code>ratiog</code>.
</p>
<p>Because standardization is performed "batch by batch" the "addon procedure" for standardization consists of plain standardization on the new test batches.
</p>


<h3>Author(s)</h3>

<p>Roman Hornung
</p>


<h3>References</h3>

<p>Hornung, R., Causeur, D., Bernau, C., Boulesteix, A.-L. (2017). Improving cross-study prediction through addon batch effect adjustment and addon normalization. Bioinformatics 33(3):397â€“404, &lt;doi: <a href="https://doi.org/10.1093/bioinformatics/btw650">10.1093/bioinformatics/btw650</a>&gt;.
</p>
<p>Hornung, R., Boulesteix, A.-L., Causeur, D. (2016). Combining location-and-scale batch effect adjustment with data cleaning by latent factor adjustment. BMC Bioinformatics 17:27, &lt;doi: <a href="https://doi.org/10.1186/s12859-015-0870-z">10.1186/s12859-015-0870-z</a>&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(autism)

trainind &lt;- which(batch %in% c(1,2))

Xtrain &lt;- X[trainind,]
ytrain &lt;- y[trainind]
batchtrain &lt;- factor(as.numeric(batch[trainind]), levels=c(1,2))


testind &lt;- which(batch %in% c(3,4))

Xtest &lt;- X[testind,]
ytest &lt;- y[testind]

batchtest &lt;- as.numeric(batch[testind])
batchtest[batchtest==3] &lt;- 1
batchtest[batchtest==4] &lt;- 2
batchtest &lt;- factor(batchtest, levels=c(1,2))


params &lt;- standardize(x=Xtrain, batch=batchtrain)

Xtestaddon &lt;- standardizeaddon(params=params, x=Xtest, batch=batchtest)
</code></pre>


</div>