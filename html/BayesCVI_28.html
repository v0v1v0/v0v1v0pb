<div class="container">

<table style="width: 100%;"><tr>
<td>plot_BCVI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plots for visualizing BCVI
</h2>

<h3>Description</h3>

<p>Plot Bayesian cluster validity index (BCVI) with and without standard deviation error bars and the underlying index.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_BCVI(B.result, mult.err.bar = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B.result</code></td>
<td>
<p>a result from one of the functions <code>B_XB.IDX, B_Wvalid, B_WP.IDX, B_WL.IDX, B_TANG.IDX, B_STRPBM.IDX, B_SF.IDX, B_PBM.IDX, B_PB.IDX, B_KWON.IDX, B_KWON2.IDX, B_KPBM.IDX, B_HF.IDX, B_GC.IDX, B_DI.IDX, B_DB.IDX, B_CSL.IDX, B_CH.IDX, B_CCV.IDX and B_BayesCVIs.IDX</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.err.bar</code></td>
<td>

<p>a multiplier of the stadard deviations to be used for plotting error bars
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>BCVI is defined as follows.
</p>
<p>Let <br></p>
<p style="text-align: center;"><code class="reqn">r_k(\bf x) = \dfrac{\max_j CVI(j)- CVI(k)}{\sum_{i=2}^K (\max_j CVI(j) - CVI(i))}</code>
</p>
<p> for a cluster validity index (CVI) such that the smallest value indicates the optimal number of clusters and
</p>
<p style="text-align: center;"><code class="reqn">r_k(\bf x) = \dfrac{CVI(k)-\min_j CVI(j)}{\sum_{i=2}^K (CVI(i)-\min_j CVI(j))} </code>
</p>

<p>for a CVI such that the largest indicates the optimal number of clusters.
Assume that <br></p>
<p style="text-align: center;"><code class="reqn">f({\bf x}|{\bf p}) = C({\bf p}) \prod_{k=2}^Kp_k^{nr_k(x)}</code>
</p>

<p>represents the conditional probability density function of the dataset given <code class="reqn">\bf p</code>, where <code class="reqn">C({\bf p})</code> is the normalizing constant. Assume further that  <code class="reqn">{\bf p}</code> follows a Dirichlet prior distribution with parameters <code class="reqn">{\bm \alpha} = (\alpha_2,\ldots,\alpha_K)</code>. The posterior distribution of <code class="reqn">\bf p</code> still remains a Dirichlet distribution with parameters <code class="reqn">(\alpha_2+nr_2({\bf x}),\ldots,\alpha_K+nr_K({\bf x}))</code>.
</p>
<p>The BCVI is then defined as  <br></p>
<p style="text-align: center;"><code class="reqn">BCVI(k) = E[p_k|{\bf x}] = \frac{\alpha_k + nr_k({\bf x})}{\alpha_0+n}</code>
</p>

<p>where <code class="reqn">\alpha_0 = \sum_{k=2}^K \alpha_k.</code> <br></p>
<p>The variance of <code class="reqn">p_k</code> can be computed as
</p>
<p style="text-align: center;"><code class="reqn">Var(p_k|{\bf x}) = \dfrac{(\alpha_k + nr_k(x))(\alpha_0 + n -\alpha_k-nr_k(x))}{(\alpha_0 + n)^2(\alpha_0 + n +1 )}.</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>plot_index</code></td>
<td>
<p>a plot of the underlying index for the number of groups from <code class="reqn">2</code> to <code class="reqn">kmax</code> according to <code>B.result</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_BCVI</code></td>
<td>
<p>a plot of BCVI for the number of groups from <code class="reqn">2</code> to <code class="reqn">kmax</code> according to <code>B.result</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_bar_plot</code></td>
<td>
<p>a plot of BCVI with error bars for the number of groups from <code class="reqn">2</code> to <code class="reqn">kmax</code> according to <code>B.result</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nathakhun Wiroonsri and Onthada Preedasawakul
</p>


<h3>References</h3>

<p>O. Preedasawakul, and N. Wiroonsri, A Bayesian Cluster Validity Index, Computational Statistics &amp; Data Analysis, 202, 108053, 2025. <a href="https://doi.org/10.1016/j.csda.2024.108053">doi:10.1016/j.csda.2024.108053</a></p>


<h3>See Also</h3>

<p><code>B_STRPBM.IDX, B_TANG.IDX, B_XB.IDX, B_Wvalid, B_WP.IDX, B_DB.IDX</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(BayesCVI)
library(UniversalCVI)

##Soft clustering

# The data included in this package.
data = B7_data[,1:2]

# alpha
aalpha = c(5,5,5,20,20,20,0.5,0.5,0.5)

B.XB = B_XB.IDX(x = scale(data), kmax =10, method = "FCM", fzm = 2,
              nstart = 20, iter = 100, alpha = aalpha, mult.alpha = 1/2)

# plot the BCVI

pplot = plot_BCVI(B.XB)
pplot$plot_index
pplot$plot_BCVI
pplot$error_bar_plot


## Hard clustering

# The data included in this package.
data = B2_data[,1:2]

K.STR = STRPBM.IDX(scale(data), kmax = 10, kmin = 2, method = "kmeans",
  indexlist = "STR", nstart = 100)

# WP.IDX values
result = K.STR$STR$STR


aalpha = c(20,20,20,5,5,5,0.5,0.5,0.5)
B.STR = BayesCVIs(CVI = result,
          n = nrow(data),
          kmax = 10,
          opt.pt = "max",
          alpha = aalpha,
          mult.alpha = 1/2)

# plot the BCVI

pplot = plot_BCVI(B.STR)
pplot$plot_index
pplot$plot_BCVI
pplot$error_bar_plot

</code></pre>


</div>