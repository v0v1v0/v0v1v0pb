<div class="container">

<table style="width: 100%;"><tr>
<td>propDiffCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence intervals for the difference of proportions
in group testing</h2>

<h3>Description</h3>

<p>Calculates confidence intervals for the difference of two
proportions based on group testing data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">propDiffCI(
  x1,
  m1,
  x2,
  m2,
  n1 = rep(1, length(x1)),
  n2 = rep(1, length(x2)),
  pt.method = c("Firth", "Gart", "bc-mle", "mle"),
  ci.method = c("skew-score", "bc-skew-score", "score", "lrt", "Wald"),
  conf.level = 0.95,
  tol = .Machine$double.eps^0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>vector specifying the observed number of positive
groups among the number of groups tested (<kbd>n1</kbd>) in population 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>vector of corresponding group sizes in population 1.
Must have the same length as <kbd>x1</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>vector specifying the observed number of positive
groups among the number of groups tested (<kbd>n2</kbd>) in population 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>vector of corresponding group sizes in population 2.
Must have the same length as <kbd>x2</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>vector of the corresponding number of groups with
sizes <kbd>m1</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>vector of the corresponding number of groups with
sizes <kbd>m2</kbd>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.method</code></td>
<td>
<p>character string specifying the point estimator to
compute. Options include <kbd>"Firth"</kbd> for the bias-preventative estimator
(Hepworth &amp; Biggerstaff, 2017), the default <kbd>"Gart"</kbd> for the
bias-corrected MLE (Biggerstaff, 2008), <kbd>"bc-mle"</kbd> (same as
<kbd>"Gart"</kbd> for backward compatibility), and <kbd>"mle"</kbd> for the MLE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>
<p>character string specifying the confidence interval to
compute. Options include <kbd>"skew-score"</kbd> for the skewness-corrected,
<kbd>"score"</kbd> for the score (the default), <kbd>"bc-skew-score"</kbd> for the
bias- and skewness-corrected, <kbd>"lrt"</kbd> for the likelihood ratio test,
and <kbd>"Wald"</kbd> for the Wald interval. See Biggerstaff (2008) for
additional details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the accuracy required for iterations in internal functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Confidence interval methods include the Wilson score
(<kbd>ci.method = "score"</kbd>), skewness-corrected score
(<kbd>ci.method = "skew-score"</kbd>), bias- and skewness-corrected score
(<kbd>ci.method = "bc-skew-score"</kbd>), likelihood ratio test
(<kbd>ci.method = "lrt"</kbd>), and Wald (<kbd>ci.method = "Wald"</kbd>) interval.
For computational details, simulation results, and recommendations on
confidence interval methods, see Biggerstaff (2008).
</p>
<p>Point estimates available include the MLE (<kbd>pt.method = "mle"</kbd>),
bias-corrected MLE (<kbd>pt.method = "Gart"</kbd> or
<kbd>pt.method = "bc-mle"</kbd>), and bias-preventative
(<kbd>pt.method = "Firth"</kbd>). For additional details and recommendations
on point estimation, see Hepworth and Biggerstaff (2017).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the estimated difference of proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcl</code></td>
<td>
<p>the lower confidence limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ucl</code></td>
<td>
<p>the upper confidence limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.method</code></td>
<td>
<p>the method used for point estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>
<p>the method used for confidence interval estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>the confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>the numbers of positive groups in population 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>the sizes of the groups in population 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>the numbers of groups with corresponding group sizes
<kbd>m1</kbd> in population 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>the numbers of positive groups in population 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>the sizes of the groups in population 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>the numbers of groups with corresponding group sizes
<kbd>m2</kbd> in population 2.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This function was originally written as the <code>pooledBinDiff</code>
function by Brad Biggerstaff for the <code>binGroup</code> package. Minor
modifications were made for inclusion of the function in the
<code>binGroup2</code> package.
</p>


<h3>References</h3>

<p>Biggerstaff, B. (2008).
“Confidence intervals for the difference of proportions estimated from pooled samples.”
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>, <b>13</b>, 478–496.
</p>
<p>Hepworth, G., Biggerstaff, B. (2017).
“Bias correction in estimating proportions by pooled testing.”
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>, <b>22</b>, 602–614.
</p>


<h3>See Also</h3>

<p><code>propCI</code> for confidence intervals for one proportion
in group testing, <code>gtTest</code> for hypothesis tests in group
testing, and <code>gtPower</code> for power calculations in group testing.
</p>
<p>Other estimation functions: 
<code>designEst()</code>,
<code>designPower()</code>,
<code>gtPower()</code>,
<code>gtTest()</code>,
<code>gtWidth()</code>,
<code>propCI()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Estimate the prevalence in two populations
#   with multiple groups of various sizes:
# Population 1:
#   0 out of 5 groups test positively with
#   groups of size 1 (individual testing);
#   0 out of 5 groups test positively with
#   groups of size 5;
#   1 out of 5 groups test positively with
#   groups of size 10; and
#   2 out of 5 groups test positively with
#   groups of size 50.
# Population 2:
#   0 out of 5 groups test positively with
#   groups of size 1 (individual testing);
#   1 out of 5 groups test positively with
#   groups of size 5;
#   0 out of 5 groups test positively with
#   groups of size 10; and
#   4 out of 5 groups test positively with
#   groups of size 50.
x1 &lt;- c(0, 0, 1, 2)
m &lt;- c(1, 5, 10, 50)
n &lt;- c(5, 5, 5, 5)
x2 &lt;- c(0, 1, 0, 4)
propDiffCI(x1 = x1, m1 = m, x2 = x2, m2 = m, n1 = n, n2 = n,
           pt.method = "Gart", ci.method = "score")

# Compare recommended methods:
propDiffCI(x1 = x1, m1 = m, x2 = x2, m2 = m, n1 = n, n2 = n,
           pt.method = "mle", ci.method = "lrt")

propDiffCI(x1 = x1, m1 = m, x2 = x2, m2 = m, n1 = n, n2 = n,
           pt.method = "mle", ci.method = "score")

propDiffCI(x1 = x1, m1 = m, x2 = x2, m2 = m, n1 = n, n2 = n,
           pt.method = "mle", ci.method = "skew-score")
</code></pre>


</div>