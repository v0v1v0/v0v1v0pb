<div class="container">

<table style="width: 100%;"><tr>
<td>schaferStrimmer_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Schäfer Strimmer covariance shrinkage</h2>

<h3>Description</h3>

<p>Computes the Schäfer Strimmer shrinkage estimator for a covariance matrix
from a matrix of samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">schaferStrimmer_cov(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix of samples with dimensions nxp (n samples, p dimensions).</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function computes the shrinkage to a diagonal covariance with unequal variances.
Note that here we use the estimators <code class="reqn">S = X X^T/n</code> and <code class="reqn">T = diag(S)</code> and we internally
use the correlation matrix in place of the covariance to compute the optimal shrinkage factor.
</p>


<h3>Value</h3>

<p>A list containing the shrinkage estimator and the optimal lambda. The list has the following named elements:
</p>

<ul>
<li> <p><code>shrink_cov</code>: the shrinked covariance matrix (<code>p</code> x <code>p</code>);
</p>
</li>
<li> <p><code>lambda_star</code>: the optimal lambda for the shrinkage;
</p>
</li>
</ul>
<h3>References</h3>

<p>Schäfer, Juliane, and Korbinian Strimmer. (2005). <em>A Shrinkage Approach to Large-Scale Covariance Matrix Estimation and Implications for Functional Genomics.</em> Statistical Applications in Genetics and Molecular Biology 4: Article32. <a href="https://doi.org/10.2202/1544-6115.1175">doi:10.2202/1544-6115.1175</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate some multivariate normal samples
# Parameters
nSamples &lt;- 200
pTrue &lt;- 2

# True moments
trueSigma &lt;- matrix(c(3,2,2,2), nrow=2)
chol_trueSigma &lt;- chol(trueSigma)
trueMean &lt;- c(0,0) 

# Generate samples
set.seed(42)
x &lt;- replicate(nSamples, trueMean) +  
     t(chol_trueSigma)%*%matrix(stats::rnorm(pTrue*nSamples), 
                                nrow = pTrue, ncol = nSamples)
x &lt;- t(x) 
res_shrinkage &lt;- schaferStrimmer_cov(x)
res_shrinkage$lambda_star # should be 0.01287923

</code></pre>


</div>