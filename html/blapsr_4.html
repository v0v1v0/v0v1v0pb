<div class="container">

<table style="width: 100%;"><tr>
<td>coxlps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Cox proportional hazards regression model with Laplace-P-splines.</h2>

<h3>Description</h3>

<p>Fits a Cox proportional hazards regression model for right censored data by
combining Bayesian P-splines and Laplace approximations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxlps(formula, data, K = 30, penorder = 2, tmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object where the ~ operator separates the response
from the covariates. In a Cox model, it takes the form
<em>response ~ covariates</em>, where <em>response</em> is a survival object
returned by the <code>Surv</code> function of the <em>survival</em>
package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional. A data frame to match the variable names provided in
<code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A positive integer specifying the number of cubic B-spline
functions in the basis. Default is <em>K = 30</em> and allowed values
are <code>10 &lt;= K &lt;= 60</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penorder</code></td>
<td>
<p>The penalty order used on finite differences of the
coefficients of contiguous B-splines. Can be either 2 for a second-order
penalty (the default) or 3 for a third-order penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>
<p>A user-specified value for the upper bound of the B-spline basis.
The default is NULL, so that the B-spline basis is specified in the interval
<em>[0, tup]</em>, where <em>tup</em> is the  upper bound of the follow-up
times. It is required that <em>tmax</em> &gt; <em>tup</em>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The log-baseline hazard is modeled as a linear combination of
<code>K</code> cubic B-splines as obtained from <code>cubicbs</code>. The
B-spline basis is specified in the interval <em>[0, tup]</em>, where
<em>tup</em> is the upper bound of the follow-up times,
i.e. the largest observed follow-up time. Following Jullion
and Lambert (2007), a robust Gamma prior is imposed on the roughness
penalty parameter. A grid-based approach is used to explore the posterior
penalty space and the resulting quadrature points serve to compute the
approximate (joint) marginal posterior of the latent field vector. Point
and set estimates of latent field elements are obtained from a finite
mixture of Gaussian densities. The routine centers the columns of the
covariate matrix around their mean value for numerical stability.
</p>


<h3>Value</h3>

<p>An object of class <code>coxlps</code> containing various components from
the fit. Details can be found in coxlps.object. Plot of
estimated smooth hazard and survival curves can be obtained using
<code>plot.coxlps</code>. If required, estimated baseline quantities
on specific time values can be obtained with coxlps.baseline.
</p>


<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>.
</p>


<h3>References</h3>

<p>Cox, D.R. (1972). Regression models and life-tables.
<em>Journal of the Royal Statistical Society: Series B (Methodological)</em>
<strong>34</strong>(2): 187-202.
</p>
<p>Gressani, O. and Lambert, P. (2018). Fast Bayesian inference
using Laplace approximations in a flexible promotion time cure model based
on P-splines. <em>Computational Statistical &amp; Data Analysis</em> <strong>124</strong>:
151-167.
</p>
<p>Jullion, A. and Lambert, P. (2007). Robust specification of the
roughness penalty prior distribution in spatially adaptive Bayesian
P-splines models. <em>Computational Statistical &amp; Data Analysis</em>
<strong>51</strong>(5): 2542-2558.
</p>


<h3>See Also</h3>

<p><code>Surv</code>, <code>coxph</code>, <code>simsurvdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example 1 (Simulated survival data)

set.seed(3)

# Simulate survival data  with simsurvdata
betas &lt;- c(0.13, 0.52, 0.30)
simul &lt;- simsurvdata(a = 3.8, b = 2.2, n = 250, betas = betas , censperc = 20)
simul
simdat &lt;- simul$survdata
plot(simul) # Plot survival data

# Estimation with coxlps
fit &lt;- coxlps(Surv(time, delta) ~ x1 + x2 + x3, data = simdat, K = 15)
# Compare coxlps and coxph
fit
summary(coxph(Surv(time, delta) ~ x1 + x2 + x3, data = simdat))

# Fitted baseline survival vs target
plot(fit, h0 = FALSE, cred.int = 0.95, overlay.km = TRUE)
domt &lt;- seq(0, 4, length = 100)
lines(domt, simul$S0(domt), type = "l", col = "red")
legend("topright", col=c("black", "blue", "red"), lty = rep(1,3),
      c("Bayesian LPS", "Kaplan-Meier", "Target"), cex = 0.8, bty = "n")

### Example 2 (Kidney transplant data)

data(kidneytran)
Surv.obj &lt;- Surv(kidneytran$time, kidneytran$delta)
fit &lt;- coxlps(Surv.obj ~ age + gender + race, data = kidneytran)
coxphfit &lt;- coxph(Surv.obj ~ age + gender + race, data = kidneytran)
## Compare coxph and coxlps results
summary(coxphfit)
fit
## Plot Kaplan-Meier curve vs Laplace-P-spline fit
plot(fit, h0 = FALSE, overlay.km = TRUE, plot.cred = FALSE)

### Example 3 (Laryngeal cancer data)

data(laryngeal)
fit &lt;- coxlps(Surv(time, delta) ~ age + diagyr + as.factor(stage),
               data = laryngeal)
coxphfit &lt;- coxph(Surv(time, delta) ~ age + diagyr + as.factor(stage),
                  data = laryngeal)
## Compare coxph and coxlps results
summary(coxphfit)
fit
## Plot Kaplan-Meier curve vs Laplace-P-spline fit
plot(fit, h0 = FALSE, overlay.km = TRUE, plot.cred = FALSE)


</code></pre>


</div>