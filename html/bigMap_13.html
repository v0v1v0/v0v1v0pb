<div class="container">

<table style="width: 100%;"><tr>
<td>bdm.optk.s2nr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find optimal number of clusters based on signal-to-noise-ratio.</h2>

<h3>Description</h3>

<p>Performs a recursive merging of clusters based on minimum loss of signal-to-noise-ratio (S2NR). The S2NR is the explained/unexplained variance ratio measured in the high dimensional space based on the given low dimensional clustering. Merging is applied recursively until reaching a configuration of only 2 clusters and the S2NR is measured at each step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bdm.optk.s2nr(bdm, info = T, plot.optk = T, ret.optk = F,
  layer = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bdm</code></td>
<td>
<p>A clustered <var>bdm</var> instance (<var>i.e.</var> all up-stream steps performed: <code>bdm.ptse(), bdm.pakde() and bdm.wtt()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>Logical value. If TRUE, all merging steps are shown (default value is <code>info = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.optk</code></td>
<td>
<p>Logical value. If TRUE, this function plots the heuristic measure versus the number of clusters (default value is <code>plot.optk = TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.optk</code></td>
<td>
<p>Logical value. For large datasets this computation can take a while and it might be interesting to save it. If TRUE, the function returns a copy of the <var>bdm</var> instance with the values of S2NR attached as <var>bdm$optk</var> (default value is <code>ret.optk = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layer</code></td>
<td>
<p>The <var>bdm$ptsne</var> layer to be used (default value is <code>layer = 1</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The logic under this heuristic is that neigbouring clusters in the embedding correspond to close clusters in the high dimensional space, <var>i.e.</var> it is a merging heuristic based on the spatial distribution of clusters. For each cluster (child cluster) we choose the neighboring cluster with steepest gradient along their common border (father cluster). Thus, we get a set of pairs of clusters (child/father) as potential mergings. Given this set of candidates, the merging is performed recursively choosing, at each step, the pair of child/father clusters that results in a minimum loss of S2NR.
A typical situation is that some clusters dominate over all of their neighboring clusters. This clusters have no <var>father</var>. Thus, once all candidate mergings have been performed we reach a <var>blocked</var> state where only the dominant clusters remain. This situation identifies a hierarchy level in the clustering. When this situation is reached, the algorithm starts a new merging round, identifying the child/father relations at that level of hierarchy. The process stops when only two clusters remain.
Usually, the clustering hierarchy is clearly depicted by singular points in the S2NR function. This is a hint that the low dimensional clustering configuration is an image of a hierarchycal spatial configuration in the high dimensional space. See <code>bdm.optk.plot()</code>.
</p>


<h3>Value</h3>

<p>None if <code>ret.optk = FALSE</code>. Else, a copy of the input <var>bdm</var> instance with new element <var>bdm$optk</var> (a matrix).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# --- load mapped dataset
bdm.example()
# --- compute optimal number of clusters and attach the computation
bdm.optk.s2nr(exMap, plot.optk = TRUE, ret.optk = FALSE)
</code></pre>


</div>