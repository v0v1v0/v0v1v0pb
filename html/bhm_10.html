<div class="container">

<table style="width: 100%;"><tr>
<td>brm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting Biomarker Continuous Threshold Models
</h2>

<h3>Description</h3>

<p>{brm} is an R function for Continuous Threshold Models.
It uses the maximum likehood method (Liu and Chen, 2020) 
to identify a cut-point (thershold parameter) for the biomarker in the Cox proportional hazards model.
The model is specified by giving a symbolic description of the linear predictor and a description of the distribution family.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brm(x, ...)

## S3 method for class 'formula'
brm(formula, data = list(...), interaction = TRUE, 
      method = c("gradient", "profile", "single"), q=1, epsilon = NULL, ...)
# use 
#          brm(y ~ biomarker)             
# or
#          brm(y ~ biomarker + x1 + x2, interactin = FALSE)
#
# to fit a prognostic model with biomarker term only (will be implement in the future)
#
# use 
#
#          brm(y ~ biomarker+treatment+x1+x2+...)
#
# to fit a predictive model with interaciton between biomarker 
# and treatment, adjusted for x1, x2, etc.
# 
# use 
#          brm(x, y, control, ...)
#
# to fit a model without formula
#
# Biomarker shall be in the first dependent variable
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula"(or one that can be coerced to that class): a symbolic description of the model to be fitted. 
The details of model specification are given under 'Details'.</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by 'as.data.frame' to a data frame) containing the variables in the model. 
If not found in data, the variables are taken from environment(formula), typically the environment from which glm is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction</code></td>
<td>
<p>model with interaction term between biomarker and treatment variables. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to fit a brm model, such as a gradient method or a single-index model. The default method is the "gradient" method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>nubmer of biomarker variables. If q &gt; 1, a single-index model will be fitted. Default is q = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For "brm.default", x is a design matrix of dimension n * p and y is a vector of observations of length n for a "Surv" survival object for "coxph" models.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level regression fitting functions (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Step width for the profile likelihood method, default is (max(w)-min(w))/20.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>'biomarker' is a Biomarker variable. This variable is required and shall be the first dependent variable in the formula.
</p>
<p>"interaction" is an option of fitting model with itneractin term.
When interaction = TRUE, a predictive biomarker model will be fitted.
When interaction = FALSE, a prognostic biomarker model will be fitted.
Both Biomarker and Treatment variables are required if 'interaction' = TRUE and 'treatment' shall be the second variable in the formula.
</p>
<p>"brm.default" is the workhorse functions: they are not normally called directly but can be more efficient where the response vector, design matrix and family have already been calculated.
</p>


<h3>Value</h3>


<p>brm returns an object of class inheriting from "brm" which inherits from the class glm or 'coxph'. See later in this section.  
</p>
<p>The function "summary" (i.e., "summary.brm") can be used to obtain or print a summary of the results, 
for example, the 95
</p>
<p>An object of class "brm" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients from 'brm'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.max</code></td>
<td>
<p>the maximum likelihood estimate for the threshold parameter(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a vector contains both the coefficients and c.max.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the variance matrix of theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the log-likelihood with the final values of the coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>the vector of linear predictors, one per subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first</code></td>
<td>
<p>the first derivative vector at the solution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Shuoshuo Liu (shuoshuo.liu@psu.edu) and Bingshu E. Chen (bingshu.chen@queensu.ca)
</p>


<h3>References</h3>

<p>Liu, S. S. and Chen, B. E. (2020). Continuous threshold models with two-way interactions in survival analysis. Canadian Journal of Statistics. Vol. 48, page 751-772. 
</p>


<h3>See Also</h3>


<p><code>bhm</code>, 
<code>coxph</code>,
<code>plot.brm</code>,
<code>print.brm</code>,
<code>residuals.brm</code>,
<code>summary.brm</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## Generate a random data set
n = 100
b = c(0.5, 1, 1.5)
data = gendat.surv(n, c0 = 0.40, beta = b, type="brm")
age = runif(n, 0, 1)*100
tm = data[, 1]
status = data[, 2]
trt = data[, 3]
ki67 = data[, 4]
## fit a biomarker threshold survival model with one single cut point

   fit = brm(Surv(tm, status)~ki67+trt+age)
##
## fit a prognostic continuous threshold model with biomarker only
##
#    fit = brm(Surv(tm, status)~ki67)
##
## To print the output, use
##
#    print(fit)
##
</code></pre>


</div>