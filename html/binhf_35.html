<div class="container">

<table style="width: 100%;"><tr>
<td>propest.wav</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Proportion estimation function</h2>

<h3>Description</h3>

<p>Proportion estimation procedure for simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">propest.wav(proportion = P2, binsize=1,length = 256, times = 100, meth = "u", van = 6, 
fam = "DaubLeAsymm", min.level = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>proportion</code></td>
<td>
<p>A Bernoulli proportion/binomial mean function.  Examples are <span class="env">P2</span>, <span class="env">P4</span> and <span class="env">sinlog</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>
<p>The binomial size corresponding to the mean function <span class="env">proportion</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>Length of vector to be produced.  Must be a power of two.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>The number of times to sample the proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p>A wavelet thresholding method.  Possible values are "u" for universal thresholding, or "c" for cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>van</code></td>
<td>
<p>the number of vanishing moments of the wavelet used in the wavelet denoiser.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>the wavelet family used in the wavelet denoiser.  Possible values are "DaubLeAsymm" and "DaubExPhase".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.level</code></td>
<td>
<p>the primary resolution level for the wavelet transform denoiser.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a regularly-spaced vector on the unit interval of length <span class="env">length</span>, and uses these values to create corresponding values using the proportion function.  These values are then used as binomial probabilities to sample "observed" binomial random variables.  The observation vector is then denoised using a wavelet transform defined by the arguments <span class="env">van</span>, <span class="env">fam</span>, <span class="env">min.level</span> with thresholding method <span class="env">meth</span>.  This denoising is done for both Anscombe and the Haar-Fisz method for binomial random variables.  The procedure is repeated <span class="env">times</span> times, and the resulting proportion estimates averaged.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>regular grid on which the proportion function is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector corresponding to <span class="env">x</span> of proportion function values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>matrix of dimensions <span class="env">times</span>x<span class="env">length</span> of sampled binomial variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>matrix of dimensions <span class="env">times</span>x<span class="env">length</span> of estimated values of the proportion function, for the binomial Haar-Fisz transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ea</code></td>
<td>
<p>matrix of dimensions <span class="env">times</span>x<span class="env">length</span> of estimated values of the proportion function, for Anscombe's transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanfhat</code></td>
<td>
<p>averaged proportion estimate for the binomial Haar-Fisz transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanfhata</code></td>
<td>
<p>averaged proportion estimate for Anscombe's transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amse</code></td>
<td>
<p>average mean square error for the binomial Haar-Fisz transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amsea</code></td>
<td>
<p>average mean square error for Anscombe's transform.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matt Nunes (<a href="mailto:m.nunes@ucl.ac.uk">m.nunes@ucl.ac.uk</a>)</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
sim&lt;-propest.wav(proportion = P2, binsize=1,length = 256, times = 1000, meth = "u", 
van = 6, fam = "DaubLeAsymm", min.level = 4)

plot(sim$x,sim$y,type="l",xlab="",ylab="Binomial mean function")

##^^ shows original proportion to estimate.

lines(sim$x,sim$meanfhat,col=2)
lines(sim$x,sim$meanfhata,col=3)

##^^shows the estimates of the proportion from the two transforms.

## End(Not run)
</code></pre>


</div>