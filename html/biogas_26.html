<div class="container">

<table style="width: 100%;"><tr>
<td>stdVol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Correct Gas Volume to 'Standard' Conditions
</h2>

<h3>Description</h3>

<p><code>stdVol</code> corrects gas volumes to dry conditions at a specified temperature and pressure. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">stdVol(vol, temp, pres, rh = 1, 
       temp.std = getOption('temp.std', as.numeric(NA)), 
       pres.std = getOption('pres.std', as.numeric(NA)), 
       unit.temp = getOption('unit.temp', 'C'), 
       unit.pres = getOption('unit.pres', 'atm'), 
       std.message = TRUE, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vol</code></td>
<td>

<p>measured gas volume at <code>temp</code> temperature, <code>pres</code> pressure, and <code>rh</code> relative humidity.
A numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp</code></td>
<td>

<p>temperature of gas in degrees C by default (see <code>unit.temp</code>).
A numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pres</code></td>
<td>

<p>pressure of gas in atm by default (see <code>unit.pres</code>).
A numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rh</code></td>
<td>

<p>relative humidity of the gas (<code>0&lt;= rh &lt;= 1</code>).
Typically should be 1.0 (the default).
A numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.std</code></td>
<td>

<p>"standard" temperature.
Default value is 0 degrees C.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pres.std</code></td>
<td>

<p>"standard" pressure.
Default value is 1.0 atm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.pres</code></td>
<td>

<p>pressure units for <code>pres</code> and <code>pres.std</code> arguments.
Options are <code>"atm"</code> (the default), <code>"Pa"</code>, <code>"kPa"</code>, <code>"hPa"</code>, and <code>"bar"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.temp</code></td>
<td>

<p>temperature units for <code>temp</code> and <code>temp.std</code> arguments.
Options are <code>"C"</code> (degrees Celcius), <code>"F"</code> (degrees Fahrenheit), and <code>"K"</code> (Kelvin).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.message</code></td>
<td>

<p>should a message with the standard conditions be displayed? Default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>

<p>if <code>TRUE</code>, will return a warning if temperature is below 0 C  or above 100 C, or if pressure is below 50 kPa or above 150 kPa.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Standardisation is done in a two-step process following Hafner et al. (2015).
First, the contribution of water vapor is removed and volume is corrected to the standard pressure:
</p>
<p>vd = vm*(pm - rh*pw)/ps
</p>
<p>where vd = dry volume at standard pressure ps, vm = measured volume at pressure pm, pw = saturation vapor pressure of water (all pressures in Pa), and rh = relative humidity (<code>rh</code> above).
Water vapor pressure pw is calculated from the Magnus form equation given in Alduchov and Eskridge (1996) (Eqs. (21) and (22)).
In the second step, the volume is adjusted for temperature.
</p>
<p>vs = vd*Ts/T  
</p>
<p>where vs = standardised volume and Ts = standardisation temperature (K, converted from <code>temp.std</code> argument).
This approach is based on Charles's and Boyle's laws.
Comparison with calculations using the Peng-Robinson equation of state suggests that error in <code>stdVol</code> is around 0.1% for typical biogas with volume measured at 25 degrees C, and higher at higher temperatures (up to 0.3% at 55 degrees C).
</p>
<p>Standard temperature and pressure and their units can be defined by the user using the <code>temp.std</code>, <code>pres.std</code>, <code>temp.unit</code>, and <code>pres.unit</code> arguments.  
Alternatively,  standard values and units of temperature and pressure can be globally set using the function <code>options</code>.
Default values are 0 degrees C and 1.0 atm. 
<code>stdVol</code> is vectorized, and if one argument has a shorter length than the others, it will be recycled.
</p>


<h3>Value</h3>

<p>Standardised gas volume in the same units as <code>vol</code>.
A numeric vector.
</p>


<h3>Author(s)</h3>

<p>Sasha D. Hafner and Charlotte Rennuit
</p>


<h3>References</h3>

<p>Hafner, S.D., Rennuit, C., Triolo, J.M., Richards, B.K. 2015. Validation of a simple gravimetric method for measuring biogas production in laboratory experiments. <em>Biomass and Bioenergy</em> <b>83</b>, 297-301.
</p>
<p>Richards, B.K., Cummings, R.J., White, T.E., Jewell, W.J. 1991. Methods for kinetic analysis of methane fermentation in high solids biomass digesters. <em>Biomass and Bioenergy</em> <b>1</b>, 65-73.
</p>


<h3>See Also</h3>

<p><code>cumBg</code>,
<code>summBg</code>,
<code>stdVol</code>,
<code>options</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # 100 mL, measured at 35 C
  stdVol(100, temp = 35, pres = 1)

  # Or, with different units
  stdVol(100, temp = 35, pres = 103, unit.pres = "kPa", pres.std = 101.325)
  
  # Vectorized
  data(vol)
  head(vol)
  vol$vol.std &lt;- stdVol(vol$vol, temp = 20, pres = 1.02)
  head(vol)
  
  #using options() (recommended!)
  oldoptions &lt;- options(temp.std = 273.15, pres.std = 101325, 
                        unit.temp = 'K', unit.pres = 'Pa')
  vol$vol.std &lt;- stdVol(vol$vol, temp = 293.15, pres = 101325)
  head(vol)
  options(oldoptions)
</code></pre>


</div>