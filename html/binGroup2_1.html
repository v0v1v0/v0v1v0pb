<div class="container">

<table style="width: 100%;"><tr>
<td>binGroup2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>binGroup2: Identification and Estimation using Group Testing</h2>

<h3>Description</h3>

<p>Methods for the group testing identification and
estimation problems.
</p>


<h3>Details</h3>

<p>Methods for identification of positive items in group testing designs:
Operating characteristics (e.g., expected number of tests) are calculated
for commonly used hierarchical and array-based algorithms. Optimal testing
configurations for an algorithm can be found as well. Please see Hitt et al.
(2019) for specific details.
</p>
<p>Methods for estimation and inference for proportions in group testing
designs: For estimating one proportion or the difference of proportions,
confidence interval methods are included that account for different pool
sizes. Functions for hypothesis testing of proportions, calculation of
power, and calculation of the expected width of confidence intervals are
also included. Furthermore, regression methods and simulation of group
testing data are implemented for simple pooling (Dorfman testing with
or without retests), halving, and array testing designs.
</p>
<p>The <code>binGroup2</code> package is based upon the <code>binGroup</code> package that
was originally designed for the group testing estimation problem. Over time,
additional functions for estimation and for the group testing identification
problem were included. Due to the diverse styles resulting from these
additions, we have created <code>binGroup2</code> as a way to unify functions in
a coherent structure and incorporate additional functions for
identification. The <code>binGroup2</code> package provides all the main
functionality from the <code>binGroup</code> package, and can be used in place of
the <code>binGroup</code> package. The name “binGroup” originates from the
assumption in basic estimation for group testing that the
number of positive groups has a binomial distribution. While more advanced
estimation methods no longer make this assumption, we continue with the
<code>binGroup</code> name for consistency.
</p>
<p>Bilder (2019a,b) provide introductions to group testing. These papers and
additional details about group testing are available at
<a href="http://chrisbilder.com/grouptesting/">http://chrisbilder.com/grouptesting/</a>.
</p>
<p>This research was supported by the National Institutes of Health under
grant R01 AI121351.
</p>


<h4>Identification</h4>

<p>The binGroup2 package focuses on the group testing identification problem
using hierarchical and array-based group testing algorithms.
</p>
<p>The <code>OTC1</code> function implements a number of group testing
algorithms, described in Hitt et al. (2019), which calculate the operating
characteristics and find the optimal testing configuration over a range of
possible initial group sizes and/or testing configurations (sets of
subsequent group sizes). The <code>OTC2</code> function does the same with
a multiplex assay that tests for two diseases.
</p>
<p>The <code>operatingCharacteristics1</code> (<code>opChar1</code>) and
<code>operatingCharacteristics2</code> (<code>opChar2</code>) functions
calculate operating characteristics for a specified testing configuration
with assays that test for one and two diseases, respectively.
</p>
<p>These functions allow the sensitivity and specificity to differ across
stages of testing. This means that the accuracy of the diagnostic test can
differ for stages in a hierarchical testing algorithm or between
row/column testing and individual testing in an array testing algorithm.</p>



<h4>Estimation</h4>

<p>The binGroup2 package also provides functions for estimation and
inference for proportions in group testing designs.
</p>
<p>The <code>propCI</code> function calculates the point estimate and
confidence intervals for a single proportion from group testing data.
The <code>propDiffCI</code> function does the same for the difference of
proportions. A number of confidence interval methods are available for
groups of equal or different sizes.
</p>
<p>The <code>gtWidth</code> function calculates the expected width of
confidence intervals in group testing. The <code>gtTest</code> function
calculates p-values for hypothesis tests of single proportions. The
<code>gtPower</code> function calculates power to reject a hypothesis.
</p>
<p>The <code>designPower</code> function iterates either the number of groups
or group size in a one-parameter group testing design until a pre-specified
power level is achieved. The <code>designEst</code> function finds the
optimal group size corresponding to the minimal mean-squared error of the
point estimator.
</p>
<p>The <code>gtReg</code> function implements regression methods and the
<code>gtSim</code> function simulates group testing data for simple
pooling, halving, and array testing designs.</p>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Brianna Hitt <a href="mailto:brianna.hitt@afacademy.af.edu">brianna.hitt@afacademy.af.edu</a> (<a href="https://orcid.org/0000-0002-0645-0067">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li>
<p> Christopher Bilder (<a href="https://orcid.org/0000-0002-2848-8576">ORCID</a>)
</p>
</li>
<li>
<p> Frank Schaarschmidt (<a href="https://orcid.org/0000-0002-6599-3803">ORCID</a>)
</p>
</li>
<li>
<p> Brad Biggerstaff (<a href="https://orcid.org/0000-0002-3105-3530">ORCID</a>)
</p>
</li>
<li>
<p> Christopher McMahan (<a href="https://orcid.org/0000-0001-5056-9615">ORCID</a>)
</p>
</li>
<li>
<p> Joshua Tebbs (<a href="https://orcid.org/0000-0002-6762-7241">ORCID</a>)
</p>
</li>
</ul>
<p>Other contributors:
</p>

<ul>
<li>
<p> Boan Zhang [contributor]
</p>
</li>
<li>
<p> Michael Black [contributor]
</p>
</li>
<li>
<p> Peijie Hou [contributor]
</p>
</li>
<li>
<p> Peng Chen [contributor]
</p>
</li>
<li>
<p> Minh Nguyen [contributor]
</p>
</li>
</ul>
<h3>References</h3>

<p>Altman, D., Bland, J. (1994).
“Diagnostic tests 1: Sensitivity and specificity.”
<em>BMJ</em>, <b>308</b>, 1552.
</p>
<p>Altman, D., Bland, J. (1994).
“Diagnostic tests 2: Predictive values.”
<em>BMJ</em>, <b>309</b>, 102.
</p>
<p>Biggerstaff, B. (2008).
“Confidence intervals for the difference of proportions estimated from pooled samples.”
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>, <b>13</b>, 478–496.
</p>
<p>Bilder, C., Tebbs, J., Chen, P. (2010).
“Informative retesting.”
<em>Journal of the American Statistical Association</em>, <b>105</b>, 942–955.
</p>
<p>Bilder, C., Tebbs, J., McMahan, C. (2019).
“Informative group testing for multiplex assays.”
<em>Biometrics</em>, <b>75</b>, 278–288.
</p>
<p>Bilder, C. (2019a).
“Group Testing for Estimation.”
<em>Wiley StatsRef: Statistics Reference Online</em>.
</p>
<p>Bilder, C. (2019b).
“Group Testing for Identification.”
<em>Wiley StatsRef: Statistics Reference Online</em>.
</p>
<p>Bilder, C., Iwen, P., Abdalhamid, B., Tebbs, J., McMahan, C. (2020).
“Tests in short supply? Try group testing.”
<em>Significance</em>, <b>17</b>, 15.
</p>
<p>Black, M., Bilder, C., Tebbs, J. (2012).
“Group testing in heterogeneous populations by using halving algorithms.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>61</b>, 277–290.
</p>
<p>Black, M., Bilder, C., Tebbs, J. (2015).
“Optimal retesting configurations for hierarchical group testing.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>64</b>, 693–710.
</p>
<p>Graff, L., Roeloffs, R. (1972).
“Group testing in the presence of test error; an extension of the Dorfman procedure.”
<em>Technometrics</em>, <b>14</b>, 113–122.
</p>
<p>Hepworth, G. (1996).
“Exact confidence intervals for proportions estimated by group testing.”
<em>Biometrics</em>, <b>52</b>, 1134–1146.
</p>
<p>Hepworth, G., Biggerstaff, B. (2017).
“Bias correction in estimating proportions by pooled testing.”
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>, <b>22</b>, 602–614.
</p>
<p>Hitt, B., Bilder, C., Tebbs, J., McMahan, C. (2019).
“The objective function controversy for group testing: Much ado about nothing?”
<em>Statistics in Medicine</em>, <b>38</b>, 4912–4923.
</p>
<p>Hou, P., Tebbs, J., Wang, D., McMahan, C., Bilder, C. (2021).
“Array testing with multiplex assays.”
<em>Biostatistics</em>, <b>21</b>, 417–431.
</p>
<p>Malinovsky, Y., Albert, P., Roy, A. (2016).
“Reader reaction: A note on the evaluation of group testing algorithms in the presence of misclassification.”
<em>Biometrics</em>, <b>72</b>, 299–302.
</p>
<p>McMahan, C., Tebbs, J., Bilder, C. (2012a).
“Informative Dorfman Screening.”
<em>Biometrics</em>, <b>68</b>, 287–296.
</p>
<p>McMahan, C., Tebbs, J., Bilder, C. (2012b).
“Two-Dimensional Informative Array Testing.”
<em>Biometrics</em>, <b>68</b>, 793–804.
</p>
<p>Schaarschmidt, F. (2007).
“Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing.”
<em>Communications in Biometry and Crop Science</em>, <b>2</b>, 32–40.
ISSN 1896-0782.
</p>
<p>Swallow, W. (1985).
“Group testing for estimating infection rates and probabilities of disease transmission.”
<em>Phytopathology</em>, <b>75</b>, 882–889.
</p>
<p>Tebbs, J., Bilder, C. (2004).
“Confidence interval procedures for the probability of disease transmission in multiple-vector-transfer designs.”
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>, <b>9</b>, 75–90.
</p>
<p>Vansteelandt, S., Goetghebeur, E., Verstraeten, T. (2000).
“Regression models for disease prevalence with diagnostic tests on pools of serum samples.”
<em>Biometrics</em>, <b>56</b>, 1126–1133.
</p>
<p>Verstraeten, T., Farah, B., Duchateau, L., Matu, R. (1998).
“Pooling sera to reduce the cost of HIV surveillance: a feasibility study in a rural Kenyan district.”
<em>Tropical Medicine &amp; International Health</em>, <b>3</b>, 747–750.
</p>
<p>Xie, M. (2001).
“Regression analysis of group testing samples.”
<em>Statistics in Medicine</em>, <b>20</b>, 1957–1969.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# 1) Identification using hierarchical and array-based
#   group testing algorithms with an assay that tests
#   for one disease.

# 1.1) Find the optimal testing configuration over a
#   range of initial group sizes, using informative
#   three-stage hierarchical testing, where
#   p denotes the overall prevalence of disease (mean
#    parameter of a beta distribution);
#   Se denotes the sensitivity of the diagnostic test;
#   Sp denotes the specificity of the diagnostic test;
#   group.sz denotes the range of initial pool sizes
#   for consideration;
#   obj.fn specifies the objective functions for which
#   to find results; and
#   alpha is the heterogeneity level.
set.seed(1002)
results1 &lt;- OTC1(algorithm = "ID3", p = 0.025, Se = 0.95,
                 Sp = 0.95, group.sz = 3:20,
                 obj.fn = "ET", alpha = 2)
summary(results1)

# 1.2) Find the optimal testing configuration using
#   non-informative array testing without master pooling.
# The sensitivity and specificity differ for row/column
#   testing and individual testing.
results2 &lt;- OTC1(algorithm = "A2", p = 0.05,
                 Se = c(0.95, 0.99), Sp = c(0.95, 0.98),
                 group.sz = 3:15, obj.fn = "ET")
summary(results2)

# 1.3) Calculate the operating characteristics using
#   informative two-stage hierarchical (Dorfman) testing,
#   implemented via the pool-specific optimal Dorfman
#   (PSOD) method described in McMahan et al. (2012a).
# Hierarchical testing configurations are specified by
#   a matrix in the hier.config argument. The rows of
#   the matrix correspond to the stages of the
#   hierarchical testing algorithm, the columns
#   correspond to the individuals to be tested, and the
#   cell values correspond to the group number of each
#   individual at each stage.
config.mat &lt;- matrix(data = c(rep(1, 5), rep(2, 4), 3, 1:10),
                     nrow = 2, ncol = 10, byrow = TRUE)
set.seed(8791)
results3 &lt;- opChar1(algorithm = "ID2", p = 0.02,
                    Se = 0.95, Sp = 0.99,
                    hier.config = config.mat, alpha = 0.5)
summary(results3)

# 1.4) Calculate the operating characteristics using
#   non-informative four-stage hierarchical testing.
config.mat &lt;- matrix(data = c(rep(1, 15), rep(c(1, 2, 3), each = 5),
                              rep(1, 3), rep(2, 2),
                              rep(3, 3), rep(4, 2),
                              rep(5, 4), 6, 1:15),
                     nrow = 4, ncol = 15, byrow = TRUE)
results4 &lt;- opChar1(algorithm = "D4", p = 0.008,
                    Se = 0.96, Sp = 0.98,
                    hier.config = config.mat,
                    a = c(1, 4, 6, 9, 11, 15))
summary(results4)


# 2) Identification using hierarchical and array-based
#   group testing algorithms with a multiplex assay that
#   tests for two diseases.

# 2.1) Find the optimal testing configuration using
#   non-informative two-stage hierarchical testing, given
#   p.vec, a vector of overall joint probabilities of disease;
#   Se, a vector of sensitivity values for each disease; and
#   Sp, a vector of specificity values for each disease.
# Se and Sp can also be specified as a matrix, where one
#   value is specified for each disease at each stage of
#   testing.
results5 &lt;- OTC2(algorithm = "D2",
                 p.vec = c(0.90, 0.04, 0.04, 0.02),
                 Se = c(0.99, 0.99), Sp = c(0.99, 0.99),
                 group.sz = 3:20)
summary(results5)

# 2.2) Calculate the operating characteristics for
#   informative five-stage hierarchical testing, given
#   alpha.vec, a vector of shape parameters for the
#   Dirichlet distribution;
#   Se, a matrix of sensitivity values; and
#   Sp, a matrix of specificity values.
Se &lt;- matrix(data = rep(0.95, 10), nrow = 2, ncol = 5, byrow = TRUE)
Sp &lt;- matrix(data = rep(0.99, 10), nrow = 2, ncol = 5, byrow = TRUE)
config.mat &lt;- matrix(data = c(rep(1, 24), rep(1, 18),
                              rep(2, 6), rep(1, 9),
                              rep(2, 9), rep(3, 4), 4, 5,
                              rep(1, 6), rep(2, 3),
                              rep(3, 5), rep(4, 4),
                              rep(5, 3), 6, rep(NA, 2),
                              1:21, rep(NA, 3)),
                     nrow = 5, ncol = 24, byrow = TRUE)
results6 &lt;- opChar2(algorithm = "ID5",
                    alpha = c(18.25, 0.75, 0.75, 0.25),
                    Se = Se, Sp = Sp,
                    hier.config = config.mat)
summary(results6)

# 3) Estimation of the overall disease prevalence and
#   calculation of confidence intervals.

# 3.1) Suppose 3 groups out of 24 test positively.
#   Each group has a size of 7.
propCI(x = 3, m = 7, n = 24, ci.method = "CP")
propCI(x = 3, m = 7, n = 24, ci.method = "Blaker")
propCI(x = 3, m = 7, n = 24, ci.method = "score")
propCI(x = 3, m = 7, n = 24, ci.method = "soc")

# 3.2) Consider the following situation:
#   0 out of 5 groups test positively with groups
#   of size 1 (individual testing),
#   0 out of 5 groups test positively with groups of size 5,
#   1 out of 5 groups test positively with groups of size 10,
#   2 out of 5 groups test positively with groups of size 50
propCI(x = c(0, 0, 1, 2), m = c(1, 5, 10, 50),
       n = c(5, 5, 5, 5), pt.method = "Gart",
       ci.method = "skew-score")

# 4) Estimate a group testing regression model.

# 4.1) Fit a group testing regression model with
#   simple pooling using the "hivsurv" dataset.
data(hivsurv)
fit1 &lt;- gtReg(type = "sp",
              formula = groupres ~ AGE + EDUC.,
              data = hivsurv, groupn = gnum,
              sens = 0.9, spec = 0.9, method = "Xie")
summary(fit1)

# 4.2) Simulate data for the halving protocol, and
#   fit a group testing regression model.
set.seed(46)
gt.data &lt;- gtSim(type = "halving", par = c(-6, 0.1),
                 gshape = 17, gscale = 1.4,
                 size1 = 1000, size2 = 5,
                 sens = 0.95, spec = 0.95)
fit2 &lt;- gtReg(type = "halving", formula = gres ~ x,
              data = gt.data, groupn = groupn,
              subg = subgroup, retest = retest,
              sens = 0.95, spec = 0.95,
              start = c(-6, 0.1), trace = TRUE)
summary(fit2)


</code></pre>


</div>