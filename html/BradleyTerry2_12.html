<div class="container">

<table style="width: 100%;"><tr>
<td>flatlizards</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Augrabies Male Flat Lizards: Contest Results and Predictor Variables</h2>

<h3>Description</h3>

<p>Data collected at Augrabies Falls National Park (South Africa) in
September-October 2002, on the contest performance and background attributes
of 77 male flat lizards (<em>Platysaurus broadleyi</em>).  The results of
exactly 100 contests were recorded, along with various measurements made on
each lizard.  Full details of the study are in Whiting et al. (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">flatlizards
</code></pre>


<h3>Format</h3>

<p>This dataset is a list containing two data frames:
<code>flatlizards$contests</code> and <code>flatlizards$predictors</code>.
</p>
<p>The <code>flatlizards$contests</code> data frame has 100 observations on the
following 2 variables: </p>

<dl>
<dt>winner</dt>
<dd>
<p>a factor with 77
levels <code>lizard003</code> ... <code>lizard189</code>.</p>
</dd>
<dt>loser</dt>
<dd>
<p>a factor
with the same 77 levels <code>lizard003</code> ... <code>lizard189</code>.</p>
</dd> </dl>
<p>The <code>flatlizards$predictors</code> data frame has 77 observations (one for
each of the 77 lizards) on the following 18 variables: </p>

<dl>
<dt>id</dt>
<dd>
<p>factor with 77 levels (3 5 6 ... 189), the lizard
identifiers.</p>
</dd>
<dt>throat.PC1</dt>
<dd>
<p>numeric, the first principal
component of the throat spectrum.</p>
</dd>
<dt>throat.PC2</dt>
<dd>
<p>numeric, the
second principal component of the throat spectrum.</p>
</dd>
<dt>throat.PC3</dt>
<dd>
<p>numeric, the third principal component of the
throat spectrum.</p>
</dd>
<dt>frontleg.PC1</dt>
<dd>
<p>numeric, the first principal
component of the front-leg spectrum.</p>
</dd>
<dt>frontleg.PC2</dt>
<dd>
<p>numeric,
the second principal component of the front-leg spectrum.</p>
</dd>
<dt>frontleg.PC3</dt>
<dd>
<p>numeric, the third principal component of the
front-leg spectrum.</p>
</dd>
<dt>badge.PC1</dt>
<dd>
<p>numeric, the first principal
component of the ventral colour patch spectrum.</p>
</dd>
<dt>badge.PC2</dt>
<dd>
<p>numeric, the second principal component of the
ventral colour patch spectrum.</p>
</dd>
<dt>badge.PC3</dt>
<dd>
<p>numeric, the third
principal component of the ventral colour patch spectrum.</p>
</dd>
<dt>badge.size</dt>
<dd>
<p>numeric, a measure of the area of the ventral
colour patch.</p>
</dd>
<dt>testosterone</dt>
<dd>
<p>numeric, a measure of blood
testosterone concentration.</p>
</dd>
<dt>SVL</dt>
<dd>
<p>numeric, the snout-vent
length of the lizard.</p>
</dd>
<dt>head.length</dt>
<dd>
<p>numeric, head length.</p>
</dd>
<dt>head.width</dt>
<dd>
<p>numeric, head width.</p>
</dd>
<dt>head.height</dt>
<dd>
<p>numeric, head height.</p>
</dd>
<dt>condition</dt>
<dd>
<p>numeric, a measure of body condition.</p>
</dd>
<dt>repro.tactic</dt>
<dd>
<p>a factor indicating reproductive tactic; levels
are <code>resident</code> and <code>floater</code>.</p>
</dd> </dl>
<h3>Details</h3>

<p>There were no duplicate contests (no pair of lizards was seen fighting more
than once), and there were no tied contests (the result of each contest was
clear).
</p>
<p>The variables <code>head.length</code>, <code>head.width</code>, <code>head.height</code> and
<code>condition</code> were all computed as residuals (of directly measured head
length, head width, head height and body mass index, respectively) from
simple least-squares regressions on <code>SVL</code>.
</p>
<p>Values of some predictors are missing (<code>NA</code>) for some lizards,
‘at random’, because of instrument problems unconnected with the
value of the measurement being made.
</p>


<h3>Source</h3>

<p>The data were collected by Dr Martin Whiting,
<a href="http://whitinglab.com/people/martin-whiting/">http://whitinglab.com/people/martin-whiting/</a>, and they appear here
with his kind permission.
</p>


<h3>References</h3>

<p>Turner, H. and Firth, D. (2012) Bradley-Terry models in R: The
BradleyTerry2 package.  <em>Journal of Statistical Software</em>,
<strong>48</strong>(9), 1–21.
</p>
<p>Whiting, M. J., Stuart-Fox, D. M., O'Connor, D., Firth, D., Bennett, N. C.
and Blomberg, S. P. (2006). Ultraviolet signals ultra-aggression in a
lizard. <em>Animal Behaviour</em> <strong>72</strong>, 353–363.
</p>


<h3>See Also</h3>

<p><code>BTm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##
##  Fit the standard Bradley-Terry model, using the bias-reduced
##  maximum likelihood method:
##
result &lt;- rep(1, nrow(flatlizards$contests))
BTmodel &lt;- BTm(result, winner, loser, br = TRUE, data = flatlizards$contests)
summary(BTmodel)
##
##  That's fairly useless, though, because of the rather small
##  amount of data on each lizard.  And really the scientific
##  interest is not in the abilities of these particular 77
##  lizards, but in the relationship between ability and the
##  measured predictor variables.
##
##  So next fit (by maximum likelihood) a "structured" B-T model in
##  which abilities are determined by a linear predictor.
##
##  This reproduces results reported in Table 1 of Whiting et al. (2006):
##
Whiting.model &lt;- BTm(result, winner, loser, 
                     ~ throat.PC1[..] + throat.PC3[..] +
                         head.length[..] + SVL[..],
                     data = flatlizards)
summary(Whiting.model)
##
##  Equivalently, fit the same model using glmmPQL:
##
Whiting.model &lt;- BTm(result, winner, loser,
                     ~ throat.PC1[..] + throat.PC3[..] +
                         head.length[..] + SVL[..] + (1|..), 
                     sigma = 0, sigma.fixed = TRUE, data = flatlizards)
summary(Whiting.model)
##
##  But that analysis assumes that the linear predictor formula for
##  abilities is _perfect_, i.e., that there is no error in the linear
##  predictor.  This will always be unrealistic.
##
##  So now fit the same predictor but with a normally distributed error
##  term --- a generalized linear mixed model --- by using the BTm
##  function instead of glm.
##
Whiting.model2 &lt;- BTm(result, winner, loser,
                      ~ throat.PC1[..] + throat.PC3[..] +
                          head.length[..] + SVL[..] + (1|..), 
                      data = flatlizards, trace = TRUE)
summary(Whiting.model2)
##
##  The estimated coefficients (of throat.PC1, throat.PC3,
##  head.length and SVL are not changed substantially by
##  the recognition of an error term in the model; but the estimated
##  standard errors are larger, as expected.  The main conclusions from
##  Whiting et al. (2006) are unaffected.
##
##  With the normally distributed random error included, it is perhaps
##  at least as natural to use probit rather than logit as the link
##  function:
##
require(stats)
Whiting.model3 &lt;- BTm(result, winner, loser, 
                      ~ throat.PC1[..] + throat.PC3[..] +
                          head.length[..] + SVL[..] + (1|..),
                      family = binomial(link = "probit"),
                      data = flatlizards, trace = TRUE)
summary(Whiting.model3)
BTabilities(Whiting.model3)
##  Note the "separate" attribute here, identifying two lizards with
##  missing values of at least one predictor variable 
##
##  Modulo the usual scale change between logit and probit, the results
##  are (as expected) very similar to Whiting.model2.

</code></pre>


</div>