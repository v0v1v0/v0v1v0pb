<div class="container">

<table style="width: 100%;"><tr>
<td>ekpf_filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extended Kalman Particle Filtering</h2>

<h3>Description</h3>

<p>Function <code>ekpf_filter</code> performs a extended Kalman particle filtering
with stratification resampling, based on Van Der Merwe et al (2001).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ekpf_filter(model, particles, ...)

## S3 method for class 'ssm_nlg'
ekpf_filter(
  model,
  particles,
  seed = sample(.Machine$integer.max, size = 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model of class <code>ssm_nlg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>particles</code></td>
<td>
<p>Number of particles as a positive integer. Suitable values
depend on the model and the data, and while larger values provide more
accurate estimates, the run time also increases with respect to the
number of particles, so it is generally a good idea to test the filter first
with a small number of particles, e.g., less than 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the C++ RNG (positive integer).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing samples, filtered estimates and the
corresponding covariances, weights, and an estimate of log-likelihood.
</p>


<h3>References</h3>

<p>Van Der Merwe, R., Doucet, A., De Freitas, N., &amp; Wan, E. A.
(2001). The unscented particle filter. In Advances in neural
information processing systems (pp. 584-590).
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Takes a while
set.seed(1)
n &lt;- 50
x &lt;- y &lt;- numeric(n)
y[1] &lt;- rnorm(1, exp(x[1]), 0.1)
for(i in 1:(n-1)) {
 x[i+1] &lt;- rnorm(1, sin(x[i]), 0.1)
 y[i+1] &lt;- rnorm(1, exp(x[i+1]), 0.1)
}

pntrs &lt;- cpp_example_model("nlg_sin_exp")

model_nlg &lt;- ssm_nlg(y = y, a1 = pntrs$a1, P1 = pntrs$P1, 
  Z = pntrs$Z_fn, H = pntrs$H_fn, T = pntrs$T_fn, R = pntrs$R_fn, 
  Z_gn = pntrs$Z_gn, T_gn = pntrs$T_gn,
  theta = c(log_H = log(0.1), log_R = log(0.1)), 
  log_prior_pdf = pntrs$log_prior_pdf,
  n_states = 1, n_etas = 1, state_names = "state")

out &lt;- ekpf_filter(model_nlg, particles = 100)
ts.plot(cbind(x, out$at[1:n], out$att[1:n]), col = 1:3)

</code></pre>


</div>