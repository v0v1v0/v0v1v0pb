<div class="container">

<table style="width: 100%;"><tr>
<td>BIFIE.lavaan.survey</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting a Model in <span class="pkg">lavaan</span> or in <span class="pkg">survey</span>
</h2>

<h3>Description</h3>

<p>The function <code>BIFIE.lavaan.survey</code> fits a structural equation model in <span class="pkg">lavaan</span>
using the <b>lavaan.survey</b> package (currently not on CRAN). Currently, only
maximum likelihood estimation for normally distributed data is available.
</p>
<p>The function <code>BIFIE.survey</code> fits a model defined in the <span class="pkg">survey</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BIFIE.lavaan.survey(lavmodel, svyrepdes, lavaan_fun="sem",
    lavaan_survey_default=FALSE, fit.measures=NULL, ...)

## S3 method for class 'BIFIE.lavaan.survey'
summary(object, ...)

## S3 method for class 'BIFIE.lavaan.survey'
coef(object,...)

## S3 method for class 'BIFIE.lavaan.survey'
vcov(object,...)

BIFIE.survey(svyrepdes, survey.function, ...)

## S3 method for class 'BIFIE.survey'
summary(object, digits=3, ...)

## S3 method for class 'BIFIE.survey'
coef(object,...)

## S3 method for class 'BIFIE.survey'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lavmodel</code></td>
<td>

<p>Model string in <span class="pkg">lavaan</span> syntax
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svyrepdes</code></td>
<td>

<p>Replication design object of class <code>BIFIEdata</code> or replication design
object from <span class="pkg">survey</span> package (generated by <code>BIFIEdata2svrepdesign</code> or
<code>survey::svrepdesign</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lavaan_fun</code></td>
<td>
<p>Estimation funcion in <span class="pkg">lavaan</span>. Can be <code>"lavaan"</code>,
<code>"sem"</code>, <code>"cfa"</code> or <code>"growth"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lavaan_survey_default</code></td>
<td>
<p>Logical indicating whether the <b>lavaan.survey</b>
package should be used for statistical inference for multiply imputed datasets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>BIFIE.by</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.measures</code></td>
<td>
<p>Optional vector of fit measures used in
<code>lavaan::fitMeasures</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survey.function</code></td>
<td>
<p>Function from the <span class="pkg">survey</span> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits after decimal</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>BIFIE.lavaan.survey</code> a list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lavfit</code></td>
<td>
<p>Object of class <code>lavaan</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitstat</code></td>
<td>
<p>Fit statistics from <span class="pkg">lavaan</span></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>lavaan::lavaan</code>,
<code>lavaan.survey::lavaan.survey</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Multiply imputed datasets, TIMSS replication design
#############################################################################

library(lavaan)
data(data.timss2)
data(data.timssrep)

#--- create BIFIEdata object
bdat4 &lt;- BIFIEsurvey::BIFIE.data( data=data.timss2, wgt="TOTWGT",
                wgtrep=data.timssrep[,-1], fayfac=1)
print(bdat4)

#--- create survey object with conversion function
svydes4 &lt;- BIFIEsurvey::BIFIEdata2svrepdesign(bdat4)

#*** regression model
mod1 &lt;- BIFIEsurvey::BIFIE.linreg(bdat4, formula=ASMMAT ~ ASSSCI )
mod2 &lt;- mitools::MIcombine( with(svydes4, survey::svyglm( formula=ASMMAT ~ ASSSCI,
                       design=svydes4 )))
#--- regression with lavaan.survey package
lavmodel &lt;- "ASMMAT ~ 1
             ASMMAT ~ ASSSCI"
mod3 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=svydes4)
# inference included in lavaan.survey package
mod4 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=svydes4,
                        lavaan_survey_default=TRUE)
summary(mod3)
# extract fit statistics
lavaan::fitMeasures(mod3$lavfit)

#--- use BIFIE.lavaan.survey function with BIFIEdata object
mod5 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=bdat4)
summary(mod5)

# compare estimated parameters
coef(mod1); coef(mod2); coef(mod3); coef(mod4); coef(mod5)

# compare standard error estimates
se(mod1); BIFIEsurvey::se(mod2); BIFIEsurvey::se(mod3); BIFIEsurvey::se(mod4); BIFIEsurvey::se(mod5)

#############################################################################
# EXAMPLE 2: Examples BIFIE.survey function
#############################################################################

data(data.timss2)
data(data.timssrep)

#--- create BIFIEdata object
bdat &lt;- BIFIEsurvey::BIFIE.data( data=data.timss2, wgt="TOTWGT",
              wgtrep=data.timssrep[,-1], fayfac=1)
print(bdat)

#--- survey object
sdat &lt;- BIFIEsurvey::BIFIEdata2svrepdesign(bdat)
print(sdat)

#- fit models in survey
mod1 &lt;- BIFIEsurvey::BIFIE.linreg(bdat, formula=ASMMAT~ASSSCI)
mod2 &lt;- BIFIEsurvey::BIFIE.survey( sdat, survey.function=survey::svyglm,
                                    formula=ASMMAT~ASSSCI)
mod3 &lt;- BIFIEsurvey::BIFIE.survey( bdat, survey.function=survey::svyglm,
                                     formula=ASMMAT~ASSSCI)
summary(mod1)
summary(mod2)
summary(mod3)

#############################################################################
# EXAMPLE 3: Nested multiply imputed datasets | linear regression
#############################################################################

library(lavaan)
data(data.timss4)
data(data.timssrep)

# nested imputed dataset
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss4,
            wgt=data.timss4[[1]][[1]]$TOTWGT, wgtrep=data.timssrep[, -1 ],  NMI=TRUE )
summary(bdat)

#*** BIFIEsurvey::BIFIE.linreg
mod1 &lt;- BIFIEsurvey::BIFIE.linreg(bdat, formula=ASMMAT ~ migrant )

#*** survey::svyglm
mod2 &lt;- BIFIEsurvey::BIFIE.survey(bdat, survey.function=survey::svyglm,
                                    formula=ASMMAT~migrant)

#*** lavaan.survey::lavaan.survey
lavmodel &lt;- "ASMMAT ~ 1
             ASMMAT ~ migrant"
mod3 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=bdat)

coef(mod1); coef(mod2); coef(mod3)
se(mod1); BIFIEsurvey::se(mod2), BIFIEsurvey::se(mod3)

## End(Not run)
</code></pre>


</div>