<div class="container">

<table style="width: 100%;"><tr>
<td>beta_kr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the K.R Model</h2>

<h3>Description</h3>

<p>A beta mixture model for identifying differentially methylated CpG sites between <code class="reqn">R</code> DNA sample types collected from <code class="reqn">N</code> patients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta_kr(data, M = 3, N, R, parallel_process = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe of dimension <code class="reqn">C \times NR</code> containing methylation values for <code class="reqn">C</code> CpG sites from <code class="reqn">R</code> sample types collected from <code class="reqn">N</code> patients.
Samples are grouped together in the dataframe such that the columns are ordered as Sample1_Patient1, Sample1_Patient2, Sample2_Patient1, Sample2_Patient2, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of methylation states to be identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of patients in the study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Number of sample types collected from each patient for study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel_process</code></td>
<td>
<p>The "TRUE" option results in parallel processing of the models for increased computational efficiency. The default option has been set as "FALSE" due to package testing limitations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed to allow for reproducibility (default = NULL).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The K.R model allows identification of the differentially methylated CpG sites between the <code class="reqn">R</code> DNA sample types collected from each of <code class="reqn">N</code> patients.
As each CpG site in a DNA sample can belong to one of <code class="reqn">M</code> methylation states, there can be <code class="reqn">K=M^R</code> methylation state changes between <code class="reqn">R</code> DNA sample types.
The shape parameters vary for each DNA sample type but are constrained to be equal for each patient. An initial clustering using k-means is performed to identify <code class="reqn">K</code> clusters. The resulting clustering solution is provided as
starting values to the Expectation-Maximisation algorithm. A digamma approximation is used to obtain the maximised
parameters in the M-step.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li>
<p> cluster_size - The total number of CpG sites in each of the K clusters.
</p>
</li>
<li>
<p> llk - A vector containing the log-likelihood value at each step of the EM algorithm.
</p>
</li>
<li>
<p> alpha - The first shape parameter for the beta mixture model.
</p>
</li>
<li>
<p> delta - The second shape parameter for the beta mixture model.
</p>
</li>
<li>
<p> tau - The estimated mixing proportion for each cluster.
</p>
</li>
<li>
<p> z - A matrix of dimension <code class="reqn">C \times K</code> containing the posterior probability of each CpG site belonging to each of the <code class="reqn">K</code> clusters.
</p>
</li>
<li>
<p> classification - The classification corresponding to z, i.e. map(z).
</p>
</li>
<li>
<p> uncertainty - The uncertainty of each CpG site's clustering.
</p>
</li>
<li>
<p> DM - The AUC and WD metric for distribution similarity in each cluster. </p>
</li>
</ul>
<h3>See Also</h3>

<p><code>betaclust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">my.seed &lt;- 190
M &lt;- 3
N &lt;- 4
R &lt;- 2
data_output = beta_kr(pca.methylation.data[1:30,2:9], M, N, R,
                      parallel_process = FALSE, seed = my.seed)
</code></pre>


</div>