<div class="container">

<table style="width: 100%;"><tr>
<td>com</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Center of Mass </h2>

<h3>Description</h3>

<p>Calculate the center of mass of a PDB object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">com(...)

## S3 method for class 'pdb'
com(pdb, inds=NULL, use.mass=TRUE, ...)

## S3 method for class 'xyz'
com(xyz, mass=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> an object of class <code>pdb</code> as obtained from
function <code>read.pdb</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds</code></td>
<td>
<p> atom and xyz coordinate indices obtained from <code>atom.select</code>
that selects the elements of <code>pdb</code> upon which the calculation
should be based.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.mass</code></td>
<td>
<p> logical, if TRUE the calculation will be mass
weighted (center of mass). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments to <code>atom2mass</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyz</code></td>
<td>
<p> a numeric vector or matrix of Cartesian coordinates
(e.g. an object of type <code>xyz</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass</code></td>
<td>
<p> a numeric vector containing the masses of each atom in
<code>xyz</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the center of mass of the provided PDB
structure / Cartesian coordiantes. Atom names found in standard amino
acids in the PDB are mapped to atom elements and their corresponding
relative atomic masses.  
</p>
<p>In the case of an unknown atom name <code>elety.custom</code> and
<code>mass.custom</code> can be used to map an atom to the correct
atomic mass. See examples for more details.
</p>
<p>Alternatively, the atom name will be mapped automatically to the
element corresponding to the first character of the atom name. Atom
names starting with character <code>H</code> will be mapped to hydrogen
atoms.
</p>


<h3>Value</h3>

<p>Returns the Cartesian coordinates at the center of mass.
</p>


<h3>Author(s)</h3>

<p> Lars Skjaerven </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695â€“2696.
</p>


<h3>See Also</h3>

<p><code>read.pdb</code>, <code>atom2mass</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# PDB server connection required - testing excluded

## Stucture of PKA:
pdb &lt;- read.pdb("3dnd")

## Center of mass:
com(pdb)

## Center of mass of a selection
inds &lt;- atom.select(pdb, chain="I")
com(pdb, inds)

## using XYZ Cartesian coordinates
xyz &lt;- pdb$xyz[, inds$xyz]
com.xyz(xyz)

## with mass weighting
com.xyz(xyz, mass=atom2mass(pdb$atom[inds$atom, "elety"]) )



## Not run: 
## Unknown atom names
pdb &lt;- read.pdb("3dnd")
inds &lt;- atom.select(pdb, resid="LL2")
mycom &lt;- com(pdb, inds, rescue=TRUE)
#warnings()


## Map atom names manually
pdb &lt;- read.pdb("3RE0")
inds &lt;- atom.select(pdb, resno=201)

myelety  &lt;- data.frame(name = c("CL2","PT1","N1","N2"), symb = c("Cl","Pt","N","N"))
mymasses &lt;- data.frame(symb = c("Cl","Pt"), mass = c(35.45, 195.08))
mycom    &lt;- com(pdb, inds, elety.custom=myelety, mass.custom=mymasses)

## End(Not run)
</code></pre>


</div>