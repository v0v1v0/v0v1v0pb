<div class="container">

<table style="width: 100%;"><tr>
<td>final_node_monitor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Final node monitors</h2>

<h3>Description</h3>

<p>Marginal and conditional node monitors over the last observation of the data for all vertices of a Bayesian network using the full dataset
</p>


<h3>Usage</h3>

<pre><code class="language-R">final_node_monitor(dag, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dag</code></td>
<td>
<p>an object of class <code>bn</code> from the <code>bnlearn</code> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a base R style dataframe</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider a Bayesian network over variables <code class="reqn">Y_1,\dots,Y_m</code> and suppose a dataset <code class="reqn">(\boldsymbol{y}_1,\dots,\boldsymbol{y}_n)</code> has been observed, where <code class="reqn">\boldsymbol{y}_i=(y_{i1},\dots,y_{im})</code> and <code class="reqn">y_{ij}</code> is the i-th observation of the j-th variable.
Let <code class="reqn">p_n</code> denote the marginal density of <code class="reqn">Y_j</code> after the first <code class="reqn">n-1</code> observations have been processed. Define
</p>
<p style="text-align: center;"><code class="reqn">E_n = \sum_{k=1}^Kp_n(d_k)\log(p_n(d_k)),</code>
</p>

<p style="text-align: center;"><code class="reqn">V_n = \sum_{k=1}^K p_n(d_k)\log^2(p_n(d_k))-E_n^2,</code>
</p>

<p>where <code class="reqn">(d_1,\dots,d_K)</code> are the possible values of <code class="reqn">Y_j</code>. The marginal node monitor for the vertex <code class="reqn">Y_j</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">Z_j=\frac{-\log(p_n(y_{ij}))- E_n}{\sqrt{V_n}}.</code>
</p>

<p>Higher values of <code class="reqn">Z_j</code> can give an indication of a poor model fit for the vertex <code class="reqn">Y_j</code>.
</p>
<p>The conditional node monitor for the vertex <code class="reqn">Y_j</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">Z_j=\frac{-\log(p_n(y_{nj}|y_{n1},\dots,y_{n(j-1)},y_{n(j+1)},\dots,y_{nm}))- E_n}{\sqrt{V_n}},</code>
</p>

<p>where <code class="reqn">E_n</code> and <code class="reqn">V_n</code> are computed with respect to <code class="reqn">p_n(y_{nj}|y_{n1},\dots,y_{n(j-1)},y_{n(j+1)},\dots,y_{nm})</code>. Again, higher values of <code class="reqn">Z_j</code> can give an indication of a poor model fit for the vertex <code class="reqn">Y_j</code>.
</p>


<h3>Value</h3>

<p>A dataframe including the names of the vertices, the marginal node monitors and the conditional node monitors. It also return two plots where vertices with a darker color have a higher marginal z-score or conditional z-score, respectively, in absolute value.
</p>


<h3>References</h3>

<p>Cowell, R. G., Dawid, P., Lauritzen, S. L., &amp; Spiegelhalter, D. J. (2006). Probabilistic networks and expert systems: Exact computational methods for Bayesian networks. Springer Science &amp; Business Media.
</p>
<p>Cowell, R. G., Verrall, R. J., &amp; Yoon, Y. K. (2007). Modeling operational risk with Bayesian networks. Journal of Risk and Insurance, 74(4), 795-827.
</p>


<h3>See Also</h3>

<p><code>influential_obs</code>, <code>node_monitor</code>, <code>seq_node_monitor</code>, <code>seq_pa_ch_monitor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">final_node_monitor(chds_bn, chds[1:100,])
</code></pre>


</div>