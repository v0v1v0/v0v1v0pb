<div class="container">

<table style="width: 100%;"><tr>
<td>zi_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>He's (2019) test for zero-modification</h2>

<h3>Description</h3>

<p>This is an implementation of He et al. (2019)'s test for
zero-modification (discussed further in Tang &amp; Tang (2019)). This is a test of
zero-<em>modification</em> instead of <em>inflation</em>, because the test is capable of detecting
both excessive or lack of zeros, but cannot determine the cause. For example, a mixed
data generating process could be generating structural zeros, implying a
zero-inflated distribution. However, overdispersion via a negative binomial
may also result in excessive zeros. Thus, the test merely determines whether
there are excessive (or lacking) zeros, but does not determine the process
generating this pattern. That in mind, typical tests in the literature are
inappropriate for zero-modified regression models, namely the Vuong, Wald,
score, and likelihood ratio tests. See the references below for more information
on this claim.
</p>


<h3>Usage</h3>

<pre><code class="language-R">zi_test(model, alternative = "inflated")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A model object of class <code>bizicount</code> or <code>glm</code>.
If a <code>bizicount</code> model, then at least one margin must be specified as <code>"pois"</code>.
If a <code>glm</code> model, then the <code>family</code> must be <code>poisson</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>The alternative hypothesis. One of <code>c("inflated", "deflated", "both")</code>.
These correspond to an upper tail, lower tail, or two-tailed test, respectively.
Default is <code>"inflated"</code>. Partial matching supported.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test compares the
observed proportion of zeros in the data to the expected proportion of zeros
under the null hypothesis of a Poisson distribution. This is done using
estimating equations to account for the fact that the expected proportion is
based on an estimated parameter vector, rather than the true parameter vector.
The test statistic is
</p>
<p><code class="reqn">\hat s = 1/n\sum_i (r_i - \hat p_i)</code>
</p>
<p>where <code class="reqn">r_i = 1</code> if <code class="reqn">y_i = 0</code>, otherwise <code class="reqn">r_i = 0</code>, and <code class="reqn">\hat p = dpois(0, exp(X\hat\beta)) = \hat E(r_i)</code>
is the estimated proportion of zeros under the assumption of a Poisson distribution
generated with covariates <code class="reqn">X</code> and parameter vector <code class="reqn">\hat\beta</code>.
</p>
<p>By the central limit theorem, <code class="reqn">\hat s \sim AN(0, \sigma^2_s)</code>. However,
estimating <code class="reqn">\hat \sigma_s</code> by a plug-in estimate using <code class="reqn">\hat\beta</code> is inefficient
due to <code class="reqn">\hat \beta</code> being an random variable with its own variance. Thus,
<code class="reqn">\hat\sigma</code> is estimated via estimating equations in order to account for the
variance in <code class="reqn">\hat \beta</code>.
</p>
<p>See the references below for more discussion and proofs.
</p>


<h3>Author(s)</h3>

<p>John Niehaus
</p>


<h3>References</h3>

<p>He, H., Zhang, H., Ye, P., &amp; Tang, W. (2019). A test of inflated
zeros for Poisson regression models. Statistical methods in medical research,
28(4), 1157-1169.
</p>
<p>Tang, Y., &amp; Tang, W. (2019). Testing modified zeros for Poisson regression
models. Statistical Methods in Medical Research, 28(10-11), 3123-3141.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
n = 500
u = rpois(n, 3)
y1 = rzip(n, 12, .2) + u
y2 = rpois(n, 8) + u

# Single parameter test, covariates can be added though.
uni1 = glm(y1 ~ 1, family = poisson())
uni2 = glm(y2 ~ 1, family = poisson())

biv = bizicount(y1~1, y2~1, margins = c("pois", "pois"), keep = TRUE)

zi_test(uni1)
zi_test(uni2)

zi_test(biv)
</code></pre>


</div>