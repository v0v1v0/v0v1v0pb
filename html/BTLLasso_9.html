<div class="container">

<table style="width: 100%;"><tr>
<td>ctrl.BTLLasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Control function for BTLLasso</h2>

<h3>Description</h3>

<p>Control parameters for different penalty terms and for tuning the fitting algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ctrl.BTLLasso(
  l.lambda = 30,
  log.lambda = TRUE,
  lambda.min = 0.05,
  adaptive = TRUE,
  scale = TRUE,
  norm = c("L1", "L2"),
  epsilon = 1e-04,
  lambda2 = 1e-04,
  c = 1e-09,
  precision = 3,
  weight.penalties = TRUE,
  include.intercepts = TRUE,
  order.effect = FALSE,
  object.order.effect = FALSE,
  order.center = FALSE,
  name.order = "Order",
  penalize.intercepts = FALSE,
  penalize.X = TRUE,
  penalize.Z2 = FALSE,
  penalize.Z1.absolute = TRUE,
  penalize.Z1.diffs = TRUE,
  penalize.order.effect.absolute = TRUE,
  penalize.order.effect.diffs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l.lambda</code></td>
<td>
<p>Number of tuning parameters. Applies only if <code>lambda = NULL</code> in the 
main function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.lambda</code></td>
<td>
<p>Should the grid of tuning parameters be created on a logarithmic scale 
rather than equidistant. Applies only if <code>lambda = NULL</code> in the main function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.min</code></td>
<td>
<p>Minimal value for tuning parameter. Applies only if <code>lambda = NULL</code> in the 
main function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>Should adaptive lasso be used? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Should the covariates be scaled so that they are on comparable scales? Default is TRUE.
Variables will be properly scaled AND centered. Please note that results will refer to scaled covariates.
If <code>adaptive = TRUE</code> scaling is not necessary to keep penalties comparable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>Specifies the norm used in the penalty term. Currently, only
'L1' and 'L2' are possible. Default is to 'L1', only 'L1' allows for
clustering and variable selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Threshold value for convergence of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>Tuning parameter for ridge penalty on all coefficients.
Should be small, only used to stabilize results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Internal parameter for the quadratic approximation of the L1
penalty. Should be sufficiently small.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>Precision for final parameter estimates, specifies number of decimals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight.penalties</code></td>
<td>
<p>Should the penalties across the different model components 
(i.e. intercepts, order effects, X, Z1, Z2) be weighted according to the number of
penalties included? Default is <code>TRUE</code> to minimize the risk of selection bias
across different model components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.intercepts</code></td>
<td>
<p>Should intercepts be included in the model?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.effect</code></td>
<td>
<p>Should a global order effect (corresponding to home effect
in sports applications) be included in the model?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object.order.effect</code></td>
<td>
<p>Should object-specific order effects (corresponding to home effects
in sports applications) be included in the model?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.center</code></td>
<td>
<p>Should (in case of object-specific order effects) the order effects be centered
in the design matrix? Centering is equivalent to the coding scheme of effect coding instead of 
dummy coding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.order</code></td>
<td>
<p>How should the order effect(s) be called in plots or prints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.intercepts</code></td>
<td>
<p>Should intercepts be penalized? If <code>TRUE</code>,
all pairwise differences between intercepts are penalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.X</code></td>
<td>
<p>Should effects from X matrix be penalized? If <code>TRUE</code>,
all pairwise differences corresponding to one covariate are penalized. Can also be used with
a character vector as input. Then, the character vector contains the names of the variables
from X whose parameters should be penalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.Z2</code></td>
<td>
<p>Should absolute values of effects from Z2 matrix be
penalized? Can also be used with
a character vector as input. Then, the character vector contains the names of the variables
from Z2 whose parameters should be penalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.Z1.absolute</code></td>
<td>
<p>Should absolute values of effects from Z1 matrix
be penalized? Can also be used with
a character vector as input. Then, the character vector contains the names of the variables
from Z1 whose parameters should be penalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.Z1.diffs</code></td>
<td>
<p>Should differences of effects from Z1 matrix be
penalized? If <code>TRUE</code>, all pairwise differences corresponding to one
covariate are penalized. Can also be used with
a character vector as input. Then, the character vector contains the names of the variables
from Z1 whose parameters should be penalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.order.effect.absolute</code></td>
<td>
<p>Should absolute values of order effect(s) be penalized?
Only relevant if either <code>object.order.effect = TRUE</code> or <code>order.effect = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize.order.effect.diffs</code></td>
<td>
<p>Should differences of order effects be
penalized? If <code>TRUE</code>, all pairwise differences are penalized. Only relevant if 
<code>object.order.effect = TRUE</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gunther Schauberger<br><a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Tutz, Gerhard (2019): BTLLasso - A Common Framework and Software 
Package for the Inclusion  and Selection of Covariates in Bradley-Terry Models, <em>Journal of 
Statistical Software</em>, 88(9), 1-29, <a href="https://doi.org/10.18637/jss.v088.i09">doi:10.18637/jss.v088.i09</a>
</p>
<p>Schauberger, Gunther and Tutz, Gerhard (2017): Subject-specific modelling 
of paired comparison data: A lasso-type penalty approach, <em>Statistical Modelling</em>,
17(3), 223 - 243
</p>
<p>Schauberger, Gunther, Groll Andreas and Tutz, Gerhard (2018): 
Analysis of the importance of on-field covariates in the German Bundesliga, 
<em>Journal of Applied Statistics</em>, 45(9), 1561 - 1578
</p>


<h3>See Also</h3>

<p><code>BTLLasso</code>, <code>cv.BTLLasso</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
op &lt;- par(no.readonly = TRUE)

##############################
##### Example with simulated data set containing X, Z1 and Z2
##############################
data(SimData)

## Specify control argument
## -&gt; allow for object-specific order effects and penalize intercepts
ctrl &lt;- ctrl.BTLLasso(penalize.intercepts = TRUE, object.order.effect = TRUE,
                      penalize.order.effect.diffs = TRUE)

## Simple BTLLasso model for tuning parameters lambda
m.sim &lt;- BTLLasso(Y = SimData$Y, X = SimData$X, Z1 = SimData$Z1,
                  Z2 = SimData$Z2, control = ctrl)
m.sim

par(xpd = TRUE)
plot(m.sim)


## Cross-validate BTLLasso model for tuning parameters lambda
set.seed(1860)
m.sim.cv &lt;- cv.BTLLasso(Y = SimData$Y, X = SimData$X, Z1 = SimData$Z1,
                        Z2 = SimData$Z2, control = ctrl)
m.sim.cv
coef(m.sim.cv)
logLik(m.sim.cv)

head(predict(m.sim.cv, type="response"))
head(predict(m.sim.cv, type="trait"))

plot(m.sim.cv, plots_per_page = 4)


## Example for bootstrap intervals for illustration only
## Don't calculate bootstrap intervals with B = 20!!!!
set.seed(1860)
m.sim.boot &lt;- boot.BTLLasso(m.sim.cv, B = 20, cores = 20)
m.sim.boot
plot(m.sim.boot, plots_per_page = 4)


##############################
##### Example with small version from GLES data set
##############################
data(GLESsmall)

## extract data and center covariates for better interpretability
Y &lt;- GLESsmall$Y
X &lt;- scale(GLESsmall$X, scale = FALSE)
Z1 &lt;- scale(GLESsmall$Z1, scale = FALSE)

## vector of subtitles, containing the coding of the X covariates
subs.X &lt;- c('', 'female (1); male (0)')

## Cross-validate BTLLasso model
m.gles.cv &lt;- cv.BTLLasso(Y = Y, X = X, Z1 = Z1)
m.gles.cv

coef(m.gles.cv)
logLik(m.gles.cv)

head(predict(m.gles.cv, type="response"))
head(predict(m.gles.cv, type="trait"))

par(xpd = TRUE, mar = c(5,4,4,6))
plot(m.gles.cv, subs.X = subs.X, plots_per_page = 4, which = 2:5)
paths(m.gles.cv, y.axis = 'L2')


##############################
##### Example with Bundesliga data set
##############################
data(Buli1516)

Y &lt;- Buli1516$Y5

Z1 &lt;- scale(Buli1516$Z1, scale = FALSE)

ctrl.buli &lt;- ctrl.BTLLasso(object.order.effect = TRUE, 
                           name.order = "Home", 
                           penalize.order.effect.diffs = TRUE, 
                           penalize.order.effect.absolute = FALSE,
                           order.center = TRUE, lambda2 = 1e-2)

set.seed(1860)
m.buli &lt;- cv.BTLLasso(Y = Y, Z1 = Z1, control = ctrl.buli)
m.buli

par(xpd = TRUE, mar = c(5,4,4,6))
plot(m.buli)


##############################
##### Example with Topmodel data set
##############################
data("Topmodel2007", package = "psychotree")

Y.models &lt;- response.BTLLasso(Topmodel2007$preference)
X.models &lt;- scale(model.matrix(preference~., data = Topmodel2007)[,-1])
rownames(X.models) &lt;- paste0("Subject",1:nrow(X.models))
colnames(X.models) &lt;- c("Gender","Age","KnowShow","WatchShow","WatchFinal")

set.seed(5)
m.models &lt;- cv.BTLLasso(Y = Y.models, X = X.models)
plot(m.models, plots_per_page = 6)

par(op)

## End(Not run)
</code></pre>


</div>