<div class="container">

<table style="width: 100%;"><tr>
<td>Inverse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the inverse of the cross product of a design matrix</h2>

<h3>Description</h3>

<p><code>inv</code> is a <code>S3</code> generic that calculates the inverse of the cross
product of a design matrix, also referred to as the “unscaled
covariance matrix”.
</p>
<p><code>pinv</code> calculates <code class="reqn">M^{+} = (M^T M)^{-1} M^T</code> for full (column) rank
matrices. However, it does not verify the matrix's rank.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inv(x, ...)

## S3 method for class 'matrix'
inv(x, y = NULL, transpose = FALSE, ...)

## S3 method for class 'array'
inv(x, y = NULL, transpose = FALSE, ...)

## S3 method for class 'qr'
inv(x, p = x$rank, ...)

## S3 method for class 'list'
inv(x, p = x[[1L]]$rank, r = length(x),
  vnames = dimnames(x[[1L]]$qr)[[2L]], nms = names(x), ...)

pinv(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric matrix or array, a <code>qr</code> object, or a list of
<code>qr</code> objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric matrix or vector (for the <code>matrix</code> and <code>array</code>
methods). If supplied, this will be multiplied by <code>x</code> before the
inverse is calculated. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transpose</code></td>
<td>
<p>Logical. If <code>FALSE</code> (the default), take the cross
product of the arguments. If <code>TRUE</code>, use <code>tcrossprod</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The rank of the original matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The number of design matrices; i.e., the length of the input list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vnames</code></td>
<td>
<p>Character vector of the design matrix's variable names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nms</code></td>
<td>
<p>The region names; i.e., the names of the input list</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> is a matrix, the Cholesky decomposition of the cross product is
calculated (or using <code>tcrossprod</code> if <code>transpose=TRUE</code>), and
the inverse is calculated from that result. That is,
</p>
<p style="text-align: center;"><code class="reqn">inv(X) = (X^T X)^{-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">inv(X, transpose=TRUE) = (X X^T)^{-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">inv(X, y) = (X^T y)^{-1}</code>
</p>

<p>If <code>x</code> is a 3-dimensional array, then the inverse will be calculated for
each matrix along the 3rd dimension, with the same input arguments for each.
</p>
<p>Finally, there is a method for objects with class <code>qr</code>, and lists of QR
decomposition objects.
</p>


<h3>Value</h3>

<p>A numeric matrix or array
</p>
<p><code>pinv</code> returns the input matrix's pseudoinverse
</p>


<h3>Note</h3>

<p>These methods should only be used on <em>full-rank</em> matrices, as
there is no error checking being performed.
</p>


</div>