<div class="container">

<table style="width: 100%;"><tr>
<td>rsurGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs Sampler for Seemingly Unrelated Regressions (SUR)</h2>

<h3>Description</h3>

<p><code>rsurGibbs</code> implements a Gibbs Sampler to draw from the posterior of the Seemingly Unrelated Regression (SUR) Model of Zellner.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rsurGibbs(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(regdata)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(betabar, A, nu, V)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">y_i = X_i\beta_i + e_i</code> with  <code class="reqn">i=1,\ldots,m</code> for <code class="reqn">m</code> regressions <br>
(<code class="reqn">e(k,1), \ldots, e(k,m)</code>)' <code class="reqn">\sim</code> <code class="reqn">N(0, \Sigma)</code> with <code class="reqn">k=1, \ldots, n</code> 
</p>
<p>Can be written as a stacked model: <br><code class="reqn">y = X\beta + e</code> where <code class="reqn">y</code> is a <code class="reqn">nobs*m</code> vector and <code class="reqn">p</code> = <code>length(beta)</code> = <code>sum(length(beta_i))</code>
</p>
<p>Note: must have the same number of observations (<code class="reqn">n</code>) in each equation but can have a different number of <code class="reqn">X</code> variables (<code class="reqn">p_i</code>) for each equation where <code class="reqn">p = \sum p_i</code>.
</p>
<p><code class="reqn">\beta</code> <code class="reqn">\sim</code> <code class="reqn">N(betabar, A^{-1})</code> <br><code class="reqn">\Sigma</code> <code class="reqn">\sim</code> <code class="reqn">IW(nu,V)</code>
</p>



<h4>Argument Details</h4>

<p><em><code>Data = list(regdata)</code></em>
</p>

<table><tr>
<td style="text-align: left;">
      <code>regdata: </code> </td>
<td style="text-align: left;"> list of lists, <code>regdata[[i]] = list(y=y_i, X=X_i)</code>, where <code>y_i</code> is <code class="reqn">n x 1</code> and <code>X_i</code> is <code class="reqn">n x p_i</code>
    </td>
</tr></table>
<p><em><code>Prior = list(betabar, A, nu, V)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
      <code>betabar: </code> </td>
<td style="text-align: left;"> <code class="reqn">p x 1</code> prior mean (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>A:       </code> </td>
<td style="text-align: left;"> <code class="reqn">p x p</code> prior precision matrix (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>nu:      </code> </td>
<td style="text-align: left;"> d.f. parameter for Inverted Wishart prior (def: m+3) </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>V:       </code> </td>
<td style="text-align: left;"> <code class="reqn">m x m</code> scale parameter for Inverted Wishart prior (def: nu*I)
    </td>
</tr>
</table>
<p><em><code>Mcmc = list(R, keep)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
      <code>R:       </code>
</td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>keep:    </code>
</td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
      <code>nprint:  </code>
</td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print)
  </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betadraw </code></td>
<td>
 <p><code class="reqn">R x p</code> matrix of betadraws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigmadraw </code></td>
<td>
 <p><code class="reqn">R x (m*m)</code> array of Sigma draws</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p>For further discussion, see Chapter 3, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>See Also</h3>

 <p><code>rmultireg</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=1000} else {R=10}
set.seed(66)

## simulate data from SUR
beta1 = c(1,2)
beta2 = c(1,-1,-2)
nobs = 100
nreg = 2
iota = c(rep(1, nobs))
X1 = cbind(iota, runif(nobs))
X2 = cbind(iota, runif(nobs), runif(nobs))
Sigma = matrix(c(0.5, 0.2, 0.2, 0.5), ncol=2)
U = chol(Sigma)
E = matrix(rnorm(2*nobs),ncol=2)%*%U
y1 = X1%*%beta1 + E[,1]
y2 = X2%*%beta2 + E[,2]

## run Gibbs Sampler
regdata = NULL
regdata[[1]] = list(y=y1, X=X1)
regdata[[2]] = list(y=y2, X=X2)

out = rsurGibbs(Data=list(regdata=regdata), Mcmc=list(R=R))

cat("Summary of beta draws", fill=TRUE)
summary(out$betadraw, tvalues=c(beta1,beta2))

cat("Summary of Sigmadraws", fill=TRUE)
summary(out$Sigmadraw, tvalues=as.vector(Sigma[upper.tri(Sigma,diag=TRUE)]))

## plotting examples
if(0){plot(out$betadraw, tvalues=c(beta1,beta2))}
</code></pre>


</div>