<div class="container">

<table style="width: 100%;"><tr>
<td>HyperSelect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hyperparameter selection for iMOM prior density</h2>

<h3>Description</h3>

<p>This function finds data specific hyperparameters for inverse
moment prior density so that the overlap between the iMOM prior and null
MLE density is <code class="reqn">1/\sqrt p</code>. In this algorithm <code>r</code> is always chosen
to be equal to 1 and <code>tau</code> is found based on the mentioned overlap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HyperSelect(
  X,
  resp,
  eff_size = 0.7,
  nlptype = "piMOM",
  iter = 10000,
  mod_prior = c("unif", "beta"),
  family = c("logistic", "survival")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design matrix. <code>NA</code>'s should be removed and columns be
scaled. It is recommended that the <code>PreProcess</code> function is run first
and its output used for this argument. The columns are genes and rows
represent the observations. The column names are used as gene names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>For logistic regression models, it is the binary response
vector. For Cox proportional hazard model, this is a two column matrix
where the first column contains survival time vector and the second column
is the censoring status for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff_size</code></td>
<td>
<p>This is the expected effect size in the model for a
standardized design matrix, which is basically the coefficient value that is
expected to occur the most based on some prior knowledge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlptype</code></td>
<td>
<p>Determines the type of nonlocal prior that is used in the
analyses. It can be "piMOM" for product inverse moment prior, or "pMOM" for
product moment prior. The default is set to piMOM prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iteration needed to simulate from null model in
order to approximate the null MLE density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod_prior</code></td>
<td>
<p>Type of prior used for model space. <code>uniform</code> is for
uniform binomial and <code>beta</code> is for beta binomial prior. In the former
case, both hyper parameters in the beta prior are equal to <code>1</code> but in
the latter case those two hyper parameters are chosen as explained in the
reference papers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Determines the type of data analysis. <code>logistic</code> is for
binary outcome data where logistic regression modeling is used whereas
<code>survival</code> is for survival outcome data using Cox proportional
hazard model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns a list having following object:
</p>
<table><tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The hyperparameter for iMOM prior density function, calculated
using the proposed algorithm for the given dataset.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Amir Nikooienejad
</p>


<h3>References</h3>

<p>Nikooienejad, A., Wang, W., and Johnson, V. E. (2016). Bayesian
variable selection for binary outcomes in high dimensional genomic studies
using nonlocal priors. Bioinformatics, 32(9), 1338-1345.<br><br>
Johnson, V. E., and Rossell, D. (2010). On the use of nonlocal prior
densities in Bayesian hypothesis tests. Journal of the Royal Statistical
Society: Series B (Statistical Methodology), 72(2), 143-170.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Simulating Logistic Regression Data
n &lt;- 20
p &lt;- 100
set.seed(321)
Sigma &lt;- diag(p)
full &lt;- matrix(c(rep(0.5, p * p)), ncol = p)
Sigma &lt;- full + 0.5 * Sigma
cholS &lt;- chol(Sigma)
Beta &lt;- c(1, 1.8, 2.5)
X = matrix(rnorm(n*p, 1, 2), ncol = p)
X = X%*%cholS
beta &lt;- numeric(p)
beta[c(1:length(Beta))] &lt;- Beta
XB &lt;- X%*%beta
probs &lt;- as.vector(exp(XB)/(1+exp(XB)))
y &lt;- rbinom(n,1,probs)
colnames(X) &lt;- paste("gene_",c(1:p),sep="")
Xout &lt;- PreProcess(X)
XX &lt;- Xout$X
hparam &lt;- HyperSelect(XX, y, iter = 1000, mod_prior = "beta",
                      family = "logistic")

hparam$tau
</code></pre>


</div>