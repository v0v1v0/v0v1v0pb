<div class="container">

<table style="width: 100%;"><tr>
<td>bd.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ball Divergence based Equality of Distributions Test</h2>

<h3>Description</h3>

<p>Performs the nonparametric two-sample or <code class="reqn">K</code>-sample Ball Divergence test for
equality of multivariate distributions
</p>


<h3>Usage</h3>

<pre><code class="language-R">bd.test(x, ...)

## Default S3 method:
bd.test(
  x,
  y = NULL,
  num.permutations = 99,
  method = c("permutation", "limit"),
  distance = FALSE,
  size = NULL,
  seed = 1,
  num.threads = 0,
  kbd.type = c("sum", "maxsum", "max"),
  weight = c("constant", "variance"),
  ...
)

## S3 method for class 'formula'
bd.test(formula, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix, data.frame, or a list containing at least two numeric vectors, matrices, or data.frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector, matrix, data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.permutations</code></td>
<td>
<p>the number of permutation replications. When <code>num.permutations = 0</code>, the function just returns
the Ball Divergence statistic. Default: <code>num.permutations = 99</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>if <code>method = "permutation"</code>, a permutation procedure is carried out to compute the <code class="reqn">p</code>-value;
if <code> method = "limit"</code>, an approximate null distribution is used when <code>weight = "constant"</code>.
Any unambiguous substring can be given. Default <code>method = "permutation"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>if <code>distance = TRUE</code>, the elements of <code>x</code> will be considered as a distance matrix. Default: <code>distance = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector recording sample size of each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed. Default <code>seed = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.threads</code></td>
<td>
<p>number of threads. If <code>num.threads = 0</code>, then all of available cores will be used. Default <code>num.threads = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kbd.type</code></td>
<td>
<p>a character string specifying the <code class="reqn">K</code>-sample Ball Divergence test statistic, 
must be one of <code>"sum"</code>, <code>"summax"</code>, or <code>"max"</code>. Any unambiguous substring can be given. 
Default <code>kbd.type = "sum"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a character string specifying the weight form of Ball Divergence statistic.
It must be one of <code>"constant"</code> or <code>"variance"</code>. 
Any unambiguous substring can be given. Default: <code>weight = "constant"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where <code>response</code> gives the data values and <code>group</code> a vector or factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see <code>model.frame</code>) containing the variables in the formula <code>formula</code>. By default the variables are taken from <code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain <code>NA</code>s. Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bd.test</code> is nonparametric test for the two-sample or <code class="reqn">K</code>-sample problem. 
It can detect distribution difference between <code class="reqn">K(K \geq 2)</code> sample even though sample size are imbalanced.
This test can cope well multivariate dataset or complex dataset. 
</p>
<p>If only <code>x</code> is given, the statistic is 
computed from the original pooled samples, stacked in 
matrix where each row is a multivariate observation, or from the distance matrix 
when <code>distance = TRUE</code>. The first <code>sizes[1]</code> rows of <code>x</code> are the first sample, the next 
<code>sizes[2]</code> rows of <code>x</code> are the second sample, etc.
If <code>x</code> is a <code>list</code>, its elements are taken as the samples to be compared, 
and hence, this <code>list</code> must contain at least two numeric data vectors, matrices or data.frames.
</p>
<p><code>bd.test</code> utilizes the Ball Divergence statistics (see <code>bd</code>) to measure dispersion and 
derives a <code class="reqn">p</code>-value via replicating the random permutation <code>num.permutations</code> times. 
The function simply returns the test statistic 
when <code>num.permutations = 0</code>. 
</p>
<p>The time complexity of <code>bd.test</code> is around <code class="reqn">O(R \times n^2)</code>,
where <code class="reqn">R</code> = <code>num.permutations</code> and <code class="reqn">n</code> is sample size.
</p>


<h3>Value</h3>

<p>If <code>num.permutations &gt; 0</code>, <code>bd.test</code> returns a <code>htest</code> class object containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Ball Divergence statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the <code class="reqn">p</code>-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>permutation replications of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.info</code></td>
<td>
<p>a <code>list</code> mainly containing two vectors, the first vector is the Ball Divergence statistics 
with different aggregation strategy and weight, the second vector is the <code class="reqn">p</code>-values of tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>description of data.</p>
</td>
</tr>
</table>
<p>If <code>num.permutations = 0</code>, <code>bd.test</code> returns a statistic value.
</p>


<h3>Note</h3>

<p>Actually, <code>bd.test</code> simultaneously computing <code>"sum"</code>, <code>"summax"</code>, and <code>"max"</code> Ball Divergence statistics 
when <code class="reqn">K \geq 3</code>.
Users can get other Ball Divergence statistics and their corresponding <code class="reqn">p</code>-values 
in the <code>complete.info</code> element of output. We give a quick example below to illustrate.
</p>


<h3>Author(s)</h3>

<p>Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang, Jin Zhu
</p>


<h3>References</h3>

<p>Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. Ball Divergence: Nonparametric two sample test. Annals of Statistics. 46 (2018), no. 3, 1109â€“1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077
</p>
<p>Jin Zhu, Wenliang Pan, Wei Zheng, and Xueqin Wang (2021). Ball: An R Package for Detecting Distribution Difference and Association in Metric Spaces, Journal of Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.
</p>


<h3>See Also</h3>

<p><code>bd</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">################# Quick Start #################
set.seed(1)
x &lt;- rnorm(50)
y &lt;- rnorm(50, mean = 1)
# plot(density(x))
# lines(density(y), col = "red")
bd.test(x = x, y = y)

################# Quick Start #################
x &lt;- matrix(rnorm(100), nrow = 50, ncol = 2)
y &lt;- matrix(rnorm(100, mean = 3), nrow = 50, ncol = 2)
# Hypothesis test with Standard Ball Divergence:
bd.test(x = x, y = y)

################# Simlated Non-Hilbert data #################
data("bdvmf")
## Not run: 
library(scatterplot3d)
scatterplot3d(bdvmf[["x"]], color = bdvmf[["group"]], 
              xlab = "X1", ylab = "X2", zlab = "X3")

## End(Not run)
# calculate geodesic distance between sample:
Dmat &lt;- nhdist(bdvmf[["x"]], method = "geodesic")
# hypothesis test with BD :
bd.test(x = Dmat, size = c(150, 150), num.permutations = 99, distance = TRUE)

################# Non-Hilbert Real Data #################
# load data:
data("macaques")
# number of femala and male Macaca fascicularis:
table(macaques[["group"]])
# calculate Riemannian shape distance matrix:
Dmat &lt;- nhdist(macaques[["x"]], method = "riemann")
# hypothesis test with BD:
bd.test(x = Dmat, num.permutations = 99, size = c(9, 9), distance = TRUE)

################  K-sample Test  #################
n &lt;- 150
bd.test(rnorm(n), size = c(40, 50, 60))
# alternative input method:
x &lt;- lapply(c(40, 50, 60), rnorm)
res &lt;- bd.test(x)
res
## get all Ball Divergence statistics:
res[["complete.info"]][["statistic"]]
## get all test result:
res[["complete.info"]][["p.value"]]

################  Testing via approximate limit distribution  #################
## Not run: 
set.seed(1)
n &lt;- 1000
x &lt;- rnorm(n)
y &lt;- rnorm(n)
res &lt;- bd.test(x, y, method = "limit")
bd.test(x, y)

## End(Not run)

################  Formula interface  ################
## Two-sample test
bd.test(extra ~ group, data = sleep)
## K-sample test
bd.test(Sepal.Width ~ Species, data = iris)
bd.test(Sepal.Width ~ Species, data = iris, kbd.type = "max")
</code></pre>


</div>