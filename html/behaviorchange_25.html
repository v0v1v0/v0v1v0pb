<div class="container">

<table style="width: 100%;"><tr>
<td>determinant_selection_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Potential for Change Index and the Determinant Selection Table</h2>

<h3>Description</h3>

<p>These functions compute the Potential for Change Index for one or multiple
(sub-)determinants, the room for improvement (an intermediate estimate),
and produce a convenient table with an overview of all (sub-)determinants.
Note that for determinant selection purposes, quantitative estimates such
as the Potential for Change Index should never be used without also
thoroughly inspecting the visualisations of the univariate distributions
and the confidence intervals for the associations to the ultimate
intervention targets (usually the target behavior or a proxy measure). For
this purpose, the Confidence Interval-Based Estimation of Relevance plots
can be used (see <code>CIBER()</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">determinant_selection_table(
  data,
  determinants,
  target,
  determinantLabels = NULL,
  targetLabel = NULL,
  sortBy = NULL,
  sortByAbs = TRUE,
  decreasing = TRUE,
  digits = 3,
  increasesAreImprovements = TRUE,
  minimum = base::min,
  maximum = base::max,
  center = base::mean,
  weight = stats::cor,
  type = NULL,
  minimumArgs = list(na.rm = TRUE),
  maximumArgs = list(na.rm = TRUE),
  centerArgs = list(na.rm = TRUE),
  weightArgs = list(use = "complete.obs"),
  potentialScale = NULL,
  headingLevel = 3,
  output = behaviorchange::opts$get("tableOutput")
)

determinantSelectionTable_partial(
  x,
  digits = attr(x, "digits"),
  headingLevel = attr(x, "headingLevel"),
  echoPartial = FALSE,
  partialFile = NULL,
  quiet = TRUE,
  ...
)

## S3 method for class 'determinantSelectionTable'
knit_print(
  x,
  digits = attr(x, "digits"),
  headingLevel = attr(x, "headingLevel"),
  echoPartial = FALSE,
  partialFile = NULL,
  quiet = TRUE,
  ...
)

## S3 method for class 'determinantSelectionTable'
print(
  x,
  digits = attr(x, "digits"),
  headingLevel = attr(x, "headingLevel"),
  output = attr(x, "output"),
  forceKnitrOutput = FALSE,
  ...
)

potential_for_change_index(
  data,
  determinants,
  target,
  increasesAreImprovements = TRUE,
  sampleLevel = FALSE,
  minimum = base::min,
  maximum = base::max,
  center = base::mean,
  weight = stats::cor,
  type = NULL,
  minimumArgs = list(na.rm = TRUE),
  maximumArgs = list(na.rm = TRUE),
  centerArgs = list(na.rm = TRUE),
  weightArgs = list(use = "complete.obs")
)

room_for_improvement(
  x,
  increasesAreImprovements = TRUE,
  sampleLevel = FALSE,
  minimum = base::min,
  maximum = base::max,
  center = base::mean,
  minimumArgs = list(na.rm = TRUE),
  maximumArgs = list(na.rm = TRUE),
  centerArgs = list(na.rm = TRUE),
  varName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The dataframe containing the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>determinants</code></td>
<td>
<p>The name(s) of the determinant(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>The target (e.g. behavior or intention).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>determinantLabels, targetLabel</code></td>
<td>
<p>Optionally, labels to use for the
(sub-)determinants and the target. The <code>determinantLabels</code> must have the
same order as the <code>determinants</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortBy</code></td>
<td>
<p>The column to sort the results by; if not <code>NULL</code>, a number
from 1-6 that corresponds to the six columns of the Determinant Selection
Table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortByAbs</code></td>
<td>
<p>Whether to sort by raw values (<code>FALSE</code>) or their
absolute value (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>Whether to sort in decreasing (<code>TRUE</code>) or increasing
(<code>FALSE</code>) order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits to round to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>increasesAreImprovements</code></td>
<td>
<p>Whether increases are improvements (<code>TRUE</code>)
or decreases are improvements (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum, maximum</code></td>
<td>
<p>The minimum and maximum, as functions that take
a vector and return the minimum and maximum scores, as numbers, or as
vectors of numbers specifying the minimum and maximum to use for each
column in <code>x</code> or <code>determinants</code>, or a lists of functions specifying the functions to use
for each column in <code>x</code> or <code>determinants</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>For the sample-level version, a function that takes a
vector and returns the center (e.g. mean, median, etc), or a list of
functions specifying the function to use for each column in <code>x</code> or
<code>determinants</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>The function to return the weight/multiplier to use in the
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of potential for change index. Currently implemented
are type <code>'1'</code> and type <code>'2'</code> - see details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimumArgs, maximumArgs, centerArgs, weightArgs</code></td>
<td>
<p>lists with arguments
to pass to the corresponding functions. Note that these are not vectorized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>potentialScale</code></td>
<td>
<p>The scale with minimum and maximum possible values
for the Potential for Change index. If <code>NULL</code>, the minimum is set to <code>0</code>
and the maximum is set to the highest observed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>headingLevel</code></td>
<td>
<p>The number of hashes to print in front of the headings
when printing while knitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Whether to only output to the viewer (if possible;
<code>output='viewer'</code>), or only to the console (<code>output='console'</code>), or to
both (<code>output=c('viewer', 'console')</code>). Note that displaying in the viewer
requires the <code>htmltools</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For room for improvement, either a numeric vector with scores on
a (sub-)determinant, or a data frame with multiple such vectors. For the
Determinant Selection Table functions, the object to print/knit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>echoPartial</code></td>
<td>
<p>Whether to show the executed code in the R Markdown
partial (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partialFile</code></td>
<td>
<p>This can be used to specify a custom partial file. The
file will have object <code>x</code> available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Passed on to <code>knitr::knit()</code> whether it should e
chatty (<code>FALSE</code>) or quiet (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any additional arguments are passed to the default print method
by the print method, and to <code>rmdpartials::partial()</code> when knitting a
RMarkdown partial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forceKnitrOutput</code></td>
<td>
<p>Force knitr output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleLevel</code></td>
<td>
<p>Whether to return sample-level estimates (<code>TRUE</code>) or
individual-level estimates (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varName</code></td>
<td>
<p>For internal use.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Potential for Change index was developed by Keegan et al. and is a
numerical representation of a number of important features in <code>CIBER()</code>
plots (for more details, please see the references below). It turned out
a similar measure, the Intervention Potential, was developed by Huber &amp;
Mosler (2013). The latter uses regression coefficients as weights, which
is problematic for a number of reasons (see Crutzen, Peters &amp; Noijen, 2017),
and has therefore not been implemented as a default, but it is possible to
use regression coefficients by specifying a custom weight function.
</p>
<p>The original Potential for Change Index was conceptualized to optimize
intervention tailoring and improve the prediction of individual-level
intervention effectiveness. A second conceptualization of the Potential
for Change Index can facilitate sub-determinant selection.
</p>
<p>In addition to using the <code>minimum</code>, <code>maximum</code>, <code>center</code>, and <code>weight</code>
functions to specify custom functions, specific types have also been
implemented to quickly use a prespecified combination of functions.
</p>
<p>The first (<code>type = '1'</code>) is computed as follows:
</p>

<ul>
<li>
<p> For sub-determinants with a positive zero-order correlation with
behavior, the sample mean is subtracted from the observed maximum score,
and the result is multiplied by the zero-order correlation;
</p>
</li>
<li>
<p> For sub-determinants with a negative zero-order correlation with
behavior, the sample mean is subtracted from the observed minimum score,
and the result is multiplied by the zero-order correlation.
</p>
</li>
</ul>
<p>The second (<code>type = '2'</code>) is computed as follows:
</p>

<ul>
<li>
<p> For sub-determinants with a positive zero-order correlation with
behavior, the sample mean is subtracted from the .95 quantile of the
scores, and the result is multiplied by the squared zero-order
correlation (i.e. the proportion of explained variance);
</p>
</li>
<li>
<p> For sub-determinants with a negative zero-order correlation with
behavior, the sample mean is subtracted from the .05 quantile of the
scores, and the result is multiplied by the squared zero-order
correlation (i.e. the proportion of explained variance);
</p>
</li>
</ul>
<p>The second variant effectively takes the 5% trimmed maximum and minimum,
rendering it less sensitive to outliers, penalizes weak associations with
behavior more severely, and decreases sensitivity to differences between
correlations. These differences should render the second variant a bit more
robust over different samples.
</p>
<p>The room for improvement is one of the ingredients of the Potential
for Change Index or P_delta, a generalized version of the Intervention
Potential. The Determinant Selection Table efficiently presents the
Potential for Change Indices for a set of (sub-)determinants.
</p>


<h3>Value</h3>

<p>For the individual-level version, a vector or data
frame with the same dimensions as provided; for the sample-level version, if
a vector is provided, a single number, and if a data frame is provided, a
vector with as many values as the data frame has columns. For
Determinant Selection Table, a data frame.
</p>


<h3>References</h3>

<p>Knittle, K. P., Peters, G.-J. Y., Heino, M. T. J., Tobias, R., &amp;
Hankonen, N. (2019). Potential for change: New metrics for tailoring and
predicting response to behavior change interventions. <a href="https://doi.org/10/ghqmg3">doi:10/ghqmg3</a>
</p>
<p>Huber, A. C. &amp; Mosler, H.-J. (2013) Determining behavioral factors for
interventions to increase safe water consumption: a cross-sectional field
study in rural Ethiopia, International Journal of Environmental Health
Research, 23:2, 96-107 <a href="https://doi.org/10.1080/09603123.2012.699032">doi:10.1080/09603123.2012.699032</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Get example data
dat &lt;- get(data("BBC_pp15.1", package="behaviorchange"));

### Individual-level version, for one sub-determinant
P_delta_example &lt;-
  behaviorchange::potential_for_change_index(
    data=dat,
    determinants='highDose_attitude',
    target='highDose_intention'
  );

head(P_delta_example);
hist(P_delta_example);

### Sample-level version
behaviorchange::potential_for_change_index(
  data=dat,
  determinants='highDose_attitude',
  target='highDose_intention',
  sampleLevel = TRUE
);

### Individual-level for multiple determinants
P_delta_example &lt;-
  behaviorchange::potential_for_change_index(
    data=dat,
    determinants=c('highDose_attitude', 'highDose_perceivedNorm'),
    target='highDose_intention'
  );
head(P_delta_example);

### Sample-level version for multiple determinants
behaviorchange::potential_for_change_index(
  data=dat,
  determinants=c('highDose_attitude', 'highDose_perceivedNorm'),
  target='highDose_intention',
  sampleLevel = TRUE
);

### Get the Potential for Change Index Type 2
behaviorchange::potential_for_change_index(
  data=dat,
  determinants=c('highDose_attitude', 'highDose_perceivedNorm'),
  target='highDose_intention',
  type = '2',
  sampleLevel = TRUE
);

### Get a Determinant Selection Table
behaviorchange::determinant_selection_table(
  data=dat,
  determinants = c('highDose_AttBeliefs_long',
                   'highDose_AttBeliefs_intensity',
                   'highDose_AttBeliefs_euphoria'),
  target = 'highDose_intention',
  sortBy = 6
);

### R Markdown partials can smoothly be included in RMarkdown documents
behaviorchange::determinantSelectionTable_partial(
  behaviorchange::determinant_selection_table(
    data=dat,
    determinants = c('highDose_AttBeliefs_long',
                     'highDose_AttBeliefs_intensity',
                     'highDose_AttBeliefs_euphoria'),
    target = 'highDose_intention',
    sortBy = 6
  )
);

### Room for improvement for one variable
head(
  room_for_improvement(
    dat$highDose_AttBeliefs_long
  )
);

room_for_improvement(
  dat$highDose_AttBeliefs_long,
  sampleLevel = TRUE
);

### For multiple (sub-)determinants
head(
  room_for_improvement(
    dat[, c('highDose_AttBeliefs_long',
            'highDose_AttBeliefs_intensity',
            'highDose_AttBeliefs_euphoria')]
  )
);

room_for_improvement(
  dat[, c('highDose_AttBeliefs_long',
          'highDose_AttBeliefs_intensity',
          'highDose_AttBeliefs_euphoria')],
  sampleLevel = TRUE
);

</code></pre>


</div>