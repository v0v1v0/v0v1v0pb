<div class="container">

<table style="width: 100%;"><tr>
<td>twohk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> One and Two Gene Models Using Linearized Posterior </h2>

<h3>Description</h3>

<p>Fits all one and two gene models (without interactions aka 'epistasis')
in an intercross, backcross, or recombinant inbred line. Uses a linear
approximation to the likelihood, i.e. the expected allele states are
used. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">twohk(varcov, ana.obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p> An object produced by <code> make.varcov</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ana.obj</code></td>
<td>
<p>An <code>analysis.object</code> — see <code>make.analysis.obj</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments override the default choices of
candidate loci (<code>locs</code>), prior for locus (<code>locs.prior</code>),
or method specified by <code>ana.obj</code>:
<code>locs</code> A vector indexing the loci to use.
<code>locs.prior</code> 
The prior mass to  associate with each locus. Typically, these sum
to one, but sometimes they might each be set to one (as in computing
lod scores). 
<code>combo.prior</code> Only valid for <code>ana.obj$method=="F2"</code>. 
The prior probability for each term or combination of terms for the
phenotypic effect at a locus. Typically, there will be three of
these - one for the 'additive' term (linear in number of alleles
from one parent strain), the 'dominance' term (quadratic in allele
number), or both terms. The default sets them all to 1/3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The marginal posterior (integrating over regression parameters and
dispersion) is calculated for each one and two gene model under the
assumed correctness of the regression model using expected genotypes
given marker values. This amounts to linearizing the likelihood with
respect to the  (possibly unknown) locus states. For models where the
loci are fully informative markers this is the true posterior.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>loc.1</code></td>
<td>
<p>The marginal posterior for each one gene model relative to
a no gene model.  For
<code>twohkf2</code> this is a matrix of 3 columns; the first for models
with additive terms, the second for dominance terms, and the third
for both. The sum over all three columns yields the marginal
posterior for the locus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.2</code></td>
<td>
<p>The marginal posterior for each locus — obtained by summing
over all two gene models that include that locus—  relative to
a no gene model. For
<code>twohkf2</code> this is a matrix of 3 columns; the first for models
with additive terms, the second for dominance terms, and the third for both. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs.1</code></td>
<td>
<p>The regression coefficients for the genetic effect for 
each locus. For <code>twohkf2</code>, this is a matrix with two rows; the
first is for the 'additive effect' and the second is for the
'dominance' effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs.2</code></td>
<td>
<p>The marginal posterior mean of regression coefficients
for the genetic effect for each locus - obtained by averaging over
all two gene models that include that locus according to the
posterior masses. For <code>twohkf2</code>, this is a matrix with two rows; the
first is for the 'additive effect' and the second is for the
'dominance' effect.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Charles C. Berry <a href="mailto:cberry@ucsd.edu">cberry@ucsd.edu</a> </p>


<h3>References</h3>

<p>Haley C.S. and Knott S.A. (1992) A simple regression method for mapping
quantitative trait loci in line crosses using flanking
markers. <em>Heredity</em> <b>69</b>,315-324. </p>


<h3>Examples</h3>

<pre><code class="language-R">data(little.ana.bc)
little.vc&lt;-make.varcov(little.ana.bc$data[,little.ana.bc$reg.names],
  little.ana.bc$data$bc.phenotype)
little.2&lt;- twohk(little.vc,little.ana.bc,rparm=1)
print( c(odds.1=sum(little.2$loc.1),odds.2=sum(little.2$loc.2)) )
par(mfrow=c(3,2))
little.pe &lt;- 2 * little.2$loc.2 / sum(little.2$loc.2)   #locus-wise posterior expectation
plot(little.ana.bc,little.pe,type="h",ylab="E(genes")
rm(little.2,little.vc,little.pe,little.ana.bc)
</code></pre>


</div>