<div class="container">

<table style="width: 100%;"><tr>
<td>bayes.lin.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian inference for simple linear regression</h2>

<h3>Description</h3>

<p>This function is used to find the posterior distribution of the simple
linear regression slope variable <code class="reqn">\beta</code> when we have a random
sample of ordered pairs <code class="reqn">(x_{i}, y_{i})</code> from the simple linear
regression model: </p>
<p style="text-align: center;"><code class="reqn"> </code>
</p>
<p style="text-align: center;"><code class="reqn">
y_{i} = \alpha_{\bar{x}} + \beta x_{i}+\epsilon_{i} </code>
</p>
<p style="text-align: center;"><code class="reqn"> </code>
</p>
<p> where the
observation errors are, <code class="reqn">\epsilon_i</code>, independent
<code class="reqn">normal(0,\sigma^{2})</code> with known variance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayes.lin.reg(
  y,
  x,
  slope.prior = c("flat", "normal"),
  intcpt.prior = c("flat", "normal"),
  mb0 = 0,
  sb0 = 0,
  ma0 = 0,
  sa0 = 0,
  sigma = NULL,
  alpha = 0.05,
  plot.data = FALSE,
  pred.x = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the value of the explantory variable associated with each response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope.prior</code></td>
<td>
<p>use a “flat” prior or a “normal” prior. for
<code class="reqn">\beta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intcpt.prior</code></td>
<td>
<p>use a “flat” prior or a “normal” prior. for
<code class="reqn">\alpha_[\bar{x}]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mb0</code></td>
<td>
<p>the prior mean of the simple linear regression slope variable
<code class="reqn">\beta</code>. This argument is ignored for a flat prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sb0</code></td>
<td>
<p>the prior std. deviation of the simple linear regression slope
variable <code class="reqn">\beta</code> - must be greater than zero. This argument is
ignored for a flat prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma0</code></td>
<td>
<p>the prior mean of the simple linear regression intercept variable
<code class="reqn">\alpha_{\bar{x}}</code>. This argument is ignored for a flat
prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sa0</code></td>
<td>
<p>the prior std. deviation of the simple linear regression variable
<code class="reqn">\alpha_{\bar{x}}</code> - must be greater than zero. This
argument is ignored for a flat prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the value of the std. deviation of the residuals. By default,
this is assumed to be unknown and the sample value is used instead. This
affects the prediction intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>controls the width of the credible interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.data</code></td>
<td>
<p>if true the data are plotted, and the posterior regression
line superimposed on the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.x</code></td>
<td>
<p>a vector of x values for which the predicted y values are
obtained and the std. errors of prediction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that are passed to <code>Bolstad.control</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list will be returned with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>post.coef</code></td>
<td>
<p>the posterior mean of the intecept and the slope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.coef</code></td>
<td>
<p>the posterior standard deviation of the intercept the
slope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.x</code></td>
<td>
<p>the vector of values for which predictions have been
requested. If pred.x is NULL then this is not returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.y</code></td>
<td>
<p>the
vector predicted values corresponding to pred.x. If pred.x is NULL then this
is not returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.se</code></td>
<td>
<p>The standard errors of the predicted values
in pred.y. If pred.x is NULL then this is not returned</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
## generate some data from a known model, where the true value of the
## intercept alpha is 2, the true value of the slope beta is 3, and the
## errors come from a normal(0,1) distribution
set.seed(123)
x = rnorm(50)
y = 2 + 3*x + rnorm(50)

## use the function with a flat prior for the slope beta and a
## flat prior for the intercept, alpha_xbar.

bayes.lin.reg(y,x)

## use the function with a normal(0,3) prior for the slope beta and a
## normal(30,10) prior for the intercept, alpha_xbar.

bayes.lin.reg(y,x,"n","n",0,3,30,10)

## use the same data but plot it and the credible interval

bayes.lin.reg(y,x,"n","n",0,3,30,10, plot.data = TRUE)

## The heart rate vs. O2 uptake example 14.1
O2 = c(0.47,0.75,0.83,0.98,1.18,1.29,1.40,1.60,1.75,1.90,2.23)
HR = c(94,96,94,95,104,106,108,113,115,121,131)
plot(HR,O2,xlab="Heart Rate",ylab="Oxygen uptake (Percent)")

bayes.lin.reg(O2,HR,"n","f",0,1,sigma=0.13)

## Repeat the example but obtain predictions for HR = 100 and 110

bayes.lin.reg(O2,HR,"n","f",0,1,sigma=0.13,pred.x=c(100,110))

</code></pre>


</div>