<div class="container">

<table style="width: 100%;"><tr>
<td>runmcmc_cp1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a posterior distribution of data conditional that there is one groove.</h2>

<h3>Description</h3>

<p>This function is basically a wrapper for running the left and right (one) changepoint
Gibbs algorithms. The only computation that this function does is to estimate the posterior
means of the left and right changepoint distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runmcmc_cp1(data, iter, start.vals.left, start.vals.right, prop_var_left,
  prop_var_right, cp_prop_var, tol_edge = 10, warmup = 500,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame with columns "x" and "y." "x" is a column of the locations of the
observed residual values, y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of interations after warmup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.vals.left</code></td>
<td>
<p>Starting values for the changepoint algorithm assuming the groove is on the left.
List with elements "sigma", "l", "cp", "beta", and "intercept." "sigma" and "l"
are 2 element vectors where the first element is for the data to the left of the changepoint.
"cp" is the changepoint starting value. "beta" and "intercept" are the slope and intercept
starting values for the mean of the data model to the left of the changepoint.
which parameterize the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.vals.right</code></td>
<td>
<p>Starting values for the changepoint algorithm assuming the groove is on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_var_left</code></td>
<td>
<p>The proposal variance for the random walk Metropolis algorithm assuming
that the groove is on the left.
A two element list of the proposal variance-covariance matrices for the random
walk metropolis algorithm(s). The first element is for the data to the left of the changepoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_var_right</code></td>
<td>
<p>The proposal variance for the random walk Metropolis algorithm assuming
that the groove is on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp_prop_var</code></td>
<td>
<p>The proposal variance for the changepoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_edge</code></td>
<td>
<p>This parameter controls how close changepoint proposals can be to the edge of the data
before getting automatically rejected. For example, a value of 10 means that the changepoint will be
automatically rejected if the proposal is within a distance of 10 x-values from either edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmup</code></td>
<td>
<p>The number of initial iterations which serves two purposes: the first is to allow the
algorithm to wander to the area of most mass, and the second is to tune the proposal variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical value indicating whether to print the iteration number and the parameter proposals.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with all of the output that the left and right changepoint functions produce
individually plus the posterior means of the left and right changepoints.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fake data
sim_groove &lt;- function(beta = c(-0.28,0.28), a = 125)
{
    x &lt;- seq(from = 0, to = 2158, by = 20)
    med &lt;- median(x)
    y &lt;- 1*(x &lt;= a)*(beta[1]*(x - med) - beta[1]*(a - med)) +
    1*(x &gt;= 2158 - a)*(beta[2]*(x - med) - beta[2]*(2158 - a - med))
    return(data.frame("x" = x, "y" = y))
}

fake_groove &lt;- sim_groove()

# define starting values for the changepoints
cp_start_left &lt;- min(fake_groove$x) + 60
cp_start_right &lt;- max(fake_groove$x) - 60

# define list of starting values for both the left and right changepoint models
start.vals &lt;- list("left" = list("sigma" = c(1,1),
                              "l" = c(10,10),
                              "cp" = c(cp_start_left),
                              "beta" = c(-1),
                              "intercept" = c(0)),
                              "right" = list("sigma" = c(1,1),
                               "l" = c(10,10),
                                "cp" = c(cp_start_right),
                                "beta" = c(1),
                                "intercept" = c(0)))

# list of starting values for each of the two MH steps
#  (not sampling the changepoint) for both the left and right changepoint models

prop_var &lt;- list("left" = list(diag(c(1/2,1/2,1/2,1/2)),
                            diag(c(1/2,1/2))),
                            "right" = list(diag(c(1/2,1/2)),
                            diag(c(1/2,1/2,1/2, 1/2))))

# define the proposal variance for the RWMH step sampling the changepoint
cp_prop_var &lt;- 10^2

# run Gibbs MCMC for both the right only and left only GEA models
set.seed(1111)
m1cp &lt;- runmcmc_cp1(data = fake_groove, iter = 500,
                 start.vals.left = start.vals$left,
                 start.vals.right = start.vals$right,
                 prop_var_left = prop_var$left,
                 prop_var_right = prop_var$right,
                 cp_prop_var = cp_prop_var,
                 tol_edge = 50,
                 warmup = 100, verbose = FALSE)
</code></pre>


</div>