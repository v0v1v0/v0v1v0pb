<div class="container">

<table style="width: 100%;"><tr>
<td>invertRIconfInt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate treatment effect confidence intervals by inverting the randomization test</h2>

<h3>Description</h3>

<p>Using an output object from <code>seqblock</code> or any other matrix or dataframe that includes a treatment and an outcome variable for multiple units, as well as blocking and non-blocking variables for the respective unit(s), <code>invertRIconfInt</code> calculates treatment effect confidence intervals by inverting the randomization inference test.</p>


<h3>Usage</h3>

<pre><code class="language-R">invertRIconfInt(dat, outcome.var, tr.var, tau.abs.min = -1, tau.abs.max = 1, 
  tau.length = 10, n.sb.p = 100, id.vars, id.vals, exact.vars = NULL, exact.vals = NULL,
  exact.restr = NULL, exact.alg = "single", covar.vars = NULL, covar.vals = NULL, 
  covar.restr = NULL, covars.ord = NULL, n.tr = 2, tr.names = NULL, assg.prob = NULL,
  seed = NULL, seed.dist, assg.prob.stat = NULL, trim = NULL, assg.prob.method = NULL, 
  assg.prob.kfac = NULL, distance = "mahalanobis", file.name = "sbout.RData", 
  query = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>a matrix or dataframe containing the names and values of the different blocking and non-blocking variables, as well as each unit's treatment assignment and outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome.var</code></td>
<td>
<p>a string specifying the name of the outcome variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr.var</code></td>
<td>
<p>a string specifying the name of the treatment variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.abs.min</code></td>
<td>
<p>lower bound of the range across which the confidence intervals will be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.abs.max</code></td>
<td>
<p>upper bound of the range across which the confidence intervals will be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.length</code></td>
<td>
<p>the number of (evenly spaced) possible treatment effects across the range specified by <code>tau.abs.min</code> and <code>tau.abs.max</code> for which location inside or outside the confidence intervals will be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sb.p</code></td>
<td>
<p>the number of times that sequential blocking will be performed on the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.vars</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.vals</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.vars</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.vals</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.restr</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.alg</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.vars</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.vals</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.restr</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars.ord</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tr</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr.names</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assg.prob</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.dist</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assg.prob.stat</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assg.prob.method</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assg.prob.kfac</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>see the <code>seqblock</code> documentation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>invertRIconfInt</code> takes a data matrix (or data frame) containing names and values of different blocking and non-blocking variables, as well as each unit's treatment assignment and outcome as input and returns a list of treatment effect confidence intervals.
</p>
<p>Apart from specifying the treatment and outcome variable, the user can set all other arguments to <code>seqblock</code> when running <code>invertRIconfInt</code>. The function will then calculate the confidence intervals by employing a method described in Ho and Imai (2006), which inverts Fisher's exact test. The resulting confidence intervals are distribution-free, nonparametric and have accurate coverage probabilities.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ci95</code></td>
<td>
<p>vector of treatment effects within the 95% confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci90</code></td>
<td>
<p>vector of treatment effects within the 90% confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci80</code></td>
<td>
<p>vector of treatment effects within the 80% confidence interval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ryan T. Moore <a href="mailto:rtm@wustl.edu">rtm@wustl.edu</a> and Jonathan Homola <a href="mailto:homola@wustl.edu">homola@wustl.edu</a></p>


<h3>References</h3>

<p>Moore, Ryan T. and Sally A. Moore. 2013. "Blocking for Sequential Political Experiments." <em>Political Analysis</em> 21(4): 507-523. 
</p>
<p>Ho, Daniel E., and Kosuke Imai. 2006. "Randomization inference with natural experiments: An analysis of ballot effects in the 2003 California recall election." <em>Journal of the American Statistical Association</em> 101(475): 888-900.
</p>


<h3>See Also</h3>

<p><code>seqblock</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Create an example data matrix with 50 observations that contains an ID variable, 
##   a dummy variable indicating gender, an age variable (between 18 and 55), a 
##   treatment variable and an outcome variable (between 15 and 20). 
## id &lt;- seq(1,50,1)
## gender &lt;- sample(c(1,2),50,replace=T)
## age &lt;- sample(seq(18,55,1),50,replace=T)
## treat &lt;- sample(c(1,2),50,replace=T)
## out &lt;- treat + sample(seq(15,20,1),50,replace=T)
## data &lt;- cbind(id, gender, age, out, treat)

## Check summary statistics for the created data
## aggregate(out~treat, data, mean)

## Run invertRIconfInt()
## invertRIconfInt(data, outcome.var="out", tr.var="treat", tau.abs.min = -3, 
##  tau.abs.max = 3, id.vars = "id", id.vals = "id", exact.vars = c("gender", "age"), 
##  exact.vals = c("gender", "age"))
</code></pre>


</div>