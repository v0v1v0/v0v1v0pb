<div class="container">

<table style="width: 100%;"><tr>
<td>cross_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a cross plot comparing differential expression (DE) results</h2>

<h3>Description</h3>

<p>This function creates a cross plot visualising the differences
in log2(fold-change) between two DE analyses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cross_plot(
  DEtable1,
  DEtable2,
  DEtable1Subset,
  DEtable2Subset,
  df = NULL,
  lfc.threshold = NULL,
  raster = FALSE,
  mask = FALSE,
  labnames = c("not DE", "DE both", "DE comparison 1", "DE comparison 2"),
  cols.chosen = c("grey", "purple", "dodgerblue", "lightcoral"),
  labels.per.region = 5,
  fix.axis.ratio = TRUE,
  add.guide.lines = TRUE,
  add.labels.custom = FALSE,
  genes.to.label = NULL,
  seed = 0,
  label.force = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DEtable1, DEtable2, DEtable1Subset, DEtable2Subset</code></td>
<td>
<p>tables of DE results,
usually generated by <code>DEanalysis_edger</code>; the first two should
contain all genes, while the second two should only contain DE genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Optionally, pre-computed cross plot table, from cross_plot_prep</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfc.threshold</code></td>
<td>
<p>the log2(fold-change)
threshold to determine whether a gene is DE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raster</code></td>
<td>
<p>whether to rasterize non-DE genes with ggraster to reduce
memory usage; particularly useful when saving plots to files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>whether to hide genes that were not called DE in either
comparison; default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labnames, cols.chosen</code></td>
<td>
<p>the legend labels and colours for the 4
categories of genes ("not DE", "DE both", "DE comparison 1", "DE comparison 2")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.per.region</code></td>
<td>
<p>how many labels to show in each region of the plot;
the plot is split in 8 regions using the axes and major diagonals, and the
points closest to the origin in each region are labelled; default is
5, set to 0 for no labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.axis.ratio</code></td>
<td>
<p>whether to ensure the x and y axes have the same
units, resulting in a square plot; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.guide.lines</code></td>
<td>
<p>whether to add vertical and horizontal guide lines
to the plot to highlight the thresholds; default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.labels.custom</code></td>
<td>
<p>whether to add labels to user-specified genes;
the parameter genes.to.label must also be specified; default is FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes.to.label</code></td>
<td>
<p>a vector of gene names to be labelled in the
plot; if names are present those are shown as the labels (but the values are
the ones matched - this is to allow custom gene names to be presented)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed to be used for reproducibility; only used for
ggrepel::geom_label_repel if labels are present</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.force</code></td>
<td>
<p>passed to the force argument of ggrepel::geom_label_repel;
higher values make labels overlap less (at the cost of them being further
away from the points they are labelling)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The cross plot as a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">expression.matrix.preproc &lt;- as.matrix(read.csv(
  system.file("extdata", "expression_matrix_preprocessed.csv", package = "bulkAnalyseR"), 
  row.names = 1
))[1:500, 1:4]

anno &lt;- AnnotationDbi::select(
  getExportedValue('org.Mm.eg.db', 'org.Mm.eg.db'),
  keys = rownames(expression.matrix.preproc),
  keytype = 'ENSEMBL',
  columns = 'SYMBOL'
) %&gt;%
  dplyr::distinct(ENSEMBL, .keep_all = TRUE) %&gt;%
  dplyr::mutate(NAME = ifelse(is.na(SYMBOL), ENSEMBL, SYMBOL))
  
edger &lt;- DEanalysis_edger(
  expression.matrix = expression.matrix.preproc,
  condition = rep(c("0h", "12h"), each = 2),
  var1 = "0h",
  var2 = "12h",
  anno = anno
)
deseq &lt;- DEanalysis_edger(
  expression.matrix = expression.matrix.preproc,
  condition = rep(c("0h", "12h"), each = 2),
  var1 = "0h",
  var2 = "12h",
  anno = anno
)
cross_plot(
  DEtable1 = edger, 
  DEtable2 = deseq,
  DEtable1Subset = dplyr::filter(edger, abs(log2FC) &gt; 1, pvalAdj &lt; 0.05),
  DEtable2Subset = dplyr::filter(deseq, abs(log2FC) &gt; 1, pvalAdj &lt; 0.05),
  labels.per.region = 0
)
</code></pre>


</div>