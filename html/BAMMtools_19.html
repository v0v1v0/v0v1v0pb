<div class="container">

<table style="width: 100%;"><tr>
<td>getBestShiftConfiguration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get the best (sampled) rate shift configuration from a <code>BAMM</code>
analysis</h2>

<h3>Description</h3>

<p>Get the rate shift configuration with the maximum a
posteriori probability, e.g., the shift configuration that was sampled
most frequently with <code>BAMM</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getBestShiftConfiguration(x, expectedNumberOfShifts, threshold = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either a <code>bammdata</code> object or a <code>credibleshiftset</code>
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedNumberOfShifts</code></td>
<td>
<p>The expected number of shifts under the
prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>The marginal posterior-to-prior odds ratio used as a
cutoff for distinguishing between "core" and "non-core" rate shifts.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates the rate shift configuration with the
highest maximum a posteriori (MAP) probability. It returns a
<code>bammdata</code> object with a single sample. This can be plotted with
<code>plot.bammdata</code>, and individual rate shifts can then
be added with <code>addBAMMshifts</code>. 
</p>
<p>The parameters of this object are averaged over all samples in the
posterior that were assignable to the MAP shift configuration. All
non-core shifts have been excluded, such that the only shift
information contained in the object is from the "significant" rate
shifts, as determined by the relevant marginal posterior-to-prior odds
ratio <code>threshold</code>.
</p>
<p>You can extract the same information from the credible set of shift
configurations. See <code>credibleShiftSet</code> for more
information.
</p>


<h3>Value</h3>

<p>A class <code>bammdata</code> object with a single sample, corresponding
to the diversification rate shift configuration with the maximum a
posteriori probability. See <code>getEventData</code> for details.
</p>


<h3>Author(s)</h3>

<p>Dan Rabosky
</p>


<h3>See Also</h3>

<p>getEventData,  credibleShiftSet,
plot.credibleshiftset, plot.bammdata
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.1, nsamples=500)

# Get prior distribution on shifts-per-branch:
bp &lt;- getBranchShiftPriors(whales, expectedNumberOfShifts = 1)

# Pass the event data object in to the function:
best &lt;- getBestShiftConfiguration(ed, expectedNumberOfShifts = 1,
                                  threshold = 5)
plot(best, lwd=2)
addBAMMshifts(best, cex=2)

# Now we can also work with the credible shift set:
css &lt;- credibleShiftSet(ed, expectedNumberOfShifts = 1, threshold = 5)

summary(css)

# examine model-averaged shifts from MAP configuration-
# This gives us parameters, times, and associated nodes
#   of each evolutionary rate regime (note that one of
#   them corresponds to the root)
css$eventData[[1]];

# Get bammdata representation of MAP configuration:
best &lt;- getBestShiftConfiguration(css, expectedNumberOfShifts = 1,
                                  threshold = 5)

plot(best)
addBAMMshifts(best)
</code></pre>


</div>