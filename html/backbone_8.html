<div class="container">

<table style="width: 100%;"><tr>
<td>fdsm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract backbone using the Fixed Degree Sequence Model</h2>

<h3>Description</h3>

<p><code>fdsm</code> extracts the backbone of a bipartite projection using the Fixed Degree Sequence Model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdsm(
  B,
  alpha = 0.05,
  trials = NULL,
  missing.as.zero = FALSE,
  signed = FALSE,
  mtc = "none",
  class = "original",
  narrative = FALSE,
  progress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An unweighted bipartite graph, as: (1) an incidence matrix in the form of a matrix or sparse <code>Matrix</code>; (2) an edgelist in the form of a two-column dataframe; (3) an <code>igraph</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>real: significance level of hypothesis test(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>numeric: the number of bipartite graphs generated to approximate the edge weight distribution. If NULL, the number of trials is selected based on <code>alpha</code> (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.as.zero</code></td>
<td>
<p>boolean: should missing edges be treated as edges with zero weight and tested for significance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signed</code></td>
<td>
<p>boolean: TRUE for a signed backbone, FALSE for a binary backbone (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtc</code></td>
<td>
<p>string: type of Multiple Test Correction to be applied; can be any method allowed by <code>p.adjust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>string: the class of the returned backbone graph, one of c("original", "matrix", "Matrix", "igraph", "edgelist").
If "original", the backbone graph returned is of the same class as <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>narrative</code></td>
<td>
<p>boolean: TRUE if suggested text &amp; citations should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>boolean: TRUE if the progress of Monte Carlo trials should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>fdsm</code> function compares an edge's observed weight in the projection <code>B*t(B)</code> to the distribution of weights
expected in a projection obtained from a random bipartite network where both the row vertex degrees and column
vertex degrees are <em>exactly</em> fixed at their values in <code>B</code>. It uses the <code>fastball()</code> algorithm to generate random
bipartite matrices with give row and column vertex degrees.
</p>
<p>When <code>signed = FALSE</code>, a one-tailed test (is the weight stronger?) is performed for each edge. The resulting backbone
contains edges whose weights are significantly <em>stronger</em> than expected in the null model. When <code>signed = TRUE</code>, a
two-tailed test (is the weight stronger or weaker?) is performed for each edge. The resulting backbone contains
positive edges for those whose weights are significantly <em>stronger</em>, and negative edges for those whose weights are
significantly <em>weaker</em>, than expected in the null model.
</p>
<p>The p-values used to evaluate the statistical significance of each edge are computed using Monte Carlo methods. The number of
<code>trials</code> performed affects the precision of these p-values. This precision impacts the confidence that a given edge's p-value
is less than the desired <code>alpha</code> level, and therefore represents a statistically significant edge that should be retained in
the backbone. When <code>trials = NULL</code>, <code>trials.needed()</code> is used to estimate the required number of trials to evaluate the
statistical significance of an edges' p-values.
</p>


<h3>Value</h3>

<p>If <code>alpha</code> != NULL: Binary or signed backbone graph of class <code>class</code>.
</p>
<p>If <code>alpha</code> == NULL: An S3 backbone object containing (1) the weighted graph as a matrix, (2) upper-tail p-values as a
matrix, (3, if <code>signed = TRUE</code>) lower-tail p-values as a matrix, (4, if present) node attributes as a dataframe, and
(5) several properties of the original graph and backbone model, from which a backbone can subsequently be extracted
using <code>backbone.extract()</code>.
</p>


<h3>References</h3>

<p>package: Neal, Z. P. (2022). backbone: An R Package to Extract Network Backbones. <em>PLOS ONE, 17</em>, e0269137. <a href="https://doi.org/10.1371/journal.pone.0269137">doi:10.1371/journal.pone.0269137</a>
</p>
<p>fdsm: Neal, Z. P., Domagalski, R., and Sagan, B. (2021). Comparing Alternatives to the Fixed Degree Sequence Model for Extracting the Backbone of Bipartite Projections. <em>Scientific Reports</em>. <a href="https://doi.org/10.1038/s41598-021-03238-3">doi:10.1038/s41598-021-03238-3</a>
</p>
<p>fastball: Godard, Karl and Neal, Zachary P. 2022. fastball: A fast algorithm to sample bipartite graphs with fixed degree sequences. <em>Journal of Complex Networks</em> <a href="https://doi.org/10.1093/comnet/cnac049">doi:10.1093/comnet/cnac049</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#A binary bipartite network of 30 agents &amp; 75 artifacts; agents form three communities
B &lt;- rbind(cbind(matrix(rbinom(250,1,.8),10),
                 matrix(rbinom(250,1,.2),10),
                 matrix(rbinom(250,1,.2),10)),
           cbind(matrix(rbinom(250,1,.2),10),
                 matrix(rbinom(250,1,.8),10),
                 matrix(rbinom(250,1,.2),10)),
           cbind(matrix(rbinom(250,1,.2),10),
                 matrix(rbinom(250,1,.2),10),
                 matrix(rbinom(250,1,.8),10)))

P &lt;- B%*%t(B) #An ordinary weighted projection...
plot(igraph::graph_from_adjacency_matrix(P, mode = "undirected",
                                         weighted = TRUE, diag = FALSE)) #...is a dense hairball

bb &lt;- fdsm(B, alpha = 0.05, trials = 1000, narrative = TRUE, class = "igraph") #An FDSM backbone...
plot(bb) #...is sparse with clear communities
</code></pre>


</div>