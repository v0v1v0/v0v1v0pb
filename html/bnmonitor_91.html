<div class="container">

<table style="width: 100%;"><tr>
<td>seq_pa_ch_monitor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequential parent-child node monitors</h2>

<h3>Description</h3>

<p>Sequential node monitor for a vertex of a Bayesian network for a specific configuration of its parents
</p>


<h3>Usage</h3>

<pre><code class="language-R">seq_pa_ch_monitor(dag, df, node.name, pa.names, pa.val, alpha = "default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dag</code></td>
<td>
<p>an object of class <code>bn</code> from the <code>bnlearn</code> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a base R style dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.name</code></td>
<td>
<p>node over which to compute the monitor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pa.names</code></td>
<td>
<p>vector including the names of the parents of <code>node.name</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pa.val</code></td>
<td>
<p>vector including the levels of <code>pa.names</code> considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>single integer. By default, the number of max levels in <code>df</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider a Bayesian network over variables <code class="reqn">Y_1,\dots,Y_m</code> and suppose a dataset <code class="reqn">(\boldsymbol{y}_1,\dots,\boldsymbol{y}_n)</code> has been observed, where <code class="reqn">\boldsymbol{y}_i=(y_{i1},\dots,y_{im})</code> and <code class="reqn">y_{ij}</code> is the i-th observation of the j-th variable.
Consider a configuration <code class="reqn">\pi_j</code> of the parents and consider the sub-vector <code class="reqn">\boldsymbol{y}'=(\boldsymbol{y}_1',\dots,\boldsymbol{y}_{N'}')</code> of <code class="reqn">(\boldsymbol{y}_1,\dots,\boldsymbol{y}_n)</code> including observations where the parents of <code class="reqn">Y_j</code> take value <code class="reqn">\pi_j</code> only.
Let <code class="reqn">p_i(\cdot|\pi_j)</code> be the conditional distribution of <code class="reqn">Y_j</code> given that its parents take value <code class="reqn">\pi_j</code> after the first i-1 observations have been processed. Define
</p>
<p style="text-align: center;"><code class="reqn">E_i = \sum_{k=1}^Kp_i(d_k|\pi_j)\log(p_i(d_k|\pi_j)),</code>
</p>

<p style="text-align: center;"><code class="reqn">V_i = \sum_{k=1}^K p_i(d_k|\pi_j)\log^2(p_i(d_k|\pi_j))-E_i^2,</code>
</p>

<p>where <code class="reqn">(d_1,\dots,d_K)</code> are the possible values of <code class="reqn">Y_j</code>. The sequential parent-child node monitor for the vertex <code class="reqn">Y_j</code> and parent configuration <code class="reqn">\pi_j</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">Z_{ij}=\frac{-\sum_{k=1}^i\log(p_k(y_{kj}'|\pi_j))-\sum_{k=1}^i E_k}{\sqrt{\sum_{k=1}^iV_k}}.</code>
</p>

<p>Values of <code class="reqn">Z_{ij}</code> such that <code class="reqn">|Z_{ij}|&gt; 1.96</code> can give an indication of a poor model fit for the vertex <code class="reqn">Y_j</code> after the first i-1 observations have been processed.
</p>


<h3>Value</h3>

<p>A vector including the scores <code class="reqn">Z_{ij}</code>.
</p>


<h3>References</h3>

<p>Cowell, R. G., Dawid, P., Lauritzen, S. L., &amp; Spiegelhalter, D. J. (2006). Probabilistic networks and expert systems: Exact computational methods for Bayesian networks. Springer Science &amp; Business Media.
</p>
<p>Cowell, R. G., Verrall, R. J., &amp; Yoon, Y. K. (2007). Modeling operational risk with Bayesian networks. Journal of Risk and Insurance, 74(4), 795-827.
</p>


<h3>See Also</h3>

<p><code>influential_obs</code>, <code>node_monitor</code>, <code>seq_node_monitor</code>, <code>seq_pa_ch_monitor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">seq_pa_ch_monitor(chds_bn, chds, "Events", "Social", "High", 3)

</code></pre>


</div>