<div class="container">

<table style="width: 100%;"><tr>
<td>bayes_ammi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Estimation of the Additive Main Effects and Multiplicative Interaction Model</h2>

<h3>Description</h3>

<p>Performs Bayesian Estimation of the Additive Main Effects and Multiplicative Interaction Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayes_ammi(.data, .y, .gen, .env, .rep, .nIter)

## Default S3 method:
bayes_ammi(.data, .y, .gen, .env, .rep, .nIter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.y</code></td>
<td>
<p>Response Variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.gen</code></td>
<td>
<p>Genotypes Factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.env</code></td>
<td>
<p>Environment Factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.rep</code></td>
<td>
<p>Replication Factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.nIter</code></td>
<td>
<p>Number of Iterations</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Genotype by Environment Interaction Model
</p>


<h3>Author(s)</h3>


<ol>
<li>
<p> Muhammad Yaseen (<a href="mailto:myaseen208@gmail.com">myaseen208@gmail.com</a>)
</p>
</li>
<li>
<p> Jose Crossa (<a href="mailto:j.crossa@cgiar.org">j.crossa@cgiar.org</a>)
</p>
</li>
<li>
<p> Sergio Perez-Elizalde (<a href="mailto:sergiop@colpos.mx">sergiop@colpos.mx</a>)
</p>
</li>
<li>
<p> Diego Jarquin (<a href="mailto:diego.jarquin@gmail.com">diego.jarquin@gmail.com</a>)
</p>
</li>
<li>
<p> Jose Miguel Cotes
</p>
</li>
<li>
<p> Kert Viele
</p>
</li>
<li>
<p> Genzhou Liu
</p>
</li>
<li>
<p> Paul L. Cornelius
</p>
</li>
</ol>
<h3>References</h3>

<p>Crossa, J., Perez-Elizalde, S., Jarquin, D., Cotes, J.M., Viele, K., Liu, G., and Cornelius, P.L. (2011)
Bayesian Estimation of the Additive Main Effects and Multiplicative Interaction Model
<em>Crop Science</em>, <strong>51</strong>, 1458â€“1469.
(<a href="https://acsess.onlinelibrary.wiley.com/doi/abs/10.2135/cropsci2010.06.0343">doi: 10.2135/cropsci2010.06.0343</a>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Maiz)

fm1 &lt;-
 bayes_ammi(
     .data  = Maiz
   , .y     = y
   , .gen   = entry
   , .env   = site
   , .rep   = rep
   , .nIter = 20
  )
names(fm1)
fm1$mu1
fm1$tau1
fm1$tao1
fm1$delta1
fm1$lambdas1
fm1$alphas1
fm1$gammas1

library(ggplot2)

Plot1Mu &lt;-
  ggplot(data = fm1$mu1, mapping = aes(x = 1:nrow(fm1$mu1), y = mu)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(mu), x = "Iterations") +
  theme_bw()
print(Plot1Mu)

Plot2Mu &lt;-
  ggplot(data = fm1$mu1, mapping = aes(mu)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(mu)) +
  theme_bw()
print(Plot2Mu)


Plot1Sigma2 &lt;-
  ggplot(data = fm1$tau1, mapping = aes(x = 1:nrow(fm1$tau1), y = tau)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(sigma^2), x = "Iterations") +
  theme_bw()
print(Plot1Sigma2)


Plot2Sigma2 &lt;-
  ggplot(data = fm1$tau1, mapping = aes(tau)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(sigma^2)) +
  theme_bw()
print(Plot2Sigma2)


# Plot of Alphas
Plot1Alpha1 &lt;-
  ggplot(data = fm1$tao1, mapping = aes(x = 1:nrow(fm1$tao1), y = tao1)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(alpha[1]), x = "Iterations") +
  theme_bw()
print(Plot1Alpha1)

Plot2Alpha1 &lt;-
  ggplot(data = fm1$tao1, mapping = aes(tao1)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(alpha[1])) +
  theme_bw()
print(Plot2Alpha1)

Plot1Alpha2 &lt;-
  ggplot(data = fm1$tao1, mapping = aes(x = 1:nrow(fm1$tao1), y = tao2)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(alpha[2]), x = "Iterations") +
  theme_bw()
print(Plot1Alpha2)

Plot2Alpha2 &lt;-
  ggplot(data = fm1$tao1, mapping = aes(tao2)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(alpha[2])) +
  theme_bw()
print(Plot2Alpha2)

# Plot of Betas
Plot1Beta1 &lt;-
  ggplot(data = fm1$delta1, mapping = aes(x = 1:nrow(fm1$delta1), y = delta1)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(beta[1]), x = "Iterations") +
  theme_bw()
print(Plot1Beta1)

Plot2Beta1 &lt;-
  ggplot(data = fm1$delta1, mapping = aes(delta1)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(beta[1])) +
  theme_bw()
print(Plot2Beta1)


Plot1Beta2 &lt;-
  ggplot(data = fm1$delta1, mapping = aes(x = 1:nrow(fm1$delta1), y = delta2)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(beta[2]), x = "Iterations") +
  theme_bw()
print(Plot1Beta2)

Plot2Beta2 &lt;-
  ggplot(data = fm1$delta1, mapping = aes(delta2)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(beta[2])) +
  theme_bw()
print(Plot2Beta2)


Plot1Beta3 &lt;-
  ggplot(data = fm1$delta1, mapping = aes(x = 1:nrow(fm1$delta1), y = delta3)) +
  geom_line(color = "blue") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = expression(beta[3]), x = "Iterations") +
  theme_bw()
print(Plot1Beta3)

Plot2Beta3 &lt;-
  ggplot(data = fm1$delta1, mapping = aes(delta3)) +
  geom_histogram() +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(y = "Frequency", x = expression(beta[3])) +
  theme_bw()
print(Plot2Beta3)


BiplotAMMI &lt;-
  ggplot(data = fm1$alphas0, mapping = aes(x = alphas1, y = alphas2)) +
  geom_point() +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = 0) +
  geom_text(aes(label = 1:nrow(fm1$alphas0)),
            vjust = "inward", hjust = "inward") +
  geom_point(data = fm1$gammas0, mapping = aes(x = gammas1, y = gammas2)) +
  geom_segment(data = fm1$gammas0,
               aes(x = 0, y = 0, xend = gammas1, yend = gammas2),
               arrow = arrow(length = unit(0.2, "cm"))
               , alpha = 0.75, color = "red") +
  geom_text(data = fm1$gammas0,
            aes(x = gammas1, y = gammas2,
                label = paste0("E", 1:nrow(fm1$gammas0))),
            vjust = "inward", hjust = "inward") +
  scale_x_continuous(
    limits = c(-max(abs(c(range(fm1$alphas0[, 1:2], fm1$gammas0[, 1:2]))))
               , max(abs(c(range(fm1$alphas0[, 1:2], fm1$gammas0[, 1:2])))))) +
  scale_y_continuous(
    limits = c(-max(abs(c(range(fm1$alphas0[, 1:2], fm1$gammas0[, 1:2]))))
               , max(abs(c(range(fm1$alphas0[, 1:2], fm1$gammas0[, 1:2])))))) +
  labs(title = "MCO Method", x = expression(PC[1]), y = expression(PC[2])) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

print(BiplotAMMI)


BiplotBayesAMMI &lt;-
  ggplot(data = fm1$alphas1, mapping = aes(x = alphas1, y = alphas2)) +
  geom_point() +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = 0) +
  geom_text(aes(label = 1:nrow(fm1$alphas1)),
            vjust = "inward", hjust = "inward") +
  geom_point(data = fm1$gammas1, mapping = aes(x = gammas1, y = gammas2)) +
  geom_segment(data = fm1$gammas1,
               aes(x = 0, y = 0, xend = gammas1, yend = gammas2),
               arrow = arrow(length = unit(0.2, "cm"))
               , alpha = 0.75, color = "red") +
  geom_text(data = fm1$gammas1,
            aes(x = gammas1, y = gammas2,
                label = paste0("E", 1:nrow(fm1$gammas1))),
            vjust = "inward", hjust = "inward") +
  scale_x_continuous(
    limits = c(-max(abs(c(range(fm1$alphas1[, 1:2], fm1$gammas1[, 1:2]))))
               , max(abs(c(range(fm1$alphas1[, 1:2], fm1$gammas1[, 1:2])))))) +
  scale_y_continuous(
    limits = c(-max(abs(c(range(fm1$alphas1[, 1:2], fm1$gammas1[, 1:2]))))
               , max(abs(c(range(fm1$alphas1[, 1:2], fm1$gammas1[, 1:2])))))) +
  labs(title = "Bayesian Method", x = expression(PC[1]), y = expression(PC[2])) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

print(BiplotBayesAMMI)


</code></pre>


</div>