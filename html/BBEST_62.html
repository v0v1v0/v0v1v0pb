<div class="container">

<table style="width: 100%;"><tr>
<td>set.sigma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Set the experimental uncertainty
</h2>

<h3>Description</h3>

<p>This function either sets the pointwise experimental uncertainty or estimates it using <code>aws</code> library.
</p>


<h3>Usage</h3>

<pre><code class="language-R">set.sigma(data, sigma=NA, x.bkg.only=NA, n.regions=10, hmax=250, sigma2=c(0.1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of type <code>data</code>. See <code>set.data</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>numeric vector which, if not <code>NA</code>, determines the pointwise experimental uncertainty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.bkg.only</code></td>
<td>
<p>if parameter <code>sigma</code> is <code>NA</code>, determines the peak-free region used to estimate the noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.regions</code></td>
<td>
<p>if both parameters <code>sigma</code> and <code>x.bkg.only</code> are <code>NA</code>, the grid is split into <code>n.regions</code> equal regions. The noise is then estimated for each of these regions. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmax</code></td>
<td>
<p>specifies the maximal bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>specifies the estimation of the signal's variance</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We assume the experimental uncertainty to have  a Gaussian distribution with x-dependent amplitude. Splitting the grid into <code>n.regions</code> segments and estimating Gaussian standard deviations over each of these segments allows us to approximate the true distribution.
</p>
<p>The function uses <code>aws</code> package that uses a Propagation-Separation Approach for signal smoothing. The use of <code>sigma2</code> argument allows to obtain a smoother or rougher result.
</p>


<h3>Value</h3>

<p>An object of type <code>data</code>. Elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>numeric vector containing the estimated noise level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothed</code></td>
<td>
<p>if both parameters <code>sigma</code> and <code>x.bkg.only</code> are <code>NA</code> contains a smoothed estimate of the regression function.</p>
</td>
</tr>
</table>
<p>are replaced with their new values.
</p>


<h3>References</h3>

<p>Polzehl J, Papafitsoros K, Tabelow K (2020). Patch-Wise Adaptive Weights Smoothing in R. Journal of Statistical Software, 95(6), 1-27.
Joerg Polzehl, Felix Anker (2020): aws: Adaptive Weights Smoothing. Version 2.5. <a href="https://CRAN.R-project.org/package=aws">https://CRAN.R-project.org/package=aws</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Setting x and y
x &lt;- seq(.7, 30, 0.01)
y &lt;- sin(x)
# Adding x-dependent noise
y &lt;- y + rnorm(sd=0.05+x/240, n=length(x))

# estimating noise
dat &lt;- list(x=x, y=y)
dat &lt;- set.sigma(dat, n.regions=1, sigma2 = 0.005)
# use
# dat &lt;- set.sigma(dat, n.regions=5)
# to see the difference


# Plotting results: noisy function and a
# smoothed estimate +/- 2 standard deviations
plot(x, y, t="l")
lines(dat$x, dat$smoothed, col=3, lwd=2)
lines(dat$x, dat$smoothed+2*dat$sigma, col=2)
lines(dat$x, dat$smoothed-2*dat$sigma, col=2)
abline(v=seq(min(x), max(x),length=5), col=4)

## End(Not run)
</code></pre>


</div>