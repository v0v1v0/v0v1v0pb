<div class="container">

<table style="width: 100%;"><tr>
<td>predict_MCMC_growth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stochastic growth of MCMC fit</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt="[Superseded]"></a>
</p>
<p>The function <code>predict_MCMC_growth()</code> has been superseded by <code>predictMCMC()</code>
S3 methods of the relevant classes.
</p>
<p>Nonetheless, it can still make a prediction of microbial growth including
parameter uncertainty based on a growth model
fitted using <code>fit_MCMC_growth()</code> or <code>fit_multiple_growth_MCMC()</code>.
This function predicts growth curves for <code>niter</code> samples (with replacement)
of the samples of the MCMC algorithm. Then, credible intervals are calculated based on the
quantiles of the model predictions at each time point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_MCMC_growth(
  MCMCfit,
  times,
  env_conditions,
  niter,
  newpars = NULL,
  formula = . ~ time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MCMCfit</code></td>
<td>
<p>An instance of <code>FitDynamicGrowthMCMC</code> or
<code>FitMultipleGrowthMCMC</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Numeric vector of storage times for the predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env_conditions</code></td>
<td>
<p>Tibble with the (dynamic) environmental conditions
during the experiment. It must have one column named 'time' with the
storage time and as many columns as required with the environmental conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newpars</code></td>
<td>
<p>A named list defining new values for the some model parameters.
The name must be the identifier of a model already included in the model.
These parameters do not include variation, so defining a new value for a fitted
parameters "fixes" it. <code>NULL</code> by default (no new parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula stating the column named defining the elapsed time in
<code>env_conditions</code>. By default, . ~ time.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An instance of <code>MCMCgrowth()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## We need a FitDynamicGrowthMCMC object

data("example_dynamic_growth")
data("example_env_conditions")

sec_model_names &lt;- c(temperature = "CPM", aw= "CPM")

known_pars &lt;- list(Nmax = 1e4,  # Primary model
    N0 = 1e0, Q0 = 1e-3,  # Initial values of the primary model
    mu_opt = 4, # mu_opt of the gamma model
    temperature_n = 1,  # Secondary model for temperature
    aw_xmax = 1, aw_xmin = .9, aw_n = 1  # Secondary model for water activity
    )

my_start &lt;- list(temperature_xmin = 25, temperature_xopt = 35,
    temperature_xmax = 40,
    aw_xopt = .95)

set.seed(12124) # Setting seed for repeatability

my_MCMC_fit &lt;- fit_MCMC_growth(example_dynamic_growth, example_env_conditions,
    my_start, known_pars, sec_model_names, niter = 3000)

## Define the conditions for the simulation

my_times &lt;- seq(0, 15, length = 50)
niter &lt;- 2000

newpars &lt;- list(N0 = 1e-1,  # A parameter that was fixed
                temperature_xmax = 120  # A parameter that was fitted
                )


## Make the simulations

my_MCMC_prediction &lt;- predict_MCMC_growth(my_MCMC_fit,
    my_times,
    example_env_conditions, # It could be different from the one used for fitting
    niter,
    newpars)
    
## We can plot the prediction interval

plot(my_MCMC_prediction)

## We can also get the quantiles at each time point

print(my_MCMC_prediction$quantiles)


</code></pre>


</div>