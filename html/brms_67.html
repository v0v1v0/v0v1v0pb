<div class="container">

<table style="width: 100%;"><tr>
<td>car</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial conditional autoregressive (CAR) structures</h2>

<h3>Description</h3>

<p>Set up an spatial conditional autoregressive (CAR) term in <span class="pkg">brms</span>. The
function does not evaluate its arguments â€“ it exists purely to help set up a
model with CAR terms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">car(M, gr = NA, type = "escar")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Adjacency matrix of locations. All non-zero entries are treated as
if the two locations are adjacent. If <code>gr</code> is specified, the row names
of <code>M</code> have to match the levels of the grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr</code></td>
<td>
<p>An optional grouping factor mapping observations to spatial
locations. If not specified, each observation is treated as a separate
location. It is recommended to always specify a grouping factor to allow
for handling of new data in post-processing methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of the CAR structure. Currently implemented are
<code>"escar"</code> (exact sparse CAR), <code>"esicar"</code> (exact sparse intrinsic
CAR), <code>"icar"</code> (intrinsic CAR), and <code>"bym2"</code>. More information is
provided in the 'Details' section.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>escar</code> and <code>esicar</code> types are
implemented based on the case study of Max Joseph
(<a href="https://github.com/mbjoseph/CARstan">https://github.com/mbjoseph/CARstan</a>). The <code>icar</code> and
<code>bym2</code> type is implemented based on the case study of Mitzi Morris
(<a href="https://mc-stan.org/users/documentation/case-studies/icar_stan.html">https://mc-stan.org/users/documentation/case-studies/icar_stan.html</a>).
</p>


<h3>Value</h3>

<p>An object of class <code>'car_term'</code>, which is a list
of arguments to be interpreted by the formula
parsing functions of <span class="pkg">brms</span>.
</p>


<h3>See Also</h3>

<p><code>autocor-terms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# generate some spatial data
east &lt;- north &lt;- 1:10
Grid &lt;- expand.grid(east, north)
K &lt;- nrow(Grid)

# set up distance and neighbourhood matrices
distance &lt;- as.matrix(dist(Grid))
W &lt;- array(0, c(K, K))
W[distance == 1] &lt;- 1
rownames(W) &lt;- 1:nrow(W)

# generate the covariates and response data
x1 &lt;- rnorm(K)
x2 &lt;- rnorm(K)
theta &lt;- rnorm(K, sd = 0.05)
phi &lt;- rmulti_normal(
  1, mu = rep(0, K), Sigma = 0.4 * exp(-0.1 * distance)
)
eta &lt;- x1 + x2 + phi
prob &lt;- exp(eta) / (1 + exp(eta))
size &lt;- rep(50, K)
y &lt;- rbinom(n = K, size = size, prob = prob)
g &lt;- 1:length(y)
dat &lt;- data.frame(y, size, x1, x2, g)

# fit a CAR model
fit &lt;- brm(y | trials(size) ~ x1 + x2 + car(W, gr = g),
           data = dat, data2 = list(W = W),
           family = binomial())
summary(fit)

## End(Not run)

</code></pre>


</div>