<div class="container">

<table style="width: 100%;"><tr>
<td>vecr2matr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Transform single component indeces to double component indeces
</h2>

<h3>Description</h3>

<p>Components of a bivariate G-spline can be indexed in several
ways. Suppose that the knots in the first dimension are
<code class="reqn">\mu_{1,-K_1},\dots,\mu_{1,K_1}</code>
and the knots in the second dimension
<code class="reqn">\mu_{2,-K_2},\dots,\mu_{2,K_2}.</code>
I.e. we have <code class="reqn">2K_1+1</code> knots in the first dimension and
<code class="reqn">2K_2+1</code> knots in the second dimension. Each G-spline
component can have a double index <code class="reqn">(k_1,k_2)</code>
assigned which means that it corresponds to the knot
<code class="reqn">(\mu_{1,k_1},\mu_{2,k_2})</code>
or alternatively the same G-spline component can have a~single index
</p>
<p style="text-align: center;"><code class="reqn">r=(k_2 + K_2)\times(2K_1+1) + k_1 + K_1 + 1</code>
</p>

<p>assigned where <code class="reqn">r</code> takes values from
<code class="reqn">1,\dots,K_1\times K_2</code>. Single indexing is used
for example by files <code>r.sim</code> and <code>r_2.sim</code> generated by
functions <code>bayesHistogram</code>, <code>bayesBisurvreg</code>,
<code>bayessurvreg2</code> to save some space.
</p>
<p>This function serves to translate single indeces to double indeces
using the relationship
</p>
<p style="text-align: center;"><code class="reqn">k_1 = (r - 1) \mbox{ mod } (2K_1+1) - K_1</code>
</p>

<p style="text-align: center;"><code class="reqn">k_2 = (r - 1) \mbox{ div } (2K_1+1) - K_2</code>
</p>

<p>The function can be used also in one dimensional case when a~simple
relationship holds
</p>
<p style="text-align: center;"><code class="reqn">r = k + K + 1</code>
</p>
  
<p style="text-align: center;"><code class="reqn">k = r - 1 - K</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">vecr2matr(vec.r, KK)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vec.r</code></td>
<td>
<p>a~vector of single indeces</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KK</code></td>
<td>
<p>a~vector with numbers of knots on each side of the central
knot for each dimension of the G-spline. The length of <code>KK</code>
determines dimension of the G-spline</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In bivariate case: a~matrix with two columns and as many rows as the
length of <code>vec.r</code>.
</p>
<p>In univariate case: a~vector with as ,amy components as the length of <code>vec.r</code>.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Bivariate G-spline
### with 31 knots in each dimension
KK &lt;- c(15, 15)

### First observation in component (-15, -15),
### second observation in component (15, 15),
### third observation in component (0, 0)
vec.r &lt;- c(1, 961, 481)
vecr2matr(vec.r, KK)
</code></pre>


</div>