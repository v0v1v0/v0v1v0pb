<div class="container">

<table style="width: 100%;"><tr>
<td>bartc-plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot methods for <code>bartc</code>
</h2>

<h3>Description</h3>

<p>Visual exploratory data analysis and model fitting diagnostics for causal inference models fit
using the <code>bartc</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_sigma(x, main = "Traceplot sigma", 
           xlab = "iteration", ylab = "sigma",
           lty = 1:x$n.chains,
           ...)

plot_est(x, main = paste("Traceplot", x$estimand),
         xlab = "iteration", ylab = x$estimand,
         lty = 1:x$n.chains, col = NULL,
         ...)

plot_indiv(x, main = "Histogram Individual Quantities",
           type = c("icate", "mu.obs", "mu.cf", "mu.0",
                    "mu.1", "y.cf", "y.0", "y.1", "ite"),
           xlab = "treatment effect",
           breaks = 20,
           ...)

plot_support(x, main = "Common Support Scatterplot",
             xvar = "tree.1", yvar = "tree.2",
             sample = c("inferential", "all"),
             xlab = NULL, ylab = NULL,
             pch.trt = 21, bg.trt = "black",
             pch.ctl = pch.trt, bg.ctl = NA,
             pch.sup = pch.trt, bg.sup = NA, col.sup = "red", cex.sup = 1.5,
             legend.x = "topleft", legend.y = NULL,
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Object of class <code>bartcFit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>Character title of plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Character label of <code class="reqn">x</code> axis. For <code>plot_support</code>, if <code>NULL</code> a default will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Character label of <code class="reqn">y</code> axis. For <code>plot_support</code>, if <code>NULL</code> a default will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>For line plots (<code>plot_sigma</code>, <code>plot_est</code>), models use the values of <code>lty</code> to
visually distinguish each chain.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>For line plots, use <code>col</code> vector to distinguish between groups (if any).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>Argument to <code>hist</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The individual quantity to be plotted. See <code>fitted</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>

<p>Variable for use on <code class="reqn">x</code> axis.  Can be one of <code>"tree.XX"</code>, <code>"pca.XX"</code>, <code>"css"</code>, 
any individual level quantity accepted by <code>fitted</code>, the number or 
name of a column used to fit the response model, or a given vector. See below for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>

<p>Return information for either the <code>"inferential"</code> (e.g. treated observations when the estimand is
<code>att</code>) or <code>"all"</code> observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>

<p>Variable for use on the <code class="reqn">y</code> axis, of the same form as <code>xvar</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.trt</code></td>
<td>

<p><code>pch</code> point value used when plotting treatment observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.trt</code></td>
<td>

<p><code>bg</code> background value used when plotting treatment observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.ctl</code></td>
<td>

<p><code>pch</code> point value used when plotting control observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.ctl</code></td>
<td>

<p><code>bg</code> background value used when plotting treatment observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.sup</code></td>
<td>

<p><code>pch</code> point value used when plotting suppressed observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.sup</code></td>
<td>

<p><code>bg</code> background value used when plotting suppressed observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sup</code></td>
<td>

<p><code>col</code> color value used when plotting suppressed observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.sup</code></td>
<td>

<p><code>cex</code> size value used when plotting suppressed observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.x</code></td>
<td>

<p>x value passed to <code>legend</code>. If <code>NULL</code>, legend plotting is skipped.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.y</code></td>
<td>

<p>Optional y value passed to <code>legend</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Optional graphical parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces various plots using objects fit by <code>bartc</code>. <code>plot_sigma</code> and <code>plot_est</code>
are traditional parameter trace plots that can be used to diagnose the convergence of the posterior
sampler. If the <code>bartc</code> model is fit with <code>n.chains</code> greater than one, by default each chain
will be plotted with its own line type.
</p>
<p><code>plot_indiv</code> produces a simple histogram of the distribution of the estimates of the individual
effects, taken as the average of their posterior samples.
</p>
<p><code>plot_support</code> is used to visualize the common support diagnostic in the form of a scatterplot.
Points that the diagnostic excludes are outlined in red. The contents of the <code class="reqn">x</code> and <code class="reqn">y</code> axes
are controlled by the <code>xvar</code> and <code>yvar</code> arguments respectively and can be of the form:
</p>

<ul>
<li> <p><code>"tree.XX"</code> - Variable number <code>"XX"</code> as selected by variable importance in predicting
individual treatment effects using a tree fit by <code>rpart</code>. <code>"XX"</code> must be a number
not exceeding the number of continuous variables used to fit the response model.
</p>
</li>
<li> <p><code>"pca.XX"</code> - <code>"XX"</code>th principal component axis.
</p>
</li>
<li> <p><code>"css"</code> - The common support statistic.
</p>
</li>
<li> <p><code>"y"</code> - Observed response variable.
</p>
</li>
<li> <p><code>"y0"</code> - Predicted values for the response under the control as obtained by <code>fitted</code>.
</p>
</li>
<li> <p><code>"y1"</code> - Predicted values for the response under the treatment  <code>fitted</code>.
</p>
</li>
<li> <p><code>"indiv.diff"</code> - Individual treatment effect estimates, or <code class="reqn">\hat{y}(1) - \hat{y}(0)</code>.
</p>
</li>
<li> <p><code>"p.score"</code> - Propensity score used to fit the response model (if applicable).
</p>
</li>
<li> <p><code>"p.weights"</code> - Weights used when taking average of individual differences for response method
<code>"p.weight"</code>.
</p>
</li>
<li>
<p> predictor columns - Given by name or number.
</p>
</li>
<li>
<p> supplied vector - Any vector of length equal to the number of observations.
</p>
</li>
</ul>
<h3>Value</h3>

<p>None, although plotting occurs as a side-effect.
</p>


<h3>Author(s)</h3>

<p>Vincent Dorie: <a href="mailto:vdorie@gmail.com">vdorie@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>bartc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate fake data using a simple linear model
n &lt;- 100L
beta.z &lt;- c(.75, -0.5,  0.25)
beta.y &lt;- c(.5,   1.0, -1.5)
sigma &lt;- 2

set.seed(725)
x &lt;- matrix(rnorm(3 * n), n, 3)
tau &lt;- rgamma(1L, 0.25 * 16 * rgamma(1L, 1 * 32, 32), 16)

p.score &lt;- pnorm(x %*% beta.z)
z &lt;- rbinom(n, 1, p.score)

mu.0 &lt;- x %*% beta.y
mu.1 &lt;- x %*% beta.y + tau

y &lt;- mu.0 * (1 - z) + mu.1 * z + rnorm(n, 0, sigma)

# run with low parameters only for example
fit &lt;- bartc(y, z, x, n.samples = 100L, n.burn = 15L, n.chains = 2L,
             n.threads = 1L,
             commonSup.rule = "sd")


## plot specific functions

# sigma plot can be used to access convergence of chains
plot_sigma(fit)

# show points lacking common support
plot_support(fit, xvar = "tree.1", yvar = "css", legend.x = NULL)

# see example in ?"bartc-generics" for rank-ordered individual effects plot
</code></pre>


</div>