<div class="container">

<table style="width: 100%;"><tr>
<td>marginal.bayesGspline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Summary for the marginal density estimates based on the bivariate model with Bayesian
G-splines.
</h2>

<h3>Description</h3>

<p>Compute the estimate of the marginal density function based on the values
sampled using the MCMC (MCMC average evaluated in a
grid of values) in a model where density is specified as
a bivariate Bayesian G-spline.
</p>
<p>This function serves to summarize the MCMC chains related to the distributional parts 
of the considered models obtained using the functions:
<code>bayesHistogram</code> and <code>bayesBisurvreg</code>.
</p>
<p>If asked, this function returns also the values of the marginal G-spline
evaluated in a grid at each iteration of MCMC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marginal.bayesGspline(dir, extens = "", K, grid1, grid2,
   skip = 0, by = 1, last.iter, nwrite, only.aver = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>directory where to search for files (‘mixmoment.sim’,
‘mweight.sim’, ‘mmean.sim’, ‘gspline.sim’) with the MCMC
sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extens</code></td>
<td>
<p>an extension used to distinguish different sampled
G-splines if more G-splines were used in one simulation (e.g. with
doubly-censored data). According to which
<code>bayes*survreg*</code> function was used, specify the argument
<code>extens</code> in the following way.
</p>

<dl>
<dt>bayesHistogram:</dt>
<dd>
<p>always <code>extens = ""</code>
</p>
</dd>
<dt>bayesBisurvreg:</dt>
<dd>
<p><code class="reqn">\quad</code>
</p>

<ul>
<li>
<p> to compute the marginals of the bivariate distribution of the <em>error</em> term for
the <em>onset</em> time: <code>extens = ""</code>;
</p>
</li>
<li>
<p> to compute the marginals of the bivariate distribution of the <em>error</em> term for
the <em>event</em> time if there was doubly-censoring:
<code>extens = "_2"</code>;
</p>
</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a~vector of length 2 specifying the number of knots at each
side of the middle knot for each dimension of the G-spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid1</code></td>
<td>
<p>grid of values from the first dimension at which the sampled 
marginal densities are to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid2</code></td>
<td>
<p>grid of values from the second dimension
at which the sampled marginal densities are to be
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>number of rows that should be skipped at the beginning of
each *.sim file with the stored sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>additional thinning of the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last.iter</code></td>
<td>
<p>index of the last row from *.sim files that should be
used. If not specified than it is set to the maximum available
determined according to the file <code>mixmoment.sim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nwrite</code></td>
<td>
<p>frequency with which is the user informed about the
progress of computation (every <code>nwrite</code>th iteration count of
iterations change).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.aver</code></td>
<td>
<p><code>TRUE/FALSE</code>, if <code>TRUE</code> only MCMC average is
returned otherwise also values of the marginal G-spline at each iteration are
returned (which might ask for quite lots of memory).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>marginal.bayesGspline</code> is returned. This object is a
list with components <code>margin1</code> and <code>margin2</code> (for two margins).
</p>
<p>Both <code>margin1</code> and <code>margin2</code> components are data.frames with
columns named <code>grid</code> and <code>average</code> where
</p>
<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>is a grid of values (vector) at which the McMC average of the
marginal G-spline was computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>are McMC averages of the marginal G-spline (vector) evaluated in
<code>grid</code>.</p>
</td>
</tr>
</table>
<p>There exists a method to plot objects of the class <code>marginal.bayesGspline</code>.
</p>


<h3>Attributes</h3>

<p>Additionally, the object of class <code>marginal.bayesGspline</code> has the following
attributes:
</p>

<dl>
<dt><code>sample.size</code></dt>
<dd>
<p>a length of the McMC sample used to compute the McMC average.
</p>
</dd>
<dt><code>sample1</code></dt>
<dd>
<p>marginal (margin = 1) G-spline evaluated in a grid of values. This attribute
is present only if <code>only.aver = FALSE</code>.
</p>
<p>This a matrix with <code>sample.size</code> columns and length(grid1) rows.
</p>
</dd>
<dt><code>sample2</code></dt>
<dd>
<p>marginal (margin = 2) G-spline evaluated in a grid of values. This attribute
is present only if <code>only.aver = FALSE</code>.
</p>
<p>This a matrix with <code>sample.size</code> columns and length(grid2) rows.
</p>
</dd>    
</dl>
<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Komárek, A. (2006).
<em>Accelerated Failure Time Models for Multivariate
Interval-Censored Data with Flexible Distributional Assumptions</em>.
PhD. Thesis, Katholieke Universiteit Leuven, Faculteit Wetenschappen.
</p>
<p>Komárek, A. and Lesaffre, E. (2006).
Bayesian semi-parametric accelerated failurew time model for paired
doubly interval-censored data.
<em>Statistical Modelling</em>, <b>6</b>, 3 - 22.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See the description of R commands for
## the models described in
## Komarek (2006),
## Komarek and Lesaffre (2006),
## 
## R commands available
## in the documentation
## directory of this package
## - see ex-tandmobPA.R and
##   https://www2.karlin.mff.cuni.cz/~komarek/software/bayesSurv/ex-tandmobPA.pdf
##
</code></pre>


</div>