<div class="container">

<table style="width: 100%;"><tr>
<td>sam_BayesX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Markov Chain Monte Carlo for BAMLSS using <span class="pkg">BayesX</span>
</h2>

<h3>Description</h3>

<p>This sampler function for BAMLSS is an interface to the <span class="pkg">BayesX</span>
(<code>https://www.uni-goettingen.de/de/bayesx/550513.html</code>)
command-line binary from <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. The sampler is based on the command line version and functions
provided in the <span class="pkg">BayesXsrc</span> package, which can be installed using
function <code>get_BayesXsrc()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Sampler functions:
sam_BayesX(x, y, family, start = NULL, weights = NULL, offset = NULL,
  data = NULL, control = BayesX.control(...), ...)

BayesX(x, y, family, start = NULL, weights = NULL, offset = NULL,
  data = NULL, control = BayesX.control(...), ...)

## Sampler control:
BayesX.control(n.iter = 1200, thin = 1, burnin = 200,
  seed = NULL, predict = "light", model.name = "bamlss",
  data.name = "d", prg.name = NULL, dir = NULL,
  verbose = FALSE, show.prg = TRUE, modeonly = FALSE, ...)

## Special BayesX smooth term constructor.
sx(x, z = NULL, bs = "ps", by = NA, ...)

## Special BayesX tensor product smooth term constructor.
tx(..., bs = "ps", k = -1,
  ctr = c("center", "main", "both", "both1", "both2",
    "none", "meanf", "meanfd", "meansimple", "nullspace"),
  xt = NULL, special = TRUE)
tx2(...)
tx3(..., bs = "ps", k = c(10, 5),
  ctr = c("main", "center"),
  xt = NULL, special = TRUE)
tx4(..., ctr = c("center", "main", "both", "both1", "both2"))

## Smooth constructors and predict matrix.
## S3 method for class 'tensorX.smooth.spec'
smooth.construct(object, data, knots, ...)
## S3 method for class 'tensorX.smooth'
Predict.matrix(object, data) 
## S3 method for class 'tensorX3.smooth.spec'
smooth.construct(object, data, knots, ...)
## S3 method for class 'tensorX3.smooth'
Predict.matrix(object, data) 

## Family object for quantile regression with BayesX.
quant_bamlss(prob = 0.5)

## Download the newest version of BayesXsrc.
get_BayesXsrc(dir = NULL, install = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For function <code>BayesX()</code> the <code>x</code> list, as returned from
function <code>bamlss.frame</code>, holding all model matrices and other information that is
used for fitting the model. For function <code>sx()</code> arguments <code>x</code> and <code>z</code> specify
the variables the smooth should be a function of.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The model response, as returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Second variable in a <code>sx()</code> term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <span class="pkg">bamlss</span> family object, see <code>family.bamlss</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named numeric vector containing possible starting values, the names are based on
function <code>parameters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Prior weights on the data, as returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Can be used to supply model offsets for use in fitting,
returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The model frame that should be used for modeling. Note that argument <code>data</code> needs
not to be specified when the <code>BayesX()</code> sampler function is used with <code>bamlss</code>.
For the smooth constructor for <code>tx()</code> terms, see function <code>smooth.construct</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List of control arguments to be send to <span class="pkg">BayesX</span>. See below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Sets the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Defines the thinning parameter for MCMC simulation. E.g., <code>thin = 10</code> means,
that only every 10th sampled parameter will be stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Sets the burn-in phase of the sampler, i.e., the number of starting samples that
should be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Sets the seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>Not supported at the moment, do not modify!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.name</code></td>
<td>
<p>The name that should be used for the model when calling <span class="pkg">BayesX</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>The name that should be used for the data set when calling <span class="pkg">BayesX</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prg.name</code></td>
<td>
<p>The name that should be used for the <code>.prg</code> file that is send to <span class="pkg">BayesX</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>Specifies the directory where <span class="pkg">BayesX</span> should store all output files. For function
<code>get_BayesXsrc()</code>, the directory where <span class="pkg">BayesXsrc</span> should be stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print information during runtime of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.prg</code></td>
<td>
<p>Show the <span class="pkg">BayesX</span> <code>.prg</code> file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modeonly</code></td>
<td>
<p>Should only the posterior mode be compute, note that this is done using
fixed smoothing parameters/variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>A <code>character</code> string, specifying the basis/type which is used for
this model term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>A by variable for varying coefficient model terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The dimension(s) of the bases used to represent the <code>tx()</code> smooth term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used in <code>BayesX.control</code>. For function <code>sx()</code> any extra arguments that
should be passed to <span class="pkg">BayesX</span> for this model term can be specified here. For function
<code>tx()</code>, all variables the smooth should be a function of are specified here. For function
<code>sam_BayesX()</code> all arguments that should be passed to <code>BayesX.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctr</code></td>
<td>
<p>Specifies the type of constraints that should be applied. <code>"main"</code>, both
main effects should be removed; <code>"both"</code>, both main effects and varying effects should
be removed; <code>"none"</code>, no constraint should be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xt</code></td>
<td>
<p>A list of extra arguments to be passed to <span class="pkg">BayesX</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>special</code></td>
<td>
<p>Should the <code>tx()</code> model term be treated as a special smooth. This must
be set to <code>TRUE</code> if using the <code>sam_BayesX</code> sampler and should be set to <code>FALSE</code>,
e.g., when using the <code>sam_GMCMC</code> sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, knots</code></td>
<td>
<p>See, function <code>smooth.construct</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Numeric, specifies the quantile to be modeled, see the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>install</code></td>
<td>
<p>Should package <span class="pkg">BayesXsrc</span> be installed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>sam_BayesX()</code> writes a <span class="pkg">BayesX</span> <code>.prg</code> file and processes the data.
Then, the function call the <span class="pkg">BayesX</span> binary via function
<code>run.bayesx()</code> of the <span class="pkg">BayesXsrc</span> package. After the <span class="pkg">BayesX</span> sampler has
finished, the function reads back in all the parameter samples that can then be used
for further processing within <code>bamlss</code>, i.a.
</p>
<p>The smooth term constructor functions <code>s</code> and <code>te</code> can
be used with the <code>sam_BayesX()</code> sampler. When using <code>te</code> note that only
one smoothing variance is estimated by <span class="pkg">BayesX</span>.
</p>
<p>For anisotropic penalties use function <code>tx()</code> and <code>tx3()</code>, the former currently
supports smooth functions of two variables, while <code>tx3()</code> is supposed to model space-time
interactions. Note that in <code>tx3()</code> the first variable represents time and the 2nd and 3rd
variable the coordinates in space.
</p>


<h3>Value</h3>

<p>Function <code>sam_BayesX()</code> returns samples of parameters. The samples are provided as a
<code>mcmc</code> matrix.
</p>
<p>Function <code>BayesX.control()</code> returns a <code>list</code> with control arguments for
<span class="pkg">BayesX</span>.
</p>
<p>Function <code>sx()</code> a <code>list</code> of class <code>"xx.smooth.spec"</code> and <code>"no.mgcv"</code>, where
<code>"xx"</code> is a basis/type identifying code given by the <code>bs</code> argument.
</p>
<p>Function <code>tx()</code> and <code>tx2()</code> a <code>list</code> of class <code>tensorX.smooth.spec</code>.
</p>


<h3>Note</h3>

<p>Note that this interface is still experimental and needs the newest version of the <span class="pkg">BayesX</span>
source code, which is not yet part of the <span class="pkg">BayesXsrc</span> package on CRAN. The newest version
can be installed with function <code>get_BayesXsrc</code>. Note that the function assumes that sh,
subversion (svn) and <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> can be run from the command line!
</p>
<p>Note that for setting up a new family object to be used with <code>sam_BayesX()</code> additional
information needs to be supplied. The extra information must be placed within the
family object in an named <code>list</code> element named <code>"bayesx"</code>. For each parameter of
the distribution a character string with the corresponding <span class="pkg">BayesX</span> <code>family</code> name and the
<code>equationtype</code> must be supplied. See, e.g., the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> code of <code>gaussian_bamlss</code>
how the setup works.
</p>
<p>For function <code>sx()</code> the following basis types are currently supported:
</p>

<ul>
<li> <p><code>"ps"</code>: P-spline with second order difference penalty. 
</p>
</li>
<li> <p><code>"mrf"</code>: Markov random fields: Defines a Markov random field prior for a
spatial covariate, where geographical information is provided by a map object in
boundary or graph file format (see function <code>read.bnd</code>,
<code>read.gra</code> and <code>shp2bnd</code>), as an additional
argument named <code>map</code>.
</p>
</li>
<li> <p><code>"re"</code>: Gaussian i.i.d. Random effects of a unit or cluster identification covariate.
</p>
</li>
</ul>
<p>Function <code>tx()</code> currently supports smooth terms with two variables.
</p>


<h3>See Also</h3>

<p><code>bamlss</code>, <code>bamlss.frame</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Get newest version of BayesXsrc.
## Note: needs sh, svn and R build tools!
## get_BayesXsrc()
## Not run: if(require("BayesXsrc")) {
  ## Simulate some data
  set.seed(123)
  d &lt;- GAMart()

  ## Estimate model with BayesX. Note
  ## that BayesX computes starting values, so
  ## these are not required by some optimizer function
  ## in bamlss()
  b1 &lt;- bamlss(num ~ s(x1) + s(x2) + s(x3) + s(lon,lat),
    data = d, optimizer = FALSE, sampler = sam_BayesX)

  plot(b1)

  ## Same model with anisotropic penalty.
  b2 &lt;- bamlss(num ~ s(x1) + s(x2) + s(x3) + tx(lon,lat),
    data = d, optimizer = FALSE, sampler = sam_BayesX)

  plot(b2)

  ## Quantile regression.
  b3_0.1 &lt;- bamlss(num ~ s(x1) + s(x2) + s(x3) + tx(lon,lat),
    data = d, optimizer = FALSE, sampler = sam_BayesX,
    family = gF("quant", prob = 0.1))

  b3_0.9 &lt;- bamlss(num ~ s(x1) + s(x2) + s(x3) + tx(lon,lat),
    data = d, optimizer = FALSE, sampler = sam_BayesX,
    family = gF("quant", prob = 0.9))

  ## Predict quantiles.
  p_0.1 &lt;- predict(b3_0.1, term = "s(x2)")
  p_0.9 &lt;- predict(b3_0.9, term = "s(x2)")

  ## Plot.
  plot2d(p_0.1 + p_0.9 ~ x2, data = d)  
}

## End(Not run)
</code></pre>


</div>