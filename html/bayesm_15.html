<div class="container">

<table style="width: 100%;"><tr>
<td>llnhlogit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate Log Likelihood for non-homothetic Logit Model</h2>

<h3>Description</h3>

<p><code>llnhlogit</code> evaluates log-likelihood for the Non-homothetic Logit model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">llnhlogit(theta, choice, lnprices, Xexpend)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta   </code></td>
<td>
<p> parameter vector (see details section) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice  </code></td>
<td>
 <p><code class="reqn">n x 1</code> vector of choice (1,...,p) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lnprices</code></td>
<td>
 <p><code class="reqn">n x p</code>  array of log-prices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xexpend </code></td>
<td>
 <p><code class="reqn">n x d</code> array of vars predicting expenditure </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Non-homothetic logit model, <code class="reqn">Pr(i) = exp(tau v_i) / sum_j exp(tau v_j)</code> <br></p>
<p><code class="reqn">v_i = alpha_i - e^{kappaStar_i}u^i - lnp_i</code> <br>
tau is the scale parameter of extreme value error distribution.<br><code class="reqn">u^i</code> solves <code class="reqn">u^i = psi_i(u^i)E/p_i</code>.<br><code class="reqn">ln(psi_i(U)) = alpha_i - e^{kappaStar_i}U</code>. <br><code class="reqn">ln(E) = gamma'Xexpend</code>.<br></p>
<p>Structure of theta vector: <br>
alpha: <code class="reqn">p x 1</code> vector of utility intercepts.<br>
kappaStar: <code class="reqn">p x 1</code> vector of utility rotation parms expressed on natural log scale. <br>
gamma: <code class="reqn">k x 1</code> – expenditure variable coefs.<br>
tau: <code class="reqn">1 x 1</code> – logit scale parameter.<br></p>


<h3>Value</h3>

<p>Value of log-likelihood (sum of log prob of observed multinomial outcomes).</p>


<h3>Warning</h3>

<p>This routine is a utility routine that does <strong>not</strong> check the input arguments for proper dimensions and type.
</p>


<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p>For further discussion, see Chapter 4, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch. </p>


<h3>See Also</h3>

<p><code>simnhlogit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">N=1000; p=3; k=1
theta = c(rep(1,p), seq(from=-1,to=1,length=p), rep(2,k), 0.5)
lnprices = matrix(runif(N*p), ncol=p)
Xexpend = matrix(runif(N*k), ncol=k)
simdata = simnhlogit(theta, lnprices, Xexpend)

## evaluate likelihood at true theta
llstar = llnhlogit(theta, simdata$y, simdata$lnprices, simdata$Xexpend)
</code></pre>


</div>