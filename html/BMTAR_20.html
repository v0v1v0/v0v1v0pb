<div class="container">

<table style="width: 100%;"><tr>
<td>mtarnumreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the number of regimes in a MTAR model</h2>

<h3>Description</h3>

<p>Compute estimation of number of regimes by NAIC or Carlin and Chib methodology for a MTAR model
</p>


<h3>Usage</h3>

<pre><code class="language-R">mtarnumreg(ini_obj, level = 0.95, burn_m = NULL,niter_m = 1000,
iterprev = 500, chain_m = FALSE, list_m = FALSE,
NAIC = FALSE,ordersprev = list(maxpj = 2,maxqj = 0,maxdj = 0),
parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ini_obj</code></td>
<td>
<p>class “<code>regime_inipars</code>” object, here specificate l0_min, l0_max and method. Not NULL. Default l0_min = 2, l0_max = 3, method = 'KUO'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric type, confident interval for estimations. Default 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_m</code></td>
<td>
<p>numeric type, number of initial runs. Default NULL (10% of niter)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter_m</code></td>
<td>
<p>numeric type, number of runs of MCMC. Default 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterprev</code></td>
<td>
<p>numeric type, number of runs for pseudo values. Default 500</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain_m</code></td>
<td>
<p>logical type, if return chains of parameters. Default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_m</code></td>
<td>
<p>logical type, if return list of regimes considered. Default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAIC</code></td>
<td>
<p>logical type, if return estimation of number of regimes by NAIC (not run Carlin and Chip for l). Default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordersprev</code></td>
<td>
<p>list type object with names (maxpj,maxqj,maxdj), maximum number of lags of each process consider in the pseudo values for each number of regimes considered . Default maxpj = 2,maxqj = 0, maxdj = 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical type, if package <code>parallel</code> should be used. Default FALSE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two proposals to identify or estimate the number of regimes l are implemented. Metropolised Carlin and Chib methodology takes into account the changing dimension in the parameter vector when the number of regimes changes, that proposal is  Bayesian model selection. Other methodology consists in calculating the information criterion NAIC.
</p>


<h3>Value</h3>

<p>Return a list type object of class “<code>regime_number</code>”
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tsregime</code></td>
<td>
<p>ini_obj$tsregime_obj</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_m</code></td>
<td>
<p>if list_m TRUE list of models considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_chain</code></td>
<td>
<p>if chain_m TRUE chains of m</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>table of the proportions of m estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_m</code></td>
<td>
<p>numeric type, final number of regimes estimated</p>
</td>
</tr>
</table>
<p>If NAIC TRUE
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tsregime</code></td>
<td>
<p>ini_obj$tsregime_obj</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_m</code></td>
<td>
<p>list of consider models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAIC</code></td>
<td>
<p>list type of NAIC for each considered model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAIC_final_m</code></td>
<td>
<p>numeric type, final number of regimes by this criteria</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Valeria Bejarano <a href="mailto:vbejaranos@unal.edu.co">vbejaranos@unal.edu.co</a>, Sergio Calderon <a href="mailto:sacalderonv@unal.edu.co">sacalderonv@unal.edu.co</a> &amp; Andrey Rincon <a href="mailto:adrincont@unal.edu.co">adrincont@unal.edu.co</a></p>


<h3>References</h3>

<p>Calderon, S. and Nieto, F. (2017) <em>Bayesian analysis of multivariate threshold autoregress models with missing data.</em> Communications in Statistics - Theory and Methods 46 (1):296–318. doi:10.1080/03610926.2014.990758.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("datasim")
data = datasim
initial = mtarinipars(tsregime_obj = data$Sim,
list_model = list(l0_max = 3),method = 'KUO')

estim = mtarnumreg(ini_obj = initial,iterprev = 500,niter_m = 500,
burn_m = 500, list_m = TRUE,ordersprev = list(maxpj = 2))
estim$final_m

</code></pre>


</div>