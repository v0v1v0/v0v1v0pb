<div class="container">

<table style="width: 100%;"><tr>
<td>BAGofT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Binary Regression Adaptive Goodness-of-fit Test (BAGofT)

</h2>

<h3>Description</h3>

<p><code>BAGofT</code> is used to test the goodness-of-fit of binary classifiers.
The test statistic is constructed based on the results from multiple splittings.
In each split, the test first
splits the data into a training set and a validation set. Then,
it adaptively obtains a partition based on the training set and performs a goodness-of-fit test on the validation set. Details can be found in Zhang, Ding and Yang (2021).

</p>


<h3>Usage</h3>

<pre><code class="language-R">BAGofT(testModel, parFun = parRF(), data, nsplits = 100,
ne = floor(5*nrow(data)^(1/2)), nsim = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>testModel</code></td>
<td>
<p> a function that generates predicted results from the classifier to test. Details can be found in <code>"testGlmBi"</code> for binomial regression, <code>"testGlmnet"</code> for penalized logistic regression, <code>"testRF"</code> for random forest, and <code>"testXGboost"</code> for XGboost.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parFun</code></td>
<td>
<p> a function that generates the adaptive partition. The default is ‘parRF()’ that generates a partition by random forest. More information can be found in <code>"parRF"</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing  the response and covariates used in the model together with the other covariates not in the model but considered used to generate the partition.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsplits</code></td>
<td>
<p>number of splits. The default is 100.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ne</code></td>
<td>
<p>the size of the validation set. The default is floor(5*nrow(data)^(1/2)).

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulated datasets to calculate the bootstrap <code class="reqn">p</code>-value.

</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the bootstrap <code class="reqn">p</code>-value of the BAGofT test statistic (which combines the results from multiple splitting by taking the average).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value2</code></td>
<td>
<p>the bootstrap <code class="reqn">p</code>-value from an alternative version of the BAGofT test statistic (which combines the results from multiple splitting by taking the sample median).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value3</code></td>
<td>
<p>the bootstrap <code class="reqn">p</code>-value from an alternative version of the BAGofT test statistic (which combines the results from multiple splitting by taking the minimum).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmean</code></td>
<td>
<p>the BAGofT test statistic (which combines the results from multiple splitting by taking the average).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmedian</code></td>
<td>
<p>an alternative BAGofT test statistic (which combines the results from multiple splitting by taking the sample median).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmin</code></td>
<td>
<p>an alternative BAGofT test statistic (which combines the results from multiple splitting by taking the minimum).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simRes</code></td>
<td>
<p>a list that contains the simulated test statitics used to generate the bootstrap <code class="reqn">p</code>-values. ‘simRes$pmeanSim’, ‘simRes$pmediansim’, ‘simRes$pmeanSim’ corresepond to the three kinds of BAGofT statistics, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singleSplit.results</code></td>
<td>
<p>a list that contains the results from each splitting. Its elements are as follows.
</p>
<p>‘singleSplit.results[[k]]$chisq’: The chi-squared statistic of the BAGofT test from the <code class="reqn">k</code>th splitting.
</p>
<p>‘singleSplit.results[[k]]$p.value’: The <code class="reqn">p</code>-value calculated from the chi-squared statistic.
</p>
<p>‘singleSplit.results[[k]]$ngp’: The number of groups chosen by the adaptive partition.
</p>
<p>‘singleSplit.results[[k]]$contri’: The weighted sum of squares from each group.
</p>
<p>‘singleSplit.results[[k]]$parRes’: Variable importance (or other results from custom partition functions) from the adaptive partition.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, Ding and Yang (2021) "Is a Classification Procedure Good Enough?-A Goodness-of-Fit Assessment Tool for Classification Learning" arXiv preprint 	arXiv:1911.03063v2 (2021).

</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
###################################################
# Generate a sample dataset.
###################################################
# set the random seed
set.seed(20)
# set the number of observations
n &lt;- 200

# generate covariates data
x1dat &lt;- runif(n, -3, 3)
x2dat &lt;- rnorm(n, 0, 1)
x3dat &lt;- rchisq(n, 4)

# set coefficients
beta1 &lt;- 1
beta2 &lt;- 1
beta3 &lt;- 1

# calculate the linear predictor data
lindat &lt;- x1dat * beta1 + x2dat * beta2 + x3dat * beta3
# calculate the probabilities by inverse logit link
pdat &lt;- 1/(1 + exp(-lindat))

# generate the response data
ydat &lt;- sapply(pdat, function(x) stats :: rbinom(1, 1, x))

# generate the dataset
dat &lt;- data.frame(y = ydat, x1 = x1dat, x2 = x2dat,
                    x3 = x3dat)

###################################################
# Obtain the testing result
###################################################
# Test a logistic regression that misses 'x3'. The partition
# variables are 'x1', 'x2', and 'x3'.
testRes &lt;- BAGofT(testModel =testGlmBi(formula = y ~ x1 + x2 , link = "logit"),
       parFun = parRF(parVar = c("x1", "x2", "x3")),
       data = dat)

# the bootstrap p-value is 0. Therefore, the test is rejected
print(testRes$p.value)

# the variable importance from the adaptive partition shows that x3 is likely
# to be the reason for the overfitting (,which is correct since the formula
# fm misses the x3).
print(VarImp(testRes))

## End(Not run)
</code></pre>


</div>