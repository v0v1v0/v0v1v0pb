<div class="container">

<table style="width: 100%;"><tr>
<td>callRelatedness</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>callRelatedness</h2>

<h3>Description</h3>

<p>A function that takes PMR observations, and (given a prior distribution for
degrees of relatedness) returns the posterior probabilities of all pairs of
individuals being (a) the same individual/twins, (b) first-degree related,
(c) second-degree related or (d) "unrelated" (third-degree or higher).
The highest posterior probability degree of relatedness is also returned as
a hard classification.
Options include setting the background relatedness (or using the sample
median), a minimum number of overlapping SNPs if one uses the sample median
for background relatedness, and a minimum number of overlapping SNPs
for including pairs in the analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">callRelatedness(
  pmr_tibble,
  class_prior = rep(0.25, 4),
  average_relatedness = NULL,
  median_co = 500,
  filter_n = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pmr_tibble</code></td>
<td>
<p>a tibble that is the output of the processEigenstrat
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_prior</code></td>
<td>
<p>the prior probabilities for same/twin, 1st-degree,
2nd-degree, unrelated, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average_relatedness</code></td>
<td>
<p>a single numeric value, or a vector of numeric
values, to use as the average background relatedness. If NULL, the sample
median is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median_co</code></td>
<td>
<p>if average_relatedness is left NULL, then the minimum cutoff
for the number of overlapping snps to be included in the median calculation
is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_n</code></td>
<td>
<p>the minimum number of overlapping SNPs for which pairs are
removed from the entire analysis. If NULL, default is 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>results_tibble: A tibble containing 13 columns:
</p>

<ul>
<li>
<p> row: The row number
</p>
</li>
<li>
<p> pair: the pair of individuals that are compared.
</p>
</li>
<li>
<p> relationship: the highest posterior probability estimate of the degree of relatedness.
</p>
</li>
<li>
<p> pmr: the pairwise mismatch rate (mismatch/nsnps).
</p>
</li>
<li>
<p> sd: the estimated standard deviation of the pmr.
</p>
</li>
<li>
<p> mismatch: the number of sites which did not match for each pair.
</p>
</li>
<li>
<p> nsnps: the number of overlapping snps that were compared for each pair.
</p>
</li>
<li>
<p> ave_re;: the value for the background relatedness used for normalisation.
</p>
</li>
<li>
<p> Same_Twins: the posterior probability associated with a same individual/twins classification.
</p>
</li>
<li>
<p> First_Degree: the posterior probability associated with a first-degree classification.
</p>
</li>
<li>
<p> Second_Degree: the posterior probability associated with a second-degree classification.
</p>
</li>
<li>
<p> Unrelated: the posterior probability associated with an unrelated classification.
</p>
</li>
<li>
<p> BF: A strength of confidence in the Bayes Factor associated with the highest posterior probability classification compared to the 2nd highest. (No longer included)
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">callRelatedness(counts_example,
  class_prior=rep(0.25,4),
  average_relatedness=NULL,
  median_co=5e2,filter_n=1
)
</code></pre>


</div>