<div class="container">

<table style="width: 100%;"><tr>
<td>bd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ball Divergence statistic</h2>

<h3>Description</h3>

<p>Compute Ball Divergence statistic, which is a generic dispersion measure in Banach spaces.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bd(
  x,
  y = NULL,
  distance = FALSE,
  size = NULL,
  num.threads = 1,
  kbd.type = c("sum", "maxsum", "max")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix, data.frame, or a list containing at least two numeric vectors, matrices, or data.frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector, matrix, data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>if <code>distance = TRUE</code>, the elements of <code>x</code> will be considered as a distance matrix. Default: <code>distance = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a vector recording sample size of each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.threads</code></td>
<td>
<p>number of threads. If <code>num.threads = 0</code>, then all of available cores will be used. Default <code>num.threads = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kbd.type</code></td>
<td>
<p>a character string specifying the <code class="reqn">K</code>-sample Ball Divergence test statistic, 
must be one of <code>"sum"</code>, <code>"summax"</code>, or <code>"max"</code>. Any unambiguous substring can be given. 
Default <code>kbd.type = "sum"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the samples not containing missing values, <code>bd</code> returns Ball Divergence statistics.
If we set <code>distance = TRUE</code>, arguments <code>x</code>, <code>y</code> can be a <code>dist</code> object or a
symmetric numeric matrix recording distance between samples; 
otherwise, these arguments are treated as data.
</p>
<p>Ball divergence statistic measure the distribution difference of two datasets in Banach spaces. 
The Ball divergence statistic is proven to be zero if and only if two datasets are identical.
</p>
<p>The definition of the Ball Divergence statistics is as follows.
Given two independent samples <code class="reqn"> \{x_{1}, \ldots, x_{n}\} </code> with the associated probability measure <code class="reqn">\mu</code> and 
<code class="reqn"> \{y_{1}, \ldots, y_{m}\} </code> with <code class="reqn">\nu</code>, where the observations in each sample are <em>i.i.d</em>.
Let <code class="reqn">\delta(x,y,z)=I(z\in \bar{B}(x, \rho(x,y)))</code>, 
where <code class="reqn">\delta(x,y,z)</code> indicates whether <code class="reqn">z</code> is located in the closed ball <code class="reqn">\bar{B}(x, \rho(x,y))</code> 
with center <code class="reqn">x</code> and radius <code class="reqn">\rho(x, y)</code>. 
We denote:
</p>
<p style="text-align: center;"><code class="reqn">
A_{ij}^{X}=\frac{1}{n}\sum_{u=1}^{n}{\delta(X_i,X_j,X_u)}, \quad A_{ij}^{Y}=\frac{1}{m}\sum_{v=1}^{m}{\delta(X_i,X_j,Y_v)},
</code>
</p>

<p style="text-align: center;"><code class="reqn">
C_{kl}^{X}=\frac{1}{n}\sum_{u=1}^{n}{\delta(Y_k,Y_l,X_u)}, \quad C_{kl}^{Y}=\frac{1}{m}\sum_{v=1}^{m}{\delta(Y_k,Y_l,Y_v)}.
</code>
</p>

<p><code class="reqn">A_{ij}^X</code> represents the proportion of samples <code class="reqn"> \{x_{1}, \ldots, x_{n}\} </code> located in the 
ball <code class="reqn">\bar{B}(X_i,\rho(X_i,X_j))</code> and <code class="reqn">A_{ij}^Y</code> represents the proportion of samples <code class="reqn"> \{y_{1}, \ldots, y_{m}\} </code> 
located in the ball <code class="reqn">\bar{B}(X_i,\rho(X_i,X_j))</code>. 
Meanwhile, <code class="reqn">C_{kl}^X</code> and <code class="reqn">C_{kl}^Y</code> represent the corresponding proportions located in the ball <code class="reqn">\bar{B}(Y_k,\rho(Y_k,Y_l))</code>.
The Ball Divergence statistic is defined as:
</p>
<p style="text-align: center;"><code class="reqn">D_{n,m}=A_{n,m}+C_{n,m}</code>
</p>

<p>Ball Divergence can be generalized to the <em>K</em>-sample test problem. Suppose we 
have <code class="reqn">K</code> group samples, each group include <code class="reqn">n_{k}</code> samples. 
The definition of <code class="reqn">K</code>-sample Ball Divergence statistic could be 
to directly sum up the two-sample Ball Divergence statistics of all sample pairs (<code>kbd.type = "sum"</code>)
</p>
<p style="text-align: center;"><code class="reqn">\sum_{1 \leq k &lt; l \leq K}{D_{n_{k},n_{l}}},</code>
</p>

<p>or to find one sample with the largest difference to the others (<code>kbd.type = "maxsum"</code>)
</p>
<p style="text-align: center;"><code class="reqn">\max_{t}{\sum_{s=1, s \neq t}^{K}{D_{n_{s}, n_{t}}},}</code>
</p>

<p>to aggregate the <code class="reqn">K-1</code> most significant different two-sample Ball Divergence statistics (<code>kbd.type = "max"</code>)
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k=1}^{K-1}{D_{(k)}},</code>
</p>

<p>where <code class="reqn">D_{(1)}, \ldots, D_{(K-1)}</code> are the largest <code class="reqn">K-1</code> two-sample Ball Divergence statistics among 
<code class="reqn">\{D_{n_s, n_t}| 1 \leq s &lt; t \leq K\}</code>. When <code class="reqn">K=2</code>,
the three types of Ball Divergence statistics degenerate into two-sample Ball Divergence statistic.
</p>
<p>See <code>bd.test</code> for a test of distribution equality based on the Ball Divergence.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>bd </code></td>
<td>
<p> Ball Divergence statistic</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang
</p>


<h3>References</h3>

<p>Wenliang Pan, Yuan Tian, Xueqin Wang, Heping Zhang. Ball Divergence: Nonparametric two sample test. Ann. Statist. 46 (2018), no. 3, 1109â€“1137. doi:10.1214/17-AOS1579. https://projecteuclid.org/euclid.aos/1525313077
</p>


<h3>See Also</h3>

<p><code>bd.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############# Ball Divergence #############
x &lt;- rnorm(50)
y &lt;- rnorm(50)
bd(x, y)
</code></pre>


</div>