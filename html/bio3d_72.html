<div class="container">

<table style="width: 100%;"><tr>
<td>convert.pdb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Renumber and Convert Between Various PDB formats</h2>

<h3>Description</h3>

<p>Renumber and convert between CHARMM, Amber, Gromacs and Brookhaven
PDB formats.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convert.pdb(pdb, type=c("original", "pdb", "charmm", "amber", "gromacs"),
                renumber = FALSE, first.resno = 1, first.eleno = 1,
                consecutive=TRUE, rm.h = TRUE, rm.wat = FALSE,
                verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> a structure object of class <code>"pdb"</code>, obtained from
<code>read.pdb</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> output format, one of ‘original’, ‘pdb’, 
‘charmm’, ‘amber’, or ‘gromacs’. The default 
option of ‘original’ results in no conversion. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>renumber</code></td>
<td>
<p> logical, if TRUE atom and residue records are
renumbered using ‘first.resno’ and ‘first.eleno’. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.resno</code></td>
<td>
<p> first residue number to be used if
‘renumber’ is TRUE. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.eleno</code></td>
<td>
<p> first element number to be used if
‘renumber’ is TRUE. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consecutive</code></td>
<td>
<p> logical, if TRUE renumbering will result in 
consecutive residue numbers spanning all chains. Otherwise new residue  
numbers will begin at ‘first.resno’ for each chain. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.h</code></td>
<td>
<p> logical, if TRUE hydrogen atoms are removed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.wat</code></td>
<td>
<p> logical, if TRUE water atoms are removed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> logical, if TRUE details of the conversion process 
are printed. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Convert atom names and residue names, renumber atom and residue
records, strip water and hydrogen atoms from <code>pdb</code> objects.
</p>
<p>Format <code>type</code> can be one of “ori”, “pdb”, “charmm”,
“amber” or “gromacs”.
</p>


<h3>Value</h3>

<p>Returns a list of class <code>"pdb"</code>, with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>atom</code></td>
<td>
<p> a character matrix containing all atomic coordinate ATOM data,
with a row per ATOM and a column per record type.  See below for details
of the record type naming convention (useful for accessing columns). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>het</code></td>
<td>
<p> a character matrix containing atomic coordinate records
for atoms within “non-standard” HET groups (see <code>atom</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>helix</code></td>
<td>
 <p>‘start’, ‘end’ and ‘length’ of H
type sse, where start and end are residue numbers “resno”. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheet</code></td>
<td>
 <p>‘start’, ‘end’ and ‘length’ of E
type sse, where start and end are residue numbers “resno”. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqres </code></td>
<td>
<p> sequence from SEQRES field. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyz</code></td>
<td>
<p> a numeric vector of ATOM coordinate data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calpha</code></td>
<td>
<p> logical vector with length equal to <code>nrow(atom)</code>
with TRUE values indicating a C-alpha “elety”. </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For both <code>atom</code> and <code>het</code> list components the column names can be
used as a convenient means of data access, namely:
Atom serial number “eleno” ,
Atom type “elety”,
Alternate location indicator “alt”,
Residue name “resid”,
Chain identifier “chain”,
Residue sequence number “resno”,
Code for insertion of residues “insert”,
Orthogonal coordinates “x”,
Orthogonal coordinates “y”,
Orthogonal coordinates “z”,
Occupancy “o”, and
Temperature factor “b”.
See examples for further details.
</p>


<h3>Author(s)</h3>

<p> Barry Grant </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>
<p>For a description of PDB format (version3.3) see:<br><a href="http://www.wwpdb.org/documentation/format33/v3.3.html">http://www.wwpdb.org/documentation/format33/v3.3.html</a>.
</p>


<h3>See Also</h3>

 <p><code>atom.select</code>, <code>write.pdb</code>,
<code>read.dcd</code>, <code>read.fasta.pdb</code>,
<code>read.fasta</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# Read a PDB file
pdb &lt;- read.pdb("4q21")
pdb
head( pdb$atom[pdb$calpha,"resno"] )

# Convert to CHARMM format
new &lt;- convert.pdb(pdb, type="amber", renumber=TRUE, first.resno=22 )
head( new$atom[new$calpha,"resno"] )

# Write a PDB file
#write.pdb(new, file="tmp4amber.pdb")


## End(Not run)
</code></pre>


</div>