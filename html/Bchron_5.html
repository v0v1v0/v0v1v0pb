<div class="container">

<table style="width: 100%;"><tr>
<td>BchronDensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-parametric phase model</h2>

<h3>Description</h3>

<p>This function runs a non-parametric phase model on 14C and non-14C ages via Gaussian Mixture density estimation
</p>


<h3>Usage</h3>

<pre><code class="language-R">BchronDensity(
  ages,
  ageSds,
  calCurves,
  pathToCalCurves = system.file("data", package = "Bchron"),
  dfs = rep(100, length(ages)),
  numMix = 50,
  iterations = 10000,
  burn = 2000,
  thin = 8,
  updateAges = FALSE,
  store_density = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ages</code></td>
<td>
<p>A vector of ages (most likely 14C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ageSds</code></td>
<td>
<p>A vector of 1-sigma values for the ages given above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calCurves</code></td>
<td>
<p>A vector of values containing either <code>intcal20</code>, <code>shcal20</code>, <code>marine20</code>, or <code>normal</code> (older calibration curves such as intcal13 are also supported). Should be the same length the number of ages supplied. Non-standard calibration curves can be used provided they are supplied in the same format as those previously mentioned and are placed in the same directory. Normal indicates a normally-distributed (non-14C) age.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathToCalCurves</code></td>
<td>
<p>File path to where the calibration curves are located. Defaults to the system directory where the 3 standard calibration curves are stored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfs</code></td>
<td>
<p>Degrees-of-freedom values for the t-distribution associated with the calibration calculation. A large value indicates Gaussian distributions assumed for the 14C ages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numMix</code></td>
<td>
<p>The number of mixture components in the phase model. Might need to be increased if the data set is large and the phase behaviour is very complex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>The number of iterations to run for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>The number of starting iterations to discard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The step size of iterations to keep</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateAges</code></td>
<td>
<p>Whether or not to update ages as part of the MCMC run. Default is FALSE. Changing this to TRUE will improve performance but will fit a slightly invalid model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store_density</code></td>
<td>
<p>Whether or not to store the density and age grid. Useful for plotting the output in other packages</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This model places a Gaussian mixture prior distribution on the calibrated ages and so estimates the density of the overall set of radiocarbon ages. It is designed to be a probabilistic version of the Oxcal SUM command which takes calibrated ages and sums the probability distributions with the aim of estimating activity through age as a proxy.
</p>


<h3>Value</h3>

<p>An object of class <code>BchronDensityRun</code> with the following elements:
</p>

<ul>
<li>
<p>thetaThe posterior samples of the restricted ages
</p>
</li>
<li>
<p>pPosterior samples of the mixture proportions
</p>
</li>
<li>
<p>muValues of the means of each Gaussian mixture
</p>
</li>
<li>
<p>calAgesThe calibrated ages from <code>BchronCalibrate</code>
</p>
</li>
<li>
<p>GThe number of mixture components. Equal to numMix
</p>
</li>
<li>
<p>age_gridA grid of ages used for the final density estimate
</p>
</li>
<li>
<p>densityThe density estimate based on the above age grid
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>Bchronology</code>, <code>BchronRSL</code>, <code>BchronDensityFast</code> for a faster approximate version of this function
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Read in some data from Sluggan Moss
data(Sluggan)

# Run the model
SlugDens &lt;- with(
  Sluggan,
  BchronDensity(
    ages = ages,
    ageSds = ageSds,
    calCurves = calCurves
  )
)

# plot it
plot(SlugDens)

</code></pre>


</div>