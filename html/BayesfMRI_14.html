<div class="container">

<table style="width: 100%;"><tr>
<td>BayesGLM2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Group-level Bayesian GLM</h2>

<h3>Description</h3>

<p>Performs group-level Bayesian GLM estimation and inference using the joint
approach described in Mejia et al. (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BayesGLM2(
  results,
  contrasts = NULL,
  quantiles = NULL,
  excursion_type = NULL,
  contrast_names = NULL,
  gamma = 0,
  alpha = 0.05,
  nsamp_theta = 50,
  nsamp_beta = 100,
  num_cores = NULL,
  verbose = 1
)

BayesGLM_group(
  results,
  contrasts = NULL,
  quantiles = NULL,
  excursion_type = NULL,
  gamma = 0,
  alpha = 0.05,
  nsamp_theta = 50,
  nsamp_beta = 100,
  num_cores = NULL,
  verbose = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Either (1) a length <code class="reqn">N</code> list of <code>"BayesGLM"</code> objects,
or (2) a length <code class="reqn">N</code> character vector of files storing <code>"BayesGLM"</code>
objects saved with <code>saveRDS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>(Optional) A list of contrast vectors that specify the
group-level summaries of interest. If <code>NULL</code>, use contrasts that compute
the average of each field (task HRF) across subjects and sessions.
</p>
<p>Each contrast vector is length <code class="reqn">K * S * N</code> vector specifying a
group-level summary of interest, where <code class="reqn">K</code> is the number
of fields (task HRFs), <code class="reqn">S</code> is the number of sessions, and <code class="reqn">N</code> is the
number of subjects. For a single subject-session the contrast
for the first field would be:
</p>
<p><code>contrast1 &lt;- c(1, rep(0, K-1))</code>
</p>
<p>and so the full contrast vector representing the group average across
sessions and subjects for the first task would be:
</p>
<p><code>rep(rep(contrast1, S), N) /S /N</code>.
</p>
<p>To obtain the group average for the first task, for just the first sessions
from each subject:
</p>
<p><code>rep(c(contrast1, rep(0, K*(S-1))), N) /N</code>.
</p>
<p>To obtain the mean difference between the first and second sessions, for the
first task:
</p>
<p><code>rep(c(contrast1, -contrast1, rep(0, K-2)), N) /N</code>.
</p>
<p>To obtain the mean across sessions of the first task, just for the first
subject:
</p>
<p><code>c(rep(contrast1, S-1), rep(0, K*S*(N-1)) /S</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>(Optional) Vector of posterior quantiles to return in
addition to the posterior mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excursion_type</code></td>
<td>
<p>(For inference only) The type of excursion function for
the contrast ("&gt;", "&lt;", "!="), or a vector thereof (each element
corresponding to one contrast).  If <code>NULL</code>, no inference performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast_names</code></td>
<td>
<p>(Optional) Names of contrasts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>(For inference only) Activation threshold for the excursion set,
or a vector thereof (each element corresponding to one contrast). Default:
<code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(For inference only) Significance level for activation for the
excursion set, or a vector thereof (each element corresponding to one
contrast). Default: <code>.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp_theta</code></td>
<td>
<p>Number of theta values to sample from posterior. Default:
<code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp_beta</code></td>
<td>
<p>Number of beta vectors to sample conditional on each theta
value sampled. Default: <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cores</code></td>
<td>
<p>The number of cores to use for sampling betas in parallel. If
<code>NULL</code> (default), do not run in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should updates be printed? Use <code>1</code> (default) for
occasional updates, <code>2</code> for occasional updates as well as running INLA
in verbose mode (if applicable), or <code>0</code> for no updates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the estimates, PPMs and areas of activation for each contrast.
</p>


<h3>INLA Requirement</h3>

<p>This function requires the <code>INLA</code> package, which is not a CRAN package.
See <a href="https://www.r-inla.org/download-install">https://www.r-inla.org/download-install</a> for easy installation instructions.
</p>


</div>