<div class="container">

<table style="width: 100%;"><tr>
<td>plotAttractors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot state tables or transition graphs of attractors
</h2>

<h3>Description</h3>

<p>Visualizes attractors, either by drawing a table of the involved states in two colors, or by drawing a graph of transitions between the states of the attractor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotAttractors(attractorInfo, 
               subset, 
               title = "", 
               mode = c("table","graph"),
               grouping = list(), 
               plotFixed = TRUE, 
               onColor = "#4daf4a",
               offColor = "#e41a1c",
               layout = layout.circle, 
               drawLabels = TRUE,
               drawLegend = TRUE,
               ask = TRUE,
               reverse = FALSE,
               borderColor = "black",
               eps = 0.1, 
               allInOnePlot = FALSE,
               ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>attractorInfo</code></td>
<td>

<p>An object of class <code>AttractorInfo</code>, as returned by <code>getAttractors</code>, or an object of class <code>SymbolicSimulation</code>, as returned by <code>simulateSymbolicModel</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An subset of attractors to be plotted. This is a vector of attractor indices in <code>attractorInfo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>An optional title for the plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Switches between two kinds of attractor plots. See Details for more information. Default is "table".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code> and specifies a structure to form groups of genes in the plot. This is a list with the following elements: 
</p>

<dl>
<dt>class</dt>
<dd>
<p>A vector of names for the groups. These names will be printed in the region belonging to the group in the plot.</p>
</dd>  	
<dt>index</dt>
<dd>
<p>A list with the same length as <code>class</code>. Each element is a vector of gene names or gene indices belonging to the group.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotFixed</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code>.
If this is true, genes with fixed values are included in the plot. Otherwise, these genes are not drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onColor</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code> and specifies the color value for the 1/ON values in the table. Defaults to green.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offColor</code></td>
<td>
<p>This optional parameter is only used if <code>mode="table"</code> and specifies the color value for the 0/OFF values in the table. Defaults to red.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>If <code>mode="graph"</code>, this parameter specifies a layouting function that determines the placement of the nodes in the graph. Please refer to the <code>layout</code> manual entry in the <span class="pkg">igraph</span> package for further details. By default, the circle layout is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawLabels</code></td>
<td>
<p>This parameter is only relevant if <code>mode="graph"</code>. It determines whether the nodes of the graph are annotated with the corresponding values of the genes in the attractor states.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawLegend</code></td>
<td>
<p>Specifies whether a color key for the ON/OFF states is drawn if <code>mode="table"</code>. Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>

<p>If set to true, the plot function will prompt for a user input for each new plot that is shown on an interactive device (see <code>link{par("ask")}</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>

<p>Specifies the order of the genes in the plot. By default, the first gene is placed in the first row of the plot. If <code>reverse=TRUE</code> (which was the default until <span class="pkg">BoolNet</span> version 2.0.2), the first gene in the network is placed in the bottom row of the plot. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borderColor</code></td>
<td>

<p>Specifies the border or seprating color of states in an attractor. Defaults to <code>"black"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Specifies plotting margin for the sequence of states. Defaults to <code>0.1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allInOnePlot</code></td>
<td>

<p>If this is <code>TRUE</code> then all attractors, with <code>mode = "table"</code>, are plotted in one plot as specified internally by <code>par$mfrow</code> parameter. Previous value of the <code>par$mfrow</code> parameter is preserved. Defaults to <code>FALSE</code>, meaning the plots for more than one attractor will be switched interactively or all plotted in an non-interactive graphical device.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further graphical parameters to be passed to <code>plot.igraph</code> if <code>mode="graph"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function comprises two different types of plots: 
</p>
<p>The "table" mode visualizes the gene values of the states in the attractor and is only suited for synchronous or steady-state attractors. Complex asynchronous attractors are omitted in this mode. Attractors in <code>attractorInfo</code> are first grouped by length. Then, a figure is plotted to the currently selected device for each attractor length (i.e. one plot with all attractors consisting of 1 state, one plot with all attractors consisting of 2 states, etc.). If <code>ask=TRUE</code> and the standard X11 output device is used, the user must confirm that the next plot for the next attractor size should be shown.
The figure is a table with the genes in the rows and the states of the attractors in the columns. Cells of the table are (by default) red for 0/OFF values and green for 1/ON values. If <code>grouping</code> is set, the genes are rearranged according to the indices in the group, horizontal separation lines are plotted between the groups, and the group names are printed.
</p>
<p>The "graph" mode visualizes the transitions between different states. It creates a graph in which the vertices are the states in the attractor and the edges are state transitions among these states. This mode can visualize all kinds of attractors, including complex/loose attractors. One plot is drawn for each attractor. As before, this means that on the standard output device, only the last plot is displayed unless you set <code>par(mfrow=c(...))</code> accordingly.
</p>


<h3>Value</h3>

<p>If <code>mode="table"</code>, a list of matrices corresponding to the tables is returned. Each of these matrices has the genes in the rows and the states of the attractors in the columns.
</p>
<p>If <code>mode="graph"</code>, a list of objects of class <code>igraph</code> is returned. Each of these objects describes the graph for one attractor.
</p>


<h3>See Also</h3>

<p><code>getAttractors</code>, <code>simulateSymbolicModel</code>, <code>attractorsToLaTeX</code>, <code>plotSequence</code>, <code>sequenceToLaTeX</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load example data
data(cellcycle)

# get attractors
attractors &lt;- getAttractors(cellcycle)

# calculate number of different attractor lengths, 
# and plot attractors side by side in "table" mode
par(mfrow=c(1, length(table(sapply(attractors$attractors,
                          function(attractor)
                          {
                            length(attractor$involvedStates)
                          })))))
plotAttractors(attractors)

# plot attractors in "graph" mode
par(mfrow=c(1, length(attractors$attractors)))
plotAttractors(attractors, mode="graph")

# identify asynchronous attractors
attractors &lt;- getAttractors(cellcycle, type="asynchronous")

# plot attractors in "graph" mode
par(mfrow=c(1, length(attractors$attractors)))
plotAttractors(attractors, mode="graph")

## End(Not run)
</code></pre>


</div>