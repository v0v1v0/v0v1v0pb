<div class="container">

<table style="width: 100%;"><tr>
<td>NBS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Network-based statistic for brain MRI data</h2>

<h3>Description</h3>

<p>Calculates the <em>network-based statistic (NBS)</em>, which allows for
family-wise error (FWE) control over network data, introduced for brain MRI
data by Zalesky et al. Requires a three-dimensional array of all subjects'
connectivity matrices and a <code>data.table</code> of covariates, in addition to a
contrast matrix or list. A null distribution of the largest connected
component size is created by fitting a GLM to permuted data. For details, see
<code>GLM</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NBS(A, covars, contrasts, con.type = c("t", "f"), X = NULL,
  con.name = NULL, p.init = 0.001, perm.method = c("freedmanLane",
  "terBraak", "smith", "draperStoneman", "manly", "stillWhite"),
  part.method = c("beckmann", "guttman", "ridgway"), N = 1000,
  perms = NULL, symm.by = c("max", "min", "avg"),
  alternative = c("two.sided", "less", "greater"), long = FALSE, ...)

## S3 method for class 'NBS'
summary(object, contrast = NULL, digits = max(3L,
  getOption("digits") - 2L), ...)

## S3 method for class 'NBS'
nobs(object, ...)

## S3 method for class 'NBS'
terms(x, ...)

## S3 method for class 'NBS'
formula(x, ...)

## S3 method for class 'NBS'
labels(object, ...)

## S3 method for class 'NBS'
case.names(object, ...)

## S3 method for class 'NBS'
variable.names(object, ...)

## S3 method for class 'NBS'
df.residual(object, ...)

## S3 method for class 'NBS'
nregions(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Three-dimensional array of all subjects' connectivity matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>A <code>data.table</code> of covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>Numeric matrix (for T statistics) or list of matrices (for F
statistics) specifying the contrast(s) of interest; if only one contrast is
desired, you can supply a vector (for T statistics)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con.type</code></td>
<td>
<p>Character string; either <code>'t'</code> or <code>'f'</code> (for t or
F-statistics). Default: <code>'t'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric matrix, if you wish to supply your own design matrix.
Ignored if <code>outcome != measure</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con.name</code></td>
<td>
<p>Character vector of the contrast name(s); if <code>contrasts</code>
has row/list names, those will be used for reporting results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.init</code></td>
<td>
<p>Numeric; the initial p-value threshold (default: <code>0.001</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.method</code></td>
<td>
<p>Character string indicating the permutation method.
Default: <code>'freedmanLane'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.method</code></td>
<td>
<p>Character string; the method of partitioning the design
matrix into covariates of interest and nuisance. Default: <code>'beckmann'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Integer; number of permutations to create. Default: <code>5e3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>Matrix of permutations, if you would like to provide your own.
Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symm.by</code></td>
<td>
<p>Character string; how to create symmetric off-diagonal
elements. Default: <code>max</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character string, whether to do a two- or one-sided test.
Default: <code>'two.sided'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>Logical indicating whether or not to return all permutation
results. Default: <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>brainGraph_GLM_design</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>
<p>A <code>NBS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>Integer specifying the contrast to plot/summarize; defaults
to showing results for all contrasts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Integer specifying the number of digits to display for P-values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When printing a <code>summary</code>, you can include arguments to
<code>printCoefmat</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>NBS</code> with some input arguments in addition
to:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removed.subs</code></td>
<td>
<p>Character vector of subject ID's removed due to
incomplete data (if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.mat</code></td>
<td>
<p>3-d array of (symmetric) numeric matrices containing the
statistics for each edge</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.mat</code></td>
<td>
<p>3-d array of (symmetric) numeric matrices containing the
P-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>components</code></td>
<td>
<p>List containing data tables of the observed and permuted
connected component sizes and P-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank,df.residual,qr,cov.unscaled</code></td>
<td>
<p>The rank, residual degrees of
freedom, QR decomposition, and unscaled covariance matrix of the design
matrix</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is assumed that the order of the subjects in <code>covars</code> matches
that of the input array <code>A</code>. You will need to ensure that this is the
case. Prior to <code>v3.0.0</code>, the <code>covars</code> table was sorted by
<code>Study.ID</code> before creating the design matrix.
</p>


<h3>Author(s)</h3>

<p>Christopher G. Watson, <a href="mailto:cgwatson@bu.edu">cgwatson@bu.edu</a>
</p>


<h3>References</h3>

<p>Zalesky, A. and Fornito,  A. and Bullmore, E.T. (2010)
Network-based statistic: identifying differences in brain networks.
<em>NeuroImage</em>, <b>53(4)</b>, 1197â€“1207.
doi: <a href="https://doi.org/10.1016/j.neuroimage.2010.06.041">10.1016/j.neuroimage.2010.06.041</a>
</p>


<h3>See Also</h3>

<p>Other Group analysis functions: <code>Bootstrapping</code>,
<code>GLM</code>, <code>Mediation</code>,
<code>brainGraph_permute</code>, <code>mtpc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
max.comp.nbs &lt;- NBS(A.norm.sub[[1]], covars.dti, N=5e3)

## End(Not run)
</code></pre>


</div>