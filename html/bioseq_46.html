<div class="container">

<table style="width: 100%;"><tr>
<td>seq_detect_pattern</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect the presence of patterns in sequences</h2>

<h3>Description</h3>

<p>Detect the presence of patterns in sequences
</p>


<h3>Usage</h3>

<pre><code class="language-R">seq_detect_pattern(x, pattern, max_error = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a DNA, RNA or AA vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>a DNA, RNA or AA vectors (but same as <code>x</code>)
or a character vector of regular expressions, or a list.
See section Patterns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_error</code></td>
<td>
<p>numeric value ranging from 0 to 1 and giving the
maximum error rate allowed between the target sequence and the pattern.
Error rate is relative to the length of the pattern.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A logical vector.
</p>


<h3>Patterns</h3>

<p>It is important to understand how patterns are treated in <span class="pkg">bioseq</span>.
</p>
<p>Patterns are recycled along the sequences (usually the <code>x</code> argument).
This means that if a pattern (vector or list) is of length &gt; 1, it will be
replicated until it is the same length as <code>x</code>.
The reverse is not true and a vector of patterns longer than
a vector of sequences will raise a warning.
</p>
<p>Patterns can be DNA, RNA or AA vectors
(but they must be from the same class as
the sequences they are matched against).
If patterns are DNA, RNA or AA vectors,
they are disambiguated prior to matching.
For example pattern dna("ARG") will match AAG or AGG.
</p>
<p>Alternatively, patterns can be a simple character vector
containing regular expressions.
</p>
<p>Vectors of patterns (DNA, RNA, AA or regex) can also be provided in a list.
In that case, each vector of the list will be collapsed prior matching,
which means that each vector element will be used as an alternative pattern.
For example pattern list(c("AAA", "CCC"), "GG")
will match AAA or CCC in the first sequence,
GG in the second sequence, AAA or CCC in the third,
and so on following the recycling rule.
</p>
<p>@section Fuzzy matching:
When <code>max_error</code> is greater than zero, the function perform
fuzzy matching. Fuzzy matching does not support regular expression.
</p>


<h3>See Also</h3>

<p><code>stri_detect</code> from <span class="pkg">stringi</span>,
<code>str_detect</code> from <span class="pkg">stringr</span> and
<code>afind</code> from <span class="pkg">stringdist</span>
for the underlying implementation.
</p>
<p>Other string operations: 
<code>seq-replace</code>,
<code>seq_combine()</code>,
<code>seq_count_pattern()</code>,
<code>seq_crop_pattern()</code>,
<code>seq_crop_position()</code>,
<code>seq_extract_pattern()</code>,
<code>seq_extract_position()</code>,
<code>seq_remove_pattern()</code>,
<code>seq_remove_position()</code>,
<code>seq_replace_position()</code>,
<code>seq_split_kmer()</code>,
<code>seq_split_pattern()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- dna(c("ACGTTAGTGTAGCCGT", "CTCGAAATGA"))
seq_detect_pattern(x, dna(c("CCG", "AAA")))

# Regular expression
seq_detect_pattern(x, "^A.{2}T")

# Fuzzy matching
seq_detect_pattern(x, dna("AGG"), max_error = 0.2)
# No match. The pattern has three character, the max_error
# has to be &gt; 1/3 to allow one character difference.

seq_detect_pattern(x, dna("AGG"), max_error = 0.4)
# Match

</code></pre>


</div>