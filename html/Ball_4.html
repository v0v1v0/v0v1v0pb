<div class="container">

<table style="width: 100%;"><tr>
<td>bcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ball Covariance and Correlation Statistics</h2>

<h3>Description</h3>

<p>Computes Ball Covariance and Ball Correlation statistics, 
which are generic dependence measures in Banach spaces.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcor(x, y, distance = FALSE, weight = FALSE)

bcov(x, y, distance = FALSE, weight = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix, data.frame, or a list containing at least two numeric vectors, matrices, or data.frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector, matrix, or data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>if <code>distance = TRUE</code>, the elements of <code>x</code> and <code>y</code> are considered as distance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a logical or character string used to choose the weight form of Ball Covariance statistic.. 
If input is a character string, it must be one of <code>"constant"</code>, <code>"probability"</code>, or <code>"chisquare"</code>. 
Any unambiguous substring can be given. 
If input is a logical value, it is equivalent to <code>weight = "probability"</code> if <code>weight = TRUE</code> while 
equivalent to <code>weight = "constant"</code> if <code>weight = FALSE</code>.
Default: <code>weight = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample sizes of the two variables must agree,  and samples must not contain missing and infinite values. 
If we set <code>distance = TRUE</code>, arguments <code>x</code>, <code>y</code> can be a <code>dist</code> object or a
symmetric numeric matrix recording distance between samples; otherwise, these arguments are treated as data.
</p>
<p><code>bcov</code> and <code>bcor</code> compute Ball Covariance and Ball Correlation statistics.
</p>
<p>Ball Covariance statistics is a generic dependence measure in Banach spaces. It enjoys the following properties: 
</p>

<ul>
<li>
<p> It is nonnegative and it is equal to zero if and only if variables are unassociated; 
</p>
</li>
<li>
<p> It is highly robust;   
</p>
</li>
<li>
<p> It is distribution-free and model-free;   
</p>
</li>
<li>
<p> it is interesting that the HHG is a special case of Ball Covariance statistics. 
</p>
</li>
</ul>
<p>Ball correlation statistics, a normalized version of Ball Covariance statistics, generalizes Pearson correlation in two fundamental ways: 
</p>

<ul>
<li>
<p> It is well-defined for random variables in arbitrary dimension in Banach spaces
</p>
</li>
<li>
<p> BCor is equal to zero implies random variables are unassociated.
</p>
</li>
</ul>
<p>The definitions of the Ball Covariance and Ball Correlation statistics between two random variables are as follows.
Suppose, we are given pairs of independent observations 
<code class="reqn">\{(x_1, y_1),...,(x_n,y_n)\}</code>, where <code class="reqn">x_i</code> and <code class="reqn">y_i</code> can be of any dimension 
and the dimensionality of <code class="reqn">x_i</code> and <code class="reqn">y_i</code> need not be the same.
Then, we define sample version Ball Covariance as:
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{BCov}_{\omega, n}^{2}(X, Y)=\frac{1}{n^{2}}\sum_{i,j=1}^{n}{(\Delta_{ij,n}^{X,Y}-\Delta_{ij,n}^{X}\Delta_{ij,n}^{Y})^{2}} </code>
</p>

<p>where:
</p>
<p style="text-align: center;"><code class="reqn"> \Delta_{ij,n}^{X,Y}=\frac{1}{n}\sum_{k=1}^{n}{\delta_{ij,k}^{X} \delta_{ij,k}^{Y}}, 
\Delta_{ij,n}^{X}=\frac{1}{n}\sum_{k=1}^{n}{\delta_{ij,k}^{X}}, 
\Delta_{ij,n}^{Y}=\frac{1}{n}\sum_{k=1}^{n}{\delta_{ij,k}^{Y}} </code>
</p>

<p style="text-align: center;"><code class="reqn">\delta_{ij,k}^{X} = I(x_{k} \in \bar{B}(x_{i}, \rho(x_{i}, x_{j}))), 
\delta_{ij,k}^{Y} = I(y_{k} \in \bar{B}(y_{i}, \rho(y_{i}, y_{j})))</code>
</p>

<p>Among them, <code class="reqn">\bar{B}(x_{i}, \rho(x_{i}, x_{j}))</code> is a closed ball 
with center <code class="reqn">x_{i}</code> and radius <code class="reqn">\rho(x_{i}, x_{j})</code>.
Similarly, we can define <code class="reqn"> \mathbf{BCov}_{\omega,n}^2(\mathbf{X},\mathbf{X}) </code> 
and <code class="reqn"> \mathbf{BCov}_{\omega,n}^2(\mathbf{Y},\mathbf{Y}) </code>. 
We define Ball Correlation statistic as follows.
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{BCor}_{\omega,n}^2(\mathbf{X},\mathbf{Y})=
\mathbf{BCov}_{\omega,n}^2(\mathbf{X},\mathbf{Y})/\sqrt{\mathbf{BCov}_{\omega,n}^2(\mathbf{X},\mathbf{X})\mathbf{BCov}_{\omega,n}^2(\mathbf{Y},\mathbf{Y})}
</code>
</p>

<p>We can extend <code class="reqn">\mathbf{BCov}_{\omega,n}</code> to measure the mutual independence between <code class="reqn">K</code> random variables:
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n^{2}}\sum_{i,j=1}^{n}{\left[ (\Delta_{ij,n}^{X_{1}, ..., X_{K}}-\prod_{k=1}^{K}\Delta_{ij,n}^{X_{k}})^{2}\prod_{k=1}^{K}{\hat{\omega}_{k}(X_{ki},X_{kj})} \right]}</code>
</p>

<p>where <code class="reqn">X_{k}(k=1,\ldots,K)</code> are random variables and <code class="reqn">X_{ki}</code> is the <code class="reqn">i</code>-th observations of <code class="reqn">X_{k}</code>. 
</p>
<p>See <code>bcov.test</code> for a test of independence based on the Ball Covariance statistic.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bcor </code></td>
<td>
<p> Ball Correlation statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bcov </code></td>
<td>
<p> Ball Covariance statistic.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wenliang Pan, Xueqin Wang, Heping Zhang, Hongtu Zhu &amp; Jin Zhu (2019) Ball Covariance: A Generic Measure of Dependence in Banach Space, Journal of the American Statistical Association, DOI: 10.1080/01621459.2018.1543600
</p>
<p>Wenliang Pan, Xueqin Wang, Weinan Xiao &amp; Hongtu Zhu (2018) A Generic Sure Independence Screening Procedure, Journal of the American Statistical Association, DOI: 10.1080/01621459.2018.1462709
</p>
<p>Jin Zhu, Wenliang Pan, Wei Zheng, and Xueqin Wang (2021). Ball: An R Package for Detecting Distribution Difference and Association in Metric Spaces, Journal of Statistical Software, Vol.97(6), doi: 10.18637/jss.v097.i06.
</p>


<h3>See Also</h3>

<p><code>bcov.test</code>, <code>bcorsis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############# Ball Correlation #############
num &lt;- 50
x &lt;- 1:num
y &lt;- 1:num
bcor(x, y)
bcor(x, y, weight = "prob")
bcor(x, y, weight = "chisq")
############# Ball Covariance #############
num &lt;- 50
x &lt;- rnorm(num)
y &lt;- rnorm(num)
bcov(x, y)
bcov(x, y, weight = "prob")
bcov(x, y, weight = "chisq")
</code></pre>


</div>