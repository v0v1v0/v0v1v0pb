<div class="container">

<table style="width: 100%;"><tr>
<td>bws_stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the test statistic of the Baumgartner-Weiss-Schindler test.</h2>

<h3>Description</h3>

<p>Compute the Baumgartner-Weiss-Schindler test statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bws_stat(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given vectors <code class="reqn">X</code> and <code class="reqn">Y</code>, computes <code class="reqn">B_X</code> and <code class="reqn">B_Y</code> as
described by Baumgartner <em>et al.</em>, returning their average, <code class="reqn">B</code>.
The test statistic approximates the variance-weighted square norm of the
difference in CDFs of the two distributions. For sufficiently large sample
sizes (more than 20, say), under the null the test statistic approaches the asymptotic
value computed in <code>bws_cdf</code>.
</p>
<p>The test value is an approximation of
</p>
<p style="text-align: center;"><code class="reqn">\tilde{B} = \frac{mn}{m+n} \int_0^1 \frac{1}{z(1-z)} \left(F_X(z) - F_Y(z)\right)^2 \mathrm{dz},</code>
</p>

<p>where <code class="reqn">m</code> (<code class="reqn">n</code>) is the number of elements in <code class="reqn">X</code> (<code class="reqn">Y</code>), and
<code class="reqn">F_X(z)</code> (<code class="reqn">F_Y(z)</code>) is the CDF of <code class="reqn">X</code> (<code class="reqn">Y</code>).
</p>
<p>The test statistic is based only on the ranks of the input. If the same
monotonic transform is applied to both vectors, the result should be unchanged.
Moreover, the test is inherently two-sided, so swapping <code class="reqn">X</code> and <code class="reqn">Y</code>
should also leave the test statistic unchanged.
</p>


<h3>Value</h3>

<p>The BWS test statistic, <code class="reqn">B</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>W. Baumgartner, P. Weiss, H. Schindler, 'A nonparametric test for the general two-sample problem', 
Biometrics 54, no. 3 (Sep., 1998): pp. 1129-1135. 
<a href="https://doi.org/10.2307/2533862">doi:10.2307/2533862</a>
</p>


<h3>See Also</h3>

<p><code>bws_cdf</code>, <code>bws_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1234)
x &lt;- runif(1000)
y &lt;- runif(100)
bval &lt;- bws_stat(x,y)
# check a monotonic transform:
ftrans &lt;- function(x) { log(1 + x) }
bval2 &lt;- bws_stat(ftrans(x),ftrans(y))
stopifnot(all.equal(bval,bval2))
# check commutivity
bval3 &lt;- bws_stat(y,x)
stopifnot(all.equal(bval,bval3))

</code></pre>


</div>