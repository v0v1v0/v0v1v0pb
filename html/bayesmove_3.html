<div class="container">

<table style="width: 100%;"><tr>
<td>assign_tseg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add segment numbers to observations</h2>

<h3>Description</h3>

<p>After breakpoints have been extracted for each animal ID, this function
assigns the associated segment number to observations for each animal ID.
These segments of observations will be used in the second stage of the model
framework to perform mixed-membership clustering by Latent Dirichlet
Allocation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">assign_tseg(dat, brkpts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A list where each element stores the data for a unique animal ID.
Each element is a data frame that contains all data associated for a given
animal ID and must include a column labeled <code>time1</code> that numbers each
of the observations in consecutive order. This variable is automatically
generated by the <code>filter_time</code> function during data
preparation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brkpts</code></td>
<td>
<p>A data frame of breakpoints for each animal ID (as generated by
<code>get_breakpts</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame that updates the original data object by including the
segment number associated with each observation in relation to the
extracted breakpoints.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#load data
data(tracks.list)

#subset only first track
tracks.list&lt;- tracks.list[1]

#only retain id and discretized step length (SL) and turning angle (TA) columns
tracks.list2&lt;- purrr::map(tracks.list,
                   subset,
                  select = c(id, SL, TA))


set.seed(1)

# Define model params
alpha&lt;- 1
ngibbs&lt;- 1000
nbins&lt;- c(5,8)

#future::plan(future::multisession)  #run all MCMC chains in parallel
dat.res&lt;- segment_behavior(data = tracks.list2, ngibbs = ngibbs, nbins = nbins,
                           alpha = alpha)


# Determine MAP iteration for selecting breakpoints and store breakpoints
MAP.est&lt;- get_MAP(dat = dat.res$LML, nburn = ngibbs/2)
brkpts&lt;- get_breakpts(dat = dat.res$brkpts, MAP.est = MAP.est)


# Assign track segments to all observations by ID
tracks.seg&lt;- assign_tseg(dat = tracks.list, brkpts = brkpts)


</code></pre>


</div>