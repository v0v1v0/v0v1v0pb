<div class="container">

<table style="width: 100%;"><tr>
<td>balliFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>balliFit</h2>

<h3>Description</h3>

<p>Estimates likelihood and Bartlett correction factor using BALLI algorithm of each gene
</p>


<h3>Usage</h3>

<pre><code class="language-R">balliFit(y_mat, x_mat, tecVar, intVar = 2, full = T, cfault = 0,
  miter = 200, conv = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y_mat</code></td>
<td>
<p>numeric vector containing log-cpm values of each gene and each sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_mat</code></td>
<td>
<p>design matrix with samples in row and covariable(s) to be estimated in column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tecVar</code></td>
<td>
<p>numeric vector containing estimated technical variance of a gene of each sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intVar</code></td>
<td>
<p>numeric vector designating interest variable(s) which is(are) column number(s) of x_mat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>logical value designating full model (TRUE) or reduced model (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfault</code></td>
<td>
<p>initial value of index showing whether converged (0) or not (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miter</code></td>
<td>
<p>maximum number of iteration to converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>threshold for convergence</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>following components are estimated
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>log-likelihoods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>coefficients of interested variable(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>coefficients of nuisance variable(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BCF</code></td>
<td>
<p>Bartlett's correction factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfault</code></td>
<td>
<p>index whether converged or not</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">expr &lt;- data.frame(t(sapply(1:1000,function(x)rnbinom(20,mu=500,size=50))))
group &lt;- c(rep("A",10),rep("B",10))
design &lt;- model.matrix(~group, data = expr)
dge &lt;- DGEList(counts=expr, group=group)
dge &lt;- calcNormFactors(dge)
tV &lt;- tecVarEstim(dge,design)
gtv &lt;- tV$tecVar[1,]
gdat &lt;- data.frame(logcpm=tV$logcpm[1,],design,tecVar=gtv)
gy &lt;- matrix(unlist(gdat[,1]),ncol=1)
gx &lt;- matrix(unlist(gdat[,2:(ncol(gdat)-1)]),ncol=ncol(gdat)-2)
balliFit(y_mat=gy,x_mat=gx,tecVar=gtv,intVar=2,full=TRUE,cfault=0,miter=200,conv=1e-6)
</code></pre>


</div>