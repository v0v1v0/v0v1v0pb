<div class="container">

<table style="width: 100%;"><tr>
<td>assignColorBreaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map macroevolutionary rates to colors</h2>

<h3>Description</h3>

<p>Maps macroevolutionary rates to a set of <code>NCOLORS</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">assignColorBreaks(
  rates,
  NCOLORS = 64,
  spex = "s",
  logcolor = FALSE,
  method = c("linear", "quantile", "jenks"),
  JenksSubset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rates</code></td>
<td>
<p>A numeric vector of phenotypic rates or a list of numeric
vectors of speciation and extinction rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NCOLORS</code></td>
<td>
<p>An integer number of colors to use for the mapping. Larger
numbers do not necessarily result in smoother looking color ramps. The
default is 64 and is probably sufficient for most purposes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spex</code></td>
<td>
<p>A character string. "s" means that speciation rates are used
to make the map, "e" means that extinction rates are used. "netdiv"
means that diversification rates are used. Ignored for <code>BAMM</code>
trait data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logcolor</code></td>
<td>
<p>Logical. Should the natural logarithm of rates be used for
the color map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Determines how the color breaks are created. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JenksSubset</code></td>
<td>
<p>Number of regularly spaced samples to subset from
<code>rates</code>. Only relevant when <code>method = "jenks"</code>. See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method = "quantile"</code> macroevolutionary rates are binned
into <code>NCOLORS+1</code> percentiles and rates in each bin are mapped to
a color determined by the <code>pal</code> argument in <code>plot.bammdata</code>.
Alternatively, if <code>method = "linear"</code> macroevolutionary rates are
binned into <code>NCOLORS+1</code> equal length intervals between the
minimum and maximum. 
</p>
<p>If <code>method = "jenks"</code>, macroevolutionary rates are binned into
<code>NCOLORS+1</code> categories, according to the Jenks natural breaks
classification method. This method is borrowed from the field of
cartography, and seeks to minimize the variance within categories,
while maximizing the variance between categories. 
</p>
<p>The Jenks natural breaks method was ported to C from code found in the classInt R package.
</p>


<h3>Value</h3>

<p>A numeric vector of rate percentiles/intervals.
</p>


<h3>Author(s)</h3>

<p>Mike Grundler, Pascal Title
</p>


<h3>See Also</h3>

<p><code>plot.bammdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin = 0.2, nsamples = 500)

ed &lt;- dtRates(ed, 0.01)
colors &lt;- assignColorBreaks(ed$dtrates$rates, spex="s") #speciation rates
#colors &lt;- assignColorBreaks(ed$dtrates$rates[[1]]) 
#this also works for speciation rates

plot(ed, colorbreaks = colors, spex="s")
colors &lt;- assignColorBreaks(ed$dtrates$rates, spex="netdiv") 
#diversification rates

#colors &lt;- assignColorBreaks(ed$dtrates$rates[[1]] - ed$dtrates$rates[[2]]) 
#this also works for diversification rates

plot(ed, colorbreaks = colors, spex="netdiv")
</code></pre>


</div>