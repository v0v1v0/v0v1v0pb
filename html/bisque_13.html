<div class="container">

<table style="width: 100%;"><tr>
<td>sFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a spatially mean-zero spatial Gaussian process model</h2>

<h3>Description</h3>

<p>Uses a Gibbs sampler to estimate the parameters of a Matern covariance 
function used to model observations from a Gaussian process with mean 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sFit(
  x,
  coords,
  nSamples,
  thin = 1,
  rw.initsd = 0.1,
  inits = list(),
  C = 1,
  alpha = 0.44,
  priors = list(sigmasq = list(a = 2, b = 1), rho = list(L = 0, U = 1), nu = list(L = 0,
    U = 1))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Observation of a spatial Gaussian random field, passed as a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>Spatial coordinates of the observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamples</code></td>
<td>
<p>(thinned) number of MCMC samples to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning to be used within the returned MCMC samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.initsd</code></td>
<td>
<p>initial standard devaition for random walk proposals.  this 
parameter will be adaptively tuned during sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>list of initial parameters for the MCMC chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>scale factor used during tuning of the random walk proposal s.d.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>target acceptance rate for which the random walk proposals 
should optimize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>parameters to specify the prior distributions for the model</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">library(fields)

simulate.field = function(n = 100, range = .3, smoothness = .5, phi = 1){
  # Simulates a mean-zero spatial field on the unit square
  #
  # Parameters:
  #  n - number of spatial locations
  #  range, smoothness, phi - parameters for Matern covariance function
  
  coords = matrix(runif(2*n), ncol=2)
  
  Sigma = Matern(d = as.matrix(dist(coords)), 
                 range = range, smoothness = smoothness, phi = phi)
  
  list(coords = coords,
       params = list(n=n, range=range, smoothness=smoothness, phi=phi),
       x = t(chol(Sigma)) %*%  rnorm(n))
}

# simulate data
x = simulate.field()

# configure gibbs sampler  
it = 100

# run sampler using default posteriors
post.samples = sFit(x = x$x, coords = x$coords, nSamples = it)

# build kriging grid
cseq = seq(0, 1, length.out = 10)
coords.krig = expand.grid(x = cseq, y = cseq)

# sample from posterior predictive distribution
burn = 75
samples.krig = sKrig(x$x, post.samples, coords.krig = coords.krig, burn = burn)
</code></pre>


</div>