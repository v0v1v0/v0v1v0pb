<div class="container">

<table style="width: 100%;"><tr>
<td>moranbi.mc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation test for bivariate Moran's Ixy statistic</h2>

<h3>Description</h3>

<p>A permutation test for bivariate Moran's Ixy statistic calculated by using nsim random permutations of <code>x</code> and <code>y</code> for the given spatial weighting scheme, to establish the rank of the observed statistic in relation to the nsim simulated values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moranbi.mc(varX, varY, listw, nsim, zero.policy=NULL, alternative="greater",
           na.action=na.fail, spChk=NULL, return_boot=FALSE, adjust.n=TRUE, parallel="no",
           ncpus = getOption("boot.ncpus", 1L), cl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>varX</code></td>
<td>
<p>a numeric vector of the variable <code>x</code> the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varY</code></td>
<td>
<p>a numeric vector of the variable <code>y</code> the same length as the neighbours list in listw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of "greater" (default), "two.sided", or "less".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted. <code>na.pass</code> is not permitted because it is meaningless in a permutation test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spChk</code></td>
<td>
<p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code>get.spChkOption()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_boot</code></td>
<td>
<p>return an object of class <code>boot</code> from the equivalent permutation bootstrap rather than an object of class <code>htest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.n</code></td>
<td>
<p>default TRUE, if FALSE the number of observations is not adjusted for no-neighbour observations, if TRUE, the number of observations is adjusted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>The type of parallel operation to be used (if any). If missing, the default is "no". for more details see <code>boot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>integer: number of processes to be used in parallel operation: number of available CPUs. By default it is set to 1 with getOption("boot.ncpus", 1L)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>An optional parallel or snow cluster for use if <code>parallel</code> = "<code>snow</code>". If not supplied, a cluster on the local machine is created for the duration of the <code>boot</code> call (by default is NULL).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with class <code>htest</code> and <code>mc.sim</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the observed bivariate Moran's I.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the rank of the observed bivariate Moran's I.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the pseudo p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string giving the method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data, and the number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>nsim simulated values of statistic, final value is observed statistic</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cliff, A. D., Ord, J. K. 1981 Spatial processes, Pion, p. 63-5.</p>


<h3>See Also</h3>

<p><code>moran.bi</code>, <code>moranbi.test</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(spdep)
data(oldcol)
colw &lt;- nb2listw(COL.nb, style="W")
nsim &lt;- 999
set.seed(123)
sim1 &lt;- moranbi.mc(COL.OLD$CRIME, COL.OLD$INC, listw=colw, nsim=nsim, zero.policy=TRUE)
sim1
mean(sim1$res[1:nsim])
var(sim1$res[1:nsim])
summary(sim1$res[1:nsim])


colold.lags &lt;- nblag(COL.nb, 3)
set.seed(1234)
sim2 &lt;- moranbi.mc(COL.OLD$CRIME, COL.OLD$INC, nb2listw(colold.lags[[2]],style="W"),
                   nsim=nsim, zero.policy=TRUE)
summary(sim2$res[1:nsim])
sim3 &lt;- moranbi.mc(COL.OLD$CRIME, COL.OLD$INC, nb2listw(colold.lags[[3]],style="W"),
                   nsim=nsim, zero.policy=TRUE)
summary(sim3$res[1:nsim])
sim4 &lt;- moranbi.mc(COL.OLD$CRIME, COL.OLD$INC, colw, nsim=nsim, zero.policy=TRUE,
                   return_boot=TRUE,parallel="multicore")
sim4

</code></pre>


</div>