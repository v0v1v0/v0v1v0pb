<div class="container">

<table style="width: 100%;"><tr>
<td>bdgraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>	Search algorithm in graphical models </h2>

<h3>Description</h3>

<p>As the main function of the <span class="pkg">BDgraph</span> package, 
this function consists of several MCMC sampling algorithms for Bayesian model determination in undirected graphical models. 
To speed up the computations, the birth-death MCMC sampling algorithms are implemented in parallel using <span class="pkg">OpenMP</span> in <code>C++</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bdgraph( data, n = NULL, method = "ggm", algorithm = "bdmcmc", iter = 5000, 
         burnin = iter / 2, not.cont = NULL, g.prior = 0.2, df.prior = 3, 
         g.start = "empty", jump = NULL, save = FALSE, 
         cores = NULL, threshold = 1e-8, verbose = TRUE, nu = 1 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>there are two options: (1) an (<code class="reqn">n \times p</code>) <code>matrix</code> or a <code>data.frame</code> corresponding to the data, 
(2) an (<code class="reqn">p \times p</code>) covariance matrix as <code class="reqn">S=X'X</code> which <code class="reqn">X</code> is the data matrix 
(<code class="reqn">n</code> is the sample size and <code class="reqn">p</code> is the number of variables). 
It also could be an object of class "<code>sim</code>", from function <code>bdgraph.sim</code>.
The input matrix is automatically identified by checking the symmetry.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. It is needed if the "<code>data</code>" is a covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character with two options "<code>ggm</code>" (default) and "<code>gcgm</code>". 
Option "<code>ggm</code>" is for Gaussian graphical models based on Gaussianity assumption.
Option "<code>gcgm</code>" is for Gaussian copula graphical models for the data that not follow Gaussianity assumption (e.g. continuous non-Gaussian, count, or mixed dataset).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>

<p>character with two options "<code>bdmcmc</code>" (default) and "<code>rjmcmc</code>". 
Option "<code>bdmcmc</code>" is based on birth-death MCMC algorithm.
Option "<code>rjmcmc</code>" is based on reverible jump MCMC algorithm.
Option "<code>bd-dmh</code>" is based on birth-death MCMC algorithm using double Metropolis Hasting.
Option "<code>rj-dmh</code>" is based on reverible jump MCMC algorithm using double Metropolis Hasting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iteration for the sampling algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of burn-in iteration for the sampling algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>not.cont</code></td>
<td>
<p> for the case <code>method = "gcgm"</code>, a vector with binary values in which <code class="reqn">1</code> indicates not continuous variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.prior</code></td>
<td>

<p>for determining the prior distribution of each edge in the graph. 
There are two options: a single value between <code class="reqn">0</code> and <code class="reqn">1</code> (e.g. <code class="reqn">0.5</code> as a noninformative prior) 
or an (<code class="reqn">p \times p</code>) matrix with elements between <code class="reqn">0</code> and <code class="reqn">1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.prior</code></td>
<td>

<p>degree of freedom for G-Wishart distribution, <code class="reqn">W_G(b,D)</code>, which is a prior distribution of the precision matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.start</code></td>
<td>

<p>corresponds to a starting point of the graph. It could be an (<code class="reqn">p \times p</code>) matrix, "<code>empty</code>" (default), or "<code>full</code>". 
Option "<code>empty</code>" means the initial graph is an empty graph and "<code>full</code>" means a full graph. 
It also could be an object with <code>S3</code> class "<code>bdgraph</code>" of <code>R</code> package <code>BDgraph</code> or the class <code>"ssgraph"</code> of <code>R</code> package <code>ssgraph::ssgraph()</code>; 
this option can be used to run the sampling algorithm from the last objects of previous run (see examples).     
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump</code></td>
<td>

<p>it is only for the BDMCMC algorithm (<code>algorithm</code> = "<code>bdmcmc</code>").
It is for simultaneously updating multiple links at the same time to update graph in the BDMCMC algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>

<p>logical: if FALSE (default), the adjacency matrices are NOT saved. 
If TRUE, the adjacency matrices after burn-in are saved.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p> number of cores to use for parallel execution. 
The case <code>cores</code> = "<code>all</code>" means all CPU cores to use for parallel execution. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p> threshold value for the convergence of sampling algorithm from G-Wishart for the precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> logical: if TRUE (default), report/print the MCMC running time. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> prior parameter for option <code>method</code> = "<code>tgm</code>".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with <code>S3</code> class "<code>bdgraph</code>" is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p_links</code></td>
<td>
<p> upper triangular matrix which corresponds the estimated posterior probabilities of all possible links. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_hat</code></td>
<td>
<p> posterior estimation of the precision matrix. </p>
</td>
</tr>
</table>
<p>For the case "<code>save</code> = <code>TRUE</code>" is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sample_graphs</code></td>
<td>
<p> vector of strings which includes the adjacency matrices of visited graphs after burn-in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph_weights</code></td>
<td>
<p> vector which includes the waiting times of visited graphs after burn-in. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_graphs</code></td>
<td>
<p>vector which includes the identity of the adjacency matrices for all iterations after burn-in. 
It is needed for monitoring the convergence of the BD-MCMC algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_weights</code></td>
<td>
<p>vector which includes the waiting times for all iterations after burn-in. 
It is needed for monitoring the convergence of the BD-MCMC algorithm.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Reza Mohammadi <a href="mailto:a.mohammadi@uva.nl">a.mohammadi@uva.nl</a> and Ernst Wit </p>


<h3>References</h3>

<p>Mohammadi, R. and Wit, E. C. (2019). <span class="pkg">BDgraph</span>: An <code>R</code> Package for Bayesian Structure Learning in Graphical Models, <em>Journal of Statistical Software</em>, 89(3):1-30, <a href="https://doi.org/10.18637/jss.v089.i03">doi:10.18637/jss.v089.i03</a> 
</p>
<p>Mohammadi, A. and Wit, E. C. (2015). Bayesian Structure Learning in Sparse Gaussian Graphical Models, <em>Bayesian Analysis</em>, 10(1):109-138, <a href="https://doi.org/10.1214/14-BA889">doi:10.1214/14-BA889</a>
</p>
<p>Mohammadi, R., Massam, H. and Letac, G. (2023). Accelerating Bayesian Structure Learning in Sparse Gaussian Graphical Models, <em>Journal of the American Statistical Association</em>, <a href="https://doi.org/10.1080/01621459.2021.1996377">doi:10.1080/01621459.2021.1996377</a> 
</p>
<p>Mohammadi, A. et al (2017). Bayesian modelling of Dupuytren disease by using Gaussian copula graphical models, <em>Journal of the Royal Statistical Society: Series C</em>, 66(3):629-645, <a href="https://doi.org/10.1111/rssc.12171">doi:10.1111/rssc.12171</a>
</p>
<p>Dobra, A. and Mohammadi, R. (2018). Loglinear Model Selection and Human Mobility, <em>Annals of Applied Statistics</em>, 12(2):815-845, <a href="https://doi.org/10.1214/18-AOAS1164">doi:10.1214/18-AOAS1164</a>
</p>
<p>Vogels, L., Mohammadi, R., Schoonhoven, M., and Birbil, S.I. (2023) Bayesian Structure Learning in Undirected Gaussian Graphical Models: Literature Review with Empirical Comparison, <em>arXiv preprint</em>, <a href="https://doi.org/10.48550/arXiv.2307.02603">doi:10.48550/arXiv.2307.02603</a>
</p>
<p>Mohammadi, R., Schoonhoven, M., Vogels, L., and Birbil, S.I. (2023) Large-scale Bayesian Structure Learning for Gaussian Graphical Models using Marginal Pseudo-likelihood, <em>arXiv preprint</em>, <a href="https://doi.org/10.48550/arXiv.2307.00127">doi:10.48550/arXiv.2307.00127</a>
</p>
<p>Mohammadi, A. and Dobra A. (2017). The <code>R</code> Package <span class="pkg">BDgraph</span> for Bayesian Structure Learning in Graphical Models, <em>ISBA Bulletin</em>, 24(4):11-16
</p>


<h3>See Also</h3>

 <p><code>bdgraph.mpl</code>, <code>bdgraph.dw</code>, <code>bdgraph.sim</code>, <code>summary.bdgraph</code>, <code>compare</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed( 10 )

# - - Example 1

# Generating multivariate normal data from a 'random' graph
data.sim &lt;- bdgraph.sim( n = 100, p = 10, size = 15, vis = TRUE )
   
bdgraph.obj &lt;- bdgraph( data = data.sim, iter = 1000, save = TRUE )
  
summary( bdgraph.obj )

# Confusion Matrix
conf.mat( actual = data.sim, pred = bdgraph.obj )

conf.mat.plot( actual = data.sim, pred = bdgraph.obj )
   
# To compare our result with true graph
compare( bdgraph.obj, data.sim, main = c( "Target", "BDgraph" ), vis = T )

# Running algorithm with starting points from previous run
bdgraph.obj2 &lt;- bdgraph( data = data.sim, g.start = bdgraph.obj )
    
compare( list( bdgraph.obj, bdgraph.obj2 ), data.sim, 
         main = c( "Target", "Frist run", "Second run" ) )

# - - Example 2

# Generating mixed data from a 'scale-free' graph
data.sim &lt;- bdgraph.sim( n = 200, p = 7, type = "mixed", graph = "scale-free", vis = TRUE )
   
bdgraph.obj &lt;- bdgraph( data = data.sim, method = "gcgm" )
  
summary( bdgraph.obj )
   
compare( bdgraph.obj, data.sim, vis = T )

conf.mat( actual = data.sim, pred = bdgraph.obj )

conf.mat.plot( actual = data.sim, pred = bdgraph.obj )

## End(Not run)	  
</code></pre>


</div>