<div class="container">

<table style="width: 100%;"><tr>
<td>blc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lee-Carter Bayesian Estimation for mortality data</h2>

<h3>Description</h3>

<p>Performs Bayesian estimation of the Lee-Carter model considering different
variances for each age.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blc(Y, prior = NULL, init = NULL, M = 5000, bn = 4000, thin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Log-mortality rates for each age.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A list containing the prior mean <code class="reqn">m_0</code> and the prior
variance <code class="reqn">C_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A list containing initial values for <code class="reqn">\alpha</code>, <code class="reqn">\beta</code>,
<code class="reqn">\phi_V</code>, <code class="reqn">\phi_W</code> and <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of iterations. The default value is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bn</code></td>
<td>
<p>The number of initial iterations from the Gibbs sampler that should be discarded (burn-in). The default value is 4000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>A Positive integer specifying the period for saving samples. The default value is 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">Y_{it}</code> be the log mortality rate at age <code class="reqn">i</code> and time <code class="reqn">t</code>. The Lee-Carter
model is specified as follows:
</p>
<p><code class="reqn">Y_{it} = \alpha_i + \beta_i \kappa_t + \varepsilon_{it}, i=1,...,p</code> and <code class="reqn">t=1,...,T</code>,
</p>
<p>where <code class="reqn">\alpha = (\alpha_1,...,\alpha_p)'</code> are the interept of the model that represent
the log-mortality rate mean in each age; <code class="reqn">\beta = (\beta_1,...,\beta_p)'</code> are the
coefficient regression that represent the speed of relative change in the log-mortality
rate in each age. <code class="reqn">\kappa = (\kappa_1,...,\kappa_T)'</code> are the state variable that
represent the global relative change in log-mortality rate. Finally, <code class="reqn">\varepsilon_{it} ~ N(0, \sigma^2_i)</code>
is the random error.
</p>
<p>For the state variable <code class="reqn">\kappa_t</code> Lee and Carter (1992) proposed a random walk with
drift to govern the dynamics over time:
</p>
<p><code class="reqn">\kappa_t = \kappa_{t-1} + \theta + \omega_t</code>,
</p>
<p>where <code class="reqn">\theta</code> is the drift parameter and <code class="reqn">\omega_t</code> is the random error of the
random walk.
</p>
<p>We implement the Bayesian Lee Carter (BLC) model, proposed by Pedroza (2006), to estimate
the model. In this approach, we take advantage of the fact that the Bayesian Lee Carter
can be specified as dynamic linear model, to estimate the state variables <code class="reqn">\kappa_t</code>
through FFBS algorithm. To estimate the others parameters we use Gibbs sampler to sample
from their respective posterior distribution.
</p>


<h3>Value</h3>

<p>A <code>BLC</code> object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Posterior sample from alpha parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Posterior sample from beta parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiv</code></td>
<td>
<p>Posterior sample from phiv parameter. phiv is the precision of the random error of the Lee Carter model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Posterior sample from theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiw</code></td>
<td>
<p>Posterior sample from phiw. phiw is the precision of the random error of the random walk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Sampling from the state variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Y Log-mortality rates for each age passed by the user to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bn</code></td>
<td>
<p>The warmup of the algorithm specified by the user to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of iterations specified by the user to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>The prior mean of kappa0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0</code></td>
<td>
<p>The prior covariance matrix of kappa0.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lee, R. D., &amp; Carter, L. R. (1992). “Modeling and forecasting US mortality.” <em>Journal of the American statistical association</em>, 87(419), 659-671.
</p>
<p>Pedroza, C. (2006). “A Bayesian forecasting model: predicting US male mortality.” <em>Biostatistics</em>, 7(4), 530-550.
</p>


<h3>See Also</h3>

<p><code>fitted.BLC()</code>, <code>plot.BLC()</code>, <code>print.BLC()</code> and <code>predict.BLC()</code> for <code>BLC</code> methods to native R functions <code>fitted()</code>,
<code>plot()</code>, <code>print()</code> and <code>predict()</code>.
</p>
<p><code>expectancy.BLC()</code> and <code>Heatmap.BLC()</code> for <code>BLC</code> methods to compute and visualise the truncated life expectancy
via <code>expectancy()</code> and <code>Heatmap()</code> functions.
</p>
<p><code>improvement()</code> to compute the improvement of each age, based on the resulting chains of the beta parameter.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example of transforming the dataset to fit the function:

## Importing mortality data from the USA available on the Human Mortality Database (HMD):
data(USA)

## Calculating the mortality rates for the general population:
require(dplyr)
require(tidyr)
require(magrittr)

USA %&gt;% mutate(mx = USA$Dx.Total/USA$Ex.Total) -&gt; data

data %&gt;%
	filter(Age %in% 18:80 &amp; Year %in% 2000:2015)  %&gt;%
	mutate(logmx = log(mx)) %&gt;%
	dplyr::select(Year,Age,logmx) %&gt;%
	pivot_wider(names_from = Year, values_from = logmx) %&gt;%
	dplyr::select(-Age) %&gt;%
	as.matrix()  %&gt;%
	magrittr::set_rownames(18:80) -&gt; Y

## Fitting the model
fit = blc(Y = Y, M = 100, bn = 20)
print(fit)

## Viewing the results
plot(fit, ages = 18:80)
plot(fit, parameter = "beta", ages=18:80)
improvement(fit)

</code></pre>


</div>