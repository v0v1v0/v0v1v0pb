<div class="container">

<table style="width: 100%;"><tr>
<td>ar1_ng</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-Gaussian model with AR(1) latent process</h2>

<h3>Description</h3>

<p>Constructs a simple non-Gaussian model where the state dynamics follow an
AR(1) process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ar1_ng(y, rho, sigma, mu, distribution, phi, u, beta, xreg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector or a <code>ts</code> object of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A prior for autoregressive coefficient.
Should be an object of class <code>bssm_prior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A prior for the standard deviation of noise of the AR-process.
Should be an object of class <code>bssm_prior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A fixed value or a prior for the stationary mean of the latent
AR(1) process. Should be an object of class <code>bssm_prior</code> or scalar
value defining a fixed mean such as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>Distribution of the observed time series. Possible
choices are <code>"poisson"</code>, <code>"binomial"</code>, <code>"gamma"</code>, and
<code>"negative binomial"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Additional parameter relating to the non-Gaussian distribution.
For negative binomial distribution this is the dispersion term, for gamma
distribution this is the shape parameter, and for other distributions this
is ignored. Should an object of class <code>bssm_prior</code> or
a positive scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>A vector of positive constants for non-Gaussian models. For
Poisson, gamma, and negative binomial distribution, this corresponds to the
offset term. For binomial, this is the number of trials.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A prior for the regression coefficients.
Should be an object of class <code>bssm_prior</code> or <code>bssm_prior_list</code>
(in case of multiple coefficients) or missing in case of no covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>A matrix containing covariates with number of rows matching the
length of <code>y</code>. Can also be <code>ts</code>, <code>mts</code> or similar object
convertible to matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>ar1_ng</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">model &lt;- ar1_ng(discoveries, rho = uniform(0.5,-1,1), 
  sigma = halfnormal(0.1, 1), mu = normal(0, 0, 1), 
  distribution = "poisson")
out &lt;- run_mcmc(model, iter = 1e4, mcmc_type = "approx",
  output_type = "summary")
  
ts.plot(cbind(discoveries, exp(out$alphahat)), col = 1:2)

set.seed(1)
n &lt;- 30
phi &lt;- 2
rho &lt;- 0.9
sigma &lt;- 0.1
beta &lt;- 0.5
u &lt;- rexp(n, 0.1)
x &lt;- rnorm(n)
z &lt;- y &lt;- numeric(n)
z[1] &lt;- rnorm(1, 0, sigma / sqrt(1 - rho^2))
y[1] &lt;- rnbinom(1, mu = u * exp(beta * x[1] + z[1]), size = phi)
for(i in 2:n) {
  z[i] &lt;- rnorm(1, rho * z[i - 1], sigma)
  y[i] &lt;- rnbinom(1, mu = u * exp(beta * x[i] + z[i]), size = phi)
}

model &lt;- ar1_ng(y, rho = uniform_prior(0.9, 0, 1), 
  sigma = gamma_prior(0.1, 2, 10), mu = 0., 
  phi = gamma_prior(2, 2, 1), distribution = "negative binomial",
  xreg = x, beta = normal_prior(0.5, 0, 1), u = u)

</code></pre>


</div>