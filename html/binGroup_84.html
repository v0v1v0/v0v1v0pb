<div class="container">

<table style="width: 100%;"><tr>
<td>sim.halving</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation Function for Group Testing Data for the Halving Protocol
</h2>

<h3>Description</h3>

<p>Simulates data in group testing form ready to be fit by <kbd>gtreg.halving</kbd>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.halving(x = NULL, gshape = 20, gscale = 2, par,
     linkf = c("logit", "probit", "cloglog"),
     sample.size, group.size, sens = 1, spec = 1,
     sens.ind = NULL, spec.ind = NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a matrix of user-submitted covariates to simulate the data with, defaults to <kbd>NULL</kbd> in which case a gamma distribution is used to generate the covariates automatically
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gshape</code></td>
<td>

<p>shape parameter of gamma distribution, must be non-negative, set to be 20 by default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gscale</code></td>
<td>

<p>scale parameter of gamma distribution, must be strictly positive, set to be 2 by default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>the true coefficients in the linear predictor 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>

<p>sample size of simulated data 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkf</code></td>
<td>

<p>a character string specifying one of the three link functions to be used: <kbd>"logit"</kbd> (default) or <kbd>"probit"</kbd> or <kbd>"cloglog"</kbd>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.size</code></td>
<td>

<p>group size in pooling individual samples
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens</code></td>
<td>

<p>sensitivity of the group tests, set to be 1 by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>

<p>specificity of the group tests, set to be 1 by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens.ind</code></td>
<td>

<p>sensitivity of the individual retests, set to be equal to <kbd>sens</kbd> if not specified otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.ind</code></td>
<td>

<p>specificity of the individual retests, set to be equal to <kbd>spec</kbd> if not specified otherwise.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><kbd>sim.halving</kbd> generates group testing data for the halving protocol. The covariates are either specified by the <kbd>x</kbd> argument or they are generated from a gamma distribution with a given <kbd>gshape</kbd> and <kbd>gscale</kbd>. The individual probabilities are calculated from the covariates, the coefficients given in <kbd>par</kbd>, and the link function specified through <kbd>linkf</kbd>. The true binary individual responses are then simulated from the individual probabilities. The group, subgroup, and individual retests are simulated using the given <kbd>sens</kbd> and <kbd>spec</kbd> under the halving protocol. 
</p>


<h3>Value</h3>

<p><kbd>sim.halving</kbd> returns a data frame with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gres</code></td>
<td>
<p>the group response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupn</code></td>
<td>
<p>the group number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>
<p>the actual individual response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retest</code></td>
<td>
<p>the results of individual retests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup</code></td>
<td>
<p>the subgroup number</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Boan Zhang
</p>


<h3>See Also</h3>

<p><code>gtreg.halving</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(46)
gt.data &lt;- sim.halving(par = c(-6, .1), gshape = 17, gscale = 1.4,
               sample.size = 5000, group.size = 5,
               sens = 0.95, spec = 0.95)

</code></pre>


</div>