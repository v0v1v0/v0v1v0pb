<div class="container">

<table style="width: 100%;"><tr>
<td>kCompute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use sparse grid quadrature techniques to integrate (unnormalized) densities</h2>

<h3>Description</h3>

<p>This function integrates (unnormalized) densities and may be used to compute
integration constants for unnormalized densities, or to marginalize a 
joint density, for example.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kCompute(
  f,
  init,
  method = "BFGS",
  maxit = 10000,
  level = 2,
  log = FALSE,
  link = NULL,
  linkparams = NULL,
  quadError = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>(Unnormalized) density to integrate.
the function <code class="reqn">f</code> should include an argument <code>log</code>, 
which returns <code class="reqn">log(f(x))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Initial guess for the density's mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to be used to search for the density's mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations <code>optim</code> should use in 
searching for the density's mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>accuracy level (typically number of grid points for the 
underlying 1D quadrature rule) [description from mvQuad::createNIGrid]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>TRUE to return log of integration constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>character vector that specifies transformations used during 
optimization and integration of f(theta2 | X).  while theta2 may be 
defined on arbitrary support, <code>wtdMix</code> performs optimization and 
integration of theta2 on an unconstrained support.  the <code>link</code> 
vector describes the transformations that must be applied to each 
element of theta2.  Jacobian functions for the transformations will 
automatically be added to the optimization and integration routines.
currently supported link functions are 'log', 'logit', and 'identity'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkparams</code></td>
<td>
<p>Optional list of additional parameters  for link functions.
For example, the logit function can be extended to allow mappings to any 
closed interval.  There should be one list entry for each link function.  
Specify NA if no additional arguments are passed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadError</code></td>
<td>
<p>TRUE if integration nodes and weight should be computed for
the <code>level-1</code> integration grid, so that quadrature approximation
error can be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to <code>f</code></p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">kCompute(dgamma, init = 1, shape=2, link='log', level = 5)

</code></pre>


</div>