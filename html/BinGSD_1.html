<div class="container">

<table style="width: 100%;"><tr>
<td>asymcp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional power computation using asymptotic test.</h2>

<h3>Description</h3>

<p>Compute conditional power of single-arm group sequential design with binary endpoint based on asymptotic test, given the interim
result.
</p>


<h3>Usage</h3>

<pre><code class="language-R">asymcp(d, p_1, i, z_i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>An object of the class asymdesign or asymprob.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_1</code></td>
<td>
<p>A scalar or vector representing response rate or probability of success under the alternative hypothesis. The
value(s) should be within (p_0,1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Index of the analysis at which the interim statistic is given. Should be an integer ranges from 1 to K-1. i will be
rounded to its nearest whole value if it is not an integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_i</code></td>
<td>
<p>The interim statistic at analysis i.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Conditional power quantifies the conditional probability of crossing the upper bound given the interim result <code class="reqn">z_i</code>,
<code class="reqn">1\le i&lt;K</code>. Having inherited sample sizes and boundaries from <code>asymdesign</code> or <code>asymprob</code>,
given the interim statistic at <code class="reqn">i</code>th analysis <code class="reqn">z_i</code>, the conditional power is defined as
</p>
<p><code class="reqn">\alpha _{i,K}(p|z_i)=P_{p}(Z_K\ge u_K, Z_{K-1}&gt;l_{K-1}, \ldots, Z_{i+1}&gt;l_{i+1}|Z_i=z_i)</code>
</p>
<p>With asymptotic test, the test
statistic at analysis <code class="reqn">k</code> is
<code class="reqn">Z_k=\hat{\theta}_k\sqrt{n_k/p/(1-p)}=(\sum_{s=1}^{n_k}X_s/n_k-p_0)\sqrt{n_k/p/(1-p)}</code>,
which follows the normal distribution <code class="reqn">N(\theta \sqrt{n_k/p/(1-p)},1)</code>
with <code class="reqn">\theta=p-p_0</code>. In practice, <code class="reqn">p</code> in <code class="reqn">Z_k</code> can be substituted
with the sample response rate <code class="reqn">\sum_{s=1}^{n_k}X_s/n_k</code>.
</p>
<p>The increment statistic <code class="reqn">Z_k\sqrt{n_k/p/(1-p)}-Z_{k-1}\sqrt{n_{k-1}/p/(1-p)}</code> also follows a normal distribution independently
of <code class="reqn">Z_{1}, \ldots, Z_{k-1}</code>. Then the conditional power can be easily obtained using a procedure similar
to that for unconditional boundary crossing probabilities.
</p>


<h3>Value</h3>

<p>A list with the elements as follows:
</p>

<ul>
<li>
<p>K: As in d.
</p>
</li>
<li>
<p>n.I: As in d.
</p>
</li>
<li>
<p>u_K: As in d.
</p>
</li>
<li>
<p>lowerbounds: As in d.
</p>
</li>
<li>
<p>i: i used in computation.
</p>
</li>
<li>
<p>z_i: As input.
</p>
</li>
<li>
<p>cp: A matrix of conditional powers under different response rates.
</p>
</li>
<li>
<p>p_1: As input.
</p>
</li>
<li>
<p>p_0: As input.
</p>
</li>
</ul>
<h3>Reference</h3>


<ul><li>
<p>Alan Genz et al. (2018). mvtnorm: Multivariate Normal and t Distributions. R package version 1.0-11.</p>
</li></ul>
<h3>See Also</h3>

<p><code>asymprob</code>, <code>asymdesign</code>,
<code>exactcp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">I=c(0.2,0.4,0.6,0.8,0.99)
beta=0.2
betaspend=c(0.1,0.2,0.3,0.3,0.2)
alpha=0.05
p_0=0.3
p_1=0.5
K=4.6
tol=1e-6
tt1=asymdesign(I,beta,betaspend,alpha,p_0,p_1,K,tol)
tt2=asymprob(p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),d=tt1)
asymcp(tt1,p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),1,2)
asymcp(tt2,p_1=c(0.4,0.5,0.6,0.7,0.8,0.9),3,2.2)
</code></pre>


</div>