<div class="container">

<table style="width: 100%;"><tr>
<td>rThomasInhom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a realization of Thomas-type cluster point process with complex inhomogeneities</h2>

<h3>Description</h3>

<p>The means to simulate realizations
from the Thomas-type cluster point process with complex
inhomogeneities are provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rThomasInhom(
  kappa,
  alpha,
  omega,
  W,
  W_dil,
  betavec = NULL,
  alphavec = NULL,
  omegavec = NULL,
  z_beta = NULL,
  z_alpha = NULL,
  z_omega = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>intensity or intensity function of the parent process, scalar or pixel image object of class <code>spatstat.geom::im()</code> from the <span class="pkg">spatstat</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>scalar, influences the mean number of points in individual clusters, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>scalar, influences the spread of individual clusters, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>the observation window where the realization is to be generated, in the <br><code>spatstat.geom::owin()</code> format of the <span class="pkg">spatstat</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W_dil</code></td>
<td>
<p>the observation window dilated by the assumed maximal cluster radius, as a binary mask with the same resolution as the covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betavec</code></td>
<td>
<p>vector of parameters describing the dependence of the intensity function of the parent process on covariates in the list <em>z_beta</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphavec</code></td>
<td>
<p>vector of parameters describing the dependence of the mean number of points in a cluster on covariates in the list <em>z_alpha</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omegavec</code></td>
<td>
<p>vector of parameters describing the dependence of the spread of the clusters on covariates in the list <em>z_omega</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_beta</code></td>
<td>
<p>list of covariates describing the intensity function of the parent process, each covariate being a pixel image as used in the <span class="pkg">spatstat</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_alpha</code></td>
<td>
<p>list of covariates describing the location-dependent mean number of points in a cluster, each covariate being a pixel image as used in the <span class="pkg">spatstat</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_omega</code></td>
<td>
<p>list of covariates describing the location-dependent scale of a cluster, each covariate being a pixel image as used in the <span class="pkg">spatstat</span> package.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A realization of a Thomas-type cluster
point process model with possible inhomogeneity
(described by covariates) are produced in any or all of the following model
components: intensity function of the parent process, mean number
of points in a cluster, scale of the clusters.
Model parametrization is described in the documentation to the
function <code>estintp()</code>. The parent process is generated in the dilated
observation window <em>W_dil</em> to avoid edge-effects,
the resulting point pattern is eventually truncated to the smaller
observation window <em>W</em>.
</p>


<h3>Value</h3>

<p>A planar point pattern, object of the type <code>spatstat.geom::ppp()</code>
used in the <span class="pkg">spatstat</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(spatstat)
# Unit square observation window:
W &lt;- owin()

# Dilation of the observation window:
W_dil &lt;- dilation(W, 0.1)
W_dil &lt;- as.mask(W_dil)

# Define covariates:
f1 &lt;- function(x, y) { x }
f2 &lt;- function(x, y) { y }
f3 &lt;- function(x, y) { 1 - (y - 0.5) ^ 2 }
cov1 &lt;- as.im(f1, W = W_dil)
cov2 &lt;- as.im(f2, W = W_dil)
cov3 &lt;- as.im(f3, W = W_dil)


# Stationary Thomas process:
X &lt;- rThomasInhom(kappa = 50, alpha = log(10), omega = log(0.01),
       W = W, W_dil = W_dil)
plot(X)


# Thomas-type cluster process with inhomogeneity in all model components:
X &lt;- rThomasInhom(kappa = 10, betavec = c(1), z_beta = list(cov1),
            alpha = log(10), alphavec = c(1), z_alpha = list(cov2),
            omega = log(0.01), omegavec = c(1), z_omega = list(cov3),
            W = W, W_dil = W_dil)
plot(X)

</code></pre>


</div>