<div class="container">

<table style="width: 100%;"><tr>
<td>pcplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Visualization of batch effects using Principal Component Analysis
</h2>

<h3>Description</h3>

<p>This function performs principal component analysis on the covariate matrix and plots the first two principal components against each other. Different batches are distinguished by different colors and (optionally) the two classes of the target variable by different plot symbols.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcplot(x, batch, y, alpha = 0.35, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>matrix. The covariate matrix. Observations in rows, variables in columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch</code></td>
<td>

<p>factor. Batch variable. Each factor level (or 'category') corresponds to one of the batches. For example, if there are four batches, this variable would have four factor levels and observations with the same factor level would belong to the same batch.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>optional factor. Binary target variable. Has to have two factor levels, where each of them correponds to one of the two classes of the target variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>optional numeric between 0 and 1. Alpha transparency of the contour lines of the batch-specific two-dimensional density estimates. Only applicable when default color scheme (<code>rainbow</code>) is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>plot</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the data corresponding to each batch a two-dimensional kernel density estimate is obtained using the function <code>kde2d()</code> from the <span class="pkg">MASS</span>-package. These estimates are depicted through contour lines (using <code>contour</code>). 
</p>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>Author(s)</h3>

<p>Roman Hornung
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(autism)

par(mfrow=c(1,3))
pcplot(x=X, batch=batch, y=y, alpha=0.25, main="alpha = 0.25")
pcplot(x=X, batch=batch, y=y, alpha=0.75, main="alpha = 0.75")
pcplot(x=X, batch=batch, y=y, col=1:length(unique(batch)), 
  main="col = 1:length(unique(batch))")
par(mfrow=c(1,1))
</code></pre>


</div>