<div class="container">

<table style="width: 100%;"><tr>
<td>tergmprepare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare data structure for TERGM estimation, including composition change</h2>

<h3>Description</h3>

<p>Prepare data structure for TERGM estimation, including composition change.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tergmprepare(formula, offset = TRUE, blockdiag = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>The original formula provided by the user, given the data
structures in the workspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Indicates whether absent nodes should be added where they are
missing (<code>offset = TRUE</code>) or removed where they are not missing
(<code>offset = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockdiag</code></td>
<td>
<p>Should the time steps be arranged in a blockdiagonal matrix
for use with MCMC-MLE or Bayesian estimation (<code>blockdiag = TRUE</code>), or
should they be kept as items in a list for use with <code>btergm</code>
(<code>blockdiag = FALSE</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Report details about dimension adjustment?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a helper function that adjusts the dimensions of networks or
covariates within a given time step to each other by removing nodes that are
not present across all objects within a time step or by adding nodes where
they are missing (and simultaneously adding entries to a list of structural
zero matrices to indicate their absence). It is not necessary to have
identical (numbers of) nodes across time steps as long as the dimensions of
the matrices, networks, and vectors match cross-sectionally within time
steps, given that temporal dependency terms like memory are interpreted as
dyadic covariates in a given time step. This helper function also creates
these dyadic covariate data structures for some of the custom temporal model
terms, such as <code>memory</code> and <code>delrecip</code>. Leifeld, Cranmer and
Desmarais (2018) contain additional details on composition change, dimension
adjustment of matrices, and temporal dependencies. Note that this function
should not normally be used by the end user. It is automatically called
internally by the estimation functions to make the dimensions of all objects
conformable to each other for estimation. Use this function only for
diagnostic purposes!
</p>


<h3>Value</h3>

<p>A list with the following slots:
</p>

<dl>
<dt>lhs.original</dt>
<dd>
<p>A character object containing the original name of the
object on the left-hand side of the formula provided by the user. This is
saved here because the formula is manipulated such that the left-hand
side of the formula contains a new item <code>networks[[i]]</code>.</p>
</dd>
<dt>networks</dt>
<dd>
<p>The list of networks on the left-hand side of the formula
after dimension adjustment, or a blockdiagonal network representing the
left-hand side of the formula after dimension adjustment if argument
<code>blockdiag = TRUE</code> was used.</p>
</dd>
<dt>num.vertices</dt>
<dd>
<p>The maximum number of nodes of any time point after
adjustment of dimensions.</p>
</dd>
<dt>directed</dt>
<dd>
<p>Are the networks directed?</p>
</dd>
<dt>bipartite</dt>
<dd>
<p>Are the networks bipartite?</p>
</dd>
<dt>form</dt>
<dd>
<p>The formula after manipulation and adjustment of the data,
including <code>networks[[i]]</code> on the left-hand side and an added offset
covariate on the right-hand side of the formula, in addition to added
indices for the covariate terms.</p>
</dd>
<dt>time.steps</dt>
<dd>
<p>The number of time steps of the dataset.</p>
</dd>
<dt>rhs.terms</dt>
<dd>
<p>The right-hand side of the formula after adjustment, as
a vector of <code>character</code> objects representing the terms.</p>
</dd>
<dt>covnames</dt>
<dd>
<p>A <code>character</code> vector containing the names of the
objects in which the networks and covariates are stored, according to the
manipulated formula. This includes <code>"networks"</code> (for the left-hand
side of the formula) and all objects containing exogenous covariates on
the right-hand side of the formula after manipulation.</p>
</dd>
<dt>...</dt>
<dd>
<p>Each of the covariates mentioned in the slot <code>covnames</code> is
stored as an element of the list, either as a list of matrices or
networks (if <code>blockdiag = FALSE</code>) or as a matrix or network object
(if <code>blockdiag = TRUE</code>).</p>
</dd>
<dt>auto.adjust</dt>
<dd>
<p>Did the function have to adjust the dimensions of the
networks or covariates at all?</p>
</dd>
<dt>nvertices</dt>
<dd>
<p>A matrix containing the number of nodes in the rows and
columns of each object at each time step, after adjustment.</p>
</dd>
<dt>offsmat</dt>
<dd>
<p>A list of offset covariate matrices or a large blockdiagonal
offset covariate matrix containing structural zeros. If
<code>offset = FALSE</code>, this matrix or list of matrices will contain only
zeros. If <code>offset = TRUE</code>, they will contain ones where nodes were
absent in the original data.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Philip Leifeld
</p>


</div>