<div class="container">

<table style="width: 100%;"><tr>
<td>adj_mat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>adj_mat: Function to compute the adjacency matrix of an area.</h2>

<h3>Description</h3>

<p>Creates an adjacency matrix of an area of interest.
This could be the accessible area (M) of a species or any geographic
region of interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adj_mat(modelsparse, ngbs = 1, eigen_sys = FALSE, which_eigs = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modelsparse</code></td>
<td>
<p>A setA object returned by the function
<code>model2sparse</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngbs</code></td>
<td>
<p>Numeric. Number of neighbors (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen_sys</code></td>
<td>
<p>Logical. If TRUE the eigen analyses of the
adjacency matrix will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_eigs</code></td>
<td>
<p>Numeric. Which eigen value and eigen vector will
be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is a raster object of the area where the dispersal
process will occur.
The number of neighbors depends on the dispersal abilities of the species
and the spatial resolution of the niche model; for example, a species's
with big dispersal abilities will move throughout more than 1 km^2 per day,
so the idea is to give an approximate number of moving neighbors (pixels)
per unit of time.
For more information about see adjacency matrices in the context of
the theory of area of distribution (Soberon and Osorio-Olvera, 2022).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>setM</code> with 7 slots.
The first contains the adjacency matrix. A n x n sparse matrix (n=number of
non-NA cells of the niche model) where connected cells are represented by 1.
The second slot has the adjacency list. It is a list of matrices with four
columns (FromRasCell -from cell ID of the raster-, -to cell ID of the
raster-, -from non-NA cell-, -to non-NA cell-). Other slots contain
information about initial coordinates where dispersal occurs
(initial_points), number of cells used to define the neighborhood (ngbs),
non-NA coordinates (coordinates), and a matrix of eigen vectors (eigen_vec).
</p>


<h3>Author(s)</h3>

<p>Luis Osorio-Olvera &amp; Jorge Soberón
</p>


<h3>References</h3>

<p>Soberón J, Osorio-Olvera L (2023).
“A dynamic theory of the area of distribution.”
<em>Journal of Biogeography6</em>, <b>50</b>, 1037-1048.
<a href="https://doi.org/10.1111/jbi.14587">doi:10.1111/jbi.14587</a>, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/jbi.14587">https://onlinelibrary.wiley.com/doi/abs/10.1111/jbi.14587</a>..
</p>


<h3>Examples</h3>

<pre><code class="language-R">x_coord &lt;- c(-106.5699, -111.3737,-113.9332,
             -110.8913, -106.4262, -106.5699)
y_coord &lt;- c(16.62661, 17.72373, 19.87618,
             22.50763, 21.37728, 16.62661)
xy &lt;- cbind(x_coord, y_coord)
p &lt;- sp::Polygon(xy)
ps &lt;- sp::Polygons(list(p),1)
sps &lt;- sp::SpatialPolygons(list(ps))
mx_grid &lt;- bamm::shape2Grid(sps,resolution = 0.25,ones = TRUE)
mx_sparse &lt;- bamm::model2sparse(model=mx_grid, threshold = 0.1)
adj_mx &lt;- bamm::adj_mat(modelsparse=mx_sparse,
                        ngbs=1,eigen_sys=TRUE,which_eigs=1)
print(adj_mx)
mx_grid_eigen &lt;- mx_grid
mx_grid_eigen[mx_sparse@cellIDs] &lt;- adj_mx@eigen_vec
raster::plot(mx_grid_eigen)

</code></pre>


</div>