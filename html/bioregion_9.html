<div class="container">

<table style="width: 100%;"><tr>
<td>hclu_diana</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Divisive hierarchical clustering based on dissimilarity or beta-diversity</h2>

<h3>Description</h3>

<p>This function computes a divisive hierarchical clustering from a
dissimilarity (beta-diversity) <code>data.frame</code>, calculates the cophenetic correlation
coefficient, and can get clusters from the tree if requested by the user.
The function implements randomization of the dissimilarity matrix to
generate the tree, with a selection method based on the optimal cophenetic
correlation coefficient. Typically, the dissimilarity <code>data.frame</code> is a
<code>bioregion.pairwise.metric</code> object obtained by running <code>similarity</code>
or <code>similarity</code> and then <code>similarity_to_dissimilarity</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hclu_diana(
  dissimilarity,
  index = names(dissimilarity)[3],
  n_clust = NULL,
  cut_height = NULL,
  find_h = TRUE,
  h_max = 1,
  h_min = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dissimilarity</code></td>
<td>
<p>the output object from <code>dissimilarity()</code> or
<code>similarity_to_dissimilarity()</code>, or a <code>dist</code> object.
If a <code>data.frame</code> is used, the first two
columns represent pairs of sites (or any pair of nodes), and the next
column(s) are the dissimilarity indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>name or number of the dissimilarity column to use. By default,
the third column name of <code>dissimilarity</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_clust</code></td>
<td>
<p>an <code>integer</code> or an <code>integer</code> vector indicating the number of
clusters to be obtained from the hierarchical tree, or the output from
partition_metrics. Should not be used at the same time as
<code>cut_height</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_height</code></td>
<td>
<p>a <code>numeric</code> vector indicating the height(s) at which the
tree should be cut. Should not be used at the same time as <code>n_clust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find_h</code></td>
<td>
<p>a <code>boolean</code> indicating if the height of cut should be found for
the requested <code>n_clust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_max</code></td>
<td>
<p>a <code>numeric</code> indicating the maximum possible tree height for
the chosen <code>index</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_min</code></td>
<td>
<p>a <code>numeric</code> indicating the minimum possible height in the tree
for the chosen <code>index</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is based on diana.
Chapter 6 of Kaufman and Rousseeuw (1990) fully details the functioning of
the diana algorithm.
</p>
<p>To find an optimal number of clusters, see <code>partition_metrics()</code>
</p>


<h3>Value</h3>

<p>A <code>list</code> of class <code>bioregion.clusters</code> with five slots:
</p>

<ol>
<li>
<p><strong>name</strong>: <code>character</code> containing the name of the algorithm
</p>
</li>
<li>
<p><strong>args</strong>: <code>list</code> of input arguments as provided by the user
</p>
</li>
<li>
<p><strong>inputs</strong>: <code>list</code> of characteristics of the clustering process
</p>
</li>
<li>
<p><strong>algorithm</strong>: <code>list</code> of all objects associated with the
clustering procedure, such as original cluster objects
</p>
</li>
<li>
<p><strong>clusters</strong>: <code>data.frame</code> containing the clustering results</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>),
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) and
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)
</p>


<h3>References</h3>

<p>Kaufman L, Rousseeuw PJ (2009).
“Finding groups in data: An introduction to cluster analysis.”
In &amp; Sons. JW (ed.), <em>Finding groups in data: An introduction to cluster analysis.</em>.
</p>


<h3>See Also</h3>

<p>cut_tree
</p>


<h3>Examples</h3>

<pre><code class="language-R">comat &lt;- matrix(sample(0:1000, size = 500, replace = TRUE, prob = 1/1:1001),
20, 25)
rownames(comat) &lt;- paste0("Site",1:20)
colnames(comat) &lt;- paste0("Species",1:25)

dissim &lt;- dissimilarity(comat, metric = "all")

data("fishmat")
fishdissim &lt;- dissimilarity(fishmat)
fish_diana &lt;- hclu_diana(fishdissim, index = "Simpson")


</code></pre>


</div>