<div class="container">

<table style="width: 100%;"><tr>
<td>posterior.predictive3D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior predictive density on the simplex, for three-dimensional extreme value  models.</h2>

<h3>Description</h3>

<p>Computes an approximation of the predictive density based on a  posterior parameters sample. Only allowed in the three-dimensional case.
</p>


<h3>Usage</h3>

<pre><code class="language-R">posterior.predictive3D(
  post.sample,
  densityGrid,
  from = post.sample$Nbin + 1,
  to = post.sample$Nsim,
  thin = 40,
  npoints = 40,
  eps = 10^(-3),
  equi = T,
  displ = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>post.sample</code></td>
<td>
<p>A posterior sample as returned by <code>posteriorMCMC</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>densityGrid</code></td>
<td>
<p>A function returning a <code>npoints*npoints</code>
matrix, representing a discretized version of the spectral density
on the two dimensional simplex.
The function should be compatible with <code>dgridplot</code>.
In particular, it must  use <code>discretize</code> to produce
the discretization grid. It must be of type  <br><code>function(par, npoints, eps, equi, displ,invisible,
... )</code>.
See <b>Details</b> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>Integer or <code>NULL</code>. If <code>NULL</code>, the default value is used. Otherwise,  should be greater than <code>post.sample$Nbin</code>. Indicates the  index where the averaging process should start. Default to <code>post.sample$Nbin +1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Integer or <code>NULL</code>. If <code>NULL</code>, the default
value is used. Otherwise, must be lower than <code>Nsim+1</code>.
Indicates  where the averaging process should stop.
Default to <code>post.sample$Nsim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>The number of grid nodes on the squared grid containing the desired triangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Positive number:  minimum
distance from any node inside the simplex to  the simplex boundary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equi</code></td>
<td>
<p>logical. Is the simplex represented as an equilateral triangle (if <code>TRUE</code>) or a right triangle (if <code>FALSE</code>) ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displ</code></td>
<td>
<p>logical. Should a plot be produced ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional graphical parameters and arguments to be passed
to <code>contour</code>  and <code>image</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The posterior predictive density is approximated by averaging the
densities produced by the function
<code>densityGrid(par, npoints, eps, equi, displ,invisible, ...)</code> for
<code>par</code> in a  subset of  the parameters sample stored in
<code>post.sample</code>. The arguments of <code>densityGrid</code> must be
</p>

<ul>
<li> <p><code>par</code>:  A vector containing the parameters.
</p>
</li>
<li> <p><code>npoints, eps, equi</code>: Discretization parameters
to be passed to  <code>dgridplot</code>.
</p>
</li>
<li> <p><code>displ</code>:  logical. Should a plot be produced ?
</p>
</li>
<li> <p><code>invisible</code>: logical. Should the result be returned as <code>invisible</code> ?
</p>
</li>
<li> <p><code>...</code> additional arguments to be passed to
<code>dgridplot</code>
</p>
</li>
</ul>
<p>Only a sub-sample is used: one out of <code>thin</code> parameters is used
(thinning). Further, only the parameters produced between time
<code>from</code> and time <code>to</code> (included) are kept.
</p>


<h3>Value</h3>

<p>A <code>npoints*npoints</code> matrix: the posterior predictive density.
</p>


<h3>Note</h3>

<p>The computational burden may be high: it is proportional to
<code>npoints^2</code>. Therefore, the function assigned to
<code>densityGridplot</code> should be
optimized, typically by calling <code>.C</code> with an internal,
user defined <code>C</code> function.
</p>


<h3>Author(s)</h3>

<p>Anne Sabourin
</p>


<h3>See Also</h3>

<p><code>dgridplot</code>,  <code>posteriorMCMC</code>.
</p>


</div>