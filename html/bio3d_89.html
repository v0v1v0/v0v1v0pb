<div class="container">

<table style="width: 100%;"><tr>
<td>dccm.pca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Dynamical Cross-Correlation Matrix from Principal Component Analysis </h2>

<h3>Description</h3>

<p>Calculate the cross-correlation matrix from principal component analysis (PCA).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pca'
dccm(x, pc = NULL, method = c("pearson", "lmi"), ncore = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an object of class <code>pca</code> as obtained from
function <code>pca.xyz</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p> numerical, indices of PCs to be included in the calculation.
If all negative, PCs complementary to <code>abs(pc)</code> are included. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> method to calculate the cross-correlation. Currently supports
Pearson and linear mutual information (LMI). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>
<p> number of CPU cores used to do the calculation.
By default (<code>ncore = NULL</code>), use all available cores detected. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional arguments to be passed (currently ignored). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the cross-correlation matrix from principal 
component analysis (PCA) obtained from <code>pca.xyz</code> of a set of protein
structures. It is an alternative way to calculate correlation in addition
to the conventional way from xyz coordinates directly. But, in this new 
way one can freely chooses the PCs to be included in the 
calculation (e.g. for filtering out PCs with small eigenvalues).
</p>


<h3>Value</h3>

<p>Returns a cross-correlation matrix with values in a range from -1 to 1 (Pearson)
or from 0 to 1 (LMI).
</p>


<h3>Author(s)</h3>

<p> Xin-Qiu Yao</p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695â€“2696.
</p>


<h3>See Also</h3>

 <p><code>pca.xyz</code>, <code>plot.dccm</code>, <code>dccm</code>, 
<code>dccm.xyz</code>, <code>dccm.nma</code>, <code>dccm.enma</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

##-- Read example trajectory file
trtfile &lt;- system.file("examples/hivp.dcd", package="bio3d")
trj &lt;- read.dcd(trtfile)

## Read the starting PDB file to determine atom correspondence
pdbfile &lt;- system.file("examples/hivp.pdb", package="bio3d")
pdb &lt;- read.pdb(pdbfile)

## Select residues 24 to 27 and 85 to 90 in both chains
inds &lt;- atom.select(pdb, resno=c(24:27,85:90), elety='CA')

## lsq fit of trj on pdb
xyz &lt;- fit.xyz(pdb$xyz, trj, fixed.inds=inds$xyz, mobile.inds=inds$xyz)

## Do PCA
pca &lt;- pca.xyz(xyz)

## DCCM: only use first 10 PCs
cij &lt;- dccm(pca, pc = c(1:10))

## Plot DCCM
plot(cij)

## DCCM: remove first 10 PCs
cij &lt;- dccm(pca, pc = -c(1:10))

## Plot DCCM
plot(cij)


</code></pre>


</div>