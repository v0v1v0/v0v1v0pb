<div class="container">

<table style="width: 100%;"><tr>
<td>rmnlIndepMetrop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC Algorithm for Multinomial Logit Model</h2>

<h3>Description</h3>

<p><code>rmnlIndepMetrop</code> implements Independence Metropolis algorithm for the multinomial logit (MNL) model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmnlIndepMetrop(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(y, X, p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(A, betabar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint, nu)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p>y <code class="reqn">\sim</code> MNL(X, <code class="reqn">\beta</code>) <br><code class="reqn">Pr(y=j) = exp(x_j'\beta)/\sum_k{e^{x_k'\beta}}</code>
</p>
<p><code class="reqn">\beta</code> <code class="reqn">\sim</code> <code class="reqn">N(betabar, A^{-1})</code>
</p>



<h4>Argument Details</h4>

<p><em><code>Data  = list(y, X, p)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>y:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n x 1</code> vector of multinomial outcomes (1, ..., p) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>X:       </code> </td>
<td style="text-align: left;"> <code class="reqn">n*p x k</code> matrix </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>p:       </code> </td>
<td style="text-align: left;"> number of alternatives
  </td>
</tr>
</table>
<p><em><code>Prior = list(A, betabar)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>A:       </code> </td>
<td style="text-align: left;"> <code class="reqn">k x k</code> prior precision matrix (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>betabar: </code> </td>
<td style="text-align: left;"> <code class="reqn">k x 1</code> prior mean (def: 0)
  </td>
</tr>
</table>
<p><em><code>Mcmc = list(R, keep, nprint, nu)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:       </code> </td>
<td style="text-align: left;"> number of MCMC draws </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:    </code> </td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint:  </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nu:      </code> </td>
<td style="text-align: left;"> d.f. parameter for independent t density (def: 6)
  </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betadraw </code></td>
<td>
<p><code class="reqn">R/keep x k</code> matrix of beta draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglike  </code></td>
<td>
<p><code class="reqn">R/keep x 1</code> vector of log-likelihood values evaluated at each draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acceptr  </code></td>
<td>
<p>acceptance rate of Metropolis draws</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Rossi, Anderson School, UCLA, <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p>For further discussion, see Chapter 3, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>See Also</h3>

 <p><code>rhierMnlRwMixture</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=2000} else {R=10}
set.seed(66)

simmnl = function(p, n, beta) {
  ## note: create X array with 2 alt.spec vars
    k = length(beta)
    X1 = matrix(runif(n*p,min=-1,max=1), ncol=p)
    X2 = matrix(runif(n*p,min=-1,max=1), ncol=p)
    X = createX(p, na=2, nd=NULL, Xd=NULL, Xa=cbind(X1,X2), base=1)
    Xbeta = X%*%beta 
  ## now do probs
    p = nrow(Xbeta) / n
    Xbeta = matrix(Xbeta, byrow=TRUE, ncol=p)
    Prob = exp(Xbeta)
    iota = c(rep(1,p))
    denom = Prob%*%iota
    Prob = Prob / as.vector(denom)
  ## draw y
    y = vector("double",n)
    ind = 1:p
    for (i in 1:n) { 
      yvec = rmultinom(1, 1, Prob[i,])
      y[i] = ind%*%yvec 
    }
  return(list(y=y, X=X, beta=beta, prob=Prob))
}

n = 200
p = 3
beta = c(1, -1, 1.5, 0.5)

simout = simmnl(p,n,beta)

Data1 = list(y=simout$y, X=simout$X, p=p)
Mcmc1 = list(R=R, keep=1)

out = rmnlIndepMetrop(Data=Data1, Mcmc=Mcmc1)

cat("Summary of beta draws", fill=TRUE)
summary(out$betadraw, tvalues=beta)

## plotting examples
if(0){plot(out$betadraw)}
</code></pre>


</div>