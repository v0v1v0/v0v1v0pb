<div class="container">

<table style="width: 100%;"><tr>
<td>atom2mass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Atom Names/Types to Mass Converter </h2>

<h3>Description</h3>

<p>Convert atom names/types into atomic masses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">atom2mass(...)
## Default S3 method:
atom2mass(x, mass.custom=NULL, elety.custom=NULL,
                            grpby=NULL, rescue=TRUE, ...) 
## S3 method for class 'pdb'
atom2mass(pdb, inds=NULL, mass.custom=NULL,
                        elety.custom=NULL, grpby=NULL, rescue=TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a character vector containing atom names/types to be
converted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass.custom</code></td>
<td>
<p> a customized data.frame containing atomic symbols
and corresponding masses. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elety.custom</code></td>
<td>
<p> a customized data.frame containing atom
names/types and corresponding atomic symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grpby</code></td>
<td>
<p>a ‘factor’, as returned by <code>as.factor</code>, used
to group the atoms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescue</code></td>
<td>
<p> logical, if TRUE the atomic symbols will be mapped to
the first character of the atom names/types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> an object of class ‘pdb’ for which <code>elety</code> will
be converted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds</code></td>
<td>
<p> an object of class ‘select’ indicating a subset of
the <code>pdb</code> object to be used (see <code>atom.select</code> and
<code>trim.pdb</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default method first convert atom names/types into atomic symbols
using the <code>atom2ele</code> function. Then, atomic symbols are
searched in the <code>elements</code> data set and their corresponding masses
are returned. If <code>mass.custom</code> is specified it is combined with
<code>elements</code> (using <code>rbind</code>) before searching. Therefore,
<code>mass.custom</code> must have columns named <code>symb</code> and <code>mass</code>
(see examples). If <code>grpby</code> is specified masses are splitted (using
<code>split</code>) to compute the mass of groups of atoms defined by
<code>grpby</code>. 
</p>
<p>The S3 method for object of class ‘pdb’, pass
<code>pdb$atom$elety</code> to the default method. 
</p>


<h3>Value</h3>

<p>Return a numeric vector of masses.</p>


<h3>Author(s)</h3>

<p>Julien Ide, Lars Skjaerven</p>


<h3>See Also</h3>

<p><code>elements</code>, <code>atom.index</code>,
<code>atom2ele</code>, <code>read.pdb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">atom.names &lt;- c("CA", "O", "N", "OXT")
atom2mass(atom.names)


# PDB server connection required - testing excluded

## Get atomic symbols from a PDB object with a customized data set
pdb &lt;- read.pdb("3RE0", verbose=FALSE)
inds &lt;- atom.select(pdb, resno=201, verbose=FALSE)

## selected atoms
print(pdb$atom$elety[inds$atom])

## default will map CL2 to C
atom2mass(pdb, inds)

## map element CL2 correctly to Cl
myelety  &lt;- data.frame(name = c("CL2","PT1","N1","N2"), symb = c("Cl","Pt","N","N"))
atom2mass(pdb, inds, elety.custom = myelety)

## custom masses
mymasses &lt;- data.frame(symb = c("Cl","Pt"), mass = c(35.45, 195.08))
atom2mass(pdb, inds, elety.custom = myelety, mass.custom = mymasses)


</code></pre>


</div>