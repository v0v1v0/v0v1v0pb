<div class="container">

<table style="width: 100%;"><tr>
<td>.J_RJMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RJMCMC (with Bayesian Borrowing)</h2>

<h3>Description</h3>

<p>Metropolis-Hastings Green Reversible Jump move, with Bayesian 
Borrowing
</p>


<h3>Usage</h3>

<pre><code class="language-R">.J_RJMCMC(
  df_hist,
  df_curr,
  Y,
  Y_0,
  I,
  I_0,
  X,
  X_0,
  lambda,
  lambda_0,
  beta,
  beta_0,
  mu,
  sigma2,
  tau,
  s,
  J,
  Jmax,
  bp,
  bp_0,
  clam_smooth,
  a_tau = NULL,
  b_tau = NULL,
  c_tau = NULL,
  d_tau = NULL,
  type,
  p_0 = NULL,
  phi,
  pi_b,
  maxSj
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df_hist</code></td>
<td>
<p>data_frame containing historical data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_curr</code></td>
<td>
<p>data_frame containing current trial data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_0</code></td>
<td>
<p>historical data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>censoring indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I_0</code></td>
<td>
<p>historical trial censoring indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_0</code></td>
<td>
<p>historical trial design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_0</code></td>
<td>
<p>historical trial baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>current trial parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_0</code></td>
<td>
<p>historical trial parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>prior mean for baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>prior variance hyperparameter for baseline hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>borrowing parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>split point locations, J + 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>number of split points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jmax</code></td>
<td>
<p>maximum number of split points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bp</code></td>
<td>
<p>number of covariates in current trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bp_0</code></td>
<td>
<p>number of covariates in historical trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clam_smooth</code></td>
<td>
<p>neighbor interactions, in range (0, 1), for ICAR update.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_tau</code></td>
<td>
<p>tau hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_tau</code></td>
<td>
<p>tau hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_tau</code></td>
<td>
<p>tau hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_tau</code></td>
<td>
<p>tau hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>choice of borrowing, "mix", "uni", or any other string for 
borrowing on every baseline hazard without mixture.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_0</code></td>
<td>
<p>mixture ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>J hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_b</code></td>
<td>
<p>probability of birth move.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxSj</code></td>
<td>
<p>maximal time point, either current or historic.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list of proposed J and s, with adjusted values of lambda, lambda_0, 
tau, Sigma_s, and data_frames for historical and current trial data.
</p>


</div>