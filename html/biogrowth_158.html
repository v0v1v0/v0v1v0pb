<div class="container">

<table style="width: 100%;"><tr>
<td>predict_growth_uncertainty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Isothermal growth with parameter uncertainty</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Simulation of microbial growth considering uncertianty in the model parameters.
Calculations are based on
Monte Carlo simulations, considering the parameters follow a multivariate normal
distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_growth_uncertainty(
  model_name,
  times,
  n_sims,
  pars,
  corr_matrix = diag(nrow(pars)),
  check = TRUE,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model_name</code></td>
<td>
<p>Character describing the primary growth model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Numeric vector of storage times for the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sims</code></td>
<td>
<p>Number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>A tibble describing the parameter uncertainty (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr_matrix</code></td>
<td>
<p>Correlation matrix of the model parameters. Defined in the
same order as in <code>pars</code>. An identity matrix by default
(uncorrelated parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Whether to do some tests. <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The distributions of the model parameters are
defined in the <code>pars</code> argument using a tibble with 4 columns:
</p>

<ul>
<li>
<p>par: identifier of the model parameter (according to <code>primary_model_data()</code>),
</p>
</li>
<li>
<p>mean: mean value of the model parameter.,
</p>
</li>
<li>
<p>sd: standard deviation of the model parameter.,
</p>
</li>
<li>
<p>scale: scale at which the model parameter is defined. Valid values are
'original' (no transformation), 'sqrt' square root or 'log' log-scale. The
parameter sample is generated considering the parameter follows a marginal
normal distribution at this scale, and is later converted to the original scale
for calculations.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An instance of <code>GrowthUncertainty()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Definition of the simulation settings

my_model &lt;- "Baranyi"
my_times &lt;- seq(0, 30, length = 100)
n_sims &lt;- 3000

library(tibble)

pars &lt;- tribble(
    ~par, ~mean, ~sd, ~scale,
    "logN0", 0, .2, "original",
    "mu", 2, .3, "sqrt",
    "lambda", 4, .4, "sqrt",
    "logNmax", 6, .5, "original"
)

## Calling the function

stoc_growth &lt;- predict_growth_uncertainty(my_model, my_times, n_sims, pars)

## We can plot the results

plot(stoc_growth)

## Adding parameter correlation

my_cor &lt;- matrix(c(1,   0,   0, 0,
    0,   1, 0.7, 0,
    0, 0.7,   1, 0,
    0,   0,   0, 1),
    nrow = 4)

stoc_growth2 &lt;- predict_growth_uncertainty(my_model, my_times, n_sims, pars, my_cor)

plot(stoc_growth2)

## The time_to_size function can calculate the median growth curve to reach a size

time_to_size(stoc_growth, 4)

## Or the distribution of times

dist &lt;- time_to_size(stoc_growth, 4, type = "distribution")
plot(dist)




</code></pre>


</div>