<div class="container">

<table style="width: 100%;"><tr>
<td>bvar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Vector Autoregression Objects</h2>

<h3>Description</h3>

<p><code>bvar</code> is used to create objects of class <code>"bvar"</code>.
</p>
<p>A plot function for objects of class <code>"bvar"</code>.
</p>
<p>Forecasting a Bayesian VAR object of class <code>"bvar"</code> with credible bands.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bvar(
  data = NULL,
  exogen = NULL,
  y,
  x = NULL,
  A0 = NULL,
  A = NULL,
  B = NULL,
  C = NULL,
  Sigma = NULL
)

## S3 method for class 'bvar'
plot(x, ci = 0.95, type = "hist", ...)

## S3 method for class 'bvar'
predict(object, ..., n.ahead = 10, new_x = NULL, new_d = NULL, ci = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the original time-series object of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>the original time-series object of unmodelled variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a time-series object of endogenous variables with <code class="reqn">T</code> observations,
usually, a result of a call to <code>gen_var</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"bvar"</code>, usually, a result of a call to <code>draw_posterior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0</code></td>
<td>
<p>either a <code class="reqn">K^2 \times S</code> matrix of MCMC coefficient draws of structural parameters or
a named list, where element <code>coeffs</code> contains a <code class="reqn">K^2 \times S</code> matrix of MCMC coefficient
draws of structural parameters and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed. For time varying parameter models
the coefficient matrix must be <code class="reqn">TK^2 \times S</code>. Draws of the error covariance matrix of the state
equation can be provided as a <code class="reqn">K^2 \times S</code> matrix in an additional list element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>either a <code class="reqn">pK^2 \times S</code> matrix of MCMC coefficient draws of lagged endogenous variables or
a named list, where element <code>coeffs</code> contains a <code class="reqn">pK^2 \times S</code> matrix of MCMC coefficient draws
of lagged endogenous variables and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed. For time varying parameter models
the coefficient matrix must be <code class="reqn">pTK^2 \times S</code>. Draws of the error covariance matrix of the state
equation can be provided as a <code class="reqn">pK^2 \times S</code> matrix in an additional list element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>either a <code class="reqn">((1 + s)MK) \times S</code> matrix of MCMC coefficient draws of unmodelled, non-deterministic variables
or a named list, where element <code>coeffs</code> contains a <code class="reqn">((1 + s)MK) \times S</code> matrix of MCMC coefficient draws of
unmodelled, non-deterministic variables and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed. For time varying parameter models
the coefficient matrix must be <code class="reqn">(1 + s)TMK \times S</code>. Draws of the error covariance matrix of the state
equation can be provided as a <code class="reqn">(1 + s)MK \times S</code> matrix in an additional list element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>either a <code class="reqn">KN \times S</code> matrix of MCMC coefficient draws of deterministic terms or
a named list, where element <code>coeffs</code> contains a <code class="reqn">KN \times S</code> matrix of MCMC coefficient draws of
deterministic terms and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed. For time varying parameter models
the coefficient matrix must be <code class="reqn">TKN \times S</code>. Draws of the error covariance matrix of the state
equation can be provided as a <code class="reqn">KN \times S</code> matrix in an additional list element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>a <code class="reqn">K^2 \times S</code> matrix of MCMC draws for the error variance-covariance matrix or
a named list, where element <code>coeffs</code> contains a <code class="reqn">K^2 \times S</code> matrix of MCMC draws for the
error variance-covariance matrix and element <code>lambda</code> contains the corresponding draws of inclusion
parameters in case variable selection algorithms were employed to the covariances. For time varying parameter models
the coefficient matrix must be <code class="reqn">TK^2 \times S</code>. Draws of the error covariance matrix of the state
equation can be provided as a <code class="reqn">K^2 \times S</code> matrix in an additional list element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a numeric between 0 and 1 specifying the probability mass covered by the
credible intervals. Defaults to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>either <code>"hist"</code> (default) for histograms, <code>"trace"</code> for a trace plot
or <code>"boxplot"</code> for a boxplot. Only used for parameter draws of constant coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"bvar"</code>, usually, a result of a call to
<code>bvar</code> or <code>bvec_to_bvar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ahead</code></td>
<td>
<p>number of steps ahead at which to predict.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_x</code></td>
<td>
<p>an object of class <code>ts</code> of new non-deterministic, exogenous variables.
The object must have the same frequency as the time series in <code>object[["x"]]</code> and must contain
at least all necessary observations for the predicted period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_d</code></td>
<td>
<p>a matrix of new deterministic variables. Must have <code>n.ahead</code> rows.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the VARX model
</p>
<p style="text-align: center;"><code class="reqn">A_0 y_t = \sum_{i = 1}^{p} A_i y_{t-i} + \sum_{i = 0}^{s} B_i x_{t - i} + C d_t + u_t</code>
</p>

<p>the function collects the S draws of a Gibbs sampler (after the burn-in phase) in a standardised object,
where <code class="reqn">y_t</code> is a K-dimensional vector of endogenous variables,
<code class="reqn">A_0</code> is a <code class="reqn">K \times K</code> matrix of structural coefficients.
<code class="reqn">A_i</code> is a <code class="reqn">K \times K</code> coefficient matrix of lagged endogenous variabels.
<code class="reqn">x_t</code> is an M-dimensional vector of unmodelled, non-deterministic variables
and <code class="reqn">B_i</code> its corresponding coefficient matrix.
<code class="reqn">d_t</code> is an N-dimensional vector of deterministic terms
and <code class="reqn">C</code> its corresponding coefficient matrix.
<code class="reqn">u_t</code> is an error term with <code class="reqn">u_t \sim N(0, \Sigma_u)</code>.
</p>
<p>For time varying parameter and stochastic volatility models the respective coefficients and
error covariance matrix of the above model are assumed to be time varying, respectively.
</p>
<p>The draws of the different coefficient matrices provided in <code>A0</code>, <code>A</code>,
<code>B</code>, <code>C</code> and <code>Sigma</code> have to correspond to the same MCMC iterations.
</p>
<p>For the VAR model
</p>
<p style="text-align: center;"><code class="reqn">A_0 y_t = \sum_{i = 1}^{p} A_{i} y_{t-i} + \sum_{i = 0}^{s} B_{i} x_{t-i} + C D_t + u_t,</code>
</p>

<p>with <code class="reqn">u_t \sim N(0, \Sigma)</code> the function produces <code>n.ahead</code> forecasts.
</p>


<h3>Value</h3>

<p>An object of class <code>"bvar"</code> containing the following components, if specified:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the original time-series object of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>the original time-series object of unmodelled variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code class="reqn">K \times T</code> matrix of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code class="reqn">(pK + (1+s)M + N) \times T</code> matrix of regressor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of coefficient draws of structural parameters. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0_lambda</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of inclusion parameters for structural parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0_sigma</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of the error covariance matrices of the structural parameters in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>an <code class="reqn">S \times pK^2</code> "mcmc" object of coefficient draws of lagged endogenous variables. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A_lambda</code></td>
<td>
<p>an <code class="reqn">S \times pK^2</code> "mcmc" object of inclusion parameters for lagged endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A_sigma</code></td>
<td>
<p>an <code class="reqn">S \times pK^2</code> "mcmc" object of the error covariance matrices of coefficients of lagged endogenous variables in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>an <code class="reqn">S \times ((1 + s)MK)</code> "mcmc" object of coefficient draws of unmodelled, non-deterministic variables. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_lambda</code></td>
<td>
<p>an <code class="reqn">S \times ((1 + s)MK)</code> "mcmc" object of inclusion parameters for unmodelled, non-deterministic variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_sigma</code></td>
<td>
<p>an <code class="reqn">S \times ((1 + s)MK)</code> "mcmc" object of the error covariance matrices of coefficients of unmodelled, non-deterministic variables in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>an <code class="reqn">S \times NK</code> "mcmc" object of coefficient draws of deterministic terms. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_lambda</code></td>
<td>
<p>an <code class="reqn">S \times NK</code> "mcmc" object of inclusion parameters for deterministic terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_sigma</code></td>
<td>
<p>an <code class="reqn">S \times NK</code> "mcmc" object of the error covariance matrices of coefficients of deterministic terms in a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of variance-covariance draws. In case of time varying parameters a list of such objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_lambda</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of inclusion parameters for error covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma_sigma</code></td>
<td>
<p>an <code class="reqn">S \times K^2</code> "mcmc" object of the error covariance matrices of the coefficients of the error covariance matrix of the measurement equation of a model with time varying parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specifications</code></td>
<td>
<p>a list containing information on the model specification.</p>
</td>
</tr>
</table>
<p>A time-series object of class <code>"bvarprd"</code>.
</p>


<h3>References</h3>

<p>Lütkepohl, H. (2006). <em>New introduction to multiple time series analysis</em> (2nd ed.). Berlin: Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Get data
data("e1")
e1 &lt;- diff(log(e1))
e1 &lt;- window(e1, end = c(1978, 4))

# Generate model data
data &lt;- gen_var(e1, p = 2, deterministic = "const")

# Add priors
model &lt;- add_priors(data,
                    coef = list(v_i = 0, v_i_det = 0),
                    sigma = list(df = 0, scale = .00001))

# Set RNG seed for reproducibility 
set.seed(1234567)

iterations &lt;- 400 # Number of iterations of the Gibbs sampler
# Chosen number of iterations and burnin should be much higher.
burnin &lt;- 100 # Number of burn-in draws
draws &lt;- iterations + burnin # Total number of MCMC draws

y &lt;- t(model$data$Y)
x &lt;- t(model$data$Z)
tt &lt;- ncol(y) # Number of observations
k &lt;- nrow(y) # Number of endogenous variables
m &lt;- k * nrow(x) # Number of estimated coefficients

# Priors
a_mu_prior &lt;- model$priors$coefficients$mu # Vector of prior parameter means
a_v_i_prior &lt;- model$priors$coefficients$v_i # Inverse of the prior covariance matrix

u_sigma_df_prior &lt;- model$priors$sigma$df # Prior degrees of freedom
u_sigma_scale_prior &lt;- model$priors$sigma$scale # Prior covariance matrix
u_sigma_df_post &lt;- tt + u_sigma_df_prior # Posterior degrees of freedom

# Initial values
u_sigma_i &lt;- diag(1 / .00001, k)

# Data containers for posterior draws
draws_a &lt;- matrix(NA, m, iterations)
draws_sigma &lt;- matrix(NA, k^2, iterations)

# Start Gibbs sampler
for (draw in 1:draws) {
 # Draw conditional mean parameters
 a &lt;- post_normal(y, x, u_sigma_i, a_mu_prior, a_v_i_prior)

 # Draw variance-covariance matrix
 u &lt;- y - matrix(a, k) %*% x # Obtain residuals
 u_sigma_scale_post &lt;- solve(u_sigma_scale_prior + tcrossprod(u))
 u_sigma_i &lt;- matrix(rWishart(1, u_sigma_df_post, u_sigma_scale_post)[,, 1], k)

 # Store draws
 if (draw &gt; burnin) {
  draws_a[, draw - burnin] &lt;- a
  draws_sigma[, draw - burnin] &lt;- solve(u_sigma_i)
 }
}

# Generate bvar object
bvar_est &lt;- bvar(y = model$data$Y, x = model$data$Z,
                 A = draws_a[1:18,], C = draws_a[19:21, ],
                 Sigma = draws_sigma)
                 

# Load data 
data("e1")
e1 &lt;- diff(log(e1)) * 100

# Generate model
model &lt;- gen_var(e1, p = 1, deterministic = 2,
                 iterations = 100, burnin = 10)
# Chosen number of iterations and burn-in should be much higher.

# Add priors
model &lt;- add_priors(model)

# Obtain posterior draws
object &lt;- draw_posterior(model)

# Plot draws
plot(object)


# Load data
data("e1")
e1 &lt;- diff(log(e1)) * 100
e1 &lt;- window(e1, end = c(1978, 4))

# Generate model data
model &lt;- gen_var(e1, p = 0, deterministic = "const",
                 iterations = 100, burnin = 10)
# Chosen number of iterations and burnin should be much higher.

# Add prior specifications
model &lt;- add_priors(model)

# Obtain posterior draws
object &lt;- draw_posterior(model)

# Generate forecasts
bvar_pred &lt;- predict(object, n.ahead = 10, new_d = rep(1, 10))

# Plot forecasts
plot(bvar_pred)

</code></pre>


</div>