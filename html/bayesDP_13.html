<div class="container">

<table style="width: 100%;"><tr>
<td>bdpnormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Discount Prior: Gaussian mean values</h2>

<h3>Description</h3>

<p><code>bdpnormal</code> is used for estimating posterior samples from a
Gaussian outcome where an informative prior is used. The prior weight
is determined using a discount function. This code is modeled after
the methodologies developed in Haddad et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bdpnormal(
  mu_t = NULL,
  sigma_t = NULL,
  N_t = NULL,
  mu0_t = NULL,
  sigma0_t = NULL,
  N0_t = NULL,
  mu_c = NULL,
  sigma_c = NULL,
  N_c = NULL,
  mu0_c = NULL,
  sigma0_c = NULL,
  N0_c = NULL,
  discount_function = "identity",
  alpha_max = 1,
  fix_alpha = FALSE,
  weibull_scale = 0.135,
  weibull_shape = 3,
  number_mcmc = 10000,
  method = "mc",
  compare = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu_t</code></td>
<td>
<p>scalar. Mean of the current treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_t</code></td>
<td>
<p>scalar. Standard deviation of the current treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_t</code></td>
<td>
<p>scalar. Number of observations of the current treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0_t</code></td>
<td>
<p>scalar. Mean of the historical treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0_t</code></td>
<td>
<p>scalar. Standard deviation of the historical treatment
group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N0_t</code></td>
<td>
<p>scalar. Number of observations of the historical treatment
group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_c</code></td>
<td>
<p>scalar. Mean of the current control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_c</code></td>
<td>
<p>scalar. Standard deviation of the current control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_c</code></td>
<td>
<p>scalar. Number of observations of the current control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0_c</code></td>
<td>
<p>scalar. Mean of the historical control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0_c</code></td>
<td>
<p>scalar. Standard deviation of the historical control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N0_c</code></td>
<td>
<p>scalar. Number of observations of the historical control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales
the output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is "<code>identity</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1. For a two-arm trial, users may specify a vector of two values
where the first value is used to weight the historical treatment group and
the second value is used to weight the historical control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_alpha</code></td>
<td>
<p>logical. Fix alpha at alpha_max? Default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = "identity".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = "identity".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_mcmc</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations. Default is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character. Analysis method with respect to estimation of the weight
paramter alpha. Default method "<code>mc</code>" estimates alpha for each
Monte Carlo iteration. Alternate value "<code>fixed</code>" estimates alpha once
and holds it fixed throughout the analysis.  See the the
<code>bdpnormal</code> vignette <br><code>vignette("bdpnormal-vignette", package="bayesDP")</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compare</code></td>
<td>
<p>logical. Should a comparison object be included in the fit?
For a one-arm analysis, the comparison object is simply the posterior
chain of the treatment group parameter. For a two-arm analysis, the comparison
object is the posterior chain of the treatment effect that compares treatment and
control. If <code>compare=TRUE</code>, the comparison object is accessible in the
<code>final</code> slot, else the <code>final</code> slot is <code>NULL</code>. Default is
<code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bdpnormal</code> uses a two-stage approach for determining the
strength of historical data in estimation of a mean outcome. In the first stage,
a <em>discount function</em> is used that that defines the maximum strength of the
historical data and discounts based on disagreement with the current data.
Disagreement between current and historical data is determined by stochastically
comparing the respective posterior distributions under noninformative priors.
With Gaussian data, the comparison is the proability (<code>p</code>) that the current
mean is less than the historical mean. The comparison metric <code>p</code> is then
input into the discount function and the final strength of the
historical data is returned (alpha).
</p>
<p>In the second stage, posterior estimation is performed where the discount
function parameter, <code>alpha</code>, is used incorporated in all posterior
estimation procedures.
</p>
<p>To carry out a single arm (OPC) analysis, data for the current treatment
(<code>mu_t</code>, <code>sigma_t</code>, and <code>N_t</code>) and historical treatment
(<code>mu0_t</code>, <code>sigma0_t</code>, and <code>N0_t</code>) must be input. The results
are then based on the posterior distribution of the current data augmented
by the historical data.
</p>
<p>To carry our a two-arm (RCT) analysis, data for the current treatment and
at least one of current or historical control data must be input.
The results are then based on the posterior distribution of the difference
between current treatment and control, augmented by available historical data.
</p>
<p>For more details, see the <code>bdpnormal</code> vignette: <br><code>vignette("bdpnormal-vignette", package="bayesDP")</code>
</p>


<h3>Value</h3>

<p><code>bdpnormal</code> returns an object of class "bdpnormal". The
functions <code>summary</code> and
<code>print</code> are used to obtain and print
a summary of the results, including user inputs. The
<code>plot</code> function displays visual
outputs as well.
</p>
<p>An object of class <code>bdpnormal</code> is a list containing at least
the following components:
</p>

<dl>
<dt><code>posterior_treatment</code></dt>
<dd>
<p>list. Entries contain values related to the treatment group:</p>
</dd>
</dl>
<ul>
<li>
<p><code>alpha_discount</code>
numeric. Alpha value, the weighting parameter of the historical data.
</p>
</li>
<li>
<p><code>p_hat</code>
numeric. The posterior probability of the stochastic comparison
between the current and historical data.
</p>
</li>
<li>
<p><code>posterior_mu</code>
vector. A vector of length <code>number_mcmc</code> containing the posterior
mean of the treatment group. If historical treatment data is present,
the posterior incorporates the weighted historical data.
</p>
</li>
<li>
<p><code>posterior_sigma2</code>
vector. A vector of length <code>number_mcmc</code> containing the posterior
variance of the treatment group. If historical treatment data is present,
the posterior incorporates the weighted historical data.
</p>
</li>
<li>
<p><code>posterior_flat_mu</code>
vector. A vector of length <code>number_mcmc</code> containing
Monte Carlo samples of the mean of the current treatment group
under a flat/non-informative prior, i.e., no incorporation of the
historical data.
</p>
</li>
<li>
<p><code>posterior_flat_sigma2</code>
vector. A vector of length <code>number_mcmc</code> containing
Monte Carlo samples of the standard deviation of the current treatment group
under a flat/non-informative prior, i.e., no incorporation of the
historical data.
</p>
</li>
<li>
<p><code>prior_mu</code>
vector. If historical treatment data is present, a vector of length
<code>number_mcmc</code> containing Monte Carlo samples of the mean
of the historical treatment group under a flat/non-informative prior.
</p>
</li>
<li>
<p><code>prior_sigma2</code>
vector. If historical treatment data is present, a vector of length
<code>number_mcmc</code> containing Monte Carlo samples of the standard deviation
of the historical treatment group under a flat/non-informative prior.
</p>
</li>
</ul>
<dl>
<dt><code>posterior_control</code></dt>
<dd>
<p>list. Similar entries as <code>posterior_treament</code>. Only present if a
control group is specified.
</p>
</dd>
<dt><code>final</code></dt>
<dd>
<p>list. Contains the final comparison object, dependent on the analysis type:</p>
</dd>
</dl>
<ul>
<li>
<p>One-arm analysis:
vector. Posterior chain of the mean.
</p>
</li>
<li>
<p>Two-arm analysis:
vector. Posterior chain of the mean difference comparing treatment and
control groups.
</p>
</li>
</ul>
<dl>
<dt><code>args1</code></dt>
<dd>
<p>list. Entries contain user inputs. In addition, the following elements
are ouput:</p>
</dd>
</dl>
<ul>
<li>
<p><code>arm2</code>
binary indicator. Used internally to indicate one-arm or two-arm
analysis.
</p>
</li>
<li>
<p><code>intent</code>
character. Denotes current/historical status of treatment and
control groups.
</p>
</li>
</ul>
<h3>References</h3>

<p>Haddad, T., Himes, A., Thompson, L., Irony, T., Nair, R. MDIC Computer
Modeling and Simulation working group.(2017) Incorporation of stochastic
engineering models as prior information in Bayesian medical device trials.
<em>Journal of Biopharmaceutical Statistics</em>, 1-15.
</p>


<h3>See Also</h3>

<p><code>summary</code>,
<code>print</code>,
and <code>plot</code> for details of each of the
supported methods.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># One-arm trial (OPC) example
fit &lt;- bdpnormal(
  mu_t = 30, sigma_t = 10, N_t = 50,
  mu0_t = 32, sigma0_t = 10, N0_t = 50,
  method = "fixed"
)
summary(fit)
## Not run: 
plot(fit)

## End(Not run)

# Two-arm (RCT) example
fit2 &lt;- bdpnormal(
  mu_t = 30, sigma_t = 10, N_t = 50,
  mu0_t = 32, sigma0_t = 10, N0_t = 50,
  mu_c = 25, sigma_c = 10, N_c = 50,
  mu0_c = 25, sigma0_c = 10, N0_c = 50,
  method = "fixed"
)
summary(fit2)
## Not run: 
plot(fit2)

## End(Not run)

</code></pre>


</div>