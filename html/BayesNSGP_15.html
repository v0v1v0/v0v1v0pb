<div class="container">

<table style="width: 100%;"><tr>
<td>nsCrosscorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a nonstationary Matern cross-correlation matrix</h2>

<h3>Description</h3>

<p><code>nsCrosscorr</code> calculates a nonstationary cross-correlation matrix 
between two fixed sets of locations (a prediction set with M locations, and
the observed set with N locations), based on vectors of the unique anisotropy 
parameters for each station. Since the correlation function uses a 
spatially-varying Mahalanobis distance, this function requires coordinate-
specific distance matrices (see below). The function is coded as a 
<code>nimbleFunction</code> (see the <code>nimble</code> package) but can also be 
used as a regular R function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nsCrosscorr(
  Xdist1_sq,
  Xdist2_sq,
  Xdist12,
  Sigma11,
  Sigma22,
  Sigma12,
  PSigma11,
  PSigma22,
  PSigma12,
  nu,
  d
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xdist1_sq</code></td>
<td>
<p>M x N matrix; contains values of pairwise squared cross-distances
in the x-coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xdist2_sq</code></td>
<td>
<p>M x N matrix; contains values of pairwise squared cross-distances
in the y-coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xdist12</code></td>
<td>
<p>M x N matrix; contains values of pairwise signed cross/cross-
distances between the x- and y-coordinates. The sign of each element is
important; see <code>nsDist</code> function for the details of this calculation.
in the x-coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma11</code></td>
<td>
<p>Vector of length N; contains the 1-1 element of the 
anisotropy process for each observed location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma22</code></td>
<td>
<p>Vector of length N; contains the 2-2 element of the 
anisotropy process for each observed location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma12</code></td>
<td>
<p>Vector of length N; contains the 1-2 element of the 
anisotropy process for each observed location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSigma11</code></td>
<td>
<p>Vector of length N; contains the 1-1 element of the 
anisotropy process for each prediction location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSigma22</code></td>
<td>
<p>Vector of length N; contains the 2-2 element of the 
anisotropy process for each prediction location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSigma12</code></td>
<td>
<p>Vector of length N; contains the 1-2 element of the 
anisotropy process for each prediction location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Scalar; Matern smoothness parameter. <code>nu = 0.5</code> corresponds 
to the Exponential correlation; <code>nu = Inf</code> corresponds to the Gaussian
correlation function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Scalar; dimension of the spatial domain.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A M x N cross-correlation matrix for two fixed sets of stations and 
fixed parameter values.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some coordinates and parameters
coords &lt;- cbind(runif(100),runif(100))
Sigma11 &lt;- rep(1, 100) # Identity anisotropy process
Sigma22 &lt;- rep(1, 100)
Sigma12 &lt;- rep(0, 100)
Pcoords &lt;- cbind(runif(200),runif(200))
PSigma11 &lt;- rep(1, 200) # Identity anisotropy process
PSigma22 &lt;- rep(1, 200)
PSigma12 &lt;- rep(0, 200)
nu &lt;- 2
# Calculate distances
Xdist_list &lt;- nsCrossdist(coords, Pcoords)
# Calculate the correlation matrix
XcorMat &lt;- nsCrosscorr(Xdist_list$dist1_sq, Xdist_list$dist2_sq, Xdist_list$dist12,
   Sigma11, Sigma22, Sigma12, PSigma11, PSigma22, PSigma12, nu, ncol(coords))

</code></pre>


</div>