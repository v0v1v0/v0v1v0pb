<div class="container">

<table style="width: 100%;"><tr>
<td>buildBetweenGenerations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Process Generation Connections</h2>

<h3>Description</h3>

<p>This function processes connections between each two generations in a pedigree simulation.
It marks individuals as parents, sons, or daughters based on their generational position and relationships.
The function also handles the assignment of couple IDs, manages single and coupled individuals,
and establishes parent-offspring links across generations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">buildBetweenGenerations(
  df_Fam,
  Ngen,
  sizeGens,
  verbose,
  marR,
  sexR,
  kpc,
  rd_kpc
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df_Fam</code></td>
<td>
<p>A data frame containing the simulated pedigree information up to the current generation.
Must include columns for family ID, individual ID, generation number, spouse ID (spID),
and sex. This data frame is updated in place to include flags for parental status (ifparent),
son status (ifson), and daughter status (ifdau), as well as couple IDs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ngen</code></td>
<td>
<p>Number of generations. An integer &gt;= 2 that determines how many generations the simulated pedigree will have. The first generation is always a fertilized couple. The last generation has no mated individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeGens</code></td>
<td>
<p>A numeric vector containing the sizes of each generation within the pedigree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical  If TRUE, print progress through stages of algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marR</code></td>
<td>
<p>Mating rate. A numeric value ranging from 0 to 1 which determines the proportion of mated (fertilized) couples in the pedigree within each generation. For instance, marR = 0.5 suggests 50 percent of the offspring in a specific generation will be mated and have their offspring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sexR</code></td>
<td>
<p>Sex ratio of offspring. A numeric value ranging from 0 to 1 that determines the proportion of males in all offspring in this pedigree. For instance, 0.4 means 40 percent of the offspring will be male.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kpc</code></td>
<td>
<p>Number of kids per couple. An integer &gt;= 2 that determines how many kids each fertilized mated couple will have in the pedigree. Default value is 3. Returns an error when kpc equals 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rd_kpc</code></td>
<td>
<p>logical. If TRUE, the number of kids per mate will be randomly generated from a poisson distribution with mean kpc. If FALSE, the number of kids per mate will be fixed at kpc.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function iterates through each generation, starting from the second, to establish connections based on mating and parentage.
For the first generation, it sets the parental status directly. For subsequent generations, it calculates the number of couples,
the expected number of offspring, and assigns offspring to parents. It handles gender-based assignments for sons and daughters,
and deals with the nuances of single individuals and couple formation. The function relies on external functions 'assignCoupleIds'
and 'adjustKidsPerCouple' to handle specific tasks related to couple ID assignment and offspring number adjustments, respectively.
</p>


<h3>Value</h3>

<p>The function updates the 'df_Fam' data frame in place, adding or modifying columns related to parental and offspring status,
as well as assigning unique couple IDs. It does not return a value explicitly.
</p>


</div>