<div class="container">

<table style="width: 100%;"><tr>
<td>average_predictions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Average over counterfactual predictions</h2>

<h3>Description</h3>

<p><code>average_predictions()</code> averages counterfactual predictions stored within
a <code>glm</code> object. This is pivotal for estimating treatment contrasts and
associated variance estimates using g-computation. The function assumes
predictions are generated via <code>predict_counterfactuals()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">average_predictions(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted <code>glm</code> object augmented with
counterfactual predictions named: <code>counterfactual.predictions</code></p>
</td>
</tr></table>
<h3>Details</h3>

<p>The <code>average_predictions()</code> function calculates the average over the
counterfactual predictions which can then be used to estimate a treatment
contrast and associated variance estimate.
</p>
<p>The function appends a <code>glm</code> object with the
averaged counterfactual predictions.
</p>
<p>Note: Ensure that the <code>glm</code> object has been adequately prepared with
<code>predict_counterfactuals()</code> before applying <code>average_predictions()</code>.
Failure to do so may result in errors indicating missing components.
</p>


<h3>Value</h3>

<p>an updated <code>glm</code> object appended with an additional component
<code>counterfactual.means</code>.
</p>


<h3>See Also</h3>

<p><code>predict_counterfactuals()</code> for generating counterfactual
predictions.
</p>
<p><code>estimate_varcov()</code> for estimating the variance-covariate matrix
of mariginal effects
</p>
<p><code>get_marginal_effect()</code> for estimating marginal effects directly
from an original <code>glm</code> object
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Use the trial01 dataset
data(trial01)

# ensure the treatment indicator is a factor
trial01$trtp &lt;- factor(trial01$trtp)

# fit glm model for trial data
fit1 &lt;- glm(aval ~ trtp + bl_cov, family = "binomial", data = trial01)

# Preprocess fit1 as required by average_predictions
fit2 &lt;- fit1 |&gt;
  predict_counterfactuals(trt = "trtp")

# average over the counterfactual predictions
fit3 &lt;- average_predictions(fit2)

# display the average predictions
fit3$counterfactual.means

</code></pre>


</div>