<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc_bite</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC algorithm</h2>

<h3>Description</h3>

<p>Implements Markov chain Monte Carlo sampling for trait evolution models
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc_bite(model, log.file = "bite_mcmc.log", sampling.freq = 1000,
  print.freq = 1000, ncat = 1, beta.param = 0.3, ngen = 5e+06,
  burnin = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of class "jive" or other objects from the bite package (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.file</code></td>
<td>
<p>name of the output file that will store the log of MCMC chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling.freq</code></td>
<td>
<p>sampling frequency of the MCMC chain (how often chain will be saved into output file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.freq</code></td>
<td>
<p>printing frequency of the MCMC chain (how often chain will be printed in the R console). Setting it to 0 will suppress every printed message</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncat</code></td>
<td>
<p>number of classes for thermodynamic integration (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.param</code></td>
<td>
<p>beta value to define classes for thermodynamic integration (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>number of generation in MCMC chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>a burning phase of MCMC chain (has to be specified for thermodynamic integration)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function runs MCMC sampling on jive object <code>make_jive</code> or objects describing other models of the bite package.
The jive object contains both the dataset and set of model to be used in MCMC. This function implements both a conventional MCMC
and an MCMC with thermodynamic integration. The latter option is turned off by default and can be changed by
setting ncat to values &gt; 1. The recommended ncat for TI is 10. When setting ncat &gt; 1, make sure to specify burning.
As a rule of thumb set burning to 1/10 fraction of ngen.
</p>


<h3>Value</h3>

<p>Generates a log file in the users filespace at the path defined by log.file
</p>


<h3>Author(s)</h3>

<p>Theo Gaboriau, Anna Kostikova, Daniele Silvestro, and Simon Joly
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Load test data
 data(Anolis_traits)
 data(Anolis_tree)
 data(Anolis_map)
 
 ## Run a simple MCMC chain
 set.seed(300)
 my.jive &lt;- make_jive(phy = Anolis_tree, traits = Anolis_traits[,-3],
  model.priors = list(mean = "BM", logvar= c("OU", "root")))
 bite_ex &lt;- tempdir()
 logfile &lt;- sprintf("%s/my.jive_mcmc.log", bite_ex)
 mcmc_bite(model = my.jive, log.file=logfile,
 sampling.freq=10, print.freq=0, ngen=1000) 
  
 ## Run an MCMC chain with thermodynamic integration
 logfile &lt;- sprintf("%s/my.jive_mcmc_TI.log", bite_ex)
 mcmc_bite(my.jive, log.file=logfile, ncat=10, 
  sampling.freq=10, print.freq=100, ngen=1000, burnin=10) 
</code></pre>


</div>