<div class="container">

<table style="width: 100%;"><tr>
<td>bvec_to_bvar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform a VEC Model to a VAR in Levels</h2>

<h3>Description</h3>

<p>An object of class <code>"bvec"</code> is transformed to a VAR in level representation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bvec_to_bvar(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"bvec"</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>An object of class <code>"bvar"</code>.
</p>


<h3>References</h3>

<p>LÃ¼tkepohl, H. (2006). <em>New introduction to multiple time series analysis</em> (2nd ed.). Berlin: Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load data
data("e6")

# Generate model
data &lt;- gen_vec(e6, p = 4, r = 1, const = "unrestricted", season = "unrestricted")

# Obtain data matrices
y &lt;- t(data$data$Y)
w &lt;- t(data$data$W)
x &lt;- t(data$data$X)

# Reset random number generator for reproducibility
set.seed(1234567)

iterations &lt;- 100 # Number of iterations of the Gibbs sampler
# Chosen number of iterations should be much higher, e.g. 30000.

burnin &lt;- 100 # Number of burn-in draws
draws &lt;- iterations + burnin

r &lt;- 1 # Set rank

tt &lt;- ncol(y) # Number of observations
k &lt;- nrow(y) # Number of endogenous variables
k_w &lt;- nrow(w) # Number of regressors in error correction term
k_x &lt;- nrow(x) # Number of differenced regressors and unrestrictec deterministic terms

k_alpha &lt;- k * r # Number of elements in alpha
k_beta &lt;- k_w * r # Number of elements in beta
k_gamma &lt;- k * k_x

# Set uninformative priors
a_mu_prior &lt;- matrix(0, k_x * k) # Vector of prior parameter means
a_v_i_prior &lt;- diag(0, k_x * k) # Inverse of the prior covariance matrix

v_i &lt;- 0
p_tau_i &lt;- diag(1, k_w)

u_sigma_df_prior &lt;- r # Prior degrees of freedom
u_sigma_scale_prior &lt;- diag(0, k) # Prior covariance matrix
u_sigma_df_post &lt;- tt + u_sigma_df_prior # Posterior degrees of freedom

# Initial values
beta &lt;- matrix(c(1, -4), k_w, r)
u_sigma_i &lt;- diag(1 / .0001, k)
g_i &lt;- u_sigma_i

# Data containers
draws_alpha &lt;- matrix(NA, k_alpha, iterations)
draws_beta &lt;- matrix(NA, k_beta, iterations)
draws_pi &lt;- matrix(NA, k * k_w, iterations)
draws_gamma &lt;- matrix(NA, k_gamma, iterations)
draws_sigma &lt;- matrix(NA, k^2, iterations)

# Start Gibbs sampler
for (draw in 1:draws) {
  # Draw conditional mean parameters
  temp &lt;- post_coint_kls(y = y, beta = beta, w = w, x = x, sigma_i = u_sigma_i,
                         v_i = v_i, p_tau_i = p_tau_i, g_i = g_i,
                         gamma_mu_prior = a_mu_prior,
                         gamma_v_i_prior = a_v_i_prior)
  alpha &lt;- temp$alpha
  beta &lt;- temp$beta
  Pi &lt;- temp$Pi
  gamma &lt;- temp$Gamma
  
  # Draw variance-covariance matrix
  u &lt;- y - Pi %*% w - matrix(gamma, k) %*% x
  u_sigma_scale_post &lt;- solve(tcrossprod(u) +
     v_i * alpha %*% tcrossprod(crossprod(beta, p_tau_i) %*% beta, alpha))
  u_sigma_i &lt;- matrix(rWishart(1, u_sigma_df_post, u_sigma_scale_post)[,, 1], k)
  u_sigma &lt;- solve(u_sigma_i)
  
  # Update g_i
  g_i &lt;- u_sigma_i
  
  # Store draws
  if (draw &gt; burnin) {
    draws_alpha[, draw - burnin] &lt;- alpha
    draws_beta[, draw - burnin] &lt;- beta
    draws_pi[, draw - burnin] &lt;- Pi
    draws_gamma[, draw - burnin] &lt;- gamma
    draws_sigma[, draw - burnin] &lt;- u_sigma
  }
}

# Number of non-deterministic coefficients
k_nondet &lt;- (k_x - 4) * k

# Generate bvec object
bvec_est &lt;- bvec(y = data$data$Y, w = data$data$W,
                 x = data$data$X[, 1:6],
                 x_d = data$data$X[, 7:10],
                 Pi = draws_pi,
                 Gamma = draws_gamma[1:k_nondet,],
                 C = draws_gamma[(k_nondet + 1):nrow(draws_gamma),],
                 Sigma = draws_sigma)

# Thin posterior draws
bvec_est &lt;- thin(bvec_est, thin = 5)

# Transfrom VEC output to VAR output
bvar_form &lt;- bvec_to_bvar(bvec_est)

</code></pre>


</div>