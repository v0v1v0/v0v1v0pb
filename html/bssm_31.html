<div class="container">

<table style="width: 100%;"><tr>
<td>expand_sample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand the Jump Chain representation</h2>

<h3>Description</h3>

<p>The MCMC algorithms of <code>bssm</code> use a jump chain representation where we
store the accepted values and the number of times we stayed in the current
value. Although this saves bit memory and is especially convenient for
IS-corrected  MCMC, sometimes we want to have the usual sample paths
(for example for drawing traceplots).
Function <code>expand_sample</code> returns the expanded sample based on the
counts (in form of <code>coda::mcmc</code> object. Note that for
the IS-MCMC the expanded sample corresponds to the approximate posterior,
i.e., the weights are ignored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expand_sample(x, variable = "theta", times, states, by_states = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output from <code>run_mcmc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Expand parameters <code>"theta"</code> or states <code>"states"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>A vector of indices. In case of states,
what time points to expand? Default is all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>A vector of indices. In case of states,
what states to expand? Default is all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_states</code></td>
<td>
<p>If <code>TRUE</code> (default), return list by states.
Otherwise by time.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This functions is mostly for backwards compatibility, methods
<code>as.data.frame</code> and <code>as_draws</code> produce likely more convenient
output.
</p>


<h3>Value</h3>

<p>An object of class <code>"mcmc"</code> of the <code>coda</code> package.
</p>


<h3>See Also</h3>

<p><code>as.data.frame.mcmc_output</code> and <code>as_draws.mcmc_output</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 50
x &lt;- cumsum(rnorm(n))
y &lt;- rnorm(n, x)
model &lt;- bsm_lg(y, sd_y = gamma_prior(1, 2, 2), 
  sd_level = gamma_prior(1, 2, 2))
fit &lt;- run_mcmc(model, iter = 1e4)
# Traceplots for theta
plot.ts(expand_sample(fit, variable = "theta"))
# Traceplot for x_5
plot.ts(expand_sample(fit, variable = "states", times = 5, 
  states = 1)$level)
</code></pre>


</div>