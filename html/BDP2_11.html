<div class="container">

<table style="width: 100%;"><tr>
<td>plotBDP2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Plots
</h2>

<h3>Description</h3>

<p>Output of desired plots
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotBDP2(x = c("n", "k", "ptrue", "cE", "cF"), 
          y = c("Prob0Successes", "PostProb0or1Successes", "bFbE", 
                "PEcall_p0_p1", "PEstop_p0_p1", 
                "PFstopEcall", "PFstopEstop",
                "PEcall", "PEstop", "PFstop", "PFstopEstop", 
                "ExpectedNumber", 
                "PredictivePower"), 
          n, interim.at, ptrue, 
          pF, cF, pE, cE, p0, p1, Estop=FALSE,
          shape1F, shape2F, shape1E = NULL, shape2E = NULL, 
          col = c("green", "red"), cex.legend=1, add = FALSE, 
          show=TRUE, progress = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>character string specifying what is given by the x axis
</p>

<ul>
<li>
<p> "n" for number of patients at final or at first interim, depending on plot
</p>
</li>
<li>
<p> "ptrue" for the true response rate
</p>
</li>
<li>
<p> "k" number of successes at interim (only for <code>y=="PredictivePower"</code>)
</p>
</li>
<li>
<p> "cE" for the critical level of posterior probabilities used for declaring efficacy
</p>
</li>
<li>
<p> "cF" for the critical level of posterior probabilities used for declaring futility
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>character string specifying what is given by the y axis
</p>

<ul>
<li>
<p> "Prob0Successes" for plot of probability of 0 successes out of n at first interim, i.e. (1-p)^n. Two curves are generated: one for p0 and one for p1. Choose x="n" and set n to a vector of number patients at first interim.
</p>
</li>
<li>
<p> "PostProb0or1Successes" generates two curves of posterior probability that reponse rate exceeds cF. One given 0 successes and one given 1 success observed in n, i.e. P(p&gt;pF| 0 successes out of n) and P(p&gt;pF| 1 success out of n). Choose x="n" and set n to a vector of number patients at first interim.
</p>
</li>
<li>
<p> "bFbE" for plot of boundaries for futility bF and for efficacy bE in terms of number of successes per n number of patients. Futility stop if number of successes &lt;= bF, call efficacy if number of successes &gt;= bE. Choose x="n" and set n to the maximal number of patients (not a vector).
</p>
</li>
<li>
<p> "PEcall_p0_p1" for plot of probability to call efficacy at final (i.e. P(p&gt;pE|Data)&gt;=cE ), evaluated for data generated with control response rate p0 (corresponds to type I error) and for data generated with target response rate p1 (corresponds to power) for varying number of patients at final. Choose x="n" and set n to a vector of number patients at final.
</p>
</li>
<li>
<p> "PEstop_p0_p1" as above but with stopping for efficacy instead of calling efficacy 
</p>
</li>
<li>
<p> "PFstopEcall" for plotting operating characteristics for a given response rate as a function of number of patients at final, n. Shows one curve (default: in red) for the probability of stopping for futility up to final analysis and one curve (default: in green) for the probability of calling efficacy at final analysis. For the setting ptrue=p0, the curves show the probability of true stopping (default: in red) and type I error (default: in green). For the setting ptrue=p1, the curves show the probability of false stopping (default: in red) and power (default: in green). Choose x="n" and set n to a vector of number patients at final.
</p>
</li>
<li>
<p> "PFstopEstop" as above but with stopping for efficacy instead of calling efficacy 
</p>
</li>
<li>
<p> "PEcall" for plot of probability to call efficacy at final (i.e. P(p&gt;pE|Data)&gt;=cE ). 
</p>

<ul>
<li>
<p> For x="ptrue" then this is the power function. 
</p>
</li>
<li>
<p> For x="cE" this gives plots of probability to call efficacy at final, evaluated for data generated with control response rate p0 (corresponds to type I error) and for data generated with target response rate p1 (corresponds to power).
</p>
</li>
</ul>
</li>
<li>
<p> "PEstop" 
</p>

<ul>
<li>
<p> For x="ptrue" then this is the power function. 
</p>
</li>
<li>
<p> For x="cE" this gives plots of probability to call efficacy at final, evaluated for data generated with control response rate p0 (corresponds to type I error) and for data generated with target response rate p1 (corresponds to power).
</p>
</li>
</ul>
</li>
<li>
<p> "PFstop" for plot of cumulative probability to stop for futility up to final.
</p>

<ul>
<li>
<p> For x="ptrue" this gives the futility stopping probability as function of ptrue. 
</p>
</li>
<li>
<p> For x="cF" this gives 2 curves, evaluated for data generated with control response rate p0 (corresponds to true stopping probability, default: in green) and for data generated with target response rate p1 (corresponds to false stopping probability, default: in red).
</p>
</li>
</ul>
</li>
<li>
<p> "ExpectedNumber" for expected number of patients in the trial. Choose x= "ptrue". 
Takes stopping for efficacy into account if <code>Estop==TRUE</code>
</p>
</li>
<li>
<p> "PredictivePower" for predictive power (only for <code>x=="k"</code>)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size at the final analysis, vector if <code>x=="n"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interim.at</code></td>
<td>
<p>vector of sample sizes at the interim analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptrue</code></td>
<td>
<p>true (assumed) response rate used for simulating the trial, vector if <code>x=="ptrue"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pF</code></td>
<td>
<p>response rate used for the futility criterion P(p&gt;pF|Data) &lt; cF (may be identical to pE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cF</code></td>
<td>
<p>critical level of posterior probabilities used for declaring futility, vector if <code>x=="cF"</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pE</code></td>
<td>
<p>response rate used for the efficacy criterion P(p&gt;pE|Data) &gt;= cE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cE</code></td>
<td>
<p>critical level of posterior probabilities used for declaring efficacy, vector if <code>x=="cE"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>response rate corresponding to H0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>response rate corresponding to H1 (p1 &gt; p0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1F</code></td>
<td>
<p>first parameter of the Beta prior for futility analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2F</code></td>
<td>
<p>second parameter of the Beta prior for futility analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1E</code></td>
<td>
<p>first parameter of the Beta prior for efficacy analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2E</code></td>
<td>
<p>second parameter of the Beta prior for efficacy analysis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estop</code></td>
<td>
<p>Stop for efficacy? Defaults to <code>FALSE</code>. Only relevant if <code>y=="ExpectedNumber"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>line color, for some plots vector of length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>add line to existing plot. Only supported if <code>x=="ptrue"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>show plot (otherwise computed objects are invisibly returned)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>only used by shiny app</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>size of legend text relative to cex</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>plot.default()</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Kopp-Schneider, A., Wiesenfarth, M., Witt, R., Edelmann, D., Witt, O. and Abel, U. (2018).<br> Monitoring futility and efficacy in phase II trials with Bayesian
posterior distributions - a calibration approach. 
<em>Biometrical Journal</em>, to appear.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See vignette for more details and examples
pF=0.3
pE=0.12
shape1F=0.3
shape2F=0.7
shape1E=0.12
shape2E=0.88
cF=0.01
cE=0.9
nvec=c(18:40)
interim.at=c(10,20,30)

# Type I error and probability of true stopping for the uninteresting response rate. 
ptrue=0.12
plotBDP2(x="n", y="PFstopEcall",
         n =nvec, interim.at = interim.at,
         pF=pF,cF=cF,pE=pE,cE=cE,ptrue=ptrue,
         shape1F=shape1F,shape2F=shape2F,shape1E=shape1E,shape2E=shape2E)


# Power and probability of false stopping for the target response rate. 
ptrue=0.3
plotBDP2(x="n", y="PFstopEcall",
         n =nvec, interim.at = interim.at,
         pF=pF,cF=cF,pE=pE,cE=cE,ptrue=ptrue,
         shape1F=shape1F,shape2F=shape2F,shape1E=shape1E,shape2E=shape2E)

</code></pre>


</div>