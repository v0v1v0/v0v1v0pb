<div class="container">

<table style="width: 100%;"><tr>
<td>afgen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>NN and Anscombe samples</h2>

<h3>Description</h3>

<p>Samples binomial Fisz and Anscombe transformed random variables on a grid of binomial probabilities.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">afgen(xgrid = seq(0, 1, length = 21), ygrid = seq(0, 1, length = 21), samples = 1000, 
binsize = 32)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xgrid</code></td>
<td>
<p>vector of x co-ordinate probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ygrid</code></td>
<td>
<p>vector of x co-ordinate probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>the number of samples to draw from each random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>
<p>the binomial size of the binomial random variables.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function produces sampled values from the random variable:<br><br><code class="reqn">\zeta(X_1,X_2)=\frac{X_1-X_2}{ \sqrt{ (X_1+X_2)(2*binsize-X_1-X_2)/ 2*binsize }} 
</code>,<br><br> 
where <code class="reqn">X_i</code> are Bin(binsize,<code class="reqn">p_i</code>) random variables, for all combinations of values of <code class="reqn">p_1</code> in xgrid and <code class="reqn">p_2</code> in ygrid.  
For Anscombe's transformation, 
<code class="reqn">A=sin^{-1}\sqrt{(x+3/8)/(binsize+3/4)}</code>, the values correspond to the random variable with the larger binomial probability.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>an array of dimensions <code>length(xgrid)xlength(ygrid)xsamples</code> of values of binomial Haar-Fisz random variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>an array of dimensions <code>length(xgrid)xlength(ygrid)xsamples</code> of values of A.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matt Nunes (<a href="mailto:m.nunes@ucl.ac.uk">m.nunes@ucl.ac.uk</a>)</p>


<h3>References</h3>

<p>Anscombe, F.J. (1948) The transformation of poisson, binomial and negative binomial Data, <em>Biometrika</em>,<b>35</b>, 246–254.<br>
Nunes, M. and Nason, G.P. (2009) A multiscale variance stabilization for binomial sequence proportion estimation. <em>Statistica Sinica</em>, <b>19</b>
(1491–1510).
</p>


<h3>See Also</h3>

<p><code>ansc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">##
varvalues&lt;-afgen(xgrid=seq(0,1,length=21),ygrid=seq(0,1,length=21),samples=1000,binsize=32)

##creates 1000 samples of the two random variables zeta_B and A for each point 
##(x,y) for x and y regularly-spaced probability vectors of length 21.
##
</code></pre>


</div>