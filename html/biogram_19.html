<div class="container">

<table style="width: 100%;"><tr>
<td>count_ngrams</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Count n-grams in sequences</h2>

<h3>Description</h3>

<p>Counts all n-grams or position-specific n-grams present in the input sequence(s).
</p>


<h3>Usage</h3>

<pre><code class="language-R">count_ngrams(seq, n, u, d = 0, pos = FALSE, scale = FALSE, threshold = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seq</code></td>
<td>
<p>a vector or matrix describing sequence(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p><code>integer</code> size of n-gram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code>integer</code>, <code>numeric</code> or <code>character</code> vector of all
possible unigrams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p><code>integer</code> vector of distances between elements of n-gram (0 means 
consecutive elements). See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> position-specific n_grams are counted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code> output data is normalized. May be
applied only to the counts of n-grams without position information. See <code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p><code>integer</code>, if not equal to 0, data is binarized into
two groups (larger or equal to threshold vs. smaller than threshold).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <code>distance</code> vector should be always <code>n</code> - 1 in length.
For example when <code>n</code> = 3, <code>d</code> = c(1,2) means A_A__A. For <code>n</code> = 4, 
<code>d</code> = c(2,0,1) means A__AA_A. If vector <code>d</code> has length 1, it is recycled to
length <code>n</code> - 1.
</p>
<p>n-gram names follow a specific convention and have three parts for position-specific
n-grams and two parts otherwise. The parts are separated by <code>_</code>. The <code>.</code> symbol
is used to separate elements within a part. The general naming scheme is 
<code>POSITION_NGRAM_DISTANCE</code>. The optional <code>POSITION</code> part of the name indicates
the actual position of the n-gram in the sequence(s) and will be present 
only if <code>pos</code> = <code>TRUE</code>. This part is always a single integer. The <code>NGRAM</code>
part of the name is a sequence of elements in the n-gram. For example, <code>4.2.2</code>
indicates the n-gram 422 (e.g. TCC). The <code>DISTANCE</code> part of the name is a vector of
distance(s). For example, <code>0.0</code> indicates zero distances (continuous n-grams), while
<code>1.2</code> represents distances for the n-gram A_A__A.
</p>
<p>Examples of n-gram names:
</p>

<ul>
<li>
<p>46_4.4.4_0.1 : trigram 44_4 on position 46
</p>
</li>
<li>
<p>12_2.1_2     : bigram 2__1 on position 12
</p>
</li>
<li>
<p>8_1.1.1_0.0  : continuous trigram 111 on position 8
</p>
</li>
<li>
<p>1.1.1_0.0    : continuous trigram 111 without position information
</p>
</li>
</ul>
<h3>Value</h3>

<p>a <code>simple_triplet_matrix</code> where columns represent
n-grams and rows sequences. See <code>Details</code> for specifics of the naming convention.
</p>


<h3>Note</h3>

<p>By default, the counted n-gram data is stored in a memory-saving format.
To convert an object to a 'classical' matrix use the <code>as.matrix</code>
function. See examples for further information.
</p>


<h3>See Also</h3>

<p>Create vector of possible n-grams: <code>create_ngrams</code>.
</p>
<p>Extract n-grams from sequence(s): <code>seq2ngrams</code>.
</p>
<p>Get indices of n-grams: <code>get_ngrams_ind</code>.
</p>
<p>Count n-grams for multiple values of n: <code>count_multigrams</code>.
</p>
<p>Count only specified n-grams: <code>count_specified</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># count trigrams without position information for nucleotides
count_ngrams(sample(1L:4, 50, replace = TRUE), 3, 1L:4, pos = FALSE)
# count position-specific trigrams from multiple nucleotide sequences
seqs &lt;- matrix(sample(1L:4, 600, replace = TRUE), ncol = 50)
ngrams &lt;- count_ngrams(seqs, 3, 1L:4, pos = TRUE)
# output results of the n-gram counting to screen
as.matrix(ngrams)
</code></pre>


</div>