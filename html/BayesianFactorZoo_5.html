<div class="container">

<table style="width: 100%;"><tr>
<td>continuous_ss_sdf_v2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SDF model selection with continuous spike-and-slab prior (tradable factors are treated as test assets)</h2>

<h3>Description</h3>

<p>This function provides the SDF model selection procedure using the continuous spike-and-slab prior.
See Propositions 3 and 4 in Bryzgalova et al. (2023).
Unlike <code>continuous_ss_sdf</code>, tradable factors are treated as test assets in this function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">continuous_ss_sdf_v2(
  f1,
  f2,
  R,
  sim_length,
  psi0 = 1,
  r = 0.001,
  aw = 1,
  bw = 1,
  type = "OLS",
  intercept = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>A matrix of nontradable factors with dimension <code class="reqn">t \times k_1</code>, where <code class="reqn">k_1</code> is the number of nontradable factors
and <code class="reqn">t</code> is the number of periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2</code></td>
<td>
<p>A matrix of tradable factors with dimension <code class="reqn">t \times k_2</code>, where <code class="reqn">k_2</code> is the number of tradable factors
and <code class="reqn">t</code> is the number of periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A matrix of test assets with dimension <code class="reqn">t \times N</code>, where <code class="reqn">t</code> is the number of periods
and <code class="reqn">N</code> is the number of test assets (<b><code>R</code> should NOT contain tradable factors <code>f2</code></b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_length</code></td>
<td>
<p>The length of monte-carlo simulations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi0</code></td>
<td>
<p>The hyper-parameter in the prior distribution of risk prices (see <b>Details</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The hyper-parameter related to the prior of risk prices (see <b>Details</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aw</code></td>
<td>
<p>The hyper-parameter related to the prior of <code class="reqn">\gamma</code> (see <b>Details</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>The hyper-parameter related to the prior of <code class="reqn">\gamma</code> (see <b>Details</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If <code>type = 'OLS'</code> (<code>type = 'GLS'</code>), the function returns Bayesian OLS (GLS) estimates of risk prices. The default is 'OLS'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>If <code>intercept = TRUE</code> (<code>intercept = FALSE</code>), we include (exclude) the common intercept in the cross-sectional regression. The default is <code>intercept = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the description in the twin function <code>continuous_ss_sdf</code>.
</p>


<h3>Value</h3>

<p>The return of <code>continuous_ss_sdf_v2</code> is a list of the following elements:
</p>

<ul>
<li> <p><code>gamma_path</code>: A <code>sim_length</code><code class="reqn">\times k</code> matrix of the posterior draws of <code class="reqn">\gamma</code> (<code class="reqn">k = k_1 + k_2</code>). Each row represents
a draw. If <code class="reqn">\gamma_j = 1</code> in one draw, factor <code class="reqn">j</code> is included in the model in this draw and vice verse.
</p>
</li>
<li> <p><code>lambda_path</code>: A <code>sim_length</code><code class="reqn">\times (k+1)</code> matrix of the risk prices <code class="reqn">\lambda</code> if <code>intercept = TRUE</code>. Each row represents
a draw. Note that the first column is <code class="reqn">\lambda_c</code> corresponding to the constant term. The next <code class="reqn">k</code> columns (i.e., the 2-th – <code class="reqn">(k+1)</code>-th columns)
are the risk prices of the <code class="reqn">k</code> factors. If <code>intercept = FALSE</code>, <code>lambda_path</code> is a <code>sim_length</code><code class="reqn">\times k</code> matrix of the risk prices,
without the estimates of <code class="reqn">\lambda_c</code>.
</p>
</li>
<li> <p><code>sdf_path</code>: A <code>sim_length</code><code class="reqn">\times t</code> matrix of posterior draws of SDFs. Each row represents a draw.
</p>
</li>
<li> <p><code>bma_sdf</code>: BMA-SDF.
</p>
</li>
</ul>
<h3>References</h3>

<p>Bryzgalova S, Huang J, Julliard C (2023).
“Bayesian solutions for the factor zoo: We just ran two quadrillion models &lt;https://doi.org/10.1111/jofi.13197&gt;.”
<em>Journal of Finance</em>, <b>78</b>(1), 487–557.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(timeSeries)

## Load the example data
data("BFactor_zoo_example")
HML &lt;- BFactor_zoo_example$HML
lambda_ols &lt;- BFactor_zoo_example$lambda_ols
R2.ols.true &lt;- BFactor_zoo_example$R2.ols.true
sim_f &lt;- BFactor_zoo_example$sim_f
sim_R &lt;- BFactor_zoo_example$sim_R
uf &lt;- BFactor_zoo_example$uf

## sim_f: simulated strong factor
## uf: simulated useless factor

psi_hat &lt;- psi_to_priorSR(sim_R, cbind(sim_f,uf,sim_R[,1]), priorSR=0.1)

## We include the first test asset, sim_R[,1], into factors, so f2 = sim_R[,1,drop=FALSE].
## Also remember excluding sim_R[,1,drop=FALSE] from test assets, so R = sim_R[,-1].
shrinkage &lt;- continuous_ss_sdf_v2(cbind(sim_f,uf), sim_R[,1,drop=FALSE], sim_R[,-1], 1000,
                                  psi0=psi_hat, r=0.001, aw=1, bw=1)
cat("Null hypothesis: lambda =", 0, "for each of these three factors", "\n")
cat("Posterior probabilities of rejecting the above null hypotheses are:",
    colMeans(shrinkage$gamma_path), "\n")

## We also have the posterior draws of SDF: m(t) = 1 - lambda_g %*% (f(t) - mu_f)
sdf_path &lt;- shrinkage$sdf_path

## We also provide the Bayesian model averaging of the SDF (BMA-SDF)
bma_sdf &lt;- shrinkage$bma_sdf

## We can further estimate the posterior distributions of model-implied Sharpe ratios:
cat("The 5th, 50th, and 95th quantiles of model-implied Sharpe ratios:",
    quantile(colSds(t(sdf_path)), probs=c(0.05, 0.5, 0.95)), "\n")

## Finally, we can estimate the posterior distribution of model dimensions:
cat("The posterior distribution of model dimensions (= 0, 1, 2, 3):",
    prop.table(table(rowSums(shrinkage$gamma_path))), "\n")

## We now use the 17th test asset, sim_R[,17,drop=FALSE], as the tradable factor,
## so f2 = sim_R[,17,drop=FALSE].
## Also remember excluding sim_R[,17,drop=FALSE] from test assets, so R = sim_R[,-17].
psi_hat &lt;- psi_to_priorSR(sim_R, cbind(sim_f,uf,sim_R[,17]), priorSR=0.1)
shrinkage &lt;- continuous_ss_sdf_v2(cbind(sim_f,uf), sim_R[,17,drop=FALSE], sim_R[,-17],
                                  1000, psi0=psi_hat, r=0.001, aw=1, bw=1)
cat("Null hypothesis: lambda =", 0, "for each of these three factors", "\n")
cat("Posterior probabilities of rejecting the above null hypotheses are:",
    colMeans(shrinkage$gamma_path), "\n")



</code></pre>


</div>