<div class="container">

<table style="width: 100%;"><tr>
<td>LN_QuantReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian estimate of the log-normal conditioned quantiles</h2>

<h3>Description</h3>

<p>This function produces a point estimate for the log-normal distribution quantile of fixed level <code>quant</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LN_QuantReg(
  y,
  X,
  Xtilde,
  quant,
  method = "weak_inf",
  guess_s2 = NULL,
  y_transf = TRUE,
  CI = TRUE,
  method_CI = "exact",
  alpha_CI = 0.05,
  type_CI = "two-sided",
  rel_tol_CI = 1e-05,
  nrep_CI = 1e+05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of observations of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtilde</code></td>
<td>
<p>Covariate patterns of the units to estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Number between 0 and 1 that indicates the quantile of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String that indicates the prior setting to adopt. Choosing <code>"weak_inf"</code>
a weakly informative prior setting is adopted, whereas selecting
<code>"optimal"</code> the hyperparameters are fixed trough a numerical optimization algorithm
aimed at minimizing the frequentist MSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess_s2</code></td>
<td>
<p>Specification of a guess for the variance if available. If not, the sample estimate is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_transf</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the <code>y</code> vector is assumed already log-transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Logical. With the default choice <code>TRUE</code>, the posterior credibility interval is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_CI</code></td>
<td>
<p>String that indicates if the limits should be computed through the logSMNG
quantile function <code>qlSMNG</code> (option <code>"exact"</code>, default), or by randomly generating
(<code>"simulation"</code>) using the function <code>rlSMNG</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_CI</code></td>
<td>
<p>Level of credibility of the posterior interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_CI</code></td>
<td>
<p>String that indicates the type of interval to compute: <code>"two-sided"</code> (default),
<code>"UCL"</code> (i.e. Upper Credible Limit) for upper one-sided intervals  or <code>"LCL"</code> (i.e. Lower
Credible Limit) for lower one-sided intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_tol_CI</code></td>
<td>
<p>Level of relative tolerance required for the <code>integrate</code> procedure or for the infinite sum.
Default set to <code>1e-5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep_CI</code></td>
<td>
<p>Number of simulations for the C.I. in case of <code>method="simulation"</code> and for the posterior of the coefficients vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function allows to carry out Bayesian inference for the conditional quantiles of a sample that is assumed log-normally distributed.
The design matrix containing the covariate patterns of the sampled units is <code>X</code>, whereas <code>Xtilde</code>
contains the covariate patterns of the unit to predict.
</p>
<p>The classical log-normal linear mixed model is assumed and the quantiles are estimated as:
</p>
<p style="text-align: center;"><code class="reqn">\theta_p(x)=exp(x^T\beta+\Phi^{-1}(p))</code>
</p>
<p>.
</p>
<p>A generalized inverse Gaussian prior is assumed for the variance in the log scale <code class="reqn">\sigma^2</code>, whereas a
flat improper prior is assumed for the vector of coefficients <code class="reqn">\beta</code>.
</p>
<p>Two alternative hyperparamters setting are implemented (choice controlled by the argument <code>method</code>): a weakly
informative proposal and an optimal one.
</p>


<h3>Value</h3>

<p>The function returns the prior parameters and their posterior values, summary statistics of the parameters <code class="reqn">\beta</code> and <code class="reqn">\sigma^2</code>, and the estimate of the specified quantile:
the posterior mean and variance are provided by default. Moreover the user can control the computation of posterior intervals.
</p>
<p>#'@source
</p>
<p>Gardini, A., C. Trivisano, and E. Fabrizi. <em>Bayesian inference for quantiles of the log-normal distribution.</em> Biometrical Journal (2020).
</p>


</div>