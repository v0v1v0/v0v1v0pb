<div class="container">

<table style="width: 100%;"><tr>
<td>layout.cna</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Protein Structure Network Layout </h2>

<h3>Description</h3>

<p>Determine protein structure network layout in 2D and 3D from the geometric 
center of each community.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  layout.cna(x, pdb, renumber=TRUE, k=2, full=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A protein structure network object as obtained from the ‘cna’ 
function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdb</code></td>
<td>
<p> A pdb class object as obtained from the ‘read.pdb’ 
function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>renumber</code></td>
<td>
<p> Logical, if TRUE the input ‘pdb’ will be re-numbered 
starting at residue number one before community coordinate averages are 
calculated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> A single element numeric vector between 1 and 3 specifying the 
returned coordinate dimensions. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p> Logical, if TRUE the full all-Calpha atom network coordinates will 
be returned rather than the default clustered network community coordinates. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the geometric center for each community from
the atomic position of it's Calpha atoms taken from a corresponding PDB 
file. Care needs to be taken to ensure the PDB residue numbers and the
community vector names/length match.
</p>
<p>The community residue membership are typically taken from the input network 
object but can be supplied as a list object with 'x$communities$membership'.
</p>


<h3>Value</h3>

<p>A numeric matrix of Nxk, where N is the number of communities and k the number of dimensions requested.
</p>


<h3>Author(s)</h3>

<p> Guido Scarabelli and Barry Grant </p>


<h3>See Also</h3>

 <p><code>plot.cna</code>, <code>plot.communities</code>,
<code>igraph.plotting</code>, 
<code>plot.igraph</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
if (!requireNamespace("igraph", quietly = TRUE)) {
   message('Need igraph installed to run this example')
} else {

# Load the correlation network
attach(hivp)

# Read the starting PDB file to determine atom correspondence
pdbfile &lt;- system.file("examples/hivp.pdb", package="bio3d")
pdb &lt;- read.pdb(pdbfile)

# Plot will be slow
#xy &lt;- plot.cna(net)
#plot3d.cna(net, pdb)

layout.cna(net, pdb, k=3)
layout.cna(net, pdb)

# can be used as input to plot.cna and plot3d.cna....
# plot.cna( net, layout=layout.cna(net, pdb) )
# plot3d.cna(net, pdb, layout=layout.cna(net, pdb, k=3))

detach(hivp)

}
</code></pre>


</div>