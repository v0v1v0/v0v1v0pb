<div class="container">

<table style="width: 100%;"><tr>
<td>bspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing the spectrum's posterior distribution</h2>

<h3>Description</h3>

<p>Derives the posterior distribution of the spectrum
of one or several time series,
based on data and prior specifications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  bspec(x, ...)
  ## Default S3 method:
bspec(x, priorscale=1, priordf=0, intercept=TRUE,
    two.sided=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a time series object of the data to be analysed.
May be a univariate (<code>ts</code> object) or multivariate
(<code>mts</code> object) time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorscale</code></td>
<td>
<p><em>either</em> a <code>numeric</code> vector giving the
scale parameters of the spectrum's prior distribution; recycled if
of length 1.
</p>
<p><em>Or</em> a <code>function</code> of frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priordf</code></td>
<td>
<p><em>either</em> a <code>numeric</code> vector giving the
degrees-of-freedom parameters of the spectrum's prior distribution;
recycled if of length 1.
</p>
<p><em>Or</em> a <code>function</code> of frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>a <code>logical</code> flag indicating whether to include
the ‘intercept’ (zero frequency) term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>a <code>logical</code> flag indicating whether to refer to
a one-sided or a two-sided spectrum. In particular affects the
interpretation of the prior scale parameters, and sets the default
for some methods applied to the resulting <code>bspec</code> object via
its <code>two.sided</code> element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on the assumptions of a zero mean and a finite spectrum,
the posterior distribution of the (discrete) spectrum is derived.
The data are modeled using the <em>Maximum Entropy</em> (Normal)
distribution for the above constraints, and based on the
prior information about the spectrum specified in terms of the
(conjugate) <em>scaled inverse <code class="reqn">\chi^2</code> distribution</em>.
</p>
<p>For more details, see the references.
</p>


<h3>Value</h3>

<p>A list of class <code>bspec</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>a <code>numeric</code> vector giving the
(Fourier-) frequencies that the spectral parameters
correspond to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a <code>numeric</code> vector giving the scale
parameters of the posterior distributions of the spectral
parameters corresponding to the above frequencies.
These -internally- always correspond to the <em>one-sided</em>
spectrum, regardless of the <code>two.sided</code> flag (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a <code>numeric</code> vector giving the
degrees-of-freedom parameters of the posterior distributions of
the spectral parameters corresponding to the above frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorscale</code></td>
<td>
<p>a <code>numeric</code> vector giving the
prior scale parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priordf</code></td>
<td>
<p>a <code>numeric</code> vector giving the
prior degrees-of-freedom parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datassq</code></td>
<td>
<p>a <code>numeric</code> vector giving the
sum-of-squares contributed by the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datadf</code></td>
<td>
<p>a <code>numeric</code> vector giving the
degrees-of-freedom contributed by the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the sample size of the original time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltat</code></td>
<td>
<p>the sampling interval of the original time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaf</code></td>
<td>
<p>the frequency interval of the Fourier-transformed time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>the time of the first observation in the original time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>an object of class <code>call</code> giving the
function call that generated the <code>bspec</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>a <code>logical</code> flag indicating
whether the spectrum is to be interpreted as one-sided or two-sided.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Roever, <a href="mailto:christian.roever@med.uni-goettingen.de">christian.roever@med.uni-goettingen.de</a></p>


<h3>References</h3>

<p>Roever, C., Meyer, R., Christensen, N.
Modelling coloured residual noise in gravitational-wave signal processing.
<em>Classical and Quantum Gravity</em>, <b>28</b>(1):015010, 2011.
doi: <a href="https://doi.org/10.1088/0264-9381/28/1/015010">10.1088/0264-9381/28/1/015010</a>.
See also <a href="https://arxiv.org/abs/0804.3853">arXiv preprint 0804.3853</a>.
</p>
<p>Roever, C.
<a href="https://dcc.ligo.org/LIGO-T1100497/public">Degrees-of-freedom
estimation in the Student-t noise model</a>.
Technical Report LIGO-T1100497, LIGO-Virgo Collaboration, 2011.
</p>
<p>Roever, C.
A Student-t based filter for robust signal detection.
<em>Physical Review D</em>, <b>84</b>(12):122004, 2011.
doi: <a href="https://doi.org/10.1103/PhysRevD.84.122004">10.1103/PhysRevD.84.122004</a>.
See also <a href="https://arxiv.org/abs/1109.0442">arXiv preprint 1109.0442</a>.</p>


<h3>See Also</h3>

<p><code>expectation</code>,
<code>quantile.bspec</code>,
<code>sample.bspec</code>,
<code>ppsample</code>,
<code>acf.bspec</code>,
<code>spectrum</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># determine spectrum's posterior distribution
# (for noninformative prior):
lhspec &lt;- bspec(lh)
print(lhspec)

# show some more details:
str(lhspec)

# plot 95 percent central intervals and medians:
plot(lhspec)

# draw and plot a sample from posterior distribution:
lines(lhspec$freq, sample(lhspec), type="b", pch=20)

########

# compare the default outputs of "bspec()" and "spectrum()":
bspec1    &lt;- bspec(lh)
spectrum1 &lt;- spectrum(lh, plot=FALSE)
plot(bspec1) 
lines(spectrum1$freq, spectrum1$spec, col="blue")
# (note -among others- the factor 2 difference)

# match the outputs:
# Need to suppress  tapering, padding and de-trending
# (see help for "spec.pgram()"):
spectrum2 &lt;- spectrum(lh, taper=0, fast=FALSE, detrend=FALSE, plot=FALSE)
# Need to drop intercept (zero frequency) term:
bspec2    &lt;- bspec(lh, intercept=FALSE)
# plot the "spectrum()" output:
plot(spectrum2)
# draw the "bspec()" scale parameters, adjusted
# by the corresponding degrees-of-freedom,
# so they correspond to one-sided spectrum:
lines(bspec2$freq, bspec2$scale/bspec2$datadf,
      type="b", col="green", lty="dashed")

########

# handle several time series at once...
data(sunspots)
# extract three 70-year segments:
spots1 &lt;- window(sunspots, 1750, 1819.99)
spots2 &lt;- window(sunspots, 1830, 1899.99)
spots3 &lt;- window(sunspots, 1910, 1979.99)
# align their time scales:
tsp(spots3) &lt;- tsp(spots2) &lt;- tsp(spots1)
# combine to multivariate time series:
spots &lt;- ts.union(spots1, spots2, spots3)
# infer spectrum:
plot(bspec(spots))
</code></pre>


</div>