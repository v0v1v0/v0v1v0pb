<div class="container">

<table style="width: 100%;"><tr>
<td>gdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Density of the Shrinkage Factor</h2>

<h3>Description</h3>

<p>Calculates the mixture marginal posterior density for the shrinkage factor
(g/(1+g)) from a BMA object under the hyper-g prior and plots it
</p>


<h3>Usage</h3>

<pre><code class="language-R">gdensity(x, n = 512, plot = TRUE, addons = "zles", addons.lwd = 1.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A bma object (see <code>bms</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The integer number of equally spaced points at which the density is
to be estimated. see 'Details' below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), the density is plotted; if
<code>FALSE</code> then <code>gdensity</code> only returns the estimated posterior
density without plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addons</code></td>
<td>
<p>character, defaulting to <code>"zles"</code>. Specifies which
additional information should be added to the plot via low-level commands
(see 'Details' below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addons.lwd</code></td>
<td>
<p>scalar, default 1.5. Line width to be used for the
low-level plotting commands specified by <code>addons</code>. Cf. argument
<code>lwd</code> in <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for <code>plot.default</code> with
sensible defaults</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>gdensity</code> estimates and plots the posterior density for
the shrinkage factor <code class="reqn">g/(1+g)</code><br> This is evidently only possible if the
shrinkage factor if not fixed, i.e. if the bma object <code>x</code> was estimated
with a hyper-g prior - cf. argument <code>g</code> in <code>bms</code><br> The
density is based only on the best models retained in the bma object
<code>x</code>, cf. argument <code>nmodel</code> in <code>bms</code><br> A note on
argument <code>n</code>: The points at which the density is estimated start at
<code class="reqn">max(0,E-5*SD)</code>, where <code class="reqn">E</code> and <code class="reqn">SD</code> are the expected value and
standard deviation of the shrinkage factor, respectively. For plotting the
entire domain <code class="reqn">(0,1)</code> use <code>xlim=c(0,1)</code> as an argument for
<code>gdensity</code>.
</p>
<p>The argument <code>addons</code> specifies what additional information should be
added to the plot(s) via the low-level commands <code>lines</code> and
<code>legend</code>:<br><code>"e"</code> for the posterior expected value (EV) of
the shrinkage factor,<br><code>"s"</code> for 2 times posterior standard deviation
(SD) bounds,<br><code>"m"</code> for the posterior median,<br><code>"f"</code> for
posterior expected values of the individual models whom the density is
averaged over,<br><code>"z"</code> for a zero line, <code>"l"</code> for including a
<code>legend</code><br> The following two are only possible if the bma
object collected statistics on shrinkage, cf. argument <code>g.stats</code> in
<code>bms</code> <code>"E"</code> for posterior expected value under MCMC
frequencies (see argument <code>exact</code> in <code>coef.bma</code>),<br><code>"S"</code> for the corresponding 2 times standard deviation bounds
(MCMC),<br></p>
<p>Any combination of these letters will give the desired result. Use
<code>addons=""</code> for not using any of these.
</p>


<h3>Value</h3>

<p><code>gdensity</code> returns an object of the class <code>density</code>
detailing the posterior mixture density of the shrinkage factor.
</p>


<h3>Note</h3>

<p>The computed marginal posterior density is a Bayesian Model Averaging
mixture of the marginal posterior densities of the shrinkage factor under
individual models.  The accuracy of the result therefore depends on the
number of 'best' models contained in <code>x</code> (cf. argument <code>nmodel</code> in
<code>bms</code>).
</p>
<p>Correspondingly, the posterior EV and SD specified by <code>addons="es"</code> are
based on 'best' model likelihoods ('exact') and are conditional on
inclusion.
</p>
<p>The low-level commands enacted by the argument <code>addons</code> rely on colors
of the <code>palette</code>: color 2 for <code>"e"</code> and <code>"s"</code>, color 3
for <code>"m"</code>, color 8 for <code>"f"</code>, color 4 for <code>"E"</code> and
<code>"S"</code>. The default colors may be changed by a call to
<code>palette</code>.
</p>


<h3>See Also</h3>

<p><code>density.bma</code> for computing coefficient densities,
<code>bms</code> for creating bma objects, <code>density</code> for the
general method
</p>
<p>Check <a href="http://bms.zeugner.eu">http://bms.zeugner.eu</a> for additional help.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

 data(datafls)
 mm=bms(datafls,g="hyper=UIP")

 gdensity(mm) # default plotting
 
 # the grey bars represent expected shrinkage factors of the individual models
 gdensity(mm,addons="lzfes") 
 
 # #plotting the median 'm' and the posterior mean and bounds based on MCMC results:
 gdensity(mm,addons="zSEm",addons.lwd=2)

# plot the posterior shrinkage density only for the very best model
 gdensity(mm[1],addons="esz")


#using the calculated density for other purposes...
 dd=gdensity(mm,plot=FALSE)
 plot(dd) 

</code></pre>


</div>