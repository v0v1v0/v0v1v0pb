<div class="container">

<table style="width: 100%;"><tr>
<td>CE.ZINB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiple Break-point Detection via the CE Method with Zero-Inflated Negative Binomial Distribution</h2>

<h3>Description</h3>

<p>Performs calculations to estimate both the number of break-points and their corresponding locations of discrete measurements with the CE method. Zero-inflated negative binomial distribution is used to model the excess zero observations and to model over-dispersesion in the oberved discrete (count) data. This function supports for the simulation of break-point locations in the CE algorithm based on the four parameter beta distribution and truncated normal distribution. The general BIC or AIC can be used to select the optimal number of break-points. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">CE.ZINB(data, Nmax = 10, eps = 0.01, rho = 0.05, M = 200, h = 5, a = 0.8, b = 0.8,
distyp = 1, penalty = "BIC", parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data to be analysed. A single column array or a dataframe.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmax</code></td>
<td>

<p>maximum number of break-points. Default value is 10. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>the cut-off value for the stopping criterion in the CE method. Default value is 0.01.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>the fraction which is used to obtain the best performing set of sample solutions (i.e., elite sample). Default value is 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>sample size to be used in simulating the locations of break-points. Default value is 200.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>minimum aberration width. Default is 5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>a smoothing parameter value. It is used in the four parameter beta distribution to smooth both shape parameters. When simulating from the truncated normal distribution, this value is used to smooth the estimates of the mean values. Default is 0.8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>a smoothing parameter value. It is used in the truncated normal distribution to smooth the estimates of the standard deviation. Default is 0.8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distyp</code></td>
<td>

<p>distribution to simulate break-point locations. Options: 1 = four parameter beta distribution, 2 = truncated normal distribution. Default is 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>

<p>User can select either BIC or AIC to obtain the number of break-points. Options: "BIC", "AIC". Default is "BIC".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>A logical argument specifying if parallel computation should be carried-out (TRUE) or not (FALSE). By default it is set as ‘FALSE’. In WINDOWS OS systems "snow" functionalities are used, whereas in Unix/Linux/MAC OSX "multicore" functionalities are used to carryout parallel computations with the maximum number of cores available.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Zero-inflated negative binomial (ZINB) distribution is used to model the discrete (count) data. ZINB model is preferred over the NB model when both excess zero values and over-dispersion observed in the count data. A performance function score (BIC) is calculated for each of the solutions generated by the statistical distribution (four parameter beta distribution or truncated normal distribution), which is used to simulate break-points from no break-point to the user provided maximum number of break-points. The solution that minimizes the BIC/AIC with respect to the number of break-points is reported as the optimal solution. Finally, a list containing a vector of break-point, BIC/AIC values and log-likelihood value is returned in the console. 
</p>


<h3>Value</h3>

<p>A list is returned with following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>No.BPs</code></td>
<td>
<p>The number of break-points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BP.Loc</code></td>
<td>
<p>A vector of break-point locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC/AIC</code></td>
<td>
<p>BIC/AIC value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>Loglikelihood of the optimal solution</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Priyadarshana, W.J.R.M. &lt;mjayawardana@swin.edu.au&gt;
</p>


<h3>References</h3>

<p>Priyadarshana, W. J. R. M. and Sofronov, G. (2012a) A Modified Cross- Entropy Method for Detecting Multiple Change-Points in DNA Count Data, In Proc. of the IEEE Conference on Evolutionary Computation (CEC), 1020-1027, DOI: 10.1109/CEC.2012.6256470.
</p>
<p>Priyadarshana, W. J. R. M. and Sofronov, G. (2012b) The Cross-Entropy Method and Multiple Change-Points Detection in Zero-Inflated DNA read count data, In: Y. T. Gu, S. C. Saha (Eds.) The 4th International Conference on Computational Methods (ICCM2012), 1-8, ISBN 978-1-921897-54-2.
</p>
<p>Rubinstein, R., and Kroese, D. (2004) The Cross-Entropy Method: A Unified Approach to Combinatorial Optimization, Monte-Carlo Simulation and Machine Learning. Springer-Verlag, New York.
</p>
<p>Schwarz, G. (1978) Estimating the dimension of a model, The Annals of Statistics, 6(2), 461-464.
</p>


<h3>See Also</h3>

<p><code>CE.NB</code> for CE with negative binomial,
</p>
<p><code>CE.NB.Init</code> for CE with negative binomial with initial locations,
</p>
<p><code>CE.ZINB.Init</code> for CE with zero-inflated negative binomial with initial locations,
</p>
<p><code>profilePlot</code> to obtain mean profile plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Simulated data example ###
# gamlss R package is used to simulate data from the ZINB.

## Not run: 
library(gamlss)
segs &lt;- 6 # Number of segements
M &lt;- c(1500, 2200, 800, 2500, 1000, 2000) # Segment width
#true.locations &lt;- c(1501, 3701, 4501, 7001, 8001)  # True break-point locations 
seg &lt;- NULL
p &lt;- c(0.6, 0.1, 0.3, 0.05, 0.2, 0.4) # Specification of p's on each segment'
sigma.val &lt;- c(1,2,3,4,5,6) # Specification of sigma vlaues 

for(j in 1:segs){
  seg &lt;- c(seg, rZINBI(M[j], mu = 300, sigma = sigma.val[j], nu = p[j]))
}

simdata &lt;- as.data.frame(seg)
rm(p, M, seg, segs, j, sigma.val)
#plot(data[, 1])

## CE with the four parameter beta distribution with BIC as the selection criterion  ##

obj1 &lt;- CE.ZINB(simdata, distyp = 1, penalty = BIC, parallel = TRUE) # Parallel computation
obj1

profilePlot(obj1, simdata) # To obtain the mean profile plot

## CE with truncated normal distribution with BIC as the selection criterion  ##

obj2 &lt;- CE.ZINB(simdata, distyp = 2, penalty = BIC, parallel = TRUE) # Parallel computation
obj2

profilePlot(obj2, simdata) # To obtain the mean profile plot

## End(Not run)
</code></pre>


</div>