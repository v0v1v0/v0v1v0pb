<div class="container">

<table style="width: 100%;"><tr>
<td>BH_SBVAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Structural Bayesian Vector Autoregression</h2>

<h3>Description</h3>

<p>Estimates the parameters of a Structural Bayesian Vector Autoregression model with the method developed by Baumeister and Hamilton (2015/2017/2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BH_SBVAR(
  y,
  nlags,
  pA,
  pdetA = NULL,
  pH = NULL,
  pP = NULL,
  pP_sig = NULL,
  pR_sig = NULL,
  kappa1 = NULL,
  itr = 5000,
  burn = 0,
  thin = 1,
  cri = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><em>(T x n)</em> matrix containing the endogenous variables. <em>T</em> is the number of observations and <em>n</em> is the number of endogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlags</code></td>
<td>
<p>Integer specifying the lag order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pA</code></td>
<td>
<p><em>(n x n x 8)</em> array where <em>n</em> is the number of endogenous variables and each slice of the third dimension contains the prior distributions (NA - no prior, 0 - symmetric t-distribution, 1 - non-central t-distribution, 2 - inverted beta distribution, 3 - beta distribution), sign restrictions (NA - no restriction, 1 - positive restriction, -1 - negative restriction), distribution position parameters, distribution scale or shape1 parameters for t-distributions or inverted beta and beta distributions, distribution degrees of freedom or shape2 parameters for t-distributions or inverted beta and beta distributions, distribution skew parameters for t-distributions, indication for long-run restrictions (NA - no long-run restriction, 1 - long-run restriction), and random-walk proposal scale parameters for <em>A</em>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdetA</code></td>
<td>
<p><em>(1 x 1 x 6)</em> array where each slice of the third dimension contains the prior distributions (NA - no prior, 0 - symmetric t-distribution, 1 - non-central t-distribution, 2 - inverted beta distribution, 3 - beta distribution), sign restrictions (NA - no restriction, 1 - positive restriction, -1 - negative restriction), distribution position parameters, distribution scale or shape1 parameters for t-distributions or inverted beta and beta distributions, distribution degrees of freedom or shape2 parameters for t-distributions or inverted beta and beta distributions, and distribution skew parameters for t-distributions for the determinant of <em>A</em>, respectively (default = NULL). NULL indicates no priors for the determinant of <em>A</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pH</code></td>
<td>
<p><em>(n x n x 6)</em> array where <em>n</em> is the number of endogenous variables and each slice of the third dimension contains the prior distributions (NA - no prior, 0 - symmetric t-distribution, 1 - non-central t-distribution, 2 - inverted beta distribution, 3 - beta distribution), sign restrictions (NA - no restriction, 1 - positive restriction, -1 - negative restriction), distribution position parameters, distribution scale or shape1 parameters for t-distributions or inverted beta and beta distributions, distribution degrees of freedom or shape2 parameters for t-distributions or inverted beta and beta distributions, and distribution skew parameters for t-distributions for <em>H</em>, the inverse of <em>A</em>, respectively (default = NULL). NULL indicates no priors for the inverse of <em>A</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pP</code></td>
<td>
<p><em>(k x n)</em> matrix containing the prior position parameters for the reduced form lagged coefficient matrix <em><code class="reqn">\Phi</code></em> (default = NULL). <em><code class="reqn">k = n L + 1</code></em>, <em>n</em> is the number of endogenous variables, and <em>L</em> is the lag length. NULL indicates no priors for <em><code class="reqn">\Phi</code></em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pP_sig</code></td>
<td>
<p><em>(k x k)</em> matrix containing values indicating confidence in the priors for <em><code class="reqn">\Phi</code></em> (default = NULL). <em><code class="reqn">k = n L + 1</code></em>, <em>n</em> is the number of endogenous variables, and <em>L</em> is the lag length. NULL indicates no priors for <em><code class="reqn">\Phi</code></em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pR_sig</code></td>
<td>
<p><em>(k x k x n)</em> array containing values indicating confidence in long-run restrictions on the lagged structural coefficient matrix <em>B</em> (default = NULL). <em><code class="reqn">k = n L + 1</code></em>, <em>n</em> is the number of endogenous variables, and <em>L</em> is the lag length. NULL indicates no long-run restrictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa1</code></td>
<td>
<p><em>(1 x n)</em> matrix containing values indicating confidence in priors for the structural variances (default = NULL). <em>n</em> is the number of endogenous variables. NULL indicates no priors for structural variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itr</code></td>
<td>
<p>Integer specifying the total number of iterations for the algorithm (default = 5000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Integer specifying the number of draws to throw out at the beginning of the algorithm (default = 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Integer specifying the thinning parameter (default = 1). All draws beyond burn are kept when thin = 1. Draw 1, draw 3, etc. beyond burn are kept when thin = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cri</code></td>
<td>
<p>credibility intervals for the estimates to be returned (default = 0.95). A value of 0.95 will return 95% credibility intervals. A value of 0.90 will return 90% credibility intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimates the parameters of a Structural Bayesian Vector Autoregression model with the method developed in Baumeister and Hamilton (2015/2017/2018). The function returns a list containing the results.
</p>


<h3>Value</h3>

<p>A list containing the following:
</p>
<p>accept_rate: Acceptance rate of the algorithm.
</p>
<p>y and x: Matrices containing the endogenous variables and their lags.
</p>
<p>nlags: Numeric value indicating the number of lags included in the model.
</p>
<p>pA, pdetA, pH, pP, pP_sig, pR, pR_sig, tau1, and kappa1: Matrices and arrays containing prior information.
</p>
<p>A_start: Matrix containing estimates of the parameters in <em>A</em> from the optimization routine.
</p>
<p>A, detA, H, B, Phi, and D: Arrays containing estimates of the model parameters. The first, second, and third slices of the third dimension are lower, median, and upper bounds of the estimates.
</p>
<p>A_den, detA_den, and H_den: Lists containing the horizontal and vertical axis coordinates of posterior densities of <em>A</em>, <em>det(A)</em>, and <em>H</em>.
</p>
<p>A_chain, B_chain, D_chain, detA_chain, H_chain: Arrays containing the raw results for <em>A</em>, <em>B</em>, <em>D</em>, <em>detA</em>, <em>H</em>.
</p>
<p>Line and ACF plots of the estimates for <em>A</em>, <em>det(A)</em>, and <em>H</em>.
</p>


<h3>Author(s)</h3>

<p>Paul Richardson
</p>


<h3>References</h3>

<p>Baumeister, C., &amp; Hamilton, J.D. (2015). Sign restrictions, structural vector autoregressions, and useful prior information. <em>Econometrica</em>, 83(5), 1963-1999.
</p>
<p>Baumeister, C., &amp; Hamilton, J.D. (2017). Structural interpretation of vector autoregressions with incomplete identification: Revisiting the role of oil supply and demand shocks (No. w24167). National Bureau of Economic Research.
</p>
<p>Baumeister, C., &amp; Hamilton, J.D. (2018). Inference in structural vector autoregressions when the identifying assumptions are not fully believed: Re-evaluating the role of monetary policy in economic fluctuations. <em>Journal of Monetary Economics</em>, 100, 48-65.
</p>


<h3>See Also</h3>

<p>Dr. Christiane Baumeister's website <a href="https://sites.google.com/site/cjsbaumeister/">https://sites.google.com/site/cjsbaumeister/</a>.
</p>
<p>Dr. James D. Hamilton's website <a href="https://econweb.ucsd.edu/~jhamilton/">https://econweb.ucsd.edu/~jhamilton/</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Import data
library(BHSBVAR)
set.seed(123)
data(USLMData)
y0 &lt;- matrix(data = c(USLMData$Wage, USLMData$Employment), ncol = 2)
y &lt;- y0 - (matrix(data = 1, nrow = nrow(y0), ncol = ncol(y0)) %*% 
             diag(x = colMeans(x = y0, na.rm = FALSE, dims = 1)))
colnames(y) &lt;- c("Wage", "Employment")

# Set function arguments
nlags &lt;- 8
itr &lt;- 5000
burn &lt;- 0
thin &lt;- 1
cri &lt;- 0.95

# Priors for A
pA &lt;- array(data = NA, dim = c(2, 2, 8))
pA[, , 1] &lt;- c(0, NA, 0, NA)
pA[, , 2] &lt;- c(1, NA, -1, NA)
pA[, , 3] &lt;- c(0.6, 1, -0.6, 1)
pA[, , 4] &lt;- c(0.6, NA, 0.6, NA)
pA[, , 5] &lt;- c(3, NA, 3, NA)
pA[, , 6] &lt;- c(NA, NA, NA, NA)
pA[, , 7] &lt;- c(NA, NA, 1, NA)
pA[, , 8] &lt;- c(2, NA, 2, NA)

# Position priors for Phi
pP &lt;- matrix(data = 0, nrow = ((nlags * ncol(pA)) + 1), ncol = ncol(pA))
pP[1:nrow(pA), 1:ncol(pA)] &lt;-
  diag(x = 1, nrow = nrow(pA), ncol = ncol(pA))

# Confidence in the priors for Phi
x1 &lt;- 
  matrix(data = NA, nrow = (nrow(y) - nlags), 
         ncol = (ncol(y) * nlags))
for (k in 1:nlags) {
  x1[, (ncol(y) * (k - 1) + 1):(ncol(y) * k)] &lt;-
    y[(nlags - k + 1):(nrow(y) - k),]
}
x1 &lt;- cbind(x1, 1)
colnames(x1) &lt;- 
  c(paste(rep(colnames(y), nlags),
          "_L",
          sort(rep(seq(from = 1, to = nlags, by = 1), times = ncol(y)),
               decreasing = FALSE),
          sep = ""),
    "cons")
y1 &lt;- y[(nlags + 1):nrow(y),]
ee &lt;- matrix(data = NA, nrow = nrow(y1), ncol = ncol(y1))
for (i in 1:ncol(y1)) {
  xx &lt;- cbind(x1[, seq(from = i, to = (ncol(x1) - 1), by = ncol(y1))], 1)
  yy &lt;- matrix(data = y1[, i], ncol = 1)
  phi &lt;- solve(t(xx) %*% xx, t(xx) %*% yy)
  ee[, i] &lt;- yy - (xx %*% phi)
}
somega &lt;- (t(ee) %*% ee) / nrow(ee)
lambda0 &lt;- 0.2
lambda1 &lt;- 1
lambda3 &lt;- 100
v1 &lt;- matrix(data = (1:nlags), nrow = nlags, ncol = 1)
v1 &lt;- v1^((-2) * lambda1)
v2 &lt;- matrix(data = diag(solve(diag(diag(somega)))), ncol = 1)
v3 &lt;- kronecker(v1, v2)
v3 &lt;- (lambda0^2) * rbind(v3, (lambda3^2))
v3 &lt;- 1 / v3
pP_sig &lt;- diag(x = 1, nrow = nrow(v3), ncol = nrow(v3))
diag(pP_sig) &lt;- v3

# Confidence in long-run restriction priors
pR_sig &lt;-
  array(data = 0,
        dim = c(((nlags * ncol(y)) + 1),
                ((nlags * ncol(y)) + 1),
                ncol(y)))
Ri &lt;-
  cbind(kronecker(matrix(data = 1, nrow = 1, ncol = nlags),
                  matrix(data = c(1, 0), nrow = 1)),
        0)
pR_sig[, , 2] &lt;- (t(Ri) %*% Ri) / 0.1

# Confidence in priors for D
kappa1 &lt;- matrix(data = 2, nrow = 1, ncol = ncol(y))

# Set graphical parameters
par(cex.axis = 0.8, cex.main = 1, font.main = 1, family = "serif",
    mfrow = c(2, 2), mar = c(2, 2.2, 2, 1), las = 1)

# Estimate the parameters of the model
results1 &lt;- 
  BH_SBVAR(y = y, nlags = nlags, pA = pA, pP = pP, pP_sig = pP_sig,
           pR_sig = pR_sig, kappa1 = kappa1, itr = itr, burn = burn,
           thin = thin, cri = cri)
</code></pre>


</div>