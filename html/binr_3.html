<div class="container">

<table style="width: 100%;"><tr>
<td>bins</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cut Numeric Values Into Evenly Distributed Groups (Bins)</h2>

<h3>Description</h3>

<p><code>bins</code> - Cuts points in vector x into evenly distributed groups (bins).
<code>bins</code> takes 3 separate approaches to generating the cuts, picks the one
resulting in the least mean square deviation from the ideal cut -
<code>length(x) / target.bins</code> points in each bin - and then  merges small bins
unless excat.groups is <code>TRUE</code>
The 3 approaches are:
</p>

<ol>
<li>
<p>Use quantiles, and increase the number of even cuts up to max.breaks until the
number of groups reaches the desired number. See <code>bins.quantiles</code>. 
</p>
</li>
<li>
<p>Start with a single bin with all the data in it and perform bin splits until
either the desired number of bins is reached or there's no reduction in error
(the latter is ignored if <code>exact.groups</code> is <code>TRUE</code>). See <code>bins.split</code>. 
</p>
</li>
<li>
<p>Start with <code>length(table(x))</code> bins, each containing exactly one distinct value
and merge bins until the desired number of bins is reached. If <code>exact.groups</code> is
<code>FALSE</code>, continue merging until there's no further reduction in error.
See <code>bins.merge</code>. 
</p>
</li>
</ol>
<p>For each of these approaches, apply redistribution of points among existing bins
until there's no further decrease in error. See <code>bins.move</code>.
</p>
<p><code>bins.getvals</code> - Extracts cut points from the object retured by <code>bins</code>.
The cut points are always between the values in <code>x</code> and weighed such that
the cut point splits the area under the line from (lo, n1) to (hi, n2) in half.
</p>
<p><code>bins.merr</code> - Partitioning the data into bins using splitting, merging
and moving optimizes this error function, which is the mean squared error
of point counts in the bins relative to the optimal number of points per bin.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bins(x, target.bins, max.breaks = NA, exact.groups = F, verbose = F,
  errthresh = 0.1, minpts = NA)

bins.getvals(lst, minpt = -Inf, maxpt = Inf)

bins.merr(binct, target.bins)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of numbers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.bins</code></td>
<td>
<p>Number of groups desired; this is also the max number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.breaks</code></td>
<td>
<p>Used for initial cut. If <code>exact.groups</code> is <code>FALSE</code>, bins are merged
until there's no bins with fewer than <code>length(x) / max.breaks</code> points.
In <code>bins</code>, one of <code>max.breaks</code> and <code>minpts</code> must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.groups</code></td>
<td>
<p>if TRUE, the result will have exactly the number of target.bins;
if FALSE, the result may contain fewer than target.bins bins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Indicates verbose output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errthresh</code></td>
<td>
<p>If the error is below the provided value, stops after the first rough estimate of the bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpts</code></td>
<td>
<p>Minimum number of points in a bin.
In <code>bins</code>, one of <code>max.breaks</code> and <code>minpts</code> must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lst</code></td>
<td>
<p>The list returned by the <code>bins</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpt</code></td>
<td>
<p>The value replacing the lower bound of the cut points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpt</code></td>
<td>
<p>The value replacing the upper bound of the cut points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binct</code></td>
<td>
<p>The number of points falling into the bins.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The gains are computed using incremental analytical expresions derived for moving
a value from one bin to the next, splitting a bin into two or merging two bins.
</p>


<h3>Value</h3>

<p>A list containing the following items (not all of them may be present):
</p>

<ul>
<li>
<p>binlo - The "low" value falling into the bin.
</p>
</li>
<li>
<p>binhi - The "high" value falling into the bin.
</p>
</li>
<li>
<p>binct - The number of points falling into the bin.
</p>
</li>
<li>
<p>xtbl - The result of a call to <code>table(x)</code>.
</p>
</li>
<li>
<p>xval - The sorted unique values of the data points x. Essentially, a numeric version of <code>names(xtbl)</code>.
</p>
</li>
<li>
<p>changed - Flag indicating whether the bins have been modified by the function.
</p>
</li>
<li>
<p>err - Mean square root error between the resulting counts and ideal bins.
</p>
</li>
<li>
<p>imax - For the move, merge and split operations, the index of the bin with the maximum gain.
</p>
</li>
<li>
<p>iside - For the move operation, the side of the move: 0 = left, 1 = right.
</p>
</li>
<li>
<p>gain - Error gain obtained as the result of the function call.
</p>
</li>
</ul>
<p><code>bins.getvals</code> returns a vector of cut points extracted from the
<code>lst</code> object.
</p>


<h3>See Also</h3>

<p><code>binr</code>, <code>bins.greedy</code>, <code>bins.quantiles</code> <code>bins.optimize</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
   # Seriously skewed x:
   x &lt;- floor(exp(rnorm(200000 * 1.3)))
   cuts &lt;- bins(x, target.bins = 10, minpts = 2000)
   cuts$breaks &lt;- bins.getvals(cuts)
   cuts$binct
   #   [0, 0]    [1, 1]    [2, 2]    [3, 3]    [4, 4]    [5, 5]    [6, 7]   [8, 10]
   # 129868     66611     28039     13757      7595      4550      4623      2791
   #   [11, 199]
   # 2166

   # Centered x:
   x &lt;- rep(c(1:10,20,31:40), c(rep(1, 10), 100, rep(1,10)))
   cuts &lt;- bins(x, target.bins = 3, minpts = 10)
   cuts$binct
   # [1, 10] [20, 20] [31, 40]
   #      10      100       10

## End(Not run)
</code></pre>


</div>