<div class="container">

<table style="width: 100%;"><tr>
<td>read.dcd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Read CHARMM/X-PLOR/NAMD Binary DCD files </h2>

<h3>Description</h3>

<p>Read coordinate data from a binary DCD trajectory file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read.dcd(trjfile, big=FALSE, verbose = TRUE, cell = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trjfile</code></td>
<td>
<p> name of trajectory file to read. A vector if 
treat a batch of files </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>big</code></td>
<td>
<p> logical, if TRUE attempt to read large files into a
big.matrix object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> logical, if TRUE print details of the reading
process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell</code></td>
<td>
<p>logical, if TRUE return cell information only.
Otherwise, return coordinates.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Reads a CHARMM or X-PLOR/NAMD binary trajectory file with either big-
or little-endian storage formats.
</p>
<p>Reading is accomplished with two different sub-functions:
<code>dcd.header</code>, which reads header info, and <code>dcd.frame</code>, which
takes header information and reads atoms frame by frame producing an
nframes/natom*3 matrix of cartesian coordinates or an nframes/6 matrix
of cell parameters.
</p>


<h3>Value</h3>

<p>A numeric matrix of xyz coordinates with a frame/structure per row and
a Cartesian coordinate per column or a numeric matrix of cell information 
with a frame/structure per row and lengths and angles per column.
</p>


<h3>Note</h3>

<p>See CHARMM documentation for DCD format description.
</p>
<p>If you experience problems reading your trajectory file with read.dcd()
consider first reading your file into VMD and from there exporting a
new DCD trajectory file with the 'save coordinates' option. This new
file should be easily read with read.dcd().
</p>
<p>Error messages beginning 'cannot allocate vector of size' indicate a
failure to obtain memory, either because the size exceeded the
address-space limit for a process or, more likely, because the system
was unable to provide the memory. Note that on a 32-bit OS there may
well be enough free memory available, but not a large enough
contiguous block of address space into which to map it. In such cases
try setting the input option 'big' to TRUE. This is an experimental
option that results in a 'big.matrix' object.
</p>


<h3>Author(s)</h3>

<p> Barry Grant </p>


<h3>References</h3>

<p>Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695â€“2696.
</p>


<h3>See Also</h3>

 <p><code>read.pdb</code>, <code>write.pdb</code>,
<code>atom.select</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Redundant testing excluded

##-- Read cell parameters from example trajectory file
trtfile &lt;- system.file("examples/hivp.dcd", package="bio3d")
trj &lt;- read.dcd(trtfile, cell = TRUE)
##-- Read coordinates from example trajectory file
trj &lt;- read.dcd(trtfile)

## Read the starting PDB file to determine atom correspondence
pdbfile &lt;- system.file("examples/hivp.pdb", package="bio3d")
pdb &lt;- read.pdb(pdbfile)

## select residues 24 to 27 and 85 to 90 in both chains
inds &lt;- atom.select(pdb, resno=c(24:27,85:90), elety='CA')

## lsq fit of trj on pdb
xyz &lt;- fit.xyz(pdb$xyz, trj, fixed.inds=inds$xyz, mobile.inds=inds$xyz)

##-- RMSD of trj frames from PDB
r1 &lt;- rmsd(a=pdb, b=xyz)


## Not run: 
# Pairwise RMSD of trj frames for positions 47 to 54
flap.inds &lt;- atom.select(pdb, resno=c(47:54), elety='CA')
p &lt;- rmsd(xyz[,flap.inds$xyz])
# plot highlighting flap opening?
plot.dmat(p, color.palette = mono.colors)

## End(Not run)

</code></pre>


</div>