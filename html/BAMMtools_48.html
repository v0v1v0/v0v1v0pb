<div class="container">

<table style="width: 100%;"><tr>
<td>speciesByRatesMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute species-specific rate through time trajectories</h2>

<h3>Description</h3>

<p>Computes the mean of the marginal posterior density of
speciation/extinction or phenotypic rates for equally spaced points
along the root to tip path for each species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">speciesByRatesMatrix(ephy, nslices, index = NULL, spex = "s")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ephy</code></td>
<td>
<p>An object of class <code>bammdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nslices</code></td>
<td>
<p>An integer number of time slices. This determines the
number of equally spaced points in time at which rates are computed
for each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>An integer or vector of mode integer indicating which
posterior samples to use in the calculation. If <code>NULL</code> (default)
all samples are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spex</code></td>
<td>
<p>A character string. "s" (default) calculates speciation rates;
"e" calculates extinction rates; "netdiv" calculates diversification
rates. Ignored if <code>ephy$type = "trait"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li>
<p> times: A vector of time points where rates were
calculated.
</p>
</li>
<li>
<p> rates: A species X times matrix of rate through time
trajectories.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Mike Grundler
</p>


<h3>References</h3>

<p><a href="http://bamm-project.org/">http://bamm-project.org/</a>
</p>


<h3>See Also</h3>

<p><code>getRateThroughTimeMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(whales, events.whales)
ed &lt;- getEventData(whales, events.whales, burnin=0.25, nsamples=500)
ratemat &lt;- speciesByRatesMatrix(ed, nslices = 100)

dolphins &lt;- extract.clade(whales, 140)$tip.label
plot.new()
plot.window(xlim = c(0, 35), ylim = c(0, 0.8))
for (i in 1:nrow(ratemat$rates)) {
	if (whales$tip.label[i] %in% dolphins) {
		lines(ratemat$times, ratemat$rates[i,], lwd = 2, col = 4)	
	} else {
		lines(ratemat$times, ratemat$rates[i,], lwd = 2, col = 8)
	}
}
axis(1, seq(-5, 35, 5))
axis(2, seq(-0.2, 0.8, 0.2), las = 1)
mtext("Time since root", 1, line = 2.5)
mtext("Speciation rate", 2, line = 2.5)

</code></pre>


</div>