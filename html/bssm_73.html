<div class="container">

<table style="width: 100%;"><tr>
<td>sim_smoother</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation Smoothing</h2>

<h3>Description</h3>

<p>Function <code>sim_smoother</code> performs simulation smoothing i.e. simulates
the states from the conditional distribution <code class="reqn">p(\alpha | y, \theta)</code>
for linear-Gaussian models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_smoother(model, nsim, seed, use_antithetic = TRUE, ...)

## S3 method for class 'lineargaussian'
sim_smoother(
  model,
  nsim = 1,
  seed = sample(.Machine$integer.max, size = 1),
  use_antithetic = TRUE,
  ...
)

## S3 method for class 'nongaussian'
sim_smoother(
  model,
  nsim = 1,
  seed = sample(.Machine$integer.max, size = 1),
  use_antithetic = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model of class <code>bsm_lg</code>, <code>ar1_lg</code>
<code>ssm_ulg</code>, or <code>ssm_mlg</code>, or one of the non-gaussian models
<code>bsm_ng</code>, <code>ar1_ng</code> <code>svm</code>,
<code>ssm_ung</code>, or <code>ssm_mng</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of samples (positive integer). Suitable values
depend on the model and the data, and while larger values provide more
accurate estimates, the run time also increases with respect to to the
number of samples, so it is generally a good idea to test the filter first
with a small number of samples, e.g., less than 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the C++ RNG (positive integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_antithetic</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), use antithetic
variable for location in simulation smoothing. Ignored for <code>ssm_mng</code>
models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For non-Gaussian/non-linear models, the simulation is based on the
approximating Gaussian model.
</p>


<h3>Value</h3>

<p>An array containing the generated samples.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># only missing data, simulates from prior
model &lt;- bsm_lg(rep(NA, 25), sd_level = 1, 
  sd_y = 1)
# use antithetic variable for location
sim &lt;- sim_smoother(model, nsim = 4, use_antithetic = TRUE, seed = 1)
ts.plot(sim[, 1, ])
cor(sim[, 1, ])
</code></pre>


</div>