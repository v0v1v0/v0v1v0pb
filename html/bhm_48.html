<div class="container">

<table style="width: 100%;"><tr>
<td>llm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an L-shape linear model</h2>

<h3>Description</h3>

<p>Fit an L-shape linear model with the cut point estimated by the profile likelihood method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
llm(formula, data=list(...), epsilon = 0.025, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>": a sympolic description of the model to be fitted. The details of model specificatoin are given under 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or enviroment containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Step width for the profile likelihood method, default is 0.025</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level regression fitting functions (see below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Define a L shape linear funcation that change slope at c0:
</p>
<p>when x &lt;c0, y = b1 + b2*x
</p>
<p>when x&gt;=c0, y = b1 + b2*x  + b3*(x-x0)
= (b1-b3*c0) + (b2+b3)*x
</p>


<h3>Value</h3>

<p>llm returns an object of class inheriting from "llm" which inherits from the class glm. See later in this section.
</p>
<p>An object of class "llm" is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients from 'llm'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals, that is response minus fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the 'terms' object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.max</code></td>
<td>
<p>the maximum likelihood estimate for the threshold parameter(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the log-likelihood with the final values of the coefficients.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bingshu E. Chen (bingshu.chen@queensu.ca)
</p>


<h3>References</h3>

<p>Liu, S. S. and Chen, B. E. (2020). Continuous threshold models with two-way interactions in survival analysis. Canadian Journal of Statistics. Vol. 48, page 751-772.
</p>


<h3>See Also</h3>


<p><code>brm</code>, 
<code>lm</code>,
<code>glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### simulate the data and fit a L-shape model.
n = 50 ; p &lt;- 2
X = matrix(rnorm(n * p), n, p) # no intercept!
w = X[, 1]; age = X[, 2]

wc = w - 0.2; sigma = 0.25
y = rnorm(n, -0.1+0.7*w-1.2*ifelse(wc&gt;0, wc, 0), sigma)

fit=llm(y~w+age)
print(fit)
print(summary(fit))
#### to plot the L-shape function
# plot(fit)
</code></pre>


</div>