<div class="container">

<table style="width: 100%;"><tr>
<td>normGibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a sample from a posterior distribution of data with an unknown mean and
variance using Gibbs sampling</h2>

<h3>Description</h3>

<p>normGibbs draws a Gibbs sample from the posterior distribution of the
parameters given the data fron normal distribution with unknown mean and
variance.  The prior for <code class="reqn">\mu</code> given <code class="reqn">var</code> is prior mean <code class="reqn">m0</code>
and prior variance <code class="reqn">var/n0</code> .  That means <code class="reqn">n0</code> is the 'equivalent
sample size.' The prior distribution of the variance is <code class="reqn">s0</code> times an
inverse chi-squared with <code class="reqn">kappa0</code> degrees of freedom. The joint prior is
the product <code class="reqn">g(var)g(mu|var)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normGibbs(y, steps = 1000, type = "ind", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector containing the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>The number of iterations of Gibbs sampling to carry out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Either 'ind' for sampling from an independent conjugate prior or
'joint' for sampling from a joint conjugate prior. 'i' and 'j' can be used
as compact notation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>If type = 'ind' then the user can specify the prior for
<code class="reqn">\mu</code> with a parameter priorMu which can either be a single number m0,
or m0 and n0. if m0 and n0 are not specified then m0 and n0 are 0 by
default. The user can also specify priorVar, which if given, must be a
vector with two elements s0 and kappa0. If s0 and kappa0 are not given then
they are zero by default. If type = 'joint' then priorMu must be a vector of
length two with elements m0 and sd0.  The user can also specify priorVar,
which if given, must be a vector with two elements s0 and kappa0. If s0 and
kappa0 are not given then they are zero by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame containing three variables </p>

<table>
<tr>
<td style="text-align: right;"> [1,] </td>
<td style="text-align: left;"> mu
</td>
<td style="text-align: left;"> a sample from the posterior distribution of the mean </td>
</tr>
<tr>
<td style="text-align: right;"> [2,] </td>
<td style="text-align: left;"> sig
</td>
<td style="text-align: left;"> a sample from the posterior distribution of the standard deviation </td>
</tr>
<tr>
<td style="text-align: right;">
[3,] </td>
<td style="text-align: left;"> mu </td>
<td style="text-align: left;"> a sample from the posterior distribution of the variance =
sig^2 </td>
</tr>
<tr>
<td style="text-align: right;"> </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James M. Curran
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## firstly generate some random data
mu = rnorm(1)
sigma = rgamma(1,5,1)
y = rnorm(100, mu, sigma)

## A \eqn{N(10,3^2)} prior for \eqn{\mu} and a 25 times inverse chi-squared
## with one degree of freedom prior for \eqn{\sigma^2}
MCMCSampleInd = normGibbs(y, steps = 5000, priorMu = c(10,3),
                           priorVar = c(25,1))


## We can also use a joint conjugate prior for \eqn{\mu} and \eqn{\sigma^2}.
## This will be a \emph{normal}\eqn{(m,\sigma^2/n_0)} prior for \eqn{\mu} given
## the variance \eqn{\sigma^2}, and an \eqn{s0} times an \emph{inverse
## chi-squared} prior for \eqn{\sigma^2}.
MCMCSampleJoint = normGibbs(y, steps = 5000, type = 'joint',
                             priorMu = c(10,3), priorVar = c(25,1))

## Now plot the results
oldPar = par(mfrow=c(2,2))

plot(density(MCMCSampleInd$mu),xlab=expression(mu), main =
'Independent')
abline(v=mu)
plot(density(MCMCSampleInd$sig),xlab=expression(sig), main =
'Independent')
abline(v=sigma)

plot(density(MCMCSampleJoint$mu),xlab=expression(mu), main =
'Joint')
abline(v=mu)
plot(density(MCMCSampleJoint$sig),xlab=expression(sig), main =
'Joint')
abline(v=sigma)


</code></pre>


</div>