<div class="container">

<table style="width: 100%;"><tr>
<td>predict.BTglmmPQL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict Method for BTglmmPQL Objects</h2>

<h3>Description</h3>

<p>Obtain predictions and optionally standard errors of those predictions from
a <code>"BTglmmPQL"</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'BTglmmPQL'
predict(
  object,
  newdata = NULL,
  newrandom = NULL,
  level = ifelse(object$sigma == 0, 0, 1),
  type = c("link", "response", "terms"),
  se.fit = FALSE,
  terms = NULL,
  na.action = na.pass,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted object of class <code>"BTglmmPQL"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>(optional) a data frame in which to look for variables with
which to predict.  If omitted, the fitted linear predictors are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newrandom</code></td>
<td>
<p>if <code>newdata</code> is provided, a corresponding design
matrix for the random effects, will columns corresponding to the random
effects estimated in the original model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an integer vector giving the level(s) at which predictions are
required. Level zero corresponds to population-level predictions (fixed
effects only), whilst level one corresponds to the individual-level
predictions (full model) which are NA for contests involving individuals not
in the original data. By default <code>level = 0</code> if the model converged to a
fixed effects model, <code>1</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of prediction required.  The default is on the scale of
the linear predictors; the alternative <code>"response"</code> is on the scale of
the response variable. Thus for a default binomial model the default
predictions are of log-odds (probabilities on logit scale) and <code>type = "response"</code> gives the predicted probabilities. The <code>"terms"</code> option
returns a matrix giving the fitted values of each term in the model formula
on the linear predictor scale (fixed effects only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>logical switch indicating if standard errors are required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>with <code>type ="terms"</code> by default all terms are returned.  A
character vector specifies which terms are to be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>function determining what should be done with missing
values in <code>newdata</code>.  The default is to predict <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>newdata</code> is omitted the predictions are based on the data used for
the fit.  In that case how cases with missing values in the original fit are
treated is determined by the <code>na.action</code> argument of that fit.  If
<code>na.action = na.omit</code> omitted cases will not appear in the residuals,
whereas if <code>na.action = na.exclude</code> they will appear (in predictions
and standard errors), with residual value <code>NA</code>.  See also
<code>napredict</code>.
</p>
<p>Standard errors for the predictions are approximated assuming the variance
of the random effects is known, see Booth and Hobert (1998).
</p>


<h3>Value</h3>

<p>If <code>se.fit = FALSE</code>, a vector or matrix of predictions.  If
<code>se = TRUE</code>, a list with components </p>
<table>
<tr style="vertical-align: top;">
<td><code>fit </code></td>
<td>
<p>Predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit </code></td>
<td>
<p>Estimated standard errors</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Heather Turner
</p>


<h3>References</h3>

<p>Booth, J. G. and Hobert, J. P. (1998). Standard errors of
prediction in Generalized Linear Mixed Models. <em>Journal of the American
Statistical Association</em> <strong>93</strong>(441), 262 â€“ 272.
</p>


<h3>See Also</h3>

<p><code>predict.glm()</code>, <code>predict.BTm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
seedsModel &lt;- glmmPQL(cbind(r, n - r) ~ seed + extract,
                      random = diag(nrow(seeds)),
                      family = binomial,
                      data = seeds)

pred &lt;- predict(seedsModel, level = 0)
predTerms &lt;- predict(seedsModel, type = "terms")

all.equal(pred, rowSums(predTerms) + attr(predTerms, "constant"))

</code></pre>


</div>