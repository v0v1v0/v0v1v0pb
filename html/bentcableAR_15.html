<div class="container">

<table style="width: 100%;"><tr>
<td>cable.change.conf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Confidence Interval for CTP of AR(p) Bent Cable </h2>

<h3>Description</h3>

<p>The <em>critical time point</em> (CTP) is estimated and
accompanied by a Wald confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cable.change.conf(ar.p.fit, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ar.p.fit</code></td>
<td>
<p> A <code>cable.ar.p.iter</code> object for AR(p<code class="reqn">\ge</code>0)
data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p> A numeric value between 0 and 1, exclusive. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CTP is the unique time point at which the cable's 
slope changes sign. If this exists, then it must happen
inside the transition <code class="reqn">\tau\pm\gamma</code>, and is estimated
by this function based on the bent-cable regression
supplied as <code>ar.p.fit</code>. Additionally, an approximate
confidence interval using the Wald method is obtained by
estimating the asymptotic variance of the CTP estimator.
Variance estimation involves inverting an approximate
Fisher information matrix by calling the built-in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
function <code>solve</code>.
</p>
<p><code>cable.change.conf</code> returns an error if the CTP (almost) 
does not exist, e.g. when the estimated bent cable slope 
(almost) does not change signs, or when the fit from
<code>ar.p.fit</code> is obtained with a time vector that is not
<code>c(0,1,2,...)</code>. See <b>Warnings</b> below.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>change.hat</code></td>
<td>
<p> The estimated CTP. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var </code></td>
<td>
<p> The estimated asymptotic variance of the CTP estimator. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p> The 100*<code>level</code> percent Wald confidence interval 
for the CTP. </p>
</td>
</tr>
</table>
<h3>Warnings</h3>

<p>Computations for the CTP estimate and confidence interval are based on a time
vector of the form <code>c(0,1,2,...)</code>. For any other form for the time
vector, the CTP will not be computed, and on-screen warnings
will appear. To ensure compatibility between the model fit and CTP
estimates, the user is advised to fit the model using the default
time vector. Then, if necessary, the user may transform the results
to the preferred time scale after the model and CTP estimates have
been produced.
</p>
<p>The above computational issue implies that the function cannot
handle non-time-series data. <b>Rationale</b>:
In a non-time-series context design points are often
non-equidistant, and the cable's slope often never changes sign;
even with a sign change, the point at which this takes place may be
less interpretable. In such a context, the user is advised to rely
on confidence regions for <code class="reqn">(\tau,\gamma)</code> (see
<b>References</b>).
</p>


<h3>Note</h3>

<p>This function is intended for internal use by <code>bentcable.ar</code>.
</p>


<h3>Author(s)</h3>

<p> Grace Chiu </p>


<h3>References</h3>

<p> See the <code>bentcableAR</code> package references. </p>


<h3>See Also</h3>

 <p><code>solve</code>, <code>cable.ar.p.plot</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(sockeye)

# AR(2) cable fit
fit.ar2 &lt;- cable.ar.p.iter( c(13,.1,-.5,11,4,.5,-.5),
	sockeye$logReturns, tol=1e-4 )
cable.change.conf( fit.ar2, .9 )

	# compare to this:
	# fit.ar2 &lt;- bentcable.ar( sockeye$logReturns, 
	#	init.cable=c(13,.1,-.5,11,4), p=2, ci.level=.9 )
	# cable.change.conf( fit.ar2$cable, .9 )

# AR(2) stick fit
stick.ar2 &lt;- cable.ar.p.iter( c(13,.1,-.5,11,.5,-.5),
	sockeye$logReturns, tol=1e-4, stick=TRUE)
cable.change.conf( stick.ar2, .9)
	# compare to this:
	# stick.ar2 &lt;- bentcable.ar( sockeye$logReturns,
	#	init.cable=c(13,.1,-.5,11), p=2, stick=TRUE, ci.level=.9 )
	#	cable.change.conf( stick.ar2$cable, .9 )

# AR(4) stick fit
fit.ar4 &lt;- cable.ar.p.iter( c(13,.1,-.5,11,.5,-.5,.5,-.5),
	sockeye$logReturns, tol=1e-4, stick=TRUE )
cable.change.conf( fit.ar4, .9 )

	# compare to this:
	# fit.ar4 &lt;- bentcable.ar( sockeye$logReturns,
	#	init.cable=c(13,.1,-.5,11), p=4, stick=TRUE, ci.level=.9 )
	# cable.change.conf( fit.ar4$cable, .9 )
</code></pre>


</div>