<div class="container">

<table style="width: 100%;"><tr>
<td>covariates.grob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create one or more covariate bars</h2>

<h3>Description</h3>

<p>Takes a list of covariate bar annotates and creates a grid graphical object for them</p>


<h3>Usage</h3>

<pre><code class="language-R">covariates.grob(
	covariates,
	ord,
	side = 'right',
	size = 1,
	grid.row = NULL,
	grid.col = NULL,
	grid.border = NULL,
	row.lines = NULL,
	col.lines = NULL,
	reorder.grid.index = FALSE,
        x = 0.5,
        y = 0.5
	);
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>Any covariate annotate to add to the plot, as a fully formed list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>A vector of integer indices indicating the order of the items in the covariate bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>Intended position of the covariate bar when added as a legend. Allowed positions are “right” and “top”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>The size of each covariate bar in units of “lines”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.row</code></td>
<td>
<p>A list of parameters to be passed to <code>gpar</code> specifying the behaviour of row lines in the covariate bars. See <code>Notes</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.col</code></td>
<td>
<p>A list of parameters to be passed to <code>gpar</code> specifying the behaviour of column lines in the covariate bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.border</code></td>
<td>
<p>A list of parameters to be passed to <code>gpar</code> specifying the behaviour of the border around the covariate bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.lines</code></td>
<td>
<p>Vector of row indices where grid lines should be drawn. If NULL (default), all row lines are drawn. Ignored if <code>grid.row</code> is not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lines</code></td>
<td>
<p>Vector of column indices where grid lines should be drawn. If NULL (default), all column lines are drawn. Ignored if <code>grid.col</code> is not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder.grid.index</code></td>
<td>
<p>Boolean specifying whether grid line indices should be re-ordered according to the <code>ord</code> argument. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x coordinate in npc coordinate system</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y coordinate in npc coordinate system</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A grid graphical object (grob) representing the covariate bar(s)</p>


<h3>Notes</h3>

<p>This code is an adaptation of the <code>dendrogramGrob</code> function in the <code>latticeExtra</code> package. It uses functions of the <code>grid</code> package.
</p>
<p>By default, the covariate bar grid is drawn via borders around individual rectangles using the parameters specified in the <code>covariates</code> argument (col, lwd, etc.). If <code>grid.row</code>, <code>grid.col</code>, or <code>grid.border</code> are specified by the user, additional grid lines are drawn over any existing ones using the parameters in these lists.
</p>


<h3>Author(s)</h3>

<p>Lauren Chong</p>


<h3>See Also</h3>

<p><code>gpar</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># The 'cairo' graphics is preferred but on M1 Macs this is not available
bitmap.type = getOption('bitmapType')
if (capabilities('cairo')) {
	bitmap.type &lt;- 'cairo';
	}

# create temp data
set.seed(1234567890);

x &lt;- outer(-5:5, -5:5, '*') + matrix(nrow = 11, ncol = 11, data = runif(11 * 11));
colnames(x) &lt;- paste('col', 1:11, sep = '-');
rownames(x) &lt;- paste('row', 1:11, sep = '-');

# set covariates
covariate.colours1 &lt;- x[,1]
covariate.colours1[covariate.colours1 &gt;= 0] &lt;- default.colours(3)[1];
covariate.colours1[covariate.colours1 != default.colours(3)[1]] &lt;- default.colours(3)[2];

covariate.colours2 &lt;- x[,1]
covariate.colours2[covariate.colours2 &gt;= 0] &lt;- default.colours(3)[2];
covariate.colours2[covariate.colours2 != default.colours(3)[2]] &lt;- default.colours(3)[3];

# create an object to draw the covariates from
covariates1 &lt;- list(
    rect = list(
        col = 'black',
        fill = covariate.colours1,
        lwd = 1.5
        ),
    rect = list(
        col = 'black',
        fill = covariate.colours2,
        lwd = 1.5
        )
    );

# create a covariates grob using a simple incremental ordering and default behaviour
covariates.grob1 &lt;- covariates.grob(
    covariates = covariates1,
    ord = c(1:ncol(x)),
    side = 'right'
    );

# create a dendrogram for x
cov.dendrogram &lt;- BoutrosLab.plotting.general::create.dendrogram(
    x = x,
    clustering.method = 'average'
    );

covariates2 &lt;-list(
    rect = list(
        col = 'black',
        fill = covariate.colours2,
        lwd = 1.5
        )
    );

# create a covariates grob using the dendrogram ordering and double the default size
covariates.grob2 &lt;- covariates.grob(
    covariates = covariates2,
    ord = order.dendrogram(cov.dendrogram),
    side = 'top',
    size = 2
    );

# add a border of a different colour
covariates.grob3 &lt;- covariates.grob(
    covariates = covariates1,
    ord = c(1:ncol(x)),
    side = 'right',
    grid.border = list(col = 'red', lwd = 1.5)
    );

# create covariates with transparent rectangle borders
covariates3 &lt;- list(
    rect = list(
        col = 'transparent',
        fill = covariate.colours1,
        lwd = 1.5
        ),
    rect = list(
        col = 'transparent',
        fill = covariate.colours2,
        lwd = 1.5
        )
    );

# add column grid lines and a border with default gpar settings
covariates.grob4 &lt;- covariates.grob(
    covariates = covariates3,
    ord = c(1:nrow(x)),
    side = 'top',
    grid.col = list(col = 'black', lty = 3),
    grid.border = list()
    );

# draw a subset of row/column lines
covariates.grob5 &lt;- covariates.grob(
    covariates = covariates3,
    ord = order.dendrogram(cov.dendrogram),
    side = 'right',
    grid.row = list(lineend = 'butt', lwd = 2),
    row.lines = 6,
    reorder.grid.index = FALSE, # note: this is already set by default
    grid.col = list(lty = 2),
    col.lines = c(0,1)
    );
</code></pre>


</div>