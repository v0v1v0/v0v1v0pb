<div class="container">

<table style="width: 100%;"><tr>
<td>np.boxcoxmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Response Transformations for Random Effect and Variance Component Models</h2>

<h3>Description</h3>

<p>The function <code>np.boxcoxmix()</code> fits an overdispersed generalized linear model
and variance component models using nonparametric profile maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">np.boxcoxmix(
  formula,
  groups = 1,
  data,
  K = 3,
  tol = 0.5,
  lambda = 1,
  steps = 500,
  EMdev.change = 1e-04,
  plot.opt = 1,
  verbose = TRUE,
  start = "gq",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the transformed response and the fixed
effect model (e.g. y ~ x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>the random effects. To fit overdispersion models , set <code>groups</code> = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables used in the fixed and random
effect models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of mass points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a positive scalar (usually, 0&lt; <code>tol</code> &lt;= 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a transformation parameter, setting <code>lambda</code>=1 means 'no
transformation'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>maximum number of iterations for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMdev.change</code></td>
<td>
<p>a small scalar, with default 0.0001, used to determine
when to stop EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>Set <code>plot.opt=1</code>, to plot the disparity against
iteration number. Use <code>plot.opt=2</code> for <code>tolfind.boxcox()</code> and <code>plot.opt=3</code>
for <code>optim.boxcox()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If set to FALSE, no printed output on progress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a description of the initial values to be used in the fitted
model, Quantile-based version "quantile" or Gaussian Quadrature "gq" can be
set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Box-Cox transformation (Box &amp; Cox, 1964) is applied to the overdispersed
generalized linear models and variance component models with an unspecified
mixing distribution. The NPML estimate of the mixing distribution is known
to be a discrete distribution involving a finite number of mass-points and corresponding
masses (Aitkin et al., 2009). An Expectation-Maximization (EM) algorithm is
used for fitting the finite mixture distribution, one needs to specify the
number of components <code>K</code> of the finite mixture in advance. To stop the EM-algorithm
when it reached its convergence point, we need to defined the convergence criteria that is 
the absolute change in the successive log-likelihood function values being less than an arbitrary 
parameter such as <code>EMdev.change</code> = 0.0001 (Einbeck et at., 2014). This algorithm can be 
implemented using the function <code>np.boxcoxmix()</code>, which is designed to account for 
overdispersed generalized linear models and variance component models using the non-parametric
profile maximum likelihood (NPPML) estimation.
</p>
<p>The ability of the EM algorithm to locate the global maximum in fewer iterations
can be affected by the choice of initial values, the function <code>np.boxcoxmix()</code>
allows us to choose from two different methods to set the initial value of the mass
points. When option "gq" is set, then Gauss-Hermite masses and mass points are used
as starting points in the EM algorithm, while setting start= "quantile" uses the 
Quantile-based version to select the starting points.
</p>


<h3>Value</h3>

<p>List with class being either <code>boxcoxmix</code> or <code>boxcoxmixpure</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mass.point</code></td>
<td>
<p>the fitted mass points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the masses corresponding to the mixing proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the
vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the standard deviation of the mixing distribution (the square root of the variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the standard error of the estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a matrix of posterior probabilities that element i comes from cluster k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the log-likelihood of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete.loglik</code></td>
<td>
<p>the complete log-likelihood of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disparity</code></td>
<td>
<p>the disparity of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMiteration</code></td>
<td>
<p>provides the number of iterations of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EMconverged</code></td>
<td>
<p>TRUE means the EM algorithm converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the Akaike information criterion of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the Bayesian information criterion of the fitted regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>the fitted values for the individual observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.transformed</code></td>
<td>
<p>the fitted values for
the individual transformed observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the difference between the observed values and the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals.transformed</code></td>
<td>
<p>the difference between the transformed observed values and the transformed fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predicted.re</code></td>
<td>
<p>a vector of predicted residuals.</p>
</td>
</tr>
</table>
<p>The other outcomes are not relevant to users and they are intended for internal use only.
</p>


<h3>Author(s)</h3>

<p>Amani Almohaimeed and Jochen Einbeck
</p>


<h3>References</h3>

<p>Box G. and Cox D. (1964). An analysis of transformations. Journal of
the Royal Statistical Society. Series B (Methodological), pages 211-252.
</p>
<p>Aitkin, M. A., Francis, B., Hinde, J., and Darnell, R. (2009). Statistical
modelling in R. Oxford University Press Oxford.
</p>
<p>Jochen Einbeck, Ross Darnell and John Hinde (2014). npmlreg:
Nonparametric maximum likelihood estimation for random effect
models. R package version 0.46-1.
</p>


<h3>See Also</h3>

<p><code>optim.boxcox</code>, <code>tolfind.boxcox</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Pennsylvanian Hospital Stay Data
data(hosp, package = "npmlreg")
test1 &lt;- np.boxcoxmix(duration ~ age + wbc1, data = hosp, K = 2, tol = 1, 
    start = "quantile", lambda = 1)
round(summary(test1)$w, digits = 3)
# [1,] 1.000 0.000

# Refinery yield of gasoline Data
data(Gasoline, package = "nlme")
test2.vc &lt;- np.boxcoxmix(yield ~ endpoint + vapor, groups = Gasoline$Sample, 
      data = Gasoline, K = 3, tol = 1.7, start = "quantile", lambda = 0)
test2.vc$disparity
# [1] 176.9827








</code></pre>


</div>