<div class="container">

<table style="width: 100%;"><tr>
<td>BMTfit.mqde</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimum Quantile Distance Fit of the BMT Distribution to Non-censored 
Data.</h2>

<h3>Description</h3>

<p>Fit of the BMT distribution to non-censored data by minimum 
quantile distance (mqde), which can also be called maximum quantile 
goodness-of-fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BMTfit.mqde(data, probs = (1:length(data) - 0.5)/length(data), qtype = 5,
  dist = "euclidean", start = list(p3 = 0.5, p4 = 0.5, p1 = min(data) - 0.1,
  p2 = max(data) + 0.1), fix.arg = NULL, type.p.3.4 = "t w",
  type.p.1.2 = "c-d", optim.method = "Nelder-Mead", custom.optim = NULL,
  weights = NULL, silent = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector with the observed values for non-censored data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A numeric vector of the probabilities for which the minimum 
quantile distance estimation is done. <code class="reqn">p[k] = (k - 0.5) / n</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtype</code></td>
<td>
<p>The quantile type used by the R <code>quantile</code> function 
to compute the empirical quantiles. Type 5 (default), i.e. <code class="reqn">x[k]</code> is 
both the <code class="reqn">k</code>th order statistic and the type 5 sample quantile of 
<code class="reqn">p[k] = (k - 0.5) / n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>The distance measure between observed and theoretical quantiles to
be used. This must be one of "euclidean" (default), "maximum", or 
"manhattan". Any unambiguous substring can be given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list giving the initial values of parameters of the BMT 
distribution or a function of data computing initial values and returning a 
named list. (see the 'details' section of 
<code>mledist</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters of
the BMT distribution or a function of data computing (fixed) parameter 
values and returning a named list. Parameters with fixed value are thus NOT 
estimated. (see the 'details' section of 
<code>mledist</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.p.3.4</code></td>
<td>
<p>Type of parametrization asociated to p3 and p4. "t w" means 
tails weights parametrization (default) and "a-s" means asymmetry-steepness 
parametrization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.p.1.2</code></td>
<td>
<p>Type of parametrization asociated to p1 and p2. "c-d" means 
domain parametrization (default) and "l-s" means location-scale 
parametrization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p><code>"default"</code> (see the 'details' section of 
<code>mledist</code>) or optimization method to pass to 
<code>optim</code>. Given the close-form expression of the quantile 
function, two optimization methods were added when the euclidean distance is
selected: Coordinate descend (<code>"CD"</code>) and Newton-Rhapson (<code>"NR"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom.optim</code></td>
<td>
<p>A function carrying the optimization (see the 'details' 
section of <code>mledist</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting process. 
Should be <code>NULL</code> or a numeric vector with strictly positive numbers. 
If non-<code>NULL</code>, weighted mqde is used, otherwise ordinary mqde.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>A logical to remove or show warnings when bootstraping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to generic functions or to the 
function <code>"mqdedist"</code>. See <code>mqdedist</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is not intended to be called directly but is internally
called in <code>BMTfit</code> when used with the minimum quantile distance 
method.
</p>
<p><code>BMTfit.mqde</code> is based on the function <code>mqdedist</code> but it 
focuses on the minimum quantile distance parameter estimation for the BMT 
distribution (see <code>BMT</code> for details about the BMT distribution 
and <code>mqdedist</code> for details about minimum quantile distance fit 
of univariate distributions).
</p>
<p>Given the close-form expression of the quantile 
function, two optimization methods were added when the euclidean distance is
selected: Coordinate descend (<code>"CD"</code>) and Newton-Rhapson (<code>"NR"</code>).
</p>


<h3>Value</h3>

<p><code>BMTfit.mqde</code> returns a list with following components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p> the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p> an integer code for the convergence of 
<code>optim</code>/<code>constrOptim</code> defined as below or defined by
the user in the user-supplied optimization function.
</p>
<p><code>0</code> indicates successful convergence.
</p>
<p><code>1</code> indicates that the iteration limit of <code>optim</code> has been 
reached.
</p>
<p><code>10</code> indicates degeneracy of the Nealder-Mead simplex.
</p>
<p><code>100</code> indicates that <code>optim</code> encountered an internal error.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>the value of the corresponding objective function of the 
estimation method at the estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>a symmetric matrix computed by <code>optim</code> as an 
estimate of the Hessian at the solution found or computed in the 
user-supplied optimization function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the log-likelihood value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p> the probability vector on which observed and theoretical 
quantiles were calculated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p> the name of the distance between observed and theoretical 
quantiles used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.function</code></td>
<td>
<p>the name of the optimization function used for maximum
product of spacing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>when <code>optim</code> is used, the name of the 
algorithm used, <code>NULL</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg</code></td>
<td>
<p>the named list giving the values of parameters of the named 
distribution that must kept fixed rather than estimated or <code>NULL</code> if 
there are no such parameters. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.arg.fun</code></td>
<td>
<p>the function used to set the value of <code>fix.arg</code> or 
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the vector of weigths used in the estimation process or 
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A two-element integer vector giving the number of calls to the
log-likelihood function and its gradient respectively. This excludes those 
calls needed to compute the Hessian, if requested, and any calls to 
log-likelihood function to compute a finite-difference approximation to the 
gradient. <code>counts</code> is returned by <code>optim</code> or the 
user-supplied function or set to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.message</code></td>
<td>
<p>A character string giving any additional information 
returned by the optimizer, or <code>NULL</code>. To understand exactly the 
message, see the source code.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Camilo Jose Torres-Jimenez [aut,cre] <a href="mailto:cjtorresj@unal.edu.co">cjtorresj@unal.edu.co</a>
</p>


<h3>Source</h3>

<p>Based on the function <code>mqdedist</code> which in turn is based on
the function <code>mledist</code> of the R package: 
<code>fitdistrplus</code>
</p>
<p>Delignette-Muller ML and Dutang C (2015), <em>fitdistrplus: An R Package 
for Fitting Distributions</em>. Journal of Statistical Software, 64(4), 1-34.
</p>


<h3>References</h3>

<p>Torres-Jimenez, C. J. (2017, September), <em>Comparison of estimation
methods for the BMT distribution</em>. ArXiv e-prints.
</p>
<p>Torres-Jimenez, C. J. (2018), <em>The BMT Item Response Theory model: A 
new skewed distribution family with bounded domain and an IRT model based on
it</em>, PhD thesis, Doctorado en ciencias - Estadistica, Universidad Nacional 
de Colombia, Sede Bogota.
</p>


<h3>See Also</h3>

<p>See <code>BMT</code> for the BMT density, distribution, quantile 
function and random deviates. See <code>BMTfit.mme</code>, 
<code>BMTfit.mle</code>, <code>BMTfit.mge</code>, 
<code>BMTfit.mpse</code> and <code>BMTfit.qme</code> for other estimation 
methods. See <code>optim</code> and <code>constrOptim</code> for 
optimization routines. See <code>BMTfit</code> and <code>fitdist</code> 
for functions that return an objetc of class <code>"fitdist"</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># (1) basic fit by minimum quantile distance estimation
set.seed(1234)
x1 &lt;- rBMT(n=100, p3=0.25, p4=0.75)
BMTfit.mqde(x1)

# (2) quantile matching is a particular case of minimum quantile distance
BMTfit.mqde(x1, probs=c(0.2,0.4,0.6,0.8), qtype=7)

# (3) maximum or manhattan instead of euclidean distance
BMTfit.mqde(x1, dist="maximum")
BMTfit.mqde(x1, dist="manhattan")

# (4) how to change the optimisation method?
BMTfit.mqde(x1, optim.method="L-BFGS-B") 
BMTfit.mqde(x1, custom.optim="nlminb")

# (5) estimation of the tails weights parameters of the BMT 
# distribution with domain fixed at [0,1]
BMTfit.mqde(x1, start=list(p3=0.5, p4=0.5), fix.arg=list(p1=0, p2=1))

# (6) estimation of the asymmetry-steepness parameters of the BMT 
# distribution with domain fixed at [0,1]
BMTfit.mqde(x1, start=list(p3=0, p4=0.5), type.p.3.4 = "a-s", 
            fix.arg=list(p1=0, p2=1))

</code></pre>


</div>