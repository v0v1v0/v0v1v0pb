<div class="container">

<table style="width: 100%;"><tr>
<td>rscaleUsage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC Algorithm for Multivariate Ordinal Data with Scale Usage Heterogeneity</h2>

<h3>Description</h3>

<p><code>rscaleUsage</code> implements an MCMC algorithm for multivariate ordinal data with scale usage heterogeniety.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">rscaleUsage(Data, Prior, Mcmc)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data </code></td>
<td>
<p>list(x, k)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>
<p>list(nu, V, mubar, Am, gs, Lambdanu, LambdaV)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mcmc </code></td>
<td>
<p>list(R, keep, nprint, ndghk, e, y, mu, Sigma, sigma, tau, Lambda)</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Model and Priors</h4>

<p><code class="reqn">n</code> = <code>nrow(x)</code> individuals respond to <code class="reqn">p</code> = <code>ncol(x)</code> questions; 
all questions are on a scale <code class="reqn">1, \ldots, k</code> for respondent <code class="reqn">i</code> and question <code class="reqn">j</code>, <br></p>
<p><code class="reqn">x_{ij} = d</code> if <code class="reqn">c_{d-1} \le y_{ij} \le c_d</code> where <code class="reqn">d = 1, \ldots, k</code> and <code class="reqn">c_d = a + bd + ed^2</code> <br></p>
<p><code class="reqn">y_i = mu + tau_i*iota + sigma_i*z_i</code> with <code class="reqn">z_i</code> <code class="reqn">\sim</code> <code class="reqn">N(0, Sigma)</code>
</p>
<p><code class="reqn">(tau_i, ln(sigma_i))</code> <code class="reqn">\sim</code> <code class="reqn">N(\phi, Lamda)</code><br><code class="reqn">\phi = (0, lambda_{22})</code> <br><code class="reqn">mu</code> <code class="reqn">\sim</code> <code class="reqn">N(mubar, Am^{-1})</code><br><code class="reqn">Sigma</code> <code class="reqn">\sim</code> <code class="reqn">IW(nu, V)</code> <br><code class="reqn">Lambda</code> <code class="reqn">\sim</code> <code class="reqn">IW(Lambdanu, LambdaV)</code> <br><code class="reqn">e</code> <code class="reqn">\sim</code> unif on a grid 
</p>
<p>It is highly recommended that the user choose the default prior settings. 
If you wish to change prior settings and/or the grids used, please carefully read the case study listed in the reference below.
</p>



<h4>Argument Details</h4>

<p><em><code>Data  = list(x, k)</code></em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>x: </code> </td>
<td style="text-align: left;"> <code class="reqn">n x p</code> matrix of discrete responses </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>k: </code> </td>
<td style="text-align: left;"> number of discrete rating scale options
    </td>
</tr>
</table>
<p><em><code>Prior = list(nu, V, mubar, Am, gs, Lambdanu, LambdaV)</code> [optional]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>nu:       </code> </td>
<td style="text-align: left;"> d.f. parameter for Sigma prior (def: p + 3) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>V:        </code> </td>
<td style="text-align: left;"> scale location matrix for Sigma prior (def: nu*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mubar:    </code> </td>
<td style="text-align: left;"> <code class="reqn">p x 1</code> vector of prior means (def: <code>rep(k/2,p)</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Am:       </code> </td>
<td style="text-align: left;"> <code class="reqn">p x p</code> prior precision matrix (def: 0.01*I) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gs:       </code> </td>
<td style="text-align: left;"> grid size for sigma (def: 100) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Lambdanu: </code> </td>
<td style="text-align: left;"> d.f. parameter for Lambda prior (def: 20) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>LambdaV:  </code> </td>
<td style="text-align: left;"> scale location matrix for Lambda prior (def: (Lambdanu - 3)*Lambda)
    </td>
</tr>
</table>
<p><em><code>Mcmc  = list(R, keep, nprint, ndghk, e, y, mu, Sigma, sigma, tau, Lambda)</code> [only <code>R</code> required]</em>
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>R:      </code> </td>
<td style="text-align: left;"> number of MCMC draws (def: 1000) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>keep:   </code> </td>
<td style="text-align: left;"> MCMC thinning parameter -- keep every <code>keep</code>th draw (def: 1) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>nprint: </code> </td>
<td style="text-align: left;"> print the estimated time remaining for every <code>nprint</code>'th draw (def: 100, set to 0 for no print) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>ndghk:  </code> </td>
<td style="text-align: left;"> number of draws for a GHK integration (def: 100) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>e:      </code> </td>
<td style="text-align: left;"> initial value (def: 0) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>y:      </code> </td>
<td style="text-align: left;"> initial values (def: x) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>mu:     </code> </td>
<td style="text-align: left;"> initial values (def: <code>apply(y,2,mean)</code>, a p-length vector) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Sigma:  </code> </td>
<td style="text-align: left;"> initial value (def: <code>var(y)</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>sigma:  </code> </td>
<td style="text-align: left;"> initial values (def: <code>rep(1,n)</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>tau:    </code> </td>
<td style="text-align: left;"> initial values (def: <code>rep(0,n)</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>Lambda: </code> </td>
<td style="text-align: left;"> initial values (def: <code>matrix(c(4,0,0,.5),ncol=2)</code>)
    </td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sigmadraw  </code></td>
<td>
<p><code class="reqn">R/keep x p*p</code> matrix of Sigma draws â€“ each row is the vector form of Sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mudraw     </code></td>
<td>
<p><code class="reqn">R/keep x p</code> matrix of mu draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taudraw    </code></td>
<td>
<p><code class="reqn">R/keep x n</code> matrix of tau draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmadraw  </code></td>
<td>
<p><code class="reqn">R/keep x n</code> matrix of sigma draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambdadraw </code></td>
<td>
<p><code class="reqn">R/keep x 4</code> matrix of Lamda draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edraw      </code></td>
<td>
<p><code class="reqn">R/keep x 1</code> vector of e draws</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p><code class="reqn">tau_i</code>, <code class="reqn">sigma_i</code> are identified from the scale usage patterns in the <code class="reqn">p</code> questions asked per respondent (# cols of <code class="reqn">x</code>).  Do not attempt to use this on datasets with only a small number of total questions.
</p>


<h3>Author(s)</h3>

<p>Rob McCulloch (Arizona State University) and Peter Rossi (Anderson School, UCLA), <a href="mailto:perossichi@gmail.com">perossichi@gmail.com</a>.</p>


<h3>References</h3>

<p> For further discussion, see Case Study 3 on Overcoming Scale Usage Heterogeneity, <em>Bayesian Statistics and Marketing</em> by Rossi, Allenby, and McCulloch.</p>


<h3>Examples</h3>

<pre><code class="language-R">if(nchar(Sys.getenv("LONG_TEST")) != 0) {R=1000} else {R=5} 
set.seed(66)

data(customerSat)
surveydat = list(k=10, x=as.matrix(customerSat))

out = rscaleUsage(Data=surveydat, Mcmc=list(R=R))
summary(out$mudraw)
</code></pre>


</div>