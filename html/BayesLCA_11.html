<div class="container">

<table style="width: 100%;"><tr>
<td>blca.vb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bayesian Latent Class Analysis  via a variational Bayes algorithm
</h2>

<h3>Description</h3>

<p>Latent class analysis (LCA) attempts to find G hidden classes in binary data X. blca.vb uses a variational EM algorithm to find the distribution which best approximates the parameters' true distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blca.vb(X, G, alpha = 1, beta = 1, delta = 1, 
	start.vals = c("single", "across"), counts.n = NULL, 
        iter = 500, restarts = 1, verbose = TRUE, conv = 1e-06, 
	small = 1e-100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>The data matrix. This may take one of several forms, see <code>data.blca</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>

<p>The number of classes to run lca for.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, beta</code></td>
<td>

<p>The prior values for the data conditional on group membership. These may take several forms: a single value, recycled across all groups and columns, a vector of length G or M (the number of columns in the data), or finally, a G x M matrix specifying each prior value separately. Defaults to 1, i.e, a uniform prior, for each value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>Prior values for the mixture components in model.  Defaults to 1, i.e., a uniform prior.  May be single or vector valued (of length G).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.vals</code></td>
<td>

<p>Denotes how class membership is to be assigned during the initial step of the algorithm. Two character values may be chosen, "single", which randomly assigns data points exclusively to one class, or "across", which assigns class membership via  <code>runif</code>. Alternatively, class membership may be pre-specified, either as a vector of class membership, or as a matrix of probabilities. Defaults to "single".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts.n</code></td>
<td>

<p>If data patterns have already been counted, a data matrix consisting of each unique data pattern can be supplied to the function, in addition to a vector counts.n, which supplies the corresponding number of times each pattern occurs in the data. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>The maximum number of iterations that the algorithm runs over.  Will stop earlier if the algorithm converges.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restarts</code></td>
<td>

<p><code>restarts</code> determines how many times the algorithm is run with different starting values. Parameter estimates from the run which achieved the highest log-posterior are returned. If starting values are supplied, these are used for the first run, after which random starting points are used. Defaults to 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical valued. If TRUE, the log-posterior from each run is printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>Convergence criteria, i.e., how small should the log-posterior increase become before the algorithm is deemed to have converged?  Set relative to the size of the data matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>small</code></td>
<td>

<p>To ensure numerical stability a small constant is added to certain parameter estimates. Defaults to 1e-100.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variational Bayes method approximates the posterior using as a product of independent distributions. Parameters are then estimated for this approximate distribution using a variational EM algorithm. This method has a tendency to underestimate parameter's variance; as such the standard error and density estimates should be interpreted with caution. 
</p>
<p>While it is worth starting the algorithm from multiple starting points, variational algorithms have less of a tendency to cpnverge at saddle point or sub-optimal local maxima.
</p>


<h3>Value</h3>






<p>A list of class "blca.vb" is returned, containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The initial call passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itemprob</code></td>
<td>
<p>The item probabilities, conditional on class membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classprob</code></td>
<td>
<p>The class probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itemprob.sd</code></td>
<td>
<p>Posterior standard deviation estimates of the item probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classprob.sd</code></td>
<td>
<p>Posterior standard deviation estimates of the class probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A list containing posterior parameter values for item and class probabilities, which are assumed to follow beta and Dirichlet distributions respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Estimate of class membership for each unique datapoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LB</code></td>
<td>
<p>The lower bound estimate of the log-posterior of the estimated model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbstore </code></td>
<td>
<p>The value of the lower bound estimate for each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations required before convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The amount that the lower bound increased at the final iteration  of the algorithm's run. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p> The number of times each unique datapoint point occured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A list containing the prior values specified for the model.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Variational Bayes approximations, are known to often underestimate the standard errors of the parameters under investigation, so caution is advised when checking their values.
</p>
<p>Earlier versions of this function erroneously referred to posterior standard deviations as standard errors. This also extended to arguments supplied to and returned by the function, some of which are now returned with the corrected corrected suffix <code>blca.em.sd</code> (for standard deviation). For backwards compatability reasons, the earlier suffix <code>.se</code> has been retained as a returned argument.
</p>


<h3>Author(s)</h3>

<p>Arthur White
</p>


<h3>References</h3>

<p>Ormerod J, Wand M (2010). “Explaining Variational Approximations.” The American Statistician, 64(2), 140-153. 
</p>


<h3>See Also</h3>


<p><code>blca.em</code>, <code>blca.gibbs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">type1 &lt;- c(0.8, 0.8, 0.2, 0.2)
type2 &lt;- c(0.2, 0.2, 0.8, 0.8)
x&lt;- rlca(1000, rbind(type1,type2), c(0.6,0.4))

fit &lt;- blca.vb(x, 2)
print(fit)
summary(fit)
par(mfrow=c(3,2))
plot(fit)
par(mfrow=c(1,1))

data(Alzheimer)
sj &lt;- blca.vb(Alzheimer, 10, delta=1/10)
sj$classprob    ##Empty Groups
</code></pre>


</div>