<div class="container">

<table style="width: 100%;"><tr>
<td>get_MAP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the maximum a posteriori (MAP) estimate of the MCMC chain</h2>

<h3>Description</h3>

<p>Identify the MCMC iteration that holds the MAP estimate. This will be used to
inform <code>get_breakpts</code> as to which breakpoints should be retained
on which to assign track segments to the observations of each animal ID.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_MAP(dat, nburn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data frame where each row holds the log marginal likelihood
values at each iteration of the MCMC chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>numeric. The size of the burn-in phase after which the MAP
estimate will be identified.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector of iterations at which the MAP estimate was found
for each animal ID.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#load data
data(tracks.list)

#subset only first track
tracks.list&lt;- tracks.list[1]

#only retain id and discretized step length (SL) and turning angle (TA) columns
tracks.list2&lt;- purrr::map(tracks.list,
                   subset,
                  select = c(id, SL, TA))


set.seed(1)

# Define model params
alpha&lt;- 1
ngibbs&lt;- 1000
nbins&lt;- c(5,8)

#future::plan(future::multisession)  #run all MCMC chains in parallel
dat.res&lt;- segment_behavior(data = tracks.list2, ngibbs = ngibbs, nbins = nbins,
                           alpha = alpha)


# Determine MAP iteration for selecting breakpoints and store breakpoints
MAP.est&lt;- get_MAP(dat = dat.res$LML, nburn = ngibbs/2)


</code></pre>


</div>