<div class="container">

<table style="width: 100%;"><tr>
<td>simEEG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation functional EEG data</h2>

<h3>Description</h3>

<p>Our data from (Fisher et al. 2014) consists of EEG measurements from the Sleep Heart Health Study (SHHS) (Quan et al. 1997). Since we cannot publish the EEG recordings from the individuals in the SHHS, we instead include the summary statistics of the PCs from our subsample of the processed SHHS EEG data. This data is used by the <code>simEEG</code> to simulate functional data that is approximately similar to the data used in our work. The resulting simulated vectors are always of length 900, and are generated from 5 basis vectors (see <code>EEG_leadingV</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">simEEG(n = 100, centered = TRUE, propVarNoise = 0.45, wide = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the desired sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered</code></td>
<td>
<p>if TRUE, the sample will be centered to have mean zero for each dimension. If FALSE, measurements will be simulated from a population where the mean is equal to that observed in the sample used in (Fisher et al. 2014) (see <code>EEG_mu</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propVarNoise</code></td>
<td>
<p>the approximate proportion of total sample variance attributable to random noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wide</code></td>
<td>
<p>if TRUE, the resulting data is outputted as a <code>n</code> by 900 matrix, with each row corresponding to a different subject. If FALSE, the resulting data is outputted as a 900 by <code>n</code> matrix, with each column corresponding to a different subject.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix containing <code>n</code> simulated measurement vectors of Normalized Delta Power, for the first 7.5 hours of sleep. These vectors are generated according to the equation:
</p>
<p><code class="reqn">y = \sum_{j=1}^{5} B_j * s_j + e</code>
</p>
<p>Where <code class="reqn">y</code> is the simulated measurement for a subject, <code class="reqn">B_j</code> is the <code class="reqn">j^{th}</code> basis vector, <code class="reqn">s_j</code> is a random normal variable with mean zero, and e is a vector of random normal noise. The specific values for <code class="reqn">B_j</code> and <code class="reqn">var(s_j)</code> are determined from the EEG data sample studied in (Fisher et al., 2014), and are respectively equal to the <code class="reqn">j^{th}</code> empirical principal component vector (see <code>EEG_leadingV</code>), and the empirical variance of the <code class="reqn">j^{th}</code> score variable (see <code>EEG_score_var</code>).
</p>


<h3>References</h3>

<p>Aaron Fisher, Brian Caffo, and Vadim Zipunnikov. <em>Fast, Exact Bootstrap Principal Component Analysis for p&gt;1 million</em>. 2014. http://arxiv.org/abs/1405.0922
</p>
<p>Stuart F Quan, Barbara V Howard, Conrad Iber, James P Kiley, F Javier Nieto, George T O'Connor, David M Rapoport, Susan Redline, John Robbins, JM Samet, et al.<em> The sleep heart health study: design, rationale, and methods</em>. Sleep, 20(12):1077-1085, 1997. 1.1
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(0)

#Low noise example, for an illustration of smoother functions
Y&lt;-simEEG(n=20,centered=FALSE,propVarNoise=.02,wide=FALSE)
matplot(Y,type='l',lty=1)

#Higher noise example, for PCA
Y&lt;-simEEG(n=100,centered=TRUE,propVarNoise=.5,wide=TRUE)
svdY&lt;-fastSVD(Y)
V&lt;-svdY$v #since Y is wide, the PCs are the right singular vectors (svd(Y)$v). 
d&lt;-svdY$d
head(cumsum(d^2)/sum(d^2),5) #first 5 PCs explain about half the variation

# Compare fitted PCs to true, generating basis vectors
# Since PCs have arbitrary sign, we match the sign of 
# the fitted sample PCs to the population PCs first
V_sign_adj&lt;- array(NA,dim=dim(V))
for(i in 1:5){
	V_sign_adj[,i]&lt;-V[,i] * sign(crossprod(V[,i],EEG_leadingV[,i]))
}
par(mfrow=c(1,2))
matplot(V_sign_adj[,1:5],type='l',lty=1,
		main='PCs from simulated data,\n sign adjusted')
matplot(EEG_leadingV,type='l',lty=1,main='Population PCs')
</code></pre>


</div>