<div class="container">

<table style="width: 100%;"><tr>
<td>forestplot.bmr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generate a forest plot for a <code>bmr</code> object
(based on the <code>forestplot</code> package's plotting functions).
</h2>

<h3>Description</h3>

<p>Generates a forest plot, showing individual estimates along with their
95 percent confidence intervals, shrinkage intervals, resulting effect
estimates and prediction intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'bmr'
forestplot(x, X.mean, X.prediction,
           labeltext, exponentiate=FALSE,
           shrinkage=TRUE, heterogeneity=TRUE, 
           digits=2, decplaces.X, plot=TRUE,
           fn.ci_norm, fn.ci_sum, col, legend=NULL, boxsize, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a <code>bmr</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.mean</code></td>
<td>

<p>a regressor matrix (<code class="reqn">X</code>) for effect estimates that are to be
shown in the plot. By default, a diagonal matrix; set to
<code>NULL</code> in order to suppress showing summary estimates. The
matrix' row names define the labels shown in the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.prediction</code></td>
<td>

<p>an optional regressor matrix (<code class="reqn">X</code>) for predictions that are to
be shown in the plot. The matrix' row names define the labels shown
in the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labeltext</code></td>
<td>
<p>an (alternative) “<code>labeltext</code>” argument
which is then handed on to the <code>forestplot()</code>
function (see the help there). You can use this to change contents
or add columns to the displayed table; see also the example below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exponentiate</code></td>
<td>

<p>a logical flag indicating whether to exponentiate numbers (effect
sizes) in table and plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>

<p>a logical flag indicating whether to show shrinkage intervals along
with the quoted estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heterogeneity</code></td>
<td>

<p>a logical flag indicating whether to quote the heterogeneity estimate 
and CI (at the bottom left of the plot).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>the number of significant digits to be shown.
This is interpreted relative to the standard errors of all estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decplaces.X</code></td>
<td>

<p>The number of decimal places to be shown for the regressors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>a logical flag indicating whether to actually generate a plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn.ci_norm, fn.ci_sum, col, legend, boxsize, ...</code></td>
<td>

<p>other arguments passed on to the
<span class="pkg">forestplot</span> package's <code>forestplot</code>
function (see also the help there).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates a forest plot illustrating the underlying data and
resulting estimates (effect estimates and/or prediction intervals,
as well as shrinkage estimates and intervals).
For effect estimates and prediction intervals, regressor matrices
(<code class="reqn">X</code>) need to be supplied via the ‘<code>X.mean</code>’ or
‘<code>X.prediction</code>’ arguments. Effect estimates are shown as
diamonds, predictions are shown as horizontal bars.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>matrix</code> of estimates and CIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.mean, X.prediction</code></td>
<td>
<p>the ‘<code>X.mean</code>’ and
‘<code>X.prediction</code>’ arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>a <code>matrix</code> of shrinkage estimates and CIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labeltext</code></td>
<td>
<p>a <code>matrix</code> of table entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forestplot</code></td>
<td>
<p>result of the call to the
‘<code>forestplot()</code>’ function.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is based on the <span class="pkg">forestplot</span> package's
“<code>forestplot()</code>” function.
</p>


<h3>Author(s)</h3>

<p>Christian Roever <a href="mailto:christian.roever@med.uni-goettingen.de">christian.roever@med.uni-goettingen.de</a>
</p>


<h3>References</h3>

<p>C. Roever, T. Friede.
Using the bayesmeta R package for Bayesian random-effects meta-regression.
<em>Computer Methods and Programs in Biomedicine</em>,
<b>299</b>:107303, 2023.
<a href="https://doi.org/10.1016/j.cmpb.2022.107303">doi:10.1016/j.cmpb.2022.107303</a>.
</p>
<p>C. Roever.
Bayesian random-effects meta-analysis using the bayesmeta R package.
<em>Journal of Statistical Software</em>, <b>93</b>(6):1-51, 2020.
<a href="https://doi.org/10.18637/jss.v093.i06">doi:10.18637/jss.v093.i06</a>.
</p>
<p>C. Lewis and M. Clarke.
Forest plots: trying to see the wood and the trees.
<em>BMJ</em>, <b>322</b>:1479, 2001.
<a href="https://doi.org/10.1136/bmj.322.7300.1479">doi:10.1136/bmj.322.7300.1479</a>.
</p>
<p>C. Guddat, U. Grouven, R. Bender and G. Skipka.
A note on the graphical presentation of prediction intervals in
random-effects meta-analyses.
<em>Systematic Reviews</em>, <b>1</b>(34), 2012.
<a href="https://doi.org/10.1186/2046-4053-1-34">doi:10.1186/2046-4053-1-34</a>.
</p>
<p>R.D. Riley, J.P. Higgins and J.J. Deeks.
Interpretation of random effects meta-analyses.
<em>BMJ</em>, <b>342</b>:d549, 2011.
<a href="https://doi.org/10.1136/bmj.d549">doi:10.1136/bmj.d549</a>.
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code>,
<code>forestplot</code>,
<code>forestplot.bayesmeta</code>,
<code>forestplot.escalc</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#################################################################
# perform a meta-analysis using binary ("indicator") covariables:

# load data:
data("CrinsEtAl2014")
# compute effect measures (log-OR):
crins.es &lt;- escalc(measure="OR",
                   ai=exp.AR.events,  n1i=exp.total,
                   ci=cont.AR.events, n2i=cont.total,
                   slab=publication, data=CrinsEtAl2014)
# show data:
crins.es[,c("publication", "IL2RA", "exp.AR.events", "exp.total",
            "cont.AR.events", "cont.total", "yi", "vi")]
# specify regressor matrix (binary indicator variables):
X &lt;- cbind("basiliximab"=as.numeric(crins.es$IL2RA=="basiliximab"),
           "daclizumab" =as.numeric(crins.es$IL2RA=="daclizumab"))
print(X)
# perform meta-analysis:
bmr01 &lt;- bmr(crins.es, X=X,
             tau.prior=function(t){dhalfnormal(t, scale=0.5)})

# show forest plot:
forestplot(bmr01)

# show forest plot including contrast
# (difference between the two groups):
forestplot(bmr01,
           X.mean=rbind("basiliximab"      = c(1, 0),
                        "daclizumab"       = c(0, 1),
                        "group difference" = c(-1, 1)))

##############################################
# perform the meta-analysis using a different 
# ("intercept / slope") regressor setup:
X &lt;- cbind("intercept"=1,
           "offset.dac"=as.numeric(crins.es$IL2RA=="daclizumab"))
print(X)
# perform meta-analysis:
bmr02 &lt;- bmr(crins.es, X=X,
             tau.prior=function(t){dhalfnormal(t, scale=0.5)})

# show default forest plot:
forestplot(bmr02)

# show forest plot including both group means and their difference:
forestplot(bmr02,
           X.mean=rbind("basiliximab"      = c(1, 0),
                        "daclizumab"       = c(1, 1),
                        "group difference" = c(0, 1)))

###############################################################
# a meta analysis using a continuous regressor
# and including prediction:
help("NicholasEtAl2019")
# load data:
data("NicholasEtAl2019")
# compute effect sizes (logarithic odds) from count data:
es &lt;- escalc(measure="PLO",
             xi=patients*(prog.percent/100), ni=patients,
             slab=study, data=NicholasEtAl2019)
# set up regressor matrix:
X &lt;- cbind("intercept2000" = 1, "year" = (es$year-2000))
# perform analysis:
bmr03 &lt;- bmr(es, X=X)
# show forest plot including some mean estimates for the
# years from 1990 to 2018, and a prediction for 2019:
forestplot(bmr03,
           X.mean=rbind("intercept (2000)"  = c(1,   0),
                        "annual change"     = c(0,   1),
                        "change per decade" = c(0,  10),
                        "mean 1990"         = c(1, -10),
                        "mean 2000"         = c(1,   0),
                        "mean 2010"         = c(1,  10),
                        "mean 2018"         = c(1,  18)),
           X.predict=rbind("prediction 2019"   = c(1,  19)),
           xlab="log-odds",
           txt_gp = fpTxtGp(ticks = gpar(cex=1), xlab = gpar(cex=1)))

# the shown summaries and predictions may also be computed "manually";
# mean effect (year 2018), posterior median and 95 percent CI:
bmr03$qpredict(p=0.5, x=c(1, 18))
bmr03$pred.interval(level=0.95, x=c(1, 18))

# prediction (year 2019), posterior median and 95 percent CI:
bmr03$qpredict(p=0.5, x=c(1, 19), mean=FALSE)
bmr03$pred.interval(level=0.95, x=c(1, 19), mean=FALSE)

# means and predictions may also be derived
# using the "summary()" function:
summary(bmr03,
        X.mean=rbind("intercept (2000)"  = c(1,   0),
                     "annual change"     = c(0,   1),
                     "change per decade" = c(0,  10),
                     "mean 1990"         = c(1, -10),
                     "mean 2000"         = c(1,   0),
                     "mean 2010"         = c(1,  10),
                     "mean 2018"         = c(1,  18)),
        X.predict=rbind("prediction 2019"   = c(1,  19)))


##########################################################
# the tabular part of the forest plot may also be changed;
# draw a default plot:
forestplot(bmr03)
# don't plot, only extract the tabular bits:
fp &lt;- forestplot(bmr03, plot=FALSE)
labtxt &lt;- fp$labeltext
head(labtxt)

# drop two columns:
labtxt &lt;- labtxt[,-c(2,3)]
# add two new columns:
labtxt &lt;- cbind(labtxt[,1],
                c("year", es$year, "",""),
                c("events / total",
                  paste(round(es$patients*(es$prog.percent/100)),
                  "/", es$patients), "",""),
                labtxt[,2:3])
head(labtxt)
# draw new forest plot:
forestplot(bmr03, labeltext=labtxt, xlab="log-odds")

## End(Not run)
</code></pre>


</div>