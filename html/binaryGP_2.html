<div class="container">

<table style="width: 100%;"><tr>
<td>predict.binaryGP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictions of Binary Gaussian Process</h2>

<h3>Description</h3>

<p>The function computes the predicted response and its variance as well as its confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'binaryGP'
predict(object, xnew, conf.level = 0.95,
  sim.number = 101, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a class binaryGP object estimated by <code>binaryGP_fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnew</code></td>
<td>
<p>a testing matrix with dimension <code>n_new</code> by <code>d</code> in which each row corresponds to a predictive location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>a value from 0 to 1 specifying the level of confidence interval. The default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.number</code></td>
<td>
<p>a positive integer specifying the simulation number for Monte-Carlo method. The default is 101.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for compatibility with generic method <code>predict</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a matrix with dimension <code>n_new</code> by <code>T</code> displaying predicted responses at locations <code>xnew</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>a matrix with dimension <code>n_new</code> by <code>T</code> displaying predictive variances at locations <code>xnew</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.bound</code></td>
<td>
<p>a matrix with dimension <code>n_new</code> by <code>T</code> displaying upper bounds with <code>conf.level</code> confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.bound</code></td>
<td>
<p>a matrix with dimension <code>n_new</code> by <code>T</code> displaying lower bounds with <code>conf.level</code> confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_pred</code></td>
<td>
<p>a matrix with dimension <code>n_new</code> by <code>T</code> displaying predicted binary responses at locations <code>xnew</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chih-Li Sung &lt;iamdfchile@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>binaryGP_fit</code> for estimation of the binary Gaussian process.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(binaryGP)

#####      Testing function: cos(x1 + x2) * exp(x1*x2) with TT sequences      #####
#####   Thanks to Sonja Surjanovic and Derek Bingham, Simon Fraser University #####
test_function &lt;- function(X, TT)
{
  x1 &lt;- X[,1]
  x2 &lt;- X[,2]

  eta_1 &lt;- cos(x1 + x2) * exp(x1*x2)

  p_1 &lt;- exp(eta_1)/(1+exp(eta_1))
  y_1 &lt;- rep(NA, length(p_1))
  for(i in 1:length(p_1)) y_1[i] &lt;- rbinom(1,1,p_1[i])
  Y &lt;- y_1
  P &lt;- p_1
  if(TT &gt; 1){
    for(tt in 2:TT){
      eta_2 &lt;- 0.3 * y_1 + eta_1
      p_2 &lt;- exp(eta_2)/(1+exp(eta_2))
      y_2 &lt;- rep(NA, length(p_2))
      for(i in 1:length(p_2)) y_2[i] &lt;- rbinom(1,1,p_2[i])
      Y &lt;- cbind(Y, y_2)
      P &lt;- cbind(P, p_2)
      y_1 &lt;- y_2
    }
  }

  return(list(Y = Y, P = P))
}

set.seed(1)
n &lt;- 30
n.test &lt;- 10
d &lt;- 2
X &lt;- matrix(runif(d * n), ncol = d)
X.test &lt;- matrix(runif(d * n.test), ncol = d)

##### without time-series #####
Y &lt;- test_function(X, 1)$Y  ## Y is a vector
test.out &lt;- test_function(X.test, 1)
Y.test &lt;- test.out$Y
P.true &lt;- test.out$P

# fitting
binaryGP.model &lt;- binaryGP_fit(X = X, Y = Y)

# prediction
binaryGP.prediction &lt;- predict(binaryGP.model, xnew = X.test)
print(binaryGP.prediction$mean)
print(binaryGP.prediction$var)
print(binaryGP.prediction$upper.bound)
print(binaryGP.prediction$lower.bound)

##### with time-series #####
Y &lt;- test_function(X, 10)$Y  ## Y is a matrix with 10 columns
test.out &lt;- test_function(X.test, 10)
Y.test &lt;- test.out$Y
P.true &lt;- test.out$P

# fitting
binaryGP.model &lt;- binaryGP_fit(X = X, Y = Y, R = 1)

# prediction
binaryGP.prediction &lt;- predict(binaryGP.model, xnew = X.test)
print(binaryGP.prediction$mean)
print(binaryGP.prediction$var)
print(binaryGP.prediction$upper.bound)
print(binaryGP.prediction$lower.bound)

</code></pre>


</div>