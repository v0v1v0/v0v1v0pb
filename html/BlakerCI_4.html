<div class="container">

<table style="width: 100%;"><tr>
<td>binom.blaker.limits</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Blaker's binomial confidence limits
</h2>

<h3>Description</h3>

<p>Fast and accurate calculation of Blaker's binomial confidence limits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binom.blaker.limits(x, n, level = 0.95, tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>number of successes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of trials.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>confidence level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>numerical tolerance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>binom.blaker.lower.limit</code>;
in fact, just <code>maxiter</code> (see <code>BlakerCI-internal</code>). 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the Blaker's <code>(1 - alpha)</code> confidence interval 
is the convex hull of the set <code>C</code> of those points 
where the acceptability function (Blaker (2000)) exceeds 
level <code>alpha</code>. The original numerical algorithm from
Blaker (2000) is prone, when <code>C</code> is a union
of disjoint intervals, to skipping a short interval
and finding inaccurate over-liberal confidence limits. 
</p>
<p>Function <code>binom.blaker.limits</code> is, by contrast,
immune from such failures and yields always as 
its result the whole confidence interval (Klaschka (2010)).
</p>


<h3>Value</h3>

<p>Length 2 vector â€“ the lower and upper confidence limits.
</p>


<h3>Note</h3>


<p>Package <code>exactci</code> by M. P. Fay includes another algorithm
that calculates Blaker's binomial confidence limits
(see user-level function <code>binom.exact</code> and internal function 
<code>exactbinomCI</code>). 
It is more sophisticated than the original Blaker's one,
but considerably slower and sometimes less accurate 
than that of <code>binom.blaker.limits</code>.
</p>
<p>Earlier 2010 versions of the algorithm of <code>binom.blaker.limits</code> 
were designed independently of (though already existing) 
M.P. Fay's packages <code>exact2x2</code> and <code>exactci</code>.
Some later modifications, however, have been inspired
by Fay's programs. 
</p>
<p>Lecoutre &amp; Poitevineau (2014) designed another algorithm 
for the calculation of the Blaker's confidence limits.
Despite more abstract theoretical background and broader 
scope (not confined to the binomial distribution),
it is closely analogous to that of <code>binom.blaker.limits</code>.
</p>


<h3>Author(s)</h3>

<p>Jan Klaschka <a href="mailto:klaschka@cs.cas.cz">klaschka@cs.cas.cz</a>
</p>


<h3>References</h3>


<p>Blaker, H. (2000) Confidence curves and improved exact confidence 
intervals for discrete distributions.
Canadian Journal of Statistics 28: 783-798.<br>
(Corrigenda: Canadian Journal of Statistics 29: 681.)
</p>






<p>Klaschka, J. (2010). BlakerCI: An algorithm and R package
for the Blaker's binomial confidence limits calculation.
Technical report No. 1099, Institute of Computer Science,
Academy of Sciences of the Czech Republic,
<a href="http://hdl.handle.net/11104/0195722">http://hdl.handle.net/11104/0195722</a>.

</p>
<p>Lecoutre, B. &amp; Poitevineau J. (2014). New results for computing
Blaker's exact confidence interval limits for usual
one-parameter discrete distributions.
Communications in Statistics - Simulation and Computation, 
<a href="http://dx.doi.org/10.1080/03610918.2014.911900">http://dx.doi.org/10.1080/03610918.2014.911900</a>.
</p>


<h3>See Also</h3>



<table>
<tr>
<td style="text-align: left;">
<code>exactci:binom.exact</code> </td>
<td style="text-align: left;">
      One of the options yields Blaker's
      limits. The algorithm is more 
      sophisti- </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> cated than
      the original Blaker's one. </td>
</tr>
<tr>
<td style="text-align: left;">

<code>propCIs:blakerci</code> </td>
<td style="text-align: left;">
      Implementation of the original algorithm from
      Blaker (2000). </td>
</tr>
<tr>
<td style="text-align: left;">
<code>binGroup:binBlaker</code> </td>
<td style="text-align: left;">
      Another implementation of the same algorithm.
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">binom.blaker.limits(3,10) # [1] 0.08726443 0.61941066

## Example of a failure of the original algorithm:
## Requires PropCIs package.
## Tolerance 1e-4 - default in the Blaker's paper.
## Not run: 
blakerci(29,99,conf.level=0.95,tolerance=1e-4) ## [1] 0.2096386 0.3923087
## The correct upper limit should be 0.3929\dots,
## as demonstrated:
## (1) By the same function with a smaller tolerance:
blakerci(29,99,conf.level=0.95,tolerance=1e-7) ## [1] 0.2097022 0.3929079
## (2) By binom.blaker.limits 
##     (default confidence limit 0.95, default tolerance 1e-10):
binom.blaker.limits(29,99) ## [1] 0.2097022 0.3929079
## (3) By exactbinomCI function from package exactci
##     (default confidence level, default tolerance): 
exactbinomCI(29,99,tsmethod="blaker")[1:2] ## [1] 0.2097 0.3929
## The same function, smaller tolerance:
exactbinomCI(29,99,tsmethod="blaker",tol=1e-8)[1:2] 
                                                ## [1] 0.2097022 0.3929079

## Another example of a failure of the original algorithm 
## with even as small tolerance as 1e-6:
blakerci(59,355,conf.level=0.95,tolerance=1e-4) ## [1] 0.1299899 0.2085809
blakerci(59,355,conf.level=0.95,tolerance=1e-5) ## [1] 0.1300799 0.2085409
blakerci(59,355,conf.level=0.95,tolerance=1e-6) ## [1] 0.1300799 0.2085349
## Only for tolerance = 1e-7 the result is satisfactory
## and in agreement with binom.blaker.limits:
blakerci(59,355,conf.level=0.95,tolerance=1e-7) ## [1] 0.1300807 0.2090809
binom.blaker.limits(59,355)                     ## [1] 0.1300807 0.2090809

## End(Not run)



</code></pre>


</div>