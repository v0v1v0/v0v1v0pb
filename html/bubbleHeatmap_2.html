<div class="container">

<table style="width: 100%;"><tr>
<td>bubbleHeatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate bubbleHeatmap Plot Object</h2>

<h3>Description</h3>

<p>This function creates a gTree for a bubbleHeatmap plot. These plots have a
grid of "bubbles" with the color and size each scaled according to the values
of a different variable. They can be used as an alternative to forest plots
for visualizing estimates and errors that can be organised in a grid format,
correlograms, and any other two variable matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bubbleHeatmap(
  colorMat,
  sizeMat = colorMat,
  treeName = "Plot",
  context = gpar(cex = 0.8),
  colorSeq = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0", "#FDDBC7",
    "#F4A582", "#D6604D", "#B2182B", "#67001F"),
  unitBase = unit(0.5, "cm"),
  diameter = 0.8,
  colorLim = c(NA, NA),
  sizeLim = c(NA, NA),
  showTopLabels = TRUE,
  showLeftLabels = TRUE,
  leftLabelsTitle = FALSE,
  showRowBracket = FALSE,
  rowTitle = FALSE,
  showColBracket = FALSE,
  colTitle = FALSE,
  plotTitle = FALSE,
  xTitle = FALSE,
  yTitle = FALSE,
  showColorLegend = TRUE,
  showBubbleLegend = TRUE,
  colorBreaks = NULL,
  sizeBreaks = NULL,
  legendHeight = 8,
  legendTitles = c(expression("-log"[10] * "P"), "Estimate (SD)")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>colorMat, sizeMat</code></td>
<td>
<p>Numeric matrices containing values to be mapped to
bubble color and size respectively. The dimensions, rownames and colnames of
these matrices must match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeName</code></td>
<td>
<p>Identifying character string for <code>gTree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>context</code></td>
<td>
<p><code>gpar</code> object to provide drawing context.
Will be applied to the parent viewport in the childrenvp slot of the gTree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorSeq</code></td>
<td>
<p>Character vector of colors to be used in creating color
scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitBase</code></td>
<td>
<p><code>unit</code> object indicating the size of one
plot grid box.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diameter</code></td>
<td>
<p>Maximum diameter of bubbles as multiple of unitBase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorLim, sizeLim</code></td>
<td>
<p>Numeric vectors indicating limits (min/max) outside
which the values of color/size matrices should be truncated. NOTE! These
data ranges are separate from the scale ranges, which are taken from the
min/max values of <code>colorBreaks</code> and <code>sizeBreaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showTopLabels</code></td>
<td>
<p>Logical, should matrix column names be printed above
plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showLeftLabels</code></td>
<td>
<p>Logical, should matrix row names be printed above
plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftLabelsTitle</code></td>
<td>
<p>Heading to print over the column of row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showRowBracket</code></td>
<td>
<p>Logical vector, should vertical bracket be printed to
the right of the plot (to label a row of plots in a final figure layout)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowTitle</code></td>
<td>
<p>Label to be printed to the right of the plot, outside row
bracket if present, to label a row of plots in a final figure layout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showColBracket</code></td>
<td>
<p>Logical, should horizontal bracket be printed
below the plot (to label a column of plots in a final figure layout)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colTitle</code></td>
<td>
<p>Label to be printed below plot, outside col bracket if
present, to label a column of plots in a final figure layout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotTitle</code></td>
<td>
<p>Plot title string, to be centered above plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xTitle</code></td>
<td>
<p>X-axis title string, displayed left of <code>LeftLabels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yTitle</code></td>
<td>
<p>Y-axis title string, displayed above <code>TopLabels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showColorLegend, showBubbleLegend</code></td>
<td>
<p>Should plot include legends for color
scale/bubble size?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorBreaks, sizeBreaks</code></td>
<td>
<p>Character vectors of legend tick labels. The
min/max values will represent the range of color/size scales. If not supplied
then these will be generated using <code>pretty</code>, to a range
outside data values (after values truncated to <code>colorLim</code>\<code>sizeLim</code>
if applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendHeight</code></td>
<td>
<p>Numeric, preferred height of legends in multiples of
<code>unitBase</code>. This will be supplied to  <code>pretty</code>
function. If sizeBreaks vector is supplied then this will be ignored and
legend height will be <code>length(sizeBreaks)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendTitles</code></td>
<td>
<p>Character vector of legend titles. First string should be
the size legend title, second for the color legend.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function creates a bubbleHeatmap using the <code>grid</code> graphics package.
It does not draw any output but produces a <code>gTree</code> object
which can be drawn using the <code>grid.draw</code> function. Returned
trees always include a <code>viewport</code> object with a 7x6 layout
and a given plot element is always positioned in the same cell, to assist
with aligning elements when combining multiple plots in a single figure (see
vignette, <code>matchLayoutHeights</code>, <code>matchLayoutWidths</code>).
NOTE: A cairo output device with gradient support is necessary to correctly
render the color legend.
</p>


<h3>See Also</h3>

<p>Other build functions: 
<code>bubbleHMLegends()</code>,
<code>bubbleHeatmapList()</code>,
<code>multiPlotInput()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 - Available plot features#
names &lt;- list(paste0("leftLabels", 1:6), paste0("topLabels", 1:10))
colorMat &lt;- matrix(rnorm(60), nrow = 6, ncol = 10, dimnames = names)
sizeMat &lt;- matrix(abs(rnorm(60)), nrow = 6, ncol = 10, dimnames = names)
tree &lt;- bubbleHeatmap(colorMat, sizeMat,
  treeName = "example",
  leftLabelsTitle = "leftLabelsTitle", showRowBracket = TRUE,
  rowTitle = "rowTitle", showColBracket = TRUE, colTitle = "colTitle",
  plotTitle = "plotTitle", xTitle = "xTitle", yTitle = "yTitle",
  legendTitles = c("legendTitles[1]", "legendTitles[2]")
)
grid.draw(tree)

</code></pre>


</div>