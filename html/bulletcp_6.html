<div class="container">

<table style="width: 100%;"><tr>
<td>robust_loess_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a robust loess regression</h2>

<h3>Description</h3>

<p>Internal function called by get_grooves_lassobasic and get_grooves_lassofull
</p>


<h3>Usage</h3>

<pre><code class="language-R">robust_loess_fit(cc, iter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>data frame with columns x and value_std, representing the crosscut</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data("example_data")
head(raw_data)
raw_data &lt;- raw_data[seq(from = 1, to = nrow(raw_data), by = 30),]
plot(raw_data$x, raw_data$y)

# set the minimum y-value to zero
check_min &lt;- min(raw_data$value[!is.na(raw_data$value)])
raw_data &lt;- dplyr::mutate(raw_data, value_std = value - check_min)

# remove global structure
rlo_fit &lt;- robust_loess_fit(cc = raw_data, iter = 20)
raw_data$rlo_pred &lt;- predict(rlo_fit, newdata = raw_data)
raw_data$rlo_resid &lt;- raw_data$value_std - raw_data$rlo_pred

# define new data frame without the global structure
data &lt;- data.frame("x" = raw_data$x, "y" = raw_data$rlo_resid)
plot(data$x, data$y)
</code></pre>


</div>