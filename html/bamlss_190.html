<div class="container">

<table style="width: 100%;"><tr>
<td>sam_MVNORM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create Samples for BAMLSS by Multivariate Normal Approximation
</h2>

<h3>Description</h3>

<p>This sampler function for BAMLSS uses estimated <code>parameters</code> and the Hessian
information to create samples from a multivariate normal distribution. Note that smoothing
variance uncertainty is not accounted for, therefore, the resulting credible intervals
are most likely too narrow. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">sam_MVNORM(x, y = NULL, family = NULL, start = NULL,
  n.samples = 500, hessian = NULL, ...)

MVNORM(x, y = NULL, family = NULL, start = NULL,
  n.samples = 500, hessian = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The <code>x</code> list, as returned from
function <code>bamlss.frame</code>, holding all model matrices and other information that is
used for fitting the model. Or an object returned from function <code>bamlss</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The model response, as returned from function <code>bamlss.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <span class="pkg">bamlss</span> family object, see <code>family.bamlss</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named numeric vector containing possible starting values, the names are based on
function <code>parameters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.samples</code></td>
<td>
<p>Sets the number of samples that should be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>The Hessian matrix that should be used. Note that the row and column names
must be the same as the names of the <code>parameters</code>. If <code>hessian = NULL</code>
the function uses <code>optim</code> to compute the Hessian if it is not provided
within <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to function <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function <code>MVNORM()</code> returns samples of parameters. The samples are provided as a
<code>mcmc</code> matrix.
</p>


<h3>See Also</h3>

<p><code>bamlss</code>, <code>bamlss.frame</code>,
<code>bamlss.engine.setup</code>, <code>set.starting.values</code>, <code>opt_bfit</code>,
<code>sam_GMCMC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulated data example illustrating
## how to call the sampler function.
## This is done internally within
## the setup of function bamlss().
d &lt;- GAMart()
f &lt;- num ~ s(x1, bs = "ps")
bf &lt;- bamlss.frame(f, data = d, family = "gaussian")

## First, find starting values with optimizer.
o &lt;- with(bf, opt_bfit(x, y, family))

## Sample.
samps &lt;- with(bf, sam_MVNORM(x, y, family, start = o$parameters))
plot(samps)
</code></pre>


</div>