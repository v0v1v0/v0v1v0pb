<div class="container">

<table style="width: 100%;"><tr>
<td>gibbs_vnp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs sampler for multivaiate Bayesian nonparametric inference with Whittle likelihood</h2>

<h3>Description</h3>

<p>Obtain samples of the posterior of the multivariate Whittle likelihood in conjunction with an Hpd AGamma process prior on the spectral density matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gibbs_vnp(
  data,
  Ntotal,
  burnin,
  thin = 1,
  print_interval = 100,
  numerical_thresh = 1e-07,
  adaption.N = burnin,
  adaption.batchSize = 50,
  adaption.tar = 0.44,
  eta = ncol(data),
  omega = ncol(data),
  Sigma = 10000 * diag(ncol(data)),
  k.theta = 0.01,
  kmax = 100 * coars + 500 * (!coars),
  trunc_l = 0.1,
  trunc_r = 0.9,
  coars = F,
  L = max(20, length(data)^(1/3))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>numeric matrix; NA values are interpreted as missing values and treated as random</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntotal</code></td>
<td>
<p>total number of iterations to run the Markov chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of initial iterations to be discarded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning number (postprocessing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_interval</code></td>
<td>
<p>Number of iterations, after which a status is printed to console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numerical_thresh</code></td>
<td>
<p>Lower (numerical pointwise) bound for the eigenvalues of the spectral density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaption.N</code></td>
<td>
<p>total number of iterations, in which the proposal variances (of r and U) are adapted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaption.batchSize</code></td>
<td>
<p>batch size of proposal adaption</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaption.tar</code></td>
<td>
<p>target acceptance rate for adapted parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>AGamma process parameter, real number &gt; ncol(data)-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>AGamma process parameter, positive constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>AGamma process parameter, Hpd matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.theta</code></td>
<td>
<p>prior parameter for polynomial degree k (propto exp(-k.theta*k*log(k)))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>upper bound for polynomial degree of Bernstein-Dirichlet mixture (can be set to Inf, algorithm is faster with kmax&lt;Inf due to pre-computation of basis functions, but values 500&lt;kmax&lt;Inf are very memory intensive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc_l, trunc_r</code></td>
<td>
<p>left and right truncation of Bernstein polynomial basis functions, 0&lt;=trunc_l&lt;trunc_r&lt;=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coars</code></td>
<td>
<p>flag indicating whether coarsened or default bernstein polynomials are used (see Appendix E.1 in Ghosal and van der Vaart 2017)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>truncation parameter of Gamma process</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A detailed description of the method can be found in Section 5 in Meier (2018).
</p>


<h3>Value</h3>

<p>list containing the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r,x,U</code></td>
<td>
<p>traces of the AGamma process parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>posterior trace of polynomial degree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psd.median,psd.mean</code></td>
<td>
<p>psd estimates: (pointwise, componentwise) posterior median and mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psd.p05,psd.p95</code></td>
<td>
<p>pointwise credibility interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psd.u05,psd.u95</code></td>
<td>
<p>uniform credibility interval, see (6.5) in Meier (2018)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lpost</code></td>
<td>
<p>trace of log posterior</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>A. Meier (2018)
<em>A Matrix Gamma Process and Applications to Bayesian Analysis of Multivariate Time Series</em>
PhD thesis, OvGU Magdeburg
&lt;https://opendata.uni-halle.de//handle/1981185920/13470&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

##
## Example: Fit multivariate NP model to SOI/Recruitment series:
##

data &lt;- cbind(as.numeric(astsa::soi-mean(astsa::soi)), 
              as.numeric(astsa::rec-mean(astsa::rec)) / 50)
data &lt;- apply(data, 2, function(x) x-mean(x))

# If you run the example be aware that this may take several minutes
print("example may take some time to run")
mcmc &lt;- gibbs_vnp(data=data, Ntotal=10000, burnin=4000, thin=2)

# Visualize results
plot(mcmc, log=T)


##
## Example 2: Fit multivariate NP model to VMA(1) data
##

n &lt;- 256
ma &lt;- rbind(c(-0.75, 0.5), c(0.5, 0.75))
Sigma &lt;- rbind(c(1, 0.5), c(0.5, 1))
data &lt;- sim_varma(model=list(ma=ma), n=n, d=2)
data &lt;- apply(data, 2, function(x) x-mean(x))

# If you run the example be aware that this may take several minutes
print("example may take some time to run")
mcmc &lt;- gibbs_vnp(data=data, Ntotal=10000, burnin=4000, thin=2)

# Plot spectral estimate, credible regions and periodogram on log-scale
plot(mcmc, log=T)

## End(Not run)
</code></pre>


</div>