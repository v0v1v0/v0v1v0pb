<div class="container">

<table style="width: 100%;"><tr>
<td>GraphFullCIs.MD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot all the CBLS potential solutions</h2>

<h3>Description</h3>

<p>Display a plot with all the CBLS potential solutions in a (M,D) plot from ρ_{MD} = -1 to ρ_{MD} = 1 (useful for unreplicated data), choose between all the slopes (and their confidence intervals), all the intercepts (and their confidence intervals), all the confidence regions (ellipses), the two extreme confidence intervals (for the expectation of Y) or the two extreme confidence bands.</p>


<h3>Usage</h3>

<pre><code class="language-R">GraphFullCIs.MD(FullCIs = NULL, CBLS.estimate = NULL, lambda = NULL,
                xname = "X", yname = "Y", antilog = NULL, graph = "joint.ellipse",
                accept.int = 0, accept.int.perc = FALSE, accept.int.threshold = NULL,
                include.H0 = TRUE, include.int = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>FullCIs</code></td>
<td>
<p> a CIs.MD class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CBLS.estimate</code></td>
<td>
<p> a <code>CBLS</code> class object. The CBLS estimates (obtained, for example, with replicated data) will be superimposed on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a lambdas class object. The value of λ (ratio of the error measurement variances) will be converted to ρ (correlation between the error measurement) and superimposed on the plot with its confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>antilog</code></td>
<td>
<p> a character string or a numeric value. This argument displays the CBLS results on the initial scales on the (M,D) plot if a logarithmic transformation was used prior to the CBLS function. Options available are: 10 or "e".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p> a character string for the type of graph: "slope" to plot all the slopes, "intercept" to plot all the intercepts,"joint.ellipse" to plot all the joint confidence intervals (ellipses), "CI" to plot the confidence intervals,"CB" to plot the confidence bands, "all" to plot all the plots on different windows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.int</code></td>
<td>
<p> a numeric vector (length equal 1 or 2) for the value of Δ: |Y-X|&lt;Δ to assess whether two devices (X and Y) are equivalent or not. Two values of Δ can be entered to take into account the case where the equivalence threshold changes along the M axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.int.perc</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether Δ needs to be interpreted in percentage: Y = X ± Δ %.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.int.threshold</code></td>
<td>
<p> a numeric value for the M threshold where the value of Δ changes if two Δ values are used in <code>accept.int</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.H0</code></td>
<td>
<p>a logical variable (TRUE or FALSE) whether the null hypothesis (slope = 0, intercept = 0) should lie on plot (in the case that the null hypothesis is out from the axes limits).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.int</code></td>
<td>
<p>a logical variable (TRUE or FALSE) whether the confidence intervals should lie entirely in the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The ellipses are plotted in an (β,α) coordinate system where the acceptance interval is a diamond. The slopes and the intercepts are plotted on the Y-axis with ρ assigned on the X-axis. The confidence intervals and confidence bands are displayed on a (M,D) plot (Bland-Altman plot).</p>


<h3>Value</h3>

<p> The plot requested by the argument <code>graph</code>.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code>MD.plot</code>, <code>CBLS</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(BivRegBLS)
data(SBP)
# Estimate all the solutions with the CBLS regression
res.full=FullCIs.MD(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Estimate the CBLS regression with replicated data
res.CBLS=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Estimate the measurement error variances ratio
res.lambda=lambdas(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Plot all the results with all the potential solutions
#   and superimpose the CBLS regression estimated with replicated data
GraphFullCIs.MD(FullCIs=res.full,CBLS.estimate=res.CBLS,lambda=res.lambda,
                xname="J",yname="S",graph="all",accept.int=10,accept.int.perc=FALSE,include.H0=TRUE)
data(Aromatics)
# Estimate all the solutions with the CBLS regression
res.full=FullCIs.MD(data=Aromatics,xcol=3,ycol=4)
# Plot all the potential solutions for the confidence regions (ellipses)
GraphFullCIs.MD(FullCIs=res.full,xname="HPLC",yname="GC MS",graph="joint.ellipse")
# Plot all the potential solutions for the confidence intervals and add two acceptance intervals
GraphFullCIs.MD(FullCIs=res.full,xname="HPLC",yname="GC MS",graph="CI",
                accept.int=c(0.1,0.2),accept.int.threshold=15)
</code></pre>


</div>