<div class="container">

<table style="width: 100%;"><tr>
<td>d2:fitpred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for fitting models with MCMC, predicting class labels of test cases, and finding predictive probabilities with cross-validation</h2>

<h3>Description</h3>

<p><code>bcbcsf_fitpred</code> trains  models with Gibbs sampling for each number of retained features. The results are saved in files. This function also makes predictions for test cases if they are provided.
</p>
<p><code>bcbcsf_pred</code> uses the posterior samples saved by <code>bcbcsf_fitpred</code> to predict the class labels of test cases. Prediction results are an array of predictive probabilities <code>array_probs_pred</code>, whose rows for test cases, columns for classes, and the 3rd dimension for different numbers of retained features.
</p>
<p><code>cross_vld</code> uses cross-validation to obtain predictive probabilities for all cases of a data set. This generic function can be used with <code>bcbcsf_fitpred</code> and other classifiers. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
bcbcsf_fitpred (
  ## arguments specifying info of data sets
  X_tr, y_tr, nos_fsel = ncol (X_tr), 
  X_ts = NULL,  standardize = FALSE, rankf = FALSE,
  ## arguments for prediction
  burn = NULL, thin = 1, offset_sdxj = 0.5,
  ## arguments for Markov chain sampling
  no_rmc = 1000, no_imc = 5, no_mhwmux = 10,
  fit_bcbcsf_filepre = ".fitbcbcsf_", 
  ## arguments specifying priors for parameters and hyerparameters
  w0_mu = 0.05, alpha0_mu = 0.5, alpha1_mu = 3,
  w0_x  = 1.00, alpha0_x  = 0.5, alpha1_x  = 10,
  w0_nu = 0.05, alpha0_nu = 0.5, prior_psi = NULL,
  ## arguments for metropolis sampling for wmu, wx
  stepadj_mhwmux = 1, diag_mhwmux = FALSE,
  ## arguments for computing adjustment factor
  bcor = 1, cut_qf = exp (-10), cut_dpoi = exp (-10), nos_sim = 1000,
  ## whether look at progress
  monitor = TRUE)
  
bcbcsf_pred (X_ts, out_fit, burn = NULL, thin = 1, offset_sdxj = 0.5)

cross_vld (X, y, nfold = 10, folds = NULL, 
           fitpred_func = bcbcsf_fitpred,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_tr, X_ts, X</code></td>
<td>
<p>matrices containing gene expression data; rows should be for the cases, and columns for different genes; <code>X_tr</code> are training data, <code>X_ts</code> are test data or future data for which prediction are needed, <code>X</code> are a data set used for cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_tr,y</code></td>
<td>
<p>class labels in training or test data set, or just a data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nos_fsel</code></td>
<td>
<p>a vector of numbers of features to be retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn,thin</code></td>
<td>
<p><code>burn</code> of Markov chain (super)iterations will be discarded for prediction, and only every <code>thin</code>th are used; by default, 20% of (super)iterations are burned, and <code>thin</code>=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset_sdxj</code></td>
<td>
<p>a value between 0 and 1; 100*<code>offset_sdxj</code>% quantile of the samples of all standard deviations <code class="reqn">\sqrt{w^x_j}</code> is added to the all standard deviations; this is to remedy the non-normality in real gene expression data sets, and especially offset some very small standard deviations; by default, median is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_rmc, no_imc</code></td>
<td>
<p><code>no_rmc</code> of super Markov chain transitions are run, with <code>no_imc</code> Markov chain iterations for each; only the last state of each super transition is saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_bcbcsf_filepre</code></td>
<td>
<p>a string added to the names of files saving Markov chain fitting results; the actual file names contain also the data dimension and number of retained features; when <code>fit_bcbcsf_filepre</code> is set to NULL, no fitting file will be created, and <code>bcbcsf_fitpred</code> returns only the fitting result corresponding to the last number of retained features in <code>nos_fsel</code>, which is always returned regardless of the value of <code>fit_bcbcsf_filepre</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w0_mu,alpha0_mu,alpha1_mu,w0_x,alpha0_x,alpha1_x,w0_nu,alpha0_nu</code></td>
<td>
<p>settings of priors for means and variances of genes; they are denoted by <code class="reqn">w_0^{\mu}</code>, <code class="reqn">\alpha_1^{\mu}</code>, <code class="reqn">\alpha_1^\mu</code>,<code class="reqn">w_0^x</code>,<code class="reqn">\alpha_0^x</code>,<code class="reqn">\alpha_1^x</code>,<code class="reqn">w_0^\nu</code>,<code class="reqn">\alpha_0^\nu</code> in the reference. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_psi</code></td>
<td>
<p>a vector of length the number of classes, specifying the Dirichlet prior distribution for probabilities of classes; it is denoted by <code class="reqn">c_{1:G}</code> in the reference; by default, they are all equal to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_mhwmux,stepadj_mhwmux, diag_mhwmux</code></td>
<td>
<p>arguments specifying Metropolis sampling for <code class="reqn">\log(w^\mu)</code> and <code class="reqn">\log(w^x)</code>; respectively the number of iterations, stepsize adjustment, and an indicator representing whether one wants to pause and look into this sampling. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bcor</code></td>
<td>
<p>taking value 0 or 1, indicating whether bias-correction is to be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_qf, cut_dpoi,nos_sim</code></td>
<td>
<p>arguments specifying approximation of adjustment factor; <code>cut_qf</code> is <code class="reqn">f_\ell</code> in the reference, <code>cut_dpoi</code> is the threshold below which Poisson probabilities are omitted, <code>nos_sim</code> is the number of random <code class="reqn">\Lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold, folds</code></td>
<td>
<p><code>folds</code> should be a list of test cases for different folds; if <code>folds</code> is NULL (by default), <code>folds</code> will be generated by the software, with <code>nfold</code> is set to the smaller value of the given value and the smallest number of cases in all classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_fit</code></td>
<td>
<p>a list returned by <code>bcbcsf_fitpred</code>, which are used to make prediction for test cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>if it is set to TRUE, the original gene expression values are centralized and divided by the pooled standard deviation; by default, it is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rankf</code></td>
<td>
<p>if it is set to TRUE, the original features will be re-ordered by F-statistic; by default, it is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor</code></td>
<td>
<p>if it is set to TRUE, progress of fitting is shown on screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitpred_func</code></td>
<td>
<p>an R function that can fit with training data, and predict for test data; the arguments of <code>fitpred_func</code> must include <code>X_tr</code>, <code>y_tr</code>, <code>X_ts</code>,  and the outputs of <code>fitpred_func</code> must include <code>array_probs_pred</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to classifier <code>fitpred_func</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nos_fsel</code></td>
<td>
<p>a vector of numbers of features retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitfiles</code></td>
<td>
<p>a string vector of length <code>nos_fsel</code>, each saving file name of Markov chain fitting result for a number of retained features in <code>nos_fsel</code>;  the <code>fitfiles</code> returned by <code>cross_vld</code> is for the training in the last fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>array_probs_pred</code></td>
<td>
<p>an array of predictive probabilities, whose rows for test cases, columns for classes, and the 3rd dimension for different numbers of retained features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_bcbcsf</code></td>
<td>
<p>a list of Markov chain sampling results from the fitting with number of retained features equal to the last number in <code>nos_fsel</code>. Note that, the fitting results for other numbers (including the last one) of retained feature are saved in harddrive files if <code>fit_bcbcsf_filepre</code> isn't empty, and can be retrieved using function <code>reload_fit_bcbcsf</code>. Particularly, the list component of <code>fit_bcbcsf</code> has <code>fsel</code> saving the indice of features selected by F-statistic.</p>
</td>
</tr>
</table>
</div>