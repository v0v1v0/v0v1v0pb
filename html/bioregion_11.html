<div class="container">

<table style="width: 100%;"><tr>
<td>hclu_optics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>OPTICS hierarchical clustering algorithm</h2>

<h3>Description</h3>

<p>This function performs semi-hierarchical
clustering on the basis of dissimilarity with the OPTICS algorithm (Ordering
Points To Identify the Clustering Structure)
</p>


<h3>Usage</h3>

<pre><code class="language-R">hclu_optics(
  dissimilarity,
  index = names(dissimilarity)[3],
  minPts = NULL,
  eps = NULL,
  xi = 0.05,
  minimum = FALSE,
  show_hierarchy = FALSE,
  algorithm_in_output = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dissimilarity</code></td>
<td>
<p>the output object from <code>dissimilarity()</code> or
<code>similarity_to_dissimilarity()</code>, or a <code>dist</code> object.
If a <code>data.frame</code> is used, the first two columns represent pairs of
sites (or any pair of nodes), and the next column(s) are the dissimilarity
indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>name or number of the dissimilarity column to use. By default,
the third column name of <code>dissimilarity</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPts</code></td>
<td>
<p>a <code>numeric</code> value specifying the minPts argument of
dbscan). minPts is the minimum number of
points to form a dense region. By default, it is set to the natural
logarithm of the number of sites in <code>dissimilarity</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>a <code>numeric</code> value specifying the eps argument of
optics). It is the upper limit of the size
of the epsilon neighborhood. Limiting the neighborhood size improves
performance and has no or very little impact on the ordering as long as it
is not set too low. If not specified (default behavior), the largest
minPts-distance in the data set is used which gives the same result as
infinity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>a <code>numeric</code> value specifying the steepness threshold to
identify clusters hierarchically using the Xi method
(see optics).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p>a <code>boolean</code> specifying if the hierarchy should be pruned
out from the output to only keep clusters at the "minimal" level, i.e.
only leaf / non-overlapping clusters.
If <code>TRUE</code>, then argument <code>show_hierarchy</code> should be <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_hierarchy</code></td>
<td>
<p>a <code>boolean</code> specifying if the hierarchy of
clusters should be included in the output. By default, the hierarchy is not
visible in the clusters obtained from OPTICS - it can only be visualized by
visualising the plot of the OPTICS object. If <code>show_hierarchy = TRUE</code>,
then the output cluster <code>data.frame</code> will contain additional columns
showing the hierarchy of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm_in_output</code></td>
<td>
<p>a <code>boolean</code> indicating if the original output
of dbscan should be returned in the output (<code>TRUE</code> by
default, see Value).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>you can add here further arguments to be passed to <code>optics()</code>
(see optics).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The OPTICS (Ordering points to identify the clustering structure) is a
semi-hierarchical clustering algorithm which orders the points in the
dataset such that points which are closest become neighbors, and calculates
a reachability distance for each point. Then, clusters can be extracted in a
hierarchical manner from this reachability distance, by identifying clusters
depending on changes in the relative cluster density. The reachability plot
should be explored to understand the clusters and their hierarchical nature,
by running plot on the output of the function
if <code>algorithm_in_output = TRUE</code>: <code>plot(object$algorithm)</code>.
We recommend reading (Hahsler et al. 2019) to grasp the
algorithm, how it works, and what the clusters mean.
</p>
<p>To extract the clusters, we use the
extractXi function which is based on the
steepness of the reachability plot (see
optics)
</p>


<h3>Value</h3>

<p>A <code>list</code> of class <code>bioregion.clusters</code> with five slots:
</p>

<ol>
<li>
<p><strong>name</strong>: <code>character</code> containing the name of the algorithm
</p>
</li>
<li>
<p><strong>args</strong>: <code>list</code> of input arguments as provided by the user
</p>
</li>
<li>
<p><strong>inputs</strong>: <code>list</code> of characteristics of the clustering process
</p>
</li>
<li>
<p><strong>algorithm</strong>: <code>list</code> of all objects associated with the
clustering procedure, such as original cluster objects
</p>
</li>
<li>
<p><strong>clusters</strong>: <code>data.frame</code> containing the clustering results</p>
</li>
</ol>
<p>In the <code>algorithm</code> slot, if <code>algorithm_in_output = TRUE</code>, users can
find the output of optics.
</p>


<h3>Author(s)</h3>

<p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>),
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) and
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)
</p>


<h3>References</h3>

<p>Hahsler M, Piekenbrock M, Doran D (2019).
“Dbscan: Fast density-based clustering with R.”
<em>Journal of Statistical Software</em>, <b>91</b>(1).
ISSN 15487660.
</p>


<h3>See Also</h3>

<p>nhclu_dbscan
</p>


<h3>Examples</h3>

<pre><code class="language-R">dissim &lt;- dissimilarity(fishmat, metric = "all")
  
clust1 &lt;- hclu_optics(dissim, index = "Simpson")
clust1

# Visualize the optics plot (the hierarchy of clusters is illustrated at the
# bottom)
plot(clust1$algorithm)

# Extract the hierarchy of clusters
clust1 &lt;- hclu_optics(dissim, index = "Simpson", show_hierarchy = TRUE)
clust1

</code></pre>


</div>