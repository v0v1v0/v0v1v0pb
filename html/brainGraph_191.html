<div class="container">

<table style="width: 100%;"><tr>
<td>Residuals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear model residuals in structural covariance networks</h2>

<h3>Description</h3>

<p><code>get.resid</code> runs linear models across brain regions listed in a
<code>data.table</code> (e.g., cortical thickness), adjusting for variables in
<code>covars</code> (e.g. age, sex, etc.), and calculates the
<em>externally Studentized</em> (or <em>leave-one-out</em>) residuals.
</p>
<p>The <code>[</code> method reorders or subsets residuals based on a given
numeric vector. However, this is used in bootstrap and permutation analysis
and should generally not be called directly by the user.
</p>
<p>The <code>summary</code> method prints the number of outliers per region, and the
number of times a given subject was an outlier (i.e., across regions).
</p>
<p>The <code>plot</code> method lets you check the model residuals for each brain
region in a structural covariance analysis. It shows a <em>qqplot</em> of the
studentized residuals, as output from <code>get.resid</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.resid(dt.vol, covars, method = c("comb.groups", "sep.groups"),
  use.mean = FALSE, exclude.cov = NULL, atlas = NULL, ...)

## S3 method for class 'brainGraph_resids'
x[i, g = NULL]

## S3 method for class 'brainGraph_resids'
summary(object, region = NULL,
  outlier.thresh = 2, ...)

## S3 method for class 'brainGraph_resids'
plot(x, region = NULL, outlier.thresh = 2,
  cols = FALSE, ids = TRUE, ...)

## S3 method for class 'brainGraph_resids'
nobs(object, ...)

## S3 method for class 'brainGraph_resids'
case.names(object, ...)

## S3 method for class 'brainGraph_resids'
groups(x)

## S3 method for class 'brainGraph_resids'
region.names(object)

## S3 method for class 'brainGraph_resids'
nregions(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dt.vol</code></td>
<td>
<p>A <code>data.table</code> containing all the volumetric measure of
interest (i.e., the object <code>lhrh</code> as output by
<code>import_scn</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>A <code>data.table</code> of the covariates of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string indicating whether to test models for subject
groups separately or combined. Default: <code>comb.groups</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.mean</code></td>
<td>
<p>Logical should we control for the mean hemispheric brain
value (e.g. mean LH/RH cortical thickness). Default: <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.cov</code></td>
<td>
<p>Character vector of covariates to exclude. Default:
<code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atlas</code></td>
<td>
<p>Character string indicating the brain atlas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>brainGraph_GLM_design</code> (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>A <code>brainGraph_resids</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Numeric vector of the indices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Character string indicating the group. Default: <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>Character vector of region(s) to focus on; default behavior is
to show summary for all regions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.thresh</code></td>
<td>
<p>Number indicating how many standard deviations
above/below the mean indicate an outlier. Default: <code>2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>Logical indicating whether to color by group. Default:
<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>Logical indicating whether to plot subject ID's for outliers.
Otherwise plots the integer index</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You can choose to run models for each of your subject groups separately or
combined (the default) via the <code>method</code> argument. You may also choose
whether to include the mean, per-hemisphere structural measure in the
models. Finally, you can specify variables that are present in <code>covars</code>
which you would like to exclude from the models. Optional arguments can be
provided that get passed to <code>brainGraph_GLM_design</code>.
</p>
<p>If you do not explicitly specify the atlas name, then it will be guessed from
the size of your data. This could cause problems if you are using a custom
atlas, with or without the same number of regions as a dataset in the
package.
</p>


<h3>Value</h3>

<p><code>get.resid</code> - an object of class <code>brainGraph_resids</code> with
elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.table with the input volume/thickness/etc. data as well
as the covariates used in creating the design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The <em>design matrix</em>, if using default arguments. If
<code>use.mean=TRUE</code> then it will be a <em>named list</em> with a separate
matrix for the left and right hemispheres. If <code>method='sep.groups'</code>, a
nested named list for each group and hemisphere.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The input argument <code>method</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.mean</code></td>
<td>
<p>The input argument <code>use.mean</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resids.all</code></td>
<td>
<p>The “wide” <code>data.table</code> of residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Group</code></td>
<td>
<p>Group names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atlas</code></td>
<td>
<p>The atlas name</p>
</td>
</tr>
</table>
<p><code>summary.brainGraph_resids</code> returns a list with two
data tables, one of the residuals, and one of only the outlier regions
</p>
<p>The <code>plot</code> method returns a <code>trellis</code> object or a list of
<code>ggplot</code> objects
</p>


<h3>Note</h3>

<p>It is assumed that <code>dt.vol</code> was created using
<code>import_scn</code>. In older versions, there were issues when the Study
ID was specified as an integer and was not “zero-padded”. This is done
automatically by <code>import_scn</code>, so if you are using an external
program, please be sure that the Study ID column is matched in both
<code>dt.vol</code> and <code>covars</code>.
</p>


<h3>Author(s)</h3>

<p>Christopher G. Watson, <a href="mailto:cgwatson@bu.edu">cgwatson@bu.edu</a>
</p>


<h3>See Also</h3>

<p><code>influence.measures</code>, <code>qqnorm</code>
</p>
<p>Other Structural covariance network functions: <code>Bootstrapping</code>,
<code>IndividualContributions</code>,
<code>brainGraph_permute</code>,
<code>corr.matrix</code>, <code>import_scn</code>,
<code>plot_volumetric</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
myresids &lt;- get.resids(lhrh, covars)
residPlots &lt;- plot(myresids, cols=TRUE)

## Save as a multi-page PDF
ml &lt;- marrangeGrob(residPlots, nrow=3, ncol=3)
ggsave('residuals.pdf', ml)

## End(Not run)
</code></pre>


</div>