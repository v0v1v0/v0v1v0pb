<div class="container">

<table style="width: 100%;"><tr>
<td>shrgamsp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox PH model with univariate and bivariate shared gamma frailty model.</h2>

<h3>Description</h3>

<p>Fit Cox PH model with univariate and bivariate shared gamma frailty model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shrgamsp(
  formula,
  data,
  weights = NULL,
  initfrailp = NULL,
  control = bcfrailph.control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, with the response on the left of a ~ operator, and the terms on the right. The response must be a survival object as returned by the <code>Surv</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe contain survival time, censor, covariate etc with data in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>vector of case weights for gamma model. the default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initfrailp</code></td>
<td>
<p>Initial estimates for the frailty parameters. The default is c(0.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Arguments to control the fit. The default is <code>bcfrailph.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of shrgamsp contains  the following components.
</p>

<ul>
<li> <p><code>coefficients</code> - A vector of estimated Covariate coefficients.
</p>
</li>
<li> <p><code>frailparest</code> - A vector of estimated Frailty parameters i.e. frailty variance and correlation.
</p>
</li>
<li> <p><code>vcov</code>- Variance Covariance matrix of the Estimated Covariate coefficients obtained from the observed information matrix.
</p>
</li>
<li> <p><code>stderr</code>-A vector containing the Standard error of the Estimated parameters both covariate coefficients and  frailty parameter.
</p>
</li>
<li> <p><code>loglik0</code>- Log likelihood of without frailty model.
</p>
</li>
<li> <p><code>loglik</code>-Log likelihood of Cox PH model with frailty.
</p>
</li>
<li> <p><code>Iloglilk</code>- Log likelihood of with frailty model after integrating out the frailty term.
</p>
</li>
<li> <p><code>bhaz</code>- an array containing unique event times and estimated baseline hazard.
</p>
</li>
<li> <p><code>X</code>-Matrix of observed covariates.
</p>
</li>
<li> <p><code>time</code>-the observed survival time.
</p>
</li>
<li> <p><code>censor</code>-censoring indicator.
</p>
</li>
<li> <p><code>resid</code>-the martingale residuals.
</p>
</li>
<li> <p><code>lin.prid</code>-the vector of linear predictors.
</p>
</li>
<li> <p><code>frail</code>-estimated Frailty values.
</p>
</li>
<li> <p><code>iteration</code>-Number of outer iterations.
</p>
</li>
<li> <p><code>e.time</code>-the vector of unique event times.
</p>
</li>
<li> <p><code>n.event</code>- the number of events at each of the unique event times.
</p>
</li>
<li> <p><code>convergence</code>-an indicator of convergence . see <code>nlminb</code>.
</p>
</li>
</ul>
<h3>Note</h3>

<p>This is just a <code>coxph</code> model with gamma frailty and the differences between
<code>coxph</code> with gamma frailty fit and <code>shrgamsp</code> fit is on the standard errors of the
covariates cofficients. Here, the standard errors of the estimated covariate coefficients and the frailty variance parameter are obtained using
the standard errors estimation approach given in Klein and Moeschberger (2003).
</p>


<h3>References</h3>

<p>Duchateau, L., Janssen, P. (2008) The Frailty Model. Springer, New York.
</p>
<p>Klein, J. P., and Moeschberger, M. L. (2003), Survival analysis: techniques for censored and truncated data, New York: Springer.
</p>


<h3>See Also</h3>

<p><code>bcfrailph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2)
n1=500;IID=array(1:n1)
X1&lt;-runif(n1,  min=0, max=1)
z=rgamma(n1,shape=2,scale=0.5)
u1&lt;-runif(n1,  min=0, max=1)
time&lt;- 1/0.1*log(1-0.1*log(u1)/(0.0001*exp(3*X1)*z))
censor=rep(1,n1)
dataa &lt;- data.frame(time=time, X1=X1,censor=censor,IID=IID)

fitcoxfr=shrgamsp(Surv(time,censor)~ X1+frailty(IID) ,data=dataa)
fitcoxfr

</code></pre>


</div>