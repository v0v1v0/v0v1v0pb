<div class="container">

<table style="width: 100%;"><tr>
<td>plot.amlps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot smooth functions of an additive model object.</h2>

<h3>Description</h3>

<p>Displays a plot of the fitted additive smooth components of an
<code>amlps</code> object. The routine can also be used to
print a table of point and set estimates of an additive smooth term for a
user-specified grid of values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'amlps'
plot(x, xp, smoo.index, cred.int = 0.95, plot.cred = TRUE,
     np = 100, fit.col = "blue", shade.col = "gray75", show.plot = TRUE,
     show.info = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>amlps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xp</code></td>
<td>
<p>A numeric vector of grid values on which to compute a point estimate
and pointwise credible interval for the smooth function specified in
<code>smoo.index</code>. The components of <code>xp</code> must be within the range
of the observed covariate values for the corresponding smooth function.
Results will be displayed in a table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoo.index</code></td>
<td>
<p>The index of the smooth function. For instance
<code>smoo.index = 2</code> refers to the second smooth function specified in
the <code>formula</code> of the <code>amlps</code> routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred.int</code></td>
<td>
<p>The level of the pointwise credible interval to be
computed for the smooth additive term. Default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cred</code></td>
<td>
<p>Logical. Should the credible intervals be plotted?
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>The number of points used to construct the plot of the smooth
additive function. Default is 100 and allowed values are between 20 and
200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.col</code></td>
<td>
<p>The color of the fitted curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade.col</code></td>
<td>
<p>The shading color for the credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plot</code></td>
<td>
<p>Logical. Should the plot be displayed? Default is
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.info</code></td>
<td>
<p>Logical. Should the table of point and set estimates of
the smooth function on the specified <code>xp</code> values be displayed? Default
is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces a plot of a smooth additive term fitted with the
<code>amlps</code> function. On the y-axis, the estimated effective
dimension of the smooth term is also displayed. At the bottom of each
plot, vertical ticks indicate the location of the covariate values. The
labels on the x-axis correspond to the covariate name associated to the
smooth term.
</p>


<h3>Value</h3>

<p>If <code>xp</code> is unspecified (the default), the routine will only
return a plot of the estimated smooth curve. Otherwise, it provides a
list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xp</code></td>
<td>
<p>The chosen points on which to compute the smooth fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sm.xp</code></td>
<td>
<p>The estimated smooth fit at points specified in <code>xp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sm.low</code></td>
<td>
<p>The lower bound of the pointwise credible interval for the
smooth additive function at points specified in <code>xp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sm.up</code></td>
<td>
<p>The upper bound of the pointwise credible interval for the
smooth additive function at points specified in <code>xp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred.int</code></td>
<td>
<p>The chosen level to compute credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoo.index</code></td>
<td>
<p>The index of the smooth function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Oswaldo Gressani <a href="mailto:oswaldo_gressani@hotmail.fr">oswaldo_gressani@hotmail.fr</a>.
</p>


<h3>See Also</h3>

<p><code>amlps</code>, <code>amlps.object</code>,
<code>print.amlps</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Classic simulated data example

set.seed(3)

sim.data &lt;- simgamdata(setting = 2, n = 200, dist = "gaussian", scale = 0.3)
plot(sim.data)         # Scatter plot of response
data &lt;- sim.data$data  # Simulated data frame

# Fit model
fit &lt;- amlps(y ~ z1 + z2 + sm(x1) + sm(x2), data = data, K = 20)
fit

# Plot fit of second function and results for a specific grid x
plot(fit, xp = c(-0.8, -0.4, 0, 0.4, 0.8), smoo.index = 2, ylim=c(-3, 3))

</code></pre>


</div>