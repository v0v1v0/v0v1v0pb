<div class="container">

<table style="width: 100%;"><tr>
<td>noisyr_counts_with_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply a modified noisyR counts pipeline printing a plot</h2>

<h3>Description</h3>

<p>This function is identical to the noisyr::noisyr_counts
function, with the addition of the option to print a line plot of the
similarity against expression for all samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">noisyr_counts_with_plot(
  expression.matrix,
  n.elements.per.window = NULL,
  optimise.window.length.logical = FALSE,
  similarity.threshold = 0.25,
  method.chosen = "Boxplot-IQR",
  ...,
  output.plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expression.matrix</code></td>
<td>
<p>the expression matrix; rows correspond to genes and
columns correspond to samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.elements.per.window</code></td>
<td>
<p>number of elements to have in a window passed to
calculate_expression_similarity_counts(); default 10% of the number of rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimise.window.length.logical</code></td>
<td>
<p>whether to call optimise_window_length to try and
optimise the value of n.elements.per.window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>similarity.threshold, method.chosen</code></td>
<td>
<p>parameters passed on to
<code>calculate_noise_threshold</code>; they can be single values or vectors;
if they are vectors optimal values are computed by calling
<code>calculate_noise_threshold_method_statistics</code> and
minimising the coefficient of variation across samples; all possible values for
method.chosen can be viewed by <code>get_methods_calculate_noise_threshold</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed on to <code>noisyr::noisyr_counts()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.plot</code></td>
<td>
<p>whether to create an expression-similarity plot for the
noise analysis (printed to the console); default is FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The denoised expression matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">expression.matrix &lt;- as.matrix(read.csv(
  system.file("extdata", "expression_matrix.csv", package = "bulkAnalyseR"), 
  row.names = 1
))[1:10, 1:4]
expression.matrix.denoised &lt;- noisyr_counts_with_plot(expression.matrix)
</code></pre>


</div>