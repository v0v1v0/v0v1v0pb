<div class="container">

<table style="width: 100%;"><tr>
<td>poisson.blaker.acc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Blaker's Poisson acceptability function, optionally
unimodalized.
</h2>

<h3>Description</h3>

<p>Calculates values of the acceptability function for the Poisson
distribution (see Blaker (2000))
in a sequence of points (for, e.g., plotting purposes).
The acceptability function may optionally be 
“unimodalized”, i.e. replaced with the smallest
greater or equal unimodal function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">poisson.blaker.acc(x, p, type = c("orig", "unimod"),
      acc.tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>number of events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector (length 1 allowed) of hypothesized Poisson parameters.
In case of more than one point, an increasing sequence required. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>for <code>type = "orig"</code>, original acceptability function
calculated.<br>
For <code>type = "unimod"</code>, smallest unimodal function
greater or equal to the acceptability function calculated
instead. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc.tol</code></td>
<td>

<p>numerical tolerance (relevant only for <code>type = "unimod"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to 
<code>poisson.blaker.acc.single.p</code>;
in fact, just <code>maxiter</code> (see <code>BlakerCI-internal</code>). 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Single values of the “unimodalized” acceptability function 
(for <code>type = "unimod"</code>) are computed by an iterative
numerical algorithm implemented in internal function
<br><code>poisson.blaker.acc.single.p</code>.
The function cited is called just once in each of the intervals
where the acceptability function is continuous
(namely in the leftmost one of those points of <code>p</code> 
that fall into the interval when dealing with points
below <code>x</code>, and the rightmost one when above 
<code>x</code>). The rest is done by function
<code>cummax</code>.  
This is considerably faster than calling 
<code>poisson.blaker.acc.single.p</code>
for every point of <code>p</code>.
Note that applying <code>cummax</code> directly to
a vector of unmodified acceptability values
is even faster and provides a unimodal output;
it may, nevertheless, lack accuracy. 
</p>


<h3>Value</h3>

<p>Vector of acceptability values (with or without unimodalization)
in points of <code>p</code>.
</p>


<h3>Note</h3>


<p>Inspired by M.P. Fay (2010), mentioning
“unavoidable inconsistencies” between tests with non-unimodal
acceptability functions and confidence intervals derived from them.
When the acceptability functions are unimodalized
and the test modified accordingly (i.e. p-values slightly increased
in some cases), a perfectly matching test-CI pair is obtained. 
</p>


<h3>Author(s)</h3>

<p>Jan Klaschka <a href="mailto:klaschka@cs.cas.cz">klaschka@cs.cas.cz</a>
</p>


<h3>References</h3>

<p>Blaker, H. (2000) Confidence curves and improved exact confidence 
intervals for discrete distributions.
Canadian Journal of Statistics 28: 783-798.<br>
(Corrigenda: Canadian Journal of Statistics 29: 681.)
</p>




<p>Fay, M.P. (2010). Two-sided Exact Tests and Matching Confidence 
Intervals for Discrete Data. 
R Journal 2(1): 53-58.
</p>







<h3>Examples</h3>

<pre><code class="language-R">p &lt;- seq(0,10,length=1001)
acc &lt;- poisson.blaker.acc(3,p)
acc1 &lt;- poisson.blaker.acc(3,p,type="unimod")
plot(p,acc,type="l")
lines(p,acc1,col="red")
legend(x=7,y=.8,c("orig","unimod"),col=c("black","red"),lwd=1)

## The two lines -- the unimodalized and original acceptabilities -- 
## look almost the same but some small differences are slightly 
## visible.

## They can be seen better this way:
plot(p,acc1-acc,type="l")

## Focussing on one of them:
p &lt;- seq(5.05,5.6,length=1001)
acc &lt;- poisson.blaker.acc(3,p)
acc1 &lt;- poisson.blaker.acc(3,p,type="unimod")
plot(p,acc,type="l",ylim=c(.391,.396))
lines(p,acc1,col="red")
legend(x=5.4,y=.395,c("orig","unimod"),col=c("black","red"),lwd=1)

</code></pre>


</div>