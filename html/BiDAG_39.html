<div class="container">

<table style="width: 100%;"><tr>
<td>partitionMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DAG structure sampling with partition MCMC</h2>

<h3>Description</h3>

<p>This function implements the partition MCMC algorithm for the structure learning of Bayesian networks.  This procedure provides an unbiased sample from the posterior distribution of DAGs given the data. 
The search space can be defined either by a preliminary run of the function <code>iterativeMCMC</code> or by a given adjacency matrix (which can be the full matrix with zero on the diagonal, to consider the entire space of DAGs, feasible only for a limited number of nodes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">partitionMCMC(
  scorepar,
  moveprobs = NULL,
  iterations = NULL,
  stepsave = NULL,
  alpha = 0.05,
  gamma = 1,
  verbose = FALSE,
  scoreout = FALSE,
  compress = TRUE,
  startspace = NULL,
  blacklist = NULL,
  scoretable = NULL,
  startDAG = NULL
)

## S3 method for class 'partitionMCMC'
plot(
  x,
  ...,
  burnin = 0.2,
  main = "DAG logscores",
  xlab = "iteration",
  ylab = "logscore",
  type = "l",
  col = "#0c2c84"
)

## S3 method for class 'partitionMCMC'
print(x, ...)

## S3 method for class 'partitionMCMC'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scorepar</code></td>
<td>
<p>an object of class <code>scoreparameters</code>, containing the data and scoring parameters;  see constructor function <code>scoreparameters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moveprobs</code></td>
<td>
<p>(optional) a numerical vector of 5 values in <code>{0,1}</code> corresponding to the following MCMC move probabilities in the space of partitions:
</p>

<ul>
<li>
<p> swap any two elements from different partition elements
</p>
</li>
<li>
<p> swap any two elements in adjacent partition elements
</p>
</li>
<li>
<p> split a partition element or join one
</p>
</li>
<li>
<p> move a single node into another partition element or into a new one
</p>
</li>
<li>
<p> stay still
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>integer, the number of MCMC steps, the default value is <code class="reqn">20n^{2}\log{n}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsave</code></td>
<td>
<p>integer, thinning interval for the MCMC chain, indicating the number of steps between two output iterations, the default is <code>iterations/1000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numerical significance value in <code>{0,1}</code> for the conditional independence tests at the PC algorithm stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>tuning parameter which transforms the score by raising it to this power, 1 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical, if set to TRUE (default) messages about progress will be printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoreout</code></td>
<td>
<p>logical, if TRUE the search space and score tables are returned, FALSE by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compress</code></td>
<td>
<p>logical, if TRUE adjacency matrices representing sampled graphs will be stored as a sparse Matrix (recommended); TRUE by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startspace</code></td>
<td>
<p>(optional) a square matrix, of dimensions equal to the number of nodes, which defines the search space for the order MCMC in the form of an adjacency matrix; if NULL, the skeleton obtained from the PC-algorithm will be used. If <code>startspace[i,j]</code> equals to 1 (0) it means that the edge from node <code>i</code> to node <code>j</code> is included (excluded) from the search space. To include an edge in both directions, both <code>startspace[i,j]</code> and <code>startspace[j,i]</code> should be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blacklist</code></td>
<td>
<p>(optional) a square matrix, of dimensions equal to the number of nodes, which defines edges to exclude from the search space; if <code>blacklist[i,j]=1</code> it means that the edge from node <code>i</code> to node <code>j</code> is excluded from the search space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoretable</code></td>
<td>
<p>(optional) object of class <code>scorespace</code> containing list of score tables calculated for example by the last iteration of the function <code>iterativeMCMC</code>. When not NULL, parameter <code>startspace</code> is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startDAG</code></td>
<td>
<p>(optional) an adjacency matrix of dimensions equal to the number of nodes, representing a DAG in the search space defined by startspace.  If startspace is defined but <code>startDAG</code> is not, an empty DAG will be used by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class 'partitionMCMC'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number between <code>0</code> and <code>1</code>, indicates the percentage of the samples which will be discarded as ‘burn-in’ of the MCMC chain; the rest  of the samples will be used to calculate the posterior probabilities; 0.2 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>name of the graph; "DAG logscores" by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>name of x-axis; "iteration"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>name of y-axis; "logscore"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of line in the plot; "l" by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of line in the plot; "#0c2c84" by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class 'partitionMCMC'</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Object of class <code>partitionMCMC</code>, which contains log-score trace as well 
as adjacency matrix of the maximum scoring DAG, its score and the order score. Additionally, returns all sampled DAGs (represented by their adjacency matrices), their scores,
orders and partitions See <code>partitionMCMC class</code>.
</p>


<h3>Note</h3>

<p>see also extractor functions <code>getDAG</code>, <code>getTrace</code>, <code>getSpace</code>, <code>getMCMCscore</code>.
</p>


<h3>Author(s)</h3>

<p>Jack Kuipers, Polina Suter, the code partly derived from the partition MCMC implementation from Kuipers J, Moffa G (2017) &lt;doi:10.1080/01621459.2015.1133426&gt;
</p>


<h3>References</h3>

<p>P. Suter, J. Kuipers, G. Moffa, N.Beerenwinkel (2023) &lt;doi:10.18637/jss.v105.i09&gt;
</p>
<p>Kuipers J and Moffa G (2017). Partition MCMC for inference on acyclic digraphs. Journal of the American Statistical Association 112, 282-299.
</p>
<p>Geiger D and Heckerman D (2002). Parameter priors for directed acyclic graphical models and the characterization of several probability distributions. The Annals of Statistics 30, 1412-1440.
</p>
<p>Heckerman D and Geiger D (1995). Learning Bayesian networks: A unification for discrete and Gaussian domains. In Eleventh Conference on Uncertainty in Artificial Intelligence, pages 274-284.
</p>
<p>Kalisch M, Maechler M, Colombo D, Maathuis M and Buehlmann P (2012). Causal inference using graphical models with the R package pcalg. Journal of Statistical Software 47, 1-26.
</p>
<p>Kuipers J, Moffa G and Heckerman D (2014). Addendum on the scoring of Gaussian directed acyclic graphical models. The Annals of Statistics 42, 1689-1691.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
myScore&lt;-scoreparameters("bge", Boston)
partfit&lt;-partitionMCMC(myScore)
plot(partfit)

## End(Not run)
</code></pre>


</div>