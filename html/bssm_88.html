<div class="container">

<table style="width: 100%;"><tr>
<td>ukf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unscented Kalman Filtering</h2>

<h3>Description</h3>

<p>Function <code>ukf</code> runs the unscented Kalman filter for the given
non-linear Gaussian model of class <code>ssm_nlg</code>,
and returns the filtered estimates and one-step-ahead predictions of the
states <code class="reqn">\alpha_t</code> given the data up to time <code class="reqn">t</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ukf(model, alpha = 0.001, beta = 2, kappa = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model of class <code>ssm_nlg</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Positive tuning parameter of the UKF. Default is 0.001. Smaller
the value, closer the sigma point are to the mean of the state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Non-negative tuning parameter of the UKF. The default value is
2, which is optimal for Gaussian states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Non-negative tuning parameter of the UKF, which also affects
the spread of sigma points. Default value is 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing the log-likelihood,
one-step-ahead predictions <code>at</code> and filtered
estimates <code>att</code> of states, and the corresponding variances <code>Pt</code> and
<code>Ptt</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Takes a while on CRAN
set.seed(1)
mu &lt;- -0.2
rho &lt;- 0.7
sigma_y &lt;- 0.1
sigma_x &lt;- 1
x &lt;- numeric(50)
x[1] &lt;- rnorm(1, mu, sigma_x / sqrt(1 - rho^2))
for(i in 2:length(x)) {
  x[i] &lt;- rnorm(1, mu * (1 - rho) + rho * x[i - 1], sigma_x)
}
y &lt;- rnorm(50, exp(x), sigma_y)

pntrs &lt;- cpp_example_model("nlg_ar_exp")

model_nlg &lt;- ssm_nlg(y = y, a1 = pntrs$a1, P1 = pntrs$P1, 
  Z = pntrs$Z_fn, H = pntrs$H_fn, T = pntrs$T_fn, R = pntrs$R_fn, 
  Z_gn = pntrs$Z_gn, T_gn = pntrs$T_gn,
  theta = c(mu= mu, rho = rho, 
    log_sigma_x = log(sigma_x), log_sigma_y = log(sigma_y)), 
  log_prior_pdf = pntrs$log_prior_pdf,
  n_states = 1, n_etas = 1, state_names = "state")

out_iekf &lt;- ekf(model_nlg, iekf_iter = 5)
out_ukf &lt;- ukf(model_nlg, alpha = 0.01, beta = 2, kappa = 1)
ts.plot(cbind(x, out_iekf$att, out_ukf$att), col = 1:3)

</code></pre>


</div>