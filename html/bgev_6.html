<div class="container">

<table style="width: 100%;"><tr>
<td>distCheck</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Check implementation of a distribution in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. 
</h2>

<h3>Description</h3>

<p>This is just a refactorization of 
the original <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>distCheck</code> to allow customization for heavy tailed distributions
and distribution with constrained support. Assumes one has implemented density, 
probability, quantile and random generation for a new distribution. 
Originally implemented to be used with the bimodal GEV distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">distCheck(fun = "norm", n = 1000, robust = FALSE, subdivisions = 1500, 
support.lower = -Inf, support.upper = Inf, 
var.exists = TRUE, print.result = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>

<p>Name of distribution. E.g, "bgev" for bimodal GEV, "gev" for GEV, "norm" for normal. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>size of the sample when generating random values through "rfun"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Boolean. Used for computing mean and variance in a robust way when evaluating mean 
and variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>

<p>used for numerical integration when using "dfun"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support.lower</code></td>
<td>

<p>lower limit of the support of the distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support.upper</code></td>
<td>

<p>upper limit of the support of the distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.exists</code></td>
<td>

<p>Boolean indicating if variance exists (useful for gev, bimodal gev, stable etc)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.result</code></td>
<td>

<p>Boolean indicating weather to print results of the tests on screen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>parameters passed to the distribution, e.g., mu and sd for normal, mu, sigma, xi
and delta for bimodal GEV.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All tests results are organized into a list to make it easier to find where 
results went wrong and to make it scalable for testing distributions for 
several parameters. 
</p>


<h3>Value</h3>

<p>A list of lists with test results
</p>
<p><code>list( functionTested = fun,
              functionParam = list(...),</code><br><code>test1.density =      list(computed = NULL, expected = NULL, error.check = NULL),</code><br><code>test2.quantile.cdf = list(computed = NULL, expected = NULL, error.check = NULL),</code><br><code>test3.mean.var =     list(computed = list(mean = NULL, var = NULL, log = NULL), </code><br><code> expected = list(mean = NULL, var = NULL, log = NULL),</code><br><code>  error.check = NULL, </code><br><code>  condition.is.var.finite = TRUE))</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>functionParam </code></td>
<td>
<p>Additional parameters passed to the distribution with the ... argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test1.density </code></td>
<td>
<p>results for the density function test. A list with the 'computed' value 
using the density function and numerical integration, the 'expected' value (which is 1) and 
the result of the 'error.check' comparing both values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test2.quantile.cdf </code></td>
<td>
<p>results for the quantile function test. A list with the 'computed' value 
using the quantile function at chosen probabilites on [0,1], the 'expected' value (which is 1) and 
the result of the 'error.check' comparing both values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test3.mean.var </code></td>
<td>
<p>results for the random generation and the density function. 
A list with the 'computed' values using the random quantities (computes mean(X), variance(X) and E(log(abs(X))) where X follows
the distribution being tested. The 'expected' is a list containing the same quantities computed using numerical integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error.check </code></td>
<td>
<p>check if expected variance and computed variance are close enough.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition.is.var.finite </code></td>
<td>
<p>For some distributions there are known conditions for the variance to be finite. This quantity
is expected to be evaluated outside the DistCheck function and passed through the argument 'var.exists'.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]
</p>


<h3>References</h3>

<p>Otiniano, Cira EG, et al. (2023). A bimodal model for extremes data. Environmental and Ecological Statistics, 1-28. http://dx.doi.org/10.1007/s10651-023-00566-7
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate random values for the parameters and test the 
# bimodal gev distribution implementation
set.seed(1)
mu = runif(1,-2,2)
sigma = runif(1,0.1,2)
xi = runif(1,0.3,0.9) * sign(runif(1,-1,1))
delta = 1#runif(1,-0.6,2)
support = bgev.support(mu, sigma, xi, delta)
var.exists = ( xi != 0) &amp; (xi &lt; (delta + 1)/2)
ret = distCheck(fun="bgev", n = 2000, 
      support.lower = support[1], support.upper = support[2], 
      subdivisions = 5000, mu = mu, sigma = sigma, xi = xi, 
      delta = delta, var.exists = var.exists, print.result = TRUE)
</code></pre>


</div>