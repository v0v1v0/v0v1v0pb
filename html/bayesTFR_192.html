<div class="container">

<table style="width: 100%;"><tr>
<td>tfr.dl.coverage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness of Fit of the Double Logistic Function
</h2>

<h3>Description</h3>

<p>The function computes coverage, i.e. the ratio of observed data fitted within the given probability intervals of the predictive posterior distribution of the double logistic function, as well as the root mean square error and mean absolute error of the simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tfr.dl.coverage(sim.dir, pi = c(80, 90, 95), burnin = 2000, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim.dir</code></td>
<td>
<p>Directory with the MCMC simulation results. If a prediction and its corresponding thinned MCMCs are available in the simulation directory, those are taken for assessing the goodness of fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>Probability interval. It can be a single number or an array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Burnin. Only relevant if <code>sim.dir</code> does not contain thinned chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical switching log messages on and off.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>total.coverage</code></td>
<td>
<p>Vector of the coverage, one element per probability interval. For each <code>pi</code>, it is the ratio of the number of observed data points that fall within the probability interval of the posterior distribution over the total number of data points, i.e. TFR for all countries and historical time periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.coverage</code></td>
<td>
<p>Matrix corresponding to the coverage computed per time period. (Rows correspond to probability intervals, columns correspond to time.) It is derived like <code>total.coverage</code> except that both, the nominator and denominator, contain only data points belonging to the corresponding time period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country.coverage</code></td>
<td>
<p>Matrix corresponding to the coverage computed per country. (Rows correspond to probability intervals, columns correspond to countries.) It is derived like <code>total.coverage</code> except that both, the nominator and denominator, contain only data points belonging to the corresponding country.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.rmse</code></td>
<td>
<p>Root mean square error as <code class="reqn">\sqrt{(1/n\sum(x-m)^2)}</code> where <code class="reqn">x</code> are observed data points, <code class="reqn">m</code> is the mean of the posterior distribution and <code class="reqn">n</code> is the number of data points. Here the sum is taken over all countries and historical time periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.rmse</code></td>
<td>
<p>Like <code>total.rmse</code> except that each time period is considered separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country.rmse</code></td>
<td>
<p>Like <code>total.rmse</code> except that each country is considered separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.mae</code></td>
<td>
<p>Mean absolute error as <code class="reqn">1/n\sum|x-m|</code> where <code class="reqn">x</code> are observed data points, <code class="reqn">m</code> is the median of the posterior distribution and <code class="reqn">n</code> is the number of data points. Here the sum is taken over all countries and historical time periods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.mae</code></td>
<td>
<p>Like <code>total.mae</code> except that each time period is considered separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country.mae</code></td>
<td>
<p>Like <code>total.mae</code> except that each country is considered separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.cdf</code></td>
<td>
<p><code class="reqn">T \times C</code> matrix (with <code class="reqn">T</code> being the number of time periods and <code class="reqn">C</code> being the number of countries), containing the predictive CDF of the observation, i.e. the quantile of each data point within the predictive posterior distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>0-1 <code class="reqn">T \times C</code> matrix indicating if the corresponding data point was included in the goodness of fit computation. Zeros indicate missing historical values.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>To see the fit visually per country, use <code>DLcurve.plot(..., predictive.distr=TRUE,...)</code>.
</p>


<h3>Author(s)</h3>

<p>Hana Sevcikova
</p>


<h3>See Also</h3>

<p><code>DLcurve.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
sim.dir &lt;- file.path(find.package("bayesTFR"), "ex-data", "bayesTFR.output")
tfr &lt;- get.tfr.mcmc(sim.dir)
# Note that this simulation is a toy example and thus has not converged.
gof &lt;- tfr.dl.coverage(sim.dir)
gof$time.coverage
DLcurve.plot(tfr, country=608, predictive.distr=TRUE, pi=c(80, 90, 95))

## End(Not run)
</code></pre>


</div>