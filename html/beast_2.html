<div class="container">

<table style="width: 100%;"><tr>
<td>beast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Main function
</h2>

<h3>Description</h3>

<p>This is the main function of the package, implementing the MCMC sampler described in Papastamoulis et al (2017). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">beast(myDataList, burn, nIter, mhPropRange, mhSinglePropRange, startPoint,
    timeScale, savePlots, zeroNormalization, LRange, tau,
    gammaParameter, nu0, alpha0, beta0, subsetIndex, saveTheta, sameVariance,
    Prior
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>myDataList</code></td>
<td>

<p>Observed data in the form of a <code>list</code> with length <code class="reqn">R</code>, denoting the dimensionality of the multivariate time-series data. For each <code class="reqn">r = 1,\ldots,R</code>, <code>myDataList[[r]]</code> should correspond to <code class="reqn">T\times N</code> array, with <code>myDataList[[r]][t, n]</code> corresponding to the observed data for time-series <code class="reqn">n = 1,\ldots,N</code> and time-point <code class="reqn">t = 1,\ldots,T</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>Number of iterations that will be discarder as burn-in period. Default value: <code>burn = 20000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIter</code></td>
<td>

<p>Number of MCMC iterations. Default value: <code>nIter = 70000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mhPropRange</code></td>
<td>

<p>Positive integer corresponding to the parameter <code class="reqn">d_1</code> of MCMC Move 3.a of Papastamoulis et al (2017). Default value: <code>mhPropRange = 1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mhSinglePropRange</code></td>
<td>

<p>Positive integer denoting the parameter <code class="reqn">d_2</code> of Papastamoulis et al (2017). Default value: <code>mhPropRange = 40</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startPoint</code></td>
<td>

<p>An (optional) positive integer pointing at the minimum time-point where changes are allowed to occur. Default value: <code>startPoint = 2</code> (all possible values are taken into account).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeScale</code></td>
<td>

<p>Null.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savePlots</code></td>
<td>

<p>Character denoting the name of the folder where various plots will be saved to.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeroNormalization</code></td>
<td>

<p>Logical value denoting whether to normalize to zero all time time-series for <code class="reqn">t=1</code>. Default: <code>zeroNormalization = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRange</code></td>
<td>

<p>Range of possible values for the number of change-points. Default value: <code>LRange = 0:30</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>Positive real number corresponding to parameter <code class="reqn">c</code> in Move 2 of Papastamoulis et al (2017). Default value: <code>tau = 0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammaParameter</code></td>
<td>

<p>Positive real number corresponding to parameter <code class="reqn">\alpha</code> of the exponential prior distribution. Default value: <code>gammaParameter = 2</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0</code></td>
<td>

<p>Positive real number corresponding to prior parameter <code class="reqn">\nu_0</code> in Papastamoulis et al (2017). Default value: <code>nu0 = 0.1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>

<p>Positive real number corresponding to prior parameter <code class="reqn">\alpha_0</code> in Papastamoulis et al (2017). Default value: <code>alpha0 = 1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>

<p>Positive real number corresponding to prior parameter <code class="reqn">\beta_0</code> in Papastamoulis et al (2017). Default value: <code>beta0 = 1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsetIndex</code></td>
<td>

<p>Optional subset of integers corresponding to time-series indexes. If not null, the sampler will be applied only to the specified subset.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveTheta</code></td>
<td>

<p>Logical value indicating whether to save the generated values of the mean per time-point across the MCMC trace. Default: FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sameVariance</code></td>
<td>

<p>Logical value indicating whether to assume the same variance per time-point across time-series. Default value: <code>sameVariance = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Prior</code></td>
<td>

<p>Character string specifying the prior distribution of the number of change-points. Allowed values: <code>Prior = "complexity"</code> (default) or <code>Prior = "Poisson"</code> (not suggested). 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output of the sampler is returned as a list, with the following features:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Cutpoint_posterior_median</code></td>
<td>
<p>The estimated medians per change-point, conditionally on the most probable number of change-points per time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cutpoint_posterior_variance</code></td>
<td>
<p>The estimated variances per change-points, conditionally on the most probable number of change-points per time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumberOfCutPoints_posterior_distribution</code></td>
<td>
<p>Posterior distributions of number of change-points per time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumberOfCutPoints_MAP</code></td>
<td>
<p>The most probable number of change-points per time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Metropolis-Hastings_acceptance_rate</code></td>
<td>
<p>Acceptance of the MCMC move-types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject_ID</code></td>
<td>
<p>the identifier of individual time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cutpoint_mcmc_trace_map</code></td>
<td>
<p>The sampled values of each change-point per time series, conditionally on the MAP values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The sampled values of the means per time-series, conditionally on the MAP values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCutPointsTrace</code></td>
<td>
<p>The sampled values of the number of change-points, per time-series.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The complexity prior distribution with parameter <code>gammaParameter = 2</code> is the default prior assumption imposed on the number of change-points. Smaller (larger) values of <code>gammaParameter</code> will a-priori support larger (respectively: smaller) number of change-points. 
</p>
<p>For completeness purposes, the Poisson distribution is also allowed in the <code>Prior</code>. In this latter case, the <code>gammaParameter</code> denotes the rate parameter of the Poisson distribution. Note that in this case the interpretation of <code>gammaParameter</code> is reversed: Smaller (larger) values of <code>gammaParameter</code> will a-priori support smaller (respectively: larger) number of change-points.
</p>


<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>References</h3>

<p>Papastamoulis P., Furukawa T., van Rhijn N., Bromley M., Bignell E. and Rattray M. (2017). Bayesian detection of piecewise linear trends in replicated time-series with application to growth data modelling. arXiv:1709.06111 [stat.AP]
</p>


<h3>Examples</h3>

<pre><code class="language-R"># toy-example (MCMC iterations not enough)
library('beast')	# load package
data("FungalGrowthDataset")	# load dataset
myIndex &lt;- c(392, 62, 3, 117)	# run the sampler only for the 
#                                 specific subset of time-series
set.seed(1)	
# Run MCMC sampler with very small number of iterations (nIter):
run_mcmc &lt;- beast(myDataList = FungalGrowthDataset, subsetIndex = myIndex, 
			zeroNormalization = TRUE, nIter = 40, burn = 20) 
# Print output:
print(run_mcmc)
# Plot output to file: "beast_plot.pdf"
plot(run_mcmc, fileName = "beast_plot_toy.pdf", timeScale=1/6, xlab = "hours", ylab = "growth")
# Run the following commands to obtain convergence:

## Not run: 
# This example illustrates the package using a subset of four 
#      time-series of the fungal dataset. 
library('beast')	# load package
data("FungalGrowthDataset")	# load dataset
myIndex &lt;- c(392, 62, 3, 117)	# run the sampler only for the 
#                                 specific subset of time-series
set.seed(1)		# optional
# Run MCMC sampler with the default number of iterations (nIter =70000):
run_mcmc &lt;- beast(myDataList = FungalGrowthDataset, subsetIndex = myIndex, 
			zeroNormalization = TRUE) 
# Print output:
print(run_mcmc)
# Plot output to file: "beast_plot.pdf"
plot(run_mcmc, fileName = "beast_plot.pdf", timeScale=1/6, xlab = "hours", ylab = "growth")
# NOTE 1: for a complete analysis remove the `subsetIndex = myIndex` argument.
# NOTE 2: `zeroNormalization = TRUE` is an optional argument that forces all 
#	   time-series to start from zero. It is not supposed to be used 
#	   for other applications.

## End(Not run)
</code></pre>


</div>