<div class="container">

<table style="width: 100%;"><tr>
<td>choosePositions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute positions to date next which result in maximal decrease of chronological uncertainty</h2>

<h3>Description</h3>

<p>This function finds, for a given current chronology, created via
<code>Bchronology</code>, which positions (depths) to date next
If N = 1 it just finds the position with the biggest uncertainty
If N&gt;1 it puts a date at the N = 1 position and re-runs
<code>Bchronology</code> with the extra psuedo date. It uses the
<code>unCalibrate</code> function with the un-calibrated age estimated
at the median of the chronology and the sd as specified via the
<code>newSds</code> argument. Other arguments specify the new thicknesses,
calibration curves, and outlier probabilities for newly inserted psuedo-dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">choosePositions(
  bchrRun,
  N = 1,
  newSds = 30,
  newThicknesses = 0,
  positions = bchrRun$predictPositions,
  newCalCurve = "intcal20",
  newOutlierProb = 0.05,
  level = 0.5,
  plot = TRUE,
  count = 1,
  linesAt = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bchrRun</code></td>
<td>
<p>A run of the current chronology as output from <code>Bchronology</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of new positions required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newSds</code></td>
<td>
<p>The new standard deviations of the psuedo-added dates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newThicknesses</code></td>
<td>
<p>The new thicknesses of the psuedo-added dates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positions</code></td>
<td>
<p>The positions allowed to estimate the new positions to date. Defaults to the value of <code>predictPositions</code> from the
<code>Bchronology</code> run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newCalCurve</code></td>
<td>
<p>The new calibration curve of the psuedo-added dates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newOutlierProb</code></td>
<td>
<p>The new outlier probabilities of the psuedo-added dates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The confidence level required for minimising the uncertainty. Defaults to 50%. (Note: this will be estimated more robustly than the 95% level)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Whether to plot the chronologies as they are produced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>Counter function (not for use other than by the function itself)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linesAt</code></td>
<td>
<p>Horizontal line positions (not for use other than by the function itself)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Some plots and the positions to date next
</p>


<h3>See Also</h3>

<p><code>Bchronology</code> for the main function to create chronologies, <code>unCalibrate</code> for the ability to invert calendar dates for a given calibration curve.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Glendalough)
GlenOut &lt;- Bchronology(
  ages = Glendalough$ages,
  ageSds = Glendalough$ageSds,
  calCurves = Glendalough$calCurves,
  positions = Glendalough$position,
  positionThicknesses = Glendalough$thickness,
  ids = Glendalough$id,
  predictPositions = seq(0, 1500, by = 10)
)

# Find out which two positions (depths) to date if we have room for two more dates
# Here going to choose 3 new positions to date
newPositions &lt;- choosePositions(GlenOut, N = 3)
print(newPositions)

# Suppose you are only interested in dating the new depths at 500, 600, or 700 cm
newPositions2 &lt;- choosePositions(GlenOut,
  N = 2,
  positions = seq(500, 700, by = 10)
)
print(newPositions2)

</code></pre>


</div>