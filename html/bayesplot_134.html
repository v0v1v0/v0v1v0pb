<div class="container">

<table style="width: 100%;"><tr>
<td>PPC-errors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PPC errors</h2>

<h3>Description</h3>

<p>Various plots of predictive errors <code>y - yrep</code>. See the
<strong>Details</strong> and <strong>Plot Descriptions</strong> sections, below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppc_error_hist(
  y,
  yrep,
  ...,
  facet_args = list(),
  binwidth = NULL,
  bins = NULL,
  breaks = NULL,
  freq = TRUE
)

ppc_error_hist_grouped(
  y,
  yrep,
  group,
  ...,
  facet_args = list(),
  binwidth = NULL,
  bins = NULL,
  breaks = NULL,
  freq = TRUE
)

ppc_error_scatter(y, yrep, ..., facet_args = list(), size = 2.5, alpha = 0.8)

ppc_error_scatter_avg(y, yrep, ..., size = 2.5, alpha = 0.8)

ppc_error_scatter_avg_grouped(
  y,
  yrep,
  group,
  ...,
  facet_args = list(),
  size = 2.5,
  alpha = 0.8
)

ppc_error_scatter_avg_vs_x(y, yrep, x, ..., size = 2.5, alpha = 0.8)

ppc_error_binned(
  y,
  yrep,
  ...,
  facet_args = list(),
  bins = NULL,
  size = 1,
  alpha = 0.25
)

ppc_error_data(y, yrep, group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of observations. See <strong>Details</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yrep</code></td>
<td>
<p>An <code>S</code> by <code>N</code> matrix of draws from the posterior (or prior)
predictive distribution. The number of rows, <code>S</code>, is the size of the
posterior (or prior) sample used to generate <code>yrep</code>. The number of columns,
<code>N</code> is the number of predicted observations (<code>length(y)</code>). The columns of
<code>yrep</code> should be in the same order as the data points in <code>y</code> for the plots
to make sense. See the <strong>Details</strong> and <strong>Plot Descriptions</strong> sections for
additional advice specific to particular plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently unused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_args</code></td>
<td>
<p>A named list of arguments (other than <code>facets</code>) passed
to <code>ggplot2::facet_wrap()</code> or <code>ggplot2::facet_grid()</code>
to control faceting. Note: if <code>scales</code> is not included in <code>facet_args</code>
then <strong>bayesplot</strong> may use <code>scales="free"</code> as the default (depending
on the plot) instead of the <strong>ggplot2</strong> default of <code>scales="fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>Passed to <code>ggplot2::geom_histogram()</code> to override
the default binwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>For <code>ppc_error_binned()</code>, the number of bins to use (approximately).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Passed to <code>ggplot2::geom_histogram()</code> as an
alternative to <code>binwidth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>For histograms, <code>freq=TRUE</code> (the default) puts count on the
y-axis. Setting <code>freq=FALSE</code> puts density on the y-axis. (For many
plots the y-axis text is off by default. To view the count or density
labels on the y-axis see the <code>yaxis_text()</code> convenience
function.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A grouping variable of the same length as <code>y</code>.
Will be coerced to factor if not already a factor.
Each value in <code>group</code> is interpreted as the group level pertaining
to the corresponding observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size, alpha</code></td>
<td>
<p>For scatterplots, arguments passed to
<code>ggplot2::geom_point()</code> to control the appearance of the points. For the
binned error plot, arguments controlling the size of the outline and
opacity of the shaded region indicating the 2-SE bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector the same length as <code>y</code> to use as the x-axis
variable.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All of these functions (aside from the <code style="white-space: pre;">⁠*_scatter_avg⁠</code> functions)
compute and plot predictive errors for each row of the matrix <code>yrep</code>, so
it is usually a good idea for <code>yrep</code> to contain only a small number of
draws (rows). See <strong>Examples</strong>, below.
</p>
<p>For binomial and Bernoulli data the <code>ppc_error_binned()</code> function can be used
to generate binned error plots. Bernoulli data can be input as a vector of 0s
and 1s, whereas for binomial data <code>y</code> and <code>yrep</code> should contain "success"
proportions (not counts). See the <strong>Examples</strong> section, below.
</p>


<h3>Value</h3>

<p>A ggplot object that can be further customized using the <strong>ggplot2</strong> package.
</p>


<h3>Plot descriptions</h3>


<dl>
<dt><code>ppc_error_hist()</code></dt>
<dd>
<p>A separate histogram is plotted for the predictive errors computed from
<code>y</code> and each dataset (row) in <code>yrep</code>. For this plot <code>yrep</code> should have
only a small number of rows.
</p>
</dd>
<dt><code>ppc_error_hist_grouped()</code></dt>
<dd>
<p>Like <code>ppc_error_hist()</code>, except errors are computed within levels of a
grouping variable. The number of histograms is therefore equal to the
product of the number of rows in <code>yrep</code> and the number of groups
(unique values of <code>group</code>).
</p>
</dd>
<dt><code>ppc_error_scatter()</code></dt>
<dd>
<p>A separate scatterplot is displayed for <code>y</code> vs. the predictive errors
computed from <code>y</code> and each dataset (row) in <code>yrep</code>. For this plot <code>yrep</code>
should have only a small number of rows.
</p>
</dd>
<dt><code>ppc_error_scatter_avg()</code></dt>
<dd>
<p>A single scatterplot of <code>y</code> vs. the average of the errors computed from
<code>y</code> and each dataset (row) in <code>yrep</code>. For each individual data point
<code>y[n]</code> the average error is the average of the errors for <code>y[n]</code> computed
over the the draws from the posterior predictive distribution.
</p>
</dd>
<dt><code>ppc_error_scatter_avg_vs_x()</code></dt>
<dd>
<p>Same as <code>ppc_error_scatter_avg()</code>, except the average is plotted on the
y-axis and a predictor variable <code>x</code> is plotted on the x-axis.
</p>
</dd>
<dt><code>ppc_error_binned()</code></dt>
<dd>
<p>Intended for use with binomial data. A separate binned error plot (similar
to <code>arm::binnedplot()</code>) is generated for each dataset (row) in <code>yrep</code>. For
this plot <code>y</code> and <code>yrep</code> should contain proportions rather than counts,
and <code>yrep</code> should have only a small number of rows.
</p>
</dd>
</dl>
<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari,
A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis.</em> Chapman &amp; Hall/CRC
Press, London, third edition. (Ch. 6)
</p>


<h3>See Also</h3>

<p>Other PPCs: 
<code>PPC-censoring</code>,
<code>PPC-discrete</code>,
<code>PPC-distributions</code>,
<code>PPC-intervals</code>,
<code>PPC-loo</code>,
<code>PPC-overview</code>,
<code>PPC-scatterplots</code>,
<code>PPC-test-statistics</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- example_y_data()
yrep &lt;- example_yrep_draws()
ppc_error_hist(y, yrep[1:3, ])

# errors within groups
group &lt;- example_group_data()
(p1 &lt;- ppc_error_hist_grouped(y, yrep[1:3, ], group))
p1 + yaxis_text() # defaults to showing counts on y-axis

table(group) # more obs in GroupB, can set freq=FALSE to show density on y-axis
(p2 &lt;- ppc_error_hist_grouped(y, yrep[1:3, ], group, freq = FALSE))
p2 + yaxis_text()


# scatterplots
ppc_error_scatter(y, yrep[10:14, ])
ppc_error_scatter_avg(y, yrep)

x &lt;- example_x_data()
ppc_error_scatter_avg_vs_x(y, yrep, x)

## Not run: 
# binned error plot with binomial model from rstanarm
library(rstanarm)
example("example_model", package = "rstanarm")
formula(example_model)

# get observed proportion of "successes"
y &lt;- example_model$y  # matrix of "success" and "failure" counts
trials &lt;- rowSums(y)
y_prop &lt;- y[, 1] / trials  # proportions

# get predicted success proportions
yrep &lt;- posterior_predict(example_model)
yrep_prop &lt;- sweep(yrep, 2, trials, "/")

ppc_error_binned(y_prop, yrep_prop[1:6, ])

## End(Not run)

</code></pre>


</div>