<div class="container">

<table style="width: 100%;"><tr>
<td>posteriorWeights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior model weights</h2>

<h3>Description</h3>

<p>Approximates the models' posterior weights  by simple Monte Carlo integration
</p>


<h3>Usage</h3>

<pre><code class="language-R">posteriorWeights(
  dat,
  HparList = list(get("pb.Hpar"), get("nl.Hpar")),
  lklList = list(get("dpairbeta"), get("dnestlog")),
  priorList = list(get("prior.pb"), get("prior.nl")),
  priorweights = c(0.5, 0.5),
  Nsim = 20000,
  Nsim.min = 10000,
  precision = 0.05,
  seed = 1,
  kind = "Mersenne-Twister",
  show.progress = floor(seq(1, Nsim, length.out = 10)),
  displ = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>The angular data set relative to which the marginal model likelihood is to be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HparList</code></td>
<td>
<p>A list containing the hyper Parameter for the priors in each model. (list of lists).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lklList</code></td>
<td>
<p>A list containing the likelihood functions of each model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorList</code></td>
<td>
<p>A list containing the prior definitions of each model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorweights</code></td>
<td>
<p>A vector of positive weights, summing to one: the prior marginal weights of each model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsim</code></td>
<td>
<p>The maximum number of iterations to be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsim.min</code></td>
<td>
<p>The minimum number of iterations to be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>the desired relative precision. See
<code>MCpriorIntFun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed to be set <em>via</em>
<code>set.seed</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kind</code></td>
<td>
<p>The kind of random numbers generator. Default to
"Mersenne-Twister". See <code>set.seed</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.progress</code></td>
<td>
<p>An vector of integers containing the times
(iteration numbers) at  which a message showing progression
will be printed on the standard output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displ</code></td>
<td>
<p>Logical. Should convergence monitoring plots be issued ?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>if <code class="reqn">J</code> is the number of models, the posterior weights are given by
</p>
<p style="text-align: center;"><code class="reqn">postW(i) = priorW(i)*lkl(i)/
(\sum_{j=1,\dots,J} priorW(j)*lkl(j)),</code>
</p>

<p>where <code class="reqn">lkl(i)</code> stands for the Monte-Carlo estimate of the
marginal likelihood of model <code class="reqn">i</code> and <code class="reqn">priorW(i)</code> is
the prior weight
defined in <code>priorweights[i]</code>. For more explanations, see the reference below 
The confidence intervals are obtained by adding/subtracting two times the estimated standard errors of the marginal likelihood estimates.
The latter are only estimates, which interpretation may be misleading:
See the note in section <code>marginal.lkl</code>
</p>


<h3>Value</h3>

<p>A matrix of <code class="reqn">6</code> columns and <code>length(priorweights)</code> rows. The columns contain respectively the posterior model weights (in the same order as in <code>priorweights</code>), the lower and the upper bound of the confidence interval (see <b>Details</b>), the marginal model weights, the estimated standard error of the marginal likelihood estimators, and the number of simulations performed.
</p>


<h3>References</h3>

<p>HOETING, J., MADIGAN, D., RAFTERY, A. and VOLINSKY, C. (1999). Bayesian model averaging: A tutorial. <em>Statistical science 14, 382-401</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(pb.Hpar)
data(nl.Hpar)
set.seed(5)
mixDat=rbind(rpairbeta(n=10,dimData=3, par=c(0.68,3.1,0.5,0.5)),
  rnestlog(n=10,par=c(0.68,0.78, 0.3,0.5)))
posteriorWeights (dat=mixDat,
                  HparList=list(get("pb.Hpar"),get("nl.Hpar")),
                  lklList=list(get("dpairbeta"), get("dnestlog")),
                  priorList=list(get("prior.pb"), get("prior.nl")),
                  priorweights=c(0.5,0.5),
                  Nsim=1e+3,
                  Nsim.min=5e+2, precision=0.1,
                  displ=FALSE)
## Not run: posteriorWeights (dat=mixDat,
                  HparList=list(get("pb.Hpar"),get("nl.Hpar")),
                  lklList=list(get("dpairbeta"), get("dnestlog")),
                  priorList=list(get("prior.pb"), get("prior.nl")),
                  priorweights=c(0.5,0.5),
                  Nsim=20e+3,
                  Nsim.min=10e+3, precision=0.05,
                  displ=TRUE)
## End(Not run)
</code></pre>


</div>