<div class="container">

<table style="width: 100%;"><tr>
<td>CBLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Correlated Bivariate Least Square regression (CBLS)</h2>

<h3>Description</h3>

<p>Estimate the Correlated Bivariate Least Square regression with replicated data (in a (M,D) plot) where M=(X+Y)/2 and D=Y-X.</p>


<h3>Usage</h3>

<pre><code class="language-R">CBLS(data = NULL, xcol = 1, ycol = 2, var.x = NULL, var.y = NULL,
     df.var.x = Inf, df.var.y = Inf, ratio.var = NULL, conf.level = 0.95,
     pred.level = 0.95, npoints = 1000, qx = 1, qy = 1, xpred = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.x</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device X if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.y</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device Y if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.var.x</code></td>
<td>
<p> a numeric variable for the degrees of freedom of the variance of the measurement error of device X if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.var.y</code></td>
<td>
<p> a numeric variable for the degrees of freedom of the variance of the measurement error of device Y if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.var</code></td>
<td>
<p> a numeric value for λ, the ratio of the measurement error variances (Y over X) if known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qx</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qy</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpred</code></td>
<td>
<p> a numeric vector for customized predictions at given M values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data argument is mandatory. If the data are unreplicated, then the measurement error variances must be given or their ratio (λ) in order to calculate the correlation, ρ_{MD}, between the measurement errors of the differences (on the Y-axis) and the measurement errors of the means (on the X-axis). The confidence level is used for the confidence intervals of the parameters (ρ_{MD}, β (slope), α (intercept)), the hyperbolic confidence intervals  (the prediction of the expectation of Y for a given X) and the hyperbolic confidence bands. The predictive level is used for the hyperbolic predictive intervals (the prediction of a future Y for a given X) and the hyperbolic generalized intervals (the prediction of the mean of q future Y values for a given X).
</p>


<h3>Value</h3>

<p>A CBLS class object, a list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Xij</code></td>
<td>
<p> a table with the (replicated) X measurements (replicates are in columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yik</code></td>
<td>
<p> a table with the (replicated) Y measurements (replicates are in columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xi</code></td>
<td>
<p> a vector with the means of the X measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yi</code></td>
<td>
<p> a vector with the means of the Y measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mi</code></td>
<td>
<p> a vector with the means ((X+Y)/2) measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Di</code></td>
<td>
<p> a vector with the differences (Y-X) measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nxi</code></td>
<td>
<p> a vector with the number of X replicates per sample (patient).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyi</code></td>
<td>
<p> a vector with the number of Y replicates per sample (patient).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variances_x</code></td>
<td>
<p> a vector with the variances calculated on the X replicates per sample (patient).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variances_y</code></td>
<td>
<p> a vector with the variances calculated on the Y replicates per sample (patient).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rho.MD</code></td>
<td>
<p> a table with the value of ρMD (the correlation between the measurement errors of the means and the differences) and its confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ellipse.CBLS</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval (confidence region, ellipse) for the parameters (β, α).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimate.CBLS</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 0, intercept = 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pred.CBLS</code></td>
<td>
<p> a data frame with npoints rows (from the minimum to the maximum of the observed X values) and the following columns: the X values where the predictions are calculated (X0), the Y predicted values (Ypred), the lower and upper bounds of the confidence interval, predictive interval, generalized interval and confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpred.CBLS</code></td>
<td>
<p> a data frame with the customized predictions and the same columns than <code>Pred.CBLS</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.</p>


<h3>See Also</h3>

<p><code>BLS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(BivRegBLS)
data(SBP)
# CBLS regression on replicated data
res.CBLS1=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,qx=3,qy=3,xpred=c(100,120,140,160))
# CBLS regression on unreplicated data with measurement error variances previously estimated
res.CBLS2=CBLS(data=SBP,xcol=c("J1"),ycol="S1",var.x=80,var.y=50,df.var.x=100,df.var.y=100)
</code></pre>


</div>