<div class="container">

<table style="width: 100%;"><tr>
<td>GroupMembershipMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct a group membership matrix for hierarchical algorithms</h2>

<h3>Description</h3>

<p>Construct a group membership matrix for two-, three-, or
four-stage hierarchical algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GroupMembershipMatrix(stage1, stage2 = NULL, stage3 = NULL, stage4 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stage1</code></td>
<td>
<p>the group size in stage one of testing. This also corresponds
to the number of individuals to be tested and will specify the number of
columns in the resulting group membership matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage2</code></td>
<td>
<p>a vector of group sizes in stage two of testing. The group sizes
specified here should sum to the number of individuals/group size specified
in <kbd>stage1</kbd>. If <kbd>NULL</kbd>, a group membership matrix will be constructed
for a two-stage hierarchical algorithm.
Further details are given under 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage3</code></td>
<td>
<p>a vector of group sizes in stage three of testing. The group sizes
specified here should sum to the number of individuals/group size specified
in <kbd>stage1</kbd>. If group sizes are provided in <kbd>stage2</kbd> and <kbd>stage3</kbd>
is <kbd>NULL</kbd>, a group membership matrix will be constructed for a
three-stage hierarchical algorithm. Further details are given under 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage4</code></td>
<td>
<p>a vector of group sizes in stage four of testing. The group sizes
specified here should sum to the number of individuals/group size specified
in <kbd>stage1</kbd>. If group sizes are provided in <kbd>stage3</kbd> and <kbd>stage4</kbd>
is <kbd>NULL</kbd>, a group membership matrix will be constructed for a four-stage
hierarchical algorithm. Further details are given under 'Details'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function constructs a group membership matrix for two-, three-,
four-, or five-stage hierarchical algorithms. The resulting group membership
matrix has rows corresponding to the number of stages of testing and columns
corresponding to each individual to be tested. The value specified in
<kbd>stage1</kbd> corresponds to the number of individuals to be tested.
</p>
<p>For group membership matrices when only <kbd>stage1</kbd> is specified, a two-stage
hierarchical algorithm is used and the second stage will consist of individual
testing. For group membership matrices when <kbd>stage1</kbd> and <kbd>stage2</kbd> are
specified, a three-stage hierarchical algorithm is used and the third stage
will consist of individual testing. Group membership matrices for four- and
five-stage hierarchical algorithms follow a similar structure.
There should never be group sizes specified for later
stages of testing without also providing group sizes for all earlier stages
of testing (i.e., to provide group sizes for <kbd>stage3</kbd>, group sizes must
also be provided for <kbd>stage1</kbd> and <kbd>stage2</kbd>).
</p>


<h3>Value</h3>

<p>A matrix specifying the group membership for each individual. The
rows of the matrix correspond to the stages of testing and the columns of
the matrix correspond to the individuals to be tested.
</p>


<h3>Author(s)</h3>

<p>Minh Nguyen and Christopher Bilder
</p>


<h3>See Also</h3>

<p>Other operating characteristic functions: 
<code>Sterrett()</code>,
<code>TOD()</code>,
<code>halving()</code>,
<code>operatingCharacteristics1()</code>,
<code>operatingCharacteristics2()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a group membership matrix for a two-stage
#   hierarchical algorithm, within the opChar1() function
#   and calculate operating characteristics
opChar1(algorithm = "D2", p = 0.0193, Se = 0.99, Sp = 0.99,
        hier.config = GroupMembershipMatrix(stage1 = 16),
        print.time = FALSE)

# Generate a group membership matrix for a five-stage
#   hierarchical algorithm and calculate the
#   operating characteristics for a two-disease assay
config.mat &lt;- GroupMembershipMatrix(stage1 = 16,
                                    stage2 = c(8,8),
                                    stage3 = c(4,4,4,4),
                                    stage4 = rep(2, times = 8))
Se &lt;- matrix(data = rep(0.95, 10), nrow = 2, ncol = 5,
             dimnames = list(Infection = 1:2, Stage = 1:5))
Sp &lt;- matrix(data = rep(0.99, 10), nrow = 2, ncol = 5,
             dimnames = list(Infection = 1:2, Stage = 1:5))
opChar2(algorithm = "D5", p.vec = c(0.92, 0.05, 0.02, 0.01),
        Se = Se, Sp = Sp, hier.config = config.mat)
</code></pre>


</div>