<div class="container">

<table style="width: 100%;"><tr>
<td>plot.matrix.loadings</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Residue-Residue Matrix Loadings</h2>

<h3>Description</h3>

<p>Plot residue-residue matrix loadings of a particular PC that is obtained from a 
principal component analysis (PCA) of cross-correlation or distance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'matrix.loadings'
plot(x, pc = 1, resno = NULL, sse = NULL,
  mask.n = 0, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the results of PCA as obtained from <code>pca.array</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>the principal component along which the loadings will be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resno</code></td>
<td>
<p>numerical vector or ‘pdb’ object as obtained from <code>read.pdb</code>
to show residue number on the x- and y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sse</code></td>
<td>
<p>a ‘sse’ object as obtained from <code>dssp</code> or <code>stride</code>, 
or a ‘pdb’ object as obtained from <code>read.pdb</code> to show secondary
structural elements along x- and y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask.n</code></td>
<td>
<p>the number of elements from the diagonal to be masked from output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if FALSE no plot will be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>plot.dccm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function plots loadings (the eigenvectors) of PCA performed on a set of matrices 
such as distance matrices from an ensemble of crystallographic structures 
and residue-residue cross-correlations or covariance matrices derived from 
ensemble NMA or MD simulation replicates (See <code>pca.array</code> for detail). 
Loadings are displayed as a matrix with dimension the same as the input matrices 
of the PCA. Each element of loadings represents the proportion that the corresponding 
residue pair contributes to the variance in a particular PC. The plot can be used 
to identify key regions that best explain the variance of underlying matrices.
</p>


<h3>Value</h3>

<p>Plot and also returns a numeric matrix containing the loadings.
</p>


<h3>Author(s)</h3>

<p>Xin-Qiu Yao
</p>


<h3>References</h3>

<p>Skjaerven, L. et al. (2014) <em>BMC Bioinformatics</em> <b>15</b>, 399.
Grant, B.J. et al. (2006) <em>Bioinformatics</em> <b>22</b>, 2695–2696.
</p>


<h3>See Also</h3>

<p><code>plot.dccm</code>, <code>pca.array</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
   attach(transducin)
   gaps.res &lt;- gap.inspect(pdbs$ali)
   sse &lt;- pdbs$sse[1, gaps.res$f.inds]

   # calculate modes
   modes &lt;- nma(pdbs, ncore=NULL)

   # calculate cross-correlation matrices from the modes
   cijs &lt;- dccm(modes, ncore=NULL)$all.dccm

   # do PCA on cross-correlation matrices
   pc &lt;- pca.array(cijs)

   # plot loadings
   l &lt;- plot.matrix.loadings(pc, sse=sse)
   l[1:10, 1:10]

   # plot loadings with elements 10-residue separated from diagonal masked
   plot.matrix.loadings(pc, sse=sse, mask.n=10)


## End(Not run)
</code></pre>


</div>