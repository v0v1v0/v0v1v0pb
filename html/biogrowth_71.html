<div class="container">

<table style="width: 100%;"><tr>
<td>fit_multiple_growth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting growth models to multiple dynamic experiments</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt="[Superseded]"></a>
</p>
<p>The function <code>fit_multiple_growth()</code> has been superseded by the top-level
function <code>fit_growth()</code>, which provides a unified approach for growth modelling.
</p>
<p>But, if you so wish, this function still enables fitting a growth model using a dataset comprised of
several experiments with potentially different dynamic experimental conditions.
Note that the definition of secondary models must comply with the
<code>secondary_model_data</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_multiple_growth(
  starting_point,
  experiment_data,
  known_pars,
  sec_model_names,
  ...,
  check = TRUE,
  formula = logN ~ time,
  logbase_mu = logbase_logN,
  logbase_logN = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>starting_point</code></td>
<td>
<p>a named vector of starting values for the model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>experiment_data</code></td>
<td>
<p>a nested list with the experimental data. Each entry describes
one experiment as a list with two elements: data and conditions. <code>data</code> is a tibble
with a column giving the elapsed time (named "time" by default) and another one
with the decimal logarithm of the population size (named "logN" by default).
<code>conditions</code> is a tibble with one column giving the elapsed time (using the
same name as <code>data</code>) and as many additional columns as environmental factors.
The default column names can be changed with the formula argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known_pars</code></td>
<td>
<p>named vector of known model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sec_model_names</code></td>
<td>
<p>named character vector with names of the
environmental conditions and values of the secondary model (see secondary_model_data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for <code>modFit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Whether to check the validity of the models. <code>TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula" describing the x and y variables.
<code>logN ~ time</code> as a default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbase_mu</code></td>
<td>
<p>Base of the logarithm the growth rate is referred to.
By default, the same as logbase_logN. See vignette about units for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbase_logN</code></td>
<td>
<p>Base of the logarithm for the population size. By default,
10 (i.e. log10). See vignette about units for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An instance of <code>FitMultipleDynamicGrowth()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## We will use the multiple_experiments data set

data("multiple_experiments")

## For each environmental factor, we need to defined a model

sec_names &lt;- c(temperature = "CPM", pH = "CPM")

## Any model parameter can be fixed

known &lt;- list(Nmax = 1e8, N0 = 1e0, Q0 = 1e-3,
    temperature_n = 2, temperature_xmin = 20, temperature_xmax = 35,
    pH_n = 2, pH_xmin = 5.5, pH_xmax = 7.5, pH_xopt = 6.5)

## The rest require starting values for model fitting

start &lt;- list(mu_opt = .8, temperature_xopt = 30)

## We can now call the fitting function

global_fit &lt;- fit_multiple_growth(start, multiple_experiments, known, sec_names)

## Parameter estimates can be retrieved with summary

summary(global_fit)

## We can compare fitted model against observations

plot(global_fit)

## Any single environmental factor can be added to the plot using add_factor

plot(global_fit, add_factor = "temperature")


</code></pre>


</div>