<div class="container">

<table style="width: 100%;"><tr>
<td>MarkerBasedDecomposition</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs marker-based decomposition of bulk expression using marker genes</h2>

<h3>Description</h3>

<p>Estimates relative abundances of cell types from PCA-based decomposition.
Uses a list of marker genes to subset the expression data, and returns the 
first PC of each sub-matrix as the cell type fraction estimates.
Optionally, weights for each marker gene can be used to prioritize genes
that are highly expressed in the given cell type.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MarkerBasedDecomposition(
  bulk.eset,
  markers,
  ct_col = "cluster",
  gene_col = "gene",
  min_gene = 5,
  max_gene = 200,
  weighted = FALSE,
  w_col = "avg_logFC",
  unique_markers = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bulk.eset</code></td>
<td>
<p>Expression Set. Normalized bulk expression data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>Data frame with columns specifying cluster and gene,
and optionally a column for weights, typically the fold-change of the gene.
Important that the genes for each cell type are row-sorted by signficance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ct_col</code></td>
<td>
<p>Character string. Column name specifying cluster/cell type
corresponding to each marker gene in <strong>markers</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_col</code></td>
<td>
<p>Character string. Column name specifying gene names in
<strong>markers</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_gene</code></td>
<td>
<p>Numeric. Min number of genes to use for each cell type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_gene</code></td>
<td>
<p>Numeric. Max number of genes to use for each cell type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Boolean. Whether to use weights for gene prioritization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_col</code></td>
<td>
<p>Character string. Column name for weights, such as "avg_logFC",
in <strong>markers</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique_markers</code></td>
<td>
<p>Boolean. If TRUE, subset markers to include only genes 
that are markers for only one cell type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean. Whether to print log info during decomposition.
Errors will be printed regardless.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that this method expects the input bulk data to be normalized, unlike
the reference-based method.
</p>


<h3>Value</h3>

<p>A List. Slot <strong>bulk.props</strong> contains estimated relative cell
type abundances. Slot <strong>var.explained</strong> contains variance explained by
first 20 PCs for cell type marker genes. Slot <strong>genes.used</strong> contains
vector of genes used for decomposition.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(Biobase)
sim.data &lt;- SimulateData(n.ind=10, n.genes=100, n.cells=100,
                         cell.types=c("Neurons", "Astrocytes", "Microglia"),
                         avg.props=c(.5, .3, .2))
res &lt;- MarkerBasedDecomposition(sim.data$bulk.eset, sim.data$markers, weighted=FALSE)
estimated.cell.proportions &lt;- res$bulk.props

</code></pre>


</div>