<div class="container">

<table style="width: 100%;"><tr>
<td>glmmPQL.control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Control Aspects of the glmmPQL Algorithm</h2>

<h3>Description</h3>

<p>Set control variables for the glmmPQL algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmmPQL.control(maxiter = 50, IWLSiter = 10, tol = 1e-06, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of outer iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IWLSiter</code></td>
<td>
<p>the maximum number of iterated weighted least squares
iterations used to estimate the fixed effects, given the standard deviation
of the random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance used to determine convergence in the IWLS
iterations and over all (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical: whether or not to print the score for the random
effects variance at the end of each iteration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides an interface to control the PQL algorithm used by
<code>BTm()</code> for fitting Bradley Terry models with random effects.
</p>
<p>The algorithm iterates between a series of iterated weighted least squares
iterations to update the fixed effects and a single Fisher scoring iteration
to update the standard deviation of the random effects.
</p>
<p>Convergence of both the inner and outer iterations are judged by comparing
the squared components of the relevant score vector with corresponding
elements of the diagonal of the Fisher information matrix. If, for all
components of the relevant score vector, the ratio is less than
<code>tolerance^2</code>, or the corresponding diagonal element of the Fisher
information matrix is less than 1e-20, iterations cease.
</p>


<h3>Value</h3>

<p>A list with the arguments as components.
</p>


<h3>Author(s)</h3>

<p>Heather Turner
</p>


<h3>References</h3>

<p>Breslow, N. E. and Clayton, D. G. (1993), Approximate inference
in Generalized Linear Mixed Models. <em>Journal of the American
Statistical Association</em> <strong>88</strong>(421), 9â€“25.
</p>


<h3>See Also</h3>

<p><code>glmmPQL()</code>, <code>BTm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Variation on example(flatlizards)
result &lt;- rep(1, nrow(flatlizards$contests))

## BTm passes arguments on to glmmPQL.control()
args(BTm)
BTmodel &lt;- BTm(result, winner, loser, ~ throat.PC1[..] + throat.PC3[..] +
               head.length[..] + SVL[..] + (1|..),
               data = flatlizards, tol = 1e-3, trace = TRUE)
summary(BTmodel)

</code></pre>


</div>