<div class="container">

<table style="width: 100%;"><tr>
<td>fst_admix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate FST for the admixed individuals</h2>

<h3>Description</h3>

<p>This function returns the generalized FST of the admixed individuals given their admixture proportion matrix, the coancestry matrix of intermediate subpopulations (or its special cases, see <code>coanc_subpops</code> parameter below), and optional weights for individuals.
This FST equals the weighted mean of the diagonal of the coancestry matrix (see <code>coanc_admix()</code>).
Below there are <code>n</code> individuals and <code>k</code> intermediate subpopulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fst_admix(admix_proportions, coanc_subpops, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>admix_proportions</code></td>
<td>
<p>The <code>n</code>-by-<code>k</code> admixture proportion matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coanc_subpops</code></td>
<td>
<p>Either the <code>k</code>-by-<code>k</code> intermediate subpopulation coancestry matrix (for the complete admixture model), or the length-<code>k</code> vector of intermediate subpopulation FST values (for the BN-PSD model; assumes zero coancestries between subpopulations), or a scalar FST value shared by all intermediate subpopulations (also assumes zero coancestry between subpopulations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional length-<code>n</code> vector of weights for individuals that define their generalized FST (default uniform weights)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As a precaution, function stops if both inputs have names and the column names of <code>admix_proportions</code> and the names in <code>coanc_subpops</code> disagree, which might be because these two matrices are not aligned or there is some other inconsistency.
</p>


<h3>Value</h3>

<p>The generalized FST of the admixed individuals
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set desired parameters
# number of individuals
n_ind &lt;- 1000
# number of intermediate subpopulations
k_subpops &lt;- 10

# differentiation of intermediate subpopulations
coanc_subpops &lt;- ( 1 : k_subpops ) / k_subpops

# construct admixture proportions
admix_proportions &lt;- admix_prop_1d_linear(n_ind, k_subpops, sigma = 1)

# lastly, calculate Fst!!! (uniform weights in this case)
fst_admix(admix_proportions, coanc_subpops)

</code></pre>


</div>