<div class="container">

<table style="width: 100%;"><tr>
<td>traceplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Illustrate conditional means of study-specific estimates as well as
overall mean (or other linear combinations) as a function of
heterogeneity.
</h2>

<h3>Description</h3>

<p>Generates a trace plot of study-specific (shrinkage) estimates as a
function of the heterogeneity (<code class="reqn">\tau</code>), along with conditional
estimates of the overall mean or other linear combinations of
regression parameters.
The heterogeneity's posterior distribution is also shown at the bottom.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  traceplot(x, ...)
  ## S3 method for class 'bayesmeta'
traceplot(x, mulim, taulim, ci=FALSE,
          ylab="effect", prior=FALSE, infinity=FALSE,
          rightmargin=8, col=rainbow(x$k), labcol=col,
          meanlabel="overall mean", meancol="black",
          meanlabcol=meancol, ...)
  ## S3 method for class 'bmr'
traceplot(x, mulim, taulim, ci=FALSE,
          ylab="effect", prior=FALSE, infinity=FALSE,
          rightmargin=8, col=rainbow(x$k), labcol=col,
          X, Xlabels, Xcols="black", Xlabcols=Xcols, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a <code>bayesmeta</code> or <code>bmr</code>object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mulim, taulim</code></td>
<td>
<p>(optional) ranges for the effect (mu) and
heterogeneity (tau) axes. If only one value is given for
<code>taulim</code>, then this is taken as the upper limit, and the lower
limit is zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>a logical flag indicating whether to also show (conditional)
confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>a label for the effect (mu) axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>a logical flag indicating whether to show the (heterogeneity) prior
density along with its posterior.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infinity</code></td>
<td>

<p>a logical flag indicating whether add an “infinity” tickmark
to the heterogeneity (tau) axis and show the corresponding limiting
values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightmargin</code></td>
<td>

<p>an additional margin to be added to the right side of the plot, in
order to accomodate the estimates' labels. In case study labels
still extend beyond the figure margin, try increasing this number.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>colors to be used for plotting the (<code class="reqn">k</code>) estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labcol</code></td>
<td>

<p>colors to be used for labelling the (<code class="reqn">k</code>) estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanlabel</code></td>
<td>

<p>a label for the overall mean estimate
(<code>traceplot.bayesmeta()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meancol</code></td>
<td>

<p>colour specification for the overall mean estimate
(<code>traceplot.bayesmeta()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanlabcol</code></td>
<td>

<p>colour specification for the overall mean label
(<code>traceplot.bayesmeta()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>matrix (or vector) of coefficients defining linear combinations of
regression parameters to be shown (<code>traceplot.bmr()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xlabels</code></td>
<td>

<p>labels for the linear combinations (<code>traceplot.bmr()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xcols</code></td>
<td>

<p>colour specification for the linear combinations
(<code>traceplot.bmr()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xlabcols</code></td>
<td>

<p>colour specification for the linear combination labels
(<code>traceplot.bmr()</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments passed on to the
<code>plot()</code> function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given heterogeneity (<code class="reqn">\tau</code>) value, the <em>conditional</em>
posterior distributions of the overall effect (<code class="reqn">\mu</code>) as well as
the study-specific parameters (<code class="reqn">\theta_i</code>) are again
normal. The conditional normal moments (mean and variance) then vary
as functions of the heterogeneity; for large heterogeneity, the
shrinkage estimates approach the original data (<code class="reqn">y_i</code>),
while the overall mean approaches an un-weighted overall average. For
small heterogeneity, both overall mean as well as study-specific
estimates are increasingly <em>shrunk</em> towards the
inverse-variance-weighted ‘common-effect’ estimate (Roever,
2020).
</p>
<p>This trace plot illustrates the conditional (overall and
study-specific) estimates along with the heterogeneity's posterior
distribution (density) in a layout similar to that utilized
by Rubin (1981).
</p>


<h3>Author(s)</h3>

<p>Christian Roever <a href="mailto:christian.roever@med.uni-goettingen.de">christian.roever@med.uni-goettingen.de</a>
</p>


<h3>References</h3>

<p>C. Roever, D. Rindskopf, T. Friede.
How trace plots help interpret meta-analysis results.
<em>(submitted for publication)</em>, 2023.
<a href="https://arxiv.org/abs/2306.17043">https://arxiv.org/abs/2306.17043</a>.
</p>
<p>C. Roever.
Bayesian random-effects meta-analysis using the bayesmeta R package.
<em>Journal of Statistical Software</em>, <b>93</b>(6):1-51, 2020.
<a href="https://doi.org/10.18637/jss.v093.i06">doi:10.18637/jss.v093.i06</a>.
</p>
<p>C. Roever, T. Friede.
Using the bayesmeta R package for Bayesian random-effects meta-regression.
<em>Computer Methods and Programs in Biomedicine</em>,
<b>299</b>:107303, 2023.
<a href="https://doi.org/10.1016/j.cmpb.2022.107303">doi:10.1016/j.cmpb.2022.107303</a>.
</p>
<p>D.B. Rubin.
Estimation in parallel randomized experiments.
<em>Journal of Educational Statistics</em>, <b>6</b>(4):377-401, 1981.
<a href="https://doi.org/10.3102/10769986006004377">doi:10.3102/10769986006004377</a>.
</p>
<p>DuMouchel, W. H. (1994).
Hierarchical Bayes linear models for meta-analysis.
Technical Report 27, National Institute of Statistical Sciences (NISS);
Research Triangle Park, NC, USA.
<a href="https://www.niss.org/research/technical-reports/hierarchical-bayes-linear-models-meta-analysis-1994">https://www.niss.org/research/technical-reports/hierarchical-bayes-linear-models-meta-analysis-1994</a>
</p>


<h3>See Also</h3>

<p><code>bayesmeta</code>, <code>bmr</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
########################
# SAT coaching example;
# load example data:
data("Rubin1981")

# perform meta-analysis:
bma01 &lt;- bayesmeta(y=Rubin1981[,"effect"], sigma=Rubin1981[,"stderr"],
                  labels=Rubin1981[,"school"], tau.prior="uniform")

# show meta-analysis results:
forestplot(bma01)

# show trace plot:
traceplot(bma01)


##################################
# COPD (meta-regression) example;
# load example data,
# compute effect sizes (log-ORs):
data("KarnerEtAl2014")
karner.exa &lt;- escalc(measure="OR",
                     ai=tiotropium.exa, n1i=tiotropium.total,
                     ci=placebo.exa,    n2i=placebo.total,
                     slab=study, data=KarnerEtAl2014)


#################################
# perform "plain" meta-analysis:
bma02 &lt;- bayesmeta(karner.exa,
                   tau.prior=function(t){dhalfnormal(t, scale=0.5)})

traceplot(bma02, ylab="log-OR",
          prior=TRUE, infi=TRUE, taulim=0.53)

forestplot(bma02)


############################
# perform meta-regressions:

# 1st regression;
# specify regressor matrix
# (indicator variables, "short" vs. "long" study duration):
X1 &lt;- cbind("short" = as.numeric(karner.exa$duration == "up to 1 year"),
            "long"  = as.numeric(karner.exa$duration == "1 year or longer"))

# perform meta-regression
# (two group means, common heterogeneity):
bmr01 &lt;- bmr(karner.exa, X=X1,
             tau.prior=function(t){dhalfnormal(t, scale=0.5)})

# show trace plot:
traceplot(bmr01, ylab="log-OR", prior=TRUE,
          taulim=0.53, mulim=c(-1, 0.2),
          X=rbind("short" = c(1,0),
                  "long"  = c(0,1)))

# 2nd regression;
# specify regressor matrix
# (baseline FEV1, an indicator of disease severity):
X2 &lt;- cbind("intercept" = 1,
            "fev1"      = karner.exa$baseline.fev1)

# perform meta-regression
# (linear effect of FEV1 on log-OR):
bmr02 &lt;- bmr(karner.exa, X=X2,
             tau.prior=function(t){dhalfnormal(t, scale=0.5)})

traceplot(bmr02, ylab="log-OR", prior=TRUE,
          taulim=0.53, mulim=c(-1.0, 0.2),
          X=rbind("FEV1 = 1.0"=c(1,1.0),
                  "FEV1 = 1.5"=c(1,1.5),
                  "FEV1 = 2.0"=c(1,2.0)))

## End(Not run)
</code></pre>


</div>