<div class="container">

<table style="width: 100%;"><tr>
<td>emix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute expectations via weighted mixtures</h2>

<h3>Description</h3>

<p>Approximates expectations of the form
</p>
<p style="text-align: center;"><code class="reqn">E[h(\theta)] = \int h(\theta) f(\theta) d\theta</code>
</p>

<p>using a weighted mixture
</p>
<p style="text-align: center;"><code class="reqn">E[h(\theta)] \approx \sum_{j=1}^k h(\theta^{(k)}) w_k</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">emix(h, params, wts, ncores = 1, errorNodesWts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Function for which the expectation should be taken.  The function 
should be defined so it is can be called via <code>f(params, ...)</code>.
Additional parameters may be passed to <code class="reqn">h</code> via <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Matrix in which each row contains parameters at which
<code class="reqn">h</code> should be evaluated.  The number of rows in <code>params</code> should 
match the number of mixture components <code class="reqn">k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>vector of weights for each mixture component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores over which to evaluate mixture.  this function
assumes a parallel backend is already registered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorNodesWts</code></td>
<td>
<p>list with elements <code>inds</code> and <code>weights</code> that 
point out which <code>params</code> get used to compute an approximation of the 
quadrature error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>h</code></p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># density will be a mixture of betas
params = matrix(exp(2*runif(10)), ncol=2)

# mixture components are equally weighted
wts = rep(1/nrow(params), nrow(params))

# compute mean of distribution by cycling over each mixture component
h = function(p) { p[1] / sum(p) }

# compute mixture mean
mean.mix = emix(h, params, wts)

# (comparison) Monte Carlo estimate of mixture mean
nsamples = 1e4
component = sample(x = 1:length(wts), size = nsamples, prob = wts, 
                   replace = TRUE)
x = sapply(component, function(cmp) {
  rbeta(n = 1, shape1 = params[cmp, 1], shape2 = params[cmp, 2])
})
mean.mix.mc = mean(x)

# compare estimates
c(emix = mean.mix, MC = mean.mix.mc)
</code></pre>


</div>