<div class="container">

<table style="width: 100%;"><tr>
<td>predBMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictive accuracy measurement using Bayesian Model Averaging</h2>

<h3>Description</h3>

<p>This function is used for predictive accuracy measurement of
the selected models using Bayesian Model Averaging methodology. The Occam's
window with cut out threshold of <code>thr</code> is used. That means only models
that have posterior probability of at least <code>thr</code> * posteior
probability of the highest posterior probability model are considered in
model averaging. For survival time response datasets, the predictive Area
Under Curve (AUC) at each given time point is computed as the output. In
this case, the predictive AUC is obtained using Uno's method for
observations in the test set. For binary outcome data, only one AUC is
reported which is from the ROC computed on the test set. The training set is
used to find the selected model and relevant probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predBMA(
  bvsobj,
  X,
  resp,
  prep,
  logT,
  nlptype = "piMOM",
  train_idx,
  test_idx,
  thr = 0.05,
  times = NULL,
  family = c("logistic", "survival")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bvsobj</code></td>
<td>
<p>An object that is generated by <code>bvs</code> function. It
is the output of the Bayesian variable selection procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The same <code>n</code> times <code>p</code> data frame initially used in
<code>bvs</code> function. This is the full data frame containing all test and
train data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>For logistic regression models, this variable is the binary
response vector. For the Cox proportional hazard models this is a two column
matrix where the first column contains survival times and the second column
is the censoring status for each observation. Note that for survival times,
the time section of this variable should be in the same scale and unit
(year, days, etc.) as <code>times</code> variable for which the AUC has to be
computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prep</code></td>
<td>
<p>A boolean variable determining if the preprocessing step has
been done on the original data frame in <code>bvs</code> function. This should
have the same value as <code>prep</code> variable in the <code>bvs</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logT</code></td>
<td>
<p>A boolean variable determining if log transform should has been
done on continuous columns of the data frame in <code>bvs</code> function. This
should have the same value as <code>logT</code> variable in the <code>bvs</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlptype</code></td>
<td>
<p>Determines the type of nonlocal prior that is used in the
analyses. It can be "piMOM" for product inverse moment prior, or "pMOM" for
product moment prior. The default is set to piMOM prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>train_idx</code></td>
<td>
<p>An integer vector containing the indices of the training
set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_idx</code></td>
<td>
<p>An integer vector containing the indices of the test set.
The set of observations that prediction will be performed on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>The threshold used for Occam's window as explained in the
description. The default value for this variable is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>A vector of times at which predictive AUC is to be computed.
This input is only used for prediction in survival data analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Determines the type of data analysis. <code>logistic</code> is for
binary outcome and logistic regression model whereas, <code>survival</code>
represents survival outcomes and the Cox proportional hazard model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output is different based on the family for the anlysis of data
<strong>1) </strong> <code>family = logistic</code>
The output is a list with the two following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>auc</code></td>
<td>
<p>This is the area under the ROC curve after Bayesian model
averaging is used to obtain ROC for the test data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc_curve</code></td>
<td>
<p>This is a two column matrix representing points on the ROC
curve and can be used to plot the curve. The first column is FPR and the
second column is TPR which represent x-axis and y-axis in the ROC curve,
respectively.</p>
</td>
</tr>
</table>
<p><strong>2) </strong> <code>family = survival</code>
</p>
<table><tr style="vertical-align: top;">
<td><code>auc</code></td>
<td>
<p>A vector with the same length as <code>times</code> variable showing
predictive area under the curve at each given time point using Bayesian
Model averaging.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Amir Nikooienejad
</p>


<h3>References</h3>

<p>Raftery, A. E., Madigan, D., &amp; Hoeting, J. A. (1997). Bayesian
model averaging for linear regression models. Journal of the American
Statistical Association, 92(437), 179-191.<br><br>
Nikooienejad, A., Wang, W., &amp; Johnson, V. E. (2020). Bayesian variable
selection for survival data using inverse moment priors. Annals of Applied
Statistics, 14(2), 809-828. <br><br>
Uno, H., Cai, T., Tian, L., &amp; Wei, L. J. (2007). Evaluating
prediction rules for t-year survivors with censored regression models.
Journal of the American Statistical Association, 102(478), 527-537.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Simulating Logistic Regression Data
n &lt;- 200
p &lt;- 40
set.seed(123)
Sigma &lt;- diag(p)
full &lt;- matrix(c(rep(0.5, p*p)), ncol=p)
Sigma &lt;- full + 0.5*Sigma
cholS &lt;- chol(Sigma)
Beta &lt;- c(-1.7,1.8,2.5)
X &lt;- matrix(rnorm(n*p), ncol=p)
X &lt;- X%*%cholS
colnames(X) &lt;- c(paste("gene_",c(1:p),sep=""))
beta &lt;- numeric(p)
beta[c(1:length(Beta))] &lt;- Beta
Xout &lt;- PreProcess(X)
X &lt;- Xout$X
XB &lt;- X%*%beta
probs &lt;- as.vector(exp(XB)/(1+exp(XB)))
y &lt;- rbinom(n,1,probs)
X &lt;- as.data.frame(X)
train_idx &lt;- sample(1:n,0.8*n)
test_idx &lt;- setdiff(1:n,train_idx)
X_train &lt;- X[train_idx,]
y_train &lt;- y[train_idx]
bout &lt;- bvs(X_train, y_train, prep=FALSE, family = "logistic",
           mod_prior = "beta",niter = 50)
BMAout &lt;- predBMA(bout, X, y, prep = FALSE, logT = FALSE, 
                 train_idx = train_idx, test_idx = test_idx,
                 family="logistic")
### AUC for the prediction:
BMAout$auc

### Plotting ROC Curve
roc &lt;- BMAout$roc_curve
plot(roc,lwd=2,type='l',col='blue')
</code></pre>


</div>