<div class="container">

<table style="width: 100%;"><tr>
<td>logLik.lineargaussian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Log-likelihood of a State Space Model of class <code>bssm_model</code>
</h2>

<h3>Description</h3>

<p>Computes the log-likelihood of a state space model defined by <code>bssm</code>
package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lineargaussian'
logLik(object, ...)

## S3 method for class 'nongaussian'
logLik(
  object,
  particles,
  method = "psi",
  max_iter = 100,
  conv_tol = 1e-08,
  seed = sample(.Machine$integer.max, size = 1),
  ...
)

## S3 method for class 'ssm_nlg'
logLik(
  object,
  particles,
  method = "bsf",
  max_iter = 100,
  conv_tol = 1e-08,
  iekf_iter = 0,
  seed = sample(.Machine$integer.max, size = 1),
  ...
)

## S3 method for class 'ssm_sde'
logLik(
  object,
  particles,
  L,
  seed = sample(.Machine$integer.max, size = 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Model of class <code>bssm_model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>particles</code></td>
<td>
<p>Number of samples for particle filter
(non-negative integer). If 0, approximate log-likelihood is returned either
based on the Gaussian approximation or EKF, depending on the <code>method</code>
argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Sampling method. For Gaussian and non-Gaussian models with
linear dynamics,options are <code>"bsf"</code> (bootstrap particle filter, default
for non-linear models) and <code>"psi"</code> (<code class="reqn">\psi</code>-APF, the default for
other models). For-nonlinear models option <code>"ekf"</code>
uses EKF/IEKF-based particle filter (or just EKF/IEKF approximation in the
case of <code>particles = 0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of iterations used in Gaussian approximation,
as a positive integer.
Default is 100 (although typically only few iterations are needed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv_tol</code></td>
<td>
<p>Positive tolerance parameter used in Gaussian approximation.
Default is 1e-8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the C++ RNG (positive integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iekf_iter</code></td>
<td>
<p>Non-negative integer. If zero (default), first
approximation for non-linear Gaussian models is obtained from extended
Kalman filter. If <code>iekf_iter &gt; 0</code>, iterated extended Kalman filter is
used with <code>iekf_iter</code> iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Integer  defining the discretization level defined as (2^L).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric value.
</p>


<h3>References</h3>

<p>Durbin, J., &amp; Koopman, S. (2002). A Simple and Efficient Simulation
Smoother for State Space Time Series Analysis. Biometrika, 89(3), 603-615.
</p>
<p>Shephard, N., &amp; Pitt, M. (1997). Likelihood Analysis of
Non-Gaussian Measurement Time Series. Biometrika, 84(3), 653-667.
</p>
<p>Gordon, NJ, Salmond, DJ, Smith, AFM (1993).
Novel approach to nonlinear/non-Gaussian Bayesian state estimation.
IEE Proceedings-F, 140, 107-113.
</p>
<p>Vihola, M, Helske, J, Franks, J. Importance sampling type estimators
based on approximate marginal Markov chain Monte Carlo.
Scand J Statist. 2020; 1-38. https://doi.org/10.1111/sjos.12492
</p>
<p>Van Der Merwe, R, Doucet, A, De Freitas, N,  Wan, EA (2001).
The unscented particle filter.
In Advances in neural information processing systems, p 584-590.
</p>
<p>Jazwinski, A 1970. Stochastic Processes and Filtering Theory.
Academic Press.
</p>
<p>Kitagawa, G (1996). Monte Carlo filter and smoother for non-Gaussian
nonlinear state space models.
Journal of Computational and Graphical Statistics, 5, 1-25.
</p>


<h3>See Also</h3>

<p>particle_smoother
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
model &lt;- ssm_ulg(y = c(1,4,3), Z = 1, H = 1, T = 1, R = 1)
logLik(model)
model &lt;- ssm_ung(y = c(1,4,3), Z = 1, T = 1, R = 0.5, P1 = 2,
  distribution = "poisson")
  
model2 &lt;- bsm_ng(y = c(1,4,3), sd_level = 0.5, P1 = 2,
  distribution = "poisson")
  
logLik(model, particles = 0)
logLik(model2, particles = 0)
logLik(model, particles = 10, seed = 1)
logLik(model2, particles = 10, seed = 1)
</code></pre>


</div>