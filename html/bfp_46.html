<div class="container">

<table style="width: 100%;"><tr>
<td>scrHpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate an SCB from a samples matrix</h2>

<h3>Description</h3>

<p>Calculate an SCB from a samples matrix, which minimizes
the absolute distances of the contained samples to a mode vector, at
each gridpoint. Therefore the SCB might be considered an “HPD
SCB”.</p>


<h3>Usage</h3>

<pre><code class="language-R">scrHpd(samples, mode = apply(samples, 2, median), level = 0.95)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>m by n matrix where m is the number of samples and n
the number of parameters, hence each (multivariate) sample is a row in
the matrix <code>samples</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>mode vector of length n (defaults to the vector of medians)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>credible level for the SCB (default: 0.95)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function first computes the matrix of absolute distances of the
samples to the mode vector. Then based on this distance matrix, a
one-sided SCB as described in Besag et al. (1995) is computed, which
is then mapped back to the samples.
</p>


<h3>Value</h3>

<p>A matrix with rows “lower” and “upper”, with the lower
and upper SCB bounds.
</p>


<h3>Author(s)</h3>

<p>Daniel Saban\'es Bov\'e</p>


<h3>References</h3>

<p>Besag, J.; Green, P.; Higdon, D. and Mengersen, K. (1995):
“Bayesian computation and stochastic systems (with
discussion)”, <em>Statistical Science</em>, 10, 3-66.</p>


<h3>See Also</h3>

<p><code>empiricalHpd</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## create some samples
time &lt;- 1:10
nSamples &lt;- 50
samples &lt;- t(replicate(nSamples,
                       time * rnorm(1) + rexp(1))) +
           rnorm(length(time) * nSamples)
matplot(time, t(samples), type="l", lty=1, col=1,
        xlab="time", ylab="response")

## now test the function: 50% credible band
scb &lt;- scrHpd(samples, level=0.5)
matlines(time, t(scb), col=2, lwd=2, lty=1)
</code></pre>


</div>